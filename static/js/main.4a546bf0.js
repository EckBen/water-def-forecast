/*! For license information please see main.4a546bf0.js.LICENSE.txt */
(()=>{var e={219:(e,t,i)=>{"use strict";var r=i(3763),n={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};function l(e){return r.isMemo(e)?s:a[e.$$typeof]||n}a[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a[r.Memo]=s;var c=Object.defineProperty,u=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,f=Object.prototype;e.exports=function e(t,i,r){if("string"!==typeof i){if(f){var n=p(i);n&&n!==f&&e(t,n,r)}var s=u(i);h&&(s=s.concat(h(i)));for(var a=l(t),m=l(i),g=0;g<s.length;++g){var y=s[g];if(!o[y]&&(!r||!r[y])&&(!m||!m[y])&&(!a||!a[y])){var _=d(i,y);try{c(t,y,_)}catch(v){}}}}return t}},457:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r.A});var r=i(7868)},528:(e,t)=>{"use strict";var i=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler");Symbol.for("react.provider");var a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),f=Symbol.for("react.offscreen"),m=Symbol.for("react.client.reference");function g(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case i:switch(e=e.type){case n:case s:case o:case u:case h:return e;default:switch(e=e&&e.$$typeof){case l:case c:case p:case d:case a:return e;default:return t}}case r:return t}}}t.vM=c,t.lD=d},579:(e,t,i)=>{"use strict";e.exports=i(1153)},869:(e,t,i)=>{"use strict";i.d(t,{A:()=>o});i(5043);var r=i(3290),n=i(579);function o(e){const{styles:t,defaultTheme:i={}}=e,o="function"===typeof t?e=>{return t(void 0===(r=e)||null===r||0===Object.keys(r).length?i:e);var r}:t;return(0,n.jsx)(r.mL,{styles:o})}},879:function(e){e.exports=function(){"use strict";var e,t,i;function r(r,n){if(e)if(t){var o="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+e+")(sharedChunk); ("+t+")(sharedChunk); self.onerror = null;",s={};e(s),i=n(s),"undefined"!==typeof window&&window&&window.URL&&window.URL.createObjectURL&&(i.workerUrl=window.URL.createObjectURL(new Blob([o],{type:"text/javascript"})))}else t=n;else e=n}return r(["exports"],(function(e){function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var i,r={},n={};function o(){if(i)return n;i=1,Object.defineProperty(n,"__esModule",{value:!0}),n.setMatrixArrayType=function(e){n.ARRAY_TYPE=t=e},n.toRadian=function(e){return e*o},n.equals=function(t,i){return Math.abs(t-i)<=e*Math.max(1,Math.abs(t),Math.abs(i))},n.RANDOM=n.ARRAY_TYPE=n.EPSILON=void 0;var e=1e-6;n.EPSILON=e;var t="undefined"!=typeof Float32Array?Float32Array:Array;n.ARRAY_TYPE=t;var r=Math.random;n.RANDOM=r;var o=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)}),n}var s,a={};function l(){if(s)return a;function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}s=1,Object.defineProperty(a,"__esModule",{value:!0}),a.create=function(){var e=new t.ARRAY_TYPE(4);return t.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},a.clone=function(e){var i=new t.ARRAY_TYPE(4);return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i},a.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},a.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},a.fromValues=function(e,i,r,n){var o=new t.ARRAY_TYPE(4);return o[0]=e,o[1]=i,o[2]=r,o[3]=n,o},a.set=function(e,t,i,r,n){return e[0]=t,e[1]=i,e[2]=r,e[3]=n,e},a.transpose=function(e,t){if(e===t){var i=t[1];e[1]=t[2],e[2]=i}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},a.invert=function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],s=i*o-n*r;return s?(e[0]=o*(s=1/s),e[1]=-r*s,e[2]=-n*s,e[3]=i*s,e):null},a.adjoint=function(e,t){var i=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=i,e},a.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},a.multiply=r,a.rotate=function(e,t,i){var r=t[0],n=t[1],o=t[2],s=t[3],a=Math.sin(i),l=Math.cos(i);return e[0]=r*l+o*a,e[1]=n*l+s*a,e[2]=r*-a+o*l,e[3]=n*-a+s*l,e},a.scale=function(e,t,i){var r=t[1],n=t[2],o=t[3],s=i[0],a=i[1];return e[0]=t[0]*s,e[1]=r*s,e[2]=n*a,e[3]=o*a,e},a.fromRotation=function(e,t){var i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=i,e[2]=-i,e[3]=r,e},a.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e},a.str=function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},a.frob=function(e){return Math.hypot(e[0],e[1],e[2],e[3])},a.LDU=function(e,t,i,r){return e[2]=r[2]/r[0],i[0]=r[0],i[1]=r[1],i[3]=r[3]-e[2]*i[1],[e,t,i]},a.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e},a.subtract=n,a.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},a.equals=function(e,i){var r=e[0],n=e[1],o=e[2],s=e[3],a=i[0],l=i[1],c=i[2],u=i[3];return Math.abs(r-a)<=t.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-l)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(o-c)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(s-u)<=t.EPSILON*Math.max(1,Math.abs(s),Math.abs(u))},a.multiplyScalar=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e},a.multiplyScalarAndAdd=function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e},a.sub=a.mul=void 0;var t=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==e(t)&&"function"!=typeof t)return{default:t};var r=i(void 0);if(r&&r.has(t))return r.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var a=o?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(n,s,a):n[s]=t[s]}return n.default=t,r&&r.set(t,n),n}(o());function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}function r(e,t,i){var r=t[0],n=t[1],o=t[2],s=t[3],a=i[0],l=i[1],c=i[2],u=i[3];return e[0]=r*a+o*l,e[1]=n*a+s*l,e[2]=r*c+o*u,e[3]=n*c+s*u,e}function n(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e}return a.mul=r,a.sub=n,a}var c,u={};function h(){if(c)return u;function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}c=1,Object.defineProperty(u,"__esModule",{value:!0}),u.create=function(){var e=new t.ARRAY_TYPE(6);return t.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e},u.clone=function(e){var i=new t.ARRAY_TYPE(6);return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i},u.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},u.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},u.fromValues=function(e,i,r,n,o,s){var a=new t.ARRAY_TYPE(6);return a[0]=e,a[1]=i,a[2]=r,a[3]=n,a[4]=o,a[5]=s,a},u.set=function(e,t,i,r,n,o,s){return e[0]=t,e[1]=i,e[2]=r,e[3]=n,e[4]=o,e[5]=s,e},u.invert=function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],s=t[4],a=t[5],l=i*o-r*n;return l?(e[0]=o*(l=1/l),e[1]=-r*l,e[2]=-n*l,e[3]=i*l,e[4]=(n*a-o*s)*l,e[5]=(r*s-i*a)*l,e):null},u.determinant=function(e){return e[0]*e[3]-e[1]*e[2]},u.multiply=r,u.rotate=function(e,t,i){var r=t[0],n=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=Math.sin(i),u=Math.cos(i);return e[0]=r*u+o*c,e[1]=n*u+s*c,e[2]=r*-c+o*u,e[3]=n*-c+s*u,e[4]=a,e[5]=l,e},u.scale=function(e,t,i){var r=t[1],n=t[2],o=t[3],s=t[4],a=t[5],l=i[0],c=i[1];return e[0]=t[0]*l,e[1]=r*l,e[2]=n*c,e[3]=o*c,e[4]=s,e[5]=a,e},u.translate=function(e,t,i){var r=t[0],n=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=i[0],u=i[1];return e[0]=r,e[1]=n,e[2]=o,e[3]=s,e[4]=r*c+o*u+a,e[5]=n*c+s*u+l,e},u.fromRotation=function(e,t){var i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=i,e[2]=-i,e[3]=r,e[4]=0,e[5]=0,e},u.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e},u.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},u.str=function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},u.frob=function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],1)},u.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e},u.subtract=n,u.multiplyScalar=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e},u.multiplyScalarAndAdd=function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e[4]=t[4]+i[4]*r,e[5]=t[5]+i[5]*r,e},u.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]},u.equals=function(e,i){var r=e[0],n=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=i[0],u=i[1],h=i[2],d=i[3],p=i[4],f=i[5];return Math.abs(r-c)<=t.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(n-u)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(o-h)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(s-d)<=t.EPSILON*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(a-p)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(l-f)<=t.EPSILON*Math.max(1,Math.abs(l),Math.abs(f))},u.sub=u.mul=void 0;var t=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==e(t)&&"function"!=typeof t)return{default:t};var r=i(void 0);if(r&&r.has(t))return r.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var a=o?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(n,s,a):n[s]=t[s]}return n.default=t,r&&r.set(t,n),n}(o());function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}function r(e,t,i){var r=t[0],n=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=i[0],u=i[1],h=i[2],d=i[3],p=i[4],f=i[5];return e[0]=r*c+o*u,e[1]=n*c+s*u,e[2]=r*h+o*d,e[3]=n*h+s*d,e[4]=r*p+o*f+a,e[5]=n*p+s*f+l,e}function n(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e}return u.mul=r,u.sub=n,u}var d,p={};function f(){if(d)return p;function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}d=1,Object.defineProperty(p,"__esModule",{value:!0}),p.create=function(){var e=new t.ARRAY_TYPE(9);return t.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},p.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},p.clone=function(e){var i=new t.ARRAY_TYPE(9);return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i},p.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},p.fromValues=function(e,i,r,n,o,s,a,l,c){var u=new t.ARRAY_TYPE(9);return u[0]=e,u[1]=i,u[2]=r,u[3]=n,u[4]=o,u[5]=s,u[6]=a,u[7]=l,u[8]=c,u},p.set=function(e,t,i,r,n,o,s,a,l,c){return e[0]=t,e[1]=i,e[2]=r,e[3]=n,e[4]=o,e[5]=s,e[6]=a,e[7]=l,e[8]=c,e},p.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},p.transpose=function(e,t){if(e===t){var i=t[1],r=t[2],n=t[5];e[1]=t[3],e[2]=t[6],e[3]=i,e[5]=t[7],e[6]=r,e[7]=n}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},p.invert=function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=u*s-a*c,d=-u*o+a*l,p=c*o-s*l,f=i*h+r*d+n*p;return f?(e[0]=h*(f=1/f),e[1]=(-u*r+n*c)*f,e[2]=(a*r-n*s)*f,e[3]=d*f,e[4]=(u*i-n*l)*f,e[5]=(-a*i+n*o)*f,e[6]=p*f,e[7]=(-c*i+r*l)*f,e[8]=(s*i-r*o)*f,e):null},p.adjoint=function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8];return e[0]=s*u-a*c,e[1]=n*c-r*u,e[2]=r*a-n*s,e[3]=a*l-o*u,e[4]=i*u-n*l,e[5]=n*o-i*a,e[6]=o*c-s*l,e[7]=r*l-i*c,e[8]=i*s-r*o,e},p.determinant=function(e){var t=e[3],i=e[4],r=e[5],n=e[6],o=e[7],s=e[8];return e[0]*(s*i-r*o)+e[1]*(-s*t+r*n)+e[2]*(o*t-i*n)},p.multiply=r,p.translate=function(e,t,i){var r=t[0],n=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=i[0],p=i[1];return e[0]=r,e[1]=n,e[2]=o,e[3]=s,e[4]=a,e[5]=l,e[6]=d*r+p*s+c,e[7]=d*n+p*a+u,e[8]=d*o+p*l+h,e},p.rotate=function(e,t,i){var r=t[0],n=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=Math.sin(i),p=Math.cos(i);return e[0]=p*r+d*s,e[1]=p*n+d*a,e[2]=p*o+d*l,e[3]=p*s-d*r,e[4]=p*a-d*n,e[5]=p*l-d*o,e[6]=c,e[7]=u,e[8]=h,e},p.scale=function(e,t,i){var r=i[0],n=i[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=n*t[3],e[4]=n*t[4],e[5]=n*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},p.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},p.fromRotation=function(e,t){var i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=i,e[2]=0,e[3]=-i,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},p.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},p.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},p.fromQuat=function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],s=i+i,a=r+r,l=n+n,c=i*s,u=r*s,h=r*a,d=n*s,p=n*a,f=n*l,m=o*s,g=o*a,y=o*l;return e[0]=1-h-f,e[3]=u-y,e[6]=d+g,e[1]=u+y,e[4]=1-c-f,e[7]=p-m,e[2]=d-g,e[5]=p+m,e[8]=1-c-h,e},p.normalFromMat4=function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],p=t[11],f=t[12],m=t[13],g=t[14],y=t[15],_=i*a-r*s,v=i*l-n*s,x=i*c-o*s,b=r*l-n*a,w=r*c-o*a,S=n*c-o*l,T=u*m-h*f,M=u*g-d*f,A=u*y-p*f,C=h*g-d*m,E=h*y-p*m,P=d*y-p*g,k=_*P-v*E+x*C+b*A-w*M+S*T;return k?(e[0]=(a*P-l*E+c*C)*(k=1/k),e[1]=(l*A-s*P-c*M)*k,e[2]=(s*E-a*A+c*T)*k,e[3]=(n*E-r*P-o*C)*k,e[4]=(i*P-n*A+o*M)*k,e[5]=(r*A-i*E-o*T)*k,e[6]=(m*S-g*w+y*b)*k,e[7]=(g*x-f*S-y*v)*k,e[8]=(f*w-m*x+y*_)*k,e):null},p.projection=function(e,t,i){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/i,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e},p.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},p.frob=function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},p.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e[6]=t[6]+i[6],e[7]=t[7]+i[7],e[8]=t[8]+i[8],e},p.subtract=n,p.multiplyScalar=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*i,e},p.multiplyScalarAndAdd=function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e[4]=t[4]+i[4]*r,e[5]=t[5]+i[5]*r,e[6]=t[6]+i[6]*r,e[7]=t[7]+i[7]*r,e[8]=t[8]+i[8]*r,e},p.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},p.equals=function(e,i){var r=e[0],n=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=i[0],p=i[1],f=i[2],m=i[3],g=i[4],y=i[5],_=i[6],v=i[7],x=i[8];return Math.abs(r-d)<=t.EPSILON*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(n-p)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(p))&&Math.abs(o-f)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(s-m)<=t.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(a-g)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(g))&&Math.abs(l-y)<=t.EPSILON*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(c-_)<=t.EPSILON*Math.max(1,Math.abs(c),Math.abs(_))&&Math.abs(u-v)<=t.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(h-x)<=t.EPSILON*Math.max(1,Math.abs(h),Math.abs(x))},p.sub=p.mul=void 0;var t=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==e(t)&&"function"!=typeof t)return{default:t};var r=i(void 0);if(r&&r.has(t))return r.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var a=o?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(n,s,a):n[s]=t[s]}return n.default=t,r&&r.set(t,n),n}(o());function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}function r(e,t,i){var r=t[0],n=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=i[0],p=i[1],f=i[2],m=i[3],g=i[4],y=i[5],_=i[6],v=i[7],x=i[8];return e[0]=d*r+p*s+f*c,e[1]=d*n+p*a+f*u,e[2]=d*o+p*l+f*h,e[3]=m*r+g*s+y*c,e[4]=m*n+g*a+y*u,e[5]=m*o+g*l+y*h,e[6]=_*r+v*s+x*c,e[7]=_*n+v*a+x*u,e[8]=_*o+v*l+x*h,e}function n(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e[6]=t[6]-i[6],e[7]=t[7]-i[7],e[8]=t[8]-i[8],e}return p.mul=r,p.sub=n,p}var m,g={};function y(){if(m)return g;function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}m=1,Object.defineProperty(g,"__esModule",{value:!0}),g.create=function(){var e=new t.ARRAY_TYPE(16);return t.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},g.clone=function(e){var i=new t.ARRAY_TYPE(16);return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i},g.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},g.fromValues=function(e,i,r,n,o,s,a,l,c,u,h,d,p,f,m,g){var y=new t.ARRAY_TYPE(16);return y[0]=e,y[1]=i,y[2]=r,y[3]=n,y[4]=o,y[5]=s,y[6]=a,y[7]=l,y[8]=c,y[9]=u,y[10]=h,y[11]=d,y[12]=p,y[13]=f,y[14]=m,y[15]=g,y},g.set=function(e,t,i,r,n,o,s,a,l,c,u,h,d,p,f,m,g){return e[0]=t,e[1]=i,e[2]=r,e[3]=n,e[4]=o,e[5]=s,e[6]=a,e[7]=l,e[8]=c,e[9]=u,e[10]=h,e[11]=d,e[12]=p,e[13]=f,e[14]=m,e[15]=g,e},g.identity=r,g.transpose=function(e,t){if(e===t){var i=t[1],r=t[2],n=t[3],o=t[6],s=t[7],a=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=i,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=o,e[11]=t[14],e[12]=n,e[13]=s,e[14]=a}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},g.invert=function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],p=t[11],f=t[12],m=t[13],g=t[14],y=t[15],_=i*a-r*s,v=i*l-n*s,x=i*c-o*s,b=r*l-n*a,w=r*c-o*a,S=n*c-o*l,T=u*m-h*f,M=u*g-d*f,A=u*y-p*f,C=h*g-d*m,E=h*y-p*m,P=d*y-p*g,k=_*P-v*E+x*C+b*A-w*M+S*T;return k?(e[0]=(a*P-l*E+c*C)*(k=1/k),e[1]=(n*E-r*P-o*C)*k,e[2]=(m*S-g*w+y*b)*k,e[3]=(d*w-h*S-p*b)*k,e[4]=(l*A-s*P-c*M)*k,e[5]=(i*P-n*A+o*M)*k,e[6]=(g*x-f*S-y*v)*k,e[7]=(u*S-d*x+p*v)*k,e[8]=(s*E-a*A+c*T)*k,e[9]=(r*A-i*E-o*T)*k,e[10]=(f*w-m*x+y*_)*k,e[11]=(h*x-u*w-p*_)*k,e[12]=(a*M-s*C-l*T)*k,e[13]=(i*C-r*M+n*T)*k,e[14]=(m*v-f*b-g*_)*k,e[15]=(u*b-h*v+d*_)*k,e):null},g.adjoint=function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],p=t[11],f=t[12],m=t[13],g=t[14],y=t[15];return e[0]=a*(d*y-p*g)-h*(l*y-c*g)+m*(l*p-c*d),e[1]=-(r*(d*y-p*g)-h*(n*y-o*g)+m*(n*p-o*d)),e[2]=r*(l*y-c*g)-a*(n*y-o*g)+m*(n*c-o*l),e[3]=-(r*(l*p-c*d)-a*(n*p-o*d)+h*(n*c-o*l)),e[4]=-(s*(d*y-p*g)-u*(l*y-c*g)+f*(l*p-c*d)),e[5]=i*(d*y-p*g)-u*(n*y-o*g)+f*(n*p-o*d),e[6]=-(i*(l*y-c*g)-s*(n*y-o*g)+f*(n*c-o*l)),e[7]=i*(l*p-c*d)-s*(n*p-o*d)+u*(n*c-o*l),e[8]=s*(h*y-p*m)-u*(a*y-c*m)+f*(a*p-c*h),e[9]=-(i*(h*y-p*m)-u*(r*y-o*m)+f*(r*p-o*h)),e[10]=i*(a*y-c*m)-s*(r*y-o*m)+f*(r*c-o*a),e[11]=-(i*(a*p-c*h)-s*(r*p-o*h)+u*(r*c-o*a)),e[12]=-(s*(h*g-d*m)-u*(a*g-l*m)+f*(a*d-l*h)),e[13]=i*(h*g-d*m)-u*(r*g-n*m)+f*(r*d-n*h),e[14]=-(i*(a*g-l*m)-s*(r*g-n*m)+f*(r*l-n*a)),e[15]=i*(a*d-l*h)-s*(r*d-n*h)+u*(r*l-n*a),e},g.determinant=function(e){var t=e[0],i=e[1],r=e[2],n=e[3],o=e[4],s=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],p=e[12],f=e[13],m=e[14],g=e[15];return(t*s-i*o)*(h*g-d*m)-(t*a-r*o)*(u*g-d*f)+(t*l-n*o)*(u*m-h*f)+(i*a-r*s)*(c*g-d*p)-(i*l-n*s)*(c*m-h*p)+(r*l-n*a)*(c*f-u*p)},g.multiply=n,g.translate=function(e,t,i){var r,n,o,s,a,l,c,u,h,d,p,f,m=i[0],g=i[1],y=i[2];return t===e?(e[12]=t[0]*m+t[4]*g+t[8]*y+t[12],e[13]=t[1]*m+t[5]*g+t[9]*y+t[13],e[14]=t[2]*m+t[6]*g+t[10]*y+t[14],e[15]=t[3]*m+t[7]*g+t[11]*y+t[15]):(n=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],p=t[10],f=t[11],e[0]=r=t[0],e[1]=n,e[2]=o,e[3]=s,e[4]=a,e[5]=l,e[6]=c,e[7]=u,e[8]=h,e[9]=d,e[10]=p,e[11]=f,e[12]=r*m+a*g+h*y+t[12],e[13]=n*m+l*g+d*y+t[13],e[14]=o*m+c*g+p*y+t[14],e[15]=s*m+u*g+f*y+t[15]),e},g.scale=function(e,t,i){var r=i[0],n=i[1],o=i[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},g.rotate=function(e,i,r,n){var o,s,a,l,c,u,h,d,p,f,m,g,y,_,v,x,b,w,S,T,M,A,C,E,P=n[0],k=n[1],I=n[2],D=Math.hypot(P,k,I);return D<t.EPSILON?null:(P*=D=1/D,k*=D,I*=D,o=Math.sin(r),s=Math.cos(r),c=i[1],u=i[2],h=i[3],p=i[5],f=i[6],m=i[7],y=i[9],_=i[10],v=i[11],x=P*P*(a=1-s)+s,S=P*k*a-I*o,T=k*k*a+s,M=I*k*a+P*o,A=P*I*a+k*o,C=k*I*a-P*o,E=I*I*a+s,e[0]=(l=i[0])*x+(d=i[4])*(b=k*P*a+I*o)+(g=i[8])*(w=I*P*a-k*o),e[1]=c*x+p*b+y*w,e[2]=u*x+f*b+_*w,e[3]=h*x+m*b+v*w,e[4]=l*S+d*T+g*M,e[5]=c*S+p*T+y*M,e[6]=u*S+f*T+_*M,e[7]=h*S+m*T+v*M,e[8]=l*A+d*C+g*E,e[9]=c*A+p*C+y*E,e[10]=u*A+f*C+_*E,e[11]=h*A+m*C+v*E,i!==e&&(e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15]),e)},g.rotateX=function(e,t,i){var r=Math.sin(i),n=Math.cos(i),o=t[4],s=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*n+c*r,e[5]=s*n+u*r,e[6]=a*n+h*r,e[7]=l*n+d*r,e[8]=c*n-o*r,e[9]=u*n-s*r,e[10]=h*n-a*r,e[11]=d*n-l*r,e},g.rotateY=function(e,t,i){var r=Math.sin(i),n=Math.cos(i),o=t[0],s=t[1],a=t[2],l=t[3],c=t[8],u=t[9],h=t[10],d=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*n-c*r,e[1]=s*n-u*r,e[2]=a*n-h*r,e[3]=l*n-d*r,e[8]=o*r+c*n,e[9]=s*r+u*n,e[10]=a*r+h*n,e[11]=l*r+d*n,e},g.rotateZ=function(e,t,i){var r=Math.sin(i),n=Math.cos(i),o=t[0],s=t[1],a=t[2],l=t[3],c=t[4],u=t[5],h=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*n+c*r,e[1]=s*n+u*r,e[2]=a*n+h*r,e[3]=l*n+d*r,e[4]=c*n-o*r,e[5]=u*n-s*r,e[6]=h*n-a*r,e[7]=d*n-l*r,e},g.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},g.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},g.fromRotation=function(e,i,r){var n,o,s,a=r[0],l=r[1],c=r[2],u=Math.hypot(a,l,c);return u<t.EPSILON?null:(a*=u=1/u,l*=u,c*=u,n=Math.sin(i),o=Math.cos(i),e[0]=a*a*(s=1-o)+o,e[1]=l*a*s+c*n,e[2]=c*a*s-l*n,e[3]=0,e[4]=a*l*s-c*n,e[5]=l*l*s+o,e[6]=c*l*s+a*n,e[7]=0,e[8]=a*c*s+l*n,e[9]=l*c*s-a*n,e[10]=c*c*s+o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},g.fromXRotation=function(e,t){var i=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=i,e[7]=0,e[8]=0,e[9]=-i,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},g.fromYRotation=function(e,t){var i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-i,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=i,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},g.fromZRotation=function(e,t){var i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=i,e[2]=0,e[3]=0,e[4]=-i,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},g.fromRotationTranslation=s,g.fromQuat2=function(e,i){var r=new t.ARRAY_TYPE(3),n=-i[0],o=-i[1],a=-i[2],l=i[3],c=i[4],u=i[5],h=i[6],d=i[7],p=n*n+o*o+a*a+l*l;return p>0?(r[0]=2*(c*l+d*n+u*a-h*o)/p,r[1]=2*(u*l+d*o+h*n-c*a)/p,r[2]=2*(h*l+d*a+c*o-u*n)/p):(r[0]=2*(c*l+d*n+u*a-h*o),r[1]=2*(u*l+d*o+h*n-c*a),r[2]=2*(h*l+d*a+c*o-u*n)),s(e,i,r),e},g.getTranslation=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},g.getScaling=a,g.getRotation=function(e,i){var r=new t.ARRAY_TYPE(3);a(r,i);var n=1/r[0],o=1/r[1],s=1/r[2],l=i[0]*n,c=i[1]*o,u=i[2]*s,h=i[4]*n,d=i[5]*o,p=i[6]*s,f=i[8]*n,m=i[9]*o,g=i[10]*s,y=l+d+g,_=0;return y>0?(_=2*Math.sqrt(y+1),e[3]=.25*_,e[0]=(p-m)/_,e[1]=(f-u)/_,e[2]=(c-h)/_):l>d&&l>g?(_=2*Math.sqrt(1+l-d-g),e[3]=(p-m)/_,e[0]=.25*_,e[1]=(c+h)/_,e[2]=(f+u)/_):d>g?(_=2*Math.sqrt(1+d-l-g),e[3]=(f-u)/_,e[0]=(c+h)/_,e[1]=.25*_,e[2]=(p+m)/_):(_=2*Math.sqrt(1+g-l-d),e[3]=(c-h)/_,e[0]=(f+u)/_,e[1]=(p+m)/_,e[2]=.25*_),e},g.fromRotationTranslationScale=function(e,t,i,r){var n=t[0],o=t[1],s=t[2],a=t[3],l=n+n,c=o+o,u=s+s,h=n*l,d=n*c,p=n*u,f=o*c,m=o*u,g=s*u,y=a*l,_=a*c,v=a*u,x=r[0],b=r[1],w=r[2];return e[0]=(1-(f+g))*x,e[1]=(d+v)*x,e[2]=(p-_)*x,e[3]=0,e[4]=(d-v)*b,e[5]=(1-(h+g))*b,e[6]=(m+y)*b,e[7]=0,e[8]=(p+_)*w,e[9]=(m-y)*w,e[10]=(1-(h+f))*w,e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e},g.fromRotationTranslationScaleOrigin=function(e,t,i,r,n){var o=t[0],s=t[1],a=t[2],l=t[3],c=o+o,u=s+s,h=a+a,d=o*c,p=o*u,f=o*h,m=s*u,g=s*h,y=a*h,_=l*c,v=l*u,x=l*h,b=r[0],w=r[1],S=r[2],T=n[0],M=n[1],A=n[2],C=(1-(m+y))*b,E=(p+x)*b,P=(f-v)*b,k=(p-x)*w,I=(1-(d+y))*w,D=(g+_)*w,L=(f+v)*S,R=(g-_)*S,z=(1-(d+m))*S;return e[0]=C,e[1]=E,e[2]=P,e[3]=0,e[4]=k,e[5]=I,e[6]=D,e[7]=0,e[8]=L,e[9]=R,e[10]=z,e[11]=0,e[12]=i[0]+T-(C*T+k*M+L*A),e[13]=i[1]+M-(E*T+I*M+R*A),e[14]=i[2]+A-(P*T+D*M+z*A),e[15]=1,e},g.fromQuat=function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],s=i+i,a=r+r,l=n+n,c=i*s,u=r*s,h=r*a,d=n*s,p=n*a,f=n*l,m=o*s,g=o*a,y=o*l;return e[0]=1-h-f,e[1]=u+y,e[2]=d-g,e[3]=0,e[4]=u-y,e[5]=1-c-f,e[6]=p+m,e[7]=0,e[8]=d+g,e[9]=p-m,e[10]=1-c-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},g.frustum=function(e,t,i,r,n,o,s){var a=1/(i-t),l=1/(n-r),c=1/(o-s);return e[0]=2*o*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*l,e[6]=0,e[7]=0,e[8]=(i+t)*a,e[9]=(n+r)*l,e[10]=(s+o)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=s*o*2*c,e[15]=0,e},g.perspectiveNO=l,g.perspectiveZO=function(e,t,i,r,n){var o,s=1/Math.tan(t/2);return e[0]=s/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=n&&n!==1/0?(e[10]=n*(o=1/(r-n)),e[14]=n*r*o):(e[10]=-1,e[14]=-r),e},g.perspectiveFromFieldOfView=function(e,t,i,r){var n=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),s=Math.tan(t.leftDegrees*Math.PI/180),a=Math.tan(t.rightDegrees*Math.PI/180),l=2/(s+a),c=2/(n+o);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-(s-a)*l*.5,e[9]=(n-o)*c*.5,e[10]=r/(i-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*i/(i-r),e[15]=0,e},g.orthoNO=c,g.orthoZO=function(e,t,i,r,n,o,s){var a=1/(t-i),l=1/(r-n),c=1/(o-s);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=c,e[11]=0,e[12]=(t+i)*a,e[13]=(n+r)*l,e[14]=o*c,e[15]=1,e},g.lookAt=function(e,i,n,o){var s,a,l,c,u,h,d,p,f,m,g=i[0],y=i[1],_=i[2],v=o[0],x=o[1],b=o[2],w=n[0],S=n[1],T=n[2];return Math.abs(g-w)<t.EPSILON&&Math.abs(y-S)<t.EPSILON&&Math.abs(_-T)<t.EPSILON?r(e):(d=g-w,p=y-S,f=_-T,s=x*(f*=m=1/Math.hypot(d,p,f))-b*(p*=m),a=b*(d*=m)-v*f,l=v*p-x*d,(m=Math.hypot(s,a,l))?(s*=m=1/m,a*=m,l*=m):(s=0,a=0,l=0),c=p*l-f*a,u=f*s-d*l,h=d*a-p*s,(m=Math.hypot(c,u,h))?(c*=m=1/m,u*=m,h*=m):(c=0,u=0,h=0),e[0]=s,e[1]=c,e[2]=d,e[3]=0,e[4]=a,e[5]=u,e[6]=p,e[7]=0,e[8]=l,e[9]=h,e[10]=f,e[11]=0,e[12]=-(s*g+a*y+l*_),e[13]=-(c*g+u*y+h*_),e[14]=-(d*g+p*y+f*_),e[15]=1,e)},g.targetTo=function(e,t,i,r){var n=t[0],o=t[1],s=t[2],a=r[0],l=r[1],c=r[2],u=n-i[0],h=o-i[1],d=s-i[2],p=u*u+h*h+d*d;p>0&&(u*=p=1/Math.sqrt(p),h*=p,d*=p);var f=l*d-c*h,m=c*u-a*d,g=a*h-l*u;return(p=f*f+m*m+g*g)>0&&(f*=p=1/Math.sqrt(p),m*=p,g*=p),e[0]=f,e[1]=m,e[2]=g,e[3]=0,e[4]=h*g-d*m,e[5]=d*f-u*g,e[6]=u*m-h*f,e[7]=0,e[8]=u,e[9]=h,e[10]=d,e[11]=0,e[12]=n,e[13]=o,e[14]=s,e[15]=1,e},g.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},g.frob=function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},g.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e[6]=t[6]+i[6],e[7]=t[7]+i[7],e[8]=t[8]+i[8],e[9]=t[9]+i[9],e[10]=t[10]+i[10],e[11]=t[11]+i[11],e[12]=t[12]+i[12],e[13]=t[13]+i[13],e[14]=t[14]+i[14],e[15]=t[15]+i[15],e},g.subtract=u,g.multiplyScalar=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12]*i,e[13]=t[13]*i,e[14]=t[14]*i,e[15]=t[15]*i,e},g.multiplyScalarAndAdd=function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e[4]=t[4]+i[4]*r,e[5]=t[5]+i[5]*r,e[6]=t[6]+i[6]*r,e[7]=t[7]+i[7]*r,e[8]=t[8]+i[8]*r,e[9]=t[9]+i[9]*r,e[10]=t[10]+i[10]*r,e[11]=t[11]+i[11]*r,e[12]=t[12]+i[12]*r,e[13]=t[13]+i[13]*r,e[14]=t[14]+i[14]*r,e[15]=t[15]+i[15]*r,e},g.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},g.equals=function(e,i){var r=e[0],n=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=e[9],p=e[10],f=e[11],m=e[12],g=e[13],y=e[14],_=e[15],v=i[0],x=i[1],b=i[2],w=i[3],S=i[4],T=i[5],M=i[6],A=i[7],C=i[8],E=i[9],P=i[10],k=i[11],I=i[12],D=i[13],L=i[14],R=i[15];return Math.abs(r-v)<=t.EPSILON*Math.max(1,Math.abs(r),Math.abs(v))&&Math.abs(n-x)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(x))&&Math.abs(o-b)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(b))&&Math.abs(s-w)<=t.EPSILON*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(a-S)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(S))&&Math.abs(l-T)<=t.EPSILON*Math.max(1,Math.abs(l),Math.abs(T))&&Math.abs(c-M)<=t.EPSILON*Math.max(1,Math.abs(c),Math.abs(M))&&Math.abs(u-A)<=t.EPSILON*Math.max(1,Math.abs(u),Math.abs(A))&&Math.abs(h-C)<=t.EPSILON*Math.max(1,Math.abs(h),Math.abs(C))&&Math.abs(d-E)<=t.EPSILON*Math.max(1,Math.abs(d),Math.abs(E))&&Math.abs(p-P)<=t.EPSILON*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(f-k)<=t.EPSILON*Math.max(1,Math.abs(f),Math.abs(k))&&Math.abs(m-I)<=t.EPSILON*Math.max(1,Math.abs(m),Math.abs(I))&&Math.abs(g-D)<=t.EPSILON*Math.max(1,Math.abs(g),Math.abs(D))&&Math.abs(y-L)<=t.EPSILON*Math.max(1,Math.abs(y),Math.abs(L))&&Math.abs(_-R)<=t.EPSILON*Math.max(1,Math.abs(_),Math.abs(R))},g.sub=g.mul=g.ortho=g.perspective=void 0;var t=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==e(t)&&"function"!=typeof t)return{default:t};var r=i(void 0);if(r&&r.has(t))return r.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var a=o?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(n,s,a):n[s]=t[s]}return n.default=t,r&&r.set(t,n),n}(o());function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}function r(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function n(e,t,i){var r=t[0],n=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],p=t[10],f=t[11],m=t[12],g=t[13],y=t[14],_=t[15],v=i[0],x=i[1],b=i[2],w=i[3];return e[0]=v*r+x*a+b*h+w*m,e[1]=v*n+x*l+b*d+w*g,e[2]=v*o+x*c+b*p+w*y,e[3]=v*s+x*u+b*f+w*_,e[4]=(v=i[4])*r+(x=i[5])*a+(b=i[6])*h+(w=i[7])*m,e[5]=v*n+x*l+b*d+w*g,e[6]=v*o+x*c+b*p+w*y,e[7]=v*s+x*u+b*f+w*_,e[8]=(v=i[8])*r+(x=i[9])*a+(b=i[10])*h+(w=i[11])*m,e[9]=v*n+x*l+b*d+w*g,e[10]=v*o+x*c+b*p+w*y,e[11]=v*s+x*u+b*f+w*_,e[12]=(v=i[12])*r+(x=i[13])*a+(b=i[14])*h+(w=i[15])*m,e[13]=v*n+x*l+b*d+w*g,e[14]=v*o+x*c+b*p+w*y,e[15]=v*s+x*u+b*f+w*_,e}function s(e,t,i){var r=t[0],n=t[1],o=t[2],s=t[3],a=r+r,l=n+n,c=o+o,u=r*a,h=r*l,d=r*c,p=n*l,f=n*c,m=o*c,g=s*a,y=s*l,_=s*c;return e[0]=1-(p+m),e[1]=h+_,e[2]=d-y,e[3]=0,e[4]=h-_,e[5]=1-(u+m),e[6]=f+g,e[7]=0,e[8]=d+y,e[9]=f-g,e[10]=1-(u+p),e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e}function a(e,t){var i=t[4],r=t[5],n=t[6],o=t[8],s=t[9],a=t[10];return e[0]=Math.hypot(t[0],t[1],t[2]),e[1]=Math.hypot(i,r,n),e[2]=Math.hypot(o,s,a),e}function l(e,t,i,r,n){var o,s=1/Math.tan(t/2);return e[0]=s/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=n&&n!==1/0?(e[10]=(n+r)*(o=1/(r-n)),e[14]=2*n*r*o):(e[10]=-1,e[14]=-2*r),e}function c(e,t,i,r,n,o,s){var a=1/(t-i),l=1/(r-n),c=1/(o-s);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+i)*a,e[13]=(n+r)*l,e[14]=(s+o)*c,e[15]=1,e}function u(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e[6]=t[6]-i[6],e[7]=t[7]-i[7],e[8]=t[8]-i[8],e[9]=t[9]-i[9],e[10]=t[10]-i[10],e[11]=t[11]-i[11],e[12]=t[12]-i[12],e[13]=t[13]-i[13],e[14]=t[14]-i[14],e[15]=t[15]-i[15],e}return g.perspective=l,g.ortho=c,g.mul=n,g.sub=u,g}var _,v={},x={};function b(){if(_)return x;function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}_=1,Object.defineProperty(x,"__esModule",{value:!0}),x.create=r,x.clone=function(e){var i=new t.ARRAY_TYPE(3);return i[0]=e[0],i[1]=e[1],i[2]=e[2],i},x.length=n,x.fromValues=function(e,i,r){var n=new t.ARRAY_TYPE(3);return n[0]=e,n[1]=i,n[2]=r,n},x.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},x.set=function(e,t,i,r){return e[0]=t,e[1]=i,e[2]=r,e},x.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e},x.subtract=s,x.multiply=a,x.divide=l,x.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},x.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},x.min=function(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e},x.max=function(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e},x.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},x.scale=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e},x.scaleAndAdd=function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e},x.distance=c,x.squaredDistance=u,x.squaredLength=h,x.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},x.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},x.normalize=function(e,t){var i=t[0],r=t[1],n=t[2],o=i*i+r*r+n*n;return o>0&&(o=1/Math.sqrt(o)),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e},x.dot=d,x.cross=function(e,t,i){var r=t[0],n=t[1],o=t[2],s=i[0],a=i[1],l=i[2];return e[0]=n*l-o*a,e[1]=o*s-r*l,e[2]=r*a-n*s,e},x.lerp=function(e,t,i,r){var n=t[0],o=t[1],s=t[2];return e[0]=n+r*(i[0]-n),e[1]=o+r*(i[1]-o),e[2]=s+r*(i[2]-s),e},x.hermite=function(e,t,i,r,n,o){var s=o*o,a=s*(2*o-3)+1,l=s*(o-2)+o,c=s*(o-1),u=s*(3-2*o);return e[0]=t[0]*a+i[0]*l+r[0]*c+n[0]*u,e[1]=t[1]*a+i[1]*l+r[1]*c+n[1]*u,e[2]=t[2]*a+i[2]*l+r[2]*c+n[2]*u,e},x.bezier=function(e,t,i,r,n,o){var s=1-o,a=s*s,l=o*o,c=a*s,u=3*o*a,h=3*l*s,d=l*o;return e[0]=t[0]*c+i[0]*u+r[0]*h+n[0]*d,e[1]=t[1]*c+i[1]*u+r[1]*h+n[1]*d,e[2]=t[2]*c+i[2]*u+r[2]*h+n[2]*d,e},x.random=function(e,i){i=i||1;var r=2*t.RANDOM()*Math.PI,n=2*t.RANDOM()-1,o=Math.sqrt(1-n*n)*i;return e[0]=Math.cos(r)*o,e[1]=Math.sin(r)*o,e[2]=n*i,e},x.transformMat4=function(e,t,i){var r=t[0],n=t[1],o=t[2],s=i[3]*r+i[7]*n+i[11]*o+i[15];return e[0]=(i[0]*r+i[4]*n+i[8]*o+i[12])/(s=s||1),e[1]=(i[1]*r+i[5]*n+i[9]*o+i[13])/s,e[2]=(i[2]*r+i[6]*n+i[10]*o+i[14])/s,e},x.transformMat3=function(e,t,i){var r=t[0],n=t[1],o=t[2];return e[0]=r*i[0]+n*i[3]+o*i[6],e[1]=r*i[1]+n*i[4]+o*i[7],e[2]=r*i[2]+n*i[5]+o*i[8],e},x.transformQuat=function(e,t,i){var r=i[0],n=i[1],o=i[2],s=t[0],a=t[1],l=t[2],c=n*l-o*a,u=o*s-r*l,h=r*a-n*s,d=n*h-o*u,p=o*c-r*h,f=r*u-n*c,m=2*i[3];return u*=m,h*=m,p*=2,f*=2,e[0]=s+(c*=m)+(d*=2),e[1]=a+u+p,e[2]=l+h+f,e},x.rotateX=function(e,t,i,r){var n=[],o=[];return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],o[0]=n[0],o[1]=n[1]*Math.cos(r)-n[2]*Math.sin(r),o[2]=n[1]*Math.sin(r)+n[2]*Math.cos(r),e[0]=o[0]+i[0],e[1]=o[1]+i[1],e[2]=o[2]+i[2],e},x.rotateY=function(e,t,i,r){var n=[],o=[];return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],o[0]=n[2]*Math.sin(r)+n[0]*Math.cos(r),o[1]=n[1],o[2]=n[2]*Math.cos(r)-n[0]*Math.sin(r),e[0]=o[0]+i[0],e[1]=o[1]+i[1],e[2]=o[2]+i[2],e},x.rotateZ=function(e,t,i,r){var n=[],o=[];return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],o[0]=n[0]*Math.cos(r)-n[1]*Math.sin(r),o[1]=n[0]*Math.sin(r)+n[1]*Math.cos(r),o[2]=n[2],e[0]=o[0]+i[0],e[1]=o[1]+i[1],e[2]=o[2]+i[2],e},x.angle=function(e,t){var i=e[0],r=e[1],n=e[2],o=t[0],s=t[1],a=t[2],l=Math.sqrt(i*i+r*r+n*n)*Math.sqrt(o*o+s*s+a*a),c=l&&d(e,t)/l;return Math.acos(Math.min(Math.max(c,-1),1))},x.zero=function(e){return e[0]=0,e[1]=0,e[2]=0,e},x.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},x.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},x.equals=function(e,i){var r=e[0],n=e[1],o=e[2],s=i[0],a=i[1],l=i[2];return Math.abs(r-s)<=t.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-a)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(o-l)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))},x.forEach=x.sqrLen=x.len=x.sqrDist=x.dist=x.div=x.mul=x.sub=void 0;var t=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==e(t)&&"function"!=typeof t)return{default:t};var r=i(void 0);if(r&&r.has(t))return r.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var a=o?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(n,s,a):n[s]=t[s]}return n.default=t,r&&r.set(t,n),n}(o());function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}function r(){var e=new t.ARRAY_TYPE(3);return t.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function n(e){return Math.hypot(e[0],e[1],e[2])}function s(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e}function a(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e}function l(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e}function c(e,t){return Math.hypot(t[0]-e[0],t[1]-e[1],t[2]-e[2])}function u(e,t){var i=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2];return i*i+r*r+n*n}function h(e){var t=e[0],i=e[1],r=e[2];return t*t+i*i+r*r}function d(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}x.sub=s,x.mul=a,x.div=l,x.dist=c,x.sqrDist=u,x.len=n,x.sqrLen=h;var p,f=(p=r(),function(e,t,i,r,n,o){var s,a;for(t||(t=3),i||(i=0),a=r?Math.min(r*t+i,e.length):e.length,s=i;s<a;s+=t)p[0]=e[s],p[1]=e[s+1],p[2]=e[s+2],n(p,p,o),e[s]=p[0],e[s+1]=p[1],e[s+2]=p[2];return e});return x.forEach=f,x}var w,S,T={};function M(){if(w)return T;function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}w=1,Object.defineProperty(T,"__esModule",{value:!0}),T.create=r,T.clone=function(e){var i=new t.ARRAY_TYPE(4);return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i},T.fromValues=function(e,i,r,n){var o=new t.ARRAY_TYPE(4);return o[0]=e,o[1]=i,o[2]=r,o[3]=n,o},T.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},T.set=function(e,t,i,r,n){return e[0]=t,e[1]=i,e[2]=r,e[3]=n,e},T.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e},T.subtract=n,T.multiply=s,T.divide=a,T.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},T.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},T.min=function(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e[3]=Math.min(t[3],i[3]),e},T.max=function(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e[3]=Math.max(t[3],i[3]),e},T.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},T.scale=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e},T.scaleAndAdd=function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e},T.distance=l,T.squaredDistance=c,T.length=u,T.squaredLength=h,T.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},T.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},T.normalize=function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],s=i*i+r*r+n*n+o*o;return s>0&&(s=1/Math.sqrt(s)),e[0]=i*s,e[1]=r*s,e[2]=n*s,e[3]=o*s,e},T.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},T.cross=function(e,t,i,r){var n=i[0]*r[1]-i[1]*r[0],o=i[0]*r[2]-i[2]*r[0],s=i[0]*r[3]-i[3]*r[0],a=i[1]*r[2]-i[2]*r[1],l=i[1]*r[3]-i[3]*r[1],c=i[2]*r[3]-i[3]*r[2],u=t[0],h=t[1],d=t[2],p=t[3];return e[0]=h*c-d*l+p*a,e[1]=-u*c+d*s-p*o,e[2]=u*l-h*s+p*n,e[3]=-u*a+h*o-d*n,e},T.lerp=function(e,t,i,r){var n=t[0],o=t[1],s=t[2],a=t[3];return e[0]=n+r*(i[0]-n),e[1]=o+r*(i[1]-o),e[2]=s+r*(i[2]-s),e[3]=a+r*(i[3]-a),e},T.random=function(e,i){var r,n,o,s,a,l;i=i||1;do{a=(r=2*t.RANDOM()-1)*r+(n=2*t.RANDOM()-1)*n}while(a>=1);do{l=(o=2*t.RANDOM()-1)*o+(s=2*t.RANDOM()-1)*s}while(l>=1);var c=Math.sqrt((1-a)/l);return e[0]=i*r,e[1]=i*n,e[2]=i*o*c,e[3]=i*s*c,e},T.transformMat4=function(e,t,i){var r=t[0],n=t[1],o=t[2],s=t[3];return e[0]=i[0]*r+i[4]*n+i[8]*o+i[12]*s,e[1]=i[1]*r+i[5]*n+i[9]*o+i[13]*s,e[2]=i[2]*r+i[6]*n+i[10]*o+i[14]*s,e[3]=i[3]*r+i[7]*n+i[11]*o+i[15]*s,e},T.transformQuat=function(e,t,i){var r=t[0],n=t[1],o=t[2],s=i[0],a=i[1],l=i[2],c=i[3],u=c*r+a*o-l*n,h=c*n+l*r-s*o,d=c*o+s*n-a*r,p=-s*r-a*n-l*o;return e[0]=u*c+p*-s+h*-l-d*-a,e[1]=h*c+p*-a+d*-s-u*-l,e[2]=d*c+p*-l+u*-a-h*-s,e[3]=t[3],e},T.zero=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e},T.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},T.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},T.equals=function(e,i){var r=e[0],n=e[1],o=e[2],s=e[3],a=i[0],l=i[1],c=i[2],u=i[3];return Math.abs(r-a)<=t.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-l)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(o-c)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(s-u)<=t.EPSILON*Math.max(1,Math.abs(s),Math.abs(u))},T.forEach=T.sqrLen=T.len=T.sqrDist=T.dist=T.div=T.mul=T.sub=void 0;var t=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==e(t)&&"function"!=typeof t)return{default:t};var r=i(void 0);if(r&&r.has(t))return r.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var a=o?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(n,s,a):n[s]=t[s]}return n.default=t,r&&r.set(t,n),n}(o());function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}function r(){var e=new t.ARRAY_TYPE(4);return t.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function n(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e}function s(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e[3]=t[3]*i[3],e}function a(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e[3]=t[3]/i[3],e}function l(e,t){return Math.hypot(t[0]-e[0],t[1]-e[1],t[2]-e[2],t[3]-e[3])}function c(e,t){var i=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2],o=t[3]-e[3];return i*i+r*r+n*n+o*o}function u(e){return Math.hypot(e[0],e[1],e[2],e[3])}function h(e){var t=e[0],i=e[1],r=e[2],n=e[3];return t*t+i*i+r*r+n*n}T.sub=n,T.mul=s,T.div=a,T.dist=l,T.sqrDist=c,T.len=u,T.sqrLen=h;var d,p=(d=r(),function(e,t,i,r,n,o){var s,a;for(t||(t=4),i||(i=0),a=r?Math.min(r*t+i,e.length):e.length,s=i;s<a;s+=t)d[0]=e[s],d[1]=e[s+1],d[2]=e[s+2],d[3]=e[s+3],n(d,d,o),e[s]=d[0],e[s+1]=d[1],e[s+2]=d[2],e[s+3]=d[3];return e});return T.forEach=p,T}function A(){if(S)return v;function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}S=1,Object.defineProperty(v,"__esModule",{value:!0}),v.create=l,v.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},v.setAxisAngle=c,v.getAxisAngle=function(e,i){var r=2*Math.acos(i[3]),n=Math.sin(r/2);return n>t.EPSILON?(e[0]=i[0]/n,e[1]=i[1]/n,e[2]=i[2]/n):(e[0]=1,e[1]=0,e[2]=0),r},v.getAngle=function(e,t){var i=y(e,t);return Math.acos(2*i*i-1)},v.multiply=u,v.rotateX=function(e,t,i){i*=.5;var r=t[0],n=t[1],o=t[2],s=t[3],a=Math.sin(i),l=Math.cos(i);return e[0]=r*l+s*a,e[1]=n*l+o*a,e[2]=o*l-n*a,e[3]=s*l-r*a,e},v.rotateY=function(e,t,i){i*=.5;var r=t[0],n=t[1],o=t[2],s=t[3],a=Math.sin(i),l=Math.cos(i);return e[0]=r*l-o*a,e[1]=n*l+s*a,e[2]=o*l+r*a,e[3]=s*l-n*a,e},v.rotateZ=function(e,t,i){i*=.5;var r=t[0],n=t[1],o=t[2],s=t[3],a=Math.sin(i),l=Math.cos(i);return e[0]=r*l+n*a,e[1]=n*l-r*a,e[2]=o*l+s*a,e[3]=s*l-o*a,e},v.calculateW=function(e,t){var i=t[0],r=t[1],n=t[2];return e[0]=i,e[1]=r,e[2]=n,e[3]=Math.sqrt(Math.abs(1-i*i-r*r-n*n)),e},v.exp=h,v.ln=d,v.pow=function(e,t,i){return d(e,t),g(e,e,i),h(e,e),e},v.slerp=p,v.random=function(e){var i=t.RANDOM(),r=t.RANDOM(),n=t.RANDOM(),o=Math.sqrt(1-i),s=Math.sqrt(i);return e[0]=o*Math.sin(2*Math.PI*r),e[1]=o*Math.cos(2*Math.PI*r),e[2]=s*Math.sin(2*Math.PI*n),e[3]=s*Math.cos(2*Math.PI*n),e},v.invert=function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],s=i*i+r*r+n*n+o*o,a=s?1/s:0;return e[0]=-i*a,e[1]=-r*a,e[2]=-n*a,e[3]=o*a,e},v.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},v.fromMat3=m,v.fromEuler=function(e,t,i,r){var n=.5*Math.PI/180;t*=n,i*=n,r*=n;var o=Math.sin(t),s=Math.cos(t),a=Math.sin(i),l=Math.cos(i),c=Math.sin(r),u=Math.cos(r);return e[0]=o*l*u-s*a*c,e[1]=s*a*u+o*l*c,e[2]=s*l*c-o*a*u,e[3]=s*l*u+o*a*c,e},v.str=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},v.setAxes=v.sqlerp=v.rotationTo=v.equals=v.exactEquals=v.normalize=v.sqrLen=v.squaredLength=v.len=v.length=v.lerp=v.dot=v.scale=v.mul=v.add=v.set=v.copy=v.fromValues=v.clone=void 0;var t=a(o()),i=a(f()),r=a(b()),n=a(M());function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(s=function(e){return e?i:t})(e)}function a(t,i){if(t&&t.__esModule)return t;if(null===t||"object"!==e(t)&&"function"!=typeof t)return{default:t};var r=s(i);if(r&&r.has(t))return r.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&Object.prototype.hasOwnProperty.call(t,a)){var l=o?Object.getOwnPropertyDescriptor(t,a):null;l&&(l.get||l.set)?Object.defineProperty(n,a,l):n[a]=t[a]}return n.default=t,r&&r.set(t,n),n}function l(){var e=new t.ARRAY_TYPE(4);return t.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function c(e,t,i){i*=.5;var r=Math.sin(i);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(i),e}function u(e,t,i){var r=t[0],n=t[1],o=t[2],s=t[3],a=i[0],l=i[1],c=i[2],u=i[3];return e[0]=r*u+s*a+n*c-o*l,e[1]=n*u+s*l+o*a-r*c,e[2]=o*u+s*c+r*l-n*a,e[3]=s*u-r*a-n*l-o*c,e}function h(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],s=Math.sqrt(i*i+r*r+n*n),a=Math.exp(o),l=s>0?a*Math.sin(s)/s:0;return e[0]=i*l,e[1]=r*l,e[2]=n*l,e[3]=a*Math.cos(s),e}function d(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],s=Math.sqrt(i*i+r*r+n*n),a=s>0?Math.atan2(s,o)/s:0;return e[0]=i*a,e[1]=r*a,e[2]=n*a,e[3]=.5*Math.log(i*i+r*r+n*n+o*o),e}function p(e,i,r,n){var o,s,a,l,c,u=i[0],h=i[1],d=i[2],p=i[3],f=r[0],m=r[1],g=r[2],y=r[3];return(s=u*f+h*m+d*g+p*y)<0&&(s=-s,f=-f,m=-m,g=-g,y=-y),1-s>t.EPSILON?(o=Math.acos(s),a=Math.sin(o),l=Math.sin((1-n)*o)/a,c=Math.sin(n*o)/a):(l=1-n,c=n),e[0]=l*u+c*f,e[1]=l*h+c*m,e[2]=l*d+c*g,e[3]=l*p+c*y,e}function m(e,t){var i,r=t[0]+t[4]+t[8];if(r>0)i=Math.sqrt(r+1),e[3]=.5*i,e[0]=(t[5]-t[7])*(i=.5/i),e[1]=(t[6]-t[2])*i,e[2]=(t[1]-t[3])*i;else{var n=0;t[4]>t[0]&&(n=1),t[8]>t[3*n+n]&&(n=2);var o=(n+1)%3,s=(n+2)%3;i=Math.sqrt(t[3*n+n]-t[3*o+o]-t[3*s+s]+1),e[n]=.5*i,e[3]=(t[3*o+s]-t[3*s+o])*(i=.5/i),e[o]=(t[3*o+n]+t[3*n+o])*i,e[s]=(t[3*s+n]+t[3*n+s])*i}return e}v.clone=n.clone,v.fromValues=n.fromValues,v.copy=n.copy,v.set=n.set,v.add=n.add,v.mul=u;var g=n.scale;v.scale=g;var y=n.dot;v.dot=y,v.lerp=n.lerp;var _=n.length;v.length=_,v.len=_;var x=n.squaredLength;v.squaredLength=x,v.sqrLen=x;var w=n.normalize;v.normalize=w,v.exactEquals=n.exactEquals,v.equals=n.equals;var T,A,C,E=(T=r.create(),A=r.fromValues(1,0,0),C=r.fromValues(0,1,0),function(e,t,i){var n=r.dot(t,i);return n<-.999999?(r.cross(T,A,t),r.len(T)<1e-6&&r.cross(T,C,t),r.normalize(T,T),c(e,T,Math.PI),e):n>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(r.cross(T,t,i),e[0]=T[0],e[1]=T[1],e[2]=T[2],e[3]=1+n,w(e,e))});v.rotationTo=E;var P,k,I=(P=l(),k=l(),function(e,t,i,r,n,o){return p(P,t,n,o),p(k,i,r,o),p(e,P,k,2*o*(1-o)),e});v.sqlerp=I;var D,L=(D=i.create(),function(e,t,i,r){return D[0]=i[0],D[3]=i[1],D[6]=i[2],D[1]=r[0],D[4]=r[1],D[7]=r[2],D[2]=-t[0],D[5]=-t[1],D[8]=-t[2],w(e,m(e,D))});return v.setAxes=L,v}var C,E={};function P(){if(C)return E;function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}C=1,Object.defineProperty(E,"__esModule",{value:!0}),E.create=function(){var e=new t.ARRAY_TYPE(8);return t.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e},E.clone=function(e){var i=new t.ARRAY_TYPE(8);return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i},E.fromValues=function(e,i,r,n,o,s,a,l){var c=new t.ARRAY_TYPE(8);return c[0]=e,c[1]=i,c[2]=r,c[3]=n,c[4]=o,c[5]=s,c[6]=a,c[7]=l,c},E.fromRotationTranslationValues=function(e,i,r,n,o,s,a){var l=new t.ARRAY_TYPE(8);l[0]=e,l[1]=i,l[2]=r,l[3]=n;var c=.5*o,u=.5*s,h=.5*a;return l[4]=c*n+u*r-h*i,l[5]=u*n+h*e-c*r,l[6]=h*n+c*i-u*e,l[7]=-c*e-u*i-h*r,l},E.fromRotationTranslation=a,E.fromTranslation=function(e,t){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=.5*t[0],e[5]=.5*t[1],e[6]=.5*t[2],e[7]=0,e},E.fromRotation=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e},E.fromMat4=function(e,n){var o=i.create();r.getRotation(o,n);var s=new t.ARRAY_TYPE(3);return r.getTranslation(s,n),a(e,o,s),e},E.copy=l,E.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e},E.set=function(e,t,i,r,n,o,s,a,l){return e[0]=t,e[1]=i,e[2]=r,e[3]=n,e[4]=o,e[5]=s,e[6]=a,e[7]=l,e},E.getDual=function(e,t){return e[0]=t[4],e[1]=t[5],e[2]=t[6],e[3]=t[7],e},E.setDual=function(e,t){return e[4]=t[0],e[5]=t[1],e[6]=t[2],e[7]=t[3],e},E.getTranslation=function(e,t){var i=t[4],r=t[5],n=t[6],o=t[7],s=-t[0],a=-t[1],l=-t[2],c=t[3];return e[0]=2*(i*c+o*s+r*l-n*a),e[1]=2*(r*c+o*a+n*s-i*l),e[2]=2*(n*c+o*l+i*a-r*s),e},E.translate=function(e,t,i){var r=t[0],n=t[1],o=t[2],s=t[3],a=.5*i[0],l=.5*i[1],c=.5*i[2],u=t[4],h=t[5],d=t[6],p=t[7];return e[0]=r,e[1]=n,e[2]=o,e[3]=s,e[4]=s*a+n*c-o*l+u,e[5]=s*l+o*a-r*c+h,e[6]=s*c+r*l-n*a+d,e[7]=-r*a-n*l-o*c+p,e},E.rotateX=function(e,t,r){var n=-t[0],o=-t[1],s=-t[2],a=t[3],l=t[4],c=t[5],u=t[6],h=t[7],d=l*a+h*n+c*s-u*o,p=c*a+h*o+u*n-l*s,f=u*a+h*s+l*o-c*n,m=h*a-l*n-c*o-u*s;return i.rotateX(e,t,r),e[4]=d*(a=e[3])+m*(n=e[0])+p*(s=e[2])-f*(o=e[1]),e[5]=p*a+m*o+f*n-d*s,e[6]=f*a+m*s+d*o-p*n,e[7]=m*a-d*n-p*o-f*s,e},E.rotateY=function(e,t,r){var n=-t[0],o=-t[1],s=-t[2],a=t[3],l=t[4],c=t[5],u=t[6],h=t[7],d=l*a+h*n+c*s-u*o,p=c*a+h*o+u*n-l*s,f=u*a+h*s+l*o-c*n,m=h*a-l*n-c*o-u*s;return i.rotateY(e,t,r),e[4]=d*(a=e[3])+m*(n=e[0])+p*(s=e[2])-f*(o=e[1]),e[5]=p*a+m*o+f*n-d*s,e[6]=f*a+m*s+d*o-p*n,e[7]=m*a-d*n-p*o-f*s,e},E.rotateZ=function(e,t,r){var n=-t[0],o=-t[1],s=-t[2],a=t[3],l=t[4],c=t[5],u=t[6],h=t[7],d=l*a+h*n+c*s-u*o,p=c*a+h*o+u*n-l*s,f=u*a+h*s+l*o-c*n,m=h*a-l*n-c*o-u*s;return i.rotateZ(e,t,r),e[4]=d*(a=e[3])+m*(n=e[0])+p*(s=e[2])-f*(o=e[1]),e[5]=p*a+m*o+f*n-d*s,e[6]=f*a+m*s+d*o-p*n,e[7]=m*a-d*n-p*o-f*s,e},E.rotateByQuatAppend=function(e,t,i){var r=i[0],n=i[1],o=i[2],s=i[3],a=t[0],l=t[1],c=t[2],u=t[3];return e[0]=a*s+u*r+l*o-c*n,e[1]=l*s+u*n+c*r-a*o,e[2]=c*s+u*o+a*n-l*r,e[3]=u*s-a*r-l*n-c*o,e[4]=(a=t[4])*s+(u=t[7])*r+(l=t[5])*o-(c=t[6])*n,e[5]=l*s+u*n+c*r-a*o,e[6]=c*s+u*o+a*n-l*r,e[7]=u*s-a*r-l*n-c*o,e},E.rotateByQuatPrepend=function(e,t,i){var r=t[0],n=t[1],o=t[2],s=t[3],a=i[0],l=i[1],c=i[2],u=i[3];return e[0]=r*u+s*a+n*c-o*l,e[1]=n*u+s*l+o*a-r*c,e[2]=o*u+s*c+r*l-n*a,e[3]=s*u-r*a-n*l-o*c,e[4]=r*(u=i[7])+s*(a=i[4])+n*(c=i[6])-o*(l=i[5]),e[5]=n*u+s*l+o*a-r*c,e[6]=o*u+s*c+r*l-n*a,e[7]=s*u-r*a-n*l-o*c,e},E.rotateAroundAxis=function(e,i,r,n){if(Math.abs(n)<t.EPSILON)return l(e,i);var o=Math.hypot(r[0],r[1],r[2]);n*=.5;var s=Math.sin(n),a=s*r[0]/o,c=s*r[1]/o,u=s*r[2]/o,h=Math.cos(n),d=i[0],p=i[1],f=i[2],m=i[3];e[0]=d*h+m*a+p*u-f*c,e[1]=p*h+m*c+f*a-d*u,e[2]=f*h+m*u+d*c-p*a,e[3]=m*h-d*a-p*c-f*u;var g=i[4],y=i[5],_=i[6],v=i[7];return e[4]=g*h+v*a+y*u-_*c,e[5]=y*h+v*c+_*a-g*u,e[6]=_*h+v*u+g*c-y*a,e[7]=v*h-g*a-y*c-_*u,e},E.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e[6]=t[6]+i[6],e[7]=t[7]+i[7],e},E.multiply=c,E.scale=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e},E.lerp=function(e,t,i,r){var n=1-r;return u(t,i)<0&&(r=-r),e[0]=t[0]*n+i[0]*r,e[1]=t[1]*n+i[1]*r,e[2]=t[2]*n+i[2]*r,e[3]=t[3]*n+i[3]*r,e[4]=t[4]*n+i[4]*r,e[5]=t[5]*n+i[5]*r,e[6]=t[6]*n+i[6]*r,e[7]=t[7]*n+i[7]*r,e},E.invert=function(e,t){var i=d(t);return e[0]=-t[0]/i,e[1]=-t[1]/i,e[2]=-t[2]/i,e[3]=t[3]/i,e[4]=-t[4]/i,e[5]=-t[5]/i,e[6]=-t[6]/i,e[7]=t[7]/i,e},E.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=t[7],e},E.normalize=function(e,t){var i=d(t);if(i>0){i=Math.sqrt(i);var r=t[0]/i,n=t[1]/i,o=t[2]/i,s=t[3]/i,a=t[4],l=t[5],c=t[6],u=t[7],h=r*a+n*l+o*c+s*u;e[0]=r,e[1]=n,e[2]=o,e[3]=s,e[4]=(a-r*h)/i,e[5]=(l-n*h)/i,e[6]=(c-o*h)/i,e[7]=(u-s*h)/i}return e},E.str=function(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"},E.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]},E.equals=function(e,i){var r=e[0],n=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=i[0],d=i[1],p=i[2],f=i[3],m=i[4],g=i[5],y=i[6],_=i[7];return Math.abs(r-h)<=t.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(n-d)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(o-p)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(s-f)<=t.EPSILON*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(a-m)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(l-g)<=t.EPSILON*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(c-y)<=t.EPSILON*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(u-_)<=t.EPSILON*Math.max(1,Math.abs(u),Math.abs(_))},E.sqrLen=E.squaredLength=E.len=E.length=E.dot=E.mul=E.setReal=E.getReal=void 0;var t=s(o()),i=s(A()),r=s(y());function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(n=function(e){return e?i:t})(e)}function s(t,i){if(t&&t.__esModule)return t;if(null===t||"object"!==e(t)&&"function"!=typeof t)return{default:t};var r=n(i);if(r&&r.has(t))return r.get(t);var o={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&Object.prototype.hasOwnProperty.call(t,a)){var l=s?Object.getOwnPropertyDescriptor(t,a):null;l&&(l.get||l.set)?Object.defineProperty(o,a,l):o[a]=t[a]}return o.default=t,r&&r.set(t,o),o}function a(e,t,i){var r=.5*i[0],n=.5*i[1],o=.5*i[2],s=t[0],a=t[1],l=t[2],c=t[3];return e[0]=s,e[1]=a,e[2]=l,e[3]=c,e[4]=r*c+n*l-o*a,e[5]=n*c+o*s-r*l,e[6]=o*c+r*a-n*s,e[7]=-r*s-n*a-o*l,e}function l(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function c(e,t,i){var r=t[0],n=t[1],o=t[2],s=t[3],a=i[4],l=i[5],c=i[6],u=i[7],h=t[4],d=t[5],p=t[6],f=t[7],m=i[0],g=i[1],y=i[2],_=i[3];return e[0]=r*_+s*m+n*y-o*g,e[1]=n*_+s*g+o*m-r*y,e[2]=o*_+s*y+r*g-n*m,e[3]=s*_-r*m-n*g-o*y,e[4]=r*u+s*a+n*c-o*l+h*_+f*m+d*y-p*g,e[5]=n*u+s*l+o*a-r*c+d*_+f*g+p*m-h*y,e[6]=o*u+s*c+r*l-n*a+p*_+f*y+h*g-d*m,e[7]=s*u-r*a-n*l-o*c+f*_-h*m-d*g-p*y,e}E.getReal=i.copy,E.setReal=i.copy,E.mul=c;var u=i.dot;E.dot=u;var h=i.length;E.length=h,E.len=h;var d=i.squaredLength;return E.squaredLength=d,E.sqrLen=d,E}var k,I,D={};function L(){if(k)return D;function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}k=1,Object.defineProperty(D,"__esModule",{value:!0}),D.create=r,D.clone=function(e){var i=new t.ARRAY_TYPE(2);return i[0]=e[0],i[1]=e[1],i},D.fromValues=function(e,i){var r=new t.ARRAY_TYPE(2);return r[0]=e,r[1]=i,r},D.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},D.set=function(e,t,i){return e[0]=t,e[1]=i,e},D.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e},D.subtract=n,D.multiply=s,D.divide=a,D.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},D.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},D.min=function(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e},D.max=function(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e},D.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},D.scale=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e},D.scaleAndAdd=function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e},D.distance=l,D.squaredDistance=c,D.length=u,D.squaredLength=h,D.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},D.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},D.normalize=function(e,t){var i=t[0],r=t[1],n=i*i+r*r;return n>0&&(n=1/Math.sqrt(n)),e[0]=t[0]*n,e[1]=t[1]*n,e},D.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},D.cross=function(e,t,i){var r=t[0]*i[1]-t[1]*i[0];return e[0]=e[1]=0,e[2]=r,e},D.lerp=function(e,t,i,r){var n=t[0],o=t[1];return e[0]=n+r*(i[0]-n),e[1]=o+r*(i[1]-o),e},D.random=function(e,i){i=i||1;var r=2*t.RANDOM()*Math.PI;return e[0]=Math.cos(r)*i,e[1]=Math.sin(r)*i,e},D.transformMat2=function(e,t,i){var r=t[0],n=t[1];return e[0]=i[0]*r+i[2]*n,e[1]=i[1]*r+i[3]*n,e},D.transformMat2d=function(e,t,i){var r=t[0],n=t[1];return e[0]=i[0]*r+i[2]*n+i[4],e[1]=i[1]*r+i[3]*n+i[5],e},D.transformMat3=function(e,t,i){var r=t[0],n=t[1];return e[0]=i[0]*r+i[3]*n+i[6],e[1]=i[1]*r+i[4]*n+i[7],e},D.transformMat4=function(e,t,i){var r=t[0],n=t[1];return e[0]=i[0]*r+i[4]*n+i[12],e[1]=i[1]*r+i[5]*n+i[13],e},D.rotate=function(e,t,i,r){var n=t[0]-i[0],o=t[1]-i[1],s=Math.sin(r),a=Math.cos(r);return e[0]=n*a-o*s+i[0],e[1]=n*s+o*a+i[1],e},D.angle=function(e,t){var i=e[0],r=e[1],n=t[0],o=t[1],s=Math.sqrt(i*i+r*r)*Math.sqrt(n*n+o*o);return Math.acos(Math.min(Math.max(s&&(i*n+r*o)/s,-1),1))},D.zero=function(e){return e[0]=0,e[1]=0,e},D.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},D.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]},D.equals=function(e,i){var r=e[0],n=e[1],o=i[0],s=i[1];return Math.abs(r-o)<=t.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))},D.forEach=D.sqrLen=D.sqrDist=D.dist=D.div=D.mul=D.sub=D.len=void 0;var t=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==e(t)&&"function"!=typeof t)return{default:t};var r=i(void 0);if(r&&r.has(t))return r.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var a=o?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(n,s,a):n[s]=t[s]}return n.default=t,r&&r.set(t,n),n}(o());function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}function r(){var e=new t.ARRAY_TYPE(2);return t.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0),e}function n(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e}function s(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e}function a(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e}function l(e,t){return Math.hypot(t[0]-e[0],t[1]-e[1])}function c(e,t){var i=t[0]-e[0],r=t[1]-e[1];return i*i+r*r}function u(e){return Math.hypot(e[0],e[1])}function h(e){var t=e[0],i=e[1];return t*t+i*i}D.len=u,D.sub=n,D.mul=s,D.div=a,D.dist=l,D.sqrDist=c,D.sqrLen=h;var d,p=(d=r(),function(e,t,i,r,n,o){var s,a;for(t||(t=2),i||(i=0),a=r?Math.min(r*t+i,e.length):e.length,s=i;s<a;s+=t)d[0]=e[s],d[1]=e[s+1],n(d,d,o),e[s]=d[0],e[s+1]=d[1];return e});return D.forEach=p,D}function R(){if(I)return r;function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}I=1,Object.defineProperty(r,"__esModule",{value:!0}),r.vec4=r.vec3=r.vec2=r.quat2=r.quat=r.mat4=r.mat3=r.mat2d=r.mat2=r.glMatrix=void 0;var t=_(o());r.glMatrix=t;var i=_(l());r.mat2=i;var n=_(h());r.mat2d=n;var s=_(f());r.mat3=s;var a=_(y());r.mat4=a;var c=_(A());r.quat=c;var u=_(P());r.quat2=u;var d=_(L());r.vec2=d;var p=_(b());r.vec3=p;var m=_(M());function g(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(g=function(e){return e?i:t})(e)}function _(t,i){if(t&&t.__esModule)return t;if(null===t||"object"!==e(t)&&"function"!=typeof t)return{default:t};var r=g(i);if(r&&r.has(t))return r.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var a=o?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(n,s,a):n[s]=t[s]}return n.default=t,r&&r.set(t,n),n}return r.vec4=m,r}var z,O,F,B,N=R(),j=function(){if(O)return z;function e(e,t,i,r){this.cx=3*e,this.bx=3*(i-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(r-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=i,this.p2y=r}return O=1,z=e,e.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var i=e,r=0;r<8;r++){var n=this.sampleCurveX(i)-e;if(Math.abs(n)<t)return i;var o=this.sampleCurveDerivativeX(i);if(Math.abs(o)<1e-6)break;i-=n/o}var s=0,a=1;for(i=e,r=0;r<20&&(n=this.sampleCurveX(i),!(Math.abs(n-e)<t));r++)e>n?s=i:a=i,i=.5*(a-s)+s;return i},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}},z}(),V=t(j);function U(){if(B)return F;function e(e,t){this.x=e,this.y=t}return B=1,F=e,e.prototype={clone:function(){return new e(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,i=e.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),i=Math.sin(e),r=i*this.x+t*this.y;return this.x=t*this.x-i*this.y,this.y=r,this},_rotateAround:function(e,t){var i=Math.cos(e),r=Math.sin(e),n=t.y+r*(this.x-t.x)+i*(this.y-t.y);return this.x=t.x+i*(this.x-t.x)-r*(this.y-t.y),this.y=n,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},e.convert=function(t){return t instanceof e?t:Array.isArray(t)?new e(t[0],t[1]):t},F}var G=t(U());function H(e,t){if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!H(e[i],t[i]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==t){if("object"!=typeof t)return!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(!H(e[i],t[i]))return!1;return!0}return e===t}const W=Math.PI/180,$=180/Math.PI;function q(e){return e*W}function X(e){return e*$}const Y=[[0,0],[1,0],[1,1],[0,1]];function Z(e){if(e<=0)return 0;if(e>=1)return 1;const t=e*e,i=t*e;return 4*(e<.5?i:3*(e-t)+i-.75)}function K(e,t,i,r){const n=new V(e,t,i,r);return function(e){return n.solve(e)}}const J=K(.25,.1,.25,1);function Q(e,t,i){return Math.min(i,Math.max(t,e))}function ee(e,t,i){return(i=Q((i-e)/(t-e),0,1))*i*(3-2*i)}function te(e,t,i){const r=i-t,n=((e-t)%r+r)%r+t;return n===t?i:n}function ie(e,t,i){if(!e.length)return i(null,[]);let r=e.length;const n=new Array(e.length);let o=null;e.forEach(((e,s)=>{t(e,((e,t)=>{e&&(o=e),n[s]=t,0==--r&&i(o,n)}))}))}function re(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];for(const n of i)for(const t in n)e[t]=n[t];return e}let ne=1;function oe(){return ne++}function se(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function ae(e,t){e.forEach((e=>{t[e]&&(t[e]=t[e].bind(t))}))}function le(e,t){return-1!==e.indexOf(t,e.length-t.length)}function ce(e,t,i){const r={};for(const n in e)r[n]=t.call(this,e[n],n,e);return r}function ue(e,t,i){const r={};for(const n in e)t.call(this,e[n],n,e)&&(r[n]=e[n]);return r}function he(e){return Array.isArray(e)?e.map(he):"object"==typeof e&&e?ce(e,he):e}const de={};function pe(e){de[e]||("undefined"!=typeof console&&console.warn(e),de[e]=!0)}function fe(e,t,i){return(i.y-e.y)*(t.x-e.x)>(t.y-e.y)*(i.x-e.x)}function me(e){let t=0;for(let i,r,n=0,o=e.length,s=o-1;n<o;s=n++)i=e[n],r=e[s],t+=(r.x-i.x)*(i.y+r.y);return t}function ge(e){let[t,i,r]=e;const n=q(i+90),o=q(r);return{x:t*Math.cos(n)*Math.sin(o),y:t*Math.sin(n)*Math.sin(o),z:t*Math.cos(o),azimuthal:i,polar:r}}function ye(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function _e(e){const t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((e,i,r,n)=>{const o=r||n;return t[i]=!o||o.toLowerCase(),""})),t["max-age"]){const e=parseInt(t["max-age"],10);isNaN(e)?delete t["max-age"]:t["max-age"]=e}return t}let ve=null;function xe(e,t){return[e[4*t],e[4*t+1],e[4*t+2],e[4*t+3]]}function be(e,t,i,r){for(;t<i;){const n=t+i>>1;e[n]<r?t=n+1:i=n}return t}function we(e,t,i,r){for(;t<i;){const n=t+i>>1;e[n]<=r?t=n+1:i=n}return t}function Se(e){return e>0?1/(1.001-e):1+e}function Te(e){return e>0?1-1/(1.001-e):-e}const Me={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!Me.API_URL)return null;try{const e=new URL(Me.API_URL);return"api.mapbox.cn"===e.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===e.hostname?"https://events.mapbox.com/events/v2":null}catch(e){return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function Ae(e){return Me.API_URL_REGEX.test(e)}function Ce(e){return Me.API_SPRITE_REGEX.test(e)}let Ee,Pe,ke,Ie,De,Le;function Re(){return null==Ee&&(Ee=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof self.createImageBitmap),Ee}const ze={now:()=>void 0!==Ie?Ie:performance.now(),setNow(e){Ie=e},restoreNow(){Ie=void 0},frame(e){const t=requestAnimationFrame(e);return{cancel:()=>cancelAnimationFrame(t)}},getImageData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const{width:i,height:r}=e;De||(De=document.createElement("canvas"));const n=De.getContext("2d",{willReadFrequently:!0});if(!n)throw new Error("failed to create canvas 2d context");return(i>De.width||r>De.height)&&(De.width=i,De.height=r),n.clearRect(-t,-t,i+2*t,r+2*t),n.drawImage(e,0,0,i,r),n.getImageData(-t,-t,i+2*t,r+2*t)},resolveURL:e=>(Pe||(Pe=document.createElement("a")),Pe.href=e,Pe.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(null==ke&&(ke=window.matchMedia("(prefers-reduced-motion: reduce)")),ke.matches)},hasCanvasFingerprintNoise(){if(void 0!==Le)return Le;if(!Re())return Le=!1,!1;const e=new OffscreenCanvas(85,1),t=e.getContext("2d",{willReadFrequently:!0});let i=0;for(let n=0;n<e.width;++n)t.fillStyle=`rgba(${i++},${i++},${i++}, 255)`,t.fillRect(n,0,1,1);const r=t.getImageData(0,0,e.width,e.height);i=0;for(let n=0;n<r.data.length;++n)if(n%4!=3&&i++!==r.data[n])return Le=!0,!0;return Le=!1,!1}};function Oe(e,t){const i=e.indexOf("?");if(i<0)return`${e}?${new URLSearchParams(t).toString()}`;const r=new URLSearchParams(e.slice(i));for(const n in t)r.set(n,t[n]);return`${e.slice(0,i)}?${r.toString()}`}function Fe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{persistentParams:[]};const i=e.indexOf("?");if(i<0)return e;const r=new URLSearchParams,n=new URLSearchParams(e.slice(i));for(const s of t.persistentParams){const e=n.get(s);e&&r.set(s,e)}const o=r.toString();return`${e.slice(0,i)}${o.length>0?`?${o}`:""}`}const Be="mapbox-tiles";let Ne=500,je=50;const Ve=["language","worldview","jobid"];let Ue,Ge;function He(){try{return caches}catch(e){}}function We(){const e=He();e&&null==Ue&&(Ue=e.open(Be))}let $e=1/0;const qe={supported:!1,testSupport:function(e){!Ze&&Ye&&(Ke?Qe(e):Xe=e)}};let Xe,Ye,Ze=!1,Ke=!1;const Je="undefined"!=typeof self?self:{};function Qe(e){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,Ye),e.isContextLost())return;qe.supported=!0}catch(e){}e.deleteTexture(t),Ze=!0}Je.document&&(Ye=Je.document.createElement("img"),Ye.onload=function(){Xe&&Qe(Xe),Xe=null,Ke=!0},Ye.onerror=function(){Ze=!0,Xe=null},Ye.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const et={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};"function"==typeof Object.freeze&&Object.freeze(et);class tt extends Error{constructor(e,t,i){401===t&&Ae(i)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=t,this.url=i}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const it=ye()?()=>self.worker&&self.worker.referrer:()=>("blob:"===location.protocol?parent:self).location.href,rt=function(e,t){if(!(/^file:/.test(i=e.url)||/^file:/.test(it())&&!/^\w+:/.test(i))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(e,t){const i=new AbortController,r=new Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,referrer:it(),referrerPolicy:e.referrerPolicy,signal:i.signal});let n=!1,o=!1;const s=(a=r.url).indexOf("sku=")>0&&Ae(a);var a;"json"===e.type&&r.headers.set("Accept","application/json");const l=(i,n,a)=>{if(o)return;if(i&&"SecurityError"!==i.message&&pe(i.toString()),n&&a)return c(n);const l=Date.now();fetch(r).then((i=>{if(i.ok){const e=s?i.clone():null;return c(i,e,l)}return t(new tt(i.statusText,i.status,e.url))})).catch((i=>{"AbortError"!==i.name&&t(new Error(`${i.message} ${e.url}`))}))},c=(i,s,a)=>{("arrayBuffer"===e.type?i.arrayBuffer():"json"===e.type?i.json():i.text()).then((e=>{o||(s&&a&&function(e,t,i){if(We(),null==Ue)return;const r=_e(t.headers.get("Cache-Control")||"");if(r["no-store"])return;const n={status:t.status,statusText:t.statusText,headers:new Headers};t.headers.forEach(((e,t)=>n.headers.set(t,e))),r["max-age"]&&n.headers.set("Expires",new Date(i+1e3*r["max-age"]).toUTCString());const o=n.headers.get("Expires");if(!o)return;if(new Date(o).getTime()-i<42e4)return;let s=Fe(e.url,{persistentParams:Ve});if(206===t.status){const t=e.headers.get("Range");if(!t)return;n.status=200,s=Oe(s,{range:t})}!function(e,t){if(void 0===Ge)try{new Response(new ReadableStream),Ge=!0}catch(e){Ge=!1}Ge?t(e.body):e.blob().then(t)}(t,(e=>{const i=new Response(200!==(r=t.status)&&404!==r&&[101,103,204,205,304].includes(r)?null:e,n);var r;We(),null!=Ue&&Ue.then((e=>e.put(s,i))).catch((e=>pe(e.message)))}))}(r,s,a),n=!0,t(null,e,i.headers.get("Cache-Control"),i.headers.get("Expires")))})).catch((e=>{o||t(new Error(e.message))}))};return s?function(e,t){if(We(),null==Ue)return t(null);Ue.then((i=>{let r=Fe(e.url,{persistentParams:Ve});const n=e.headers.get("Range");n&&(r=Oe(r,{range:n})),i.match(r).then((e=>{const n=function(e){if(!e)return!1;const t=new Date(e.headers.get("Expires")||0),i=_e(e.headers.get("Cache-Control")||"");return t>Date.now()&&!i["no-cache"]}(e);i.delete(r),n&&i.put(r,e.clone()),t(null,e,n)})).catch(t)})).catch(t)}(r,l):l(null,null),{cancel:()=>{o=!0,n||i.abort()}}}(e,t);if(ye()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var i;return function(e,t){const i=new XMLHttpRequest;i.open(e.method||"GET",e.url,!0),"arrayBuffer"===e.type&&(i.responseType="arraybuffer");for(const r in e.headers)i.setRequestHeader(r,e.headers[r]);return"json"===e.type&&(i.responseType="text",i.setRequestHeader("Accept","application/json")),i.withCredentials="include"===e.credentials,i.onerror=()=>{t(new Error(i.statusText))},i.onload=()=>{if((i.status>=200&&i.status<300||0===i.status)&&null!==i.response){let r=i.response;if("json"===e.type)try{r=JSON.parse(i.response)}catch(e){return t(e)}t(null,r,i.getResponseHeader("Cache-Control"),i.getResponseHeader("Expires"))}else t(new tt(i.statusText,i.status,e.url))},i.send(e.body),{cancel:()=>i.abort()}}(e,t)},nt=function(e,t){return rt(re(e,{type:"arrayBuffer"}),t)};function ot(e){const t=document.createElement("a");return t.href=e,t.protocol===location.protocol&&t.host===location.host}const st="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let at,lt;at=[],lt=0;const ct=function(e,t){if(qe.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),lt>=Me.MAX_PARALLEL_IMAGE_REQUESTS){const i={requestParameters:e,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return at.push(i),i}lt++;let i=!1;const r=()=>{if(!i)for(i=!0,lt--;at.length&&lt<Me.MAX_PARALLEL_IMAGE_REQUESTS;){const e=at.shift(),{requestParameters:t,callback:i,cancelled:r}=e;r||(e.cancel=ct(t,i).cancel)}},n=nt(e,((e,i,n,o)=>{r(),e?t(e):i&&(self.createImageBitmap?function(e,t){const i=new Blob([new Uint8Array(e)],{type:"image/png"});createImageBitmap(i).then((e=>{t(null,e)})).catch((e=>{t(new Error(`Could not load image because of ${e.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))}))}(i,((e,i)=>t(e,i,n,o))):function(e,t){const i=new Image;i.onload=()=>{t(null,i),URL.revokeObjectURL(i.src),i.onload=null,requestAnimationFrame((()=>{i.src=st}))},i.onerror=()=>t(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const r=new Blob([new Uint8Array(e)],{type:"image/png"});i.src=e.byteLength?URL.createObjectURL(r):st}(i,((e,i)=>t(e,i,n,o))))}));return{cancel:()=>{n.cancel(),r()}}};var ut,ht,dt,pt={exports:{}},ft={exports:{}},mt={exports:{}},gt=function(){if(dt)return pt.exports;dt=1;var e=(ut||(ut=1,ft.exports=function(e,t){var i,r,n,o,s,a,l,c;for(r=e.length-(i=3&e.length),n=t,s=3432918353,a=461845907,c=0;c<r;)l=255&e.charCodeAt(c)|(255&e.charCodeAt(++c))<<8|(255&e.charCodeAt(++c))<<16|(255&e.charCodeAt(++c))<<24,++c,n=27492+(65535&(o=5*(65535&(n=(n^=l=(65535&(l=(l=(65535&l)*s+(((l>>>16)*s&65535)<<16)&4294967295)<<15|l>>>17))*a+(((l>>>16)*a&65535)<<16)&4294967295)<<13|n>>>19))+((5*(n>>>16)&65535)<<16)&4294967295))+((58964+(o>>>16)&65535)<<16);switch(l=0,i){case 3:l^=(255&e.charCodeAt(c+2))<<16;case 2:l^=(255&e.charCodeAt(c+1))<<8;case 1:n^=l=(65535&(l=(l=(65535&(l^=255&e.charCodeAt(c)))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<15|l>>>17))*a+(((l>>>16)*a&65535)<<16)&4294967295}return n^=e.length,n=2246822507*(65535&(n^=n>>>16))+((2246822507*(n>>>16)&65535)<<16)&4294967295,n=3266489909*(65535&(n^=n>>>13))+((3266489909*(n>>>16)&65535)<<16)&4294967295,(n^=n>>>16)>>>0}),ft.exports),t=(ht||(ht=1,mt.exports=function(e,t){for(var i,r=e.length,n=t^r,o=0;r>=4;)i=1540483477*(65535&(i=255&e.charCodeAt(o)|(255&e.charCodeAt(++o))<<8|(255&e.charCodeAt(++o))<<16|(255&e.charCodeAt(++o))<<24))+((1540483477*(i>>>16)&65535)<<16),n=1540483477*(65535&n)+((1540483477*(n>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),r-=4,++o;switch(r){case 3:n^=(255&e.charCodeAt(o+2))<<16;case 2:n^=(255&e.charCodeAt(o+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(o)))+((1540483477*(n>>>16)&65535)<<16)}return n=1540483477*(65535&(n^=n>>>13))+((1540483477*(n>>>16)&65535)<<16),(n^=n>>>15)>>>0}),mt.exports);return pt.exports=e,pt.exports.murmur3=e,pt.exports.murmur2=t,pt.exports}(),yt=t(gt);class _t{constructor(e){re(this,(arguments.length<=1?void 0:arguments[1])||{}),this.type=e}}class vt extends _t{constructor(e){super("error",re({error:e},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}}function xt(e,t,i){i[e]&&-1!==i[e].indexOf(t)||(i[e]=i[e]||[],i[e].push(t))}function bt(e,t,i){if(i&&i[e]){const r=i[e].indexOf(t);-1!==r&&i[e].splice(r,1)}}class wt{on(e,t){return this._listeners=this._listeners||{},xt(e,t,this._listeners),this}off(e,t){return bt(e,t,this._listeners),bt(e,t,this._oneTimeListeners),this}once(e,t){return t?(this._oneTimeListeners=this._oneTimeListeners||{},xt(e,t,this._oneTimeListeners),this):new Promise((t=>this.once(e,t)))}fire(e,t){const i="string"==typeof e?new _t(e,t):e,r=i.type;if(this.listens(r)){i.target=this;const e=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];for(const r of e)r.call(this,i);const t=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];for(const o of t)bt(r,o,this._oneTimeListeners),o.call(this,i);const n=this._eventedParent;n&&(re(i,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),n.fire(i))}else i instanceof vt&&console.error(i.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,t){return this._eventedParent=e,this._eventedParentData=t,this}}var St,Tt={},Mt=function(){if(St)return Tt;St=1;var e={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function t(e){return(e=Math.round(e))<0?0:e>255?255:e}function i(e){return t("%"===e[e.length-1]?parseFloat(e)/100*255:parseInt(e))}function r(e){return(t="%"===e[e.length-1]?parseFloat(e)/100:parseFloat(e))<0?0:t>1?1:t;var t}function n(e,t,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?e+(t-e)*i*6:2*i<1?t:3*i<2?e+(t-e)*(2/3-i)*6:e}try{Tt.parseCSSColor=function(o){var s,a=o.replace(/ /g,"").toLowerCase();if(a in e)return e[a].slice();if("#"===a[0])return 4===a.length?(s=parseInt(a.substr(1),16))>=0&&s<=4095?[(3840&s)>>4|(3840&s)>>8,240&s|(240&s)>>4,15&s|(15&s)<<4,1]:null:7===a.length&&(s=parseInt(a.substr(1),16))>=0&&s<=16777215?[(16711680&s)>>16,(65280&s)>>8,255&s,1]:null;var l=a.indexOf("("),c=a.indexOf(")");if(-1!==l&&c+1===a.length){var u=a.substr(0,l),h=a.substr(l+1,c-(l+1)).split(","),d=1;switch(u){case"rgba":if(4!==h.length)return null;d=r(h.pop());case"rgb":return 3!==h.length?null:[i(h[0]),i(h[1]),i(h[2]),d];case"hsla":if(4!==h.length)return null;d=r(h.pop());case"hsl":if(3!==h.length)return null;var p=(parseFloat(h[0])%360+360)%360/360,f=r(h[1]),m=r(h[2]),g=m<=.5?m*(f+1):m+f-m*f,y=2*m-g;return[t(255*n(y,g,p+1/3)),t(255*n(y,g,p)),t(255*n(y,g,p-1/3)),d];default:return null}}return null}}catch(e){}return Tt}();class At{constructor(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.r=e,this.g=t,this.b=i,this.a=r}static parse(e){if(!e)return;if(e instanceof At)return e;if("string"!=typeof e)return;const t=Mt.parseCSSColor(e);return t?new At(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3]):void 0}toStringPremultipliedAlpha(){const[e,t,i,r]=0===this.a?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(e)},${Math.round(t)},${Math.round(i)},${r})`}toString(){const[e,t,i,r]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*e)},${Math.round(255*t)},${Math.round(255*i)},${r})`}toRenderColor(e){const{r:t,g:i,b:r,a:n}=this;return new Ct(e,t,i,r,n)}clone(){return new At(this.r,this.g,this.b,this.a)}}class Ct{constructor(e,t,i,r,n){if(e){const o=e.image.height,s=o*o;t=0===n?0:t/n*(o-1),i=0===n?0:i/n*(o-1),r=0===n?0:r/n*(o-1);const a=Math.floor(t),l=Math.floor(i),c=Math.floor(r),u=Math.ceil(t),h=Math.ceil(i),d=Math.ceil(r),p=t-a,f=i-l,m=r-c,g=e.image.data,y=4*(a+l*s+c*o),_=4*(a+l*s+d*o),v=4*(a+h*s+c*o),x=4*(a+h*s+d*o),b=4*(u+l*s+c*o),w=4*(u+l*s+d*o),S=4*(u+h*s+c*o),T=4*(u+h*s+d*o);if(y<0||T>=g.length)throw new Error("out of range");this.r=Et(Et(Et(g[y],g[_],m),Et(g[v],g[x],m),f),Et(Et(g[b],g[w],m),Et(g[S],g[T],m),f),p)/255*n,this.g=Et(Et(Et(g[y+1],g[_+1],m),Et(g[v+1],g[x+1],m),f),Et(Et(g[b+1],g[w+1],m),Et(g[S+1],g[T+1],m),f),p)/255*n,this.b=Et(Et(Et(g[y+2],g[_+2],m),Et(g[v+2],g[x+2],m),f),Et(Et(g[b+2],g[w+2],m),Et(g[S+2],g[T+2],m),f),p)/255*n,this.a=n}else this.r=t,this.g=i,this.b=r,this.a=n}toArray(){const{r:e,g:t,b:i,a:r}=this;return 0===r?[0,0,0,0]:[255*e/r,255*t/r,255*i/r,r]}toHslaArray(){if(0===this.a)return[0,0,0,0];const{r:e,g:t,b:i,a:r}=this,n=Math.min(Math.max(e/r,0),1),o=Math.min(Math.max(t/r,0),1),s=Math.min(Math.max(i/r,0),1),a=Math.min(n,o,s),l=Math.max(n,o,s),c=(a+l)/2;if(a===l)return[0,0,100*c,r];const u=l-a,h=c>.5?u/(2-l-a):u/(l+a);let d=0;return l===n?d=(o-s)/u+(o<s?6:0):l===o?d=(s-n)/u+2:l===s&&(d=(n-o)/u+4),d*=60,[Math.min(Math.max(d,0),360),Math.min(Math.max(100*h,0),100),Math.min(Math.max(100*c,0),100),r]}toArray01(){const{r:e,g:t,b:i,a:r}=this;return 0===r?[0,0,0,0]:[e/r,t/r,i/r,r]}toArray01Scaled(e){const{r:t,g:i,b:r,a:n}=this;return 0===n?[0,0,0]:[t/n*e,i/n*e,r/n*e]}toArray01PremultipliedAlpha(){const{r:e,g:t,b:i,a:r}=this;return[e,t,i,r]}toArray01Linear(){const{r:e,g:t,b:i,a:r}=this;return 0===r?[0,0,0,0]:[Math.pow(e/r,2.2),Math.pow(t/r,2.2),Math.pow(i/r,2.2),r]}}function Et(e,t,i){return e*(1-i)+t*i}function Pt(e,t,i){return e.map(((e,r)=>Et(e,t[r],i)))}At.black=new At(0,0,0,1),At.white=new At(1,1,1,1),At.transparent=new At(0,0,0,0),At.red=new At(1,0,0,1),At.blue=new At(0,0,1,1);var kt=Object.freeze({__proto__:null,array:Pt,color:function(e,t,i){return new At(Et(e.r,t.r,i),Et(e.g,t.g,i),Et(e.b,t.b,i),Et(e.a,t.a,i))},number:Et});function It(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];for(const n of i)for(const t in n)e[t]=n[t];return e}class Dt extends Error{constructor(e,t){super(t),this.message=t,this.key=e}}class Lt{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.parent=e,this.bindings={};for(const[i,r]of t)this.bindings[i]=r}concat(e){return new Lt(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const Rt={kind:"null"},zt={kind:"number"},Ot={kind:"string"},Ft={kind:"boolean"},Bt={kind:"color"},Nt={kind:"object"},jt={kind:"value"},Vt={kind:"collator"},Ut={kind:"formatted"},Gt={kind:"resolvedImage"};function Ht(e,t){return{kind:"array",itemType:e,N:t}}function Wt(e){if("array"===e.kind){const t=Wt(e.itemType);return"number"==typeof e.N?`array<${t}, ${e.N}>`:"value"===e.itemType.kind?"array":`array<${t}>`}return e.kind}const $t=[Rt,zt,Ot,Ft,Bt,Ut,Nt,Ht(jt),Gt];function qt(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!qt(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(const e of $t)if(!qt(e,t))return null}return`Expected ${Wt(e)} but found ${Wt(t)} instead.`}function Xt(e,t){return t.some((t=>t.kind===e.kind))}function Yt(e,t){return t.some((t=>"null"===t?null===e:"array"===t?Array.isArray(e):"object"===t?e&&!Array.isArray(e)&&"object"==typeof e:t===typeof e))}class Zt{constructor(e,t,i){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,t){return this.collator.compare(e,t)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Kt{constructor(e,t,i,r,n){this.text=e.normalize?e.normalize():e,this.image=t,this.scale=i,this.fontStack=r,this.textColor=n}}class Jt{constructor(e){this.sections=e}static fromString(e){return new Jt([new Kt(e,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some((e=>0!==e.text.length||e.image&&e.image.namePrimary))}static factory(e){return e instanceof Jt?e:Jt.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map((e=>e.text)).join("")}serialize(){const e=["format"];for(const t of this.sections){if(t.image){e.push(["image",t.image.namePrimary]);continue}e.push(t.text);const i={};t.fontStack&&(i["text-font"]=["literal",t.fontStack.split(",")]),t.scale&&(i["font-scale"]=t.scale),t.textColor&&(i["text-color"]=["rgba"].concat(t.textColor.toRenderColor(null).toArray())),e.push(i)}return e}}class Qt{constructor(e,t){if(this.id=e,this.options=t||{params:{}},this.options.transform){const{a:e,b:t,c:i,d:r,e:n,f:o}=this.options.transform;this.options.transform=new DOMMatrix([e,t,i,r,n,o])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}static deserializeId(e){return JSON.parse(e).id}static deserializeFromString(e){const t=JSON.parse(e),{a:i,b:r,c:n,d:o,e:s,f:a}=t.options.transform;return new DOMMatrix([i,r,n,o,s,a]),new Qt(t.id,t.options)}scaleSelf(e){return this.options.transform=this.options.transform.scale(e),this}serialize(){const e={id:this.id};this.options&&(e.options=this.options);const{a:t,b:i,c:r,d:n,e:o,f:s}=this.options.transform;return e.options.transform={a:t,b:i,c:r,d:n,e:o,f:s},JSON.stringify(e)}}class ei{constructor(e){this.namePrimary=e.namePrimary,e.nameSecondary&&(this.nameSecondary=e.nameSecondary),e.optionsPrimary&&(this.optionsPrimary=e.optionsPrimary),e.optionsSecondary&&(this.optionsSecondary=e.optionsSecondary),this.available=e.available}toString(){return this.namePrimary&&this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}getPrimary(){return new Qt(this.namePrimary,{params:this.optionsPrimary&&this.optionsPrimary.params||{}})}getSerializedPrimary(){return this.getPrimary().serialize()}getSecondary(){return this.nameSecondary?new Qt(this.nameSecondary,{params:this.optionsSecondary&&this.optionsSecondary.params||{}}):null}static from(e){return"string"==typeof e?ei.build(e):e}static build(e,t,i,r){return e?new ei({namePrimary:e,nameSecondary:t,optionsPrimary:i,optionsSecondary:r,available:!1}):null}}function ti(e,t,i,r){return"number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof i&&i>=0&&i<=255?void 0===r||"number"==typeof r&&r>=0&&r<=1?null:`Invalid rgba value [${[e,t,i,r].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof r?[e,t,i,r]:[e,t,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ii(e){if(null===e)return!0;if("string"==typeof e)return!0;if("boolean"==typeof e)return!0;if("number"==typeof e)return!0;if(e instanceof At)return!0;if(e instanceof Zt)return!0;if(e instanceof Jt)return!0;if(e instanceof ei)return!0;if(Array.isArray(e)){for(const t of e)if(!ii(t))return!1;return!0}if("object"==typeof e){for(const t in e)if(!ii(e[t]))return!1;return!0}return!1}function ri(e){if(null===e)return Rt;if("string"==typeof e)return Ot;if("boolean"==typeof e)return Ft;if("number"==typeof e)return zt;if(e instanceof At)return Bt;if(e instanceof Zt)return Vt;if(e instanceof Jt)return Ut;if(e instanceof ei)return Gt;if(Array.isArray(e)){const t=e.length;let i;for(const r of e){const e=ri(r);if(i){if(i===e)continue;i=jt;break}i=e}return Ht(i||jt,t)}return Nt}function ni(e){const t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof At?e.toStringPremultipliedAlpha():e instanceof Jt||e instanceof ei?e.toString():JSON.stringify(e)}class oi{constructor(e,t){this.type=e,this.value=t}static parse(e,t){if(2!==e.length)return t.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!ii(e[1]))return t.error("invalid value");const i=e[1];let r=ri(i);const n=t.expectedType;return"array"!==r.kind||0!==r.N||!n||"array"!==n.kind||"number"==typeof n.N&&0!==n.N||(r=n),new oi(r,i)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof At?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof Jt?this.value.serialize():this.value}}class si{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const ai={string:Ot,number:zt,boolean:Ft,object:Nt};class li{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let i,r=1;const n=e[0];if("array"===n){let n,o;if(e.length>2){const i=e[1];if("string"!=typeof i||!(i in ai)||"object"===i)return t.error('The item type argument of "array" must be one of string, number, boolean',1);n=ai[i],r++}else n=jt;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);o=e[2],r++}i=Ht(n,o)}else i=ai[n];const o=[];for(;r<e.length;r++){const i=t.parse(e[r],r,jt);if(!i)return null;o.push(i)}return new li(i,o)}evaluate(e){for(let t=0;t<this.args.length;t++){const i=this.args[t].evaluate(e);if(!qt(this.type,ri(i)))return i;if(t===this.args.length-1)throw new si(`The expression ${JSON.stringify(this.args[t].serialize())} evaluated to ${Wt(ri(i))} but was expected to be of type ${Wt(this.type)}.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}serialize(){const e=this.type,t=[e.kind];if("array"===e.kind){const i=e.itemType;if("string"===i.kind||"number"===i.kind||"boolean"===i.kind){t.push(i.kind);const r=e.N;("number"==typeof r||this.args.length>1)&&t.push(r)}}return t.concat(this.args.map((e=>e.serialize())))}}class ci{constructor(e){this.type=Ut,this.sections=e}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const i=e[1];if(!Array.isArray(i)&&"object"==typeof i)return t.error("First argument must be an image or text section.");const r=[];let n=!1;for(let o=1;o<=e.length-1;++o){const i=e[o];if(n&&"object"==typeof i&&!Array.isArray(i)){n=!1;let e=null;if(i["font-scale"]&&(e=t.parseObjectValue(i["font-scale"],o,"font-scale",zt),!e))return null;let s=null;if(i["text-font"]&&(s=t.parseObjectValue(i["text-font"],o,"text-font",Ht(Ot)),!s))return null;let a=null;if(i["text-color"]&&(a=t.parseObjectValue(i["text-color"],o,"text-color",Bt),!a))return null;const l=r[r.length-1];l.scale=e,l.font=s,l.textColor=a}else{const i=t.parse(e[o],o,jt);if(!i)return null;const s=i.type.kind;if("string"!==s&&"value"!==s&&"null"!==s&&"resolvedImage"!==s)return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");n=!0,r.push({content:i,scale:null,font:null,textColor:null})}}return new ci(r)}evaluate(e){return new Jt(this.sections.map((t=>{const i=t.content.evaluate(e);return ri(i)===Gt?new Kt("",i,null,null,null):new Kt(ni(i),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)})))}eachChild(e){for(const t of this.sections)e(t.content),t.scale&&e(t.scale),t.font&&e(t.font),t.textColor&&e(t.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const t of this.sections){e.push(t.content.serialize());const i={};t.scale&&(i["font-scale"]=t.scale.serialize()),t.font&&(i["text-font"]=t.font.serialize()),t.textColor&&(i["text-color"]=t.textColor.serialize()),e.push(i)}return e}}class ui{constructor(e,t,i,r){this._imageWarnHistory={},this.type=Gt,this.inputPrimary=e,this.inputSecondary=t,this.inputPrimaryParams=i,this.inputSecondaryParams=r}static parse(e,t){if(e.length<2)return t.error("Expected two or more arguments.");let i=1;const r=[];function n(){if(i<e.length){const n=t.parse(e[i],i++,Ot);return n?(r.push({image:n,options:void 0}),!0):(t.error(r.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function o(){if(i<e.length){if(null===(n=e[i])||"object"!=typeof n||Array.isArray(n))return!0;const o=e[i].params,s=t.concat(i);if(!o)return i++,!0;if("object"!=typeof o||o.constructor!==Object)return s.error('Image options "params" should be an object'),!1;const a={},l=s.concat(void 0,"params");for(const e in o){if(!e)return l.error("Image parameter name should be non-empty"),!1;const t=l.concat(void 0,e).parse(o[e],void 0,Bt,void 0,{typeAnnotation:"coerce"});if(!t)return!1;a[e]=t}return r[r.length-1].options=a,i++,!0}var n;return!0}for(let s=0;s<2;s++)if(!n()||!o())return;return new ui(r[0].image,r[1]?r[1].image:void 0,r[0].options,r[1]?r[1].options:void 0)}evaluateParams(e,t){const i={};if(t){for(const r in t)if(t[r])try{const n=t[r].evaluate(e),o=`Ignoring image parameter "${r}" with semi-transparent color ${n.toString()}`;if(1!==n.a){this._imageWarnHistory[o]||(console.warn(o),this._imageWarnHistory[o]=!0);continue}i[r]=n}catch(e){continue}if(0!==Object.keys(i).length)return{params:i}}}evaluate(e){const t=ei.build(this.inputPrimary.evaluate(e),this.inputSecondary?this.inputSecondary.evaluate(e):void 0,this.inputPrimaryParams?this.evaluateParams(e,this.inputPrimaryParams):void 0,this.inputSecondaryParams?this.evaluateParams(e,this.inputSecondaryParams):void 0);return t&&e.availableImages&&(t.available=e.availableImages.indexOf(t.namePrimary)>-1,t.nameSecondary&&t.available&&e.availableImages&&(t.available=e.availableImages.indexOf(t.nameSecondary)>-1)),t}eachChild(e){if(e(this.inputPrimary),this.inputPrimaryParams)for(const t in this.inputPrimaryParams)this.inputPrimaryParams[t]&&e(this.inputPrimaryParams[t]);if(this.inputSecondary&&(e(this.inputSecondary),this.inputSecondaryParams))for(const t in this.inputSecondaryParams)this.inputSecondaryParams[t]&&e(this.inputSecondaryParams[t])}outputDefined(){return!1}serializeParams(e){const t={};if(e){for(const i in e)e[i]&&(t[i]=e[i].serialize());return{params:t}}}serialize(){const e=["image",this.inputPrimary.serialize()];return this.inputPrimaryParams&&e.push(this.serializeParams(this.inputPrimaryParams)),this.inputSecondary&&(e.push(this.inputSecondary.serialize()),this.inputSecondaryParams&&e.push(this.serializeParams(this.inputSecondaryParams))),e}}function hi(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}const di={"to-boolean":Ft,"to-color":Bt,"to-number":zt,"to-string":Ot};class pi{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const i=e[0],r=[];let n=Rt;if("to-array"===i){if(!Array.isArray(e[1]))return null;const i=e[1].length;if(t.expectedType){if("array"!==t.expectedType.kind)return t.error(`Expected ${t.expectedType.kind} but found array.`);n=Ht(t.expectedType.itemType,i)}else{if(!(i>0&&ii(e[1][0])))return null;n=Ht(ri(e[1][0]),i)}for(let o=0;o<i;o++){const i=e[1][o];let s;if("array"===hi(i))s=t.parse(i,void 0,n.itemType);else{const e=hi(i);if(e!==n.itemType.kind)return t.error(`Expected ${n.itemType.kind} but found ${e}.`);s=t.registry.literal.parse(["literal",void 0===i?null:i],t)}if(!s)return null;r.push(s)}}else{if(("to-boolean"===i||"to-string"===i)&&2!==e.length)return t.error("Expected one argument.");n=di[i];for(let i=1;i<e.length;i++){const n=t.parse(e[i],i,jt);if(!n)return null;r.push(n)}}return new pi(n,r)}evaluate(e){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(e));if("color"===this.type.kind){let t,i;for(const r of this.args){if(t=r.evaluate(e),i=null,t instanceof At)return t;if("string"==typeof t){const i=e.parseColor(t);if(i)return i}else if(Array.isArray(t)&&(i=t.length<3||t.length>4?`Invalid rbga value ${JSON.stringify(t)}: expected an array containing either three or four numeric values.`:ti(t[0],t[1],t[2],t[3]),!i))return new At(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new si(i||`Could not parse color from value '${"string"==typeof t?t:String(JSON.stringify(t))}'`)}if("number"===this.type.kind){let t=null;for(const i of this.args){if(t=i.evaluate(e),null===t)return 0;const r=Number(t);if(!isNaN(r))return r}throw new si(`Could not convert ${JSON.stringify(t)} to number.`)}return"formatted"===this.type.kind?Jt.fromString(ni(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?ei.build(ni(this.args[0].evaluate(e))):"array"===this.type.kind?this.args.map((t=>t.evaluate(e))):ni(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}serialize(){if("formatted"===this.type.kind)return new ci([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new ui(this.args[0]).serialize();const e="array"===this.type.kind?[]:[`to-${this.type.kind}`];return this.eachChild((t=>{e.push(t.serialize())})),e}}const fi=["Unknown","Point","LineString","Polygon"];class mi{constructor(e,t){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=e,this.options=t}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?fi[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(e){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const e=this.featureDistanceData.center,t=this.featureDistanceData.scale,{x:i,y:r}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(i*t-e[0])+this.featureDistanceData.bearing[1]*(r*t-e[1])}return 0}parseColor(e){let t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=At.parse(e)),t}getConfig(e){return this.options?this.options.get(e):null}}class gi{constructor(e,t,i,r,n){this.name=e,this.type=t,this._evaluate=i,this.args=r,this._overloadIndex=n}evaluate(e){if(!this._evaluate){const e=gi.definitions[this.name];this._evaluate=Array.isArray(e)?e[2]:e.overloads[this._overloadIndex][1]}return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map((e=>e.serialize())))}static parse(e,t){const i=e[0],r=gi.definitions[i];if(!r)return t.error(`Unknown expression "${i}". If you wanted a literal array, use ["literal", [...]].`,0);const n=Array.isArray(r)?r[0]:r.type,o=Array.isArray(r)?[[r[1],r[2]]]:r.overloads,s=[];let a=null,l=-1;for(const[c,u]of o){if(Array.isArray(c)&&c.length!==e.length-1)continue;s.push(c),l++,a=new Or(t.registry,t.path,null,t.scope,void 0,t._scope,t.options);const r=[];let o=!1;for(let t=1;t<e.length;t++){const i=e[t],n=Array.isArray(c)?c[t-1]:c.type,s=a.parse(i,1+r.length,n);if(!s){o=!0;break}r.push(s)}if(!o)if(Array.isArray(c)&&c.length!==r.length)a.error(`Expected ${c.length} arguments, but found ${r.length} instead.`);else{for(let e=0;e<r.length;e++){const t=Array.isArray(c)?c[e]:c.type,i=r[e];a.concat(e+1).checkSubtype(t,i.type)}if(0===a.errors.length)return new gi(i,n,u,r,l)}}if(1===s.length)t.errors.push(...a.errors);else{const i=(s.length?s:o.map((e=>{let[t]=e;return t}))).map(yi).join(" | "),r=[];for(let n=1;n<e.length;n++){const i=t.parse(e[n],1+r.length);if(!i)return null;r.push(Wt(i.type))}t.error(`Expected arguments of type ${i}, but found (${r.join(", ")}) instead.`)}return null}static register(e,t){gi.definitions=t;for(const i in t)e[i]=gi}}function yi(e){return Array.isArray(e)?`(${e.map(Wt).join(", ")})`:`(${Wt(e.type)}...)`}class _i{constructor(e,t,i){this.type=Vt,this.locale=i,this.caseSensitive=e,this.diacriticSensitive=t}static parse(e,t){if(2!==e.length)return t.error("Expected one argument.");const i=e[1];if("object"!=typeof i||Array.isArray(i))return t.error("Collator options argument must be an object.");const r=void 0===i["case-sensitive"]?t.parse(!1,1,Ft):t.parseObjectValue(i["case-sensitive"],1,"case-sensitive",Ft);if(!r)return null;const n=void 0===i["diacritic-sensitive"]?t.parse(!1,1,Ft):t.parseObjectValue(i["diacritic-sensitive"],1,"diacritic-sensitive",Ft);if(!n)return null;let o=null;return i.locale&&(o=t.parseObjectValue(i.locale,1,"locale",Ot),!o)?null:new _i(r,n,o)}evaluate(e){return new Zt(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}function vi(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length-1,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:bi;for(;r>i;){if(r-i>600){const o=r-i+1,s=t-i+1,a=Math.log(o),l=.5*Math.exp(2*a/3),c=.5*Math.sqrt(a*l*(o-l)/o)*(s-o/2<0?-1:1);vi(e,t,Math.max(i,Math.floor(t-s*l/o+c)),Math.min(r,Math.floor(t+(o-s)*l/o+c)),n)}const o=e[t];let s=i,a=r;for(xi(e,i,t),n(e[r],o)>0&&xi(e,i,r);s<a;){for(xi(e,s,a),s++,a--;n(e[s],o)<0;)s++;for(;n(e[a],o)>0;)a--}0===n(e[i],o)?xi(e,i,a):(a++,xi(e,a,r)),a<=t&&(i=a+1),t<=a&&(r=a-1)}}function xi(e,t,i){const r=e[t];e[t]=e[i],e[i]=r}function bi(e,t){return e<t?-1:e>t?1:0}function wi(e){let t=0;for(let i,r,n=0,o=e.length,s=o-1;n<o;s=n++)i=e[n],r=e[s],t+=(r.x-i.x)*(i.y+r.y);return t}function Si(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function Ti(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function Mi(e,t,i){const r=e[0]-t[0],n=e[1]-t[1],o=e[0]-i[0],s=e[1]-i[1];return r*s-o*n==0&&r*o<=0&&n*s<=0}function Ai(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!1;for(let a=0,l=t.length;a<l;a++){const l=t[a];for(let t=0,a=l.length,c=a-1;t<a;c=t++){const a=l[c],u=l[t];if(Mi(e,a,u))return i;(o=a)[1]>(n=e)[1]!=(s=u)[1]>n[1]&&n[0]<(s[0]-o[0])*(n[1]-o[1])/(s[1]-o[1])+o[0]&&(r=!r)}}var n,o,s;return r}function Ci(e,t,i,r){const n=r[0]-i[0],o=r[1]-i[1],s=(e[0]-i[0])*o-n*(e[1]-i[1]),a=(t[0]-i[0])*o-n*(t[1]-i[1]);return s>0&&a<0||s<0&&a>0}function Ei(e,t,i,r){return 0!=(n=[r[0]-i[0],r[1]-i[1]])[0]*(o=[t[0]-e[0],t[1]-e[1]])[1]-n[1]*o[0]&&!(!Ci(e,t,i,r)||!Ci(i,r,e,t));var n,o}const Pi=8192;function ki(e,t){const i=(180+e[0])/360,r=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,n=Math.pow(2,t.z);return[Math.round(i*n*Pi),Math.round(r*n*Pi)]}function Ii(e,t){for(let i=0;i<t.length;i++)if(Ai(e,t[i]))return!0;return!1}function Di(e,t,i){for(const r of i)for(let i=0,n=r.length,o=n-1;i<n;o=i++)if(Ei(e,t,r[o],r[i]))return!0;return!1}function Li(e,t){for(let i=0;i<e.length;++i)if(!Ai(e[i],t))return!1;for(let i=0;i<e.length-1;++i)if(Di(e[i],e[i+1],t))return!1;return!0}function Ri(e,t){for(let i=0;i<t.length;i++)if(Li(e,t[i]))return!0;return!1}function zi(e,t,i){const r=[];for(let n=0;n<e.length;n++){const o=[];for(let r=0;r<e[n].length;r++){const s=ki(e[n][r],i);Si(t,s),o.push(s)}r.push(o)}return r}function Oi(e,t,i){const r=[];for(let n=0;n<e.length;n++){const o=zi(e[n],t,i);r.push(o)}return r}function Fi(e,t,i,r){if(e[0]<i[0]||e[0]>i[2]){const t=.5*r;let n=e[0]-i[0]>t?-r:i[0]-e[0]>t?r:0;0===n&&(n=e[0]-i[2]>t?-r:i[2]-e[0]>t?r:0),e[0]+=n}Si(t,e)}function Bi(e,t,i,r){const n=Math.pow(2,r.z)*Pi,o=[r.x*Pi,r.y*Pi],s=[];if(!e)return s;for(const a of e)for(const e of a){const r=[e.x+o[0],e.y+o[1]];Fi(r,t,i,n),s.push(r)}return s}function Ni(e,t,i,r){const n=Math.pow(2,r.z)*Pi,o=[r.x*Pi,r.y*Pi],s=[];if(!e)return s;for(const l of e){const e=[];for(const i of l){const r=[i.x+o[0],i.y+o[1]];Si(t,r),e.push(r)}s.push(e)}if(t[2]-t[0]<=n/2){(a=t)[0]=a[1]=1/0,a[2]=a[3]=-1/0;for(const e of s)for(const r of e)Fi(r,t,i,n)}var a;return s}class ji{constructor(e,t){this.type=Ft,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(ii(e[1])){const t=e[1];if("FeatureCollection"===t.type)for(let e=0;e<t.features.length;++e){const i=t.features[e].geometry.type;if("Polygon"===i||"MultiPolygon"===i)return new ji(t,t.features[e].geometry)}else if("Feature"===t.type){const e=t.geometry.type;if("Polygon"===e||"MultiPolygon"===e)return new ji(t,t.geometry)}else if("Polygon"===t.type||"MultiPolygon"===t.type)return new ji(t,t)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){const i=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],n=e.canonicalID();if(!n)return!1;if("Polygon"===t.type){const o=zi(t.coordinates,r,n),s=Bi(e.geometry(),i,r,n);if(!Ti(i,r))return!1;for(const e of s)if(!Ai(e,o))return!1}if("MultiPolygon"===t.type){const o=Oi(t.coordinates,r,n),s=Bi(e.geometry(),i,r,n);if(!Ti(i,r))return!1;for(const e of s)if(!Ii(e,o))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){const i=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],n=e.canonicalID();if(!n)return!1;if("Polygon"===t.type){const o=zi(t.coordinates,r,n),s=Ni(e.geometry(),i,r,n);if(!Ti(i,r))return!1;for(const e of s)if(!Li(e,o))return!1}if("MultiPolygon"===t.type){const o=Oi(t.coordinates,r,n),s=Ni(e.geometry(),i,r,n);if(!Ti(i,r))return!1;for(const e of s)if(!Ri(e,o))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const Vi={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},Ui=1/298.257223563,Gi=Ui*(2-Ui),Hi=Math.PI/180;class Wi{static fromTile(e,t,i){const r=Math.PI*(1-2*(e+.5)/Math.pow(2,t)),n=Math.atan(.5*(Math.exp(r)-Math.exp(-r)))/Hi;return new Wi(n,i)}static get units(){return Vi}constructor(e,t){if(void 0===e)throw new Error("No latitude given.");if(t&&!Vi[t])throw new Error(`Unknown unit ${t}. Use one of: ${Object.keys(Vi).join(", ")}`);const i=6378.137*Hi*(t?Vi[t]:1),r=Math.cos(e*Hi),n=1/(1-Gi*(1-r*r)),o=Math.sqrt(n);this.kx=i*o*r,this.ky=i*o*n*(1-Gi)}distance(e,t){const i=Xi(e[0]-t[0])*this.kx,r=(e[1]-t[1])*this.ky;return Math.sqrt(i*i+r*r)}bearing(e,t){const i=Xi(t[0]-e[0])*this.kx;return Math.atan2(i,(t[1]-e[1])*this.ky)/Hi}destination(e,t,i){const r=i*Hi;return this.offset(e,Math.sin(r)*t,Math.cos(r)*t)}offset(e,t,i){return[e[0]+t/this.kx,e[1]+i/this.ky]}lineDistance(e){let t=0;for(let i=0;i<e.length-1;i++)t+=this.distance(e[i],e[i+1]);return t}area(e){let t=0;for(let i=0;i<e.length;i++){const r=e[i];for(let e=0,n=r.length,o=n-1;e<n;o=e++)t+=Xi(r[e][0]-r[o][0])*(r[e][1]+r[o][1])*(i?-1:1)}return Math.abs(t)/2*this.kx*this.ky}along(e,t){let i=0;if(t<=0)return e[0];for(let r=0;r<e.length-1;r++){const n=e[r],o=e[r+1],s=this.distance(n,o);if(i+=s,i>t)return qi(n,o,(t-(i-s))/s)}return e[e.length-1]}pointToSegmentDistance(e,t,i){let[r,n]=t,o=Xi(i[0]-r)*this.kx,s=(i[1]-n)*this.ky;if(0!==o||0!==s){const t=(Xi(e[0]-r)*this.kx*o+(e[1]-n)*this.ky*s)/(o*o+s*s);t>1?(r=i[0],n=i[1]):t>0&&(r+=o/this.kx*t,n+=s/this.ky*t)}return o=Xi(e[0]-r)*this.kx,s=(e[1]-n)*this.ky,Math.sqrt(o*o+s*s)}pointOnLine(e,t){let i=1/0,r=e[0][0],n=e[0][1],o=0,s=0;for(let a=0;a<e.length-1;a++){let l=e[a][0],c=e[a][1],u=Xi(e[a+1][0]-l)*this.kx,h=(e[a+1][1]-c)*this.ky,d=0;0===u&&0===h||(d=(Xi(t[0]-l)*this.kx*u+(t[1]-c)*this.ky*h)/(u*u+h*h),d>1?(l=e[a+1][0],c=e[a+1][1]):d>0&&(l+=u/this.kx*d,c+=h/this.ky*d)),u=Xi(t[0]-l)*this.kx,h=(t[1]-c)*this.ky;const p=u*u+h*h;p<i&&(i=p,r=l,n=c,o=a,s=d)}return{point:[r,n],index:o,t:Math.max(0,Math.min(1,s))}}lineSlice(e,t,i){let r=this.pointOnLine(i,e),n=this.pointOnLine(i,t);if(r.index>n.index||r.index===n.index&&r.t>n.t){const e=r;r=n,n=e}const o=[r.point],s=r.index+1,a=n.index;!$i(i[s],o[0])&&s<=a&&o.push(i[s]);for(let l=s+1;l<=a;l++)o.push(i[l]);return $i(i[a],n.point)||o.push(n.point),o}lineSliceAlong(e,t,i){let r=0;const n=[];for(let o=0;o<i.length-1;o++){const s=i[o],a=i[o+1],l=this.distance(s,a);if(r+=l,r>e&&0===n.length&&n.push(qi(s,a,(e-(r-l))/l)),r>=t)return n.push(qi(s,a,(t-(r-l))/l)),n;r>e&&n.push(a)}return n}bufferPoint(e,t){const i=t/this.ky,r=t/this.kx;return[e[0]-r,e[1]-i,e[0]+r,e[1]+i]}bufferBBox(e,t){const i=t/this.ky,r=t/this.kx;return[e[0]-r,e[1]-i,e[2]+r,e[3]+i]}insideBBox(e,t){return Xi(e[0]-t[0])>=0&&Xi(e[0]-t[2])<=0&&e[1]>=t[1]&&e[1]<=t[3]}}function $i(e,t){return e[0]===t[0]&&e[1]===t[1]}function qi(e,t,i){const r=Xi(t[0]-e[0]);return[e[0]+r*i,e[1]+(t[1]-e[1])*i]}function Xi(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}class Yi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e,t)=>e<t?-1:e>t?1:0;if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let i=(this.length>>1)-1;i>=0;i--)this._down(i)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(0===this.length)return;const e=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:i}=this,r=t[e];for(;e>0;){const n=e-1>>1,o=t[n];if(i(r,o)>=0)break;t[e]=o,e=n}t[e]=r}_down(e){const{data:t,compare:i}=this,r=this.length>>1,n=t[e];for(;e<r;){let r=1+(e<<1);const o=r+1;if(o<this.length&&i(t[o],t[r])<0&&(r=o),i(t[r],n)>=0)break;t[e]=t[r],e=r}t[e]=n}}var Zi=8192;function Ki(e,t){return t.dist-e.dist}const Ji=100,Qi=50;function er(e){const t=[1/0,1/0,-1/0,-1/0];if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}function tr(e){return e[1]-e[0]+1}function ir(e,t){const i=e[1]>=e[0]&&e[1]<t;return i||console.warn("Distance Expression: Index is out of range"),i}function rr(e,t){if(e[0]>e[1])return[null,null];const i=tr(e);if(t){if(2===i)return[e,null];const t=Math.floor(i/2);return[[e[0],e[0]+t],[e[0]+t,e[1]]]}{if(1===i)return[e,null];const t=Math.floor(i/2)-1;return[[e[0],e[0]+t],[e[0]+t+1,e[1]]]}}function nr(e,t){const i=[1/0,1/0,-1/0,-1/0];if(!ir(t,e.length))return i;for(let r=t[0];r<=t[1];++r)Si(i,e[r]);return i}function or(e){const t=[1/0,1/0,-1/0,-1/0];for(let i=0;i<e.length;++i)for(let r=0;r<e[i].length;++r)Si(t,e[i][r]);return t}function sr(e,t,i){if(er(e)||er(t))return NaN;let r=0,n=0;return e[2]<t[0]&&(r=t[0]-e[2]),e[0]>t[2]&&(r=e[0]-t[2]),e[1]>t[3]&&(n=e[1]-t[3]),e[3]<t[1]&&(n=t[1]-e[3]),i.distance([0,0],[r,n])}function ar(e){return 360*e-180}function lr(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}function cr(e,t){const i=Math.pow(2,t.z),r=(e.y/Zi+t.y)/i;return[ar((e.x/Zi+t.x)/i),lr(r)]}function ur(e,t){const i=[];for(let r=0;r<e.length;++r)i.push(cr(e[r],t));return i}function hr(e,t,i){const r=i.pointOnLine(t,e).point;return i.distance(e,r)}function dr(e,t,i,r,n){const o=i.slice(r[0],r[1]+1);let s=1/0;for(let a=t[0];a<=t[1];++a)if(0===(s=Math.min(s,hr(e[a],o,n))))return 0;return s}function pr(e,t,i,r,n){const o=Math.min(n.pointToSegmentDistance(e,i,r),n.pointToSegmentDistance(t,i,r)),s=Math.min(n.pointToSegmentDistance(i,e,t),n.pointToSegmentDistance(r,e,t));return Math.min(o,s)}function fr(e,t,i,r,n){if(!ir(t,e.length)||!ir(r,i.length))return NaN;let o=1/0;for(let s=t[0];s<t[1];++s)for(let t=r[0];t<r[1];++t){if(Ei(e[s],e[s+1],i[t],i[t+1]))return 0;o=Math.min(o,pr(e[s],e[s+1],i[t],i[t+1],n))}return o}function mr(e,t,i,r,n){if(!ir(t,e.length)||!ir(r,i.length))return NaN;let o=1/0;for(let s=t[0];s<=t[1];++s)for(let t=r[0];t<=r[1];++t)if(0===(o=Math.min(o,n.distance(e[s],i[t]))))return o;return o}function gr(e,t,i){if(Ai(e,t,!0))return 0;let r=1/0;for(const n of t){const t=n.length;if(t<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(n[0]!==n[t-1]&&0===(r=Math.min(r,i.pointToSegmentDistance(e,n[t-1],n[0]))))return r;if(0===(r=Math.min(r,hr(e,n,i))))return r}return r}function yr(e,t,i,r){if(!ir(t,e.length))return NaN;for(let o=t[0];o<=t[1];++o)if(Ai(e[o],i,!0))return 0;let n=1/0;for(let o=t[0];o<t[1];++o)for(const t of i)for(let i=0,s=t.length,a=s-1;i<s;a=i++){if(Ei(e[o],e[o+1],t[a],t[i]))return 0;n=Math.min(n,pr(e[o],e[o+1],t[a],t[i],r))}return n}function _r(e,t){for(const i of e)for(let e=0;e<=i.length-1;++e)if(Ai(i[e],t,!0))return!0;return!1}function vr(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;const n=or(e),o=or(t);if(r!==1/0&&sr(n,o,i)>=r)return r;if(Ti(n,o)){if(_r(e,t))return 0}else if(_r(t,e))return 0;let s=r;for(const a of e)for(let e=0,r=a.length,n=r-1;e<r;n=e++)for(const o of t)for(let t=0,r=o.length,l=r-1;t<r;l=t++){if(Ei(a[n],a[e],o[l],o[t]))return 0;s=Math.min(s,pr(a[n],a[e],o[l],o[t],i))}return s}function xr(e,t,i,r,n,o,s){if(null===o||null===s)return;const a=sr(nr(r,o),nr(n,s),i);a<t&&e.push({dist:a,range1:o,range2:s})}function br(e,t,i,r){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0,o=Math.min(r.distance(e[0],i[0][0]),n);if(0===o)return o;const s=new Yi([{dist:0,range1:[0,e.length-1],range2:[0,0]}],Ki),a=t?Qi:Ji,l=or(i);for(;s.length;){const n=s.pop();if(n.dist>=o)continue;const c=n.range1;if(tr(c)<=a){if(!ir(c,e.length))return NaN;if(t){const t=yr(e,c,i,r);if(0===(o=Math.min(o,t)))return o}else for(let t=c[0];t<=c[1];++t){const n=gr(e[t],i,r);if(0===(o=Math.min(o,n)))return o}}else{const i=rr(c,t);if(null!==i[0]){const t=sr(nr(e,i[0]),l,r);t<o&&s.push({dist:t,range1:i[0],range2:[0,0]})}if(null!==i[1]){const t=sr(nr(e,i[1]),l,r);t<o&&s.push({dist:t,range1:i[1],range2:[0,0]})}}}return o}function wr(e,t,i,r,n){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1/0,s=Math.min(o,n.distance(e[0],i[0]));if(0===s)return s;const a=new Yi([{dist:0,range1:[0,e.length-1],range2:[0,i.length-1]}],Ki),l=t?Qi:Ji,c=r?Qi:Ji;for(;a.length;){const o=a.pop();if(o.dist>=s)continue;const u=o.range1,h=o.range2;if(tr(u)<=l&&tr(h)<=c){if(!ir(u,e.length)||!ir(h,i.length))return NaN;if(t&&r?s=Math.min(s,fr(e,u,i,h,n)):t||r?t&&!r?s=Math.min(s,dr(i,h,e,u,n)):!t&&r&&(s=Math.min(s,dr(e,u,i,h,n))):s=Math.min(s,mr(e,u,i,h,n)),0===s)return s}else{const o=rr(u,t),l=rr(h,r);xr(a,s,n,e,i,o[0],l[0]),xr(a,s,n,e,i,o[0],l[1]),xr(a,s,n,e,i,o[1],l[0]),xr(a,s,n,e,i,o[1],l[1])}}return s}function Sr(e,t,i,r){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0;const o=nr(e,[0,e.length-1]);for(const s of i)if(!(n!==1/0&&sr(o,nr(s,[0,s.length-1]),r)>=n)&&(n=Math.min(n,wr(e,t,s,!0,r,n)),0===n))return n;return n}function Tr(e,t,i,r){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0;const o=nr(e,[0,e.length-1]);for(const s of i){if(n!==1/0&&sr(o,or(s),r)>=n)continue;const i=br(e,t,s,r,n);if(isNaN(i))return i;if(0===(n=Math.min(n,i)))return n}return n}function Mr(e){return"Point"===e||"MultiPoint"===e||"LineString"===e||"MultiLineString"===e||"Polygon"===e||"MultiPolygon"===e}class Ar{constructor(e,t){this.type=zt,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error(`'distance' expression requires either one argument, but found ' ${e.length-1} instead.`);if(ii(e[1])){const t=e[1];if("FeatureCollection"===t.type){for(let e=0;e<t.features.length;++e)if(Mr(t.features[e].geometry.type))return new Ar(t,t.features[e].geometry)}else if("Feature"===t.type){if(Mr(t.geometry.type))return new Ar(t,t.geometry)}else if(Mr(t.type))return new Ar(t,t)}return t.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(e){const t=e.geometry(),i=e.canonicalID();if(null!=t&&null!=i){if("Point"===e.geometryType())return function(e,t,i){const r=[];for(const o of e)for(const e of o)r.push(cr(e,t));const n=new Wi(r[0][1],"meters");return"Point"===i.type||"MultiPoint"===i.type||"LineString"===i.type?wr(r,!1,"Point"===i.type?[i.coordinates]:i.coordinates,"LineString"===i.type,n):"MultiLineString"===i.type?Sr(r,!1,i.coordinates,n):"Polygon"===i.type||"MultiPolygon"===i.type?Tr(r,!1,"Polygon"===i.type?[i.coordinates]:i.coordinates,n):null}(t,i,this.geometries);if("LineString"===e.geometryType())return function(e,t,i){const r=[];for(const o of e){const e=[];for(const i of o)e.push(cr(i,t));r.push(e)}const n=new Wi(r[0][0][1],"meters");if("Point"===i.type||"MultiPoint"===i.type||"LineString"===i.type)return Sr("Point"===i.type?[i.coordinates]:i.coordinates,"LineString"===i.type,r,n);if("MultiLineString"===i.type){let e=1/0;for(let t=0;t<i.coordinates.length;t++){const o=Sr(i.coordinates[t],!0,r,n,e);if(isNaN(o))return o;if(0===(e=Math.min(e,o)))return e}return e}if("Polygon"===i.type||"MultiPolygon"===i.type){let e=1/0;for(let t=0;t<r.length;t++){const o=Tr(r[t],!0,"Polygon"===i.type?[i.coordinates]:i.coordinates,n,e);if(isNaN(o))return o;if(0===(e=Math.min(e,o)))return e}return e}return null}(t,i,this.geometries);if("Polygon"===e.geometryType())return function(e,t,i){const r=[];for(const o of function(e){const t=e.length;if(t<=1)return[e];const i=[];let r,n;for(let o=0;o<t;o++){const t=wi(e[o]);0!==t&&(e[o].area=Math.abs(t),void 0===n&&(n=t<0),n===t<0?(r&&i.push(r),r=[e[o]]):r.push(e[o]))}return r&&i.push(r),i}(e)){const e=[];for(let i=0;i<o.length;++i)e.push(ur(o[i],t));r.push(e)}const n=new Wi(r[0][0][0][1],"meters");if("Point"===i.type||"MultiPoint"===i.type||"LineString"===i.type)return Tr("Point"===i.type?[i.coordinates]:i.coordinates,"LineString"===i.type,r,n);if("MultiLineString"===i.type){let e=1/0;for(let t=0;t<i.coordinates.length;t++){const o=Tr(i.coordinates[t],!0,r,n,e);if(isNaN(o))return o;if(0===(e=Math.min(e,o)))return e}return e}return"Polygon"===i.type||"MultiPolygon"===i.type?function(e,t,i){let r=1/0;for(const n of e)for(const e of t){const t=vr(n,e,i,r);if(isNaN(t))return t;if(0===(r=Math.min(r,t)))return r}return r}("Polygon"===i.type?[i.coordinates]:i.coordinates,r,n):null}(t,i,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Cr(e,t){switch(e){case"string":return ni(t);case"number":return+t;case"boolean":return!!t;case"color":return At.parse(t);case"formatted":return Jt.fromString(ni(t));case"resolvedImage":return ei.build(ni(t))}return t}function Er(e,t,i,r){return void 0!==r&&(e=r*Math.round(e/r)),void 0!==t&&e<t&&(e=t),void 0!==i&&e>i&&(e=i),e}class Pr{constructor(e,t,i){this.type=e,this.key=t,this.scope=i}static parse(e,t){let i=t.expectedType;if(null==i&&(i=jt),e.length<2||e.length>3)return t.error("Invalid number of arguments for 'config' expression.");const r=t.parse(e[1],1);if(!(r instanceof oi))return t.error("Key name of 'config' expression must be a string literal.");if(e.length>=3){const n=t.parse(e[2],2);return n instanceof oi?new Pr(i,ni(r.value),ni(n.value)):t.error("Scope of 'config' expression must be a string literal.")}return new Pr(i,ni(r.value))}evaluate(e){const t=[this.key,this.scope,e.scope].filter(Boolean).join("\x1f"),i=e.getConfig(t);if(!i)return null;const{type:r,value:n,values:o,minValue:s,maxValue:a,stepValue:l}=i,c=i.default.evaluate(e);let u=c;if(n){const t=e.scope;e.scope=(t||"").split("\x1f").slice(1).join("\x1f"),u=n.evaluate(e),e.scope=t}return r&&(u=Cr(r,u)),void 0===u||void 0===s&&void 0===a&&void 0===l||("number"==typeof u?u=Er(u,s,a,l):Array.isArray(u)&&(u=u.map((e=>"number"==typeof e?Er(e,s,a,l):e)))),void 0!==n&&void 0!==u&&o&&!o.includes(u)&&(u=c,r&&(u=Cr(r,u))),(r&&r!==this.type||void 0!==u&&ri(u)!==this.type)&&(u=Cr(this.type.kind,u)),u}eachChild(){}outputDefined(){return!1}serialize(){const e=["config",this.key];return this.scope&&e.concat(this.key),e}}function kr(e){if(e instanceof gi){if("get"===e.name&&1===e.args.length)return!1;if("feature-state"===e.name)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof ji)return!1;if(e instanceof Ar)return!1;let t=!0;return e.eachChild((e=>{t&&!kr(e)&&(t=!1)})),t}function Ir(e){if(e instanceof gi&&"feature-state"===e.name)return!1;let t=!0;return e.eachChild((e=>{t&&!Ir(e)&&(t=!1)})),t}function Dr(e){if(e instanceof Pr)return new Set([e.key]);let t=new Set;return e.eachChild((e=>{t=new Set([...t,...Dr(e)])})),t}function Lr(e,t){if(e instanceof gi&&t.indexOf(e.name)>=0)return!1;let i=!0;return e.eachChild((e=>{i&&!Lr(e,t)&&(i=!1)})),i}class Rr{constructor(e,t){this.type=t.type,this.name=e,this.boundExpression=t}static parse(e,t){if(2!==e.length||"string"!=typeof e[1])return t.error("'var' expression requires exactly one string literal argument.");const i=e[1];return t.scope.has(i)?new Rr(i,t.scope.get(i)):t.error(`Unknown variable "${i}". Make sure "${i}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class zr{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Lt,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0;this.registry=e,this.path=t,this.key=t.map((e=>"string"==typeof e?`['${e}']`:`[${e}]`)).join(""),this.scope=r,this.errors=n,this.expectedType=i,this._scope=o,this.options=s}parse(e,t,i,r){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return t||i?this.concat(t,null,i,r)._parse(e,n):this._parse(e,n)}parseObjectValue(e,t,i,r,n){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};return this.concat(t,i,r,n)._parse(e,o)}_parse(e,t){function i(e,t,i){return"assert"===i?new li(t,[e]):"coerce"===i?new pi(t,[e]):e}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const r="string"==typeof e[0]?this.registry[e[0]]:void 0;if(r){let n=r.parse(e,this);if(!n)return null;if(this.expectedType){const e=this.expectedType,r=n.type;if("string"!==e.kind&&"number"!==e.kind&&"boolean"!==e.kind&&"object"!==e.kind&&"array"!==e.kind||"value"!==r.kind)if("color"!==e.kind&&"formatted"!==e.kind&&"resolvedImage"!==e.kind||"value"!==r.kind&&"string"!==r.kind){if(this.checkSubtype(e,r))return null}else n=i(n,e,t.typeAnnotation||"coerce");else n=i(n,e,t.typeAnnotation||"assert")}if(!(n instanceof oi)&&"resolvedImage"!==n.type.kind&&Fr(n)){const t=new mi(this._scope,this.options);try{n=new oi(n.type,n.evaluate(t))}catch(e){return this.error(e.message),null}}return n}return pi.parse(["to-array",e],this)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,t,i,r){let n="number"==typeof e?this.path.concat(e):this.path;n="string"==typeof t?n.concat(t):n;const o=r?this.scope.concat(r):this.scope;return new zr(this.registry,n,i||null,o,this.errors,this._scope,this.options)}error(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];const n=`${this.key}${i.map((e=>`[${e}]`)).join("")}`;this.errors.push(new Dt(n,e))}checkSubtype(e,t){const i=qt(e,t);return i&&this.error(i),i}}var Or=zr;function Fr(e){if(e instanceof Rr)return Fr(e.boundExpression);if(e instanceof gi&&"error"===e.name)return!1;if(e instanceof _i)return!1;if(e instanceof ji)return!1;if(e instanceof Ar)return!1;if(e instanceof Pr)return!1;const t=e instanceof pi||e instanceof li;let i=!0;return e.eachChild((e=>{i=t?i&&Fr(e):i&&e instanceof oi})),!!i&&kr(e)&&Lr(e,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function Br(e,t){const i=e.length-1;let r,n,o=0,s=i,a=0;for(;o<=s;)if(a=Math.floor((o+s)/2),r=e[a],n=e[a+1],r<=t){if(a===i||t<n)return a;o=a+1}else{if(!(r>t))throw new si("Input is not a number.");s=a-1}return 0}class Nr{constructor(e,t,i){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(const[r,n]of i)this.labels.push(r),this.outputs.push(n)}static parse(e,t){if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");const i=t.parse(e[1],1,zt);if(!i)return null;const r=[];let n=null;t.expectedType&&"value"!==t.expectedType.kind&&(n=t.expectedType);for(let o=1;o<e.length;o+=2){const i=1===o?-1/0:e[o],s=e[o+1],a=o,l=o+1;if("number"!=typeof i)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',a);if(r.length&&r[r.length-1][0]>=i)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',a);const c=t.parse(s,l,n);if(!c)return null;n=n||c.type,r.push([i,c])}return new Nr(n,i,r)}evaluate(e){const t=this.labels,i=this.outputs;if(1===t.length)return i[0].evaluate(e);const r=this.input.evaluate(e);if(r<=t[0])return i[0].evaluate(e);const n=t.length;return r>=t[n-1]?i[n-1].evaluate(e):i[Br(t,r)].evaluate(e)}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}serialize(){const e=["step",this.input.serialize()];for(let t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e}}const jr=.95047,Vr=1.08883,Ur=4/29,Gr=6/29,Hr=3*Gr*Gr,Wr=Gr*Gr*Gr,$r=Math.PI/180,qr=180/Math.PI;function Xr(e){return e>Wr?Math.pow(e,1/3):e/Hr+Ur}function Yr(e){return e>Gr?e*e*e:Hr*(e-Ur)}function Zr(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Kr(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Jr(e){const t=Kr(e.r),i=Kr(e.g),r=Kr(e.b),n=Xr((.4124564*t+.3575761*i+.1804375*r)/jr),o=Xr((.2126729*t+.7151522*i+.072175*r)/1);return{l:116*o-16,a:500*(n-o),b:200*(o-Xr((.0193339*t+.119192*i+.9503041*r)/Vr)),alpha:e.a}}function Qr(e){let t=(e.l+16)/116,i=isNaN(e.a)?t:t+e.a/500,r=isNaN(e.b)?t:t-e.b/200;return t=1*Yr(t),i=jr*Yr(i),r=Vr*Yr(r),new At(Zr(3.2404542*i-1.5371385*t-.4985314*r),Zr(-.969266*i+1.8760108*t+.041556*r),Zr(.0556434*i-.2040259*t+1.0572252*r),e.alpha)}function en(e,t,i){const r=t-e;return e+i*(r>180||r<-180?r-360*Math.round(r/360):r)}const tn={forward:Jr,reverse:Qr,interpolate:function(e,t,i){return{l:Et(e.l,t.l,i),a:Et(e.a,t.a,i),b:Et(e.b,t.b,i),alpha:Et(e.alpha,t.alpha,i)}}},rn={forward:function(e){const{l:t,a:i,b:r}=Jr(e),n=Math.atan2(r,i)*qr;return{h:n<0?n+360:n,c:Math.sqrt(i*i+r*r),l:t,alpha:e.a}},reverse:function(e){const t=e.h*$r,i=e.c;return Qr({l:e.l,a:Math.cos(t)*i,b:Math.sin(t)*i,alpha:e.alpha})},interpolate:function(e,t,i){return{h:en(e.h,t.h,i),c:Et(e.c,t.c,i),l:Et(e.l,t.l,i),alpha:Et(e.alpha,t.alpha,i)}}};var nn=Object.freeze({__proto__:null,hcl:rn,lab:tn});class on{constructor(e,t,i,r,n,o){this.type=e,this.operator=t,this.interpolation=i,this.input=r,this.dynamicStops=n,this.labels=[],this.outputs=[];for(const[s,a]of o)this.labels.push(s),this.outputs.push(a)}static interpolationFactor(e,t,i,r){let n=0;if("exponential"===e.name)n=sn(t,e.base,i,r);else if("linear"===e.name)n=sn(t,1,i,r);else if("cubic-bezier"===e.name){const o=e.controlPoints;n=new V(o[0],o[1],o[2],o[3]).solve(sn(t,1,i,r))}return n}static parse(e,t){let[i,r,n,...o]=e;if(!Array.isArray(r)||0===r.length)return t.error("Expected an interpolation type expression.",1);if("linear"===r[0])r={name:"linear"};else if("exponential"===r[0]){const e=r[1];if("number"!=typeof e)return t.error("Exponential interpolation requires a numeric base.",1,1);r={name:"exponential",base:e}}else{if("cubic-bezier"!==r[0])return t.error(`Unknown interpolation type ${String(r[0])}`,1,0);{const e=r.slice(1);if(4!==e.length||e.some((e=>"number"!=typeof e||e<0||e>1)))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);r={name:"cubic-bezier",controlPoints:e}}}if(e.length-1<3)return t.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length-1>3&&(e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(n=t.parse(n,2,zt),!n)return null;const s=[];let a=null;if("interpolate-hcl"===i||"interpolate-lab"===i?a=Bt:t.expectedType&&"value"!==t.expectedType.kind&&(a=t.expectedType),e.length-1==3){const e=t.parse(o[0],3,jt);return e?new on(a,i,r,n,e,s):null}for(let l=0;l<o.length;l+=2){const e=o[l],i=o[l+1],r=l+3,n=l+4;if("number"!=typeof e)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',r);if(s.length&&s[s.length-1][0]>=e)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',r);const c=t.parse(i,n,a);if(!c)return null;a=a||c.type,s.push([e,c])}return"number"===a.kind||"color"===a.kind||"array"===a.kind&&"number"===a.itemType.kind&&"number"==typeof a.N?new on(a,i,r,n,null,s):t.error(`Type ${Wt(a)} is not interpolatable.`)}evaluate(e){let t=this.labels,i=this.outputs;if(this.dynamicStops){const r=this.dynamicStops.evaluate(e);if(r.length%2!=0)throw new si("Expected an even number of arguments.");t=[],i=[];for(let e=0;e<r.length;e+=2){const n=r[e],o=new oi(zt,r[e+1]);if("number"!=typeof n)throw new si('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.');if(t.length&&t[t.length-1]>=n)throw new si('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.');t.push(n),i.push(o)}if(0===t.length)throw new si("Expected at least one input/output pair.")}if(1===t.length)return i[0].evaluate(e);const r=this.input.evaluate(e);if(r<=t[0])return i[0].evaluate(e);const n=t.length;if(r>=t[n-1])return i[n-1].evaluate(e);const o=Br(t,r),s=on.interpolationFactor(this.interpolation,r,t[o],t[o+1]),a=i[o].evaluate(e),l=i[o+1].evaluate(e);return"interpolate"===this.operator?kt[this.type.kind.toLowerCase()](a,l,s):"interpolate-hcl"===this.operator?rn.reverse(rn.interpolate(rn.forward(a),rn.forward(l),s)):tn.reverse(tn.interpolate(tn.forward(a),tn.forward(l),s))}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}serialize(){let e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const t=[this.operator,e,this.input.serialize()];if(this.dynamicStops)t.push(this.dynamicStops.serialize());else for(let i=0;i<this.labels.length;i++)t.push(this.labels[i],this.outputs[i].serialize());return t}}function sn(e,t,i,r){const n=r-i,o=e-i;return 0===n?0:1===t?o/n:(Math.pow(t,o)-1)/(Math.pow(t,n)-1)}class an{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expectected at least one argument.");let i=null;const r=t.expectedType;r&&"value"!==r.kind&&(i=r);const n=[];for(const s of e.slice(1)){const e=t.parse(s,1+n.length,i,void 0,{typeAnnotation:"omit"});if(!e)return null;i=i||e.type,n.push(e)}const o=r&&n.some((e=>qt(r,e.type)));return new an(o?jt:i,n)}evaluate(e){let t,i=null,r=0;for(const n of this.args){if(r++,i=n.evaluate(e),i&&i instanceof ei&&!i.available&&(t||(t=i),i=null,r===this.args.length))return t;if(null!==i)break}return i}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}serialize(){const e=["coalesce"];return this.eachChild((t=>{e.push(t.serialize())})),e}}class ln{constructor(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const t of this.bindings)e(t[1]);e(this.result)}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const i=[];for(let n=1;n<e.length-1;n+=2){const r=e[n];if("string"!=typeof r)return t.error(`Expected string, but found ${typeof r} instead.`,n);if(/[^a-zA-Z0-9_]/.test(r))return t.error("Variable names must contain only alphanumeric characters or '_'.",n);const o=t.parse(e[n+1],n+1);if(!o)return null;i.push([r,o])}const r=t.parse(e[e.length-1],e.length-1,t.expectedType,i);return r?new ln(i,r):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[t,i]of this.bindings)e.push(t,i.serialize());return e.push(this.result.serialize()),e}}class cn{constructor(e,t,i){this.type=e,this.index=t,this.input=i}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const i=t.parse(e[1],1,zt),r=t.parse(e[2],2,Ht(t.expectedType||jt));return i&&r?new cn(r.type.itemType,i,r):null}evaluate(e){const t=this.index.evaluate(e),i=this.input.evaluate(e);if(t<0)throw new si(`Array index out of bounds: ${t} < 0.`);if(t>i.length-1)throw new si(`Array index out of bounds: ${t} > ${i.length-1}.`);if(t===Math.floor(t))return i[t];const r=Math.floor(t),n=Math.ceil(t),o=i[r],s=i[n];if("number"!=typeof o||"number"!=typeof s)throw new si(`Cannot interpolate between non-number values at index ${t}.`);const a=t-r;return o*(1-a)+s*a}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class un{constructor(e,t){this.type=Ft,this.needle=e,this.haystack=t}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const i=t.parse(e[1],1,jt),r=t.parse(e[2],2,jt);return i&&r?Xt(i.type,[Ft,Ot,zt,Rt,jt])?new un(i,r):t.error(`Expected first argument to be of type boolean, string, number or null, but found ${Wt(i.type)} instead`):null}evaluate(e){const t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(null==i)return!1;if(!Yt(t,["boolean","string","number","null"]))throw new si(`Expected first argument to be of type boolean, string, number or null, but found ${Wt(ri(t))} instead.`);if(!Yt(i,["string","array"]))throw new si(`Expected second argument to be of type array or string, but found ${Wt(ri(i))} instead.`);return i.indexOf(t)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class hn{constructor(e,t,i){this.type=zt,this.needle=e,this.haystack=t,this.fromIndex=i}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const i=t.parse(e[1],1,jt),r=t.parse(e[2],2,jt);if(!i||!r)return null;if(!Xt(i.type,[Ft,Ot,zt,Rt,jt]))return t.error(`Expected first argument to be of type boolean, string, number or null, but found ${Wt(i.type)} instead`);if(4===e.length){const n=t.parse(e[3],3,zt);return n?new hn(i,r,n):null}return new hn(i,r)}evaluate(e){const t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!Yt(t,["boolean","string","number","null"]))throw new si(`Expected first argument to be of type boolean, string, number or null, but found ${Wt(ri(t))} instead.`);if(!Yt(i,["string","array"]))throw new si(`Expected second argument to be of type array or string, but found ${Wt(ri(i))} instead.`);if(this.fromIndex){const r=this.fromIndex.evaluate(e);return i.indexOf(t,r)}return i.indexOf(t)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class dn{constructor(e,t,i,r,n,o){this.inputType=e,this.type=t,this.input=i,this.cases=r,this.outputs=n,this.otherwise=o}static parse(e,t){if(e.length<5)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return t.error("Expected an even number of arguments.");let i,r;t.expectedType&&"value"!==t.expectedType.kind&&(r=t.expectedType);const n={},o=[];for(let l=2;l<e.length-1;l+=2){let s=e[l];const a=e[l+1];Array.isArray(s)||(s=[s]);const c=t.concat(l);if(0===s.length)return c.error("Expected at least one branch label.");for(const e of s){if("number"!=typeof e&&"string"!=typeof e)return c.error("Branch labels must be numbers or strings.");if("number"==typeof e&&Math.abs(e)>Number.MAX_SAFE_INTEGER)return c.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof e&&Math.floor(e)!==e)return c.error("Numeric branch labels must be integer values.");if(i){if(c.checkSubtype(i,ri(e)))return null}else i=ri(e);if(void 0!==n[String(e)])return c.error("Branch labels must be unique.");n[String(e)]=o.length}const u=t.parse(a,l,r);if(!u)return null;r=r||u.type,o.push(u)}const s=t.parse(e[1],1,jt);if(!s)return null;const a=t.parse(e[e.length-1],e.length-1,r);return a?"value"!==s.type.kind&&t.concat(1).checkSubtype(i,s.type)?null:new dn(i,r,s,n,o,a):null}evaluate(e){const t=this.input.evaluate(e);return(ri(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],t=Object.keys(this.cases).sort(),i=[],r={};for(const o of t){const e=r[this.cases[o]];void 0===e?(r[this.cases[o]]=i.length,i.push([this.cases[o],[o]])):i[e][1].push(o)}const n=e=>"number"===this.inputType.kind?Number(e):e;for(const[o,s]of i)e.push(1===s.length?n(s[0]):s.map(n)),e.push(this.outputs[o].serialize());return e.push(this.otherwise.serialize()),e}}class pn{constructor(e,t,i){this.type=e,this.branches=t,this.otherwise=i}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return t.error("Expected an odd number of arguments.");let i;t.expectedType&&"value"!==t.expectedType.kind&&(i=t.expectedType);const r=[];for(let o=1;o<e.length-1;o+=2){const n=t.parse(e[o],o,Ft);if(!n)return null;const s=t.parse(e[o+1],o+1,i);if(!s)return null;r.push([n,s]),i=i||s.type}const n=t.parse(e[e.length-1],e.length-1,i);return n?new pn(i,r,n):null}evaluate(e){for(const[t,i]of this.branches)if(t.evaluate(e))return i.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[t,i]of this.branches)e(t),e(i);e(this.otherwise)}outputDefined(){return this.branches.every((e=>{let[t,i]=e;return i.outputDefined()}))&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild((t=>{e.push(t.serialize())})),e}}class fn{constructor(e,t,i,r){this.type=e,this.input=t,this.beginIndex=i,this.endIndex=r}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const i=t.parse(e[1],1,jt),r=t.parse(e[2],2,zt);if(!i||!r)return null;if(!Xt(i.type,[Ht(jt),Ot,jt]))return t.error(`Expected first argument to be of type array or string, but found ${Wt(i.type)} instead`);if(4===e.length){const n=t.parse(e[3],3,zt);return n?new fn(i.type,i,r,n):null}return new fn(i.type,i,r)}evaluate(e){const t=this.input.evaluate(e),i=this.beginIndex.evaluate(e);if(!Yt(t,["string","array"]))throw new si(`Expected first argument to be of type array or string, but found ${Wt(ri(t))} instead.`);if(this.endIndex){const r=this.endIndex.evaluate(e);return t.slice(i,r)}return t.slice(i)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function mn(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function gn(e,t,i,r){return 0===r.compare(t,i)}function yn(e,t,i){const r="=="!==e&&"!="!==e;return class n{constructor(e,t,i){this.type=Ft,this.lhs=e,this.rhs=t,this.collator=i,this.hasUntypedArgument="value"===e.type.kind||"value"===t.type.kind}static parse(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");const i=e[0];let o=t.parse(e[1],1,jt);if(!o)return null;if(!mn(i,o.type))return t.concat(1).error(`"${i}" comparisons are not supported for type '${Wt(o.type)}'.`);let s=t.parse(e[2],2,jt);if(!s)return null;if(!mn(i,s.type))return t.concat(2).error(`"${i}" comparisons are not supported for type '${Wt(s.type)}'.`);if(o.type.kind!==s.type.kind&&"value"!==o.type.kind&&"value"!==s.type.kind)return t.error(`Cannot compare types '${Wt(o.type)}' and '${Wt(s.type)}'.`);r&&("value"===o.type.kind&&"value"!==s.type.kind?o=new li(s.type,[o]):"value"!==o.type.kind&&"value"===s.type.kind&&(s=new li(o.type,[s])));let a=null;if(4===e.length){if("string"!==o.type.kind&&"string"!==s.type.kind&&"value"!==o.type.kind&&"value"!==s.type.kind)return t.error("Cannot use collator to compare non-string types.");if(a=t.parse(e[3],3,Vt),!a)return null}return new n(o,s,a)}evaluate(n){const o=this.lhs.evaluate(n),s=this.rhs.evaluate(n);if(r&&this.hasUntypedArgument){const t=ri(o),i=ri(s);if(t.kind!==i.kind||"string"!==t.kind&&"number"!==t.kind)throw new si(`Expected arguments for "${e}" to be (string, string) or (number, number), but found (${t.kind}, ${i.kind}) instead.`)}if(this.collator&&!r&&this.hasUntypedArgument){const e=ri(o),i=ri(s);if("string"!==e.kind||"string"!==i.kind)return t(n,o,s)}return this.collator?i(n,o,s,this.collator.evaluate(n)):t(n,o,s)}eachChild(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)}outputDefined(){return!0}serialize(){const t=[e];return this.eachChild((e=>{t.push(e.serialize())})),t}}}const _n=yn("==",(function(e,t,i){return t===i}),gn),vn=yn("!=",(function(e,t,i){return t!==i}),(function(e,t,i,r){return!gn(0,t,i,r)})),xn=yn("<",(function(e,t,i){return t<i}),(function(e,t,i,r){return r.compare(t,i)<0})),bn=yn(">",(function(e,t,i){return t>i}),(function(e,t,i,r){return r.compare(t,i)>0})),wn=yn("<=",(function(e,t,i){return t<=i}),(function(e,t,i,r){return r.compare(t,i)<=0})),Sn=yn(">=",(function(e,t,i){return t>=i}),(function(e,t,i,r){return r.compare(t,i)>=0}));class Tn{constructor(e,t,i,r,n,o){this.type=Ot,this.number=e,this.locale=t,this.currency=i,this.unit=r,this.minFractionDigits=n,this.maxFractionDigits=o}static parse(e,t){if(3!==e.length)return t.error("Expected two arguments.");const i=t.parse(e[1],1,zt);if(!i)return null;const r=e[2];if("object"!=typeof r||Array.isArray(r))return t.error("NumberFormat options argument must be an object.");let n=null;if(r.locale&&(n=t.parseObjectValue(r.locale,2,"locale",Ot),!n))return null;let o=null;if(r.currency&&(o=t.parseObjectValue(r.currency,2,"currency",Ot),!o))return null;let s=null;if(r.unit&&(s=t.parseObjectValue(r.unit,2,"unit",Ot),!s))return null;let a=null;if(r["min-fraction-digits"]&&(a=t.parseObjectValue(r["min-fraction-digits"],2,"min-fraction-digits",zt),!a))return null;let l=null;return r["max-fraction-digits"]&&(l=t.parseObjectValue(r["max-fraction-digits"],2,"max-fraction-digits",zt),!l)?null:new Tn(i,n,o,s,a,l)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Mn{constructor(e){this.type=zt,this.input=e}static parse(e,t){if(2!==e.length)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);const i=t.parse(e[1],1);return i?"array"!==i.type.kind&&"string"!==i.type.kind&&"value"!==i.type.kind?t.error(`Expected argument of type string or array, but found ${Wt(i.type)} instead.`):new Mn(i):null}evaluate(e){const t=this.input.evaluate(e);if("string"==typeof t)return t.length;if(Array.isArray(t))return t.length;throw new si(`Expected value to be of type string or array, but found ${Wt(ri(t))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild((t=>{e.push(t.serialize())})),e}}function An(e){return function(){e=1831565813+(e|=0)|0;let t=Math.imul(e^e>>>15,1|e);return t=t+Math.imul(t^t>>>7,61|t)^t,((t^t>>>14)>>>0)/4294967296}}const Cn={"==":_n,"!=":vn,">":bn,"<":xn,">=":Sn,"<=":wn,array:li,at:cn,boolean:li,case:pn,coalesce:an,collator:_i,format:ci,image:ui,in:un,"index-of":hn,interpolate:on,"interpolate-hcl":on,"interpolate-lab":on,length:Mn,let:ln,literal:oi,match:dn,number:li,"number-format":Tn,object:li,slice:fn,step:Nr,string:li,"to-boolean":pi,"to-color":pi,"to-number":pi,"to-string":pi,var:Rr,within:ji,distance:Ar,config:Pr};function En(e,t){let[i,r,n,o]=t;i=i.evaluate(e),r=r.evaluate(e),n=n.evaluate(e);const s=o?o.evaluate(e):1,a=ti(i,r,n,s);if(a)throw new si(a);return new At(i/255*s,r/255*s,n/255*s,s)}function Pn(e,t){let[i,r,n,o]=t;i=i.evaluate(e),r=r.evaluate(e),n=n.evaluate(e);const s=o?o.evaluate(e):1,a=function(e,t,i,r){return"number"==typeof e&&e>=0&&e<=360?"number"==typeof t&&t>=0&&t<=100&&"number"==typeof i&&i>=0&&i<=100?void 0===r||"number"==typeof r&&r>=0&&r<=1?null:`Invalid hsla value [${[e,t,i,r].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${("number"==typeof r?[e,t,i,r]:[e,t,i]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${("number"==typeof r?[e,t,i,r]:[e,t,i]).join(", ")}]: 'h' must be between 0 and 360.`}(i,r,n,s);if(a)throw new si(a);const l=`hsla(${i}, ${r}%, ${n}%, ${s})`,c=At.parse(l);if(!c)throw new si(`Failed to parse HSLA color: ${l}`);return c}function kn(e,t){return e in t}function In(e,t){const i=t[e];return void 0===i?null:i}function Dn(e){return{type:e}}function Ln(e){return{result:"success",value:e}}function Rn(e){return{result:"error",value:e}}function zn(e,t){return!!e&&!!e.parameters&&e.parameters.indexOf(t)>-1}function On(e){return"data-driven"===e["property-type"]}function Fn(e){return zn(e.expression,"measure-light")}function Bn(e){return zn(e.expression,"zoom")}function Nn(e){return!!e.expression&&e.expression.interpolated}function jn(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function Vn(e){return e}function Un(e,t){const i="color"===t.type,r=e.stops&&"object"==typeof e.stops[0][0],n=r||!(r||void 0!==e.property),o=e.type||(Nn(t)?"exponential":"interval");if(i&&((e=It({},e)).stops&&(e.stops=e.stops.map((e=>[e[0],At.parse(e[1])]))),e.default=At.parse(e.default?e.default:t.default)),e.colorSpace&&"rgb"!==e.colorSpace&&!nn[e.colorSpace])throw new Error(`Unknown color space: ${e.colorSpace}`);let s,a,l;if("exponential"===o)s=$n;else if("interval"===o)s=Wn;else if("categorical"===o){s=Hn,a=Object.create(null);for(const t of e.stops)a[t[0]]=t[1];l=typeof e.stops[0][0]}else{if("identity"!==o)throw new Error(`Unknown function type "${o}"`);s=qn}if(r){const i={},r=[];for(let t=0;t<e.stops.length;t++){const n=e.stops[t],o=n[0].zoom;void 0===i[o]&&(i[o]={zoom:o,type:e.type,property:e.property,default:e.default,stops:[]},r.push(o)),i[o].stops.push([n[0].value,n[1]])}const n=[];for(const e of r)n.push([i[e].zoom,Un(i[e],t)]);const o={name:"linear"};return{kind:"composite",interpolationType:o,interpolationFactor:on.interpolationFactor.bind(void 0,o),zoomStops:n.map((e=>e[0])),evaluate:(i,r)=>{let{zoom:o}=i;return $n({stops:n,base:e.base},t,o).evaluate(o,r)}}}if(n){const i="exponential"===o?{name:"exponential",base:void 0!==e.base?e.base:1}:null;return{kind:"camera",interpolationType:i,interpolationFactor:on.interpolationFactor.bind(void 0,i),zoomStops:e.stops.map((e=>e[0])),evaluate:i=>{let{zoom:r}=i;return s(e,t,r,a,l)}}}return{kind:"source",evaluate(i,r){const n=r&&r.properties?r.properties[e.property]:void 0;return void 0===n?Gn(e.default,t.default):s(e,t,n,a,l)}}}function Gn(e,t,i){return void 0!==e?e:void 0!==t?t:void 0!==i?i:void 0}function Hn(e,t,i,r,n){return Gn(typeof i===n?r[i]:void 0,e.default,t.default)}function Wn(e,t,i){if("number"!==hi(i))return Gn(e.default,t.default);const r=e.stops.length;if(1===r)return e.stops[0][1];if(i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[r-1][0])return e.stops[r-1][1];const n=Br(e.stops.map((e=>e[0])),i);return e.stops[n][1]}function $n(e,t,i){const r=void 0!==e.base?e.base:1;if("number"!==hi(i))return Gn(e.default,t.default);const n=e.stops.length;if(1===n)return e.stops[0][1];if(i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[n-1][0])return e.stops[n-1][1];const o=Br(e.stops.map((e=>e[0])),i),s=function(e,t,i,r){const n=r-i,o=e-i;return 0===n?0:1===t?o/n:(Math.pow(t,o)-1)/(Math.pow(t,n)-1)}(i,r,e.stops[o][0],e.stops[o+1][0]),a=e.stops[o][1],l=e.stops[o+1][1];let c=kt[t.type]||Vn;if(e.colorSpace&&"rgb"!==e.colorSpace){const t=nn[e.colorSpace];c=(e,i)=>t.reverse(t.interpolate(t.forward(e),t.forward(i),s))}return"function"==typeof a.evaluate?{evaluate(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const r=a.evaluate.apply(void 0,t),n=l.evaluate.apply(void 0,t);if(void 0!==r&&void 0!==n)return c(r,n,s)}}:c(a,l,s)}function qn(e,t,i){return"color"===t.type?i=At.parse(i):"formatted"===t.type?i=Jt.fromString(i.toString()):"resolvedImage"===t.type?i=ei.build(i.toString()):hi(i)===t.type||"enum"===t.type&&t.values[i]||(i=void 0),Gn(i,e.default,t.default)}gi.register(Cn,{error:[{kind:"error"},[Ot],(e,t)=>{let[i]=t;throw new si(i.evaluate(e))}],typeof:[Ot,[jt],(e,t)=>{let[i]=t;return Wt(ri(i.evaluate(e)))}],"to-rgba":[Ht(zt,4),[Bt],(e,t)=>{let[i]=t;return i.evaluate(e).toRenderColor(null).toArray()}],"to-hsla":[Ht(zt,4),[Bt],(e,t)=>{let[i]=t;return i.evaluate(e).toRenderColor(null).toHslaArray()}],rgb:[Bt,[zt,zt,zt],En],rgba:[Bt,[zt,zt,zt,zt],En],hsl:[Bt,[zt,zt,zt],Pn],hsla:[Bt,[zt,zt,zt,zt],Pn],has:{type:Ft,overloads:[[[Ot],(e,t)=>{let[i]=t;return kn(i.evaluate(e),e.properties())}],[[Ot,Nt],(e,t)=>{let[i,r]=t;return kn(i.evaluate(e),r.evaluate(e))}]]},get:{type:jt,overloads:[[[Ot],(e,t)=>{let[i]=t;return In(i.evaluate(e),e.properties())}],[[Ot,Nt],(e,t)=>{let[i,r]=t;return In(i.evaluate(e),r.evaluate(e))}]]},"feature-state":[jt,[Ot],(e,t)=>{let[i]=t;return In(i.evaluate(e),e.featureState||{})}],properties:[Nt,[],e=>e.properties()],"geometry-type":[Ot,[],e=>e.geometryType()],id:[jt,[],e=>e.id()],zoom:[zt,[],e=>e.globals.zoom],pitch:[zt,[],e=>e.globals.pitch||0],"distance-from-center":[zt,[],e=>e.distanceFromCenter()],"measure-light":[zt,[Ot],(e,t)=>{let[i]=t;return e.measureLight(i.evaluate(e))}],"heatmap-density":[zt,[],e=>e.globals.heatmapDensity||0],"line-progress":[zt,[],e=>e.globals.lineProgress||0],"raster-value":[zt,[],e=>e.globals.rasterValue||0],"raster-particle-speed":[zt,[],e=>e.globals.rasterParticleSpeed||0],"sky-radial-progress":[zt,[],e=>e.globals.skyRadialProgress||0],accumulated:[jt,[],e=>void 0===e.globals.accumulated?null:e.globals.accumulated],"+":[zt,Dn(zt),(e,t)=>{let i=0;for(const r of t)i+=r.evaluate(e);return i}],"*":[zt,Dn(zt),(e,t)=>{let i=1;for(const r of t)i*=r.evaluate(e);return i}],"-":{type:zt,overloads:[[[zt,zt],(e,t)=>{let[i,r]=t;return i.evaluate(e)-r.evaluate(e)}],[[zt],(e,t)=>{let[i]=t;return-i.evaluate(e)}]]},"/":[zt,[zt,zt],(e,t)=>{let[i,r]=t;return i.evaluate(e)/r.evaluate(e)}],"%":[zt,[zt,zt],(e,t)=>{let[i,r]=t;return i.evaluate(e)%r.evaluate(e)}],ln2:[zt,[],()=>Math.LN2],pi:[zt,[],()=>Math.PI],e:[zt,[],()=>Math.E],"^":[zt,[zt,zt],(e,t)=>{let[i,r]=t;return Math.pow(i.evaluate(e),r.evaluate(e))}],sqrt:[zt,[zt],(e,t)=>{let[i]=t;return Math.sqrt(i.evaluate(e))}],log10:[zt,[zt],(e,t)=>{let[i]=t;return Math.log(i.evaluate(e))/Math.LN10}],ln:[zt,[zt],(e,t)=>{let[i]=t;return Math.log(i.evaluate(e))}],log2:[zt,[zt],(e,t)=>{let[i]=t;return Math.log(i.evaluate(e))/Math.LN2}],sin:[zt,[zt],(e,t)=>{let[i]=t;return Math.sin(i.evaluate(e))}],cos:[zt,[zt],(e,t)=>{let[i]=t;return Math.cos(i.evaluate(e))}],tan:[zt,[zt],(e,t)=>{let[i]=t;return Math.tan(i.evaluate(e))}],asin:[zt,[zt],(e,t)=>{let[i]=t;return Math.asin(i.evaluate(e))}],acos:[zt,[zt],(e,t)=>{let[i]=t;return Math.acos(i.evaluate(e))}],atan:[zt,[zt],(e,t)=>{let[i]=t;return Math.atan(i.evaluate(e))}],min:[zt,Dn(zt),(e,t)=>Math.min(...t.map((t=>t.evaluate(e))))],max:[zt,Dn(zt),(e,t)=>Math.max(...t.map((t=>t.evaluate(e))))],abs:[zt,[zt],(e,t)=>{let[i]=t;return Math.abs(i.evaluate(e))}],round:[zt,[zt],(e,t)=>{let[i]=t;const r=i.evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[zt,[zt],(e,t)=>{let[i]=t;return Math.floor(i.evaluate(e))}],ceil:[zt,[zt],(e,t)=>{let[i]=t;return Math.ceil(i.evaluate(e))}],"filter-==":[Ft,[Ot,jt],(e,t)=>{let[i,r]=t;return e.properties()[i.value]===r.value}],"filter-id-==":[Ft,[jt],(e,t)=>{let[i]=t;return e.id()===i.value}],"filter-type-==":[Ft,[Ot],(e,t)=>{let[i]=t;return e.geometryType()===i.value}],"filter-<":[Ft,[Ot,jt],(e,t)=>{let[i,r]=t;const n=e.properties()[i.value],o=r.value;return typeof n==typeof o&&n<o}],"filter-id-<":[Ft,[jt],(e,t)=>{let[i]=t;const r=e.id(),n=i.value;return typeof r==typeof n&&r<n}],"filter->":[Ft,[Ot,jt],(e,t)=>{let[i,r]=t;const n=e.properties()[i.value],o=r.value;return typeof n==typeof o&&n>o}],"filter-id->":[Ft,[jt],(e,t)=>{let[i]=t;const r=e.id(),n=i.value;return typeof r==typeof n&&r>n}],"filter-<=":[Ft,[Ot,jt],(e,t)=>{let[i,r]=t;const n=e.properties()[i.value],o=r.value;return typeof n==typeof o&&n<=o}],"filter-id-<=":[Ft,[jt],(e,t)=>{let[i]=t;const r=e.id(),n=i.value;return typeof r==typeof n&&r<=n}],"filter->=":[Ft,[Ot,jt],(e,t)=>{let[i,r]=t;const n=e.properties()[i.value],o=r.value;return typeof n==typeof o&&n>=o}],"filter-id->=":[Ft,[jt],(e,t)=>{let[i]=t;const r=e.id(),n=i.value;return typeof r==typeof n&&r>=n}],"filter-has":[Ft,[jt],(e,t)=>{let[i]=t;return i.value in e.properties()}],"filter-has-id":[Ft,[],e=>null!==e.id()&&void 0!==e.id()],"filter-type-in":[Ft,[Ht(Ot)],(e,t)=>{let[i]=t;return i.value.indexOf(e.geometryType())>=0}],"filter-id-in":[Ft,[Ht(jt)],(e,t)=>{let[i]=t;return i.value.indexOf(e.id())>=0}],"filter-in-small":[Ft,[Ot,Ht(jt)],(e,t)=>{let[i,r]=t;return r.value.indexOf(e.properties()[i.value])>=0}],"filter-in-large":[Ft,[Ot,Ht(jt)],(e,t)=>{let[i,r]=t;return function(e,t,i,r){for(;i<=r;){const n=i+r>>1;if(t[n]===e)return!0;t[n]>e?r=n-1:i=n+1}return!1}(e.properties()[i.value],r.value,0,r.value.length-1)}],all:{type:Ft,overloads:[[[Ft,Ft],(e,t)=>{let[i,r]=t;return i.evaluate(e)&&r.evaluate(e)}],[Dn(Ft),(e,t)=>{for(const i of t)if(!i.evaluate(e))return!1;return!0}]]},any:{type:Ft,overloads:[[[Ft,Ft],(e,t)=>{let[i,r]=t;return i.evaluate(e)||r.evaluate(e)}],[Dn(Ft),(e,t)=>{for(const i of t)if(i.evaluate(e))return!0;return!1}]]},"!":[Ft,[Ft],(e,t)=>{let[i]=t;return!i.evaluate(e)}],"is-supported-script":[Ft,[Ot],(e,t)=>{let[i]=t;const r=e.globals&&e.globals.isSupportedScript;return!r||r(i.evaluate(e))}],upcase:[Ot,[Ot],(e,t)=>{let[i]=t;return i.evaluate(e).toUpperCase()}],downcase:[Ot,[Ot],(e,t)=>{let[i]=t;return i.evaluate(e).toLowerCase()}],concat:[Ot,Dn(jt),(e,t)=>t.map((t=>ni(t.evaluate(e)))).join("")],"resolved-locale":[Ot,[Vt],(e,t)=>{let[i]=t;return i.evaluate(e).resolvedLocale()}],random:[zt,[zt,zt,jt],(e,t)=>{const[i,r,n]=t.map((t=>t.evaluate(e)));if(i>r)return i;if(i===r)return i;let o;if("string"==typeof n)o=function(e){let t=0;if(0===e.length)return t;for(let i=0;i<e.length;i++)t=(t<<5)-t+e.charCodeAt(i),t|=0;return t}(n);else{if("number"!=typeof n)throw new si(`Invalid seed input: ${n}`);o=n}return i+An(o)()*(r-i)}]});class Xn{constructor(e,t,i,r){this.expression=e,this._warningHistory={},this._evaluator=new mi(i,r),this._defaultValue=t?function(e){return"color"===e.type&&(jn(e.default)||Array.isArray(e.default))?new At(0,0,0,0):"color"===e.type?At.parse(e.default)||null:void 0===e.default?null:e.default}(t):null,this._enumValues=t&&"enum"===t.type?t.values:null,this.configDependencies=Dr(e)}evaluateWithoutErrorHandling(e,t,i,r,n,o,s,a){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=i,this._evaluator.canonical=r||null,this._evaluator.availableImages=n||null,this._evaluator.formattedSection=o,this._evaluator.featureTileCoord=s||null,this._evaluator.featureDistanceData=a||null,this.expression.evaluate(this._evaluator)}evaluate(e,t,i,r,n,o,s,a){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=i||null,this._evaluator.canonical=r||null,this._evaluator.availableImages=n||null,this._evaluator.formattedSection=o||null,this._evaluator.featureTileCoord=s||null,this._evaluator.featureDistanceData=a||null;try{const e=this.expression.evaluate(this._evaluator);if(null==e||"number"==typeof e&&e!=e)return this._defaultValue;if(this._enumValues&&!(e in this._enumValues))throw new si(`Expected value to be one of ${Object.keys(this._enumValues).map((e=>JSON.stringify(e))).join(", ")}, but found ${JSON.stringify(e)} instead.`);return e}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${e.message}`)),this._defaultValue}}}function Yn(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in Cn}function Zn(e,t,i,r){const n=new Or(Cn,[],t?function(e){const t={color:Bt,string:Ot,number:zt,enum:Ot,boolean:Ft,formatted:Ut,resolvedImage:Gt};return"array"===e.type?Ht(t[e.value]||jt,e.length):t[e.type]}(t):void 0,void 0,void 0,i,r),o=n.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return o?Ln(new Xn(o,t,i,r)):Rn(n.errors)}class Kn{constructor(e,t,i,r){this.kind=e,this._styleExpression=t,this.isLightConstant=i,this.isLineProgressConstant=r,this.isStateDependent="constant"!==e&&!Ir(t.expression),this.configDependencies=Dr(t.expression)}evaluateWithoutErrorHandling(e,t,i,r,n,o){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,r,n,o)}evaluate(e,t,i,r,n,o){return this._styleExpression.evaluate(e,t,i,r,n,o)}}class Jn{constructor(e,t,i,r,n,o){this.kind=e,this.zoomStops=i,this._styleExpression=t,this.isStateDependent="camera"!==e&&!Ir(t.expression),this.isLightConstant=n,this.isLineProgressConstant=o,this.configDependencies=Dr(t.expression),this.interpolationType=r}evaluateWithoutErrorHandling(e,t,i,r,n,o){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,r,n,o)}evaluate(e,t,i,r,n,o){return this._styleExpression.evaluate(e,t,i,r,n,o)}interpolationFactor(e,t,i){return this.interpolationType?on.interpolationFactor(this.interpolationType,e,t,i):0}}function Qn(e,t,i,r){if("error"===(e=Zn(e,t,i,r)).result)return e;const n=e.value.expression,o=kr(n);if(!o&&!On(t))return Rn([new Dt("","data expressions not supported")]);const s=Lr(n,["zoom","pitch","distance-from-center"]);if(!s&&!Bn(t))return Rn([new Dt("","zoom expressions not supported")]);const a=Lr(n,["measure-light"]);if(!a&&!Fn(t))return Rn([new Dt("","measure-light expression not supported")]);const l=Lr(n,["line-progress"]);if(!l&&!function(e){return zn(e.expression,"line-progress")}(t))return Rn([new Dt("","line-progress expression not supported")]);const c=t.expression&&t.expression.relaxZoomRestriction,u=to(n);return u||s||c?u instanceof Dt?Rn([u]):u instanceof on&&!Nn(t)?Rn([new Dt("",'"interpolate" expressions cannot be used with this property')]):Ln(u?new Jn(o&&l?"camera":"composite",e.value,u.labels,u instanceof on?u.interpolation:void 0,a,l):new Kn(o&&l?"constant":"source",e.value,a,l)):Rn([new Dt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class eo{constructor(e,t){this._parameters=e,this._specification=t,It(this,Un(this._parameters,this._specification))}static deserialize(e){return new eo(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function to(e){let t=null;if(e instanceof ln)t=to(e.result);else if(e instanceof an){for(const i of e.args)if(t=to(i),t)break}else(e instanceof Nr||e instanceof on)&&e.input instanceof gi&&"zoom"===e.input.name&&(t=e);return t instanceof Dt||e.eachChild((e=>{const i=to(e);i instanceof Dt?t=i:t&&i&&t!==i&&(t=new Dt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),t}var io,ro,no=function(){if(ro)return io;ro=1,io=t;var e=3;function t(t,i,r){var n=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var o=new Int32Array(this.arrayBuffer);t=o[0],this.d=(i=o[1])+2*(r=o[2]);for(var s=0;s<this.d*this.d;s++){var a=o[e+s],l=o[e+s+1];n.push(a===l?null:o.subarray(a,l))}var c=o[e+n.length+1];this.keys=o.subarray(o[e+n.length],c),this.bboxes=o.subarray(c),this.insert=this._insertReadonly}else{this.d=i+2*r;for(var u=0;u<this.d*this.d;u++)n.push([]);this.keys=[],this.bboxes=[]}this.n=i,this.extent=t,this.padding=r,this.scale=i/t,this.uid=0;var h=r/i*t;this.min=-h,this.max=t+h}return t.prototype.insert=function(e,t,i,r,n){this._forEachCell(t,i,r,n,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(r),this.bboxes.push(n)},t.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},t.prototype._insertCell=function(e,t,i,r,n,o){this.cells[n].push(o)},t.prototype.query=function(e,t,i,r,n){var o=this.min,s=this.max;if(e<=o&&t<=o&&s<=i&&s<=r&&!n)return Array.prototype.slice.call(this.keys);var a=[];return this._forEachCell(e,t,i,r,this._queryCell,a,{},n),a},t.prototype._queryCell=function(e,t,i,r,n,o,s,a){var l=this.cells[n];if(null!==l)for(var c=this.keys,u=this.bboxes,h=0;h<l.length;h++){var d=l[h];if(void 0===s[d]){var p=4*d;(a?a(u[p+0],u[p+1],u[p+2],u[p+3]):e<=u[p+2]&&t<=u[p+3]&&i>=u[p+0]&&r>=u[p+1])?(s[d]=!0,o.push(c[d])):s[d]=!1}}},t.prototype._forEachCell=function(e,t,i,r,n,o,s,a){for(var l=this._convertToCellCoord(e),c=this._convertToCellCoord(t),u=this._convertToCellCoord(i),h=this._convertToCellCoord(r),d=l;d<=u;d++)for(var p=c;p<=h;p++){var f=this.d*p+d;if((!a||a(this._convertFromCellCoord(d),this._convertFromCellCoord(p),this._convertFromCellCoord(d+1),this._convertFromCellCoord(p+1)))&&n.call(this,e,t,i,r,f,o,s,a))return}},t.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},t.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},t.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,i=e+this.cells.length+1+1,r=0,n=0;n<this.cells.length;n++)r+=this.cells[n].length;var o=new Int32Array(i+r+this.keys.length+this.bboxes.length);o[0]=this.extent,o[1]=this.n,o[2]=this.padding;for(var s=i,a=0;a<t.length;a++){var l=t[a];o[e+a]=s,o.set(l,s),s+=l.length}return o[e+t.length]=s,o.set(this.keys,s),o[e+t.length+1]=s+=this.keys.length,o.set(this.bboxes,s),s+=this.bboxes.length,o.buffer},io}(),oo=t(no);const so={};function ao(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.defineProperty(e,"_classRegistryKey",{value:t,writable:!1}),so[t]={klass:e,omit:i.omit||[]}}ao(Object,"Object"),oo.serialize=function(e,t){const i=e.toArrayBuffer();return t&&t.add(i),{buffer:i}},oo.deserialize=function(e){return new oo(e.buffer)},Object.defineProperty(oo,"name",{value:"Grid"}),ao(oo,"Grid"),"undefined"!=typeof DOMMatrix&&ao(DOMMatrix,"DOMMatrix"),ao(At,"Color"),ao(Error,"Error"),ao(Jt,"Formatted"),ao(Kt,"FormattedSection"),ao(tt,"AJAXError"),ao(ei,"ResolvedImage"),ao(eo,"StylePropertyFunction"),ao(Xn,"StyleExpression",{omit:["_evaluator"]}),ao(Qt,"ImageIdWithOptions"),ao(Jn,"ZoomDependentExpression"),ao(Kn,"ZoomConstantExpression"),ao(gi,"CompoundExpression",{omit:["_evaluate"]});for(const bv in Cn)so[Cn[bv]._classRegistryKey]||ao(Cn[bv],`Expression${bv}`);function lo(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function co(e){return self.ImageBitmap&&e instanceof ImageBitmap}function uo(e,t){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(lo(e)||co(e))return t&&t.add(e),e;if(ArrayBuffer.isView(e))return t&&t.add(e.buffer),e;if(e instanceof ImageData)return t&&t.add(e.data.buffer),e;if(Array.isArray(e)){const i=[];for(const r of e)i.push(uo(r,t));return i}if(e instanceof Map){const t={$name:"Map"};for(const[i,r]of e.entries())t[i]=uo(r);return t}if(e instanceof Set){const t={$name:"Set"};let i=0;for(const r of e.values())t[++i]=uo(r);return t}if("object"==typeof e){const i=e.constructor,r=i._classRegistryKey;if(!r)throw new Error(`Can't serialize object of unregistered class "${r}".`);const n=i.serialize?i.serialize(e,t):{};if(!i.serialize){for(const i in e)e.hasOwnProperty(i)&&(so[r].omit.indexOf(i)>=0||(n[i]=uo(e[i],t)));e instanceof Error&&(n.message=e.message)}if(n.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==r&&(n.$name=r),n}throw new Error("can't serialize object of type "+typeof e)}function ho(e){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||lo(e)||co(e)||ArrayBuffer.isView(e)||e instanceof ImageData)return e;if(Array.isArray(e))return e.map(ho);if("object"==typeof e){const t=e.$name||"Object";if("Map"===t){const t=new Map;for(const i of Object.keys(e))"$name"!==i&&t.set(i,ho(e[i]));return t}if("Set"===t){const t=new Set;for(const i of Object.keys(e))"$name"!==i&&t.add(ho(e[i]));return t}const{klass:i}=so[t];if(!i)throw new Error(`Can't deserialize unregistered class "${t}".`);if(i.deserialize)return i.deserialize(e);const r=Object.create(i.prototype);for(const n of Object.keys(e))"$name"!==n&&(r[n]=ho(e[n]));return r}throw new Error("can't deserialize object of type "+typeof e)}const po={"Latin-1 Supplement":e=>e>=128&&e<=255,Arabic:e=>e>=1536&&e<=1791,"Arabic Supplement":e=>e>=1872&&e<=1919,"Arabic Extended-A":e=>e>=2208&&e<=2303,"Hangul Jamo":e=>e>=4352&&e<=4607,"Unified Canadian Aboriginal Syllabics":e=>e>=5120&&e<=5759,Khmer:e=>e>=6016&&e<=6143,"Unified Canadian Aboriginal Syllabics Extended":e=>e>=6320&&e<=6399,"General Punctuation":e=>e>=8192&&e<=8303,"Letterlike Symbols":e=>e>=8448&&e<=8527,"Number Forms":e=>e>=8528&&e<=8591,"Miscellaneous Technical":e=>e>=8960&&e<=9215,"Control Pictures":e=>e>=9216&&e<=9279,"Optical Character Recognition":e=>e>=9280&&e<=9311,"Enclosed Alphanumerics":e=>e>=9312&&e<=9471,"Geometric Shapes":e=>e>=9632&&e<=9727,"Miscellaneous Symbols":e=>e>=9728&&e<=9983,"Miscellaneous Symbols and Arrows":e=>e>=11008&&e<=11263,"CJK Radicals Supplement":e=>e>=11904&&e<=12031,"Kangxi Radicals":e=>e>=12032&&e<=12255,"Ideographic Description Characters":e=>e>=12272&&e<=12287,"CJK Symbols and Punctuation":e=>e>=12288&&e<=12351,Hiragana:e=>e>=12352&&e<=12447,Katakana:e=>e>=12448&&e<=12543,Bopomofo:e=>e>=12544&&e<=12591,"Hangul Compatibility Jamo":e=>e>=12592&&e<=12687,Kanbun:e=>e>=12688&&e<=12703,"Bopomofo Extended":e=>e>=12704&&e<=12735,"CJK Strokes":e=>e>=12736&&e<=12783,"Katakana Phonetic Extensions":e=>e>=12784&&e<=12799,"Enclosed CJK Letters and Months":e=>e>=12800&&e<=13055,"CJK Compatibility":e=>e>=13056&&e<=13311,"CJK Unified Ideographs Extension A":e=>e>=13312&&e<=19903,"Yijing Hexagram Symbols":e=>e>=19904&&e<=19967,"CJK Unified Ideographs":e=>e>=19968&&e<=40959,"Yi Syllables":e=>e>=40960&&e<=42127,"Yi Radicals":e=>e>=42128&&e<=42191,"Hangul Jamo Extended-A":e=>e>=43360&&e<=43391,"Hangul Syllables":e=>e>=44032&&e<=55215,"Hangul Jamo Extended-B":e=>e>=55216&&e<=55295,"Private Use Area":e=>e>=57344&&e<=63743,"CJK Compatibility Ideographs":e=>e>=63744&&e<=64255,"Arabic Presentation Forms-A":e=>e>=64336&&e<=65023,"Vertical Forms":e=>e>=65040&&e<=65055,"CJK Compatibility Forms":e=>e>=65072&&e<=65103,"Small Form Variants":e=>e>=65104&&e<=65135,"Arabic Presentation Forms-B":e=>e>=65136&&e<=65279,"Halfwidth and Fullwidth Forms":e=>e>=65280&&e<=65519,Osage:e=>e>=66736&&e<=66815,"CJK Unified Ideographs Extension B":e=>e>=131072&&e<=173791};function fo(e){for(const t of e)if(yo(t.charCodeAt(0)))return!0;return!1}function mo(e){for(const t of e)if(!go(t.charCodeAt(0)))return!1;return!0}function go(e){return!(po.Arabic(e)||po["Arabic Supplement"](e)||po["Arabic Extended-A"](e)||po["Arabic Presentation Forms-A"](e)||po["Arabic Presentation Forms-B"](e))}function yo(e){return!(746!==e&&747!==e&&(e<4352||!(po["Bopomofo Extended"](e)||po.Bopomofo(e)||po["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||po["CJK Compatibility Ideographs"](e)||po["CJK Compatibility"](e)||po["CJK Radicals Supplement"](e)||po["CJK Strokes"](e)||!(!po["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||12336===e)||po["CJK Unified Ideographs Extension A"](e)||po["CJK Unified Ideographs"](e)||po["Enclosed CJK Letters and Months"](e)||po["Hangul Compatibility Jamo"](e)||po["Hangul Jamo Extended-A"](e)||po["Hangul Jamo Extended-B"](e)||po["Hangul Jamo"](e)||po["Hangul Syllables"](e)||po.Hiragana(e)||po["Ideographic Description Characters"](e)||po.Kanbun(e)||po["Kangxi Radicals"](e)||po["Katakana Phonetic Extensions"](e)||po.Katakana(e)&&12540!==e||!(!po["Halfwidth and Fullwidth Forms"](e)||65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)||!(!po["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||po["Unified Canadian Aboriginal Syllabics"](e)||po["Unified Canadian Aboriginal Syllabics Extended"](e)||po["Vertical Forms"](e)||po["Yijing Hexagram Symbols"](e)||po["Yi Syllables"](e)||po["Yi Radicals"](e))))}function _o(e){return!(yo(e)||function(e){return!!(po["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||po["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||po["Letterlike Symbols"](e)||po["Number Forms"](e)||po["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||po["Control Pictures"](e)&&9251!==e||po["Optical Character Recognition"](e)||po["Enclosed Alphanumerics"](e)||po["Geometric Shapes"](e)||po["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||po["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||po["CJK Symbols and Punctuation"](e)||po.Katakana(e)||po["Private Use Area"](e)||po["CJK Compatibility Forms"](e)||po["Small Form Variants"](e)||po["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e)}(e))}function vo(e){return e>=1424&&e<=2303||po["Arabic Presentation Forms-A"](e)||po["Arabic Presentation Forms-B"](e)}function xo(e,t){return!(!t&&vo(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||po.Khmer(e))}function bo(e){for(const t of e)if(vo(t.charCodeAt(0)))return!0;return!1}const wo="deferred",So="loading",To="loaded";let Mo=null,Ao="unavailable",Co=null;const Eo=function(e){e&&"string"==typeof e&&e.indexOf("NetworkError")>-1&&(Ao="error"),Mo&&Mo(e)};function Po(){ko.fire(new _t("pluginStateChange",{pluginStatus:Ao,pluginURL:Co}))}const ko=new wt,Io=function(){return Ao},Do=function(){if(Ao!==wo||!Co)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ao=So,Po(),Co&&nt({url:Co},(e=>{e?Eo(e):(Ao=To,Po())}))},Lo={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Ao===To||null!=Lo.applyArabicShaping,isLoading:()=>Ao===So,setState(e){Ao=e.pluginStatus,Co=e.pluginURL},isParsed:()=>null!=Lo.applyArabicShaping&&null!=Lo.processBidirectionalText&&null!=Lo.processStyledBidirectionalText,getPluginURL:()=>Co};class Ro{constructor(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.transition=t.transition,this.pitch=t.pitch,this.brightness=t.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(e){return function(e,t){for(const i of e)if(!xo(i.charCodeAt(0),t))return!1;return!0}(e,Lo.isLoaded())}}class zo{constructor(e,t,i,r){this.property=e,this.value=t,this.expression=function(e,t,i,r){if(jn(e))return new eo(e,t);if(Yn(e)||Array.isArray(e)&&e.length>0){const n=Qn(e,t,i,r);if("error"===n.result)throw new Error(n.value.map((e=>`${e.key}: ${e.message}`)).join(", "));return n.value}{let i=e;return"string"==typeof e&&"color"===t.type&&(i=At.parse(e)),{kind:"constant",configDependencies:new Set,evaluate:()=>i}}}(void 0===t?e.specification.default:t,e.specification,i,r)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,t,i){return this.property.possiblyEvaluate(this,e,t,i)}}class Oo{constructor(e,t,i){this.property=e,this.value=new zo(e,void 0,t,i)}transitioned(e,t){return new Bo(this.property,this.value,t,re({},e.transition,this.transition),e.now)}untransitioned(){return new Bo(this.property,this.value,null,{},0)}}class Fo{constructor(e,t,i){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues),this._scope=t,this._options=i,this.configDependencies=new Set}getValue(e){return he(this._values[e].value.value)}setValue(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Oo(this._values[e].property,this._scope,this._options)),this._values[e].value=new zo(this._values[e].property,null===t?void 0:he(t),this._scope,this._options),this._values[e].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[e].value.expression.configDependencies]))}setTransitionOrValue(e,t){t&&(this._options=t);const i=this._properties.properties;if(e)for(const r in e){const t=e[r];if(le(r,"-transition")){const e=r.slice(0,-11);i[e]&&this.setTransition(e,t)}else i.hasOwnProperty(r)&&this.setValue(r,t)}}getTransition(e){return he(this._values[e].transition)}setTransition(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Oo(this._values[e].property)),this._values[e].transition=he(t)||void 0}serialize(){const e={};for(const t of Object.keys(this._values)){const i=this.getValue(t);void 0!==i&&(e[t]=i);const r=this.getTransition(t);void 0!==r&&(e[`${t}-transition`]=r)}return e}transitioned(e,t){const i=new No(this._properties);for(const r of Object.keys(this._values))i._values[r]=this._values[r].transitioned(e,t._values[r]);return i}untransitioned(){const e=new No(this._properties);for(const t of Object.keys(this._values))e._values[t]=this._values[t].untransitioned();return e}}class Bo{constructor(e,t,i,r,n){const o=r.delay||0,s=r.duration||0;n=n||0,this.property=e,this.value=t,this.begin=n+o,this.end=this.begin+s,e.specification.transition&&(r.delay||r.duration)&&(this.prior=i)}possiblyEvaluate(e,t,i){const r=e.now||0,n=this.value.possiblyEvaluate(e,t,i),o=this.prior;if(o){if(r>this.end)return this.prior=null,n;if(this.value.isDataDriven())return this.prior=null,n;if(r<this.begin)return o.possiblyEvaluate(e,t,i);{const s=(r-this.begin)/(this.end-this.begin);return this.property.interpolate(o.possiblyEvaluate(e,t,i),n,Z(s))}}return n}}class No{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,t,i){const r=new Uo(this._properties);for(const n of Object.keys(this._values))r._values[n]=this._values[n].possiblyEvaluate(e,t,i);return r}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class jo{constructor(e,t,i){this._properties=e,this._values=Object.create(e.defaultPropertyValues),this._scope=t,this._options=i,this.configDependencies=new Set}getValue(e){return he(this._values[e].value)}setValue(e,t){this._values[e]=new zo(this._values[e].property,null===t?void 0:he(t),this._scope,this._options),this._values[e].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[e].expression.configDependencies]))}serialize(){const e={};for(const t of Object.keys(this._values)){const i=this.getValue(t);void 0!==i&&(e[t]=i)}return e}possiblyEvaluate(e,t,i){const r=new Uo(this._properties);for(const n of Object.keys(this._values))r._values[n]=this._values[n].possiblyEvaluate(e,t,i);return r}}class Vo{constructor(e,t,i){this.property=e,this.value=t,this.parameters=i}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,t,i,r){return this.property.evaluate(this.value,this.parameters,e,t,i,r)}}class Uo{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Go{constructor(e){this.specification=e}possiblyEvaluate(e,t){return e.expression.evaluate(t)}interpolate(e,t,i){const r=kt[this.specification.type];return r?r(e,t,i):e}}class Ho{constructor(e,t){this.specification=e,this.overrides=t}possiblyEvaluate(e,t,i,r){return new Vo(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(t,null,{},i,r)}:e.expression,t)}interpolate(e,t,i){if("constant"!==e.value.kind||"constant"!==t.value.kind)return e;if(void 0===e.value.value||void 0===t.value.value)return new Vo(this,{kind:"constant",value:void 0},e.parameters);const r=kt[this.specification.type];return r?new Vo(this,{kind:"constant",value:r(e.value.value,t.value.value,i)},e.parameters):e}evaluate(e,t,i,r,n,o){return"constant"===e.kind?e.value:e.evaluate(t,i,r,n,o)}}class Wo{constructor(e){this.specification=e}possiblyEvaluate(e,t,i,r){return!!e.expression.evaluate(t,null,{},i,r)}interpolate(){return!1}}class $o{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const t=new Ro(0,{});for(const i in e){const r=e[i];r.specification.overridable&&this.overridableProperties.push(i);const n=this.defaultPropertyValues[i]=new zo(r,void 0),o=this.defaultTransitionablePropertyValues[i]=new Oo(r);this.defaultTransitioningPropertyValues[i]=o.untransitioned(),this.defaultPossiblyEvaluatedValues[i]=n.possiblyEvaluate(t)}}}ao(Ho,"DataDrivenProperty"),ao(Go,"DataConstantProperty"),ao(Wo,"ColorRampProperty");var qo=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow","experimental":true},"rain":{"type":"rain","experimental":true},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor","experimental":true},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"metadata":{"experimental":true,"type":"*"},"selectors":{"experimental":true,"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"experimental":true,"type":"string","required":true},"properties":{"experimental":true,"type":"selectorProperty","required":false},"featureNamespace":{"experimental":true,"type":"string","required":false},"_uniqueFeatureID":{"experimental":true,"type":"boolean","private":true,"required":false}},"selectorProperty":{"experimental":true,"*":{"experimental":true,"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-quality":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]},"experimental":true},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant"},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","experimental":true,"private":true,"expression":{},"property-type":"data-constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"line-cross-slope":{"type":"number","experimental":true,"expression":{},"property-type":"constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","experimental":true,"private":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.4,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","property-type":"data-constant","default":0.71,"minimum":0,"maximum":5,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.57,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","property-type":"data-constant","default":0.7,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}},"buildingFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"flat","property-type":"data-constant"},"fill-extrusion-base-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"terrain","property-type":"data-constant"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"experimental":true,"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"*"}}}');function Xo(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function Yo(e){if(Array.isArray(e))return e.map(Yo);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){const t={};for(const i in e)t[i]=Yo(e[i]);return t}return Xo(e)}function Zo(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(const t of e.slice(1))if(!Zo(t)&&"boolean"!=typeof t)return!1;return!0;default:return!0}}function Ko(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"fill";if(null==e)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Zo(e)||(e=ns(e));const n=e;let o=!0;try{o=function(e){if(!es(e))return e;let t=Yo(e);return Qo(t),t=Jo(t),t}(n)}catch(e){console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(n,null,2)}\n        `)}let s=null,a=null;if("background"!==r&&"sky"!==r&&"slot"!==r){a=qo[`filter_${r}`];const e=Zn(o,a,t,i);if("error"===e.result)throw new Error(e.value.map((e=>`${e.key}: ${e.message}`)).join(", "));s=(t,i,r)=>e.value.evaluate(t,i,{},r)}let l=null,c=null;if(o!==n){const e=Zn(n,a,t,i);if("error"===e.result)throw new Error(e.value.map((e=>`${e.key}: ${e.message}`)).join(", "));l=(t,i,r,n,o)=>e.value.evaluate(t,i,{},r,void 0,void 0,n,o),c=!kr(e.value.expression)}return{filter:s,dynamicFilter:l||void 0,needGeometry:rs(o),needFeature:!!c}}function Jo(e){if(!Array.isArray(e))return e;const t=function(e){if(ts.has(e[0]))for(let t=1;t<e.length;t++)if(es(e[t]))return!0;return e}(e);return!0===t?t:t.map((e=>Jo(e)))}function Qo(e){let t=!1;const i=[];if("case"===e[0]){for(let r=1;r<e.length-1;r+=2)t=t||es(e[r]),i.push(e[r+1]);i.push(e[e.length-1])}else if("match"===e[0]){t=t||es(e[1]);for(let t=2;t<e.length-1;t+=2)i.push(e[t+1]);i.push(e[e.length-1])}else if("step"===e[0]){t=t||es(e[1]);for(let t=1;t<e.length-1;t+=2)i.push(e[t+1])}t&&(e.length=0,e.push("any",...i));for(let r=1;r<e.length;r++)Qo(e[r])}function es(e){if(!Array.isArray(e))return!1;if("pitch"===(t=e[0])||"distance-from-center"===t)return!0;var t;for(let i=1;i<e.length;i++)if(es(e[i]))return!0;return!1}const ts=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function is(e,t){return e<t?-1:e>t?1:0}function rs(e){if(!Array.isArray(e))return!1;if("within"===e[0]||"distance"===e[0])return!0;for(let t=1;t<e.length;t++)if(rs(e[t]))return!0;return!1}function ns(e){if(!e)return!0;const t=e[0];return e.length<=1?"any"!==t:"=="===t?os(e[1],e[2],"=="):"!="===t?ls(os(e[1],e[2],"==")):"<"===t||">"===t||"<="===t||">="===t?os(e[1],e[2],t):"any"===t?(i=e.slice(1),["any"].concat(i.map(ns))):"all"===t?["all"].concat(e.slice(1).map(ns)):"none"===t?["all"].concat(e.slice(1).map(ns).map(ls)):"in"===t?ss(e[1],e.slice(2)):"!in"===t?ls(ss(e[1],e.slice(2))):"has"===t?as(e[1]):"!has"!==t||ls(as(e[1]));var i}function os(e,t,i){switch(e){case"$type":return[`filter-type-${i}`,t];case"$id":return[`filter-id-${i}`,t];default:return[`filter-${i}`,e,t]}}function ss(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some((e=>typeof e!=typeof t[0]))?["filter-in-large",e,["literal",t.sort(is)]]:["filter-in-small",e,["literal",t]]}}function as(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function ls(e){return["!",e]}const cs="\x1f";function us(e,t){return t?`${e}${cs}${t}`:e}const hs="-transition",ds=new Set(["fill","line","background","hillshade","raster"]);class ps extends wt{constructor(e,t,i,r,n){if(super(),this.id=e.id,this.fqid=us(this.id,i),this.type=e.type,this.scope=i,this.lut=r,this.options=n,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,"custom"!==e.type){if(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type&&"background"!==e.type&&"sky"!==e.type&&"slot"!==e.type){this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter;const t=Zn(this.filter,qo[`filter_${e.type}`]);"error"!==t.result&&(this.configDependencies=new Set([...this.configDependencies,...t.value.configDependencies]))}if(e.slot&&(this.slot=e.slot),t.layout&&(this._unevaluatedLayout=new jo(t.layout,this.scope,n),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),t.paint){this._transitionablePaint=new Fo(t.paint,this.scope,n);for(const t in e.paint)this.setPaintProperty(t,e.paint[t]);for(const t in e.layout)this.setLayoutProperty(t,e.layout[t]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Uo(t.paint)}}}onAdd(e){}onRemove(e){}isDraped(e){return!this.is3D()&&ds.has(this.type)}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,t){if("custom"===this.type&&"visibility"===e)return void(this.visibility=t);const i=this._unevaluatedLayout;i._properties.properties[e]&&(i.setValue(e,t),this.configDependencies=new Set([...this.configDependencies,...i.configDependencies]),"visibility"===e&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(e){return le(e,hs)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,t){const i=this._transitionablePaint,r=i._properties.properties;if(le(e,hs)){const n=e.slice(0,-11);return r[n]&&i.setTransition(n,t||void 0),!1}if(!r[e])return!1;const n=i._values[e],o=n.value.isDataDriven(),s=n.value;i.setValue(e,t),this.configDependencies=new Set([...this.configDependencies,...i.configDependencies]),this._handleSpecialPaintPropertyUpdate(e);const a=i._values[e].value,l=a.isDataDriven(),c=le(e,"pattern")||"line-dasharray"===e;return l||o||c||this._handleOverridablePaintPropertyUpdate(e,s,a)}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getDefaultProgramParams(e,t,i){return null}_handleOverridablePaintPropertyUpdate(e,t,i){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,t){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,t)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,t)}serialize(){return ue({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},((e,t)=>!(void 0===e||"layout"===t&&!Object.keys(e).length||"paint"===t&&!Object.keys(e).length)))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const e in this.paint._values){const t=this.paint.get(e);if(t instanceof Vo&&On(t.property.specification)&&("source"===t.value.kind||"composite"===t.value.kind)&&t.value.isStateDependent)return!0}return!1}compileFilter(e){this._filterCompiled||(this._featureFilter=Ko(this.filter,this.scope,e),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(e){this._stats&&("shadow"===e.renderPass?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(e){}queryIntersectsFeature(e,t,i,r,n,o,s,a,l){}}const fs={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ms{constructor(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class gs{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,t){return e._trim(),t&&(e.isTransferred=!0,t.add(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function ys(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=0,r=0;return{members:e.map((e=>{const n=fs[e.type].BYTES_PER_ELEMENT,o=i=_s(i,Math.max(t,n)),s=e.components||1;return r=Math.max(r,n),i+=n*s,{name:e.name,type:e.type,components:s,offset:o}})),size:_s(i,Math.max(r,t)),alignment:t}}function _s(e,t){return Math.ceil(e/t)*t}class vs extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t){const i=this.length;return this.resize(i+1),this.emplace(i,e,t)}emplace(e,t,i){const r=2*e;return this.int16[r+0]=t,this.int16[r+1]=i,e}}vs.prototype.bytesPerElement=4,ao(vs,"StructArrayLayout2i4");class xs extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,i){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,i)}emplace(e,t,i,r){const n=3*e;return this.int16[n+0]=t,this.int16[n+1]=i,this.int16[n+2]=r,e}}xs.prototype.bytesPerElement=6,ao(xs,"StructArrayLayout3i6");class bs extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,i,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,i,r)}emplace(e,t,i,r,n){const o=4*e;return this.int16[o+0]=t,this.int16[o+1]=i,this.int16[o+2]=r,this.int16[o+3]=n,e}}bs.prototype.bytesPerElement=8,ao(bs,"StructArrayLayout4i8");class ws extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,i,r,n){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,i,r,n)}emplace(e,t,i,r,n,o){const s=5*e;return this.int16[s+0]=t,this.int16[s+1]=i,this.int16[s+2]=r,this.int16[s+3]=n,this.int16[s+4]=o,e}}ws.prototype.bytesPerElement=10,ao(ws,"StructArrayLayout5i10");class Ss extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i,r,n,o,s){const a=this.length;return this.resize(a+1),this.emplace(a,e,t,i,r,n,o,s)}emplace(e,t,i,r,n,o,s,a){const l=6*e,c=12*e,u=3*e;return this.int16[l+0]=t,this.int16[l+1]=i,this.uint8[c+4]=r,this.uint8[c+5]=n,this.uint8[c+6]=o,this.uint8[c+7]=s,this.float32[u+2]=a,e}}Ss.prototype.bytesPerElement=12,ao(Ss,"StructArrayLayout2i4ub1f12");class Ts extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,i)}emplace(e,t,i,r){const n=3*e;return this.float32[n+0]=t,this.float32[n+1]=i,this.float32[n+2]=r,e}}Ts.prototype.bytesPerElement=12,ao(Ts,"StructArrayLayout3f12");class Ms extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i,r,n){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,i,r,n)}emplace(e,t,i,r,n,o){const s=6*e,a=3*e;return this.uint16[s+0]=t,this.uint16[s+1]=i,this.uint16[s+2]=r,this.uint16[s+3]=n,this.float32[a+2]=o,e}}Ms.prototype.bytesPerElement=12,ao(Ms,"StructArrayLayout4ui1f12");class As extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,i,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,i,r)}emplace(e,t,i,r,n){const o=4*e;return this.uint16[o+0]=t,this.uint16[o+1]=i,this.uint16[o+2]=r,this.uint16[o+3]=n,e}}As.prototype.bytesPerElement=8,ao(As,"StructArrayLayout4ui8");class Cs extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,i,r,n,o){const s=this.length;return this.resize(s+1),this.emplace(s,e,t,i,r,n,o)}emplace(e,t,i,r,n,o,s){const a=6*e;return this.int16[a+0]=t,this.int16[a+1]=i,this.int16[a+2]=r,this.int16[a+3]=n,this.int16[a+4]=o,this.int16[a+5]=s,e}}Cs.prototype.bytesPerElement=12,ao(Cs,"StructArrayLayout6i12");class Es extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,i,r,n,o,s,a,l,c,u,h){const d=this.length;return this.resize(d+1),this.emplace(d,e,t,i,r,n,o,s,a,l,c,u,h)}emplace(e,t,i,r,n,o,s,a,l,c,u,h,d){const p=12*e;return this.int16[p+0]=t,this.int16[p+1]=i,this.int16[p+2]=r,this.int16[p+3]=n,this.uint16[p+4]=o,this.uint16[p+5]=s,this.uint16[p+6]=a,this.uint16[p+7]=l,this.int16[p+8]=c,this.int16[p+9]=u,this.int16[p+10]=h,this.int16[p+11]=d,e}}Es.prototype.bytesPerElement=24,ao(Es,"StructArrayLayout4i4ui4i24");class Ps extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i,r,n,o){const s=this.length;return this.resize(s+1),this.emplace(s,e,t,i,r,n,o)}emplace(e,t,i,r,n,o,s){const a=10*e,l=5*e;return this.int16[a+0]=t,this.int16[a+1]=i,this.int16[a+2]=r,this.float32[l+2]=n,this.float32[l+3]=o,this.float32[l+4]=s,e}}Ps.prototype.bytesPerElement=20,ao(Ps,"StructArrayLayout3i3f20");class ks extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,i,r)}emplace(e,t,i,r,n){const o=4*e;return this.float32[o+0]=t,this.float32[o+1]=i,this.float32[o+2]=r,this.float32[o+3]=n,e}}ks.prototype.bytesPerElement=16,ao(ks,"StructArrayLayout4f16");class Is extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint32[1*e+0]=t,e}}Is.prototype.bytesPerElement=4,ao(Is,"StructArrayLayout1ul4");class Ds extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t){const i=this.length;return this.resize(i+1),this.emplace(i,e,t)}emplace(e,t,i){const r=2*e;return this.uint16[r+0]=t,this.uint16[r+1]=i,e}}Ds.prototype.bytesPerElement=4,ao(Ds,"StructArrayLayout2ui4");class Ls extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,i,r,n,o,s,a,l,c,u,h,d){const p=this.length;return this.resize(p+1),this.emplace(p,e,t,i,r,n,o,s,a,l,c,u,h,d)}emplace(e,t,i,r,n,o,s,a,l,c,u,h,d,p){const f=20*e,m=10*e;return this.int16[f+0]=t,this.int16[f+1]=i,this.int16[f+2]=r,this.int16[f+3]=n,this.int16[f+4]=o,this.float32[m+3]=s,this.float32[m+4]=a,this.float32[m+5]=l,this.float32[m+6]=c,this.int16[f+14]=u,this.uint32[m+8]=h,this.uint16[f+18]=d,this.uint16[f+19]=p,e}}Ls.prototype.bytesPerElement=40,ao(Ls,"StructArrayLayout5i4f1i1ul2ui40");class Rs extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,i,r,n,o,s){const a=this.length;return this.resize(a+1),this.emplace(a,e,t,i,r,n,o,s)}emplace(e,t,i,r,n,o,s,a){const l=8*e;return this.int16[l+0]=t,this.int16[l+1]=i,this.int16[l+2]=r,this.int16[l+4]=n,this.int16[l+5]=o,this.int16[l+6]=s,this.int16[l+7]=a,e}}Rs.prototype.bytesPerElement=16,ao(Rs,"StructArrayLayout3i2i2i16");class zs extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,i,r,n){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,i,r,n)}emplace(e,t,i,r,n,o){const s=4*e,a=8*e;return this.float32[s+0]=t,this.float32[s+1]=i,this.float32[s+2]=r,this.int16[a+6]=n,this.int16[a+7]=o,e}}zs.prototype.bytesPerElement=16,ao(zs,"StructArrayLayout2f1f2i16");class Os extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i,r,n,o){const s=this.length;return this.resize(s+1),this.emplace(s,e,t,i,r,n,o)}emplace(e,t,i,r,n,o,s){const a=20*e,l=5*e;return this.uint8[a+0]=t,this.uint8[a+1]=i,this.float32[l+1]=r,this.float32[l+2]=n,this.float32[l+3]=o,this.float32[l+4]=s,e}}Os.prototype.bytesPerElement=20,ao(Os,"StructArrayLayout2ub4f20");class Fs extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,i){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,i)}emplace(e,t,i,r){const n=3*e;return this.uint16[n+0]=t,this.uint16[n+1]=i,this.uint16[n+2]=r,e}}Fs.prototype.bytesPerElement=6,ao(Fs,"StructArrayLayout3ui6");class Bs extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,t,i,r,n,o,s,a,l,c,u,h,d,p,f,m,g,y,_,v,x){const b=this.length;return this.resize(b+1),this.emplace(b,e,t,i,r,n,o,s,a,l,c,u,h,d,p,f,m,g,y,_,v,x)}emplace(e,t,i,r,n,o,s,a,l,c,u,h,d,p,f,m,g,y,_,v,x,b){const w=30*e,S=15*e,T=60*e;return this.int16[w+0]=t,this.int16[w+1]=i,this.int16[w+2]=r,this.float32[S+2]=n,this.float32[S+3]=o,this.uint16[w+8]=s,this.uint16[w+9]=a,this.uint32[S+5]=l,this.uint32[S+6]=c,this.uint32[S+7]=u,this.uint16[w+16]=h,this.uint16[w+17]=d,this.uint16[w+18]=p,this.float32[S+10]=f,this.float32[S+11]=m,this.uint8[T+48]=g,this.uint8[T+49]=y,this.uint8[T+50]=_,this.uint32[S+13]=v,this.int16[w+28]=x,this.uint8[T+58]=b,e}}Bs.prototype.bytesPerElement=60,ao(Bs,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Ns extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,t,i,r,n,o,s,a,l,c,u,h,d,p,f,m,g,y,_,v,x,b,w,S,T,M,A,C,E,P,k,I){const D=this.length;return this.resize(D+1),this.emplace(D,e,t,i,r,n,o,s,a,l,c,u,h,d,p,f,m,g,y,_,v,x,b,w,S,T,M,A,C,E,P,k,I)}emplace(e,t,i,r,n,o,s,a,l,c,u,h,d,p,f,m,g,y,_,v,x,b,w,S,T,M,A,C,E,P,k,I,D){const L=20*e,R=40*e,z=80*e;return this.float32[L+0]=t,this.float32[L+1]=i,this.int16[R+4]=r,this.int16[R+5]=n,this.int16[R+6]=o,this.int16[R+7]=s,this.int16[R+8]=a,this.int16[R+9]=l,this.int16[R+10]=c,this.int16[R+11]=u,this.int16[R+12]=h,this.uint16[R+13]=d,this.uint16[R+14]=p,this.uint16[R+15]=f,this.uint16[R+16]=m,this.uint16[R+17]=g,this.uint16[R+18]=y,this.uint16[R+19]=_,this.uint16[R+20]=v,this.uint16[R+21]=x,this.uint16[R+22]=b,this.uint16[R+23]=w,this.uint16[R+24]=S,this.uint16[R+25]=T,this.uint16[R+26]=M,this.uint16[R+27]=A,this.uint32[L+14]=C,this.float32[L+15]=E,this.float32[L+16]=P,this.float32[L+17]=k,this.float32[L+18]=I,this.uint8[z+76]=D,e}}Ns.prototype.bytesPerElement=80,ao(Ns,"StructArrayLayout2f9i15ui1ul4f1ub80");class js extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.float32[1*e+0]=t,e}}js.prototype.bytesPerElement=4,ao(js,"StructArrayLayout1f4");class Vs extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i,r,n){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,i,r,n)}emplace(e,t,i,r,n,o){const s=5*e;return this.float32[s+0]=t,this.float32[s+1]=i,this.float32[s+2]=r,this.float32[s+3]=n,this.float32[s+4]=o,e}}Vs.prototype.bytesPerElement=20,ao(Vs,"StructArrayLayout5f20");class Us extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i,r,n,o,s){const a=this.length;return this.resize(a+1),this.emplace(a,e,t,i,r,n,o,s)}emplace(e,t,i,r,n,o,s,a){const l=7*e;return this.float32[l+0]=t,this.float32[l+1]=i,this.float32[l+2]=r,this.float32[l+3]=n,this.float32[l+4]=o,this.float32[l+5]=s,this.float32[l+6]=a,e}}Us.prototype.bytesPerElement=28,ao(Us,"StructArrayLayout7f28");class Gs extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i,r,n,o,s,a,l,c,u){const h=this.length;return this.resize(h+1),this.emplace(h,e,t,i,r,n,o,s,a,l,c,u)}emplace(e,t,i,r,n,o,s,a,l,c,u,h){const d=11*e;return this.float32[d+0]=t,this.float32[d+1]=i,this.float32[d+2]=r,this.float32[d+3]=n,this.float32[d+4]=o,this.float32[d+5]=s,this.float32[d+6]=a,this.float32[d+7]=l,this.float32[d+8]=c,this.float32[d+9]=u,this.float32[d+10]=h,e}}Gs.prototype.bytesPerElement=44,ao(Gs,"StructArrayLayout11f44");class Hs extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i,r,n,o,s,a,l){const c=this.length;return this.resize(c+1),this.emplace(c,e,t,i,r,n,o,s,a,l)}emplace(e,t,i,r,n,o,s,a,l,c){const u=9*e;return this.float32[u+0]=t,this.float32[u+1]=i,this.float32[u+2]=r,this.float32[u+3]=n,this.float32[u+4]=o,this.float32[u+5]=s,this.float32[u+6]=a,this.float32[u+7]=l,this.float32[u+8]=c,e}}Hs.prototype.bytesPerElement=36,ao(Hs,"StructArrayLayout9f36");class Ws extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t){const i=this.length;return this.resize(i+1),this.emplace(i,e,t)}emplace(e,t,i){const r=2*e;return this.float32[r+0]=t,this.float32[r+1]=i,e}}Ws.prototype.bytesPerElement=8,ao(Ws,"StructArrayLayout2f8");class $s extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,i,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,i,r)}emplace(e,t,i,r,n){const o=6*e;return this.uint32[3*e+0]=t,this.uint16[o+2]=i,this.uint16[o+3]=r,this.uint16[o+4]=n,e}}$s.prototype.bytesPerElement=12,ao($s,"StructArrayLayout1ul3ui12");class qs extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint16[1*e+0]=t,e}}qs.prototype.bytesPerElement=2,ao(qs,"StructArrayLayout1ui2");class Xs extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i,r,n,o,s,a,l,c,u,h,d,p,f,m){const g=this.length;return this.resize(g+1),this.emplace(g,e,t,i,r,n,o,s,a,l,c,u,h,d,p,f,m)}emplace(e,t,i,r,n,o,s,a,l,c,u,h,d,p,f,m,g){const y=16*e;return this.float32[y+0]=t,this.float32[y+1]=i,this.float32[y+2]=r,this.float32[y+3]=n,this.float32[y+4]=o,this.float32[y+5]=s,this.float32[y+6]=a,this.float32[y+7]=l,this.float32[y+8]=c,this.float32[y+9]=u,this.float32[y+10]=h,this.float32[y+11]=d,this.float32[y+12]=p,this.float32[y+13]=f,this.float32[y+14]=m,this.float32[y+15]=g,e}}Xs.prototype.bytesPerElement=64,ao(Xs,"StructArrayLayout16f64");class Ys extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i,r,n,o,s){const a=this.length;return this.resize(a+1),this.emplace(a,e,t,i,r,n,o,s)}emplace(e,t,i,r,n,o,s,a){const l=10*e,c=5*e;return this.uint16[l+0]=t,this.uint16[l+1]=i,this.uint16[l+2]=r,this.uint16[l+3]=n,this.float32[c+2]=o,this.float32[c+3]=s,this.float32[c+4]=a,e}}Ys.prototype.bytesPerElement=20,ao(Ys,"StructArrayLayout4ui3f20");class Zs extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.int16[1*e+0]=t,e}}Zs.prototype.bytesPerElement=2,ao(Zs,"StructArrayLayout1i2");class Ks extends gs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint8[1*e+0]=t,e}}Ks.prototype.bytesPerElement=1,ao(Ks,"StructArrayLayout1ub1");class Js extends ms{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Js.prototype.size=40;class Qs extends Ls{get(e){return new Js(this,e)}}ao(Qs,"CollisionBoxArray");class ea extends ms{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}ea.prototype.size=60;class ta extends Bs{get(e){return new ea(this,e)}}ao(ta,"PlacedSymbolArray");class ia extends ms{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(e){this._structArray.uint32[this._pos4+14]=e}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(e){this._structArray.float32[this._pos4+18]=e}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}ia.prototype.size=80;class ra extends Ns{get(e){return new ia(this,e)}}ao(ra,"SymbolInstanceArray");class na extends js{getoffsetX(e){return this.float32[1*e+0]}}ao(na,"GlyphOffsetArray");class oa extends vs{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}ao(oa,"SymbolLineVertexArray");class sa extends ms{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}sa.prototype.size=12;class aa extends $s{get(e){return new sa(this,e)}}ao(aa,"FeatureIndexArray");class la extends Ds{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}ao(la,"FillExtrusionCentroidArray");class ca extends ms{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}ca.prototype.size=6;class ua extends xs{get(e){return new ca(this,e)}}ao(ua,"FillExtrusionWallArray");const ha=ys([{name:"a_pos",components:2,type:"Int16"}],4),da=ys([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class pa{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.segments=e}_prepareSegment(e,t,i,r){let n=this.segments[this.segments.length-1];return e>pa.MAX_VERTEX_ARRAY_LENGTH&&pe(`Max vertices per segment is ${pa.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!n||n.vertexLength+e>pa.MAX_VERTEX_ARRAY_LENGTH||n.sortKey!==r)&&(n={vertexOffset:t,primitiveOffset:i,vertexLength:0,primitiveLength:0},void 0!==r&&(n.sortKey=r),this.segments.push(n)),n}prepareSegment(e,t,i,r){return this._prepareSegment(e,t.length,i.length,r)}get(){return this.segments}destroy(){for(const e of this.segments)for(const t in e.vaos)e.vaos[t].destroy()}static simpleSegment(e,t,i,r){return new pa([{vertexOffset:e,primitiveOffset:t,vertexLength:i,primitiveLength:r,vaos:{},sortKey:0}])}}function fa(e,t){return 256*(e=Q(Math.floor(e),0,255))+Q(Math.floor(t),0,255)}pa.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ao(pa,"SegmentVector");const ma=ys([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),ga=ys([{name:"a_dash",components:4,type:"Uint16"}]);class ya{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(e,t,i,r){this.ids.push(_a(e)),this.positions.push(t,i,r)}eachPosition(e,t){const i=_a(e);let r=0,n=this.ids.length-1;for(;r<n;){const e=r+n>>1;this.ids[e]>=i?n=e:r=e+1}for(;this.ids[r]===i;)t(this.positions[3*r],this.positions[3*r+1],this.positions[3*r+2]),r++}static serialize(e,t){const i=new Float64Array(e.ids),r=new Uint32Array(e.positions);return va(i,r,0,i.length-1),t&&(t.add(i.buffer),t.add(r.buffer)),{ids:i,positions:r}}static deserialize(e){const t=new ya;let i;t.ids=e.ids,t.positions=e.positions;for(const r of t.ids)r!==i&&t.uniqueIds.push(r),i=r;return t.indexed=!0,t}}function _a(e){const t=+e;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:yt(String(e))}function va(e,t,i,r){for(;i<r;){const n=e[i+r>>1];let o=i-1,s=r+1;for(;;){do{o++}while(e[o]<n);do{s--}while(e[s]>n);if(o>=s)break;xa(e,o,s),xa(t,3*o,3*s),xa(t,3*o+1,3*s+1),xa(t,3*o+2,3*s+2)}s-i<r-s?(va(e,t,i,s),i=s+1):(va(e,t,s+1,r),r=s)}}function xa(e,t,i){const r=e[t];e[t]=e[i],e[i]=r}ao(ya,"FeaturePositionMap");class ba{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,t){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,t),this.initialized=!0),!!this.location}set(e,t,i){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class wa extends ba{constructor(e){super(e),this.current=0}set(e,t,i){this.fetchUniformLocation(e,t)&&this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}}class Sa extends ba{constructor(e){super(e),this.current=0}set(e,t,i){this.fetchUniformLocation(e,t)&&this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))}}class Ta extends ba{constructor(e){super(e),this.current=[0,0]}set(e,t,i){this.fetchUniformLocation(e,t)&&(i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1])))}}class Ma extends ba{constructor(e){super(e),this.current=[0,0,0]}set(e,t,i){this.fetchUniformLocation(e,t)&&(i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2])))}}class Aa extends ba{constructor(e){super(e),this.current=[0,0,0,0]}set(e,t,i){this.fetchUniformLocation(e,t)&&(i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3])))}}class Ca extends ba{constructor(e){super(e),this.current=At.transparent.toRenderColor(null)}set(e,t,i){this.fetchUniformLocation(e,t)&&(i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a)))}}const Ea=new Float32Array(16);class Pa extends ba{constructor(e){super(e),this.current=Ea}set(e,t,i){if(this.fetchUniformLocation(e,t)){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let e=1;e<16;e++)if(i[e]!==this.current[e]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}}}const ka=new Float32Array(9),Ia=new Float32Array(4);class Da extends ba{constructor(e){super(e),this.current=Ia}set(e,t,i){if(this.fetchUniformLocation(e,t))for(let r=0;r<4;r++)if(i[r]!==this.current[r]){this.current=i,this.gl.uniformMatrix2fv(this.location,!1,i);break}}}function La(e){return[fa(255*e.r,255*e.g),fa(255*e.b,255*e.a)]}class Ra{constructor(e,t,i,r){this.value=e,this.uniformNames=t.map((e=>`u_${e}`)),this.type=i,this.context=r}setUniform(e,t,i,r,n){const o=r.constantOr(this.value);t.set(e,n,o instanceof At?o.toRenderColor(this.ignoreLut?null:this.context.lut):o)}getBinding(e,t){return"color"===this.type?new Ca(e):new Sa(e)}}class za{constructor(e,t){this.uniformNames=t.map((e=>`u_${e}`)),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,t,i,r,n){const o="u_pattern"===n||"u_dash"===n?this.pattern:"u_pixel_ratio"===n?this.pixelRatio:null;o&&t.set(e,n,o)}getBinding(e,t){return"u_pattern"===t||"u_dash"===t?new Aa(e):new Sa(e)}}class Oa{constructor(e,t,i,r){this.expression=e,this.type=i,this.maxValue=0,this.paintVertexAttributes=t.map((e=>({name:`a_${e}`,type:"Float32",components:"color"===i?2:1,offset:0}))),this.paintVertexArray=new r}populatePaintArray(e,t,i,r,n,o,s){const a=this.paintVertexArray.length,l="composite"===this.expression.kind||"source"===this.expression.kind?this.expression.evaluate(new Ro(0,{brightness:o}),t,{},n,r,s):"constant"===this.expression.kind&&this.expression.value;!this.lutExpression||"composite"!==this.lutExpression.kind&&"source"!==this.lutExpression.kind||(this.ignoreLut="none"===this.lutExpression.evaluate(new Ro(0,{brightness:o}),t,{},n,r,s)),this.paintVertexArray.resize(e),this._setPaintValue(a,e,l,this.context)}updatePaintArray(e,t,i,r,n,o,s){const a="composite"===this.expression.kind||"source"===this.expression.kind?this.expression.evaluate({zoom:0,brightness:s},i,r,void 0,n):"constant"===this.expression.kind&&this.expression.value;!this.lutExpression||"composite"!==this.lutExpression.kind&&"source"!==this.lutExpression.kind||(this.ignoreLut="none"===this.lutExpression.evaluate({zoom:0,brightness:s},i,r,void 0,n)),this._setPaintValue(e,t,a,this.context)}_setPaintValue(e,t,i,r){if("color"===this.type){const n=La(i.toRenderColor(this.ignoreLut?null:r.lut));for(let i=e;i<t;i++)this.paintVertexArray.emplace(i,n[0],n[1])}else{for(let r=e;r<t;r++)this.paintVertexArray.emplace(r,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&"constant"!==this.lutExpression.kind&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||"constant"!==this.expression.kind&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Fa{constructor(e,t,i,r,n,o){this.expression=e,this.uniformNames=t.map((e=>`u_${e}_t`)),this.type=i,this.useIntegerZoom=r,this.context=n,this.maxValue=0,this.paintVertexAttributes=t.map((e=>({name:`a_${e}`,type:"Float32",components:"color"===i?4:2,offset:0}))),this.paintVertexArray=new o}populatePaintArray(e,t,i,r,n,o,s){const a=this.expression.evaluate(new Ro(this.context.zoom,{brightness:o}),t,{},n,r,s),l=this.expression.evaluate(new Ro(this.context.zoom+1,{brightness:o}),t,{},n,r,s);!this.lutExpression||"composite"!==this.lutExpression.kind&&"source"!==this.lutExpression.kind||(this.ignoreLut="none"===this.lutExpression.evaluate(new Ro(this.context.zoom,{brightness:o}),t,{},n,r,s));const c=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(c,e,a,l,this.context)}updatePaintArray(e,t,i,r,n,o,s){const a=this.expression.evaluate({zoom:this.context.zoom,brightness:s},i,r,void 0,n),l=this.expression.evaluate({zoom:this.context.zoom+1,brightness:s},i,r,void 0,n);!this.lutExpression||"composite"!==this.lutExpression.kind&&"source"!==this.lutExpression.kind||(this.ignoreLut="none"===this.lutExpression.evaluate({zoom:this.context.zoom,brightness:s},i,r,void 0,n)),this._setPaintValue(e,t,a,l,this.context)}_setPaintValue(e,t,i,r,n){if("color"===this.type){const r=La(i.toRenderColor(this.ignoreLut?null:n.lut)),o=La(i.toRenderColor(this.ignoreLut?null:n.lut));for(let i=e;i<t;i++)this.paintVertexArray.emplace(i,r[0],r[1],o[0],o[1])}else{for(let n=e;n<t;n++)this.paintVertexArray.emplace(n,i,r);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(r))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,t,i,r,n){const o=this.useIntegerZoom?Math.floor(i.zoom):i.zoom,s=Q(this.expression.interpolationFactor(o,this.context.zoom,this.context.zoom+1),0,1);t.set(e,n,s)}getBinding(e,t){return new Sa(e)}}class Ba{constructor(e,t,i,r,n){this.expression=e,this.layerId=n,this.paintVertexAttributes=("array"===i?ga:ma).members;for(let o=0;o<t.length;++o);this.paintVertexArray=new r}populatePaintArray(e,t,i,r){const n=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(n,e,t.patterns&&t.patterns[this.layerId],i)}updatePaintArray(e,t,i,r,n,o,s){this._setPaintValues(e,t,i.patterns&&i.patterns[this.layerId],o)}_setPaintValues(e,t,i,r){if(!r||!i)return;const n=r[i];if(!n)return;const{tl:o,br:s,pixelRatio:a}=n;for(let l=e;l<t;l++)this.paintVertexArray.emplace(l,o[0],o[1],s[0],s[1],a)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Na{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>!0;this.binders={},this._buffers=[],this.context=t;const r=[];for(const n in e.paint._values){const o=e.paint.get(n),s=e.paint.get(`${n}-use-theme`);if(n.endsWith("-use-theme"))continue;if(!i(n))continue;if(!(o instanceof Vo&&On(o.property.specification)))continue;const a=Ua(n,e.type),l=o.value,c=o.property.specification.type,u=!!o.property.useIntegerZoom,h="line-dasharray"===n||n.endsWith("pattern"),d="line-dasharray"===n&&"constant"!==e.layout.get("line-cap").value.kind||s&&"constant"!==s.value.kind;if("constant"!==l.kind||d)if("source"===l.kind||d||h){const t=Wa(n,c,"source");this.binders[n]=h?new Ba(l,a,c,t,e.id):new Oa(l,a,c,t),r.push(`/a_${n}`)}else{const e=Wa(n,c,"composite");this.binders[n]=new Fa(l,a,c,u,t,e),r.push(`/z_${n}`)}else this.binders[n]=h?new za(l.value,a):new Ra(l.value,a,c,t),r.push(`/u_${n}`);s&&(this.binders[n].ignoreLut="none"===s.constantOr("default"),this.binders[n].lutExpression=s.value,this.binders[n].checkUseTheme=!0)}this.cacheKey=r.sort().join("")}getMaxValue(e){const t=this.binders[e];return t instanceof Oa||t instanceof Fa?t.maxValue:0}populatePaintArrays(e,t,i,r,n,o,s){for(const a in this.binders){const l=this.binders[a];l.context=this.context,l instanceof Oa||l instanceof Fa||l instanceof Ba?l.populatePaintArray(e,t,i,r,n,o,s):l.lutExpression&&l instanceof Ra&&l.lutExpression&&("composite"===l.lutExpression.kind||"source"===l.lutExpression.kind)&&(l.ignoreLut="none"===l.lutExpression.evaluate(new Ro(0,{brightness:o}),t,{},n,r,s))}}setConstantPatternPositions(e){for(const t in this.binders){const i=this.binders[t];i instanceof za&&i.setConstantPatternPositions(e)}}updatePaintArrays(e,t,i,r,n,o,s,a,l){let c=!1;const u=Object.keys(e),h=0!==u.length&&!a,d=h?u:t.uniqueIds;this.context.lut=n.lut;for(const p in this.binders){const a=this.binders[p];if(a.context=this.context,(a instanceof Oa||a instanceof Fa||a instanceof Ba)&&a.expression&&a.expression.kind&&"constant"!==a.expression.kind&&(!0===a.expression.isStateDependent||!1===a.expression.isLightConstant)){const u=n.paint.get(p);a.expression=u.value;for(const i of d){const n=e[i.toString()];t.eachPosition(i,((e,t,i)=>{const c=r.feature(e);a.updatePaintArray(t,i,c,n,o,s,l)}))}if(!h)for(const t of i.uniqueIds){const n=e[t.toString()];i.eachPosition(t,((e,t,i)=>{const c=r.feature(e);a.updatePaintArray(t,i,c,n,o,s,l)}))}c=!0}}return c}defines(){const e=[];for(const t in this.binders){const i=this.binders[t];(i instanceof Ra||i instanceof za)&&e.push(...i.uniformNames.map((e=>`#define HAS_UNIFORM_${e}`)))}return e}getBinderAttributes(){const e=[];for(const t in this.binders){const i=this.binders[t];if(i instanceof Oa||i instanceof Fa||i instanceof Ba)for(let t=0;t<i.paintVertexAttributes.length;t++)e.push(i.paintVertexAttributes[t].name)}return e}getBinderUniforms(){const e=[];for(const t in this.binders){const i=this.binders[t];if(i instanceof Ra||i instanceof za||i instanceof Fa)for(const t of i.uniformNames)e.push(t)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const t=[];for(const i in this.binders){const r=this.binders[i];if(r instanceof Ra||r instanceof za||r instanceof Fa)for(const n of r.uniformNames)t.push({name:n,property:i,binding:r.getBinding(e,n)})}return t}setUniforms(e,t,i,r,n){for(const{name:o,property:s,binding:a}of i){if(this.binders[s].checkUseTheme&&this.binders[s]instanceof Ra){const e=r.get(`${s}-use-theme`);e.isConstant()&&(this.binders[s].ignoreLut="none"===e.constantOr("default"))}this.binders[s].setUniform(e,a,n,r.get(s),o)}}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const t=this.binders[e];(t instanceof Oa||t instanceof Fa||t instanceof Ba)&&t.paintVertexBuffer&&this._buffers.push(t.paintVertexBuffer)}}upload(e){for(const t in this.binders){const i=this.binders[t];(i instanceof Oa||i instanceof Fa||i instanceof Ba)&&i.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const t=this.binders[e];(t instanceof Oa||t instanceof Fa||t instanceof Ba)&&t.destroy()}}}class ja{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>!0;this.programConfigurations={};for(const r of e)this.programConfigurations[r.id]=new Na(r,t,i);this.needsUpload=!1,this._featureMap=new ya,this._featureMapWithoutIds=new ya,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(e,t,i,r,n,o,s,a){for(const l in this.programConfigurations)this.programConfigurations[l].populatePaintArrays(e,t,r,n,o,s,a);void 0!==t.id?this._featureMap.add(t.id,i,this._bufferOffset,e):(this._featureMapWithoutIds.add(this._idlessCounter,i,this._bufferOffset,e),this._idlessCounter+=1),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,t,i,r,n,o,s){for(const a of i)this.needsUpload=this.programConfigurations[a.id].updatePaintArrays(e,this._featureMap,this._featureMapWithoutIds,t,a,r,n,o,s||0)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const Va={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Ua(e,t){return Va[e]||[e.replace(`${t}-`,"").replace(/-/g,"_")]}const Ga={"line-pattern":{source:Ms,composite:Ms},"fill-pattern":{source:Ms,composite:Ms},"fill-extrusion-pattern":{source:Ms,composite:Ms},"line-dasharray":{source:As,composite:As}},Ha={color:{source:Ws,composite:ks},number:{source:js,composite:Ws}};function Wa(e,t,i){const r=Ga[e];return r&&r[i]||Ha[t][i]}ao(Ra,"ConstantBinder"),ao(za,"PatternConstantBinder"),ao(Oa,"SourceExpressionBinder"),ao(Ba,"PatternCompositeBinder"),ao(Fa,"CompositeExpressionBinder"),ao(Na,"ProgramConfiguration",{omit:["_buffers"]}),ao(ja,"ProgramConfigurationSet");const $a=Zi/Math.PI/2,qa=5,Xa=6,Ya=16383,Za=64,Ka=[Za,32,16],Ja=-$a,Qa=$a;function el(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:$a;return i=q(i),[e*Math.sin(i)*r,-t*r,e*Math.cos(i)*r]}function tl(e,t,i){return el(Math.cos(q(e)),Math.sin(q(e)),t,i)}const il=6371008.8,rl=2*Math.PI*il;class nl{constructor(e,t){if(isNaN(e)||isNaN(t))throw new Error(`Invalid LngLat object: (${e}, ${t})`);if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new nl(te(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const t=Math.PI/180,i=this.lat*t,r=e.lat*t,n=Math.sin(i)*Math.sin(r)+Math.cos(i)*Math.cos(r)*Math.cos((e.lng-this.lng)*t);return il*Math.acos(Math.min(n,1))}toBounds(){const e=360*(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)/40075017,t=e/Math.cos(Math.PI/180*this.lat);return new ol({lng:this.lng-t,lat:this.lat-e},{lng:this.lng+t,lat:this.lat+e})}toEcef(e){return tl(this.lat,this.lng,$a+e*$a/il)}static convert(e){if(e instanceof nl)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new nl(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new nl(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class ol{constructor(e,t){if(e)if(t)this.setSouthWest(e).setNorthEast(t);else if(4===e.length){const t=e;this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]])}else{const t=e;this.setSouthWest(t[0]).setNorthEast(t[1])}}setNorthEast(e){return this._ne=e instanceof nl?new nl(e.lng,e.lat):nl.convert(e),this}setSouthWest(e){return this._sw=e instanceof nl?new nl(e.lng,e.lat):nl.convert(e),this}extend(e){const t=this._sw,i=this._ne;let r,n;if(e instanceof nl)r=e,n=e;else{if(!(e instanceof ol))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(ol.convert(e)):this.extend(nl.convert(e)):"object"==typeof e&&null!==e&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend(nl.convert(e)):this;if(r=e._sw,n=e._ne,!r||!n)return this}return t||i?(t.lng=Math.min(r.lng,t.lng),t.lat=Math.min(r.lat,t.lat),i.lng=Math.max(n.lng,i.lng),i.lat=Math.max(n.lat,i.lat)):(this._sw=new nl(r.lng,r.lat),this._ne=new nl(n.lng,n.lat)),this}getCenter(){return new nl((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new nl(this.getWest(),this.getNorth())}getSouthEast(){return new nl(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:t,lat:i}=nl.convert(e);let r=this._sw.lng<=t&&t<=this._ne.lng;return this._sw.lng>this._ne.lng&&(r=this._sw.lng>=t&&t>=this._ne.lng),this._sw.lat<=i&&i<=this._ne.lat&&r}static convert(e){if(e)return e instanceof ol?e:new ol(e)}}const sl=0,al=25.5;function ll(e){return rl*Math.cos(e*Math.PI/180)}function cl(e){return(180+e)/360}function ul(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function hl(e,t){return e/ll(t)}function dl(e){return 360*e-180}function pl(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}function fl(e,t){return e*ll(pl(t))}const ml=85.051129;function gl(e){return Math.cos(q(Q(e,-ml,ml)))}function yl(e,t){const i=Q(t,sl,al),r=Math.pow(2,i);return gl(e)*rl/(512*r)}function _l(e){return 1/Math.cos(e*Math.PI/180)}function vl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const i=Math.exp(Math.PI*(1-(e.y+t/Zi)/(1<<e.z)*2));return 80150034*i/(i*i+1)/Zi/(1<<e.z)}class xl{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.x=+e,this.y=+t,this.z=+i}static fromLngLat(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const i=nl.convert(e);return new xl(cl(i.lng),ul(i.lat),hl(t,i.lat))}toLngLat(){return new nl(dl(this.x),pl(this.y))}toAltitude(){return fl(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/rl*_l(pl(this.y))}}function bl(e,t,i,r,n,o,s,a,l){const c=(t+r)/2,u=(i+n)/2,h=new G(c,u);a(h),function(e,t,i,r,n,o){const s=i-n,a=r-o;return Math.abs((r-t)*s-(i-e)*a)/Math.hypot(s,a)}(h.x,h.y,o.x,o.y,s.x,s.y)>=l?(bl(e,t,i,c,u,o,h,a,l),bl(e,c,u,r,n,h,s,a,l)):e.push(s)}function wl(e,t,i){let r=e[0],n=r.x,o=r.y;t(r);const s=[r];for(let a=1;a<e.length;a++){const l=e[a],{x:c,y:u}=l;t(l),bl(s,n,o,c,u,r,l,t,i),n=c,o=u,r=l}return s}function Sl(e,t,i,r){if(r(t,i)){const n=t.add(i)._mult(.5);Sl(e,t,n,r),Sl(e,n,i,r)}else e.push(i)}function Tl(e,t){let i=e[0];const r=[i];for(let n=1;n<e.length;n++){const o=e[n];Sl(r,i,o,t),i=o}return r}const Ml=Math.pow(2,14)-1,Al=-Ml-1;function Cl(e,t){const i=Math.round(e.x*t),r=Math.round(e.y*t);return e.x=Q(i,Al,Ml),e.y=Q(r,Al,Ml),(i<e.x||i>e.x+1||r<e.y||r>e.y+1)&&pe("Geometry exceeds allowed extent, reduce your vector tile buffer size"),e}function El(e,t,i){const r=e.loadGeometry(),n=e.extent,o=Zi/n;if(t&&i&&i.projection.isReprojectedInTileSpace){const o=1<<t.z,{scale:s,x:a,y:l,projection:c}=i,u=e=>{const i=dl((t.x+e.x/n)/o),r=pl((t.y+e.y/n)/o),u=c.project(i,r);e.x=(u.x*s-a)*n,e.y=(u.y*s-l)*n};for(let t=0;t<r.length;t++)if(1!==e.type)r[t]=wl(r[t],u,1);else{const e=[];for(const i of r[t])i.x<0||i.x>=n||i.y<0||i.y>=n||(u(i),e.push(i));r[t]=e}}for(const s of r)for(const e of s)Cl(e,o);return r}function Pl(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?El(e):[]}}function kl(e,t,i,r,n){e.emplaceBack(2*t+(r+1)/2,2*i+(n+1)/2)}function Il(e,t,i){const r=16384;e.emplaceBack(t.x,t.y,t.z,i[0]*r,i[1]*r,i[2]*r)}class Dl{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.fqid)),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new vs,this.indexArray=new Fs,this.segments=new pa,this.programConfigurations=new ja(e.layers,{zoom:e.zoom,lut:e.lut}),this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}updateFootprints(e,t){}populate(e,t,i,r){const n=this.layers[0],o=[];let s=null;"circle"===n.type&&(s=n.layout.get("circle-sort-key"));for(const{feature:l,id:c,index:u,sourceLayerIndex:h}of e){const e=this.layers[0]._featureFilter.needGeometry,t=Pl(l,e);if(!this.layers[0]._featureFilter.filter(new Ro(this.zoom),t,i))continue;const n=s?s.evaluate(t,{},i):void 0,a={id:c,properties:l.properties,type:l.type,sourceLayerIndex:h,index:u,geometry:e?t.geometry:El(l,i,r),patterns:{},sortKey:n};o.push(a)}s&&o.sort(((e,t)=>e.sortKey-t.sortKey));let a=null;"globe"===r.projection.name&&(this.globeExtVertexArray=new Cs,a=r.projection);for(const l of o){const{geometry:r,index:n,sourceLayerIndex:o}=l,s=e[n].feature;this.addFeature(l,r,n,t.availableImages,i,a,t.brightness),t.featureIndex.insert(s,r,n,o,this.index)}}update(e,t,i,r,n,o,s){this.programConfigurations.updatePaintArrays(e,t,n,i,r,o,s)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ha.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,da.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,t,i,r,n,o,s){for(const a of t)for(const t of a){const i=t.x,r=t.y;if(i<0||i>=Zi||r<0||r>=Zi)continue;if(o){const e=o.projectTilePoint(i,r,n),t=o.upVector(n,i,r),s=this.globeExtVertexArray;Il(s,e,t),Il(s,e,t),Il(s,e,t),Il(s,e,t)}const s=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),a=s.vertexLength;kl(this.layoutVertexArray,i,r,-1,-1),kl(this.layoutVertexArray,i,r,1,-1),kl(this.layoutVertexArray,i,r,1,1),kl(this.layoutVertexArray,i,r,-1,1),this.indexArray.emplaceBack(a,a+1,a+2),this.indexArray.emplaceBack(a,a+2,a+3),s.vertexLength+=4,s.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,{},r,n,s)}}function Ll(e,t){for(let i=0;i<e.length;i++)if(Ul(t,e[i]))return!0;for(let i=0;i<t.length;i++)if(Ul(e,t[i]))return!0;return!!Fl(e,t)}function Rl(e,t,i){return!!Ul(e,t)||!!Nl(t,e,i)}function zl(e,t){if(1===e.length)return Vl(t,e[0]);for(let i=0;i<t.length;i++){const r=t[i];for(let t=0;t<r.length;t++)if(Ul(e,r[t]))return!0}for(let i=0;i<e.length;i++)if(Vl(t,e[i]))return!0;for(let i=0;i<t.length;i++)if(Fl(e,t[i]))return!0;return!1}function Ol(e,t,i){if(e.length>1){if(Fl(e,t))return!0;for(let r=0;r<t.length;r++)if(Nl(t[r],e,i))return!0}for(let r=0;r<e.length;r++)if(Nl(e[r],t,i))return!0;return!1}function Fl(e,t){if(0===e.length||0===t.length)return!1;for(let i=0;i<e.length-1;i++){const r=e[i],n=e[i+1];for(let e=0;e<t.length-1;e++)if(Bl(r,n,t[e],t[e+1]))return!0}return!1}function Bl(e,t,i,r){return fe(e,i,r)!==fe(t,i,r)&&fe(e,t,i)!==fe(e,t,r)}function Nl(e,t,i){const r=i*i;if(1===t.length)return e.distSqr(t[0])<r;for(let n=1;n<t.length;n++)if(jl(e,t[n-1],t[n])<r)return!0;return!1}function jl(e,t,i){const r=t.distSqr(i);if(0===r)return e.distSqr(t);const n=((e.x-t.x)*(i.x-t.x)+(e.y-t.y)*(i.y-t.y))/r;return e.distSqr(n<0?t:n>1?i:i.sub(t)._mult(n)._add(t))}function Vl(e,t){let i,r,n,o=!1;for(let s=0;s<e.length;s++){i=e[s];for(let e=0,s=i.length-1;e<i.length;s=e++)r=i[e],n=i[s],r.y>t.y!=n.y>t.y&&t.x<(n.x-r.x)*(t.y-r.y)/(n.y-r.y)+r.x&&(o=!o)}return o}function Ul(e,t){let i=!1;for(let r=0,n=e.length-1;r<e.length;n=r++){const o=e[r],s=e[n];o.y>t.y!=s.y>t.y&&t.x<(s.x-o.x)*(t.y-o.y)/(s.y-o.y)+o.x&&(i=!i)}return i}function Gl(e,t,i,r,n){for(const s of e)if(t<=s.x&&i<=s.y&&r>=s.x&&n>=s.y)return!0;const o=[new G(t,i),new G(t,n),new G(r,n),new G(r,i)];if(e.length>2)for(const s of o)if(Ul(e,s))return!0;for(let s=0;s<e.length-1;s++)if(Hl(e[s],e[s+1],o))return!0;return!1}function Hl(e,t,i){const r=i[0],n=i[2];if(e.x<r.x&&t.x<r.x||e.x>n.x&&t.x>n.x||e.y<r.y&&t.y<r.y||e.y>n.y&&t.y>n.y)return!1;const o=fe(e,t,i[0]);return o!==fe(e,t,i[1])||o!==fe(e,t,i[2])||o!==fe(e,t,i[3])}function Wl(e,t,i,r,n,o){let s=t.y-e.y,a=e.x-t.x;if(o=o||0){const e=s*s+a*a;if(0===e)return!0;const t=Math.sqrt(e);s/=t,a/=t}return!((i.x-e.x)*s+(i.y-e.y)*a-o<0||(r.x-e.x)*s+(r.y-e.y)*a-o<0||(n.x-e.x)*s+(n.y-e.y)*a-o<0)}function $l(e,t,i,r,n,o,s){return!(Wl(e,t,r,n,o,s)||Wl(t,i,r,n,o,s)||Wl(i,e,r,n,o,s)||Wl(r,n,e,t,i,s)||Wl(n,o,e,t,i,s)||Wl(o,r,e,t,i,s))}function ql(e,t,i){const r=t.paint.get(e).value;return"constant"===r.kind?r.value:i.programConfigurations.get(t.id).getMaxValue(e)}function Xl(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Yl(e,t,i,r,n){if(!t[0]&&!t[1])return e;const o=G.convert(t)._mult(n);"viewport"===i&&o._rotate(-r);const s=[];for(let a=0;a<e.length;a++)s.push(e[a].sub(o));return s}function Zl(e,t,i,r){const n=G.convert(e)._mult(r);return"viewport"===t&&n._rotate(-i),n}let Kl,Jl;ao(Dl,"CircleBucket",{omit:["layers"]});var Ql,ec={exports:{}},tc=(Ql||(Ql=1,function(e,t){!function(e){function t(e,t,r){var n=i(256*e,256*(t=Math.pow(2,r)-t-1),r),o=i(256*(e+1),256*(t+1),r);return n[0]+","+n[1]+","+o[0]+","+o[1]}function i(e,t,i){var r=2*Math.PI*6378137/256/Math.pow(2,i);return[e*r-2*Math.PI*6378137/2,t*r-2*Math.PI*6378137/2]}e.getURL=function(e,i,r,n,o,s){return s=s||{},e+"?"+["bbox="+t(r,n,o),"format="+(s.format||"image/png"),"service="+(s.service||"WMS"),"version="+(s.version||"1.1.1"),"request="+(s.request||"GetMap"),"srs="+(s.srs||"EPSG:3857"),"width="+(s.width||256),"height="+(s.height||256),"layers="+i].join("&")},e.getTileBBox=t,e.getMercCoords=i,Object.defineProperty(e,"__esModule",{value:!0})}(t)}(0,ec.exports)),ec.exports);class ic{constructor(e,t,i){this.z=e,this.x=t,this.y=i,this.key=oc(0,e,e,t,i)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,t){const i=tc.getTileBBox(this.x,this.y,this.z),r=function(e,t,i){let r,n="";for(let o=e;o>0;o--)r=1<<o-1,n+=(t&r?1:0)+(i&r?2:0);return n}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===t?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",r).replace("{bbox-epsg-3857}",i)}toString(){return`${this.z}/${this.x}/${this.y}`}}class rc{constructor(e,t){this.wrap=e,this.canonical=t,this.key=oc(e,t.z,t.z,t.x,t.y)}}class nc{constructor(e,t,i,r,n){this.overscaledZ=e,this.wrap=t,this.canonical=new ic(i,+r,+n),this.key=0===t&&e===i?this.canonical.key:oc(t,e,i,r,n)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const t=this.canonical.z-e;return e>this.canonical.z?new nc(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new nc(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)}calculateScaledKey(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.overscaledZ===e&&t)return this.key;if(e>this.canonical.z)return oc(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y);{const i=this.canonical.z-e;return oc(this.wrap*+t,e,e,this.canonical.x>>i,this.canonical.y>>i)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const t=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.z<this.canonical.z&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t}children(e){if(this.overscaledZ>=e)return[new nc(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const t=this.canonical.z+1,i=2*this.canonical.x,r=2*this.canonical.y;return[new nc(t,this.wrap,t,i,r),new nc(t,this.wrap,t,i+1,r),new nc(t,this.wrap,t,i,r+1),new nc(t,this.wrap,t,i+1,r+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new nc(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new nc(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new rc(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function oc(e,t,i,r,n){const o=1<<Math.min(i,22);let s=o*(n%o)+r%o;return e&&i<22&&(s+=o*o*((e<0?-2*e-1:2*e)%(1<<2*(22-i)))),16*(32*s+i)+(t-i)}const sc=[e=>{let t=e.canonical.x-1,i=e.wrap;return t<0&&(t=(1<<e.canonical.z)-1,i--),new nc(e.overscaledZ,i,e.canonical.z,t,e.canonical.y)},e=>{let t=e.canonical.x+1,i=e.wrap;return t===1<<e.canonical.z&&(t=0,i++),new nc(e.overscaledZ,i,e.canonical.z,t,e.canonical.y)},e=>new nc(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,(0===e.canonical.y?1<<e.canonical.z:e.canonical.y)-1),e=>new nc(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y===(1<<e.canonical.z)-1?0:e.canonical.y+1)];ao(ic,"CanonicalTileID"),ao(nc,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const ac=ys([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:lc}=ac,cc=ys([{name:"a_pos_3",components:3,type:"Int16"}]);var uc=ys([{name:"a_pos",type:"Int16",components:2}]);class hc{constructor(e,t){this.pos=e,this.dir=t}intersectsPlane(e,t,i){const r=N.vec3.dot(t,this.dir);if(Math.abs(r)<1e-6)return!1;const n=((e[0]-this.pos[0])*t[0]+(e[1]-this.pos[1])*t[1]+(e[2]-this.pos[2])*t[2])/r;return i[0]=this.pos[0]+this.dir[0]*n,i[1]=this.pos[1]+this.dir[1]*n,i[2]=this.pos[2]+this.dir[2]*n,!0}closestPointOnSphere(e,t,i){if(N.vec3.equals(this.pos,e)||0===t)return i[0]=i[1]=i[2]=0,!1;const[r,n,o]=this.dir,s=this.pos[0]-e[0],a=this.pos[1]-e[1],l=this.pos[2]-e[2],c=r*r+n*n+o*o,u=2*(s*r+a*n+l*o),h=u*u-4*c*(s*s+a*a+l*l-t*t);if(h<0){const e=Math.max(-u/2,0),c=s+r*e,h=a+n*e,d=l+o*e,p=Math.hypot(c,h,d);return i[0]=c*t/p,i[1]=h*t/p,i[2]=d*t/p,!1}{const e=(-u-Math.sqrt(h))/(2*c);if(e<0){const e=Math.hypot(s,a,l);return i[0]=s*t/e,i[1]=a*t/e,i[2]=l*t/e,!1}return i[0]=s+r*e,i[1]=a+n*e,i[2]=l+o*e,!0}}}class dc{constructor(e,t,i,r,n){this.TL=e,this.TR=t,this.BR=i,this.BL=r,this.horizon=n}static fromInvProjectionMatrix(e,t,i){const r=[-1,1,1],n=[1,1,1],o=[1,-1,1],s=[-1,-1,1],a=N.vec3.transformMat4(r,r,e),l=N.vec3.transformMat4(n,n,e),c=N.vec3.transformMat4(o,o,e),u=N.vec3.transformMat4(s,s,e);return new dc(a,l,c,u,t/i)}}function pc(e,t,i){let r=1/0,n=-1/0;const o=[];for(const s of e){N.vec3.sub(o,s,t);const e=N.vec3.dot(o,i);r=Math.min(r,e),n=Math.max(n,e)}return[r,n]}function fc(e,t){let i=!0;for(let r=0;r<e.planes.length;r++){const n=e.planes[r];let o=0;for(let e=0;e<t.length;e++)o+=N.vec3.dot(n,t[e])+n[3]>=0;if(0===o)return 0;o!==t.length&&(i=!1)}return i?2:1}function mc(e,t){for(const i of e.projections){const r=pc(t,e.points[0],i.axis);if(i.projection[1]<r[0]||i.projection[0]>r[1])return 0}return 1}function gc(e,t){let i=0;const r=[0,0,0,0];for(let n=0;n<e.length;n++)r[0]=e[n][0],r[1]=e[n][1],r[2]=e[n][2],r[3]=1,N.vec4.dot(r,t)>=0&&i++;return i}class yc{constructor(e,t){this.points=e||new Array(8).fill([0,0,0]),this.planes=t||new Array(6).fill([0,0,0,0]),this.bounds=_c.fromPoints(this.points),this.projections=[],this.frustumEdges=[N.vec3.sub([],this.points[2],this.points[3]),N.vec3.sub([],this.points[0],this.points[3]),N.vec3.sub([],this.points[4],this.points[0]),N.vec3.sub([],this.points[5],this.points[1]),N.vec3.sub([],this.points[6],this.points[2]),N.vec3.sub([],this.points[7],this.points[3])];for(const i of this.frustumEdges){const e=[0,-i[2],i[1]],t=[i[2],0,-i[0]];this.projections.push({axis:e,projection:pc(this.points,this.points[0],e)}),this.projections.push({axis:t,projection:pc(this.points,this.points[0],t)})}}static fromInvProjectionMatrix(e,t,i,r){const n=Math.pow(2,i),o=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((i=>{const o=N.vec4.transformMat4([],i,e),s=1/o[3]/t*n;return N.vec4.mul(o,o,[s,s,r?1/o[3]:s,s])})),s=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((e=>{const t=N.vec3.sub([],o[e[0]],o[e[1]]),i=N.vec3.sub([],o[e[2]],o[e[1]]),r=N.vec3.normalize([],N.vec3.cross([],t,i)),n=-N.vec3.dot(r,o[e[1]]);return r.concat(n)})),a=[];for(let l=0;l<o.length;l++)a.push([o[l][0],o[l][1],o[l][2]]);return new yc(a,s)}intersectsPrecise(e,t,i){for(let r=0;r<t.length;r++)if(!gc(e,t[r]))return 0;for(let r=0;r<this.planes.length;r++)if(!gc(e,this.planes[r]))return 0;for(const r of i)for(const t of this.frustumEdges){const i=N.vec3.cross([],r,t),n=N.vec3.length(i);if(0===n)continue;N.vec3.scale(i,i,1/n);const o=pc(this.points,this.points[0],i),s=pc(e,this.points[0],i);if(o[0]>s[1]||s[0]>o[1])return 0}return 1}containsPoint(e){for(const t of this.planes){const i=t[3];if(N.vec3.dot([t[0],t[1],t[2]],e)+i<0)return!1}return!0}}class _c{static fromPoints(e){const t=[1/0,1/0,1/0],i=[-1/0,-1/0,-1/0];for(const r of e)N.vec3.min(t,t,r),N.vec3.max(i,i,r);return new _c(t,i)}static fromTileIdAndHeight(e,t,i){const r=1<<e.canonical.z,n=e.canonical.x,o=e.canonical.y;return new _c([n/r,o/r,t],[(n+1)/r,(o+1)/r,i])}static applyTransform(e,t){const i=e.getCorners();for(let r=0;r<i.length;++r)N.vec3.transformMat4(i[r],i[r],t);return _c.fromPoints(i)}static applyTransformFast(e,t){const i=[t[12],t[13],t[14]],r=[...i];for(let n=0;n<3;n++)for(let o=0;o<3;o++){const s=t[4*o+n],a=s*e.min[o],l=s*e.max[o];i[n]+=Math.min(a,l),r[n]+=Math.max(a,l)}return new _c(i,r)}static projectAabbCorners(e,t){const i=e.getCorners();for(let r=0;r<i.length;++r)N.vec3.transformMat4(i[r],i[r],t);return i}constructor(e,t){this.min=e,this.max=t,this.center=N.vec3.scale([],N.vec3.add([],this.min,this.max),.5)}quadrant(e){const t=[e%2==0,e<2],i=N.vec3.clone(this.min),r=N.vec3.clone(this.max);for(let n=0;n<t.length;n++)i[n]=t[n]?this.min[n]:this.center[n],r[n]=t[n]?this.center[n]:this.max[n];return r[2]=this.max[2],new _c(i,r)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,t=this.max;return[[e[0],e[1],e[2]],[t[0],e[1],e[2]],[t[0],t[1],e[2]],[e[0],t[1],e[2]],[e[0],e[1],t[2]],[t[0],e[1],t[2]],[t[0],t[1],t[2]],[e[0],t[1],t[2]]]}intersects(e){return this.intersectsAabb(e.bounds)?fc(e,this.getCorners()):0}intersectsFlat(e){return this.intersectsAabb(e.bounds)?fc(e,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(e,t){return t||this.intersects(e)?mc(e,this.getCorners()):0}intersectsPreciseFlat(e,t){return t||this.intersectsFlat(e)?mc(e,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(e){for(let t=0;t<3;++t)if(this.min[t]>e.max[t]||e.min[t]>this.max[t])return!1;return!0}intersectsAabbXY(e){return!(this.min[0]>e.max[0]||e.min[0]>this.max[0]||this.min[1]>e.max[1]||e.min[1]>this.max[1])}encapsulate(e){for(let t=0;t<3;t++)this.min[t]=Math.min(this.min[t],e.min[t]),this.max[t]=Math.max(this.max[t],e.max[t])}encapsulatePoint(e){for(let t=0;t<3;t++)this.min[t]=Math.min(this.min[t],e[t]),this.max[t]=Math.max(this.max[t],e[t])}closestPoint(e){return[Math.max(Math.min(this.max[0],e[0]),this.min[0]),Math.max(Math.min(this.max[1],e[1]),this.min[1]),Math.max(Math.min(this.max[2],e[2]),this.min[2])]}}function vc(e){return e*$a/il}ao(_c,"Aabb");const xc=[new _c([Ja,Ja,Ja],[Qa,Qa,Qa]),new _c([Ja,Ja,Ja],[0,0,Qa]),new _c([0,Ja,Ja],[Qa,0,Qa]),new _c([Ja,0,Ja],[0,Qa,Qa]),new _c([0,0,Ja],[Qa,Qa,Qa])];function bc(e,t,i){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const n=N.vec3.scale([],e._camera.position,e.worldSize),o=[t,i,1,1];N.vec4.transformMat4(o,o,e.pixelMatrixInverse),N.vec4.scale(o,o,1/o[3]);const s=N.vec3.sub([],o,n),a=N.vec3.normalize([],s),l=e.globeMatrix,c=[l[12],l[13],l[14]],u=N.vec3.sub([],c,n),h=N.vec3.length(u),d=N.vec3.normalize([],u),p=e.worldSize/(2*Math.PI),f=N.vec3.dot(d,a),m=Math.asin(p/h);if(m<Math.acos(f)){if(!r)return null;const e=[],t=[];N.vec3.scale(e,a,h/f),N.vec3.normalize(t,N.vec3.sub(t,e,u)),N.vec3.normalize(a,N.vec3.add(a,u,N.vec3.scale(a,t,Math.tan(m)*h)))}const g=[];new hc(n,a).closestPointOnSphere(c,p,g);const y=N.vec3.normalize([],xe(l,0)),_=N.vec3.normalize([],xe(l,1)),v=N.vec3.normalize([],xe(l,2)),x=N.vec3.dot(y,g),b=N.vec3.dot(_,g),w=N.vec3.dot(v,g),S=X(Math.asin(-b/p));let T=X(Math.atan2(x,w));T=e.center.lng+function(e,t){const i=(t-e+180)%360-180;return i<-180?i+360:i}(e.center.lng,T);const M=cl(T),A=Q(ul(S),0,1);return new xl(M,A)}class wc{constructor(e,t,i){this.a=N.vec3.sub([],e,i),this.b=N.vec3.sub([],t,i),this.center=i;const r=N.vec3.normalize([],this.a),n=N.vec3.normalize([],this.b);this.angle=Math.acos(N.vec3.dot(r,n))}}function Sc(e,t){if(0===e.angle)return null;let i;return i=0===e.a[t]?1/e.angle*.5*Math.PI:1/e.angle*Math.atan(e.b[t]/e.a[t]/Math.sin(e.angle)-1/Math.tan(e.angle)),i<0||i>1?null:function(e,t,i,r){const n=Math.sin(i);return e*(Math.sin((1-r)*i)/n)+t*(Math.sin(r*i)/n)}(e.a[t],e.b[t],e.angle,Q(i,0,1))+e.center[t]}function Tc(e){if(e.z<=1)return xc[e.z+2*e.y+e.x];const t=Pc(Ec(e));return _c.fromPoints(t)}function Mc(e,t,i){return N.vec3.scale(e,e,1-i),N.vec3.scaleAndAdd(e,e,t,i)}function Ac(e,t,i){for(const r of e)N.vec3.transformMat4(r,r,t),N.vec3.scale(r,r,i)}function Cc(e,t,i,r){const n=t/e.worldSize,o=e.globeMatrix;if(i.z<=1){const e=Tc(i).getCorners();return Ac(e,o,n),_c.fromPoints(e)}const s=Ec(i,r),a=Pc(s,$a+vc(e._tileCoverLift));Ac(a,o,n);const l=Number.MAX_VALUE,c=[-l,-l,-l],u=[l,l,l];if(s.contains(e.center)){for(const e of a)N.vec3.min(u,u,e),N.vec3.max(c,c,e);c[2]=0;const t=e.point,i=[t.x*n,t.y*n,0];return N.vec3.min(u,u,i),N.vec3.max(c,c,i),new _c(u,c)}if(e._tileCoverLift>0){for(const e of a)N.vec3.min(u,u,e),N.vec3.max(c,c,e);return new _c(u,c)}const h=[o[12]*n,o[13]*n,o[14]*n],d=s.getCenter(),p=Q(e.center.lat,-ml,ml),f=Q(d.lat,-ml,ml),m=cl(e.center.lng),g=ul(p);let y=m-cl(d.lng);const _=g-ul(f);y>.5?y-=1:y<-.5&&(y+=1);let v=0;if(Math.abs(y)>Math.abs(_))v=y>=0?1:3;else{v=_>=0?0:2;const e=[o[4]*n,o[5]*n,o[6]*n],t=-Math.sin(q(_>=0?s.getSouth():s.getNorth()))*$a;N.vec3.scaleAndAdd(h,h,e,t)}const x=a[v],b=a[(v+1)%4],w=new wc(x,b,h),S=[Sc(w,0)||x[0],Sc(w,1)||x[1],Sc(w,2)||x[2]],T=Bc(e.zoom);if(T>0){const r=function(e,t,i,r,n){let{x:o,y:s,z:a}=e;const l=1/(1<<a);let c=o*l,u=c+l,h=s*l,d=h+l,p=0;const f=(c+u)/2-r;return f>.5?p=-1:f<-.5&&(p=1),c=((c+p)*t-(r*=t))*i+r,u=((u+p)*t-r)*i+r,h=(h*t-(n*=t))*i+n,d=(d*t-n)*i+n,[[c,d,0],[u,d,0],[u,h,0],[c,h,0]]}(i,t,e._pixelsPerMercatorPixel,m,g);for(let e=0;e<a.length;e++)Mc(a[e],r[e],T);const n=N.vec3.add([],r[v],r[(v+1)%4]);N.vec3.scale(n,n,.5),Mc(S,n,T)}for(const M of a)N.vec3.min(u,u,M),N.vec3.max(c,c,M);return u[2]=Math.min(x[2],b[2]),N.vec3.min(u,u,S),N.vec3.max(c,c,S),new _c(u,c)}function Ec(e){let{x:t,y:i,z:r}=e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=1/(1<<r),s=new nl(dl(t*o),i===(1<<r)-1&&n?-90:pl((i+1)*o)),a=new nl(dl((t+1)*o),0===i&&n?90:pl(i*o));return new ol(s,a)}function Pc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$a;const i=q(e.getNorth()),r=q(e.getSouth()),n=Math.cos(i),o=Math.cos(r),s=Math.sin(i),a=Math.sin(r),l=e.getWest(),c=e.getEast();return[el(o,a,l,t),el(o,a,c,t),el(n,s,c,t),el(n,s,l,t)]}function kc(e,t,i,r){const n=1<<i.z,o=(e/Zi+i.x)/n;return tl(pl((t/Zi+i.y)/n),dl(o),r)}function Ic(e){let{min:t,max:i}=e;return Ya/Math.max(i[0]-t[0],i[1]-t[1],i[2]-t[2])}const Dc=new Float64Array(16);function Lc(e){const t=Ic(e),i=N.mat4.fromScaling(Dc,[t,t,t]);return N.mat4.translate(i,i,N.vec3.negate([],e.min))}function Rc(e){const t=N.mat4.fromTranslation(Dc,e.min),i=1/Ic(e);return N.mat4.scale(t,t,[i,i,i])}function zc(e){const t=Zi/(2*Math.PI);return e/(2*Math.PI)/t}function Oc(e,t){return Zi/(512*Math.pow(2,e))*Ic(Tc(t))}function Fc(e,t,i,r,n){const o=zc(i),s=[e,t,-i/(2*Math.PI)],a=N.mat4.identity(new Float64Array(16));return N.mat4.translate(a,a,s),N.mat4.scale(a,a,[o,o,o]),N.mat4.rotateX(a,a,q(-n)),N.mat4.rotateY(a,a,q(-r)),a}function Bc(e){return ee(qa,Xa,e)}function Nc(e,t){const i=tl(t.lat,t.lng),r=function(e){const t=tl(e._center.lat,e._center.lng),i=N.vec3.fromValues(0,1,0);let r=N.vec3.cross([],i,t);const n=N.mat4.fromRotation([],-e.angle,t);r=N.vec3.transformMat4(r,r,n),N.mat4.fromRotation(n,-e._pitch,r);const o=N.vec3.normalize([],t);return N.vec3.scale(o,o,vc(e.cameraToCenterDistance/e.pixelsPerMeter)),N.vec3.transformMat4(o,o,n),N.vec3.add([],t,o)}(e),n=N.vec3.subtract([],r,i);return N.vec3.angle(n,i)}function jc(e,t){return Nc(e,t)>Math.PI/2*1.01}const Vc=q(85),Uc=Math.cos(Vc),Gc=Math.sin(Vc),Hc=N.mat4.create(),Wc=e=>{const t=[];return"map"===e.paint.get("circle-pitch-alignment")&&t.push("PITCH_WITH_MAP"),"map"===e.paint.get("circle-pitch-scale")&&t.push("SCALE_WITH_MAP"),t};function $c(e,t,i,r,n,o,s,a,l){if(o&&e.queryGeometry.isAboveHorizon)return!1;o&&(l*=e.pixelToTileUnitsFactor);const c=e.tileID.canonical,u=i.projection.upVectorScale(c,i.center.lat,i.worldSize).metersToTile;for(const h of t)for(const t of h){const h=t.add(a),d=n&&i.elevation?i.elevation.exaggeration()*n.getElevationAt(h.x,h.y,!0):0,p=i.projection.projectTilePoint(h.x,h.y,c);if(d>0){const e=i.projection.upVector(c,h.x,h.y);p.x+=e[0]*u*d,p.y+=e[1]*u*d,p.z+=e[2]*u*d}const f=o?h:qc(p.x,p.y,p.z,r),m=o?e.tilespaceRays.map((e=>Zc(e,d))):e.queryGeometry.screenGeometry,g=N.vec4.transformMat4([],[p.x,p.y,p.z,1],r);if(!s&&o?l*=g[3]/i.cameraToCenterDistance:s&&!o&&(l*=i.cameraToCenterDistance/g[3]),o){const e=pl((t.y/Zi+c.y)/(1<<c.z));l/=i.projection.pixelsPerMeter(e,1)/hl(1,e)}if(Rl(m,f,l))return!0}return!1}function qc(e,t,i,r){const n=N.vec4.transformMat4([],[e,t,i,1],r);return new G(n[0]/n[3],n[1]/n[3])}const Xc=N.vec3.fromValues(0,0,0),Yc=N.vec3.fromValues(0,0,1);function Zc(e,t){const i=N.vec3.create();return Xc[2]=t,e.intersectsPlane(Xc,Yc,i),new G(i[0],i[1])}class Kc extends Dl{}let Jc,Qc,eu,tu;function iu(e,t,i,r){let{width:n,height:o}=t;if(r){if(r instanceof Uint8ClampedArray)r=new Uint8Array(r.buffer);else if(r.length!==n*o*i)throw new RangeError("mismatched image size")}else r=new Uint8Array(n*o*i);return e.width=n,e.height=o,e.data=r,e}function ru(e,t,i){const{width:r,height:n}=t;r===e.width&&n===e.height||(nu(e,t,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,r),height:Math.min(e.height,n)},i,null),e.width=r,e.height=n,e.data=t.data)}function nu(e,t,i,r,n,o,s,a){if(0===n.width||0===n.height)return t;if(n.width>e.width||n.height>e.height||i.x>e.width-n.width||i.y>e.height-n.height)throw new RangeError("out of range source coordinates for image copy");if(n.width>t.width||n.height>t.height||r.x>t.width-n.width||r.y>t.height-n.height)throw new RangeError("out of range destination coordinates for image copy");const l=e.data,c=t.data,u=4===o&&a;for(let h=0;h<n.height;h++){const a=((i.y+h)*e.width+i.x)*o,d=((r.y+h)*t.width+r.x)*o;if(u)for(let e=0;e<n.width;e++){const t=a+e*o+3,i=d+e*o;c[i+0]=255,c[i+1]=255,c[i+2]=255,c[i+3]=l[t]}else if(s)for(let e=0;e<n.width;e++){const t=a+e*o,i=d+e*o,r=l[t+3],n=new At(l[t+0]/255*r,l[t+1]/255*r,l[t+2]/255*r,r).toRenderColor(s).toArray();c[i+0]=n[0],c[i+1]=n[1],c[i+2]=n[2],c[i+3]=n[3]}else for(let e=0;e<n.width*o;e++)c[d+e]=l[a+e]}return t}ao(Kc,"HeatmapBucket",{omit:["layers"]});class ou{constructor(e,t){iu(this,e,1,t)}resize(e){ru(this,new ou(e),1)}clone(){return new ou({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,i,r,n){nu(e,t,i,r,n,1,null)}}class su{constructor(e,t){iu(this,e,4,t)}resize(e){ru(this,new su(e),4)}replace(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new su({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,i,r,n,o,s){nu(e,t,i,r,n,4,o,s)}}class au{constructor(e,t){this.width=e.width,this.height=e.height,this.data=t instanceof Uint8Array?new Float32Array(t.buffer):t}}function lu(e){const t={},i=e.resolution||256,r=e.clips?e.clips.length:1,n=e.image||new su({width:i,height:r}),o=(i,r,o)=>{t[e.evaluationKey]=o;const s=e.expression.evaluate(t);s&&(n.data[i+r+0]=Math.floor(255*s.r/s.a),n.data[i+r+1]=Math.floor(255*s.g/s.a),n.data[i+r+2]=Math.floor(255*s.b/s.a),n.data[i+r+3]=Math.floor(255*s.a))};if(e.clips)for(let s=0,a=0;s<r;++s,a+=4*i)for(let t=0,r=0;t<i;t++,r+=4){const n=t/(i-1),{start:l,end:c}=e.clips[s];o(a,r,l*(1-n)+c*n)}else for(let s=0,a=0;s<i;s++,a+=4)o(0,a,s/(i-1));return n}ao(ou,"AlphaImage"),ao(su,"RGBAImage");const cu=ys([{name:"a_pos",components:2,type:"Int16"}],4),{members:uu}=cu;function hu(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const r=t&&t.length,n=r?t[0]*i:e.length;let o=du(e,0,n,i,!0);const s=[];if(!o||o.next===o.prev)return s;let a,l,c;if(r&&(o=function(e,t,i,r){const n=[];for(let o=0,s=t.length;o<s;o++){const i=du(e,t[o]*r,o<s-1?t[o+1]*r:e.length,r,!1);i===i.next&&(i.steiner=!0),n.push(Su(i))}n.sort(vu);for(let o=0;o<n.length;o++)i=xu(n[o],i);return i}(e,t,o,i)),e.length>80*i){a=1/0,l=1/0;let t=-1/0,r=-1/0;for(let o=i;o<n;o+=i){const i=e[o],n=e[o+1];i<a&&(a=i),n<l&&(l=n),i>t&&(t=i),n>r&&(r=n)}c=Math.max(t-a,r-l),c=0!==c?32767/c:0}return fu(o,s,i,a,l,c,0),s}function du(e,t,i,r,n){let o;if(n===function(e,t,i,r){let n=0;for(let o=t,s=i-r;o<i;o+=r)n+=(e[s]-e[o])*(e[o+1]+e[s+1]),s=o;return n}(e,t,i,r)>0)for(let s=t;s<i;s+=r)o=Lu(s/r|0,e[s],e[s+1],o);else for(let s=i-r;s>=t;s-=r)o=Lu(s/r|0,e[s],e[s+1],o);return o&&Cu(o,o.next)&&(Ru(o),o=o.next),o}function pu(e,t){if(!e)return e;t||(t=e);let i,r=e;do{if(i=!1,r.steiner||!Cu(r,r.next)&&0!==Au(r.prev,r,r.next))r=r.next;else{if(Ru(r),r=t=r.prev,r===r.next)break;i=!0}}while(i||r!==t);return t}function fu(e,t,i,r,n,o,s){if(!e)return;!s&&o&&function(e,t,i,r){let n=e;do{0===n.z&&(n.z=wu(n.x,n.y,t,i,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,function(e){let t,i=1;do{let r,n=e;e=null;let o=null;for(t=0;n;){t++;let s=n,a=0;for(let e=0;e<i&&(a++,s=s.nextZ,s);e++);let l=i;for(;a>0||l>0&&s;)0!==a&&(0===l||!s||n.z<=s.z)?(r=n,n=n.nextZ,a--):(r=s,s=s.nextZ,l--),o?o.nextZ=r:e=r,r.prevZ=o,o=r;n=s}o.nextZ=null,i*=2}while(t>1)}(n)}(e,r,n,o);let a=e;for(;e.prev!==e.next;){const l=e.prev,c=e.next;if(o?gu(e,r,n,o):mu(e))t.push(l.i,e.i,c.i),Ru(e),e=c.next,a=c.next;else if((e=c)===a){s?1===s?fu(e=yu(pu(e),t),t,i,r,n,o,2):2===s&&_u(e,t,i,r,n,o):fu(pu(e),t,i,r,n,o,1);break}}}function mu(e){const t=e.prev,i=e,r=e.next;if(Au(t,i,r)>=0)return!1;const n=t.x,o=i.x,s=r.x,a=t.y,l=i.y,c=r.y,u=n<o?n<s?n:s:o<s?o:s,h=a<l?a<c?a:c:l<c?l:c,d=n>o?n>s?n:s:o>s?o:s,p=a>l?a>c?a:c:l>c?l:c;let f=r.next;for(;f!==t;){if(f.x>=u&&f.x<=d&&f.y>=h&&f.y<=p&&Tu(n,a,o,l,s,c,f.x,f.y)&&Au(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function gu(e,t,i,r){const n=e.prev,o=e,s=e.next;if(Au(n,o,s)>=0)return!1;const a=n.x,l=o.x,c=s.x,u=n.y,h=o.y,d=s.y,p=a<l?a<c?a:c:l<c?l:c,f=u<h?u<d?u:d:h<d?h:d,m=a>l?a>c?a:c:l>c?l:c,g=u>h?u>d?u:d:h>d?h:d,y=wu(p,f,t,i,r),_=wu(m,g,t,i,r);let v=e.prevZ,x=e.nextZ;for(;v&&v.z>=y&&x&&x.z<=_;){if(v.x>=p&&v.x<=m&&v.y>=f&&v.y<=g&&v!==n&&v!==s&&Tu(a,u,l,h,c,d,v.x,v.y)&&Au(v.prev,v,v.next)>=0)return!1;if(v=v.prevZ,x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==n&&x!==s&&Tu(a,u,l,h,c,d,x.x,x.y)&&Au(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;v&&v.z>=y;){if(v.x>=p&&v.x<=m&&v.y>=f&&v.y<=g&&v!==n&&v!==s&&Tu(a,u,l,h,c,d,v.x,v.y)&&Au(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;x&&x.z<=_;){if(x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==n&&x!==s&&Tu(a,u,l,h,c,d,x.x,x.y)&&Au(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function yu(e,t){let i=e;do{const r=i.prev,n=i.next.next;!Cu(r,n)&&Eu(r,i,i.next,n)&&Iu(r,n)&&Iu(n,r)&&(t.push(r.i,i.i,n.i),Ru(i),Ru(i.next),i=e=n),i=i.next}while(i!==e);return pu(i)}function _u(e,t,i,r,n,o){let s=e;do{let e=s.next.next;for(;e!==s.prev;){if(s.i!==e.i&&Mu(s,e)){let a=Du(s,e);return s=pu(s,s.next),a=pu(a,a.next),fu(s,t,i,r,n,o,0),void fu(a,t,i,r,n,o,0)}e=e.next}s=s.next}while(s!==e)}function vu(e,t){return e.x-t.x}function xu(e,t){const i=function(e,t){let i=t;const r=e.x,n=e.y;let o,s=-1/0;do{if(n<=i.y&&n>=i.next.y&&i.next.y!==i.y){const e=i.x+(n-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(e<=r&&e>s&&(s=e,o=i.x<i.next.x?i:i.next,e===r))return o}i=i.next}while(i!==t);if(!o)return null;const a=o,l=o.x,c=o.y;let u=1/0;i=o;do{if(r>=i.x&&i.x>=l&&r!==i.x&&Tu(n<c?r:s,n,l,c,n<c?s:r,n,i.x,i.y)){const t=Math.abs(n-i.y)/(r-i.x);Iu(i,e)&&(t<u||t===u&&(i.x>o.x||i.x===o.x&&bu(o,i)))&&(o=i,u=t)}i=i.next}while(i!==a);return o}(e,t);if(!i)return t;const r=Du(i,e);return pu(r,r.next),pu(i,i.next)}function bu(e,t){return Au(e.prev,e,t.prev)<0&&Au(t.next,e,e.next)<0}function wu(e,t,i,r,n){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*n|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*n|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Su(e){let t=e,i=e;do{(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next}while(t!==e);return i}function Tu(e,t,i,r,n,o,s,a){return(n-s)*(t-a)>=(e-s)*(o-a)&&(e-s)*(r-a)>=(i-s)*(t-a)&&(i-s)*(o-a)>=(n-s)*(r-a)}function Mu(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&Eu(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}(e,t)&&(Iu(e,t)&&Iu(t,e)&&function(e,t){let i=e,r=!1;const n=(e.x+t.x)/2,o=(e.y+t.y)/2;do{i.y>o!=i.next.y>o&&i.next.y!==i.y&&n<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next}while(i!==e);return r}(e,t)&&(Au(e.prev,e,t.prev)||Au(e,t.prev,t))||Cu(e,t)&&Au(e.prev,e,e.next)>0&&Au(t.prev,t,t.next)>0)}function Au(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function Cu(e,t){return e.x===t.x&&e.y===t.y}function Eu(e,t,i,r){const n=ku(Au(e,t,i)),o=ku(Au(e,t,r)),s=ku(Au(i,r,e)),a=ku(Au(i,r,t));return n!==o&&s!==a||!(0!==n||!Pu(e,i,t))||!(0!==o||!Pu(e,r,t))||!(0!==s||!Pu(i,e,r))||!(0!==a||!Pu(i,t,r))}function Pu(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function ku(e){return e>0?1:e<0?-1:0}function Iu(e,t){return Au(e.prev,e,e.next)<0?Au(e,t,e.next)>=0&&Au(e,e.prev,t)>=0:Au(e,t,e.prev)<0||Au(e,e.next,t)<0}function Du(e,t){const i=zu(e.i,e.x,e.y),r=zu(t.i,t.x,t.y),n=e.next,o=t.prev;return e.next=t,t.prev=e,i.next=n,n.prev=i,r.next=i,i.prev=r,o.next=r,r.prev=o,r}function Lu(e,t,i,r){const n=zu(e,t,i);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function Ru(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function zu(e,t,i){return{i:e,x:t,y:i,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Ou(e,t){const i=e.length;if(i<=1)return[e];const r=[];let n,o;for(let s=0;s<i;s++){const t=me(e[s]);0!==t&&(e[s].area=Math.abs(t),void 0===o&&(o=t<0),o===t<0?(n&&r.push(n),n=[e[s]]):n.push(e[s]))}if(n&&r.push(n),t>1)for(let s=0;s<r.length;s++)r[s].length<=t||(vi(r[s],t,1,r[s].length-1,Fu),r[s]=r[s].slice(0,t));return r}function Fu(e,t){return t.area-e.area}function Bu(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(!e)return null;const r="string"==typeof e?e:e.getPrimary().id;t[r]||(t[r]=[]);const n=ei.from(r).getPrimary().scaleSelf(i);return t[r].push(n),n.serialize()}function Nu(e,t,i,r){const n=r.patternDependencies;let o=!1;for(const s of t){const t=s.paint.get(`${e}-pattern`);t.isConstant()||(o=!0),Bu(t.constantOr(null),n,i)&&(o=!0)}return o}function ju(e,t,i,r,n,o){const s=o.patternDependencies;for(const a of t){const t=a.paint.get(`${e}-pattern`).value;if("constant"!==t.kind){let e=t.evaluate({zoom:r},i,{},o.availableImages);e=e&&e.name?e.name:e;const l=Bu(e,s,n);l&&(i.patterns[a.id]=l)}}return i}class Vu{constructor(e){this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.fqid)),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new vs,this.indexArray=new Fs,this.indexArray2=new Ds,this.programConfigurations=new ja(e.layers,{zoom:e.zoom,lut:e.lut}),this.segments=new pa,this.segments2=new pa,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.projection=e.projection}updateFootprints(e,t){}populate(e,t,i,r){this.hasPattern=Nu("fill",this.layers,this.pixelRatio,t);const n=this.layers[0].layout.get("fill-sort-key"),o=[];for(const{feature:s,id:a,index:l,sourceLayerIndex:c}of e){const e=this.layers[0]._featureFilter.needGeometry,u=Pl(s,e);if(!this.layers[0]._featureFilter.filter(new Ro(this.zoom),u,i))continue;const h=n?n.evaluate(u,{},i,t.availableImages):void 0,d={id:a,properties:s.properties,type:s.type,sourceLayerIndex:c,index:l,geometry:e?u.geometry:El(s,i,r),patterns:{},sortKey:h};o.push(d)}n&&o.sort(((e,t)=>e.sortKey-t.sortKey));for(const s of o){const{geometry:r,index:n,sourceLayerIndex:o}=s;if(this.hasPattern){const e=ju("fill",this.layers,s,this.zoom,this.pixelRatio,t);this.patternFeatures.push(e)}else this.addFeature(s,r,n,i,{},t.availableImages,t.brightness,t.elevationFeatures);t.featureIndex.insert(e[n].feature,r,n,o,this.index)}}update(e,t,i,r,n,o,s){this.programConfigurations.updatePaintArrays(e,t,n,i,r,o,s)}addFeatures(e,t,i,r,n,o){for(const s of this.patternFeatures)this.addFeature(s,s.geometry,s.index,t,i,r,o,e.elevationFeatures)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,uu),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,t,i,r,n){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],s=arguments.length>6?arguments[6]:void 0;for(const a of Ou(t,500)){let e=0;for(const s of a)e+=s.length;const t=this.segments.prepareSegment(e,this.layoutVertexArray,this.indexArray),i=t.vertexLength,r=[],n=[];for(const s of a){if(0===s.length)continue;s!==a[0]&&n.push(r.length/2);const e=this.segments2.prepareSegment(s.length,this.layoutVertexArray,this.indexArray2),t=e.vertexLength;this.layoutVertexArray.emplaceBack(s[0].x,s[0].y),this.indexArray2.emplaceBack(t+s.length-1,t),r.push(s[0].x),r.push(s[0].y);for(let i=1;i<s.length;i++)this.layoutVertexArray.emplaceBack(s[i].x,s[i].y),this.indexArray2.emplaceBack(t+i-1,t+i),r.push(s[i].x),r.push(s[i].y);e.vertexLength+=s.length,e.primitiveLength+=s.length}const o=hu(r,n);for(let s=0;s<o.length;s+=3)this.indexArray.emplaceBack(i+o[s],i+o[s+1],i+o[s+2]);t.vertexLength+=e,t.primitiveLength+=o.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,n,o,r,s)}}let Uu,Gu,Hu,Wu;ao(Vu,"FillBucket",{omit:["layers","patternFeatures"]});class $u{constructor(e,t,i,r){if(this.triangleCount=t.length/3,this.min=new G(0,0),this.max=new G(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],0===this.triangleCount||0===e.length)return;const[n,o]=[e[0].clone(),e[0].clone()];for(let u=1;u<e.length;++u){const t=e[u];n.x=Math.min(n.x,t.x),n.y=Math.min(n.y,t.y),o.x=Math.max(o.x,t.x),o.y=Math.max(o.y,t.y)}if(r){const e=Math.ceil(Math.max(o.x-n.x,o.y-n.y)/r);i=Math.max(i,e)}if(0===i)return;this.min=n,this.max=o;const s=this.max.sub(this.min);s.x=Math.max(s.x,1),s.y=Math.max(s.y,1);const a=Math.max(s.x,s.y)/i;this.cellsX=Math.max(1,Math.ceil(s.x/a)),this.cellsY=Math.max(1,Math.ceil(s.y/a)),this.xScale=1/a,this.yScale=1/a;const l=[];for(let u=0;u<this.triangleCount;u++){const i=e[t[3*u+0]].sub(this.min),r=e[t[3*u+1]].sub(this.min),n=e[t[3*u+2]].sub(this.min),o=qu(Math.floor(Math.min(i.x,r.x,n.x)),this.xScale,this.cellsX),s=qu(Math.floor(Math.max(i.x,r.x,n.x)),this.xScale,this.cellsX),c=qu(Math.floor(Math.min(i.y,r.y,n.y)),this.yScale,this.cellsY),h=qu(Math.floor(Math.max(i.y,r.y,n.y)),this.yScale,this.cellsY),d=new G(0,0),p=new G(0,0),f=new G(0,0),m=new G(0,0);for(let e=c;e<=h;++e){d.y=p.y=e*a,f.y=m.y=(e+1)*a;for(let t=o;t<=s;++t)d.x=f.x=t*a,p.x=m.x=(t+1)*a,($l(i,r,n,d,p,m)||$l(i,r,n,d,m,f))&&l.push({cellIdx:e*this.cellsX+t,triIdx:u})}}if(0===l.length)return;l.sort(((e,t)=>e.cellIdx-t.cellIdx||e.triIdx-t.triIdx));let c=0;for(;c<l.length;){const e=l[c].cellIdx,t={start:this.payload.length,len:0};for(;c<l.length&&l[c].cellIdx===e;)++t.len,this.payload.push(l[c++].triIdx);this.cells[e]=t}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(e,t){if(0===this.triangleCount||0===this.cells.length)return;if(e.x>this.max.x||this.min.x>e.x||e.y>this.max.y||this.min.y>e.y)return;const i=qu(e.x-this.min.x,this.xScale,this.cellsX),r=qu(e.y-this.min.y,this.yScale,this.cellsY),n=this.cells[r*this.cellsX+i];if(n){this._lazyInitLookup();for(let e=0;e<n.len;e++){const i=this.payload[n.start+e],r=Math.floor(i/8),o=1<<i%8;if(!(this.lookup[r]&o)&&(this.lookup[r]|=o,t.push(i),t.length===this.triangleCount))return}}}query(e,t,i){if(0===this.triangleCount||0===this.cells.length)return;if(e.x>this.max.x||this.min.x>t.x)return;if(e.y>this.max.y||this.min.y>t.y)return;this._lazyInitLookup();const r=qu(e.x-this.min.x,this.xScale,this.cellsX),n=qu(t.x-this.min.x,this.xScale,this.cellsX),o=qu(e.y-this.min.y,this.yScale,this.cellsY),s=qu(t.y-this.min.y,this.yScale,this.cellsY);for(let a=o;a<=s;a++)for(let e=r;e<=n;e++){const t=this.cells[a*this.cellsX+e];if(t)for(let e=0;e<t.len;e++){const r=this.payload[t.start+e],n=Math.floor(r/8),o=1<<r%8;if(!(this.lookup[n]&o)&&(this.lookup[n]|=o,i.push(r),i.length===this.triangleCount))return}}}}function qu(e,t,i){return Math.max(0,Math.min(i-1,Math.floor(e*t)))}ao($u,"TriangleGridIndex");class Xu{constructor(e){this.zoom=e.zoom,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.fqid)),this.index=e.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.footprints=[]}updateFootprints(e,t){for(const i of this.footprints)t.push({footprint:i,id:e})}populate(e,t,i,r){const n=[];for(const{feature:o,id:s,index:a,sourceLayerIndex:l}of e){const e=this.layers[0]._featureFilter.needGeometry,t=Pl(o,e);if(!this.layers[0]._featureFilter.filter(new Ro(this.zoom),t,i))continue;const c={id:s,properties:o.properties,type:o.type,sourceLayerIndex:l,index:a,geometry:e?t.geometry:El(o,i,r),patterns:{}};n.push(c)}for(const o of n){const{geometry:r,index:n,sourceLayerIndex:s}=o;this.addFeature(o,r,n,i,{},t.availableImages,t.brightness),t.featureIndex.insert(e[n].feature,r,n,s,this.index)}}isEmpty(){return 0===this.footprints.length}uploadPending(){return!1}upload(e){}update(e,t,i,r,n,o,s){}destroy(){}addFeature(e,t,i,r,n){for(const o of Ou(t,2)){const e=[],t=[],i=[],r=new G(1/0,1/0),n=new G(-1/0,-1/0);for(const l of o)if(0!==l.length){l!==o[0]&&i.push(t.length/2);for(let i=0;i<l.length;i++)t.push(l[i].x),t.push(l[i].y),e.push(l[i]),r.x=Math.min(r.x,l[i].x),r.y=Math.min(r.y,l[i].y),n.x=Math.max(n.x,l[i].x),n.y=Math.max(n.y,l[i].y)}const s=hu(t,i),a=new $u(e,s,8,256);this.footprints.push({vertices:e,indices:s,grid:a,min:r,max:n})}}}ao(Xu,"ClipBucket",{omit:["layers"]});const Yu=ys([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Zu=ys([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),Ku=ys([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Ju=ys([{name:"a_join_normal_inside",components:3,type:"Int16"}]),Qu=ys([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),eh=ys([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:th}=Yu;var ih,rh,nh,oh,sh,ah,lh,ch={};function uh(){if(rh)return ih;rh=1;var e=U();function t(e,t,r,n,o){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=n,this._values=o,e.readFields(i,this,t)}function i(e,t,i){1==e?t.id=i.readVarint():2==e?function(e,t){for(var i=e.readVarint()+e.pos;e.pos<i;){var r=t._keys[e.readVarint()],n=t._values[e.readVarint()];t.properties[r]=n}}(i,t):3==e?t.type=i.readVarint():4==e&&(t._geometry=i.pos)}function r(e){for(var t,i,r=0,n=0,o=e.length,s=o-1;n<o;s=n++)r+=((i=e[s]).x-(t=e[n]).x)*(t.y+i.y);return r}return ih=t,t.types=["Unknown","Point","LineString","Polygon"],t.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var i,r=t.readVarint()+t.pos,n=1,o=0,s=0,a=0,l=[];t.pos<r;){if(o<=0){var c=t.readVarint();n=7&c,o=c>>3}if(o--,1===n||2===n)s+=t.readSVarint(),a+=t.readSVarint(),1===n&&(i&&l.push(i),i=[]),i.push(new e(s,a));else{if(7!==n)throw new Error("unknown command "+n);i&&i.push(i[0].clone())}}return i&&l.push(i),l},t.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,i=1,r=0,n=0,o=0,s=1/0,a=-1/0,l=1/0,c=-1/0;e.pos<t;){if(r<=0){var u=e.readVarint();i=7&u,r=u>>3}if(r--,1===i||2===i)(n+=e.readSVarint())<s&&(s=n),n>a&&(a=n),(o+=e.readSVarint())<l&&(l=o),o>c&&(c=o);else if(7!==i)throw new Error("unknown command "+i)}return[s,l,a,c]},t.prototype.toGeoJSON=function(e,i,n){var o,s,a=this.extent*Math.pow(2,n),l=this.extent*e,c=this.extent*i,u=this.loadGeometry(),h=t.types[this.type];function d(e){for(var t=0;t<e.length;t++){var i=e[t];e[t]=[360*(i.x+l)/a-180,360/Math.PI*Math.atan(Math.exp((180-360*(i.y+c)/a)*Math.PI/180))-90]}}switch(this.type){case 1:var p=[];for(o=0;o<u.length;o++)p[o]=u[o][0];d(u=p);break;case 2:for(o=0;o<u.length;o++)d(u[o]);break;case 3:for(u=function(e){var t=e.length;if(t<=1)return[e];for(var i,n,o=[],s=0;s<t;s++){var a=r(e[s]);0!==a&&(void 0===n&&(n=a<0),n===a<0?(i&&o.push(i),i=[e[s]]):i.push(e[s]))}return i&&o.push(i),o}(u),o=0;o<u.length;o++)for(s=0;s<u[o].length;s++)d(u[o][s])}1===u.length?u=u[0]:h="Multi"+h;var f={type:"Feature",geometry:{type:h,coordinates:u},properties:this.properties};return"id"in this&&(f.id=this.id),f},ih}function hh(){if(oh)return nh;oh=1;var e=uh();function t(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(i,this,t),this.length=this._features.length}function i(e,t,i){15===e?t.version=i.readVarint():1===e?t.name=i.readString():5===e?t.extent=i.readVarint():2===e?t._features.push(i.pos):3===e?t._keys.push(i.readString()):4===e&&t._values.push(function(e){for(var t=null,i=e.readVarint()+e.pos;e.pos<i;){var r=e.readVarint()>>3;t=1===r?e.readString():2===r?e.readFloat():3===r?e.readDouble():4===r?e.readVarint64():5===r?e.readVarint():6===r?e.readSVarint():7===r?e.readBoolean():null}return t}(i))}return nh=t,t.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var i=this._pbf.readVarint()+this._pbf.pos;return new e(this._pbf,i,this.extent,this._keys,this._values)},nh}function dh(){return lh||(lh=1,ch.VectorTile=function(){if(ah)return sh;ah=1;var e=hh();function t(t,i,r){if(3===t){var n=new e(r,r.readVarint()+r.pos);n.length&&(i[n.name]=n)}}return sh=function(e,i){this.layers=e.readFields(t,{},i)},sh}(),ch.VectorTileFeature=uh(),ch.VectorTileLayer=hh()),ch}var ph=dh();class fh extends G{constructor(e,t,i){super(e,t),this.z=i}}class mh extends fh{constructor(e,t,i,r){super(e,t,i),this.w=r}}function gh(e,t,i,r){const n=[],o=0===r?(e,t,i,r,n,o)=>{e.push(new G(o,i+(o-t)/(r-t)*(n-i)))}:(e,t,i,r,n,o)=>{e.push(new G(t+(o-i)/(n-i)*(r-t),o))};for(const s of e){const e=[];for(const n of s){if(n.length<=2)continue;const s=[];for(let e=0;e<n.length-1;e++){const a=n[e].x,l=n[e].y,c=n[e+1].x,u=n[e+1].y,h=0===r?a:l,d=0===r?c:u;h<t?d>t&&o(s,a,l,c,u,t):h>i?d<i&&o(s,a,l,c,u,i):s.push(n[e]),d<t&&h>=t&&o(s,a,l,c,u,t),d>i&&h<=i&&o(s,a,l,c,u,i)}let a=n[n.length-1];const l=0===r?a.x:a.y;l>=t&&l<=i&&s.push(a),s.length&&(a=s[s.length-1],s[0].x===a.x&&s[0].y===a.y||s.push(s[0]),e.push(s))}e.length&&n.push(e)}return n}function yh(e,t,i,r){const n="x"===i?"y":"x",o=(r-e[i])/(t[i]-e[i]);e[n]=e[n]+(t[n]-e[n])*o,e[i]=r,e.hasOwnProperty("z")&&(e.z=Et(e.z,t.z,o)),e.hasOwnProperty("w")&&(e.w=Et(e.w,t.w,o))}function _h(e,t,i,r){const n=i,o=r;for(const s of["x","y"]){let i=e,r=t;i[s]>=r[s]&&(i=t,r=e),i[s]<n&&r[s]>n&&yh(i,r,s,n),i[s]<o&&r[s]>o&&yh(r,i,s,o)}}const vh=Number.MAX_SAFE_INTEGER;function xh(e,t,i,r){return e.order<t||e.order===vh||!(e.clipMask&i)||function(e,t){return 0!==t.length&&void 0===t.find((t=>t===e))}(r,e.clipScope)}function bh(e,t){return e.x-t.x||e.y-t.y}function wh(e,t){return 0===bh(e.min,t.min)&&0===bh(e.max,t.max)}function Sh(e,t){return!(e.min.x>t.max.x||e.max.x<t.min.x||e.min.y>t.max.y||e.max.y<t.min.y)}function Th(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(e[i].sourceId!==t[i].sourceId||!wh(e[i],t[i])||e[i].order!==t[i].order||e[i].clipMask!==t[i].clipMask||!H(e[i].clipScope,t[i].clipScope))return!1;return!0}function Mh(e,t,i){const r=1/Zi,n=1/(1<<i.canonical.z),o=(t.x*r+i.canonical.x)*n+i.wrap,s=(t.y*r+i.canonical.y)*n;return{min:new G((e.x*r+i.canonical.x)*n+i.wrap,(e.y*r+i.canonical.y)*n),max:new G(o,s)}}function Ah(e,t,i){const r=1<<i.canonical.z,n=((t.x-i.wrap)*r-i.canonical.x)*Zi,o=(t.y*r-i.canonical.y)*Zi;return{min:new G(((e.x-i.wrap)*r-i.canonical.x)*Zi,(e.y*r-i.canonical.y)*Zi),max:new G(n,o)}}function Ch(e,t,i,r,n,o,s){const a=e.indices,l=e.vertices,c=[];for(let u=r;u<r+n;u+=3){const r=t[i[u+0]+o],n=t[i[u+1]+o],h=t[i[u+2]+o],d=Math.min(r.x,n.x,h.x),p=Math.max(r.x,n.x,h.x),f=Math.min(r.y,n.y,h.y),m=Math.max(r.y,n.y,h.y);c.length=0,e.grid.query(new G(d,f),new G(p,m),c);for(let e=0;e<c.length;e++){const t=c[e];if($l(l[a[3*t+0]],l[a[3*t+1]],l[a[3*t+2]],r,n,h,s))return!0}}return!1}function Eh(e,t,i,r){if(!e||!i)return!1;let n=e.vertices;if(!t.canonical.equals(r.canonical)||t.wrap!==r.wrap){if(i.vertices.length<e.vertices.length)return Eh(i,r,e,t);const o=t.canonical,s=r.canonical,a=Math.pow(2,s.z-o.z);n=e.vertices.map((e=>new G((e.x+o.x*Zi)*a-s.x*Zi,(e.y+o.y*Zi)*a-s.y*Zi)))}return Ch(i,n,e.indices,0,e.indices.length,0,0)}function Ph(e,t,i,r){const n=Math.pow(2,r.z-i.z);return new G((e+i.x*Zi)*n-r.x*Zi,(t+i.y*Zi)*n-r.y*Zi)}function kh(e,t){const i=[];t.grid.queryPoint(e,i);const r=t.indices,n=t.vertices;for(let o=0;o<i.length;o++){const t=i[o];if(Ul([n[r[3*t+0]],n[r[3*t+1]],n[r[3*t+2]]],e))return!0}return!1}const Ih=[new G(0,0),new G(Zi,0),new G(Zi,Zi),new G(0,Zi)];function Dh(e,t){const i=[];let r=[];if(!t||e.length<2)return[e];if(2===e.length)return Hl(e[0],e[1],Ih)?[e]:[];for(let n=0;n<e.length+2;n++){const t=e[n%e.length],o=e[(n+1)%e.length],s=Hl(0===n?e[e.length-1]:e[(n-1)%e.length],t,Ih),a=Hl(t,o,Ih),l=s||a;l&&r.push(t),l&&a||r.length>0&&(r.length>1&&i.push(r),r=[])}return r.length>1&&i.push(r),i}const Lh=ph.VectorTileFeature.types,Rh=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],zh=["fill-extrusion-flood-light-ground-radius"],Oh=Math.pow(2,13),Fh=Math.pow(2,15)-1,Bh=new G(0,1),Nh=2147483648;function jh(e,t,i,r,n,o,s,a){e.emplaceBack((t<<1)+s,(i<<1)+o,(Math.floor(r*Oh)<<1)+n,Math.round(a))}function Vh(e,t,i){e.emplaceBack(t.x*Zi,t.y*Zi,i?1:0)}function Uh(e,t,i,r,n,o){e.emplaceBack(t.x,t.y,(i.x<<1)+r,(i.y<<1)+n,o)}function Gh(e,t,i){const r=16384;e.emplaceBack(t.x,t.y,t.z,i[0]*r,i[1]*r,i[2]*r)}class Hh{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class Wh{constructor(){this.centroidXY=new G(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new G(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new G(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new G(this.max.x-this.min.x,this.max.y-this.min.y)}}class $h{constructor(){this.acc=new G(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(e,t){e.min.x===Number.MAX_VALUE&&(e.min.x=e.max.x=t.x,e.min.y=e.max.y=t.y)}appendEdge(e,t,i){this.accCount++,this.acc._add(t);let r=!!this.borders;t.x<e.min.x?(e.min.x=t.x,r=!0):t.x>e.max.x&&(e.max.x=t.x,r=!0),t.y<e.min.y?(e.min.y=t.y,r=!0):t.y>e.max.y&&(e.max.y=t.y,r=!0),((0===t.x||t.x===Zi)&&t.x===i.x)!=((0===t.y||t.y===Zi)&&t.y===i.y)&&this.processBorderOverlap(t,i),r&&this.checkBorderIntersection(t,i)}checkBorderIntersection(e,t){t.x<0!=e.x<0&&this.addBorderIntersection(0,Et(t.y,e.y,(0-t.x)/(e.x-t.x))),t.x>Zi!=e.x>Zi&&this.addBorderIntersection(1,Et(t.y,e.y,(Zi-t.x)/(e.x-t.x))),t.y<0!=e.y<0&&this.addBorderIntersection(2,Et(t.x,e.x,(0-t.y)/(e.y-t.y))),t.y>Zi!=e.y>Zi&&this.addBorderIntersection(3,Et(t.x,e.x,(Zi-t.y)/(e.y-t.y)))}addBorderIntersection(e,t){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const i=this.borders[e];t<i[0]&&(i[0]=t),t>i[1]&&(i[1]=t)}processBorderOverlap(e,t){if(e.x===t.x){if(e.y===t.y)return;const i=0===e.x?0:1;this.addBorderIntersection(i,t.y),this.addBorderIntersection(i,e.y)}else{const i=0===e.y?2:3;this.addBorderIntersection(i,t.x),this.addBorderIntersection(i,e.x)}}centroid(){return 0===this.accCount?new G(0,0):new G(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce(((e,t)=>e+ +(t[0]!==Number.MAX_VALUE)),0):0}}function qh(e,t){const i=e.add(t)._unit(),r=Q(e.x*i.x+e.y*i.y,-1,1);var n,o,s;return s=Math.acos(r),Math.min(4,Math.max(-4,Math.tan(s)))/4*Fh*((n=e).x*(o=t).y-n.y*o.x<0?-1:1)}const Xh=[e=>e.x<0,e=>e.x>Zi,e=>e.y<0,e=>e.y>Zi];function Yh(e,t,i,r){const n=[4];if(0===r)return n;i._mult(r);const o=e.sub(i),s=t.sub(i),a=[e,t,o,s];for(let l=0;l<4;l++)for(const e of a)if(Xh[l](e)){n.push(l);break}return n}class Zh{constructor(e){this.vertexArray=new ws,this.indexArray=new Fs,this.programConfigurations=new ja(e.layers,{zoom:e.zoom,lut:e.lut},(e=>zh.includes(e))),this._segments=new pa,this.hiddenByLandmarkVertexArray=new Ks,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new pa}getDefaultSegment(){return this.regionSegments[4]}hasData(){return 0!==this.vertexArray.length}addData(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const n=e.length;if(n>2){let o=Math.max(0,this._segments.get().length-1);const s=this._segments._prepareSegment(4*n,this.vertexArray.length,2*this._segmentToGroundQuads[o].length);let a;o!==this._segments.get().length-1&&(o++,this._segmentToGroundQuads[o]=[],this._segmentToRegionTriCounts[o]=[0,0,0,0,0]);{const t=e[0],i=e[1];a=qh(t.sub(e[n-1])._perp()._unit(),i.sub(t)._perp()._unit())}for(let l=0;l<n;l++){const c=l===n-1?0:l+1,u=e[l],h=e[c],d=e[c===n-1?0:c+1],p=h.sub(u)._perp()._unit(),f=qh(p,d.sub(h)._perp()._unit()),m=a,g=f;if(td(u,h,t)||r&&id(u,t)&&id(h,t)){a=f;continue}const y=s.vertexLength;Uh(this.vertexArray,u,h,1,1,m),Uh(this.vertexArray,u,h,1,0,m),Uh(this.vertexArray,u,h,0,1,g),Uh(this.vertexArray,u,h,0,0,g),s.vertexLength+=4;const _=Yh(u,h,p,i);for(const e of _)this._segmentToGroundQuads[o].push({id:y,region:e}),this._segmentToRegionTriCounts[o][e]+=2,s.primitiveLength+=2;a=f}}}prepareBorderSegments(){if(!this.hasData())return;const e=this._segments.get(),t=e.length;for(let i=0;i<t;i++)this._segmentToGroundQuads[i].sort(((e,t)=>e.region-t.region));for(let i=0;i<t;i++){const t=this._segmentToGroundQuads[i],r=e[i],n=this._segmentToRegionTriCounts[i];n.reduce(((e,t)=>e+t),0);let o=0;for(let e=0;e<=4;e++){const t=n[e];if(0!==t){let i=this.regionSegments[e];i||(i=this.regionSegments[e]=new pa);const n={vertexOffset:r.vertexOffset,primitiveOffset:r.primitiveOffset+o,vertexLength:r.vertexLength,primitiveLength:t};i.get().push(n)}o+=t}for(let e=0;e<t.length;e++){const i=t[e].id;this.indexArray.emplaceBack(i,i+1,i+3),this.indexArray.emplaceBack(i,i+3,i+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(e,t,i,r,n,o){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,e,t,i,r,n,o)}upload(e){this.hasData()&&(this.vertexBuffer=e.createVertexBuffer(this.vertexArray,Zu.members),this.indexBuffer=e.createIndexBuffer(this.indexArray))}uploadPaintProperties(e){this.hasData()&&this.programConfigurations.upload(e)}update(e,t,i,r,n,o,s){this.hasData()&&this.programConfigurations.updatePaintArrays(e,t,i,r,n,o,s)}updateHiddenByLandmark(e){if(!this.hasData())return;const t=e.groundVertexCount+e.groundVertexArrayOffset;if(0===e.groundVertexCount)return;const i=e.flags&Nh?1:0;for(let r=e.groundVertexArrayOffset;r<t;++r)this.hiddenByLandmarkVertexArray.emplace(r,i);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(e){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=e.createVertexBuffer(this.hiddenByLandmarkVertexArray,Qu.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let e=0;e<=4;e++){const t=this.regionSegments[e];t&&t.destroy()}}}}class Kh{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.pixelRatio=e.pixelRatio,this.layerIds=this.layers.map((e=>e.fqid)),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Fs,this.footprintVertices=new vs,this.footprintSegments=[],this.layoutVertexArray=new bs,this.centroidVertexArray=new la,this.wallVertexArray=new ua,this.indexArray=new Fs,this.programConfigurations=new ja(e.layers,{zoom:e.zoom,lut:e.lut},(e=>Rh.includes(e))),this.segments=new pa,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.groundEffect=new Zh(e),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(e,t){}populate(e,t,i,r){this.features=[],this.hasPattern=Nu("fill-extrusion",this.layers,this.pixelRatio,t),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=vl(i),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=0!==this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1);for(const{feature:n,id:o,index:s,sourceLayerIndex:a}of e){const e=this.layers[0]._featureFilter.needGeometry,l=Pl(n,e);if(!this.layers[0]._featureFilter.filter(new Ro(this.zoom),l,i))continue;const c={id:o,sourceLayerIndex:a,index:s,geometry:e?l.geometry:El(n,i,r),properties:n.properties,type:n.type,patterns:{}},u=this.layoutVertexArray.length,h="Polygon"===Lh[c.type];if(this.hasPattern)this.features.push(ju("fill-extrusion",this.layers,c,this.zoom,this.pixelRatio,t));else if(this.wallMode)for(const n of c.geometry)for(const e of Dh(n,h))this.addFeature(c,[e],s,i,{},t.availableImages,r,t.brightness);else this.addFeature(c,c.geometry,s,i,{},t.availableImages,r,t.brightness);t.featureIndex.insert(n,c.geometry,s,a,this.index,u)}this.sortBorders(),"mercator"===this.projection.name&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(e,t,i,r,n,o){for(const s of this.features){const e="Polygon"===Lh[s.type],{geometry:a}=s;if(this.wallMode)for(const l of a)for(const a of Dh(l,e))this.addFeature(s,[a],s.index,t,i,r,n,o);else this.addFeature(s,a,s.index,t,i,r,n,o)}this.sortBorders(),"mercator"===this.projection.name&&this.splitToSubtiles()}update(e,t,i,r,n,o,s){this.programConfigurations.updatePaintArrays(e,t,n,i,r,o,s),this.groundEffect.update(e,t,n,i,r,o,s)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,th),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.wallVertexBuffer=e.createVertexBuffer(this.wallVertexArray,Ju.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,eh.members,!0)),this.groundEffect.upload(e)),this.groundEffect.uploadPaintProperties(e),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.groundEffect.uploadHiddenByLandmark(e),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Ku.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,t,i,r,n,o,s,a){const l=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(e,{})/this.tileToMeter,c=[new G(0,0),new G(Zi,Zi)],u=s.projection,h="globe"===u.name,d=this.wallMode||"Polygon"===Lh[e.type],p=new $h;p.centroidDataIndex=this.centroidData.length;const f=new Wh,m=this.layers[0].paint.get("fill-extrusion-base").evaluate(e,{},r)<=0,g=this.layers[0].paint.get("fill-extrusion-height").evaluate(e,{},r);let y;if(f.height=g,f.vertexArrayOffset=this.layoutVertexArray.length,f.groundVertexArrayOffset=this.groundEffect.vertexArray.length,h&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Cs),this.wallMode){if(h)return void pe("Non zero fill-extrusion-line-width is not yet supported on globe.");if(1!==t.length)return;y=function(e){const t=e[0].x===e[e.length-1].x&&e[0].y===e[e.length-1].y,i=function(e){let t=0;const i=e.length;for(let r=0;r<i;r++)t+=(e[(r+1)%i].x-e[r].x)*(e[(r+1)%i].y+e[r].y);return t>=0}(e);i||(e=e.reverse());const r={geometry:[],joinNormals:[],indices:[]},n=[],o=[],s=[];let a=e.length;for(;a>=2&&e[a-1].equals(e[a-2]);)a--;if(a<(t?3:2))return r;let l,c,u,h,d,p=0;for(;p<a-1&&e[p].equals(e[p+1]);)p++;t&&(l=e[a-2],d=e[p].sub(l)._unit()._perp());for(let m=p;m<a;m++){if(u=m===a-1?t?e[p+1]:void 0:e[m+1],u&&e[m].equals(u))continue;d&&(h=d),l&&(c=l),l=e[m],d=u?u.sub(l)._unit()._perp():h,h=h||d;let i=h.add(d);0===i.x&&0===i.y||i._unit();const r=i.x*d.x+i.y*d.y,f=0!==r?1/r:1/0,g=h.x*d.y-h.y*d.x>0;let y="miter";const _=2;"miter"===y&&f>_&&(y="bevel"),"bevel"===y&&(f>100&&(y="flipbevel"),f<_&&(y="miter"));const v=(e,t,i,r)=>{const a=new G(e.x,e.y),l=new G(e.x,e.y);a.x+=t.x*r,a.y+=t.y*r,l.x-=t.x*Math.max(i,1),l.y-=t.y*Math.max(i,1),s.push(t),n.push(a),o.push(l)};if("miter"===y)i._mult(f),v(l,i,0,0);else if("flipbevel"===y)i=d.mult(-1),v(l,i,0,0),v(l,i.mult(-1),0,0);else{const e=-Math.sqrt(f*f-1),t=g?e:0,i=g?0:e;c&&v(l,h,t,i),u&&v(l,d,t,i)}}r.geometry=[...n,...o.reverse(),n[0]],r.joinNormals=[...s,...s.reverse(),s[s.length-1]];const f=r.geometry.length-1;for(let m=0;m<f/2;m++)if(m+1<f/2){let e=m,t=m+1,i=f-1-m,n=f-2-m;e=0===e?f-1:e-1,t=0===t?f-1:t-1,i=0===i?f-1:i-1,n=0===n?f-1:n-1,r.indices.push(i),r.indices.push(t),r.indices.push(e),r.indices.push(i),r.indices.push(n),r.indices.push(t)}return r}(t[0]),t=[y.geometry]}const _=(e,t)=>e<(t.length-1)/2||e===t.length-1,v=this.wallMode?[t]:Ou(t,500);for(let M=v.length-1;M>=0;M--){const e=v[M];(0===e.length||(x=e[0]).every((e=>e.x<=0))||x.every((e=>e.x>=Zi))||x.every((e=>e.y<=0))||x.every((e=>e.y>=Zi)))&&v.splice(M,1)}var x;let b;if(h)b=sd(v,c,r);else{b=[];for(const e of v)b.push({polygon:e,bounds:c})}const w=d?this.edgeRadius:0,S=w>0&&this.zoom<17,T=(e,t)=>{if(0===e.length)return!1;const i=e[e.length-1];return t.x===i.x&&t.y===i.y};for(const{polygon:M,bounds:A}of b){let e=0,t=0;for(const r of M)d&&!r[0].equals(r[r.length-1])&&r.push(r[0]),t+=d?r.length-1:r.length;const i=this.segments.prepareSegment((d?5:4)*t,this.layoutVertexArray,this.indexArray);f.footprintSegIdx<0&&(f.footprintSegIdx=this.footprintSegments.length),f.polygonSegIdx<0&&(f.polygonSegIdx=this.polygonSegments.length);const n={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},o=new Hh;if(o.vertexOffset=this.footprintVertices.length,o.indexOffset=3*this.footprintIndices.length,o.ringIndices=[],d){const t=[],n=[];e=i.vertexLength;for(let e=0;e<M.length;e++){const s=M[e];s.length&&0!==e&&n.push(t.length/2);const a=[];let c,d;c=s[1].sub(s[0])._perp()._unit(),o.ringIndices.push(s.length-1);for(let e=1;e<s.length;e++){const n=s[e],o=s[e===s.length-1?1:e+1],l=n.clone();if(w){d=o.sub(n)._perp()._unit();const e=c.add(d)._unit(),t=w*Math.min(4,1/(c.x*e.x+c.y*e.y));l.x+=t*e.x,l.y+=t*e.y,l.x=Math.round(l.x),l.y=Math.round(l.y),c=d}if(!m||0!==w&&!S||T(a,l)||a.push(l),jh(this.layoutVertexArray,l.x,l.y,0,0,1,1,0),this.wallMode){const t=_(e,s);Vh(this.wallVertexArray,y.joinNormals[e],!t)}i.vertexLength++,this.footprintVertices.emplaceBack(n.x,n.y),t.push(n.x,n.y),h&&Gh(this.layoutVertexExtArray,u.projectTilePoint(l.x,l.y,r),u.upVector(r,l.x,l.y))}m&&(0===w||S)&&(0!==a.length&&T(a,a[0])&&a.pop(),this.groundEffect.addData(a,A,l))}const s=this.wallMode?y.indices:hu(t,n);for(let r=0;r<s.length;r+=3)this.footprintIndices.emplaceBack(o.vertexOffset+s[r+0],o.vertexOffset+s[r+1],o.vertexOffset+s[r+2]),this.indexArray.emplaceBack(e+s[r],e+s[r+2],e+s[r+1]),i.primitiveLength++;o.indexCount+=s.length,o.vertexCount+=this.footprintVertices.length-o.vertexOffset}for(let s=0;s<M.length;s++){const t=M[s];p.startRing(f,t[0]);let n=t.length>4&&rd(t[t.length-2],t[0],t[1]),o=w?Qh(t[t.length-2],t[0],t[1],w):0;const a=[];let c,g,v;g=t[1].sub(t[0])._perp()._unit();let x=!0;for(let s=1,l=0;s<t.length;s++){let d=t[s-1],b=t[s];const S=t[s===t.length-1?1:s+1];if(p.appendEdge(f,b,d),td(b,d,A)){w&&(g=S.sub(b)._perp()._unit(),x=!x);continue}const M=b.sub(d)._perp(),C=M.x/(Math.abs(M.x)+Math.abs(M.y)),E=M.y>0?1:0,P=d.dist(b);if(l+P>32768&&(l=0),w){v=S.sub(b)._perp()._unit();let e=ed(d,b,S,Jh(g,v),w);isNaN(e)&&(e=0);const t=b.sub(d)._unit();d=d.add(t.mult(o))._round(),b=b.add(t.mult(-e))._round(),o=e,g=v,m&&this.zoom>=17&&(T(a,d)||a.push(d),T(a,b)||a.push(b))}const k=i.vertexLength,I=t.length>4&&rd(d,b,S);let D=nd(l,n,x);if(jh(this.layoutVertexArray,d.x,d.y,C,E,0,0,D),jh(this.layoutVertexArray,d.x,d.y,C,E,0,1,D),this.wallMode){const e=_(s-1,t),i=y.joinNormals[s-1];Vh(this.wallVertexArray,i,e),Vh(this.wallVertexArray,i,e)}if(l+=P,D=nd(l,I,!x),n=I,jh(this.layoutVertexArray,b.x,b.y,C,E,0,0,D),jh(this.layoutVertexArray,b.x,b.y,C,E,0,1,D),this.wallMode){const e=_(s,t),i=y.joinNormals[s];Vh(this.wallVertexArray,i,e),Vh(this.wallVertexArray,i,e)}if(i.vertexLength+=4,this.indexArray.emplaceBack(k+0,k+1,k+2),this.indexArray.emplaceBack(k+1,k+3,k+2),i.primitiveLength+=2,w){const r=e+(1===s?t.length-2:s-2),n=1===s?e:r+1;if(this.indexArray.emplaceBack(k+1,r,k+3),this.indexArray.emplaceBack(r,n,k+3),i.primitiveLength+=2,void 0===c&&(c=k),!td(S,t[s],A)){const e=s===t.length-1?c:i.vertexLength;this.indexArray.emplaceBack(k+2,k+3,e),this.indexArray.emplaceBack(k+3,e+1,e),this.indexArray.emplaceBack(k+3,n,e+1),i.primitiveLength+=3}x=!x}if(h){const e=this.layoutVertexExtArray,t=u.projectTilePoint(d.x,d.y,r),i=u.projectTilePoint(b.x,b.y,r),n=u.upVector(r,d.x,d.y),o=u.upVector(r,b.x,b.y);Gh(e,t,n),Gh(e,t,n),Gh(e,i,o),Gh(e,i,o)}}d&&(e+=t.length-1),m&&w&&this.zoom>=17&&(0!==a.length&&T(a,a[0])&&a.pop(),this.groundEffect.addData(a,A,l,w>0))}this.footprintSegments.push(o),n.triangleCount=this.indexArray.length-n.triangleArrayOffset,this.polygonSegments.push(n),++f.footprintSegLen,++f.polygonSegLen}if(f.vertexCount=this.layoutVertexArray.length-f.vertexArrayOffset,f.groundVertexCount=this.groundEffect.vertexArray.length-f.groundVertexArrayOffset,0!==f.vertexCount){if(f.centroidXY=p.borders?Bh:this.encodeCentroid(p,f),this.centroidData.push(f),p.borders){this.featuresOnBorder.push(p);const e=this.featuresOnBorder.length-1;for(let t=0;t<p.borders.length;t++)p.borders[t][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[t].push(e)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,n,o,r,a),this.groundEffect.addPaintPropertiesData(e,i,n,o,r,a),this.maxHeight=Math.max(this.maxHeight,g)}}sortBorders(){for(let e=0;e<this.borderFeatureIndices.length;e++)this.borderFeatureIndices[e].sort(((t,i)=>this.featuresOnBorder[t].borders[e][0]-this.featuresOnBorder[i].borders[e][0]))}splitToSubtiles(){const e=[];for(let s=0;s<this.centroidData.length;s++){const t=this.centroidData[s],i=+(t.min.y+t.max.y>Zi),r=2*i+(+(t.min.x+t.max.x>Zi)^i);for(let n=0;n<t.polygonSegLen;n++){const i=t.polygonSegIdx+n;e.push({centroidIdx:s,subtile:r,polygonSegmentIdx:i,triangleSegmentIdx:this.polygonSegments[i].triangleSegIdx})}}const t=new Fs;e.sort(((e,t)=>e.triangleSegmentIdx===t.triangleSegmentIdx?e.subtile-t.subtile:e.triangleSegmentIdx-t.triangleSegmentIdx));let i=0,r=0,n=0;for(const s of e){if(s.triangleSegmentIdx!==i)break;n++}const o=e.length;for(;r!==e.length;){i=e[r].triangleSegmentIdx;let s=0,a=r,l=r;for(let t=a;t<n&&e[t].subtile===s;t++)l++;for(;a!==n;){const r=e[a];s=r.subtile;const o=this.centroidData[r.centroidIdx].min.clone(),c=this.centroidData[r.centroidIdx].max.clone(),u={vertexOffset:this.segments.segments[i].vertexOffset,primitiveOffset:t.length,vertexLength:this.segments.segments[i].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let i=a;i<l;i++){const r=e[i],n=this.polygonSegments[r.polygonSegmentIdx],s=this.centroidData[r.centroidIdx].min,a=this.centroidData[r.centroidIdx].max,l=this.indexArray.uint16;for(let e=n.triangleArrayOffset;e<n.triangleArrayOffset+n.triangleCount;e++)t.emplaceBack(l[3*e],l[3*e+1],l[3*e+2]);u.primitiveLength+=n.triangleCount,o.x=Math.min(o.x,s.x),o.y=Math.min(o.y,s.y),c.x=Math.max(c.x,a.x),c.y=Math.max(c.y,a.y)}u.primitiveLength>0&&this.triangleSubSegments.push({segment:u,min:o,max:c}),a=l;for(let t=a;t<n&&e[t].subtile===e[a].subtile;t++)l++}r=n;for(let t=r;t<o&&e[t].triangleSegmentIdx===e[r].triangleSegmentIdx;t++)n++}t._trim(),this.indexArray=t}getVisibleSegments(e,t,i){const r=new pa;if(this.wallMode){for(const e of this.triangleSubSegments)r.segments.push(e.segment);return r}let n=0,o=0;const s=1<<e.canonical.z;if(t){const i=t.getMinMaxForTile(e);i&&(n=i.min,o=i.max)}o+=this.maxHeight;const a=e.toUnwrapped();let l;const c=[a.canonical.x/s+a.wrap,a.canonical.y/s],u=[(a.canonical.x+1)/s+a.wrap,(a.canonical.y+1)/s],h=(e,t,i)=>[e[0]*(1-i[0])+t[0]*i[0],e[1]*(1-i[1])+t[1]*i[1]],d=[],p=[];for(const f of this.triangleSubSegments){d[0]=f.min.x/Zi,d[1]=f.min.y/Zi,p[0]=f.max.x/Zi,p[1]=f.max.y/Zi;const e=h(c,u,d),t=h(c,u,p);if(0===new _c([e[0],e[1],n],[t[0],t[1],o]).intersectsPrecise(i)){l&&(r.segments.push(l),l=void 0);continue}const s=f.segment;l&&l.vertexOffset!==s.vertexOffset&&(r.segments.push(l),l=void 0),l?(l.vertexLength+=s.vertexLength,l.primitiveLength+=s.primitiveLength):l={vertexOffset:s.vertexOffset,primitiveLength:s.primitiveLength,vertexLength:s.vertexLength,primitiveOffset:s.primitiveOffset,sortKey:void 0,vaos:{}}}return l&&r.segments.push(l),r}encodeCentroid(e,t){const i=e.centroid(),r=t.span(),n=Math.min(7,Math.round(r.x*this.tileToMeter/10)),o=Math.min(7,Math.round(r.y*this.tileToMeter/10));return new G(Q(i.x,1,Zi-1)<<3|n,Q(i.y,1,Zi-1)<<3|o)}encodeBorderCentroid(e){if(!e.borders)return new G(0,0);const t=e.borders,i=Number.MAX_VALUE;if(t[0][0]!==i||t[1][0]!==i){const e=t[0][0]!==i?0:1;return new G(6|(t[0][0]!==i?0:65528),(t[e][0]+t[e][1])/2<<3|6)}{const e=t[2][0]!==i?2:3;return new G((t[e][0]+t[e][1])/2<<3|6,6|(t[2][0]!==i?0:65528))}}showCentroid(e){const t=this.centroidData[e.centroidDataIndex];t.flags&=Nh,t.centroidXY.x=0,t.centroidXY.y=0,this.writeCentroidToBuffer(t)}writeCentroidToBuffer(e){this.groundEffect.updateHiddenByLandmark(e);const t=e.vertexArrayOffset,i=e.vertexCount+e.vertexArrayOffset,r=e.flags&Nh?Bh:e.centroidXY,n=this.centroidVertexArray.geta_centroid_pos0(t);if(this.centroidVertexArray.geta_centroid_pos1(t)!==r.y||n!==r.x){for(let e=t;e<i;++e)this.centroidVertexArray.emplace(e,r.x,r.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const e of this.centroidData)this.writeCentroidToBuffer(e)}updateReplacement(e,t,i){if(t.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=t.updateTime;const r=t.getReplacementRegionsForTile(e.toUnwrapped());if(Th(this.activeReplacements,r))return;if(this.activeReplacements=r,0===this.centroidVertexArray.length)this.createCentroidsBuffer();else for(const o of this.centroidData)o.flags&=2147483647;const n=[];for(const o of this.activeReplacements){if(o.order<i)continue;const t=Math.max(1,Math.pow(2,o.footprintTileId.canonical.z-e.canonical.z));for(const i of this.centroidData)if(!(i.flags&Nh||o.min.x>i.max.x||i.min.x>o.max.x||o.min.y>i.max.y||i.min.y>o.max.y))for(let r=0;r<i.footprintSegLen;r++){const s=this.footprintSegments[i.footprintSegIdx+r];if(n.length=0,ad(this.footprintVertices,s.vertexOffset,s.vertexCount,o.footprintTileId.canonical,e.canonical,n),Ch(o.footprint,n,this.footprintIndices.uint16,s.indexOffset,s.indexCount,-s.vertexOffset,-t)){i.flags|=Nh;break}}}for(const o of this.centroidData)this.writeCentroidToBuffer(o);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(e,t,i){let r=!1;for(let n=0;n<i.footprintSegLen;n++){const o=this.footprintSegments[i.footprintSegIdx+n];let s=0;for(const i of o.ringIndices){for(let n=s,a=i+s-1;n<i+s;a=n++){const i=this.footprintVertices.int16[2*(n+o.vertexOffset)+0],s=this.footprintVertices.int16[2*(n+o.vertexOffset)+1],l=this.footprintVertices.int16[2*(a+o.vertexOffset)+1];s>t!=l>t&&e<(this.footprintVertices.int16[2*(a+o.vertexOffset)+0]-i)*(t-s)/(l-s)+i&&(r=!r)}s=i}}return r}getHeightAtTileCoord(e,t){let i=Number.NEGATIVE_INFINITY,r=!0;const n=4*(e+Zi)*Zi+(t+Zi);if(this.partLookup.hasOwnProperty(n)){const e=this.partLookup[n];return e?{height:e.height,hidden:!!(e.flags&Nh)}:void 0}for(const o of this.centroidData)e>o.max.x||o.min.x>e||t>o.max.y||o.min.y>t||this.footprintContainsPoint(e,t,o)&&o&&o.height>i&&(i=o.height,this.partLookup[n]=o,r=!!(o.flags&Nh));if(i!==Number.NEGATIVE_INFINITY)return{height:i,hidden:r};this.partLookup[n]=void 0}}function Jh(e,t){const i=e.add(t)._unit();return e.x*i.x+e.y*i.y}function Qh(e,t,i,r){const n=t.sub(e)._perp()._unit(),o=i.sub(t)._perp()._unit();return ed(e,t,i,Jh(n,o),r)}function ed(e,t,i,r,n){const o=Math.sqrt(1-r*r);return Math.min(e.dist(t)/3,t.dist(i)/3,n*o/r)}function td(e,t,i){return e.x<i[0].x&&t.x<i[0].x||e.x>i[1].x&&t.x>i[1].x||e.y<i[0].y&&t.y<i[0].y||e.y>i[1].y&&t.y>i[1].y}function id(e,t){return e.x<t[0].x||e.x>t[1].x||e.y<t[0].y||e.y>t[1].y}function rd(e,t,i){if(e.x<0||e.x>=Zi||t.x<0||t.x>=Zi||i.x<0||i.x>=Zi)return!1;const r=i.sub(t),n=r.perp(),o=e.sub(t);return(r.x*o.x+r.y*o.y)/Math.sqrt((r.x*r.x+r.y*r.y)*(o.x*o.x+o.y*o.y))>-.866&&n.x*o.x+n.y*o.y<0}function nd(e,t,i){const r=t?2|e:-3&e;return i?1|r:-2&r}function od(){const e=Math.PI/32,t=Math.tan(e),i=il;return i*Math.sqrt(1+2*t*t)-i}function sd(e,t,i){const r=1<<i.z,n=dl(i.x/r),o=dl((i.x+1)/r),s=pl(i.y/r),a=pl((i.y+1)/r);return function(e,t,i,r){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5?arguments[5]:void 0;const s=[];if(!e.length||!i||!r)return s;const a=(e,t)=>{for(const i of e)s.push({polygon:i,bounds:t})},l=Math.ceil(Math.log2(i)),c=Math.ceil(Math.log2(r)),u=l-c,h=[];for(let f=0;f<Math.abs(u);f++)h.push(u>0?0:1);for(let f=0;f<Math.min(l,c);f++)h.push(0),h.push(1);let d=e;if(d=gh(d,t[0].y-n,t[1].y+n,1),d=gh(d,t[0].x-n,t[1].x+n,0),!d.length)return s;const p=[];for(h.length?p.push({polygons:d,bounds:t,depth:0}):a(d,t);p.length;){const e=p.pop(),t=e.depth,i=h[t],r=e.bounds[0],s=e.bounds[1],l=0===i?r.x:r.y,c=0===i?s.x:s.y,u=o?o(i,l,c):.5*(l+c),d=gh(e.polygons,l-n,u+n,i),f=gh(e.polygons,u-n,c+n,i);if(d.length){const e=[r,new G(0===i?u:s.x,1===i?u:s.y)];h.length>t+1?p.push({polygons:d,bounds:e,depth:t+1}):a(d,e)}if(f.length){const e=[new G(0===i?u:r.x,1===i?u:r.y),s];h.length>t+1?p.push({polygons:f,bounds:e,depth:t+1}):a(f,e)}}return s}(e,t,Math.ceil((o-n)/11.25),Math.ceil((s-a)/11.25),1,((e,t,n)=>{if(0===e)return.5*(t+n);{const e=pl((i.y+t/Zi)/r);return(ul(.5*(pl((i.y+n/Zi)/r)+e))*r-i.y)*Zi}}))}function ad(e,t,i,r,n,o){const s=Math.pow(2,r.z-n.z);for(let a=0;a<i;a++){let i=e.int16[2*(a+t)+0],l=e.int16[2*(a+t)+1];i=(i+n.x*Zi)*s-r.x*Zi,l=(l+n.y*Zi)*s-r.y*Zi,o.push(new G(i,l))}}let ld,cd;function ud(e,t){return e.x*t.x+e.y*t.y}function hd(e,t){if(1===e.length){let i=0;const r=t[i++];let n;for(;!n||r.equals(n);)if(n=t[i++],!n)return 1/0;for(;i<t.length;i++){const o=t[i],s=e[0],a=n.sub(r),l=o.sub(r),c=s.sub(r),u=ud(a,a),h=ud(a,l),d=ud(l,l),p=ud(c,a),f=ud(c,l),m=u*d-h*h,g=(d*p-h*f)/m,y=(u*f-h*p)/m,_=r.z*(1-g-y)+n.z*g+o.z*y;if(isFinite(_))return _}return 1/0}{let e=1/0;for(const i of t)e=Math.min(e,i.z);return e}}function dd(e,t,i,r,n,o,s,a){const l=s*n.getElevationAt(e,t,!0,!0),c=0!==o[0],u=c?0===o[1]?s*(o[0]/7-450):s*function(e,t,i){const r=Math.floor(t[0]/8),n=Math.floor(t[1]/8),o=10*(t[0]-8*r),s=10*(t[1]-8*n),a=e.getElevationAt(r,n,!0,!0),l=e.getMeterToDEM(i),c=Math.floor(.5*(o*l-1)),u=Math.floor(.5*(s*l-1)),h=e.tileCoordToPixel(r,n),d=2*c+1,p=2*u+1,f=function(e,t,i,r,n){return[e.getElevationAtPixel(t,i,!0),e.getElevationAtPixel(t+n,i,!0),e.getElevationAtPixel(t,i+n,!0),e.getElevationAtPixel(t+r,i+n,!0)]}(e,h.x-c,h.y-u,d,p),m=Math.abs(f[0]-f[1]),g=Math.abs(f[2]-f[3]),y=Math.abs(f[0]-f[2])+Math.abs(f[1]-f[3]),_=Math.min(.25,.5*l*(m+g)/d),v=Math.min(.25,.5*l*y/p);return a+Math.max(_*o,v*s)}(n,o,a):l;return{base:l+(0===i?-1:i),top:c?Math.max(u+r,l+i+2):l+r}}ao(Kh,"FillExtrusionBucket",{omit:["layers","features"]}),ao(Wh,"PartData"),ao(Hh,"FootprintSegment"),ao($h,"BorderCentroidData"),ao(Zh,"GroundEffect");const pd=ys([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),fd=ys([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:md}=pd,gd=ys([{name:"a_packed",components:3,type:"Float32"}]),{members:yd}=gd,_d=ys([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:vd}=_d;class xd{constructor(e,t){this.width=e,this.height=t,this.nextRow=0,this.image=new ou({width:e,height:t}),this.positions={},this.uploaded=!1}getDash(e,t){const i=this.getKey(e,t);return this.positions[i]}trim(){const e=this.width,t=this.height=se(this.nextRow);this.image.resize({width:e,height:t})}getKey(e,t){return e.join(",")+t}getDashRanges(e,t,i){const r=[];let n=e.length%2==1?-e[e.length-1]*i:0,o=e[0]*i,s=!0;r.push({left:n,right:o,isDash:s,zeroLength:0===e[0]});let a=e[0];for(let l=1;l<e.length;l++){s=!s;const t=e[l];n=a*i,a+=t,o=a*i,r.push({left:n,right:o,isDash:s,zeroLength:0===t})}return r}addRoundDash(e,t,i){const r=t/2;for(let n=-i;n<=i;n++){const t=this.width*(this.nextRow+i+n);let o=0,s=e[o];for(let a=0;a<this.width;a++){a/s.right>1&&(s=e[++o]);const l=Math.abs(a-s.left),c=Math.abs(a-s.right),u=Math.min(l,c);let h;const d=n/i*(r+1);if(s.isDash){const e=r-Math.abs(d);h=Math.sqrt(u*u+e*e)}else h=r-Math.sqrt(u*u+d*d);this.image.data[t+a]=Math.max(0,Math.min(255,h+128))}}}addRegularDash(e,t){for(let a=e.length-1;a>=0;--a){const t=e[a],i=e[a+1];t.zeroLength?e.splice(a,1):i&&i.isDash===t.isDash&&(i.left=t.left,e.splice(a,1))}const i=e[0],r=e[e.length-1];i.isDash===r.isDash&&(i.left=r.left-this.width,r.right=i.right+this.width);const n=this.width*this.nextRow;let o=0,s=e[o];for(let a=0;a<this.width;a++){a/s.right>1&&(s=e[++o]);const i=Math.abs(a-s.left),r=Math.abs(a-s.right),l=Math.min(i,r);this.image.data[n+a]=Math.max(0,Math.min(255,(s.isDash?l:-l)+t+128))}}addDash(e,t){const i=this.getKey(e,t);if(this.positions[i])return this.positions[i];const r="round"===t,n=r?7:0,o=2*n+1;if(this.nextRow+o>this.height)return pe("LineAtlas out of space"),null;0===e.length&&e.push(1);let s=0;for(let c=0;c<e.length;c++)e[c]<0&&(pe("Negative value is found in line dasharray, replacing values with 0"),e[c]=0),s+=e[c];if(0!==s){const i=this.width/s,o=this.getDashRanges(e,this.width,i);r?this.addRoundDash(o,i,n):this.addRegularDash(o,"square"===t?.5*i:0)}const a=this.nextRow+n;this.nextRow+=o;const l={tl:[a,n],br:[s,0]};return this.positions[i]=l,l}}ao(xd,"LineAtlas");const bd=ph.VectorTileFeature.types,wd=Math.cos(Math.PI/180*37.5),Sd=Math.cos(Math.PI/180*5);class Td{constructor(e){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.zoom=e.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=e.overscaling,this.pixelRatio=e.pixelRatio,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.fqid)),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.hasZOffset=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((e=>{this.gradients[e.id]={}})),this.layoutVertexArray=new Ss,this.layoutVertexArray2=new Ts,this.patternVertexArray=new Ts,this.indexArray=new Fs,this.programConfigurations=new ja(e.layers,{zoom:e.zoom,lut:e.lut}),this.segments=new pa,this.maxLineLength=0,this.zOffsetVertexArray=new Ts,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.tessellationStep=e.tessellationStep?e.tessellationStep:Zi/64}updateFootprints(e,t){}populate(e,t,i,r){this.hasPattern=Nu("line",this.layers,this.pixelRatio,t);const n=this.layers[0].layout.get("line-sort-key");this.tileToMeter=vl(i);const o=this.layers[0].layout.get("line-z-offset"),s=o.isConstant()&&!o.constantOr(0),a=this.layers[0].layout.get("line-elevation-reference");this.hasZOffset="sea"===a||"ground"===a||!s&&"none"===a,this.hasZOffset&&"none"===a&&pe(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`);const l=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.hasZOffset&&void 0!==l;const c=[];for(const{feature:p,id:f,index:m,sourceLayerIndex:g}of e){const e=this.layers[0]._featureFilter.needGeometry,t=Pl(p,e);if(!this.layers[0]._featureFilter.filter(new Ro(this.zoom),t,i))continue;const o=n?n.evaluate(t,{},i):void 0,s={id:f,properties:p.properties,type:p.type,sourceLayerIndex:g,index:m,geometry:e?t.geometry:El(p,i,r),patterns:{},sortKey:o};c.push(s)}n&&c.sort(((e,t)=>e.sortKey-t.sortKey));const{lineAtlas:u,featureIndex:h}=t,d=this.addConstantDashes(u);for(const p of c){const{geometry:r,index:n,sourceLayerIndex:o}=p;if(d&&this.addFeatureDashes(p,u),this.hasPattern){const e=ju("line",this.layers,p,this.zoom,this.pixelRatio,t);this.patternFeatures.push(e)}else this.addFeature(p,r,n,i,u.positions,t.availableImages,t.brightness);h.insert(e[n].feature,r,n,o,this.index)}}addConstantDashes(e){let t=!1;for(const i of this.layers){const r=i.paint.get("line-dasharray").value,n=i.layout.get("line-cap").value;if("constant"!==r.kind||"constant"!==n.kind)t=!0;else{const t=n.value,i=r.value;if(!i)continue;e.addDash(i,t)}}return t}addFeatureDashes(e,t){const i=this.zoom;for(const r of this.layers){const n=r.paint.get("line-dasharray").value,o=r.layout.get("line-cap").value;if("constant"===n.kind&&"constant"===o.kind)continue;let s,a;if("constant"===n.kind){if(s=n.value,!s)continue}else s=n.evaluate({zoom:i},e);a="constant"===o.kind?o.value:o.evaluate({zoom:i},e),t.addDash(s,a),e.patterns[r.id]=t.getKey(s,a)}}update(e,t,i,r,n,o,s){this.programConfigurations.updatePaintArrays(e,t,n,i,r,o,s)}addFeatures(e,t,i,r,n,o){for(const s of this.patternFeatures)this.addFeature(s,s.geometry,s.index,t,i,r,o)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,yd)),0!==this.patternVertexArray.length&&(this.patternVertexBuffer=e.createVertexBuffer(this.patternVertexArray,vd)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=e.createVertexBuffer(this.zOffsetVertexArray,fd.members,!0)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,md),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,t,i,r,n,o,s){const a=this.layers[0].layout,l=a.get("line-join").evaluate(e,{}),c=a.get("line-cap").evaluate(e,{}),u=a.get("line-miter-limit"),h=a.get("line-round-limit");this.lineClips=this.lineFeatureClips(e),this.lineFeature=e,this.zOffsetValue=a.get("line-z-offset").value;const d=this.layers[0].paint.get("line-width").value;"constant"!==d.kind&&!1===d.isLineProgressConstant&&(this.variableWidthValue=d);for(const p of t)this.addLine(p,e,r,l,c,u,h);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,n,o,r,s)}addLine(e,t,i,r,n,o,s){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const a="none"===r;if(this.patternJoinNone=this.hasPattern&&a,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let t=0;t<e.length-1;t++)this.totalDistance+=e[t].dist(e[t+1]);this.totalFeatureLength=this.totalDistance/(this.lineClips.end-this.lineClips.start),this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const l="Polygon"===bd[t.type];let c=e.length;for(;c>=2&&e[c-1].equals(e[c-2]);)c--;let u=0;for(;u<c-1&&e[u].equals(e[u+1]);)u++;if(c<(l?3:2))return;"bevel"===r&&(o=1.05);const h=this.segments.prepareSegment(10*c,this.layoutVertexArray,this.indexArray);let d,p,f,m,g,y;this.e1=this.e2=-1,l&&(d=e[c-2],g=e[u].sub(d)._unit()._perp());for(let _=u;_<c;_++){if(f=_===c-1?l?e[u+1]:void 0:e[_+1],f&&e[_].equals(f))continue;g&&(m=g),d&&(p=d),d=e[_],y=this.evaluateLineProgressFeatures(p?p.dist(d):0),g=f?f.sub(d)._unit()._perp():m,m=m||g;const t=p&&f;let i=t?r:l||a?"butt":n;const v=m.x*g.x+m.y*g.y;if(a){const e=function(e){if(e.patternJoinNone){const t=e.segmentPoints.length/2,i=e.lineSoFar-e.segmentStart;for(let r=0;r<t;++r){const t=e.segmentPoints[2*r+1],n=Math.round(e.segmentPoints[2*r])+.5+.25*t;e.patternVertexArray.emplaceBack(n,i,e.segmentStart),e.patternVertexArray.emplaceBack(n,i,e.segmentStart)}e.segmentPoints.length=0}e.e1=e.e2=-1};if(t&&v<Sd){this.updateDistance(p,d),this.addCurrentVertex(d,m,1,1,h,y),e(this),this.addCurrentVertex(d,g,-1,-1,h,y);continue}if(p){if(!f){this.updateDistance(p,d),this.addCurrentVertex(d,m,1,1,h,y),e(this);continue}i="miter"}}let x=m.add(g);0===x.x&&0===x.y||x._unit();const b=x.x*g.x+x.y*g.y,w=0!==b?1/b:1/0,S=2*Math.sqrt(2-2*b),T=b<wd&&p&&f,M=m.x*g.y-m.y*g.x>0,A=this.overscaling<=16?15*Zi/(512*this.overscaling):0;if(t&&"round"===i)if(w<s)i="miter";else if(w<=2){const e=Md(d,-10,Zi+10);i=this.hasZOffset&&(e||this.hasCrossSlope)?"miter":"fakeround"}if("miter"===i&&w>o&&(i="bevel"),"bevel"===i&&(w>2&&(i="flipbevel"),w<o&&(i="miter")),p&&!("miter"===i&&T)&&this.updateDistance(p,d),"miter"===i)if(T){const e=d.dist(p);if(e>2*A){const t=d.sub(d.sub(p)._mult(A/e)._round());this.updateDistance(p,t),this.addCurrentVertex(t,m,0,0,h,y),p=t}this.updateDistance(p,d),x._mult(w),this.addCurrentVertex(d,x,0,0,h,y);const t=d.dist(f);if(t>2*A){const e=d.add(f.sub(d)._mult(A/t)._round());this.updateDistance(d,e),this.addCurrentVertex(e,g,0,0,h,y),d=e}}else x._mult(w),this.addCurrentVertex(d,x,0,0,h,y);else if("flipbevel"===i){if(w>100)x=g.mult(-1);else{const e=w*m.add(g).mag()/m.sub(g).mag();x._perp()._mult(e*(M?-1:1))}this.addCurrentVertex(d,x,0,0,h,y),this.addCurrentVertex(d,x.mult(-1),0,0,h,y)}else if("bevel"===i||"fakeround"===i){null!=y&&p&&this.addCurrentVertex(d,m,-1,-1,h,y);const e=d.dist(p)<=2*A&&"bevel"!==i,t=x.mult(M?1:-1);t._mult(w);const r=g.mult(M?-1:1),n=m.mult(M?-1:1),o=this.evaluateLineProgressFeatures(this.distance);if(null==y&&(this.addHalfVertex(d,t.x,t.y,!1,!M,0,h,o),e||this.addHalfVertex(d,t.x+2*n.x,t.y+2*n.y,!1,M,0,h,o)),"fakeround"===i){const e=Math.round(180*S/Math.PI/20);this.addHalfVertex(d,n.x,n.y,!1,M,0,h,o);for(let t=0;t<e;t++){let i=t/e;if(.5!==i){const e=i-.5;i+=i*e*(i-1)*((1.0904+v*(v*(3.55645-1.43519*v)-3.2452))*e*e+(.848013+v*(.215638*v-1.06021)))}const s=r.sub(n)._mult(i)._add(n)._unit();this.addHalfVertex(d,s.x,s.y,!1,M,0,h,o)}this.addHalfVertex(d,r.x,r.y,!1,M,0,h,o)}e||null!=y||this.addHalfVertex(d,t.x+2*r.x,t.y+2*r.y,!1,M,0,h,o),null!=y&&f&&this.addCurrentVertex(d,g,1,1,h,y)}else"butt"===i?this.addCurrentVertex(d,x,0,0,h,y):"square"===i?(p||this.addCurrentVertex(d,x,-1,-1,h,y),this.addCurrentVertex(d,x,0,0,h,y),p&&this.addCurrentVertex(d,x,1,1,h,y)):"round"===i&&(p&&(this.addCurrentVertex(d,m,0,0,h,y),this.addCurrentVertex(d,m,1,1,h,y,!0)),f&&(this.addCurrentVertex(d,g,-1,-1,h,y,!0),this.addCurrentVertex(d,g,0,0,h,y)))}}addVerticesTo(e,t,i,r,n,o,s,a,l,c){const u=(t.w-e.w)/this.tessellationStep|0;let h=0;const d=this.scaledDistance;if(u>1){this.lineSoFar=e.w;const d=(t.x-e.x)/u,p=(t.y-e.y)/u,f=(t.z-e.z)/u,m=(t.w-e.w)/u;for(let t=1;t<u;++t){e.x+=d,e.y+=p,e.z+=f,this.lineSoFar+=m,h+=m;const t=this.evaluateLineProgressFeatures(this.prevDistance+h);this.scaledDistance=(this.prevDistance+h)/this.totalDistance,this.addHalfVertex(e,i,r,c,!1,s,l,t),this.addHalfVertex(e,n,o,c,!0,-a,l,t)}}this.lineSoFar=t.w,this.scaledDistance=d;const p=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(t,i,r,c,!1,s,l,p),this.addHalfVertex(t,n,o,c,!0,-a,l,p)}evaluateLineProgressFeatures(e){if(!this.variableWidthValue&&!this.hasZOffset)return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+e)/this.totalFeatureLength):pe(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let t=0;return this.variableWidthValue&&"constant"!==this.variableWidthValue.kind&&(t=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.hasZOffset?"constant"===this.zOffsetValue.kind?{zOffset:this.zOffsetValue.value,variableWidth:t}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:t}:{zOffset:0,variableWidth:t}}addCurrentVertex(e,t,i,r,n,o){let s=arguments.length>6&&void 0!==arguments[6]&&arguments[6];const a=t.x+t.y*i,l=t.y-t.x*i,c=t.y*r-t.x,u=-t.y-t.x*r;if(null!=o){const t=this.hasZOffset,h=-10,d=Zi+10,p=o.zOffset,f=new mh(e.x,e.y,p,this.lineSoFar),m=!!t&&Md(e,h,d),g=this.lineSoFar,y=this.distance;if(this.currentVertex)if(m){const t=this.currentVertexIsOutside,o=this.currentVertex,m=new mh(e.x,e.y,p,this.lineSoFar);if(_h(o,m,h,d),!Md(m,h,d)){if(t){this.e1=this.e2=-1,this.distance-=o.dist(f),this.lineSoFar=o.w;const e=this.evaluateLineProgressFeatures(o.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(o,a,l,s,!1,i,n,e),this.addHalfVertex(o,c,u,s,!0,-r,n,e),this.prevDistance=this.distance}this.distance=this.prevDistance+o.dist(m),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(o,m,a,l,c,u,i,r,n,s),this.distance=y,this.scaledDistance=this.distance/this.totalDistance}}else{const e=this.currentVertex;if(this.currentVertexIsOutside){_h(e,f,h,d),this.e1=this.e2=-1,this.distance-=e.dist(f),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e.w;const t=this.evaluateLineProgressFeatures(e.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(e,a,l,s,!1,i,n,t),this.addHalfVertex(e,c,u,s,!0,-r,n,t),this.prevDistance=this.distance,this.distance=y,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(e,f,a,l,c,u,i,r,n,s)}else m||(this.addHalfVertex(e,a,l,s,!1,i,n,o),this.addHalfVertex(e,c,u,s,!0,-r,n,o));this.currentVertex=f,this.currentVertexIsOutside=m,this.lineSoFar=g}else this.addHalfVertex(e,a,l,s,!1,i,n,o),this.addHalfVertex(e,c,u,s,!0,-r,n,o)}addHalfVertex(e,t,i,r,n,o,s,a){let{x:l,y:c}=e;if(this.patternJoinNone&&(0===this.segmentPoints.length&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),n||this.segmentPoints.push(this.lineSoFar-this.segmentStart,o)),this.layoutVertexArray.emplaceBack((l<<1)+(r?1:0),(c<<1)+(n?1:0),Math.round(63*t)+128,Math.round(63*i)+128,1+(0===o?0:o<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const e=Et(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,e)}const u=s.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,u),s.primitiveLength++),n?this.e2=u:this.e1=u,null!=a&&this.zOffsetVertexArray.emplaceBack(a.zOffset,a.variableWidth,a.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(e,t){this.prevDistance=this.distance,this.distance+=e.dist(t),this.updateScaledDistance()}}function Md(e,t,i){return e.x<t||e.x>i||e.y<t||e.y>i}let Ad,Cd;function Ed(e,t,i){return t*(Zi/(e.tileSize*Math.pow(2,i-e.tileID.overscaledZ)))}ao(Td,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const Pd=(e,t,i)=>(1-i)*e+i*t;function kd(e,t){return 1/Ed(e,1,t.tileZoom)}function Id(e,t,i,r){return e.translatePosMatrix(r||t.tileID.projMatrix,t,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}const Dd=e=>{const t=[];Ld(e)&&t.push("RENDER_LINE_DASH"),e.paint.get("line-gradient")&&t.push("RENDER_LINE_GRADIENT");const i=e.paint.get("line-trim-offset");0===i[0]&&0===i[1]||t.push("RENDER_LINE_TRIM_OFFSET"),0!==e.paint.get("line-border-width").constantOr(1)&&t.push("RENDER_LINE_BORDER");const r="none"===e.layout.get("line-join").constantOr("miter"),n=!!e.paint.get("line-pattern").constantOr(1);return r&&n&&t.push("LINE_JOIN_NONE"),t};function Ld(e){const t=e.paint.get("line-dasharray").value;return t.value||"constant"!==t.kind}let Rd;const zd=()=>Rd||(Rd={layout:Ad||(Ad=new $o({"line-cap":new Ho(qo.layout_line["line-cap"]),"line-join":new Ho(qo.layout_line["line-join"]),"line-miter-limit":new Go(qo.layout_line["line-miter-limit"]),"line-round-limit":new Go(qo.layout_line["line-round-limit"]),"line-sort-key":new Ho(qo.layout_line["line-sort-key"]),"line-z-offset":new Ho(qo.layout_line["line-z-offset"]),"line-elevation-reference":new Go(qo.layout_line["line-elevation-reference"]),"line-cross-slope":new Go(qo.layout_line["line-cross-slope"]),visibility:new Go(qo.layout_line.visibility),"line-width-unit":new Go(qo.layout_line["line-width-unit"])})),paint:Cd||(Cd=new $o({"line-opacity":new Ho(qo.paint_line["line-opacity"]),"line-color":new Ho(qo.paint_line["line-color"]),"line-translate":new Go(qo.paint_line["line-translate"]),"line-translate-anchor":new Go(qo.paint_line["line-translate-anchor"]),"line-width":new Ho(qo.paint_line["line-width"]),"line-gap-width":new Ho(qo.paint_line["line-gap-width"]),"line-offset":new Ho(qo.paint_line["line-offset"]),"line-blur":new Ho(qo.paint_line["line-blur"]),"line-dasharray":new Ho(qo.paint_line["line-dasharray"]),"line-pattern":new Ho(qo.paint_line["line-pattern"]),"line-gradient":new Wo(qo.paint_line["line-gradient"]),"line-trim-offset":new Go(qo.paint_line["line-trim-offset"]),"line-trim-fade-range":new Go(qo.paint_line["line-trim-fade-range"]),"line-trim-color":new Go(qo.paint_line["line-trim-color"]),"line-emissive-strength":new Go(qo.paint_line["line-emissive-strength"]),"line-border-width":new Ho(qo.paint_line["line-border-width"]),"line-border-color":new Ho(qo.paint_line["line-border-color"]),"line-occlusion-opacity":new Go(qo.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new Ho({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new Ho({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new Ho({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new Ho({type:"string",default:"default","property-type":"data-driven"})}))},Rd);class Od extends Ho{possiblyEvaluate(e,t){return t=new Ro(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,transition:t.transition}),super.possiblyEvaluate(e,t)}evaluate(e,t,i,r){return t=re({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(e,t,i,r)}}let Fd;function Bd(e,t){return t>0?t+2*e:e}const Nd=ys([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),jd=ys([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Vd=ys([{name:"a_projected_pos",components:4,type:"Float32"}],4);ys([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Ud=ys([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),Gd=ys([{name:"a_texb",components:2,type:"Uint16"}]),Hd=ys([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),Wd=ys([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);ys([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const $d=ys([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),qd=ys([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);ys([{name:"triangle",components:3,type:"Uint16"}]),ys([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),ys([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),ys([{type:"Float32",name:"offsetX"}]),ys([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Xd=24;const Yd=128;function Zd(e,t,i,r,n){if("camera"===e.kind)return e.maxSize;if("composite"===e.kind){const r=t.possiblyEvaluate(new Ro(e.maxZoom),i).evaluate(n,{},i),o=t.possiblyEvaluate(new Ro(e.minZoom),i).evaluate(n,{},i);return Math.max(r,o)}return t.possiblyEvaluate(new Ro(r)).evaluate(n,{},i)}function Kd(e,t){const{expression:i}=t;if("constant"===i.kind)return{kind:"constant",layoutSize:i.evaluate(new Ro(e+1))};if("source"===i.kind)return{kind:"source"};{const{zoomStops:t,interpolationType:r}=i;let n=0;for(;n<t.length&&t[n]<=e;)n++;n=Math.max(0,n-1);let o=n;for(;o<t.length&&t[o]<e+1;)o++;o=Math.min(t.length-1,o);const s=t[n],a=t[o];return"composite"===i.kind?{kind:"composite",minZoom:s,maxZoom:a,interpolationType:r}:{kind:"camera",minZoom:s,maxZoom:a,minSize:i.evaluate(new Ro(s)),maxSize:i.evaluate(new Ro(a)),interpolationType:r}}}function Jd(e,t,i){let{uSize:r,uSizeT:n}=t,{lowerSize:o,upperSize:s}=i;return"source"===e.kind?o/Yd:"composite"===e.kind?Et(o/Yd,s/Yd,n):r}function Qd(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=0,n=0;if("constant"===e.kind)n=e.layoutSize*i;else if("source"!==e.kind){const{interpolationType:o,minZoom:s,maxZoom:a}=e,l=o?Q(on.interpolationFactor(o,t,s,a),0,1):0;"camera"===e.kind?n=Et(e.minSize,e.maxSize,l)*i:r=l*i}return{uSizeT:r,uSize:n}}var ep=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Yd,evaluateSizeForFeature:Jd,evaluateSizeForZoom:Qd,getRasterizedIconSize:Zd,getSizeData:Kd});function tp(e,t,i){return e.sections.forEach((e=>{e.text=function(e,t,i){const r=t.layout.get("text-transform").evaluate(i,{});return"uppercase"===r?e=e.toLocaleUpperCase():"lowercase"===r&&(e=e.toLocaleLowerCase()),Lo.applyArabicShaping&&(e=Lo.applyArabicShaping(e)),e}(e.text,t,i)})),e}const ip={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function rp(e){return"\ufe36"===e||"\ufe48"===e||"\ufe38"===e||"\ufe44"===e||"\ufe42"===e||"\ufe3e"===e||"\ufe3c"===e||"\ufe3a"===e||"\ufe18"===e||"\ufe40"===e||"\ufe10"===e||"\ufe13"===e||"\ufe14"===e||"\uff40"===e||"\uffe3"===e||"\ufe11"===e||"\ufe12"===e}function np(e){return"\ufe35"===e||"\ufe47"===e||"\ufe37"===e||"\ufe43"===e||"\ufe41"===e||"\ufe3d"===e||"\ufe3b"===e||"\ufe39"===e||"\ufe17"===e||"\ufe3f"===e}var op,sp,ap,lp={};function cp(){return op||(op=1,lp.read=function(e,t,i,r,n){var o,s,a=8*n-r-1,l=(1<<a)-1,c=l>>1,u=-7,h=i?n-1:0,d=i?-1:1,p=e[t+h];for(h+=d,o=p&(1<<-u)-1,p>>=-u,u+=a;u>0;o=256*o+e[t+h],h+=d,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=r;u>0;s=256*s+e[t+h],h+=d,u-=8);if(0===o)o=1-c;else{if(o===l)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),o-=c}return(p?-1:1)*s*Math.pow(2,o-r)},lp.write=function(e,t,i,r,n,o){var s,a,l,c=8*o-n-1,u=(1<<c)-1,h=u>>1,d=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,f=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=u?(a=0,s=u):s+h>=1?(a=(t*l-1)*Math.pow(2,n),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,n),s=0));n>=8;e[i+p]=255&a,p+=f,a/=256,n-=8);for(s=s<<n|a,c+=n;c>0;e[i+p]=255&s,p+=f,s/=256,c-=8);e[i+p-f]|=128*m}),lp}function up(){if(ap)return sp;ap=1,sp=t;var e=cp();function t(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;var i=4294967296,r=1/i,n="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function o(e){return e.type===t.Bytes?e.readVarint()+e.pos:e.pos+1}function s(e,t,i){return i?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function a(e,t,i){var r=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));i.realloc(r);for(var n=i.pos-1;n>=e;n--)i.buf[n+r]=i.buf[n]}function l(e,t){for(var i=0;i<e.length;i++)t.writeVarint(e[i])}function c(e,t){for(var i=0;i<e.length;i++)t.writeSVarint(e[i])}function u(e,t){for(var i=0;i<e.length;i++)t.writeFloat(e[i])}function h(e,t){for(var i=0;i<e.length;i++)t.writeDouble(e[i])}function d(e,t){for(var i=0;i<e.length;i++)t.writeBoolean(e[i])}function p(e,t){for(var i=0;i<e.length;i++)t.writeFixed32(e[i])}function f(e,t){for(var i=0;i<e.length;i++)t.writeSFixed32(e[i])}function m(e,t){for(var i=0;i<e.length;i++)t.writeFixed64(e[i])}function g(e,t){for(var i=0;i<e.length;i++)t.writeSFixed64(e[i])}function y(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function _(e,t,i){e[i]=t,e[i+1]=t>>>8,e[i+2]=t>>>16,e[i+3]=t>>>24}function v(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}return t.prototype={destroy:function(){this.buf=null},readFields:function(e,t,i){for(i=i||this.length;this.pos<i;){var r=this.readVarint(),n=r>>3,o=this.pos;this.type=7&r,e(n,t,this),this.pos===o&&this.skip(r)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=y(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=v(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=y(this.buf,this.pos)+y(this.buf,this.pos+4)*i;return this.pos+=8,e},readSFixed64:function(){var e=y(this.buf,this.pos)+v(this.buf,this.pos+4)*i;return this.pos+=8,e},readFloat:function(){var t=e.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=e.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(e){var t,i,r=this.buf;return t=127&(i=r[this.pos++]),i<128?t:(t|=(127&(i=r[this.pos++]))<<7,i<128?t:(t|=(127&(i=r[this.pos++]))<<14,i<128?t:(t|=(127&(i=r[this.pos++]))<<21,i<128?t:function(e,t,i){var r,n,o=i.buf;if(r=(112&(n=o[i.pos++]))>>4,n<128)return s(e,r,t);if(r|=(127&(n=o[i.pos++]))<<3,n<128)return s(e,r,t);if(r|=(127&(n=o[i.pos++]))<<10,n<128)return s(e,r,t);if(r|=(127&(n=o[i.pos++]))<<17,n<128)return s(e,r,t);if(r|=(127&(n=o[i.pos++]))<<24,n<128)return s(e,r,t);if(r|=(1&(n=o[i.pos++]))<<31,n<128)return s(e,r,t);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(i=r[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&n?function(e,t,i){return n.decode(e.subarray(t,i))}(this.buf,t,e):function(e,t,i){for(var r="",n=t;n<i;){var o,s,a,l=e[n],c=null,u=l>239?4:l>223?3:l>191?2:1;if(n+u>i)break;1===u?l<128&&(c=l):2===u?128==(192&(o=e[n+1]))&&(c=(31&l)<<6|63&o)<=127&&(c=null):3===u?(s=e[n+2],128==(192&(o=e[n+1]))&&128==(192&s)&&((c=(15&l)<<12|(63&o)<<6|63&s)<=2047||c>=55296&&c<=57343)&&(c=null)):4===u&&(s=e[n+2],a=e[n+3],128==(192&(o=e[n+1]))&&128==(192&s)&&128==(192&a)&&((c=(15&l)<<18|(63&o)<<12|(63&s)<<6|63&a)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,u=1):c>65535&&(c-=65536,r+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),r+=String.fromCharCode(c),n+=u}return r}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,i){if(this.type!==t.Bytes)return e.push(this.readVarint(i));var r=o(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(i));return e},readPackedSVarint:function(e){if(this.type!==t.Bytes)return e.push(this.readSVarint());var i=o(this);for(e=e||[];this.pos<i;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==t.Bytes)return e.push(this.readBoolean());var i=o(this);for(e=e||[];this.pos<i;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==t.Bytes)return e.push(this.readFloat());var i=o(this);for(e=e||[];this.pos<i;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==t.Bytes)return e.push(this.readDouble());var i=o(this);for(e=e||[];this.pos<i;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==t.Bytes)return e.push(this.readFixed32());var i=o(this);for(e=e||[];this.pos<i;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==t.Bytes)return e.push(this.readSFixed32());var i=o(this);for(e=e||[];this.pos<i;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==t.Bytes)return e.push(this.readFixed64());var i=o(this);for(e=e||[];this.pos<i;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==t.Bytes)return e.push(this.readSFixed64());var i=o(this);for(e=e||[];this.pos<i;)e.push(this.readSFixed64());return e},skip:function(e){var i=7&e;if(i===t.Varint)for(;this.buf[this.pos++]>127;);else if(i===t.Bytes)this.pos=this.readVarint()+this.pos;else if(i===t.Fixed32)this.pos+=4;else{if(i!==t.Fixed64)throw new Error("Unimplemented type: "+i);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),_(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),_(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),_(this.buf,-1&e,this.pos),_(this.buf,Math.floor(e*r),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),_(this.buf,-1&e,this.pos),_(this.buf,Math.floor(e*r),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(e,t){var i,r;if(e>=0?(i=e%4294967296|0,r=e/4294967296|0):(r=~(-e/4294967296),4294967295^(i=~(-e%4294967296))?i=i+1|0:(i=0,r=r+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(e,t,i){i.buf[i.pos++]=127&e|128,e>>>=7,i.buf[i.pos++]=127&e|128,e>>>=7,i.buf[i.pos++]=127&e|128,e>>>=7,i.buf[i.pos++]=127&e|128,i.buf[i.pos]=127&(e>>>=7)}(i,0,t),function(e,t){var i=(7&e)<<4;t.buf[t.pos++]|=i|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e)))))}(r,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(e,t,i){for(var r,n,o=0;o<t.length;o++){if((r=t.charCodeAt(o))>55295&&r<57344){if(!n){r>56319||o+1===t.length?(e[i++]=239,e[i++]=191,e[i++]=189):n=r;continue}if(r<56320){e[i++]=239,e[i++]=191,e[i++]=189,n=r;continue}r=n-55296<<10|r-56320|65536,n=null}else n&&(e[i++]=239,e[i++]=191,e[i++]=189,n=null);r<128?e[i++]=r:(r<2048?e[i++]=r>>6|192:(r<65536?e[i++]=r>>12|224:(e[i++]=r>>18|240,e[i++]=r>>12&63|128),e[i++]=r>>6&63|128),e[i++]=63&r|128)}return i}(this.buf,e,this.pos);var i=this.pos-t;i>=128&&a(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(t){this.realloc(4),e.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),e.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=e[i]},writeRawMessage:function(e,t){this.pos++;var i=this.pos;e(t,this);var r=this.pos-i;r>=128&&a(i,r,this),this.pos=i-1,this.writeVarint(r),this.pos+=r},writeMessage:function(e,i,r){this.writeTag(e,t.Bytes),this.writeRawMessage(i,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,l,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,c,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,d,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,u,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,h,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,p,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,f,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,m,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,g,t)},writeBytesField:function(e,i){this.writeTag(e,t.Bytes),this.writeBytes(i)},writeFixed32Field:function(e,i){this.writeTag(e,t.Fixed32),this.writeFixed32(i)},writeSFixed32Field:function(e,i){this.writeTag(e,t.Fixed32),this.writeSFixed32(i)},writeFixed64Field:function(e,i){this.writeTag(e,t.Fixed64),this.writeFixed64(i)},writeSFixed64Field:function(e,i){this.writeTag(e,t.Fixed64),this.writeSFixed64(i)},writeVarintField:function(e,i){this.writeTag(e,t.Varint),this.writeVarint(i)},writeSVarintField:function(e,i){this.writeTag(e,t.Varint),this.writeSVarint(i)},writeStringField:function(e,i){this.writeTag(e,t.Bytes),this.writeString(i)},writeFloatField:function(e,i){this.writeTag(e,t.Fixed32),this.writeFloat(i)},writeDoubleField:function(e,i){this.writeTag(e,t.Fixed64),this.writeDouble(i)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}},sp}var hp=t(up());const dp=3;function pp(e,t,i){t.glyphs=[],1===e&&i.readMessage(fp,t)}function fp(e,t,i){if(3===e){const{id:e,bitmap:r,width:n,height:o,left:s,top:a,advance:l}=i.readMessage(mp,{});t.glyphs.push({id:e,bitmap:new ou({width:n+2*dp,height:o+2*dp},r),metrics:{width:n,height:o,left:s,top:a,advance:l}})}else 4===e?t.ascender=i.readSVarint():5===e&&(t.descender=i.readSVarint())}function mp(e,t,i){1===e?t.id=i.readVarint():2===e?t.bitmap=i.readBytes():3===e?t.width=i.readVarint():4===e?t.height=i.readVarint():5===e?t.left=i.readSVarint():6===e?t.top=i.readSVarint():7===e&&(t.advance=i.readVarint())}const gp=dp,yp={horizontal:1,vertical:2,horizontalOnly:3};class _p{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(e,t){const i=new _p;return i.scale=e||1,i.fontStack=t,i}static forImage(e){const t=new _p;return t.image=e,t}}class vp{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,t){const i=new vp;for(let r=0;r<e.sections.length;r++){const n=e.sections[r];n.image?i.addImageSection(n):i.addTextSection(n,t)}return i}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCodePoint(e){return this.text.codePointAt(e)}verticalizePunctuation(e){this.text=function(e,t){let i="";for(let r=0;r<e.length;r++){const n=e.charCodeAt(r+1)||null,o=e.charCodeAt(r-1)||null;i+=!t&&(n&&_o(n)&&!ip[e[r+1]]||o&&_o(o)&&!ip[e[r-1]])||!ip[e[r]]?e[r]:ip[e[r]]}return i}(this.text,e)}trim(){let e=0;for(let i=0;i<this.text.length&&bp[this.text.charCodeAt(i)];i++)e++;let t=this.text.length;for(let i=this.text.length-1;i>=0&&i>=e&&bp[this.text.charCodeAt(i)];i--)t--;this.text=this.text.substring(e,t),this.sectionIndex=this.sectionIndex.slice(e,t)}substring(e,t){const i=new vp;return i.text=this.text.substring(e,t),i.sectionIndex=this.sectionIndex.slice(e,t),i.sections=this.sections,i}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((e,t)=>Math.max(e,this.sections[t].scale)),0)}addTextSection(e,t){this.text+=e.text,this.sections.push(_p.forText(e.scale,e.fontStack||t));const i=this.sections.length-1;for(let r=0;r<e.text.length;++r)this.sectionIndex.push(i)}addImageSection(e){const t=e.image&&e.image.namePrimary?e.image.getPrimary():null;if(!t)return void pe("Can't add FormattedSection with an empty image.");const i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCodePoint(i),this.sections.push(_p.forImage(t)),this.sectionIndex.push(this.sections.length-1)):pe("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function xp(e,t,i,r,n,o,s,a,l,c,u,h,d,p,f){const m=vp.fromFeature(e,n);h===yp.vertical&&m.verticalizePunctuation(d);let g=[];const y=function(e,t,i,r,n,o){if(!e)return[];const s=[],a=function(e,t,i,r,n,o){let s=0;for(let a=0;a<e.length();a++){const i=e.getSection(a);s+=Sp(e.getCodePoint(a),i,r,n,t,o)}return s/Math.max(1,Math.ceil(s/i))}(e,t,i,r,n,o),l=e.text.indexOf("\u200b")>=0;let c=0;for(let h=0;h<e.length();h++){const i=e.getSection(h),d=e.getCodePoint(h);if(bp[d]||(c+=Sp(d,i,r,n,t,o)),h<e.length()-1){const t=!((u=d)<11904||!(po["Bopomofo Extended"](u)||po.Bopomofo(u)||po["CJK Compatibility Forms"](u)||po["CJK Compatibility Ideographs"](u)||po["CJK Compatibility"](u)||po["CJK Radicals Supplement"](u)||po["CJK Strokes"](u)||po["CJK Symbols and Punctuation"](u)||po["CJK Unified Ideographs Extension A"](u)||po["CJK Unified Ideographs"](u)||po["Enclosed CJK Letters and Months"](u)||po["Halfwidth and Fullwidth Forms"](u)||po.Hiragana(u)||po["Ideographic Description Characters"](u)||po["Kangxi Radicals"](u)||po["Katakana Phonetic Extensions"](u)||po.Katakana(u)||po["Vertical Forms"](u)||po["Yi Radicals"](u)||po["Yi Syllables"](u)));(wp[d]||t||i.image)&&s.push(Ap(h+1,c,a,s,Mp(d,e.getCodePoint(h+1),t&&l),!1))}}var u;return Cp(Ap(e.length(),c,a,s,0,!0))}(m,c,o,t,r,p),{processBidirectionalText:_,processStyledBidirectionalText:v}=Lo;if(_&&1===m.sections.length){const e=_(m.toString(),y);for(const t of e){const e=new vp;e.text=t,e.sections=m.sections;for(let i=0;i<t.length;i++)e.sectionIndex.push(0);g.push(e)}}else if(v){const e=v(m.text,m.sectionIndex,y);for(const t of e){const e=new vp;e.text=t[0],e.sectionIndex=t[1],e.sections=m.sections,g.push(e)}}else g=function(e,t){const i=[],r=e.text;let n=0;for(const o of t)i.push(e.substring(n,o)),n=o;return n<r.length&&i.push(e.substring(n,r.length)),i}(m,y);const x=[],b={positionedLines:x,text:m.toString(),top:u[1],bottom:u[1],left:u[0],right:u[0],writingMode:h,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(e,t,i,r,n,o,s,a,l,c,u,h){let d=0,p=0,f=0;const m="right"===a?1:"left"===a?0:.5;let g=!1;for(const w of n){const e=w.getSections();for(const i of e){if(i.image)continue;const e=t[i.fontStack];if(e&&(g=void 0!==e.ascender&&void 0!==e.descender,!g))break}if(!g)break}let y=0;for(const w of n){w.trim();const n=w.getMaxScale(),s=(n-1)*Xd,a={positionedGlyphs:[],lineOffset:0};e.positionedLines[y]=a;const v=a.positionedGlyphs;let x=0;if(!w.length()){p+=o,++y;continue}let b=0,S=0;for(let o=0;o<w.length();o++){const s=w.getSection(o),a=w.getSectionIndex(o),f=w.getCodePoint(o);let m=s.scale,y=null,T=null,M=null,A=Xd,C=0;const E=!(l===yp.horizontal||!u&&!yo(f)||u&&(bp[f]||(_=f,po.Arabic(_)||po["Arabic Supplement"](_)||po["Arabic Extended-A"](_)||po["Arabic Presentation Forms-A"](_)||po["Arabic Presentation Forms-B"](_))));if(s.image){const t=r[s.image.serialize()];if(!t)continue;M=s.image.id,e.iconsInText=e.iconsInText||!0,T=t.paddedRect;const i=t.displaySize;m=m*Xd/h,y={width:i[0],height:i[1],left:0,top:-gp,advance:E?i[1]:i[0],localGlyph:!1},C=g?-y.height*m:n*Xd-17-i[1]*m,A=y.advance;const o=(E?i[0]:i[1])*m-Xd*n;o>0&&o>x&&(x=o)}else{const e=i[s.fontStack];if(!e)continue;e[f]&&(T=e[f]);const r=t[s.fontStack];if(!r)continue;const o=r.glyphs[f];if(!o)continue;if(y=o.metrics,A=8203!==f?Xd:0,g){const e=void 0!==r.ascender?Math.abs(r.ascender):0,t=void 0!==r.descender?Math.abs(r.descender):0,i=(e+t)*m;b<i&&(b=i,S=(e-t)/2*m),C=-e*m}else C=(n-m)*Xd-17}E?(e.verticalizable=!0,v.push({glyph:f,imageName:M,x:d,y:p+C,vertical:E,scale:m,localGlyph:y.localGlyph,fontStack:s.fontStack,sectionIndex:a,metrics:y,rect:T}),d+=A*m+c):(v.push({glyph:f,imageName:M,x:d,y:p+C,vertical:E,scale:m,localGlyph:y.localGlyph,fontStack:s.fontStack,sectionIndex:a,metrics:y,rect:T}),d+=y.advance*m+c)}0!==v.length&&(f=Math.max(d-c,f),g?Pp(v,m,x,S,o*n/2):Pp(v,m,x,0,o/2)),d=0;const T=o*n+x;a.lineOffset=Math.max(x,s),p+=T,++y}var _;const v=p,{horizontalAlign:x,verticalAlign:b}=Ep(s);(function(e,t,i,r,n,o){const s=(t-i)*n,a=-o*r;for(const l of e)for(const e of l.positionedGlyphs)e.x+=s,e.y+=a})(e.positionedLines,m,x,b,f,v),e.top+=-b*v,e.bottom=e.top+v,e.left+=-x*f,e.right=e.left+f,e.hasBaseline=g}(b,t,i,r,g,s,a,l,h,c,d,f),!function(e){for(const t of e)if(0!==t.positionedGlyphs.length)return!1;return!0}(x)&&b}const bp={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},wp={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Sp(e,t,i,r,n,o){if(t.image){const e=r[t.image.serialize()];return e?e.displaySize[0]*t.scale*Xd/o+n:0}{const r=i[t.fontStack],o=r&&r.glyphs[e];return o?o.metrics.advance*t.scale+n:0}}function Tp(e,t,i,r){const n=Math.pow(e-t,2);return r?e<t?n/2:2*n:n+Math.abs(i)*i}function Mp(e,t,i){let r=0;return 10===e&&(r-=1e4),i&&(r+=150),40!==e&&65288!==e||(r+=50),41!==t&&65289!==t||(r+=50),r}function Ap(e,t,i,r,n,o){let s=null,a=Tp(t,i,n,o);for(const l of r){const e=Tp(t-l.x,i,n,o)+l.badness;e<=a&&(s=l,a=e)}return{index:e,x:t,priorBreak:s,badness:a}}function Cp(e){return e?Cp(e.priorBreak).concat(e.index):[]}function Ep(e){let t=.5,i=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function Pp(e,t,i,r,n){if(!(t||i||r||n))return;const o=e.length-1,s=e[o],a=(s.x+s.metrics.advance*s.scale)*t;for(let l=0;l<=o;l++)e[l].x-=a,e[l].y+=i+r+n}function kp(e,t,i,r){const{horizontalAlign:n,verticalAlign:o}=Ep(r),s=i[0]-e.displaySize[0]*n,a=i[1]-e.displaySize[1]*o;return{imagePrimary:e,imageSecondary:t,top:a,bottom:a+e.displaySize[1],left:s,right:s+e.displaySize[0]}}function Ip(e,t,i,r,n,o){const s=e.imagePrimary;let a;if(s.content){const e=s.content,t=s.pixelRatio||1;a=[e[0]/t,e[1]/t,s.displaySize[0]-e[2]/t,s.displaySize[1]-e[3]/t]}const l=t.left*o,c=t.right*o;let u,h,d,p;"width"===i||"both"===i?(p=n[0]+l-r[3],h=n[0]+c+r[1]):(p=n[0]+(l+c-s.displaySize[0])/2,h=p+s.displaySize[0]);const f=t.top*o,m=t.bottom*o;return"height"===i||"both"===i?(u=n[1]+f-r[0],d=n[1]+m+r[2]):(u=n[1]+(f+m-s.displaySize[1])/2,d=u+s.displaySize[1]),{imagePrimary:s,imageSecondary:void 0,top:u,right:h,bottom:d,left:p,collisionPadding:a}}class Dp extends G{constructor(e,t,i,r,n){super(e,t),this.angle=r,this.z=i,void 0!==n&&(this.segment=n)}clone(){return new Dp(this.x,this.y,this.z,this.angle,this.segment)}}function Lp(e,t,i,r,n){if(void 0===t.segment)return!0;let o=t,s=t.segment+1,a=0;for(;a>-i/2;){if(s--,s<0)return!1;a-=e[s].dist(o),o=e[s]}a+=e[s].dist(e[s+1]),s++;const l=[];let c=0;for(;a<i/2;){const t=e[s],i=e[s+1];if(!i)return!1;let o=e[s-1].angleTo(t)-t.angleTo(i);for(o=Math.abs((o+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:a,angleDelta:o}),c+=o;a-l[0].distance>r;)c-=l.shift().angleDelta;if(c>n)return!1;s++,a+=t.dist(i)}return!0}function Rp(e){let t=0;for(let i=0;i<e.length-1;i++)t+=e[i].dist(e[i+1]);return t}function zp(e,t,i){return e?.6*t*i:0}function Op(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Fp(e,t,i,r,n,o){const s=zp(i,n,o),a=Op(i,r)*o;let l=0;const c=Rp(e)/2;for(let u=0;u<e.length-1;u++){const i=e[u],r=e[u+1],n=i.dist(r);if(l+n>c){const o=(c-l)/n,h=Et(i.x,r.x,o),d=Et(i.y,r.y,o),p=new Dp(h,d,0,r.angleTo(i),u);return!s||Lp(e,p,a,s,t)?p:void 0}l+=n}}function Bp(e,t,i,r,n,o,s,a,l){const c=zp(r,o,s),u=Op(r,n),h=u*s,d=0===e[0].x||e[0].x===l||0===e[0].y||e[0].y===l;return t-h<t/4&&(t=h+t/4),Np(e,d?t/2*a%t:(u/2+2*o)*s*a%t,t,c,i,h,d,!1,l)}function Np(e,t,i,r,n,o,s,a,l){const c=o/2,u=Rp(e);let h=0,d=t-i,p=[];for(let f=0;f<e.length-1;f++){const t=e[f],s=e[f+1],a=t.dist(s),m=s.angleTo(t);for(;d+i<h+a;){d+=i;const g=(d-h)/a,y=Et(t.x,s.x,g),_=Et(t.y,s.y,g);if(y>=0&&y<l&&_>=0&&_<l&&d-c>=0&&d+c<=u){const t=new Dp(y,_,0,m,f);r&&!Lp(e,t,o,r,n)||p.push(t)}}h+=a}return a||p.length||s||(p=Np(e,h/2,i,r,n,o,s,!0,l)),p}function jp(e,t,i,r,n){const o=[];for(let s=0;s<e.length;s++){const a=e[s];let l;for(let e=0;e<a.length-1;e++){let s=a[e],c=a[e+1];s.x<t&&c.x<t||(s.x<t?s=new G(t,s.y+(t-s.x)/(c.x-s.x)*(c.y-s.y))._round():c.x<t&&(c=new G(t,s.y+(t-s.x)/(c.x-s.x)*(c.y-s.y))._round()),s.y<i&&c.y<i||(s.y<i?s=new G(s.x+(i-s.y)/(c.y-s.y)*(c.x-s.x),i)._round():c.y<i&&(c=new G(s.x+(i-s.y)/(c.y-s.y)*(c.x-s.x),i)._round()),s.x>=r&&c.x>=r||(s.x>=r?s=new G(r,s.y+(r-s.x)/(c.x-s.x)*(c.y-s.y))._round():c.x>=r&&(c=new G(r,s.y+(r-s.x)/(c.x-s.x)*(c.y-s.y))._round()),s.y>=n&&c.y>=n||(s.y>=n?s=new G(s.x+(n-s.y)/(c.y-s.y)*(c.x-s.x),n)._round():c.y>=n&&(c=new G(s.x+(n-s.y)/(c.y-s.y)*(c.x-s.x),n)._round()),l&&s.equals(l[l.length-1])||(l=[s],o.push(l)),l.push(c)))))}}return o}function Vp(e){let t=0,i=0;for(const s of e)t+=s.w*s.h,i=Math.max(i,s.w);e.sort(((e,t)=>t.h-e.h));const r=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),i),h:1/0}];let n=0,o=0;for(const s of e)for(let e=r.length-1;e>=0;e--){const t=r[e];if(!(s.w>t.w||s.h>t.h)){if(s.x=t.x,s.y=t.y,o=Math.max(o,s.y+s.h),n=Math.max(n,s.x+s.w),s.w===t.w&&s.h===t.h){const t=r.pop();e<r.length&&(r[e]=t)}else s.h===t.h?(t.x+=s.w,t.w-=s.w):s.w===t.w?(t.y+=s.h,t.h-=s.h):(r.push({x:t.x+s.w,y:t.y,w:t.w-s.w,h:s.h}),t.y+=s.h,t.h-=s.h);break}}return{w:n,h:o,fill:t/(n*o)||0}}ao(Dp,"Anchor");const Up=1;class Gp{static getImagePositionScale(e,t,i){return t&&e&&e.options&&e.options.transform?{x:e.options.transform.a,y:e.options.transform.d}:{x:i,y:i}}constructor(e,t,i,r){let{pixelRatio:n,version:o,stretchX:s,stretchY:a,content:l,sdf:c,usvg:u}=t;this.paddedRect=e,this.pixelRatio=n,this.stretchX=s,this.stretchY=a,this.content=l,this.version=o,this.padding=i,this.sdf=c,this.scale=Gp.getImagePositionScale(r,u,n)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}class Hp{constructor(e,t,i){const r={},n={};this.haveRenderCallbacks=[];const o=[];this.addImages(e,r,Up,o),this.addImages(t,n,2,o);const{w:s,h:a}=Vp(o),l=new su({width:s||1,height:a||1});for(const c in e){const t=e[c],n=r[c].paddedRect;su.copy(t.data,l,{x:0,y:0},{x:n.x+Up,y:n.y+Up},t.data,i,t.sdf)}for(const c in t){const e=t[c],r=n[c].paddedRect;let o=n[c].padding;const s=r.x+o,a=r.y+o,u=e.data.width,h=e.data.height;o=o>1?o-1:o,su.copy(e.data,l,{x:0,y:0},{x:s,y:a},e.data,i),su.copy(e.data,l,{x:0,y:h-o},{x:s,y:a-o},{width:u,height:o},i),su.copy(e.data,l,{x:0,y:0},{x:s,y:a+h},{width:u,height:o},i),su.copy(e.data,l,{x:u-o,y:0},{x:s-o,y:a},{width:o,height:h},i),su.copy(e.data,l,{x:0,y:0},{x:s+u,y:a},{width:o,height:h},i),su.copy(e.data,l,{x:u-o,y:h-o},{x:s-o,y:a-o},{width:o,height:o},i),su.copy(e.data,l,{x:0,y:h-o},{x:s+u,y:a-o},{width:o,height:o},i),su.copy(e.data,l,{x:0,y:0},{x:s+u,y:a+h},{width:o,height:o},i),su.copy(e.data,l,{x:u-o,y:0},{x:s-o,y:a+h},{width:o,height:o},i)}this.lut=i,this.image=l,this.iconPositions=r,this.patternPositions=n}addImages(e,t,i,r){for(const n in e){const o=e[n],s={x:0,y:0,w:o.data.width+2*i,h:o.data.height+2*i};r.push(s);const a=Qt.deserializeFromString(n);t[n]=new Gp(s,o,i,a),o.hasRenderCallback&&this.haveRenderCallbacks.push(a.id)}}patchUpdatedImages(e,t,i){this.haveRenderCallbacks=this.haveRenderCallbacks.filter((t=>e.hasImage(t,i))),e.dispatchRenderCallbacks(this.haveRenderCallbacks,i);for(const r in e.getUpdatedImages(i)){for(const n of Object.keys(this.iconPositions))Qt.deserializeId(n)===r&&this.patchUpdatedImage(this.iconPositions[n],e.getImage(r,i),t);for(const n of Object.keys(this.patternPositions))Qt.deserializeId(n)===r&&this.patchUpdatedImage(this.patternPositions[n],e.getImage(r,i),t)}}patchUpdatedImage(e,t,i){if(!e||!t)return;if(e.version===t.version)return;e.version=t.version;const[r,n]=e.tl,o=e.sdf;if(this.lut||o){const e={width:t.data.width,height:t.data.height},s=new su(e);su.copy(t.data,s,{x:0,y:0},{x:0,y:0},e,this.lut,o),i.update(s,{position:{x:r,y:n}})}else i.update(t.data,{position:{x:r,y:n}})}}ao(Gp,"ImagePosition"),ao(Hp,"ImageAtlas");const Wp=1e20;function $p(e,t,i,r,n,o,s,a,l){for(let c=t;c<t+r;c++)qp(e,i*o+c,o,n,s,a,l);for(let c=i;c<i+n;c++)qp(e,c*o+t,1,r,s,a,l)}function qp(e,t,i,r,n,o,s){o[0]=0,s[0]=-Wp,s[1]=Wp,n[0]=e[t];for(let a=1,l=0,c=0;a<r;a++){n[a]=e[t+a*i];const r=a*a;do{const e=o[l];c=(n[a]-n[e]+r-e*e)/(a-e)/2}while(c<=s[l]&&--l>-1);l++,o[l]=a,s[l]=c,s[l+1]=Wp}for(let a=0,l=0;a<r;a++){for(;s[l+1]<a;)l++;const r=o[l],c=a-r;e[t+a*i]=n[r]+c*c}}const Xp=2,Yp={none:0,ideographs:1,all:2};class Zp{constructor(e,t,i){this.requestManager=e,this.localGlyphMode=t,this.localFontFamily=i,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e,t){this.urls[t]=e}getGlyphs(e,t,i){const r=[],n=this.urls[t]||Me.GLYPHS_URL;for(const o in e)for(const t of e[o])r.push({stack:o,id:t});ie(r,((e,t)=>{let{stack:i,id:r}=e,o=this.entries[i];o||(o=this.entries[i]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let s=o.glyphs[r];if(void 0!==s)return void t(null,{stack:i,id:r,glyph:s});if(s=this._tinySDF(o,i,r),s)return o.glyphs[r]=s,void t(null,{stack:i,id:r,glyph:s});const a=Math.floor(r/256);if(256*a>65535)return pe("glyphs > 65535 not supported"),void t(null,{stack:i,id:r,glyph:s});if(o.ranges[a])return void t(null,{stack:i,id:r,glyph:s});let l=o.requests[a];l||(l=o.requests[a]=[],Zp.loadGlyphRange(i,a,n,this.requestManager,((e,t)=>{if(t){o.ascender=t.ascender,o.descender=t.descender;for(const e in t.glyphs)this._doesCharSupportLocalGlyph(+e)||(o.glyphs[+e]=t.glyphs[+e]);o.ranges[a]=!0}for(const i of l)i(e,t);delete o.requests[a]}))),l.push(((e,n)=>{e?t(e):n&&t(null,{stack:i,id:r,glyph:n.glyphs[r]||null})}))}),((e,t)=>{if(e)i(e);else if(t){const e={};for(const{stack:i,id:r,glyph:n}of t)void 0===e[i]&&(e[i]={}),void 0===e[i].glyphs&&(e[i].glyphs={}),e[i].glyphs[r]=n&&{id:n.id,bitmap:n.bitmap.clone(),metrics:n.metrics},e[i].ascender=this.entries[i].ascender,e[i].descender=this.entries[i].descender;i(null,e)}}))}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==Yp.none&&(this.localGlyphMode===Yp.all?!!this.localFontFamily:!!this.localFontFamily&&(po["CJK Unified Ideographs"](e)||po["Hangul Syllables"](e)||po.Hiragana(e)||po.Katakana(e)||po["CJK Symbols and Punctuation"](e)||po["CJK Unified Ideographs Extension A"](e)||po["CJK Unified Ideographs Extension B"](e)||po.Osage(e)))}_tinySDF(e,t,i){const r=this.localFontFamily;if(!r||!this._doesCharSupportLocalGlyph(i))return;let n=e.tinySDF;if(!n){let i="400";/bold/i.test(t)?i="900":/medium/i.test(t)?i="500":/light/i.test(t)&&(i="200"),n=e.tinySDF=new Zp.TinySDF({fontFamily:r,fontWeight:i,fontSize:24*Xp,buffer:3*Xp,radius:8*Xp}),n.fontWeight=i}if(this.localGlyphs[n.fontWeight][i])return this.localGlyphs[n.fontWeight][i];const o=String.fromCodePoint(i),{data:s,width:a,height:l,glyphWidth:c,glyphHeight:u,glyphLeft:h,glyphTop:d,glyphAdvance:p}=n.draw(o);return this.localGlyphs[n.fontWeight][i]={id:i,bitmap:new ou({width:a,height:l},s),metrics:{width:c/Xp,height:u/Xp,left:h/Xp,top:d/Xp-27,advance:p/Xp,localGlyph:!0}}}}Zp.loadGlyphRange=function(e,t,i,r,n){const o=256*t,s=o+255,a=r.transformRequest(r.normalizeGlyphsURL(i).replace("{fontstack}",e).replace("{range}",`${o}-${s}`),et.Glyphs);nt(a,((e,t)=>{if(e)n(e);else if(t){const e={},i=function(e){return new hp(e).readFields(pp,{})}(t);for(const t of i.glyphs)e[t.id]=t;n(null,{glyphs:e,ascender:i.ascender,descender:i.descender})}}))},Zp.TinySDF=class{constructor(){let{fontSize:e=24,buffer:t=3,radius:i=8,cutoff:r=.25,fontFamily:n="sans-serif",fontWeight:o="normal",fontStyle:s="normal"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.buffer=t,this.cutoff=r,this.radius=i;const a=this.size=e+4*t,l=this._createCanvas(a),c=this.ctx=l.getContext("2d",{willReadFrequently:!0});c.font=`${s} ${o} ${e}px ${n}`,c.textBaseline="alphabetic",c.textAlign="left",c.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Uint16Array(a)}_createCanvas(e){const t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){const{width:t,actualBoundingBoxAscent:i,actualBoundingBoxDescent:r,actualBoundingBoxLeft:n,actualBoundingBoxRight:o}=this.ctx.measureText(e),s=Math.ceil(i),a=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(o-n))),l=Math.min(this.size-this.buffer,s+Math.ceil(r)),c=a+2*this.buffer,u=l+2*this.buffer,h=Math.max(c*u,0),d=new Uint8ClampedArray(h),p={data:d,width:c,height:u,glyphWidth:a,glyphHeight:l,glyphTop:s,glyphLeft:0,glyphAdvance:t};if(0===a||0===l)return p;const{ctx:f,buffer:m,gridInner:g,gridOuter:y}=this;f.clearRect(m,m,a,l),f.fillText(e,m,m+s);const _=f.getImageData(m,m,a,l);y.fill(Wp,0,h),g.fill(0,0,h);for(let v=0;v<l;v++)for(let e=0;e<a;e++){const t=_.data[4*(v*a+e)+3]/255;if(0===t)continue;const i=(v+m)*c+e+m;if(1===t)y[i]=0,g[i]=Wp;else{const e=.5-t;y[i]=e>0?e*e:0,g[i]=e<0?e*e:0}}$p(y,0,0,c,u,c,this.f,this.v,this.z),$p(g,m,m,a,l,c,this.f,this.v,this.z);for(let v=0;v<h;v++){const e=Math.sqrt(y[v])-Math.sqrt(g[v]);d[v]=Math.round(255-255*(e/this.radius+this.cutoff))}return p}};const Kp=Up;function Jp(e,t){return e+t[1]-t[0]}function Qp(e,t,i,r){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;const o=[],s=e.imagePrimary,a=s.pixelRatio,l=s.paddedRect.w-2*Kp,c=s.paddedRect.h-2*Kp,u=(e.right-e.left)*n,h=(e.bottom-e.top)*n,d=s.stretchX||[[0,l]],p=s.stretchY||[[0,c]],f=d.reduce(Jp,0),m=p.reduce(Jp,0),g=l-f,y=c-m;let _=0,v=f,x=0,b=m,w=0,S=g,T=0,M=y;if(s.content&&r){const e=s.content;_=ef(d,0,e[0]),x=ef(p,0,e[1]),v=ef(d,e[0],e[2]),b=ef(p,e[1],e[3]),w=e[0]-_,T=e[1]-x,S=e[2]-e[0]-v,M=e[3]-e[1]-b}const A=(r,o,l,c)=>{const d=rf(r.stretch-_,v,u,e.left*n),p=nf(r.fixed-w,S,r.stretch,f),g=rf(o.stretch-x,b,h,e.top*n),y=nf(o.fixed-T,M,o.stretch,m),A=rf(l.stretch-_,v,u,e.left*n),C=nf(l.fixed-w,S,l.stretch,f),E=rf(c.stretch-x,b,h,e.top*n),P=nf(c.fixed-T,M,c.stretch,m),k=new G(d,g),I=new G(A,g),D=new G(A,E),L=new G(d,E),R=new G(p/a,y/a),z=new G(C/a,P/a),O=t*Math.PI/180;if(O){const e=Math.sin(O),t=Math.cos(O),i=[t,-e,e,t];k._matMult(i),I._matMult(i),L._matMult(i),D._matMult(i)}const F=r.stretch+r.fixed,B=l.stretch+l.fixed,N=o.stretch+o.fixed,j=c.stretch+c.fixed,V=e.imageSecondary;return{tl:k,tr:I,bl:L,br:D,texPrimary:{x:s.paddedRect.x+Kp+F,y:s.paddedRect.y+Kp+N,w:B-F,h:j-N},texSecondary:V?{x:V.paddedRect.x+Kp+F,y:V.paddedRect.y+Kp+N,w:B-F,h:j-N}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:R,pixelOffsetBR:z,minFontScaleX:S/a/u,minFontScaleY:M/a/h,isSDF:i}};if(r&&(s.stretchX||s.stretchY)){const e=tf(d,g,f),t=tf(p,y,m);for(let i=0;i<e.length-1;i++){const r=e[i],n=e[i+1];for(let e=0;e<t.length-1;e++)o.push(A(r,t[e],n,t[e+1]))}}else o.push(A({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:l+1},{fixed:0,stretch:c+1}));return o}function ef(e,t,i){let r=0;for(const n of e)r+=Math.max(t,Math.min(i,n[1]))-Math.max(t,Math.min(i,n[0]));return r}function tf(e,t,i){const r=[{fixed:-Kp,stretch:0}];for(const[n,o]of e){const e=r[r.length-1];r.push({fixed:n-e.stretch,stretch:e.stretch}),r.push({fixed:n-e.stretch,stretch:e.stretch+(o-n)})}return r.push({fixed:t+Kp,stretch:i}),r}function rf(e,t,i,r){return e/t*i+r}function nf(e,t,i,r){return e-t*i/r}function of(e,t,i,r){const n=t+e.positionedLines[r].lineOffset;return 0===r?i+n/2:i+(n+(t+e.positionedLines[r-1].lineOffset))/2}function sf(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=1/0,n=1/0,o=-1/0,s=-1/0;const a=e[0];for(let p=0;p<a.length;p++){const e=a[p];(!p||e.x<r)&&(r=e.x),(!p||e.y<n)&&(n=e.y),(!p||e.x>o)&&(o=e.x),(!p||e.y>s)&&(s=e.y)}const l=Math.min(o-r,s-n);let c=l/2;const u=new Yi([],af);if(0===l)return new G(r,n);for(let p=r;p<o;p+=l)for(let t=n;t<s;t+=l)u.push(new lf(p+c,t+c,c,e));let h=function(e){let t=0,i=0,r=0;const n=e[0];for(let o=0,s=n.length,a=s-1;o<s;a=o++){const e=n[o],s=n[a],l=e.x*s.y-s.x*e.y;i+=(e.x+s.x)*l,r+=(e.y+s.y)*l,t+=3*l}return new lf(i/t,r/t,0,e)}(e),d=u.length;for(;u.length;){const r=u.pop();(r.d>h.d||!h.d)&&(h=r,i&&console.log("found best %d after %d probes",Math.round(1e4*r.d)/1e4,d)),r.max-h.d<=t||(c=r.h/2,u.push(new lf(r.p.x-c,r.p.y-c,c,e)),u.push(new lf(r.p.x+c,r.p.y-c,c,e)),u.push(new lf(r.p.x-c,r.p.y+c,c,e)),u.push(new lf(r.p.x+c,r.p.y+c,c,e)),d+=4)}return i&&(console.log(`num probes: ${d}`),console.log(`best distance: ${h.d}`)),h.p}function af(e,t){return t.max-e.max}class lf{constructor(e,t,i,r){this.p=new G(e,t),this.h=i,this.d=function(e,t){let i=!1,r=1/0;for(let n=0;n<t.length;n++){const o=t[n];for(let t=0,n=o.length,s=n-1;t<n;s=t++){const n=o[t],a=o[s];n.y>e.y!=a.y>e.y&&e.x<(a.x-n.x)*(e.y-n.y)/(a.y-n.y)+n.x&&(i=!i),r=Math.min(r,jl(e,n,a))}}return(i?1:-1)*Math.sqrt(r)}(this.p,r),this.max=this.d+this.h*Math.SQRT2}}const cf=Number.POSITIVE_INFINITY,uf=Math.sqrt(2);function hf(e,t){let[i,r]=t,n=0,o=0;if(r===cf){i<0&&(i=0);const t=i/uf;switch(e){case"top-right":case"top-left":o=t-7;break;case"bottom-right":case"bottom-left":o=7-t;break;case"bottom":o=7-i;break;case"top":o=i-7}switch(e){case"top-right":case"bottom-right":n=-t;break;case"top-left":case"bottom-left":n=t;break;case"left":n=i;break;case"right":n=-i}}else{switch(i=Math.abs(i),r=Math.abs(r),e){case"top-right":case"top-left":case"top":o=r-7;break;case"bottom-right":case"bottom-left":case"bottom":o=7-r}switch(e){case"top-right":case"bottom-right":case"right":n=-i;break;case"top-left":case"bottom-left":case"left":n=i}}return[n,o]}function df(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function pf(e,t,i,r,n,o,s,a,l,c,u,h,d,p,f){let m=o.textMaxSize.evaluate(t,{},h);void 0===m?m=s*o.textScaleFactor:m*=o.textScaleFactor;const g=e.layers[0].layout,y=g.get("icon-offset").evaluate(t,{},h),_=yf(i.horizontal)||i.vertical,v="globe"===d.name,x=Xd,b=s*o.textScaleFactor/x,w=e.tilePixelRatio*m/x,S=(I=e.overscaling,e.zoom>18&&I>2&&(I>>=1),Math.max(Zi/(512*I),1)*g.get("symbol-spacing")),T=g.get("text-padding")*e.tilePixelRatio,M=g.get("icon-padding")*e.tilePixelRatio,A=q(g.get("text-max-angle")),C="map"===g.get("text-rotation-alignment")&&"point"!==g.get("symbol-placement"),E="map"===g.get("icon-rotation-alignment")&&"point"!==g.get("symbol-placement"),P=g.get("symbol-placement"),k=S/2;var I;const D=g.get("icon-text-fit").evaluate(t,{},h),L=g.get("icon-text-fit-padding").evaluate(t,{},h),R="none"!==D;let z;!1===e.hasAnyIconTextFit&&R&&(e.hasAnyIconTextFit=!0),r&&R&&(e.allowVerticalPlacement&&i.vertical&&(z=Ip(r,i.vertical,D,L,y,b)),_&&(r=Ip(r,_,D,L,y,b)));const O=(s,a,m)=>{if(a.x<0||a.x>=Zi||a.y<0||a.y>=Zi)return;let g=null;if(v){const{x:e,y:t,z:i}=d.projectTilePoint(a.x,a.y,m);g={anchor:new Dp(e,t,i,0,void 0),up:d.upVector(m,a.x,a.y)}}!function(e,t,i,r,n,o,s,a,l,c,u,h,d,p,f,m,g,y,_,v,x,b,w,S,T,M,A){const C=e.addToLineVertexArray(t,r);let E,P,k,I,D,L,R,z=0,O=0,F=0,B=0,N=-1,j=-1;const V={};let U=yt("");const G=i?i.anchor:t,H="none"!==l.layout.get("icon-text-fit").evaluate(x,{},T);let W=0,$=0;if(void 0===l._unevaluatedLayout.getValue("text-radial-offset")?[W,$]=l.layout.get("text-offset").evaluate(x,{},T).map((e=>e*Xd)):(W=l.layout.get("text-radial-offset").evaluate(x,{},T)*Xd,$=cf),e.allowVerticalPlacement&&n.vertical){const e=n.vertical;if(f)L=vf(e),a&&(R=vf(a));else{const i=l.layout.get("text-rotate").evaluate(x,{},T)+90;k=_f(c,G,t,u,h,d,e,p,i,m),a&&(I=_f(c,G,t,u,h,d,a,y,i))}}if(o){const r=e.iconSizeData,n=l.layout.get("icon-rotate").evaluate(x,{},T),s=Qp(o,n,w,H,b.iconScaleFactor),p=a?Qp(a,n,w,H,b.iconScaleFactor):void 0;P=_f(c,G,t,u,h,d,o,y,n,null),z=4*s.length;let f=null;"source"===r.kind?(f=[Yd*l.layout.get("icon-size").evaluate(x,{},T)*b.iconScaleFactor],f[0]>mf&&pe(`${e.layerIds[0]}: Value for "icon-size" is >= ${ff}. Reduce your "icon-size".`)):"composite"===r.kind&&(f=[Yd*b.compositeIconSizes[0].evaluate(x,{},T)*b.iconScaleFactor,Yd*b.compositeIconSizes[1].evaluate(x,{},T)*b.iconScaleFactor],(f[0]>mf||f[1]>mf)&&pe(`${e.layerIds[0]}: Value for "icon-size" is >= ${ff}. Reduce your "icon-size".`)),e.addSymbols(e.icon,s,f,v,_,x,!1,i,t,C.lineStartIndex,C.lineLength,-1,S,T,M,A),N=e.icon.placedSymbolArray.length-1,p&&(O=4*p.length,e.addSymbols(e.icon,p,f,v,_,x,yp.vertical,i,t,C.lineStartIndex,C.lineLength,-1,S,T,M,A),j=e.icon.placedSymbolArray.length-1)}for(const Z in n.horizontal){const r=n.horizontal[Z];E||(U=yt(r.text),f?D=vf(r):E=_f(c,G,t,u,h,d,r,p,l.layout.get("text-rotate").evaluate(x,{},T),m));const o=1===r.positionedLines.length;if(F+=gf(e,i,t,r,s,l,f,x,m,C,n.vertical?yp.horizontal:yp.horizontalOnly,o?Object.keys(n.horizontal):[Z],V,N,b,S,T,M),o)break}n.vertical&&(B+=gf(e,i,t,n.vertical,s,l,f,x,m,C,yp.vertical,["vertical"],V,j,b,S,T,M));let q=-1;const X=(e,t)=>e?Math.max(e,t):t;q=X(D,q),q=X(L,q),q=X(R,q);const Y=q>-1?1:0;e.glyphOffsetArray.length>=65535&&pe("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==x.sortKey&&e.addToSortKeyRanges(e.symbolInstances.length,x.sortKey),e.symbolInstances.emplaceBack(t.x,t.y,G.x,G.y,G.z,V.right>=0?V.right:-1,V.center>=0?V.center:-1,V.left>=0?V.left:-1,V.vertical>=0?V.vertical:-1,N,j,U,void 0!==E?E:e.collisionBoxArray.length,void 0!==E?E+1:e.collisionBoxArray.length,void 0!==k?k:e.collisionBoxArray.length,void 0!==k?k+1:e.collisionBoxArray.length,void 0!==P?P:e.collisionBoxArray.length,void 0!==P?P+1:e.collisionBoxArray.length,I||e.collisionBoxArray.length,I?I+1:e.collisionBoxArray.length,u,F,B,z,O,Y,0,W,$,q,0,H?1:0)}(e,a,g,s,i,r,n,z,e.layers[0],e.collisionBoxArray,t.index,t.sourceLayerIndex,e.index,T,C,l,0,M,E,y,t,o,c,u,h,p,f)};if("line"===P)for(const F of jp(t.geometry,0,0,Zi,Zi)){const t=Bp(F,S,A,i.vertical||_,r,x,w,e.overscaling,Zi);for(const i of t)_&&xf(e,_.text,k,i)||O(F,i,h)}else if("line-center"===P){for(const F of t.geometry)if(F.length>1){const e=Fp(F,A,i.vertical||_,r,x,w);e&&O(F,e,h)}}else if("Polygon"===t.type)for(const F of Ou(t.geometry,0)){const e=sf(F,16);O(F[0],new Dp(e.x,e.y,0,0,void 0),h)}else if("LineString"===t.type)for(const F of t.geometry)O(F,new Dp(F[0].x,F[0].y,0,0,void 0),h);else if("Point"===t.type)for(const F of t.geometry)for(const e of F)O([e],new Dp(e.x,e.y,0,0,void 0),h)}const ff=255,mf=ff*Yd;function gf(e,t,i,r,n,o,s,a,l,c,u,h,d,p,f,m,g,y){const _=function(e,t,i,r,n,o,s,a){const l=[];if(0===t.positionedLines.length)return l;const c=r.layout.get("text-rotate").evaluate(o,{})*Math.PI/180,u=function(e){const t=e[0],i=e[1],r=t*i;return r>0?[t,-i]:r<0?[-t,i]:0===t?[i,t]:[i,-t]}(i);let h=Math.abs(t.top-t.bottom);for(const m of t.positionedLines)h-=m.lineOffset;const d=t.positionedLines.length,p=h/d;let f=t.top-i[1];for(let m=0;m<d;++m){const e=t.positionedLines[m];f=of(t,p,f,m);for(const r of e.positionedGlyphs){if(!r.rect)continue;const e=r.rect||{};let o=gp+1,h=!0,d=1,p=0;if(r.imageName){const e=s[ei.build(r.imageName).getSerializedPrimary()];if(!e)continue;if(e.sdf){pe("SDF images are not supported in formatted text and will be ignored.");continue}h=!1,d=e.pixelRatio,o=Up/d}const m=(n||a)&&r.vertical,g=r.metrics.advance*r.scale/2,y=r.metrics,_=r.rect;if(null===_)continue;a&&t.verticalizable&&(p=r.imageName?g-r.metrics.width*r.scale/2:0);const v=n?[r.x+g,r.y]:[0,0];let x=[0,0],b=[0,0],w=!1;n||(m?(b=[r.x+g+u[0],r.y+u[1]-p],w=!0):x=[r.x+g+i[0],r.y+i[1]-p]);const S=_.w*r.scale/(d*(r.localGlyph?Xp:1)),T=_.h*r.scale/(d*(r.localGlyph?Xp:1));let M,A,C,E;if(m){const e=r.y-f,t=new G(-g,g-e),i=-Math.PI/2,n=new G(...b);M=new G(-g+x[0],x[1]),M._rotateAround(i,t)._add(n),M.x+=-e+g,M.y-=(y.left-o)*r.scale;const s=r.imageName?y.advance*r.scale:Xd*r.scale,a=String.fromCodePoint(r.glyph);rp(a)?M.x+=(1-o)*r.scale:np(a)?M.x+=s-y.height*r.scale+(-o-1)*r.scale:M.x+=r.imageName||y.width+2*o===_.w&&y.height+2*o===_.h?(s-T)/2:(s-(y.height+2*o)*r.scale)/2,A=new G(M.x,M.y-S),C=new G(M.x+T,M.y),E=new G(M.x+T,M.y-S)}else{const e=(y.left-o)*r.scale-g+x[0],t=(-y.top-o)*r.scale+x[1],i=e+S,n=t+T;M=new G(e,t),A=new G(i,t),C=new G(e,n),E=new G(i,n)}if(c){let e;e=n?new G(0,0):w?new G(u[0],u[1]):new G(i[0],i[1]),M._rotateAround(c,e),A._rotateAround(c,e),C._rotateAround(c,e),E._rotateAround(c,e)}const P=new G(0,0),k=new G(0,0);l.push({tl:M,tr:A,bl:C,br:E,texPrimary:e,texSecondary:void 0,writingMode:t.writingMode,glyphOffset:v,sectionIndex:r.sectionIndex,isSDF:h,pixelOffsetTL:P,pixelOffsetBR:k,minFontScaleX:0,minFontScaleY:0})}}return l}(0,r,l,o,s,a,n,e.allowVerticalPlacement),v=e.textSizeData;let x=null;"source"===v.kind?(x=[Yd*o.layout.get("text-size").evaluate(a,{},g)*f.textScaleFactor],x[0]>mf&&pe(`${e.layerIds[0]}: Value for "text-size" is >= ${ff}. Reduce your "text-size".`)):"composite"===v.kind&&(x=[Yd*f.compositeTextSizes[0].evaluate(a,{},g)*f.textScaleFactor,Yd*f.compositeTextSizes[1].evaluate(a,{},g)*f.textScaleFactor],(x[0]>mf||x[1]>mf)&&pe(`${e.layerIds[0]}: Value for "text-size" is >= ${ff}. Reduce your "text-size".`)),e.addSymbols(e.text,_,x,l,s,a,u,t,i,c.lineStartIndex,c.lineLength,p,m,g,y,!1);for(const b of h)d[b]=e.text.placedSymbolArray.length-1;return 4*_.length}function yf(e){for(const t in e)return e[t];return null}function _f(e,t,i,r,n,o,s,a,l,c){let u=s.top,h=s.bottom,d=s.left,p=s.right;const f=s.collisionPadding;if(f&&(d-=f[0],u-=f[1],p+=f[2],h+=f[3]),l){const e=new G(d,u),t=new G(p,u),i=new G(d,h),r=new G(p,h),n=q(l);let o=new G(0,0);c&&(o=new G(c[0],c[1])),e._rotateAround(n,o),t._rotateAround(n,o),i._rotateAround(n,o),r._rotateAround(n,o),d=Math.min(e.x,t.x,i.x,r.x),p=Math.max(e.x,t.x,i.x,r.x),u=Math.min(e.y,t.y,i.y,r.y),h=Math.max(e.y,t.y,i.y,r.y)}return e.emplaceBack(t.x,t.y,t.z,i.x,i.y,d,u,p,h,a,r,n,o),e.length-1}function vf(e){e.collisionPadding&&(e.top-=e.collisionPadding[1],e.bottom+=e.collisionPadding[3]);const t=e.bottom-e.top;return t>0?Math.max(10,t):null}function xf(e,t,i,r){const n=e.compareText;if(t in n){const e=n[t];for(let t=e.length-1;t>=0;t--)if(r.dist(e[t])<i)return!0}else n[t]=[];return n[t].push(r),!1}function bf(e,t){const i=e.fovAboveCenter,r=e.elevation?e.elevation.getMinElevationBelowMSL()*t:0,n=(e._camera.position[2]*e.worldSize-r)/Math.cos(e._pitch),o=Math.sin(i)*n/Math.sin(Math.max(Math.PI/2-e._pitch-i,.01));let s=Math.sin(e._pitch)*o+n;const a=n*(1/e._horizonShift);if(!e.elevation||0===e.elevation.exaggeration()){let t=Math.max(e.zoom-17,0);e.isOrthographic&&(t/=10),s*=1+t}return Math.min(1.01*s,a)}function wf(e,t){if(!t.isReprojectedInTileSpace)return{scale:1<<e.z,x:e.x,y:e.y,x2:e.x+1,y2:e.y+1,projection:t};const i=Math.pow(2,-e.z),r=e.x*i,n=(e.x+1)*i,o=e.y*i,s=(e.y+1)*i,a=dl(r),l=dl(n),c=pl(o),u=pl(s),h=t.project(a,c),d=t.project(l,c),p=t.project(l,u),f=t.project(a,u);let m=Math.min(h.x,d.x,p.x,f.x),g=Math.min(h.y,d.y,p.y,f.y),y=Math.max(h.x,d.x,p.x,f.x),_=Math.max(h.y,d.y,p.y,f.y);const v=i/16;function x(e,i,r,n,o,s){const a=(r+o)/2,l=(n+s)/2,c=t.project(dl(a),pl(l)),u=Math.max(0,m-c.x,g-c.y,c.x-y,c.y-_);m=Math.min(m,c.x),y=Math.max(y,c.x),g=Math.min(g,c.y),_=Math.max(_,c.y),u>v&&(x(e,c,r,n,a,l),x(c,i,a,l,o,s))}x(h,d,r,o,n,o),x(d,p,n,o,n,s),x(p,f,n,s,r,s),x(f,h,r,s,r,o),m-=v,g-=v,y+=v,_+=v;const b=1/Math.max(y-m,_-g);return{scale:b,x:m*b,y:g*b,x2:y*b,y2:_*b,projection:t}}function Sf(e,t){let{x:i,y:r}=t;return new G(((i-(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0))*e.scale-e.x)*Zi,(r*e.scale-e.y)*Zi)}const Tf=N.mat4.identity(new Float32Array(16));class Mf{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,t){return{x:0,y:0,z:0}}unproject(e,t){return new nl(0,0)}projectTilePoint(e,t,i){return{x:e,y:t,z:0}}locationPoint(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return e._coordinatePoint(e.locationCoordinate(t),i)}pixelsPerMeter(e,t){return hl(1,e)*t}pixelSpaceConversion(e,t,i){return 1}farthestPixelDistance(e){return bf(e,e.pixelsPerMeter)}pointCoordinate(e,t,i,r){const n=e.horizonLineFromTop(!1),o=new G(t,Math.max(n,i));return e.rayIntersectionCoordinate(e.pointRayIntersection(o,r))}pointCoordinate3D(e,t,i){const r=new G(t,i);if(e.elevation)return e.elevation.pointCoordinate(r);{const t=this.pointCoordinate(e,r.x,r.y,0);return[t.x,t.y,t.z]}}isPointAboveHorizon(e,t){if(e.elevation&&e.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(e,t.x,t.y);const i=e.horizonLineFromTop();return t.y<i}createInversionMatrix(e,t){return Tf}createTileMatrix(e,t,i){let r,n,o;const s=i.canonical,a=N.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const l=wf(s,this);r=1,n=l.x+i.wrap*l.scale,o=l.y,N.mat4.scale(a,a,[r/l.scale,r/l.scale,e.pixelsPerMeter/t])}else r=t/e.zoomScale(s.z),n=(s.x+Math.pow(2,s.z)*i.wrap)*r,o=s.y*r;return N.mat4.translate(a,a,[n,o,0]),N.mat4.scale(a,a,[r/Zi,r/Zi,1]),a}upVector(e,t,i){return[0,0,1]}upVectorScale(e,t,i){return{metersToTile:1}}}class Af extends Mf{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[t,i]=this.parallels=e.parallels||[29.5,45.5],r=Math.sin(q(t));this.n=(r+Math.sin(q(i)))/2,this.c=1+r*(2*this.n-r),this.r0=Math.sqrt(this.c)/this.n}project(e,t){const{n:i,c:r,r0:n}=this,o=q(e-this.center[0]),s=q(t),a=Math.sqrt(r-2*i*Math.sin(s))/i;return{x:a*Math.sin(o*i),y:a*Math.cos(o*i)-n,z:0}}unproject(e,t){const{n:i,c:r,r0:n}=this,o=n+t;let s=Math.atan2(e,Math.abs(o))*Math.sign(o);o*i<0&&(s-=Math.PI*Math.sign(e)*Math.sign(o));const a=q(this.center[0])*i;s=te(s,-Math.PI-a,Math.PI-a);const l=Q(X(s/i)+this.center[0],-180,180),c=Math.asin(Q((r-(e*e+o*o)*i*i)/(2*i),-1,1)),u=Q(X(c),-ml,ml);return new nl(l,u)}}const Cf=1.340264,Ef=-.081106,Pf=893e-6,kf=.003796,If=Math.sqrt(3)/2;class Df extends Mf{project(e,t){t=t/180*Math.PI,e=e/180*Math.PI;const i=Math.asin(If*Math.sin(t)),r=i*i,n=r*r*r;return{x:.5*(e*Math.cos(i)/(If*(Cf+3*Ef*r+n*(7*Pf+9*kf*r)))/Math.PI+.5),y:1-.5*(i*(Cf+Ef*r+n*(Pf+kf*r))/Math.PI+1),z:0}}unproject(e,t){e=(2*e-.5)*Math.PI;let i=t=(2*(1-t)-1)*Math.PI,r=i*i,n=r*r*r;for(let c,u,h,d=0;d<12&&(u=i*(Cf+Ef*r+n*(Pf+kf*r))-t,h=Cf+3*Ef*r+n*(7*Pf+9*kf*r),c=u/h,i=Q(i-c,-Math.PI/3,Math.PI/3),r=i*i,n=r*r*r,!(Math.abs(c)<1e-12));++d);const o=If*e*(Cf+3*Ef*r+n*(7*Pf+9*kf*r))/Math.cos(i),s=Math.asin(Math.sin(i)/If),a=Q(180*o/Math.PI,-180,180),l=Q(180*s/Math.PI,-ml,ml);return new nl(a,l)}}class Lf extends Mf{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,t){return{x:.5+e/360,y:.5-t/360,z:0}}unproject(e,t){const i=360*(e-.5),r=Q(360*(.5-t),-ml,ml);return new nl(i,r)}}const Rf=Math.PI/2;function zf(e){return Math.tan((Rf+e)/2)}class Of extends Mf{constructor(e){super(e),this.center=e.center||[0,30];const[t,i]=this.parallels=e.parallels||[30,30];let r=q(t),n=q(i);this.southernCenter=r+n<0,this.southernCenter&&(r=-r,n=-n);const o=Math.cos(r),s=zf(r);this.n=r===n?Math.sin(r):Math.log(o/Math.cos(n))/Math.log(zf(n)/s),this.f=o*Math.pow(zf(r),this.n)/this.n}project(e,t){t=q(t),this.southernCenter&&(t=-t),e=q(e-this.center[0]);const i=1e-6,{n:r,f:n}=this;n>0?t<-Rf+i&&(t=-Rf+i):t>Rf-i&&(t=Rf-i);const o=n/Math.pow(zf(t),r);let s=o*Math.sin(r*e),a=n-o*Math.cos(r*e);return s=.5*(s/Math.PI+.5),a=.5*(a/Math.PI+.5),{x:s,y:this.southernCenter?a:1-a,z:0}}unproject(e,t){e=(2*e-.5)*Math.PI,this.southernCenter&&(t=1-t),t=(2*(1-t)-.5)*Math.PI;const{n:i,f:r}=this,n=r-t,o=Math.sign(n),s=Math.sign(i)*Math.sqrt(e*e+n*n);let a=Math.atan2(e,Math.abs(n))*o;n*i<0&&(a-=Math.PI*Math.sign(e)*o);const l=Q(X(a/i)+this.center[0],-180,180),c=Q(X(2*Math.atan(Math.pow(r/s,1/i))-Rf),-ml,ml);return new nl(l,this.southernCenter?-c:c)}}class Ff extends Mf{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,t){return{x:cl(e),y:ul(t),z:0}}unproject(e,t){const i=dl(e),r=pl(t);return new nl(i,r)}}const Bf=q(ml);class Nf extends Mf{project(e,t){const i=(t=q(t))*t,r=i*i;return{x:.5*((e=q(e))*(.8707-.131979*i+r*(r*(.003971*i-.001529*r)-.013791))/Math.PI+.5),y:1-.5*(t*(1.007226+i*(.015085+r*(.028874*i-.044475-.005916*r)))/Math.PI+1),z:0}}unproject(e,t){e=(2*e-.5)*Math.PI;let i=t=(2*(1-t)-1)*Math.PI,r=25,n=0,o=i*i;do{o=i*i;const e=o*o;n=(i*(1.007226+o*(.015085+e*(.028874*o-.044475-.005916*e)))-t)/(1.007226+o*(.045255+e*(.259866*o-.311325-.005916*11*e))),i=Q(i-n,-Bf,Bf)}while(Math.abs(n)>1e-6&&--r>0);o=i*i;const s=Q(X(e/(.8707+o*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979))),-180,180),a=X(i);return new nl(s,a)}}const jf=q(ml);class Vf extends Mf{project(e,t){t=q(t),e=q(e);const i=Math.cos(t),r=2/Math.PI,n=Math.acos(i*Math.cos(e/2)),o=Math.sin(n)/n,s=.5*(e*r+2*i*Math.sin(e/2)/o)||0,a=.5*(t+Math.sin(t)/o)||0;return{x:.5*(s/Math.PI+.5),y:1-.5*(a/Math.PI+1),z:0}}unproject(e,t){let i=e=(2*e-.5)*Math.PI,r=t=(2*(1-t)-1)*Math.PI,n=25;const o=1e-6;let s=0,a=0;do{const n=Math.cos(r),o=Math.sin(r),l=2*o*n,c=o*o,u=n*n,h=Math.cos(i/2),d=Math.sin(i/2),p=2*h*d,f=d*d,m=1-u*h*h,g=m?1/m:0,y=m?Math.acos(n*h)*Math.sqrt(1/m):0,_=.5*(2*y*n*d+2*i/Math.PI)-e,v=.5*(y*o+r)-t,x=.5*g*(u*f+y*n*h*c)+1/Math.PI,b=g*(p*l/4-y*o*d),w=.125*g*(l*d-y*o*u*p),S=.5*g*(c*h+y*f*n)+.5,T=b*w-S*x;s=(v*b-_*S)/T,a=(_*w-v*x)/T,i=Q(i-s,-Math.PI,Math.PI),r=Q(r-a,-jf,jf)}while((Math.abs(s)>o||Math.abs(a)>o)&&--n>0);return new nl(X(i),X(r))}}class Uf extends Mf{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(q(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,t){const{scale:i,cosPhi:r}=this;return{x:q(e)*r*i+.5,y:-Math.sin(q(t))/r*i+.5,z:0}}unproject(e,t){const{scale:i,cosPhi:r}=this,n=-(t-.5)/i,o=Q(X((e-.5)/i)/r,-180,180),s=Math.asin(Q(n*r,-1,1)),a=Q(X(s),-ml,ml);return new nl(o,a)}}class Gf extends Ff{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,t,i){const r=kc(e,t,i),n=Lc(Tc(i));return N.vec3.transformMat4(r,r,n),{x:r[0],y:r[1],z:r[2]}}locationPoint(e,t){const i=tl(t.lat,t.lng),r=N.vec3.normalize([],i),n=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(t),e._centerAltitude):e._centerAltitude,o=hl(1,0)*Zi*n;N.vec3.scaleAndAdd(i,i,r,o);const s=N.mat4.identity(new Float64Array(16));return N.mat4.multiply(s,e.pixelMatrix,e.globeMatrix),N.vec3.transformMat4(i,i,s),new G(i[0],i[1])}pixelsPerMeter(e,t){return hl(1,0)*t}pixelSpaceConversion(e,t,i){const r=hl(1,e)*t,n=Et(hl(1,45)*t,r,i);return this.pixelsPerMeter(e,t)/n}createTileMatrix(e,t,i){const r=Rc(Tc(i.canonical));return N.mat4.multiply(new Float64Array(16),e.globeMatrix,r)}createInversionMatrix(e,t){const{center:i}=e,r=Lc(Tc(t));return N.mat4.rotateY(r,r,q(i.lng)),N.mat4.rotateX(r,r,q(i.lat)),N.mat4.scale(r,r,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(r)}pointCoordinate(e,t,i,r){return bc(e,t,i,!0)||new xl(0,0)}pointCoordinate3D(e,t,i){const r=this.pointCoordinate(e,t,i,0);return[r.x,r.y,r.z]}isPointAboveHorizon(e,t){return!bc(e,t.x,t.y,!1)}farthestPixelDistance(e){const t=function(e,t){const i=e.cameraToCenterDistance,r=e._centerAltitude*t,n=e._camera,o=e._camera.forward(),s=N.vec3.add([],N.vec3.scale([],o,-i),[0,0,r]),a=e.worldSize/(2*Math.PI),l=[0,0,-a],c=e.width/e.height,u=Math.tan(e.fovAboveCenter),h=N.vec3.scale([],n.up(),u),d=N.vec3.scale([],n.right(),u*c),p=N.vec3.normalize([],N.vec3.add([],N.vec3.add([],o,h),d)),f=[];let m;if(new hc(s,p).closestPointOnSphere(l,a,f)){const t=N.vec3.add([],f,l),i=N.vec3.sub([],t,s);m=Math.cos(e.fovAboveCenter)*N.vec3.length(i)}else{const e=N.vec3.sub([],s,l),t=N.vec3.sub([],l,s);N.vec3.normalize(t,t);const i=N.vec3.length(e)-a;m=Math.sqrt(i*(i+2*a));const r=Math.acos(m/(a+i))-Math.acos(N.vec3.dot(o,t));m*=Math.cos(r)}return 1.01*m}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),i=Bc(e.zoom);if(i>0){const r=bf(e,hl(1,e.center.lat)*e.worldSize),n=e.worldSize/(2*Math.PI),o=Math.max(e.width,e.height)/e.worldSize*Math.PI;return Et(t,r+n*(1-Math.cos(o)),Math.pow(i,10))}return t}upVector(e,t,i){return kc(t,i,e,1)}upVectorScale(e){return{metersToTile:vc(Ic(Tc(e)))}}}function Hf(e){const t=e.parallels,i=!!t&&Math.abs(t[0]+t[1])<.01;switch(e.name){case"mercator":return new Ff(e);case"equirectangular":return new Lf(e);case"naturalEarth":return new Nf(e);case"equalEarth":return new Df(e);case"winkelTripel":return new Vf(e);case"albers":return i?new Uf(e):new Af(e);case"lambertConformalConic":return i?new Uf(e):new Of(e);case"globe":return new Gf(e)}throw new Error(`Invalid projection name: ${e.name}`)}const Wf=ph.VectorTileFeature.types,$f=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function qf(e,t,i,r,n,o,s,a,l,c,u,h,d){const p=a?Math.min(mf,Math.round(a[0])):0,f=a?Math.min(mf,Math.round(a[1])):0;e.emplaceBack(t,i,Math.round(32*r),Math.round(32*n),o,s,(p<<1)+(l?1:0),f,16*c,16*u,256*h,256*d)}function Xf(e,t,i){e.emplaceBack(t,i)}function Yf(e,t,i,r,n,o,s){e.emplaceBack(t,i,r,n,o,s)}function Zf(e,t,i,r,n){e.emplaceBack(t,i,r,n),e.emplaceBack(t,i,r,n),e.emplaceBack(t,i,r,n),e.emplaceBack(t,i,r,n)}function Kf(e){for(const t of e.sections)if(bo(t.text))return!0;return!1}class Jf{constructor(e){this.layoutVertexArray=new Es,this.indexArray=new Fs,this.programConfigurations=e,this.segments=new pa,this.dynamicLayoutVertexArray=new ks,this.opacityVertexArray=new Is,this.placedSymbolArray=new ta,this.iconTransitioningVertexArray=new Ds,this.globeExtVertexArray=new Ps,this.zOffsetVertexArray=new js}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length&&0===this.iconTransitioningVertexArray.length}upload(e,t,i,r,n){this.isEmpty()||(i&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Nd.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Vd.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,$f,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=e.createVertexBuffer(this.iconTransitioningVertexArray,Gd.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,jd.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||n)&&(this.zOffsetVertexBuffer=e.createVertexBuffer(this.zOffsetVertexArray,Ud.members,!0)),this.opacityVertexBuffer.itemSize=1),(i||r)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}ao(Jf,"SymbolBuffers");class Qf{constructor(e,t,i){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new i,this.segments=new pa,this.collisionVertexArray=new Os,this.collisionVertexArrayExt=new ks}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Hd.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,Wd.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}ao(Qf,"CollisionBuffers");class em{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.lut=e.lut,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.fqid)),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=N.mat4.identity([]),this.placementViewportMatrix=N.mat4.identity([]);const t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Kd(this.zoom,t["text-size"]),this.iconSizeData=Kd(this.zoom,t["icon-size"]);const i=this.layers[0].layout,r=i.get("symbol-sort-key"),n=i.get("symbol-z-order");this.canOverlap=i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==n&&void 0!==r.constantOr(1),this.sortFeaturesByY=("viewport-y"===n||"auto"===n&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=i.get("text-writing-mode").map((e=>yp[e])),this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.sourceID=e.sourceID,this.projection=e.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=i.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new Jf(new ja(this.layers,{zoom:this.zoom,lut:this.lut},(e=>e.startsWith("text")||e.startsWith("symbol")))),this.icon=new Jf(new ja(this.layers,{zoom:this.zoom,lut:this.lut},(e=>e.startsWith("icon")||e.startsWith("symbol")))),this.glyphOffsetArray=new na,this.lineVertexArray=new oa,this.symbolInstances=new ra}calculateGlyphDependencies(e,t,i,r,n){for(const o of e){const e=o.codePointAt(0);if(void 0===e)break;if(t[e]=!0,r&&n&&e<=65535){const e=ip[o];e&&(t[e.charCodeAt(0)]=!0)}}}updateFootprints(e,t){}updateReplacement(e,t){if(t.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=t.updateTime;const i=t.getReplacementRegionsForTile(e.toUnwrapped(),!0);return!Th(this.activeReplacements,i)&&(this.activeReplacements=i,!0)}populate(e,t,i,r){const n=this.layers[0],o=n.layout,s="globe"===this.projection.name,a=o.get("text-font"),l=o.get("text-field"),c=o.get("icon-image"),[u,h]=o.get("icon-size-scale-range"),d=Q(t.scaleFactor||1,u,h),p=("constant"!==l.value.kind||l.value.value instanceof Jt&&!l.value.value.isEmpty()||l.value.value.toString().length>0)&&("constant"!==a.value.kind||a.value.value.length>0),f="constant"!==c.value.kind||!!c.value.value||Object.keys(c.parameters).length>0,m=o.get("symbol-sort-key");if(this.features=[],!p&&!f)return;const g=t.iconDependencies,y=t.glyphDependencies,_=t.availableImages,v=new Ro(this.zoom);for(const{feature:x,id:b,index:w,sourceLayerIndex:S}of e){const e=n._featureFilter.needGeometry,t=Pl(x,e);if(!n._featureFilter.filter(v,t,i))continue;if(e||(t.geometry=El(x,i,r)),s&&1!==x.type&&i.z<=5){const e=t.geometry,r=.98078528056,n=(e,t)=>{const n=kc(e.x,e.y,i,1),o=kc(t.x,t.y,i,1);return N.vec3.dot(n,o)<r};for(let t=0;t<e.length;t++)e[t]=Tl(e[t],n)}let l,c;if(p){const e=n.getValueAndResolveTokens("text-field",t,i,_),r=Jt.factory(e);Kf(r)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===Io()||this.hasRTLText&&Lo.isParsed())&&(l=tp(r,n,t))}if(f){const e=n.getValueAndResolveTokens("icon-image",t,i,_);c=e instanceof ei?e:ei.build(e)}if(!l&&!c)continue;const u=this.sortFeaturesByKey?m.evaluate(t,{},i):void 0,h={id:b,text:l,icon:c,index:w,sourceLayerIndex:S,geometry:t.geometry,properties:x.properties,type:Wf[x.type],sortKey:u};if(this.features.push(h),c){const e=Zd(this.iconSizeData,this.layers[0]._unevaluatedLayout._values["icon-size"],i,this.zoom,h)*d*this.pixelRatio,t=c.getPrimary().scaleSelf(e);if(g[t.id]=g[t.id]||[],g[t.id].push(t),c.nameSecondary){const t=c.getSecondary().scaleSelf(e);g[t.id]=g[t.id]||[],g[t.id].push(t)}}if(l){const e=a.evaluate(t,{},i).join(","),r="map"===o.get("text-rotation-alignment")&&"point"!==o.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(yp.vertical)>=0;for(const t of l.sections)if(t.image){const e=t.image.getPrimary().scaleSelf(this.pixelRatio);g[e.id]=g[e.id]||[],g[e.id].push(e)}else{const i=fo(l.toString()),n=t.fontStack||e,o=y[n]=y[n]||{};this.calculateGlyphDependencies(t.text,o,r,this.allowVerticalPlacement,i)}}}"line"===o.get("symbol-placement")&&(this.features=function(e){const t={},i={},r=[];let n=0;function o(t){r.push(e[t]),n++}function s(e,t,n){const o=i[e];return delete i[e],i[t]=o,r[o].geometry[0].pop(),r[o].geometry[0]=r[o].geometry[0].concat(n[0]),o}function a(e,i,n){const o=t[i];return delete t[i],t[e]=o,r[o].geometry[0].shift(),r[o].geometry[0]=n[0].concat(r[o].geometry[0]),o}function l(e,t,i){const r=i?t[0][t[0].length-1]:t[0][0];return`${e}:${r.x}:${r.y}`}for(let c=0;c<e.length;c++){const u=e[c],h=u.geometry,d=u.text?u.text.toString():null;if(!d){o(c);continue}const p=l(d,h),f=l(d,h,!0);if(p in i&&f in t&&i[p]!==t[f]){const e=a(p,f,h),n=s(p,f,r[e].geometry);delete t[p],delete i[f],i[l(d,r[n].geometry,!0)]=n,r[e].geometry=null}else p in i?s(p,f,h):f in t?a(p,f,h):(o(c),t[p]=n-1,i[f]=n-1)}return r.filter((e=>e.geometry))}(this.features)),this.sortFeaturesByKey&&this.features.sort(((e,t)=>e.sortKey-t.sortKey))}update(e,t,i,r,n,o,s){this.text.programConfigurations.updatePaintArrays(e,t,n,i,r,o,s),this.icon.programConfigurations.updatePaintArrays(e,t,n,i,r,o,s)}updateZOffset(){const e=(e,t,r)=>{i+=t,i>e.length&&e.resize(i);for(let n=-t;n<0;n++)e.emplace(n+i,r)},t=(e,t,i)=>{r+=t,r>e.length&&e.resize(r);for(let n=-t;n<0;n++)e.emplace(n+r,i)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let i=0,r=0;for(let n=0;n<this.symbolInstances.length;n++){const i=this.symbolInstances.get(n),{numHorizontalGlyphVertices:r,numVerticalGlyphVertices:o,numIconVertices:s}=i,a=i.zOffset,l=s>0;if((r>0||o>0)&&(e(this.text.zOffsetVertexArray,r,a),e(this.text.zOffsetVertexArray,o,a)),l){const{placedIconSymbolIndex:e,verticalPlacedIconSymbolIndex:r}=i;e>=0&&t(this.icon.zOffsetVertexArray,s,a),r>=0&&t(this.icon.zOffsetVertexArray,i.numVerticalIconVertices,a)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Hf(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,t){const i=this.lineVertexArray.length;if(void 0!==e.segment)for(const{x:r,y:n}of t)this.lineVertexArray.emplaceBack(r,n);return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}}addSymbols(e,t,i,r,n,o,s,a,l,c,u,h,d,p,f,m){const g=e.indexArray,y=e.layoutVertexArray,_=e.globeExtVertexArray,v=e.segments.prepareSegment(4*t.length,y,g,this.canOverlap?o.sortKey:void 0),x=this.glyphOffsetArray.length,b=v.vertexLength,w=this.allowVerticalPlacement&&s===yp.vertical?Math.PI/2:0,S=o.text&&o.text.sections;for(let M=0;M<t.length;M++){const{tl:r,tr:n,bl:s,br:c,texPrimary:u,texSecondary:h,pixelOffsetTL:x,pixelOffsetBR:b,minFontScaleX:T,minFontScaleY:A,glyphOffset:C,isSDF:E,sectionIndex:P}=t[M],k=v.vertexLength,I=C[1];if(qf(y,l.x,l.y,r.x,I+r.y,u.x,u.y,i,E,x.x,x.y,T,A),qf(y,l.x,l.y,n.x,I+n.y,u.x+u.w,u.y,i,E,b.x,x.y,T,A),qf(y,l.x,l.y,s.x,I+s.y,u.x,u.y+u.h,i,E,x.x,b.y,T,A),qf(y,l.x,l.y,c.x,I+c.y,u.x+u.w,u.y+u.h,i,E,b.x,b.y,T,A),a){const{x:t,y:i,z:r}=a.anchor,[n,o,s]=a.up;Yf(_,t,i,r,n,o,s),Yf(_,t,i,r,n,o,s),Yf(_,t,i,r,n,o,s),Yf(_,t,i,r,n,o,s),Zf(e.dynamicLayoutVertexArray,t,i,r,w)}else Zf(e.dynamicLayoutVertexArray,l.x,l.y,l.z,w);if(m){const t=h||u;Xf(e.iconTransitioningVertexArray,t.x,t.y),Xf(e.iconTransitioningVertexArray,t.x+t.w,t.y),Xf(e.iconTransitioningVertexArray,t.x,t.y+t.h),Xf(e.iconTransitioningVertexArray,t.x+t.w,t.y+t.h)}g.emplaceBack(k,k+1,k+2),g.emplaceBack(k+1,k+2,k+3),v.vertexLength+=4,v.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(C[0]),M!==t.length-1&&P===t[M+1].sectionIndex||e.programConfigurations.populatePaintArrays(y.length,o,o.index,{},d,p,f,S&&S[P])}const T=a?a.anchor:l;e.placedSymbolArray.emplaceBack(T.x,T.y,T.z,l.x,l.y,x,this.glyphOffsetArray.length-x,b,c,u,l.segment,i?i[0]:0,i?i[1]:0,r[0],r[1],s,0,!1,0,h,0)}_commitLayoutVertex(e,t,i,r,n,o,s){e.emplaceBack(t,i,r,n,o,Math.round(s.x),Math.round(s.y))}_addCollisionDebugVertices(e,t,i,r,n,o,s){const a=i.segments.prepareSegment(4,i.layoutVertexArray,i.indexArray),l=a.vertexLength,c=s.tileAnchorX,u=s.tileAnchorY;for(let d=0;d<4;d++)i.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(i.collisionVertexArrayExt,t,e.padding,s.zOffset),this._commitLayoutVertex(i.layoutVertexArray,r,n,o,c,u,new G(e.x1,e.y1)),this._commitLayoutVertex(i.layoutVertexArray,r,n,o,c,u,new G(e.x2,e.y1)),this._commitLayoutVertex(i.layoutVertexArray,r,n,o,c,u,new G(e.x2,e.y2)),this._commitLayoutVertex(i.layoutVertexArray,r,n,o,c,u,new G(e.x1,e.y2)),a.vertexLength+=4;const h=i.indexArray;h.emplaceBack(l,l+1),h.emplaceBack(l+1,l+2),h.emplaceBack(l+2,l+3),h.emplaceBack(l+3,l),a.primitiveLength+=4}_addTextDebugCollisionBoxes(e,t,i,r,n,o){for(let s=r;s<n;s++){const r=i.get(s),n=this.getSymbolInstanceTextSize(e,o,t,s);this._addCollisionDebugVertices(r,n,this.textCollisionBox,r.projectedAnchorX,r.projectedAnchorY,r.projectedAnchorZ,o)}}_addIconDebugCollisionBoxes(e,t,i,r,n,o){for(let s=r;s<n;s++){const r=i.get(s),n=this.getSymbolInstanceIconSize(e,t,o.placedIconSymbolIndex);this._addCollisionDebugVertices(r,n,this.iconCollisionBox,r.projectedAnchorX,r.projectedAnchorY,r.projectedAnchorZ,o)}}generateCollisionDebugBuffers(e,t,i){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Qf(Rs,$d.members,Ds),this.iconCollisionBox=new Qf(Rs,$d.members,Ds);const r=Qd(this.iconSizeData,e),n=Qd(this.textSizeData,e,i);for(let o=0;o<this.symbolInstances.length;o++){const i=this.symbolInstances.get(o);this._addTextDebugCollisionBoxes(n,e,t,i.textBoxStartIndex,i.textBoxEndIndex,i),this._addTextDebugCollisionBoxes(n,e,t,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i),this._addIconDebugCollisionBoxes(r,e,t,i.iconBoxStartIndex,i.iconBoxEndIndex,i),this._addIconDebugCollisionBoxes(r,e,t,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex,i)}}getSymbolInstanceTextSize(e,t,i,r){const n=this.text.placedSymbolArray.get(t.rightJustifiedTextSymbolIndex>=0?t.rightJustifiedTextSymbolIndex:t.centerJustifiedTextSymbolIndex>=0?t.centerJustifiedTextSymbolIndex:t.leftJustifiedTextSymbolIndex>=0?t.leftJustifiedTextSymbolIndex:t.verticalPlacedTextSymbolIndex>=0?t.verticalPlacedTextSymbolIndex:r),o=Jd(this.textSizeData,e,n)/Xd;return this.tilePixelRatio*o}getSymbolInstanceIconSize(e,t,i){const r=this.icon.placedSymbolArray.get(i),n=Jd(this.iconSizeData,e,r);return this.tilePixelRatio*n}_commitDebugCollisionVertexUpdate(e,t,i,r){e.emplaceBack(t,-i,-i,r),e.emplaceBack(t,i,-i,r),e.emplaceBack(t,i,i,r),e.emplaceBack(t,-i,i,r)}_updateTextDebugCollisionBoxes(e,t,i,r,n,o,s){for(let a=r;a<n;a++){const r=i.get(a),n=this.getSymbolInstanceTextSize(e,o,t,a);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,n,r.padding,o.zOffset)}}_updateIconDebugCollisionBoxes(e,t,i,r,n,o,s){for(let a=r;a<n;a++){const r=i.get(a),n=this.getSymbolInstanceIconSize(e,t,o.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,n,r.padding,o.zOffset)}}updateCollisionDebugBuffers(e,t,i,r){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const n=Qd(this.iconSizeData,e,r),o=Qd(this.textSizeData,e,i);for(let s=0;s<this.symbolInstances.length;s++){const a=this.symbolInstances.get(s);this._updateTextDebugCollisionBoxes(o,e,t,a.textBoxStartIndex,a.textBoxEndIndex,a,i),this._updateTextDebugCollisionBoxes(o,e,t,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a,i),this._updateIconDebugCollisionBoxes(n,e,t,a.iconBoxStartIndex,a.iconBoxEndIndex,a,r),this._updateIconDebugCollisionBoxes(n,e,t,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex,a,r)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,t,i,r,n,o,s,a,l){const c={};if(t<i){const{x1:i,y1:r,x2:n,y2:o,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d,featureIndex:p}=e.get(t);c.textBox={x1:i,y1:r,x2:n,y2:o,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d},c.textFeatureIndex=p}if(r<n){const{x1:t,y1:i,x2:n,y2:o,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d,featureIndex:p}=e.get(r);c.verticalTextBox={x1:t,y1:i,x2:n,y2:o,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d},c.verticalTextFeatureIndex=p}if(o<s){const{x1:t,y1:i,x2:r,y2:n,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d,featureIndex:p}=e.get(o);c.iconBox={x1:t,y1:i,x2:r,y2:n,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d},c.iconFeatureIndex=p}if(a<l){const{x1:t,y1:i,x2:r,y2:n,padding:o,projectedAnchorX:s,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d,featureIndex:p}=e.get(a);c.verticalIconBox={x1:t,y1:i,x2:r,y2:n,padding:o,projectedAnchorX:s,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d},c.verticalIconFeatureIndex=p}return c}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let t=0;t<this.symbolInstances.length;t++){const i=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(e,t){const i=e.placedSymbolArray.get(t),r=i.vertexStartIndex+4*i.numGlyphs;for(let n=i.vertexStartIndex;n<r;n+=4)e.indexArray.emplaceBack(n,n+1,n+2),e.indexArray.emplaceBack(n+1,n+2,n+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const t=Math.sin(e),i=Math.cos(e),r=[],n=[],o=[];for(let s=0;s<this.symbolInstances.length;++s){o.push(s);const e=this.symbolInstances.get(s);r.push(0|Math.round(t*e.tileAnchorX+i*e.tileAnchorY)),n.push(e.featureIndex)}return o.sort(((e,t)=>r[e]-r[t]||n[t]-n[e])),o}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let e=0;e<this.symbolInstances.length;++e)this.symbolInstanceIndexesSortedZOffset.push(e)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort(((e,t)=>this.symbolInstances.get(t).zOffset-this.symbolInstances.get(e).zOffset))}addToSortKeyRanges(e,t){const i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===t?i.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const e of this.symbolInstanceIndexes){const t=this.symbolInstances.get(e);this.featureSortOrder.push(t.featureIndex);const{rightJustifiedTextSymbolIndex:i,centerJustifiedTextSymbolIndex:r,leftJustifiedTextSymbolIndex:n,verticalPlacedTextSymbolIndex:o,placedIconSymbolIndex:s,verticalPlacedIconSymbolIndex:a}=t;i>=0&&this.addIndicesForPlacedSymbol(this.text,i),r>=0&&r!==i&&this.addIndicesForPlacedSymbol(this.text,r),n>=0&&n!==r&&n!==i&&this.addIndicesForPlacedSymbol(this.text,n),o>=0&&this.addIndicesForPlacedSymbol(this.text,o),s>=0&&this.addIndicesForPlacedSymbol(this.icon,s),a>=0&&this.addIndicesForPlacedSymbol(this.icon,a)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let tm,im,rm;ao(em,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),em.addDynamicAttributes=Zf;class nm{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Rt,this.defaultValue=e}evaluate(e){if(e.formattedSection){const t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}ao(nm,"FormatSectionOverride",{omit:["defaultValue"]});const om=()=>rm||(rm={layout:tm||(tm=new $o({"symbol-placement":new Go(qo.layout_symbol["symbol-placement"]),"symbol-spacing":new Go(qo.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Go(qo.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ho(qo.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Go(qo.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Go(qo.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new Go(qo.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new Go(qo.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Go(qo.layout_symbol["icon-ignore-placement"]),"icon-optional":new Go(qo.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Go(qo.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ho(qo.layout_symbol["icon-size"]),"icon-size-scale-range":new Go(qo.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new Ho(qo.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ho(qo.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ho(qo.layout_symbol["icon-image"]),"icon-rotate":new Ho(qo.layout_symbol["icon-rotate"]),"icon-padding":new Go(qo.layout_symbol["icon-padding"]),"icon-keep-upright":new Go(qo.layout_symbol["icon-keep-upright"]),"icon-offset":new Ho(qo.layout_symbol["icon-offset"]),"icon-anchor":new Ho(qo.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Go(qo.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Go(qo.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Go(qo.layout_symbol["text-rotation-alignment"]),"text-field":new Ho(qo.layout_symbol["text-field"]),"text-font":new Ho(qo.layout_symbol["text-font"]),"text-size":new Ho(qo.layout_symbol["text-size"]),"text-size-scale-range":new Go(qo.layout_symbol["text-size-scale-range"]),"text-max-width":new Ho(qo.layout_symbol["text-max-width"]),"text-line-height":new Ho(qo.layout_symbol["text-line-height"]),"text-letter-spacing":new Ho(qo.layout_symbol["text-letter-spacing"]),"text-justify":new Ho(qo.layout_symbol["text-justify"]),"text-radial-offset":new Ho(qo.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Go(qo.layout_symbol["text-variable-anchor"]),"text-anchor":new Ho(qo.layout_symbol["text-anchor"]),"text-max-angle":new Go(qo.layout_symbol["text-max-angle"]),"text-writing-mode":new Go(qo.layout_symbol["text-writing-mode"]),"text-rotate":new Ho(qo.layout_symbol["text-rotate"]),"text-padding":new Go(qo.layout_symbol["text-padding"]),"text-keep-upright":new Go(qo.layout_symbol["text-keep-upright"]),"text-transform":new Ho(qo.layout_symbol["text-transform"]),"text-offset":new Ho(qo.layout_symbol["text-offset"]),"text-allow-overlap":new Go(qo.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Go(qo.layout_symbol["text-ignore-placement"]),"text-optional":new Go(qo.layout_symbol["text-optional"]),visibility:new Go(qo.layout_symbol.visibility)})),paint:im||(im=new $o({"icon-opacity":new Ho(qo.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new Ho(qo.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new Ho(qo.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new Ho(qo.paint_symbol["text-emissive-strength"]),"icon-color":new Ho(qo.paint_symbol["icon-color"]),"icon-halo-color":new Ho(qo.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ho(qo.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ho(qo.paint_symbol["icon-halo-blur"]),"icon-translate":new Go(qo.paint_symbol["icon-translate"]),"icon-translate-anchor":new Go(qo.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Ho(qo.paint_symbol["icon-image-cross-fade"]),"text-opacity":new Ho(qo.paint_symbol["text-opacity"]),"text-occlusion-opacity":new Ho(qo.paint_symbol["text-occlusion-opacity"]),"text-color":new Ho(qo.paint_symbol["text-color"],{runtimeType:Bt,getOverride:e=>e.textColor,hasOverride:e=>!!e.textColor}),"text-halo-color":new Ho(qo.paint_symbol["text-halo-color"]),"text-halo-width":new Ho(qo.paint_symbol["text-halo-width"]),"text-halo-blur":new Ho(qo.paint_symbol["text-halo-blur"]),"text-translate":new Go(qo.paint_symbol["text-translate"]),"text-translate-anchor":new Go(qo.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Go(qo.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Go(qo.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Go(qo.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Go(qo.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new Ho(qo.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new Ho({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new Ho({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new Ho({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new Ho({type:"string",default:"default","property-type":"data-driven"})}))},rm);class sm extends ps{constructor(e,t,i,r){super(e,om(),t,i,r),this._colorAdjustmentMatrix=N.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=void 0!==e.paint&&("icon-occlusion-opacity"in e.paint||"text-occlusion-opacity"in e.paint)}recalculate(e,t){super.recalculate(e,t),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const i=this.layout.get("text-writing-mode");if(i){const e=[];for(const t of i)e.indexOf(t)<0&&e.push(t);this.layout._values["text-writing-mode"]=e}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(e,t,i,r){return this._saturation===e&&this._contrast===t&&this._brightnessMin===i&&this._brightnessMax===r||(this._colorAdjustmentMatrix=function(e,t,i,r){e=Te(e),t=Se(t);const n=N.mat4.create(),o=e/3,s=1-2*o,a=[s,o,o,0,o,s,o,0,o,o,s,0,0,0,0,1],l=.5-.5*t,c=r-i;return N.mat4.multiply(n,[c,0,0,0,0,c,0,0,0,0,c,0,i,i,i,1],[t,0,0,0,0,t,0,0,0,0,t,0,l,l,l,1]),N.mat4.multiply(n,n,a),n}(e,t,i,r),this._saturation=e,this._contrast=t,this._brightnessMin=i,this._brightnessMax=r),this._colorAdjustmentMatrix}getValueAndResolveTokens(e,t,i,r){const n=this.layout.get(e).evaluate(t,{},i,r),o=this._unevaluatedLayout._values[e];return o.isDataDriven()||Yn(o.value)||!n?n:function(e,t){return t.replace(/{([^{}]+)}/g,((t,i)=>i in e?String(e[i]):""))}(t.properties,n)}createBucket(e){return new em(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of om().paint.overridableProperties){if(!sm.hasPaintOverride(this.layout,e))continue;const t=this.paint.get(e),i=new nm(t),r=new Xn(i,t.property.specification,this.scope,this.options);let n=null;n="constant"===t.value.kind||"source"===t.value.kind?new Kn("source",r):new Jn("composite",r,t.value.zoomStops,t.value._interpolationType),this.paint._values[e]=new Vo(t.property,n,t.parameters)}}_handleOverridablePaintPropertyUpdate(e,t,i){return!(!this.layout||t.isDataDriven()||i.isDataDriven())&&sm.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,t){const i=e.get("text-field"),r=om().paint.properties[t];let n=!1;const o=e=>{for(const t of e)if(r.overrides&&r.overrides.hasOverride(t))return void(n=!0)};if("constant"===i.value.kind&&i.value.value instanceof Jt)o(i.value.value.sections);else if("source"===i.value.kind){const e=t=>{n||(t instanceof oi&&ri(t.value)===Ut?o(t.value.sections):t instanceof ci?o(t.sections):t.eachChild(e))},t=i.value;t._styleExpression&&e(t._styleExpression.expression)}return n}getProgramIds(){return["symbol"]}getDefaultProgramParams(e,t,i){return{config:new Na(this,{zoom:t,lut:i}),overrideFog:!1}}}let am,lm,cm,um;var hm=ys([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function dm(e){switch(e){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function pm(e){switch(e){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class fm{constructor(e,t,i,r){this.context=e,this.format=i,this.useMipmap=r&&r.useMipmap,this.texture=e.gl.createTexture(),this.update(t,{premultiply:r&&r.premultiply})}update(e,t){const i=e&&e instanceof HTMLVideoElement&&0===e.width?e.videoWidth:e.width,r=e&&e instanceof HTMLVideoElement&&0===e.height?e.videoHeight:e.height,{context:n}=this,{gl:o}=n,{x:s,y:a}=t&&t.position?t.position:{x:0,y:0},l=s+i,c=a+r;!this.size||this.size[0]===l&&this.size[1]===c||(o.bindTexture(o.TEXTURE_2D,null),o.deleteTexture(this.texture),this.texture=o.createTexture(),this.size=null),o.bindTexture(o.TEXTURE_2D,this.texture),n.pixelStoreUnpackFlipY.set(!1),n.pixelStoreUnpack.set(1),n.pixelStoreUnpackPremultiplyAlpha.set(this.format===o.RGBA8&&(!t||!1!==t.premultiply));const u=e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||ImageBitmap&&e instanceof ImageBitmap;if(!this.size&&l>0&&c>0){const e=this.useMipmap?Math.floor(Math.log2(Math.max(l,c)))+1:1;o.texStorage2D(o.TEXTURE_2D,e,this.format,l,c),this.size=[l,c]}if(this.size)if(u)o.texSubImage2D(o.TEXTURE_2D,0,s,a,dm(this.format),pm(this.format),e);else{const t=e.data;t&&o.texSubImage2D(o.TEXTURE_2D,0,s,a,i,r,dm(this.format),pm(this.format),t)}this.useMipmap&&o.generateMipmap(o.TEXTURE_2D)}bind(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{context:r}=this,{gl:n}=r;n.bindTexture(n.TEXTURE_2D,this.texture),e!==this.minFilter&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,this.useMipmap&&!i?e===n.NEAREST?n.NEAREST_MIPMAP_NEAREST:n.LINEAR_MIPMAP_LINEAR:e),this.minFilter=e),t!==this.wrapS&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,t),this.wrapS=t)}bindExtraParam(e,t,i,r){const{context:n}=this,{gl:o}=n;o.bindTexture(o.TEXTURE_2D,this.texture),t!==this.magFilter&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,t),this.magFilter=t),e!==this.minFilter&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,this.useMipmap?e===o.NEAREST?o.NEAREST_MIPMAP_NEAREST:o.LINEAR_MIPMAP_LINEAR:e),this.minFilter=e),i!==this.wrapS&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,i),this.wrapS=i),r!==this.wrapT&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,r),this.wrapT=r)}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class mm{constructor(e,t){this.context=e,this.texture=t}bind(e,t){const{context:i}=this,{gl:r}=i;r.bindTexture(r.TEXTURE_2D,this.texture),e!==this.minFilter&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,e),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,e),this.minFilter=e),t!==this.wrapS&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,t),this.wrapS=t)}}function gm(e,t,i,r,n,o,s,a){const l=[e,t,1,i,r,1,n,o,1],c=[s,a,1],u=N.mat3.adjoint([],l),[h,d,p]=N.vec3.transformMat3(c,c,u);return N.mat3.multiply(l,l,[h,0,0,0,d,0,0,0,p])}function ym(e,t,i,r,n,o,s,a){const l=function(e,t,i,r,n,o,s,a){const l=gm(0,0,1,0,1,1,0,1),c=gm(e,t,i,r,n,o,s,a),u=N.mat3.adjoint([],l);return N.mat3.multiply(c,c,u)}(e,t,i,r,n,o,s,a);return[l[2]/l[8]/Zi,l[5]/l[8]/Zi]}function _m(e){return[e[0],Math.min(Math.max(e[1],-ml),ml)]}class vm extends wt{constructor(e,t,i,r){super(),this.id=e,this.dispatcher=i,this.coordinates=t.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(r),this.options=t,this._dirty=!1}load(e,t){if(this._loaded=t||!1,this.fire(new _t("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return e&&(this.coordinates=e),this._loaded=!0,void this._finishLoading();this._imageRequest=ct(this.map._requestManager.transformRequest(this.url,et.Image),((t,i)=>{this._imageRequest=null,this._loaded=!0,t?this.fire(new vt(t)):i&&(this.image=i instanceof HTMLImageElement?ze.getImageData(i):i,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,e&&(this.coordinates=e),this._finishLoading())}))}loaded(){return this._loaded}updateImage(e){return e.url?(this._imageRequest&&e.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=e.url,this.load(e.coordinates,this._loaded),this):this}setTexture(e){if(!(e.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new mm(this.map.painter.context,e.handle),this.width=e.dimensions[0],this.height=e.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new _t("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(e){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof mm||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(e){if(this.coordinates=e,this._boundsArray=void 0,this._unsupportedCoords=!1,!e.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let t=e[0][1],i=e[0][1];for(const n of e)n[1]>i&&(i=n[1]),n[1]<t&&(t=n[1]);const r=(i+t)/2;if(r>ml?this.onNorthPole=!0:r<-ml&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const t=e.map(xl.fromLngLat);this.tileID=function(e){let t=1/0,i=1/0,r=-1/0,n=-1/0;for(const c of e)t=Math.min(t,c.x),i=Math.min(i,c.y),r=Math.max(r,c.x),n=Math.max(n,c.y);const o=Math.max(r-t,n-i),s=Math.max(0,Math.floor(-Math.log(o)/Math.LN2)),a=Math.pow(2,s);let l=Math.floor((t+r)/2*a);return l>1&&(l-=1),new ic(s,l,Math.floor((i+n)/2*a))}(t),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new _t("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(e){for(const g in this.tiles){const e=this.tiles[g];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const t=wf(new ic(0,0,0),this.map.transform.projection),i=[t.projection.project(this.coordinates[0][0],this.coordinates[0][1]),t.projection.project(this.coordinates[1][0],this.coordinates[1][1]),t.projection.project(this.coordinates[2][0],this.coordinates[2][1]),t.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(e){const t=e[1].x-e[0].x,i=e[1].y-e[0].y,r=e[2].x-e[1].x,n=e[2].y-e[1].y,o=e[3].x-e[2].x,s=e[3].y-e[2].y,a=e[0].x-e[3].x,l=e[0].y-e[3].y,c=t*n-r*i,u=r*s-o*n,h=o*l-a*s,d=a*i-t*l;return c>0&&u>0&&h>0&&d>0||c<0&&u<0&&h<0&&d<0}(i))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const r=wf(this.tileID,this.map.transform.projection),[n,o,s,a]=this.coordinates.map((e=>{const t=r.projection.project(e[0],e[1]);return Sf(r,t)._round()}));this.perspectiveTransform=ym(n.x,n.y,o.x,o.y,s.x,s.y,a.x,a.y);const l=this._boundsArray=new bs;l.emplaceBack(n.x,n.y,0,0),l.emplaceBack(o.x,o.y,Zi,0),l.emplaceBack(a.x,a.y,0,Zi),l.emplaceBack(s.x,s.y,Zi,Zi),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=e.createVertexBuffer(l,hm.members),this.boundsSegments=pa.simpleSegment(0,0,4,2);const c=[],u=[_m((h=this.coordinates)[0]),_m(h[1]),_m(h[2]),_m(h[3])];var h;const[d,p,f,m]=function(e){let t=e[0][0],i=t,r=e[0][1],n=r;for(let o=1;o<e.length;o++)e[o][0]<t?t=e[o][0]:e[o][0]>i&&(i=e[o][0]),e[o][1]<r?r=e[o][1]:e[o][1]>n&&(n=e[o][1]);return[t,r,i-t,n-r]}(u);{const r=new bs,[n,o,s,a]=function(e){let t=e[0].x,i=t,r=e[0].y,n=r;for(let o=1;o<e.length;o++)e[o].x<t?t=e[o].x:e[o].x>i&&(i=e[o].x),e[o].y<r?r=e[o].y:e[o].y>n&&(n=e[o].y);return[t,r,i-t,n-r]}(i),l=e=>[(e.x-n)/s,(e.y-o)/a],[u,h,g,y]=i.map(l),_=function(e,t,i,r,n,o,s,a){const l=gm(0,0,1,0,1,1,0,1),c=gm(e,t,i,r,n,o,s,a),u=N.mat3.adjoint([],c);return N.mat3.multiply(l,l,u)}(u[0],u[1],h[0],h[1],g[0],g[1],y[0],y[1]);this.elevatedGlobePerspectiveTransform=ym(u[0],u[1],h[0],h[1],g[0],g[1],y[0],y[1]);const v=(e,t)=>{c.push(e.lng);const i=Math.round((e.lng-d)/f*Zi),n=Math.round((e.lat-p)/m*Zi),o=l(t),s=N.vec3.transformMat3([],[o[0],o[1],1],_),a=Math.round(s[0]/s[2]*Zi),u=Math.round(s[1]/s[2]*Zi);r.emplaceBack(i,n,a,u)},x=i[3].x-i[0].x,b=i[3].y-i[0].y,w=i[2].x-i[1].x,S=i[2].y-i[1].y;for(let e=0;e<65;e++){const r=e/64,n=[i[0].x+r*x,i[0].y+r*b],o=[i[1].x+r*w,i[1].y+r*S],s=o[0]-n[0],a=o[1]-n[1];for(let e=0;e<65;e++){const i=e/64,r={x:n[0]+s*i,y:n[1]+a*i,z:0};v(t.projection.unproject(r.x,r.y),r)}}this.elevatedGlobeVertexBuffer=e.createVertexBuffer(r,hm.members)}{this.maxLongitudeTriangleSize=0;let t=[],i=new Fs;const r=(e,r,n)=>{i.emplaceBack(e,r,n);const o=c[e],s=c[r],a=c[n],l=Math.min(Math.min(o,s),a),u=Math.max(Math.max(o,s),a)-l;u>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=u),t.push(l+u/2)};for(let e=0;e<64;e++)for(let t=0;t<64;t++){const i=65*e+t,n=i+1,o=i+65,s=o+1;r(i,o,n),r(n,o,s)}[t,i]=function(e,t){const i=Array.from({length:e.length},((e,t)=>t));i.sort(((t,i)=>e[t]-e[i]));const r=[],n=new Fs;for(let o=0;o<i.length;o++){const s=i[o];r.push(e[s]);const a=3*s,l=a+1;n.emplaceBack(t.uint16[a],t.uint16[l],t.uint16[l+1])}return[r,n]}(t,i),this.elevatedGlobeTrianglesCenterLongitudes=t,this.elevatedGlobeIndexBuffer=e.createIndexBuffer(i)}this.elevatedGlobeSegments=pa.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,f/Zi,0,m/Zi,0,0,p,d,0])}prepare(){const e=0!==Object.keys(this.tiles).length;if(this.tileID&&!e)return;const t=this.map.painter.context,i=t.gl;!this._dirty||this.texture instanceof mm||(this.texture?this.texture.update(this.image):(this.texture=new fm(t,this.image,i.RGBA8),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE)),this._dirty=!1),e&&this._prepareData(t)}loadTile(e,t){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={},t(null)):(e.state="errored",t(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(e){const t=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!t)return null;const i=this.elevatedGlobeTrianglesCenterLongitudes;let r=(n=e+180)+360*Math.round((i[0]-n)/360);var n;const o=new pa,s=(e,i)=>{o.segments.push({vertexOffset:0,primitiveOffset:e,vertexLength:t.segments[0].vertexLength,primitiveLength:i,sortKey:void 0,vaos:{}})},a=.51*this.maxLongitudeTriangleSize;if(Math.abs(i[0]-r)<=a){const e=we(i,0,i.length,r+a);return e===i.length||s(e,be(i,e+1,i.length,r+360-a)-e),o}r<i[0]&&(r+=360);const l=be(i,0,i.length,r-a);if(l===i.length)return s(0,i.length),o;s(0,l-0);const c=we(i,l+1,i.length,r+a);return c!==i.length&&s(c,i.length-c),o}}const xm=(Math.pow(256,2)-1)/16907520;class bm extends ps{constructor(e,t,i,r){super(e,{layout:cm||(cm=new $o({visibility:new Go(qo.layout_raster.visibility)})),paint:um||(um=new $o({"raster-opacity":new Go(qo.paint_raster["raster-opacity"]),"raster-color":new Wo(qo.paint_raster["raster-color"]),"raster-color-mix":new Go(qo.paint_raster["raster-color-mix"]),"raster-color-range":new Go(qo.paint_raster["raster-color-range"]),"raster-hue-rotate":new Go(qo.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Go(qo.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Go(qo.paint_raster["raster-brightness-max"]),"raster-saturation":new Go(qo.paint_raster["raster-saturation"]),"raster-contrast":new Go(qo.paint_raster["raster-contrast"]),"raster-resampling":new Go(qo.paint_raster["raster-resampling"]),"raster-fade-duration":new Go(qo.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Go(qo.paint_raster["raster-emissive-strength"]),"raster-array-band":new Go(qo.paint_raster["raster-array-band"]),"raster-elevation":new Go(qo.paint_raster["raster-elevation"]),"raster-color-use-theme":new Ho({type:"string",default:"default","property-type":"data-driven"})}))},t,i,r),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(e){return!(e&&e._source instanceof vm&&(e._source.onNorthPole||e._source.onSouthPole))&&0===this.paint.get("raster-elevation")}_handleSpecialPaintPropertyUpdate(e){"raster-color"!==e&&"raster-color-range"!==e||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(e){if(!this.hasColorMap())return;if(!this._curRampRange)return;const t=this._transitionablePaint._values["raster-color"].value.expression,[i,r]=e||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(i)&&isNaN(r)||i===this._curRampRange[0]&&r===this._curRampRange[1]||(this.colorRamp=lu({expression:t,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:i,end:r}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[i,r])}}let wm,Sm,Tm,Mm,Am;class Cm extends ps{constructor(e,t,i,r){super(e,{layout:wm||(wm=new $o({visibility:new Go(qo["layout_raster-particle"].visibility)})),paint:Sm||(Sm=new $o({"raster-particle-array-band":new Go(qo["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Go(qo["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new Wo(qo["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Go(qo["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Go(qo["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Go(qo["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Go(qo["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new Go(qo["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new Ho({type:"string",default:"default","property-type":"data-driven"})}))},t,i,r),this._updateColorRamp(),this.lastInvalidatedAt=ze.now()}onRemove(e){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return"none"!==this.visibility}isDraped(e){return!1}_handleSpecialPaintPropertyUpdate(e){"raster-particle-color"!==e&&"raster-particle-max-speed"!==e||(this._updateColorRamp(),this._invalidateAnimationState()),"raster-particle-count"===e&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const e=this._transitionablePaint._values["raster-particle-color"].value.expression,t=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=lu({expression:e,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:t}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=ze.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class Em extends ps{constructor(e,t){super(e,{},t,null),this.implementation=e,e.slot&&(this.slot=e.slot)}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isDraped(e){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}function Pm(e,t,i){const r=[0,0,1],n=N.quat.identity([]);return N.quat.rotateY(n,n,i?-q(e)+Math.PI:q(e)),N.quat.rotateX(n,n,-q(t)),N.vec3.transformQuat(r,r,n),N.vec3.normalize(r,r)}function km(e,t){const i=Dm(e.projection,e.zoom,e.width,e.height),r=function(e,t,i,r,n){const o=new nl(i.lng-180*Lm,i.lat),s=new nl(i.lng+180*Lm,i.lat),a=e.project(o.lng,o.lat),l=e.project(s.lng,s.lat),c=-Math.atan2(l.y-a.y,l.x-a.x),u=xl.fromLngLat(i);u.y=Q(u.y,-1+Lm,1-Lm);const h=u.toLngLat(),d=e.project(h.lng,h.lat),p=xl.fromLngLat(h);p.x+=Lm;const f=p.toLngLat(),m=e.project(f.lng,f.lat),g=zm(m.x-d.x,m.y-d.y,c),y=xl.fromLngLat(h);y.y+=Lm;const _=y.toLngLat(),v=e.project(_.lng,_.lat),x=zm(v.x-d.x,v.y-d.y,c),b=Math.abs(g.x)/Math.abs(x.y),w=N.mat4.identity([]);N.mat4.rotateZ(w,w,-c*(1-(n?0:r)));const S=N.mat4.identity([]);return N.mat4.scale(S,S,[1,1-(1-b)*r,1]),S[4]=-x.x/x.y*r,N.mat4.rotateZ(S,S,c),N.mat4.multiply(S,w,S),S}(e.projection,0,e.center,i,t),n=Im(e);return N.mat4.scale(r,r,[n,n,1]),r}function Im(e){const t=e.projection,i=Dm(e.projection,e.zoom,e.width,e.height),r=Rm(t,e.center),n=Rm(t,nl.convert(t.center));return Math.pow(2,r*i+(1-i)*n)}function Dm(e,t,i,r){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0;const o=e.range;if(!o)return 0;const s=Math.min(n,Math.max(i,r)),a=Math.log(s/1024)/Math.LN2;return ee(o[0]+a,o[1]+a,t)}const Lm=1/4e4;function Rm(e,t){const i=Q(t.lat,-ml,ml),r=new nl(t.lng-180*Lm,i),n=new nl(t.lng+180*Lm,i),o=e.project(r.lng,i),s=e.project(n.lng,i),a=xl.fromLngLat(r),l=xl.fromLngLat(n),c=s.x-o.x,u=s.y-o.y,h=l.x-a.x,d=l.y-a.y,p=Math.sqrt((h*h+d*d)/(c*c+u*u));return Math.log(p)/Math.LN2}function zm(e,t,i){const r=Math.cos(i),n=Math.sin(i);return{x:e*r-t*n,y:e*n+t*r}}function Om(e,t,i){N.mat4.identity(e),N.mat4.rotateZ(e,e,q(t[2])),N.mat4.rotateX(e,e,q(t[0])),N.mat4.rotateY(e,e,q(t[1])),N.mat4.scale(e,e,i),N.mat4.multiply(e,e,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function Fm(e,t,i,r,n,o,s,a){const l=[i[0]-t[0],i[1]-t[1],0],c=[r[0]-t[0],r[1]-t[1],0];if(N.vec3.length(l)<1e-12||N.vec3.length(c)<1e-12)return N.quat.identity(e);const u=N.vec3.cross([],l,c);N.vec3.normalize(u,u),N.vec3.subtract(c,r,t),l[2]=(o-n)*a,c[2]=(s-n)*a;const h=l;return N.vec3.cross(h,l,c),N.vec3.normalize(h,h),N.quat.rotationTo(e,u,h)}function Bm(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=Bc(t.zoom),n=function(e,t,i){const r=t.worldSize,n=[e[12],e[13],e[14]],o=pl(n[1]/r),s=dl(n[0]/r),a=N.mat4.identity([]),l=hl(1,o)*r,c=hl(1,0)*r*yl(o,t.zoom),u=1/zc(r);let h=c*u;if(i){const e=Dm(t.projection,t.zoom,t.width,t.height,1024);h=u*t.projection.pixelSpaceConversion(t.center.lat,r,e)}const d=tl(o,s);N.vec3.add(d,d,N.vec3.scale([],N.vec3.normalize([],d),l*h*n[2]));const p=function(e){const t=[e[0],e[1],e[2]];let i=[0,1,0];const r=N.vec3.cross([],i,t);return N.vec3.cross(i,t,r),0===N.vec3.squaredLength(i)&&(i=[0,1,0],N.vec3.cross(r,t,i)),N.vec3.normalize(r,r),N.vec3.normalize(i,i),N.vec3.normalize(t,t),[r[0],r[1],r[2],0,i[0],i[1],i[2],0,t[0],t[1],t[2],0,e[0],e[1],e[2],1]}(d);N.mat4.scale(a,a,[h,h,h*l]),N.mat4.translate(a,a,[-n[0],-n[1],-n[2]]);const f=N.mat4.multiply([],t.globeMatrix,p);return N.mat4.multiply(f,f,a),N.mat4.multiply(f,f,e),f}(e,t,i);if(r>0){const i=function(e,t){const i=t.worldSize,r=hl(1,0)*i*yl(t.center.lat,t.zoom)/zc(i),n=hl(1,t.center.lat)*i,o=N.mat4.identity([]);return N.mat4.rotateY(o,o,q(t.center.lng)),N.mat4.rotateX(o,o,q(t.center.lat)),N.mat4.translate(o,o,[0,0,$a]),N.mat4.scale(o,o,[r,r,r*n]),N.mat4.translate(o,o,[t.point.x-.5*i,t.point.y-.5*i,0]),N.mat4.multiply(o,o,e),N.mat4.multiply(o,t.globeMatrix,o)}(e,t);return function(e,t,i){const r=(e,t,i)=>{const r=N.vec3.length(e),n=N.vec3.length(t),o=Mc(e,t,i);return N.vec3.scale(o,o,1/N.vec3.length(o)*Et(r,n,i))},n=r([e[0],e[1],e[2]],[t[0],t[1],t[2]],i),o=r([e[4],e[5],e[6]],[t[4],t[5],t[6]],i),s=r([e[8],e[9],e[10]],[t[8],t[9],t[10]],i),a=Mc([e[12],e[13],e[14]],[t[12],t[13],t[14]],i);return[n[0],n[1],n[2],0,o[0],o[1],o[2],0,s[0],s[1],s[2],0,a[0],a[1],a[2],1]}(n,i,r)}return n}function Nm(e,t,i,r){const n=_c.projectAabbCorners(r,i);let o=Number.MAX_VALUE,s=-1;for(let c=0;c<n.length;++c){const e=n[c];e[0]=(.5*e[0]+.5)*t.width,e[1]=(.5-.5*e[1])*t.height,e[2]<o&&(s=c,o=e[2])}const a=e=>new G(n[e][0],n[e][1]);let l;switch(s){case 0:case 6:l=[a(1),a(5),a(4),a(7),a(3),a(2),a(1)];break;case 1:case 7:l=[a(0),a(4),a(5),a(6),a(2),a(3),a(0)];break;case 3:case 5:l=[a(1),a(0),a(4),a(7),a(6),a(2),a(1)];break;default:l=[a(1),a(5),a(6),a(7),a(3),a(0),a(1)]}if(Ll(e,l))return o}const jm=ys([{name:"a_pos_3f",components:3,type:"Float32"}]),Vm=ys([{name:"a_color_3f",components:3,type:"Float32"}]),Um=ys([{name:"a_color_4f",components:4,type:"Float32"}]),Gm=ys([{name:"a_uv_2f",components:2,type:"Float32"}]),Hm=ys([{name:"a_normal_3f",components:3,type:"Float32"}]),Wm=ys([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),$m=ys([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),qm={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class Xm{constructor(e,t,i,r){this.message=(e?`${e}: `:"")+i,r&&(this.identifier=r),null!=t&&t.__line__&&(this.line=t.__line__)}}function Ym(e,t){const i=-1===e.indexOf("://");try{return new URL(e,i&&t?"http://example.com":void 0),!0}catch(e){return!1}}class Zm{constructor(e,t){this.feature=e,this.instancedDataOffset=t,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class Km{constructor(){this.instancedDataArray=new Xs,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class Jm{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.fqid)),this.projection=e.projection,this.index=e.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(e,t){}populate(e,t,i,r){this.tileToMeter=vl(i);const n=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:o,id:s,index:a,sourceLayerIndex:l}of e){const e=null!=s?s:o.properties&&o.properties.hasOwnProperty("id")?o.properties.id:void 0,c=Pl(o,n);if(!this.layers[0]._featureFilter.filter(new Ro(this.zoom),c,i))continue;const u={id:e,sourceLayerIndex:l,index:a,geometry:n?c.geometry:El(o,i,r),properties:o.properties,type:o.type,patterns:{}},h=this.addFeature(u,u.geometry,c);h&&t.featureIndex.insert(o,u.geometry,a,l,this.index,this.instancesPerModel[h].instancedDataArray.length,Zi/32)}this.lookup=null}update(e,t,i,r){for(const n in this.instancesPerModel){const t=this.instancesPerModel[n];for(const i in e)t.idToFeaturesIndex.hasOwnProperty(i)&&(this.evaluate(t.features[t.idToFeaturesIndex[i]],e[i],t,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let e=!1;for(const t in this.instancesPerModel){const i=this.instancesPerModel[t];for(const t of i.features){const r=this.layers[0],n=t.feature,o=this.canonical,s=r.paint.get("model-rotation").evaluate(n,{},o),a=r.paint.get("model-scale").evaluate(n,{},o),l=r.paint.get("model-translation").evaluate(n,{},o);N.vec3.exactEquals(t.rotation,s)&&N.vec3.exactEquals(t.scale,a)&&N.vec3.exactEquals(t.translation,l)||(this.evaluate(t,t.featureStates,i,!0),e=!0)}}return e}updateReplacement(e,t,i,r){if(t.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=t.updateTime;const n=t.getReplacementRegionsForTile(e.toUnwrapped(),!0);if(Th(this.activeReplacements,n))return!1;this.activeReplacements=n;let o=!1;for(const s in this.instancesPerModel){const t=this.instancesPerModel[s],n=t.instancedDataArray;for(const s of t.features){const t=s.instancedDataOffset,a=s.instancedDataCount;for(let s=0;s<a;s++){const a=16*(s+t);let l=n.float32[a+0];const c=l>Zi;l=c?l-Zi:l;const u=Math.floor(l),h=n.float32[a+1];let d=!1;for(const t of this.activeReplacements)if(!xh(t,i,qm.Model,r)&&!(t.min.x>u||u>t.max.x||t.min.y>h||h>t.max.y)&&(d=kh(Ph(u,h,e.canonical,t.footprintTileId.canonical),t.footprint),d))break;n.float32[a]=d?l+Zi:l,o=o||d!==c}}}return o}isEmpty(){for(const e in this.instancesPerModel)if(0!==this.instancesPerModel[e].instancedDataArray.length)return!1;return!0}uploadPending(){return!this.uploaded}upload(e){if(!this.uploaded)for(const t in this.instancesPerModel){const i=this.instancesPerModel[t];i.instancedDataArray.length<0||0===i.instancedDataArray.length||(i.instancedDataBuffer?i.instancedDataBuffer.updateData(i.instancedDataArray):i.instancedDataBuffer=e.createVertexBuffer(i.instancedDataArray,Wm.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const t in this.instancesPerModel){const e=this.instancesPerModel[t];0!==e.instancedDataArray.length&&e.instancedDataBuffer&&e.instancedDataBuffer.destroy()}const e=this.layers[0].modelManager;if(e&&this.modelUris)for(const t of this.modelUris)e.removeModel(t,"")}addFeature(e,t,i){const r=this.layers[0],n=r.layout.get("model-id").evaluate(i,{},this.canonical);if(!n)return pe(`modelId is not evaluated for layer ${r.id} and it is not going to get rendered.`),n;Ym(n,!1)&&(this.modelUris.includes(n)||this.modelUris.push(n)),this.instancesPerModel[n]||(this.instancesPerModel[n]=new Km);const o=this.instancesPerModel[n],s=o.instancedDataArray,a=new Zm(i,s.length);for(const l of t)for(const e of l){if(e.x<0||e.x>=Zi||e.y<0||e.y>=Zi)continue;const t=(this.lookupDim-1)/Zi,i=this.lookupDim*(e.y*t|0)+e.x*t|0;if(this.lookup){if(0!==this.lookup[i])continue;this.lookup[i]=1}this.instanceCount++;const r=s.length;s.resize(r+1),o.instancesEvaluatedElevation.push(0),s.float32[16*r]=e.x,s.float32[16*r+1]=e.y}return a.instancedDataCount=o.instancedDataArray.length-a.instancedDataOffset,a.instancedDataCount>0&&(e.id&&(o.idToFeaturesIndex[e.id]=o.features.length),o.features.push(a),this.evaluate(a,{},o,!1)),n}getModelUris(){return this.modelUris}evaluate(e,t,i,r){const n=this.layers[0],o=e.feature,s=this.canonical,a=e.rotation=n.paint.get("model-rotation").evaluate(o,t,s),l=e.scale=n.paint.get("model-scale").evaluate(o,t,s),c=e.translation=n.paint.get("model-translation").evaluate(o,t,s),u=n.paint.get("model-color").evaluate(o,t,s);u.a=n.paint.get("model-color-mix-intensity").evaluate(o,t,s);const h=[];this.maxVerticalOffset<c[2]&&(this.maxVerticalOffset=c[2]),this.maxScale=Math.max(Math.max(this.maxScale,l[0]),Math.max(l[1],l[2])),Om(h,a,l);const d=Math.round(100*u.a)+u.b/1.05;for(let p=0;p<e.instancedDataCount;++p){const t=e.instancedDataOffset+p,n=16*t,o=i.instancedDataArray.float32;let a=0;r&&(a=o[n+6]-i.instancesEvaluatedElevation[t]);const l=0|o[n+1];o[n]=(0|o[n])+u.r/1.05,o[n+1]=l+u.g/1.05,o[n+2]=d,o[n+3]=1/(s.z>10?this.tileToMeter:vl(s,l)),o[n+4]=c[0],o[n+5]=c[1],o[n+6]=c[2]+a,o[n+7]=h[0],o[n+8]=h[1],o[n+9]=h[2],o[n+10]=h[4],o[n+11]=h[5],o[n+12]=h[6],o[n+13]=h[8],o[n+14]=h[9],o[n+15]=h[10],i.instancesEvaluatedElevation[t]=c[2]}}}let Qm,eg;ao(Jm,"ModelBucket",{omit:["layers"]}),ao(Km,"PerModelAttributes"),ao(Zm,"ModelFeature");const tg=64,ig={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function rg(e,t,i,r,n,o,s,a,l){let c=arguments.length>9&&void 0!==arguments[9]&&arguments[9];const u=i.zoom,h=i.project(r),d=yl(r.lat,u),p=1/d;N.mat4.identity(e),N.mat4.translate(e,e,[h.x+s[0]*p,h.y+s[1]*p,s[2]]);let f=1,m=1;const g=i.worldSize;if(c){if("mercator"===i.projection.name){let e=0;i.elevation&&(e=i.elevation.getAtPointOrZero(new xl(h.x/g,h.y/g),0));const t=N.vec4.transformMat4([],[h.x,h.y,e,1],i.projMatrix)[3]/i.cameraToCenterDistance;f=t,m=t*yl(i.center.lat,u)}else if("globe"===i.projection.name){const t=Bm(e,i),n=N.mat4.multiply([],i.projMatrix,t),o=[0,0,0,1];N.vec4.transformMat4(o,o,n);const s=o[3]/i.cameraToCenterDistance,a=Bc(u),l=i.projection.pixelsPerMeter(r.lat,g)*yl(r.lat,u),c=i.projection.pixelsPerMeter(i.center.lat,g)*yl(i.center.lat,u);f=s/Et(l,gl(i.center.lat),a),m=s*d/l,f*=c,m*=c}}else f=p;N.mat4.scale(e,e,[f,f,m]);const y=[...e],_=t.orientation,v=[];if(Om(v,[_[0]+n[0],_[1]+n[1],_[2]+n[2]],o),N.mat4.multiply(e,y,v),a&&i.elevation){let n=0;const o=[];if(l&&i.elevation){n=function(e,t,i,r,n){const o=t.elevation;if(!o)return 0;const s=_c.projectAabbCorners(i,r),a=hl(1,n.lat)*t.worldSize,l=function(e,t){const i=[0,0,1],r=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const n of r){const r=e[n.corners[0]],o=e[n.corners[1]],s=e[n.corners[2]],a=[o[0]-r[0],o[1]-r[1],t*(o[2]-r[2])],l=N.vec3.cross(a,a,[s[0]-r[0],s[1]-r[1],t*(s[2]-r[2])]);N.vec3.normalize(l,l),n.dotProductWithUp=N.vec3.dot(l,i)}return r.sort(((e,t)=>e.dotProductWithUp-t.dotProductWithUp)),r[0].corners}(s,a),c=s[l[0]],u=s[l[1]],h=s[l[2]],d=s[l[3]],p=o.getAtPointOrZero(new xl(c[0]/t.worldSize,c[1]/t.worldSize),0),f=o.getAtPointOrZero(new xl(u[0]/t.worldSize,u[1]/t.worldSize),0),m=o.getAtPointOrZero(new xl(h[0]/t.worldSize,h[1]/t.worldSize),0),g=o.getAtPointOrZero(new xl(d[0]/t.worldSize,d[1]/t.worldSize),0),y=(p+g)/2,_=(f+m)/2;return y>_?f<m?Fm(e,u,d,c,f,g,p,a):Fm(e,h,c,d,m,p,g,a):p<g?Fm(e,c,u,h,p,f,m,a):Fm(e,d,h,u,g,m,f,a),Math.max(y,_)}(o,i,t.aabb,e,r);const s=N.mat4.fromQuat([],o),a=N.mat4.multiply([],s,v);N.mat4.multiply(e,y,a)}else n=i.elevation.getAtPointOrZero(new xl(h.x/g,h.y/g),0);0!==n&&(e[14]+=n)}}function ng(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e.uploaded||(e.gfxTexture=new fm(t,e.image,i?t.gl.R8:t.gl.RGBA8,{useMipmap:e.sampler.minFilter>=t.gl.NEAREST_MIPMAP_NEAREST}),e.uploaded=!0,e.image=null)}function og(e,t,i){e.indexBuffer=t.createIndexBuffer(e.indexArray,!1,!0),e.vertexBuffer=t.createVertexBuffer(e.vertexArray,jm.members,!1,!0),e.normalArray&&(e.normalBuffer=t.createVertexBuffer(e.normalArray,Hm.members,!1,!0)),e.texcoordArray&&(e.texcoordBuffer=t.createVertexBuffer(e.texcoordArray,Gm.members,!1,!0)),e.colorArray&&(e.colorBuffer=t.createVertexBuffer(e.colorArray,(12===e.colorArray.bytesPerElement?Vm:Um).members,!1,!0)),e.featureArray&&(e.pbrBuffer=t.createVertexBuffer(e.featureArray,$m.members,!0)),e.segments=pa.simpleSegment(0,0,e.vertexArray.length,e.indexArray.length);const r=e.material;r.pbrMetallicRoughness.baseColorTexture&&ng(r.pbrMetallicRoughness.baseColorTexture,t),r.pbrMetallicRoughness.metallicRoughnessTexture&&ng(r.pbrMetallicRoughness.metallicRoughnessTexture,t),r.normalTexture&&ng(r.normalTexture,t),r.occlusionTexture&&ng(r.occlusionTexture,t,i),r.emissionTexture&&ng(r.emissionTexture,t)}function sg(e,t,i){if(e.meshes)for(const r of e.meshes)og(r,t,i);if(e.children)for(const r of e.children)sg(r,t,i)}function ag(e){if(e.meshes)for(const t of e.meshes)t.indexArray.destroy(),t.vertexArray.destroy(),t.colorArray&&t.colorArray.destroy(),t.normalArray&&t.normalArray.destroy(),t.texcoordArray&&t.texcoordArray.destroy(),t.featureArray&&t.featureArray.destroy();if(e.children)for(const t of e.children)ag(t)}function lg(e){if(e.meshes)for(const i of e.meshes)i.vertexBuffer&&(i.vertexBuffer.destroy(),i.indexBuffer.destroy(),i.normalBuffer&&i.normalBuffer.destroy(),i.texcoordBuffer&&i.texcoordBuffer.destroy(),i.colorBuffer&&i.colorBuffer.destroy(),i.pbrBuffer&&i.pbrBuffer.destroy(),i.segments.destroy(),i.material&&((t=i.material).pbrMetallicRoughness.baseColorTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),t.pbrMetallicRoughness.metallicRoughnessTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),t.normalTexture&&t.normalTexture.gfxTexture&&t.normalTexture.gfxTexture.destroy(),t.emissionTexture&&t.emissionTexture.gfxTexture&&t.emissionTexture.gfxTexture.destroy(),t.occlusionTexture&&t.occlusionTexture.gfxTexture&&t.occlusionTexture.gfxTexture.destroy()));var t;if(e.children)for(const i of e.children)lg(i)}class cg{constructor(e,t,i){this._demTile=e,this._dem=this._demTile.dem,this._scale=t,this._offset=i}static create(e,t,i){const r=i||e.findDEMTileFor(t);if(!r||!r.dem)return;const n=r.dem,o=r.tileID,s=1<<t.canonical.z-o.canonical.z;return new cg(r,n.dim/Zi/s,[(t.canonical.x/s-o.canonical.x)*n.dim,(t.canonical.y/s-o.canonical.y)*n.dim])}tileCoordToPixel(e,t){const i=t*this._scale+this._offset[1],r=Math.floor(e*this._scale+this._offset[0]),n=Math.floor(i);return new G(r,n)}getElevationAt(e,t,i,r){const n=e*this._scale+this._offset[0],o=t*this._scale+this._offset[1],s=Math.floor(n),a=Math.floor(o),l=this._dem;return r=!!r,i?Et(Et(l.get(s,a,r),l.get(s,a+1,r),o-a),Et(l.get(s+1,a,r),l.get(s+1,a+1,r),o-a),n-s):l.get(s,a,r)}getElevationAtPixel(e,t,i){return this._dem.get(e,t,!!i)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*hl(1,e)*this._dem.stride}}const ug=new Float32Array(262144),hg=new Uint8Array(262144);function dg(e){let t=0;if(e.meshes)for(const i of e.meshes)t=Math.max(t,i.aabb.max[2]);if(e.children)for(const i of e.children)t=Math.max(t,dg(i));return t}function pg(e,t,i){if(e.meshes)for(const r of e.meshes){if(r.aabb.min[0]===1/0)continue;const n=_c.applyTransform(r.aabb,e.matrix);i.insert(t,n.min[0],n.min[1],n.max[0],n.max[1])}if(e.children)for(const r of e.children)pg(r,t,i)}const fg=["","wall","door","roof","window","lamp","logo"];class mg{constructor(e){this.node=e,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:e.id,geometry:[],properties:{height:dg(e)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new _c([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let e=0;const t=new _c([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const i of this.node.meshes)this.node.lightMeshIndex!==e&&(i.transformedAabb=_c.applyTransformFast(i.aabb,this.node.matrix),t.encapsulate(i.transformedAabb)),e++;this.aabb=t}return this.aabb}}class gg{constructor(e,t,i,r,n,o,s){this.id=i,this.layers=e,this.layerIds=this.layers.map((e=>e.fqid)),this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.modelTraits|=ig.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,r&&(this.modelTraits|=ig.HasMapboxMeshFeatures),n&&(this.modelTraits|=ig.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=o,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const a of t)this.nodesInfo.push(new mg(a)),pg(a,s.featureIndexArray.length,s.grid),s.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,s.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(e,t){for(const i of this.getNodesInfo()){const r=i.node;r.footprint&&t.push({footprint:r.footprint,id:e})}}update(e){const t=0!==Object.keys(e).length;if(t&&!this.stateDependentLayers.length)return;const i=t?this.stateDependentLayers:this.layers;if(!H(e,this.states))for(const r of i)this.evaluate(r,e);this.states=structuredClone(e)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(e){if(!this.needsUpload)return;const t=this.getNodesInfo();for(const i of t){const t=i.node;this.uploaded?this.updatePbrBuffer(t):sg(t,e,!0)}for(const i of t)ag(i.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(e){let t=!1;if(!e.meshes)return t;for(const i of e.meshes)i.pbrBuffer&&(i.pbrBuffer.updateData(i.featureArray),t=!0);return t}needsReEvaluation(e,t,i){const r=e.transform.projectionOptions,n=e.style.getBrightness(),o=this.brightness!==n;if(!this.uploaded||this.dirty||r.name!==this.projection.name||yg(i.paint.get("model-color").value,o)||yg(i.paint.get("model-color-mix-intensity").value,o)||yg(i.paint.get("model-roughness").value,o)||yg(i.paint.get("model-emissive-strength").value,o)||yg(i.paint.get("model-height-based-emissive-strength-multiplier").value,o)){this.projection=r,this.brightness=n;const e=this.getNodesInfo();for(const t of e)t.state=null;return!0}return!1}evaluateScale(e,t){if(e.transform.zoom===this.zoom)return;this.zoom=e.transform.zoom;const i=this.getNodesInfo(),r=this.id.canonical;for(const n of i){const e=n.feature;n.evaluatedScale=t.paint.get("model-scale").evaluate(e,{},r)}}evaluate(e,t){const i=this.getNodesInfo();for(const r of i){if(!r.node.meshes)continue;const i=r.feature,n=t&&t[i.id];if(H(n,r.state))continue;r.state=structuredClone(n);const o=r.node.meshes&&r.node.meshes[0].featureData,s=r.evaluatedColor[2],a=r.evaluatedRMEA[2],l=this.id.canonical;if(r.hasTranslucentParts=!1,o){for(let t=0;t<fg.length;t++){const o=fg[t];o.length&&(i.properties.part=o);const s=e.paint.get("model-color").evaluate(i,n,l).toRenderColor(null),a=e.paint.get("model-color-mix-intensity").evaluate(i,n,l);r.evaluatedColor[t]=[s.r,s.g,s.b,a],r.evaluatedRMEA[t][0]=e.paint.get("model-roughness").evaluate(i,n,l),r.evaluatedRMEA[t][2]=e.paint.get("model-emissive-strength").evaluate(i,n,l),r.evaluatedRMEA[t][3]=s.a,r.emissionHeightBasedParams[t]=e.paint.get("model-height-based-emissive-strength-multiplier").evaluate(i,n,l),!r.hasTranslucentParts&&s.a<1&&(r.hasTranslucentParts=!0)}delete i.properties.part,vg(r,s!==r.evaluatedColor[2]||a!==r.evaluatedRMEA[2],this.modelTraits)}else r.evaluatedRMEA[0][2]=e.paint.get("model-emissive-strength").evaluate(i,n,l);r.evaluatedScale=e.paint.get("model-scale").evaluate(i,n,l),this.updatePbrBuffer(r.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(e,t,i,r){const n=e.findDEMTileFor(i);if(n&&(n.tileID.canonical!==this.terrainTile||t!==this.terrainExaggeration)){if(n.dem&&n.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=n.tileID.overscaledZ;const t=cg.create(e,i,n);if(!t)return;this.modelTraits&ig.HasMapboxMeshFeatures&&this.updateDEM(e,t,i,r);for(const e of this.getNodesInfo()){const i=e.node;if(!i.footprint||!i.footprint.vertices||!i.footprint.vertices.length)continue;const r=i.footprint.vertices;let n=t.getElevationAt(r[0].x,r[0].y,!0,!0);for(let e=1;e<r.length;e++)n=Math.min(n,t.getElevationAt(r[e].x,r[e].y,!0,!0));i.elevation=n}}this.terrainTile=n.tileID.canonical,this.terrainExaggeration=t}}updateDEM(e,t,i,r){let n=t._dem._modifiedForSources[r];if(void 0===n&&(t._dem._modifiedForSources[r]=[],n=t._dem._modifiedForSources[r]),n.includes(i.canonical))return;const o=t._dem.dim;n.push(i.canonical);let s=!1;for(const a of this.getNodesInfo()){const e=a.node;if(!e.footprint||!e.footprint.grid)continue;const i=e.footprint.grid,r=t.tileCoordToPixel(i.min.x,i.min.y),n=t.tileCoordToPixel(i.max.x,i.max.y),l=Math.min(Math.min(o-n.y,r.x),Math.min(r.y,o-n.x));if(l<0)continue;const c=Q(l,2,5);let u=Math.max(0,r.x-c),h=Math.max(0,r.y-c),d=Math.min(n.x+c,o-1),p=Math.min(n.y+c,o-1);for(let t=h;t<=p;++t)for(let e=u;e<=d;++e)hg[t*o+e]=255;let f=0,m=0;for(let s=0;s<i.cellsY;++s)for(let e=0;e<i.cellsX;++e){if(!i.cells[s*i.cellsX+e])continue;const r=t.tileCoordToPixel(i.min.x+e/i.xScale,i.min.y+s/i.yScale),n=t.tileCoordToPixel(i.min.x+(e+1)/i.xScale,i.min.y+(s+1)/i.yScale);for(let e=r.y;e<=Math.min(n.y+1,o-1);++e)for(let i=r.x;i<=Math.min(n.x+1,o-1);++i)255===hg[e*o+i]&&(hg[e*o+i]=0,f+=t.getElevationAtPixel(i,e),m++)}const g=f/m;u=Math.max(1,r.x-c),h=Math.max(1,r.y-c),d=Math.min(n.x+c,o-2),p=Math.min(n.y+c,o-2),s=!0;for(let s=h;s<=p;++s)for(let e=u;e<=d;++e)0===hg[s*o+e]&&(ug[s*o+e]=t._dem.set(e,s,g));for(let s=1;s<c;++s){u=Math.max(1,r.x-s),h=Math.max(1,r.y-s),d=Math.min(n.x+s,o-2),p=Math.min(n.y+s,o-2);for(let e=h;e<=p;++e)for(let i=u;i<=d;++i){const r=e*o+i;if(255===hg[r]){let n=0,a=0,l=-1,u=-1;for(let t=-1;t<=1;++t)for(let r=-1;r<=1;++r){const c=(e+t)*o+i+r;if(hg[c]>=s)continue;const h=ug[c],d=Math.abs(h);d>a&&(n=h,a=d,l=r,u=t)}if(a>.1){const o=1-(s+.5*Math.abs(l*u))/c;let a=t._dem.get(i,e)+n*o;const h=t._dem.get(i+l,e+u),d=t._dem.get(i-l,e-u,!0);(a-h)*(a-d)>0&&(a=(h+d)/2),ug[r]=t._dem.set(i,e,a),hg[r]=s}}}}}s&&(t._demTile.needsDEMTextureUpload=!0,t._dem._timestamp=ze.now())}getNodesInfo(){return this.nodesInfo}destroy(){const e=this.getNodesInfo();for(const t of e)ag(t.node),lg(t.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(e,t){if(t.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=t.updateTime;const i=t.getReplacementRegionsForTile(e.toUnwrapped()),r=this.getNodesInfo();for(let n=0;n<this.nodesInfo.length;n++){const e=r[n].node;r[n].hiddenByReplacement=!!e.footprint&&!i.find((t=>t.footprint===e.footprint))}}getHeightAtTileCoord(e,t){const i=this.getNodesInfo(),r=[],n=[0,0,0],o=N.mat4.identity([]);for(let s=0;s<this.nodesInfo.length;s++){const a=i[s],l=a.node.meshes[0],c=l.transformedAabb;if(e<c.min[0]||t<c.min[1]||e>c.max[0]||t>c.max[1])continue;if(!0===a.node.hidden)return{height:1/0,maxHeight:a.feature.properties.height,hidden:!1,verticalScale:a.evaluatedScale[2]};N.mat4.invert(o,a.node.matrix),n[0]=e,n[1]=t,N.vec3.transformMat4(n,n,o);const u=(n[0]-l.aabb.min[0])/(l.aabb.max[0]-l.aabb.min[0])*tg|0,h=Math.min(63,(n[1]-l.aabb.min[1])/(l.aabb.max[1]-l.aabb.min[1])*tg|0)*tg+Math.min(63,u),d=l.heightmap[h];if(!(d<0&&a.node.footprint)){if(a.hiddenByReplacement)return;return{height:d,maxHeight:a.feature.properties.height,hidden:!1,verticalScale:a.evaluatedScale[2]}}if(a.node.footprint.grid.query(new G(e,t),new G(e,t),r),r.length>0)return{height:void 0,maxHeight:a.feature.properties.height,hidden:a.hiddenByReplacement,verticalScale:a.evaluatedScale[2]}}}}function yg(e,t){return!e.isLightConstant&&t}function _g(e,t,i,r,n,o,s,a){let l=(61440&t|(61440&t)>>4)>>8,c=(3840&t|(3840&t)>>4)>>4,u=240&t|(240&t)>>4;i[3]>0&&(l=Et(l,255*i[0],i[3]),c=Et(c,255*i[1],i[3]),u=Et(u,255*i[2],i[3]));const h=l<<8|c,d=u<<8|Math.floor(255*r[3]),p=function(e){const t=Q(e,0,2);return Math.min(Math.round(.5*t*255),255)}(r[2])<<8|15*r[0]<<4|15*r[1],f=Q(n[0],0,1),m=Q(n[1],0,1),g=Q(n[2],0,1),y=Q(n[3],0,1);let _,v,x,b;if(f!==m&&s!==o&&m!==f){const e=s-o;v=1/(e*(m-f)),x=-(o+e*f)/(e*(m-f));const t=Q(n[4],-1,1);b=Math.pow(10,t),_=255*g<<8|255*y}else _=65535,v=0,x=1,b=1;if(e.emplaceBack(h,d,p,_,v,x,b),a){const e=a.length;a.clear();for(let t=0;t<e;t++)a.emplaceBack(h,d,p,_,v,x,b)}}function vg(e,t,i){const r=e.node;let n=0;const o=i&ig.HasMeshoptCompression;for(const s of r.meshes){if(r.lights&&r.lightMeshIndex===n)continue;if(!s.featureData)continue;s.featureArray=new Ys,s.featureArray.reserve(s.featureData.length);let i=t;for(const t of s.featureData){const n=o?65535&t:t>>16&65535,a=o?t>>16&65535:65535&t,l=(15&a)<8?15&a:0,c=e.evaluatedRMEA[l],u=e.evaluatedColor[l],h=e.emissionHeightBasedParams[l];let d;if(i&&2===l&&r.lights&&(d=new Ys,d.resize(10*r.lights.length)),_g(s.featureArray,n,u,c,h,s.aabb.min[2],s.aabb.max[2],d),d&&i){i=!1;const e=r.meshes[r.lightMeshIndex];e.featureArray=d,e.featureArray._trim()}}s.featureArray._trim(),n++}}function xg(e,t,i,r){const n=1<<e.z;t.lat=pl((r/Zi+e.y)/n),t.lng=dl((i/Zi+e.x)/n)}ao(gg,"Tiled3dModelBucket",{omit:["layers"]}),ao(mg,"Tiled3dModelFeature");const bg={circle:class extends ps{constructor(e,t,i,r){super(e,{layout:Kl||(Kl=new $o({"circle-sort-key":new Ho(qo.layout_circle["circle-sort-key"]),"circle-elevation-reference":new Go(qo.layout_circle["circle-elevation-reference"]),visibility:new Go(qo.layout_circle.visibility)})),paint:Jl||(Jl=new $o({"circle-radius":new Ho(qo.paint_circle["circle-radius"]),"circle-color":new Ho(qo.paint_circle["circle-color"]),"circle-blur":new Ho(qo.paint_circle["circle-blur"]),"circle-opacity":new Ho(qo.paint_circle["circle-opacity"]),"circle-translate":new Go(qo.paint_circle["circle-translate"]),"circle-translate-anchor":new Go(qo.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Go(qo.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Go(qo.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ho(qo.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ho(qo.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ho(qo.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Go(qo.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new Ho({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new Ho({type:"string",default:"default","property-type":"data-driven"})}))},t,i,r)}createBucket(e){return new Dl(e)}queryRadius(e){const t=e;return ql("circle-radius",this,t)+ql("circle-stroke-width",this,t)+Xl(this.paint.get("circle-translate"))}queryIntersectsFeature(e,t,i,r,n,o,s,a){const l=Zl(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,e.pixelToTileUnitsFactor),c=this.paint.get("circle-radius").evaluate(t,i)+this.paint.get("circle-stroke-width").evaluate(t,i);return $c(e,r,o,s,a,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),l,c)}getProgramIds(){return["circle"]}getDefaultProgramParams(e,t,i){const r=Wc(this);return{config:new Na(this,{zoom:t,lut:i}),defines:r,overrideFog:!1}}},heatmap:class extends ps{createBucket(e){return new Kc(e)}constructor(e,t,i,r){super(e,{layout:Jc||(Jc=new $o({visibility:new Go(qo.layout_heatmap.visibility)})),paint:Qc||(Qc=new $o({"heatmap-radius":new Ho(qo.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ho(qo.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Go(qo.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Wo(qo.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Go(qo.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new Ho({type:"string",default:"default","property-type":"data-driven"})}))},t,i,r),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){"heatmap-color"===e&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=lu({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(e){return ql("heatmap-radius",this,e)}queryIntersectsFeature(e,t,i,r,n,o,s,a){const l=this.paint.get("heatmap-radius").evaluate(t,i);return $c(e,r,o,s,a,!0,!0,new G(0,0),l)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(e,t,i){return"heatmap"===e?{config:new Na(this,{zoom:t,lut:i}),overrideFog:!1}:{}}},hillshade:class extends ps{constructor(e,t,i,r){super(e,{layout:eu||(eu=new $o({visibility:new Go(qo.layout_hillshade.visibility)})),paint:tu||(tu=new $o({"hillshade-illumination-direction":new Go(qo.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Go(qo.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Go(qo.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Go(qo.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Go(qo.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Go(qo.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Go(qo.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new Ho({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new Ho({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new Ho({type:"string",default:"default","property-type":"data-driven"})}))},t,i,r)}shouldRedrape(){return this.hasOffscreenPass()&&"viewport"===this.paint.get("hillshade-illumination-anchor")}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(e,t,i){return{overrideFog:!1}}},fill:class extends ps{constructor(e,t,i,r){super(e,{layout:Uu||(Uu=new $o({"fill-sort-key":new Ho(qo.layout_fill["fill-sort-key"]),visibility:new Go(qo.layout_fill.visibility),"fill-elevation-reference":new Go(qo.layout_fill["fill-elevation-reference"])})),paint:Gu||(Gu=new $o({"fill-antialias":new Go(qo.paint_fill["fill-antialias"]),"fill-opacity":new Ho(qo.paint_fill["fill-opacity"]),"fill-color":new Ho(qo.paint_fill["fill-color"]),"fill-outline-color":new Ho(qo.paint_fill["fill-outline-color"]),"fill-translate":new Go(qo.paint_fill["fill-translate"]),"fill-translate-anchor":new Go(qo.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ho(qo.paint_fill["fill-pattern"]),"fill-emissive-strength":new Go(qo.paint_fill["fill-emissive-strength"]),"fill-z-offset":new Ho(qo.paint_fill["fill-z-offset"]),"fill-color-use-theme":new Ho({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new Ho({type:"string",default:"default","property-type":"data-driven"})}))},t,i,r)}getProgramIds(){const e=this.paint.get("fill-pattern"),t=e&&e.constantOr(1),i=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&i.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),i}getDefaultProgramParams(e,t,i){return{config:new Na(this,{zoom:t,lut:i}),overrideFog:!1}}recalculate(e,t){super.recalculate(e,t);const i=this.paint._values["fill-outline-color"];"constant"===i.value.kind&&void 0===i.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new Vu(e)}queryRadius(){return Xl(this.paint.get("fill-translate"))}queryIntersectsFeature(e,t,i,r,n,o){return!e.queryGeometry.isAboveHorizon&&zl(Yl(e.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,e.pixelToTileUnitsFactor),r)}isTileClipped(){return!0}is3D(){return 0!==this.paint.get("fill-z-offset").constantOr(1)}},"fill-extrusion":class extends ps{constructor(e,t,i,r){super(e,{layout:ld||(ld=new $o({visibility:new Go(qo["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Go(qo["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:cd||(cd=new $o({"fill-extrusion-opacity":new Go(qo["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ho(qo["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Go(qo["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Go(qo["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ho(qo["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ho(qo["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ho(qo["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new Go(qo["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new Go(qo["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new Go(qo["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Go(qo["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Go(qo["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Go(qo["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Go(qo["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Go(qo["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Go(qo["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Go(qo["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new Ho(qo["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new Ho(qo["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Go(qo["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Go(qo["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Go(qo["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Go(qo["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new Ho(qo["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new Ho(qo["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new Go(qo["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new Ho({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new Ho({type:"string",default:"default","property-type":"data-driven"})}))},t,i,r),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(e){return new Kh(e)}queryRadius(){return Xl(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(e,t,i,r,n,o,s,a,l){const c=Zl(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),o.angle,e.pixelToTileUnitsFactor),u=this.paint.get("fill-extrusion-height").evaluate(t,i),h=this.paint.get("fill-extrusion-base").evaluate(t,i),d=[0,0],p=a&&o.elevation,f=o.elevation?o.elevation.exaggeration():1,m=e.tile.getBucket(this);if(p&&m instanceof Kh){const e=m.centroidVertexArray,t=l+1;t<e.length&&(d[0]=e.geta_centroid_pos0(t),d[1]=e.geta_centroid_pos1(t))}if(0===d[0]&&1===d[1])return!1;"globe"===o.projection.name&&(r=sd([r],[new G(0,0),new G(Zi,Zi)],e.tileID.canonical).map((e=>e.polygon)).flat());const g=p?a:null,[y,_]=function(e,t,i,r,n,o,s,a,l,c,u){return"globe"===e.projection.name?function(e,t,i,r,n,o,s,a,l,c,u){const h=[],d=[],p=e.projection.upVectorScale(u,e.center.lat,e.worldSize).metersToTile,f=[0,0,0,1],m=[0,0,0,1],g=(e,t,i,r)=>{e[0]=t,e[1]=i,e[2]=r,e[3]=1},y=od();i>0&&(i+=y),r+=y;for(const _ of t){const t=[],y=[];for(const h of _){const d=h.x+n.x,_=h.y+n.y,v=e.projection.projectTilePoint(d,_,u),x=e.projection.upVector(u,h.x,h.y);let b=i,w=r;if(s){const e=dd(d,_,i,r,s,a,l,c);b+=e.base,w+=e.top}0!==i?g(f,v.x+x[0]*p*b,v.y+x[1]*p*b,v.z+x[2]*p*b):g(f,v.x,v.y,v.z),g(m,v.x+x[0]*p*w,v.y+x[1]*p*w,v.z+x[2]*p*w),N.vec3.transformMat4(f,f,o),N.vec3.transformMat4(m,m,o),t.push(new fh(f[0],f[1],f[2])),y.push(new fh(m[0],m[1],m[2]))}h.push(t),d.push(y)}return[h,d]}(e,t,i,r,n,o,s,a,l,c,u):s?function(e,t,i,r,n,o,s,a,l){const c=[],u=[],h=[0,0,0,1];for(const d of e){const e=[],p=[];for(const c of d){const u=c.x+r.x,d=c.y+r.y,f=dd(u,d,t,i,o,s,a,l);h[0]=u,h[1]=d,h[2]=f.base,h[3]=1,N.vec4.transformMat4(h,h,n),h[3]=Math.max(h[3],1e-5);const m=new fh(h[0]/h[3],h[1]/h[3],h[2]/h[3]);h[0]=u,h[1]=d,h[2]=f.top,h[3]=1,N.vec4.transformMat4(h,h,n),h[3]=Math.max(h[3],1e-5);const g=new fh(h[0]/h[3],h[1]/h[3],h[2]/h[3]);e.push(m),p.push(g)}c.push(e),u.push(p)}return[c,u]}(t,i,r,n,o,s,a,l,c):function(e,t,i,r,n){const o=[],s=[],a=n[8]*t,l=n[9]*t,c=n[10]*t,u=n[11]*t,h=n[8]*i,d=n[9]*i,p=n[10]*i,f=n[11]*i;for(const m of e){const e=[],t=[];for(const i of m){const o=i.x+r.x,s=i.y+r.y,m=n[0]*o+n[4]*s+n[12],g=n[1]*o+n[5]*s+n[13],y=n[2]*o+n[6]*s+n[14],_=n[3]*o+n[7]*s+n[15],v=m+a,x=g+l,b=y+c,w=Math.max(_+u,1e-5),S=m+h,T=g+d,M=y+p,A=Math.max(_+f,1e-5);e.push(new fh(v/w,x/w,b/w)),t.push(new fh(S/A,T/A,M/A))}o.push(e),s.push(t)}return[o,s]}(t,i,r,n,o)}(o,r,h,u,c,s,g,d,f,o.center.lat,e.tileID.canonical),v=e.queryGeometry;return function(e,t,i){let r=1/0;zl(i,t)&&(r=hd(i,t[0]));for(let n=0;n<t.length;n++){const o=t[n],s=e[n];for(let e=0;e<o.length-1;e++){const t=o[e],n=[t,o[e+1],s[e+1],s[e],t];Ll(i,n)&&(r=Math.min(r,hd(i,n)))}}return r!==1/0&&r}(y,_,v.isPointQuery()?v.screenBounds:v.screenGeometry)}},line:class extends ps{constructor(e,t,i,r){const n=zd();super(e,n,t,i,r),n.layout&&(this.layout=new Uo(n.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(e){if("line-gradient"===e){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof Nr,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(e,t){super.recalculate(e,t),this.paint._values["line-floorwidth"]=(()=>{if(Fd)return Fd;const e=zd();return Fd=new Od(e.paint.properties["line-width"].specification),Fd.useIntegerZoom=!0,Fd})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new Td(e)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(e,t,i){const r=Dd(this);return{config:new Na(this,{zoom:t,lut:i}),defines:r,overrideFog:!1}}queryRadius(e){const t=e,i=Bd(ql("line-width",this,t),ql("line-gap-width",this,t)),r=ql("line-offset",this,t);return i/2+Math.abs(r)+Xl(this.paint.get("line-translate"))}queryIntersectsFeature(e,t,i,r,n,o){if(e.queryGeometry.isAboveHorizon)return!1;const s=Yl(e.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),o.angle,e.pixelToTileUnitsFactor),a=e.pixelToTileUnitsFactor/2*Bd(this.paint.get("line-width").evaluate(t,i),this.paint.get("line-gap-width").evaluate(t,i)),l=this.paint.get("line-offset").evaluate(t,i);return l&&(r=function(e,t){const i=[],r=new G(0,0);for(let n=0;n<e.length;n++){const o=e[n],s=[];for(let e=0;e<o.length;e++){const i=o[e],n=o[e+1],a=0===e?r:i.sub(o[e-1])._unit()._perp(),l=e===o.length-1?r:n.sub(i)._unit()._perp(),c=a._add(l)._unit();c._mult(1/(c.x*l.x+c.y*l.y)),s.push(c._mult(t)._add(i))}i.push(s)}return i}(r,l*e.pixelToTileUnitsFactor)),function(e,t,i){for(let r=0;r<t.length;r++){const n=t[r];if(e.length>=3)for(let t=0;t<n.length;t++)if(Ul(e,n[t]))return!0;if(Ol(e,n,i))return!0}return!1}(s,r,a)}isTileClipped(){return!0}isDraped(e){return!this.hasElevatedBuckets}},symbol:sm,background:class extends ps{constructor(e,t,i,r){super(e,{layout:am||(am=new $o({visibility:new Go(qo.layout_background.visibility)})),paint:lm||(lm=new $o({"background-pitch-alignment":new Go(qo.paint_background["background-pitch-alignment"]),"background-color":new Go(qo.paint_background["background-color"]),"background-pattern":new Go(qo.paint_background["background-pattern"]),"background-opacity":new Go(qo.paint_background["background-opacity"]),"background-emissive-strength":new Go(qo.paint_background["background-emissive-strength"]),"background-color-use-theme":new Ho({type:"string",default:"default","property-type":"data-driven"})}))},t,i,r)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(e,t,i){return{overrideFog:!1}}is3D(){return"viewport"===this.paint.get("background-pitch-alignment")}},raster:bm,"raster-particle":Cm,sky:class extends ps{constructor(e,t,i,r){super(e,{layout:Tm||(Tm=new $o({visibility:new Go(qo.layout_sky.visibility)})),paint:Mm||(Mm=new $o({"sky-type":new Go(qo.paint_sky["sky-type"]),"sky-atmosphere-sun":new Go(qo.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Go(qo.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Go(qo.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Go(qo.paint_sky["sky-gradient-radius"]),"sky-gradient":new Wo(qo.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Go(qo.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Go(qo.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Go(qo.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new Ho({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new Ho({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new Ho({type:"string",default:"default","property-type":"data-driven"})}))},t,i,r),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){"sky-gradient"===e?this._updateColorRamp():"sky-atmosphere-sun"!==e&&"sky-atmosphere-halo-color"!==e&&"sky-atmosphere-color"!==e&&"sky-atmosphere-sun-intensity"!==e||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=lu({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(e){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const t=e.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}getCenter(e,t){if("atmosphere"===this.paint.get("sky-type")){const i=this.paint.get("sky-atmosphere-sun"),r=!i,n=e.style.light,o=n.properties.get("position");return r&&"viewport"===n.properties.get("anchor")&&pe("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),r?Pm(o.azimuthal,90-o.polar,t):Pm(i[0],90-i[1],t)}const i=this.paint.get("sky-gradient-center");return Pm(i[0],90-i[1],t)}isSky(){return!0}markSkyboxValid(e){this._skyboxInvalidated=!1,this._lightPosition=e.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const e=this.paint.get("sky-type");return"atmosphere"===e?["skyboxCapture","skybox"]:"gradient"===e?["skyboxGradient"]:null}},slot:class extends ps{constructor(e,t,i,r){super(e,{paint:Am||(Am=new $o({}))},t,null)}},model:class extends ps{constructor(e,t,i,r){super(e,{layout:Qm||(Qm=new $o({visibility:new Go(qo.layout_model.visibility),"model-id":new Ho(qo.layout_model["model-id"])})),paint:eg||(eg=new $o({"model-opacity":new Ho(qo.paint_model["model-opacity"]),"model-rotation":new Ho(qo.paint_model["model-rotation"]),"model-scale":new Ho(qo.paint_model["model-scale"]),"model-translation":new Ho(qo.paint_model["model-translation"]),"model-color":new Ho(qo.paint_model["model-color"]),"model-color-mix-intensity":new Ho(qo.paint_model["model-color-mix-intensity"]),"model-type":new Go(qo.paint_model["model-type"]),"model-cast-shadows":new Go(qo.paint_model["model-cast-shadows"]),"model-receive-shadows":new Go(qo.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Go(qo.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new Ho(qo.paint_model["model-emissive-strength"]),"model-roughness":new Ho(qo.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new Ho(qo.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Go(qo.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Go(qo.paint_model["model-front-cutoff"]),"model-color-use-theme":new Ho({type:"string",default:"default","property-type":"data-driven"})}))},t,i,r),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(e){return new Jm(e)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(e){return e instanceof gg?Zi-1:0}queryIntersectsFeature(e,t,i,r,n,o){if(!this.modelManager)return!1;const s=this.modelManager,a=e.tile.getBucket(this);if(!(a&&a instanceof Jm))return!1;for(const l in a.instancesPerModel){const i=a.instancesPerModel[l],r=void 0!==t.id?t.id:t.properties&&t.properties.hasOwnProperty("id")?t.properties.id:void 0;if(i.idToFeaturesIndex.hasOwnProperty(r)){const t=i.features[i.idToFeaturesIndex[r]],n=s.getModel(l,this.scope);if(!n)return!1;let c=N.mat4.create();const u=new nl(0,0),h=a.canonical;let d=Number.MAX_VALUE;for(let r=0;r<t.instancedDataCount;++r){const s=16*(t.instancedDataOffset+r),a=i.instancedDataArray.float32,l=[a[s+4],a[s+5],a[s+6]];xg(h,u,a[s],0|a[s+1]),rg(c,n,o,u,t.rotation,t.scale,l,!1,!1,!1),"globe"===o.projection.name&&(c=Bm(c,o));const p=N.mat4.multiply([],o.projMatrix,c),f=e.queryGeometry,m=Nm(f.isPointQuery()?f.screenBounds:f.screenGeometry,o,p,n.aabb);null!=m&&(d=Math.min(m,d))}return d!==Number.MAX_VALUE&&d}}return!1}_handleOverridablePaintPropertyUpdate(e,t,i){return!(!this.layout||t.isDataDriven()||i.isDataDriven()||"model-color"!==e&&"model-color-mix-intensity"!==e&&"model-rotation"!==e&&"model-scale"!==e&&"model-translation"!==e&&"model-emissive-strength"!==e)}_isPropertyZoomDependent(e){const t=this._transitionablePaint._values[e];return null!=t&&null!=t.value&&null!=t.value.expression&&t.value.expression instanceof Jn}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends ps{constructor(e,t,i,r){super(e,{layout:Hu||(Hu=new $o({"clip-layer-types":new Go(qo.layout_clip["clip-layer-types"]),"clip-layer-scope":new Go(qo.layout_clip["clip-layer-scope"])})),paint:Wu||(Wu=new $o({}))},t,i,r)}recalculate(e,t){super.recalculate(e,t)}createBucket(e){return new Xu(e)}isTileClipped(){return!0}is3D(){return!0}}};class wg{constructor(e){this._callback=e,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._callback()}),0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Sg{constructor(){this.tasks={},this.taskQueue=[],ae(["process"],this),this.invoker=new wg(this.process),this.nextId=0}add(e,t){const i=this.nextId++,r=function(e){let{type:t,isSymbolTile:i,zoom:r}=e;return r=r||0,"message"===t?0:"maybePrepare"!==t||i?"parseTile"!==t||i?"parseTile"===t&&i?300-r:"maybePrepare"===t&&i?400-r:500:200-r:100-r}(t);if(0===r){try{e()}finally{}return null}return this.tasks[i]={fn:e,metadata:t,priority:r,id:i},this.taskQueue.push(i),this.invoker.trigger(),{cancel:()=>{delete this.tasks[i]}}}process(){try{if(this.taskQueue=this.taskQueue.filter((e=>!!this.tasks[e])),!this.taskQueue.length)return;const e=this.pick();if(null===e)return;const t=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!t)return;t.fn()}finally{}}pick(){let e=null,t=1/0;for(let r=0;r<this.taskQueue.length;r++){const i=this.tasks[this.taskQueue[r]];i.priority<t&&(t=i.priority,e=r)}if(null===e)return null;const i=this.taskQueue[e];return this.taskQueue.splice(e,1),i}remove(){this.invoker.remove()}}class Tg{constructor(e,t,i){this.target=e,this.parent=t,this.mapId=i,this.callbacks={},this.cancelCallbacks={},ae(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new Sg}send(e,t,i,r){let n=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0;const s=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(i.metadata=o,this.callbacks[s]=i);const a=new Set;return this.target.postMessage({id:s,type:e,hasCallback:!!i,targetMapId:r,mustQueue:n,sourceMapId:this.mapId,data:uo(t,a)},a),{cancel:()=>{i&&delete this.callbacks[s],this.target.postMessage({id:s,type:"<cancel>",targetMapId:r,sourceMapId:this.mapId})}}}receive(e){const t=e.data,i=t.id;if(i&&(!t.targetMapId||this.mapId===t.targetMapId))if("<cancel>"===t.type){const e=this.cancelCallbacks[i];delete this.cancelCallbacks[i],e&&e.cancel()}else if(t.mustQueue||ye()){const e=this.callbacks[i],r=this.scheduler.add((()=>this.processTask(i,t)),e&&e.metadata||{type:"message"});r&&(this.cancelCallbacks[i]=r)}else this.processTask(i,t)}processTask(e,t){if(delete this.cancelCallbacks[e],"<response>"===t.type){const i=this.callbacks[e];delete this.callbacks[e],i&&(t.error?i(ho(t.error)):i(null,ho(t.data)))}else{const i=new Set,r=t.hasCallback?(t,r)=>{this.target.postMessage({id:e,type:"<response>",sourceMapId:this.mapId,error:t?uo(t):null,data:uo(r,i)},i)}:()=>{},n=ho(t.data);if(this.parent[t.type])this.parent[t.type](t.sourceMapId,n,r);else if(this.parent.getWorkerSource){const e=t.type.split(".");this.parent.getWorkerSource(t.sourceMapId,e[0],n.source,n.scope)[e[1]](n,r)}else r(new Error(`Could not find function ${t.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var Mg={workerUrl:"",workerClass:null,workerParams:void 0};const Ag="mapboxgl_preloaded_worker_pool";class Cg{constructor(){this.active={}}acquire(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Cg.workerCount;if(!this.workers)for(this.workers=[];this.workers.length<t;)this.workers.push(null!=Mg.workerClass?new Mg.workerClass:new self.Worker(Mg.workerUrl,Mg.workerParams));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.workers&&0===this.numActive()&&(this.workers.forEach((e=>{e.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[Ag]}numActive(){return Object.keys(this.active).length}}Cg.workerCount=2;class Eg{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Worker",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Cg.workerCount;this.workerPool=e,this.actors=[],this.currentActor=0,this.id=oe();const n=this.workerPool.acquire(this.id,r);for(let o=0;o<n.length;o++){const e=new Eg.Actor(n[o],t,this.id);e.name=`${i} ${o}`,this.actors.push(e)}this.ready=!1,this.broadcast("checkIfReady",null,(()=>{this.ready=!0}))}broadcast(e,t,i){ie(this.actors,((i,r)=>{i.send(e,t,r)}),i=i||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach((e=>{e.remove()})),this.actors=[],this.workerPool.release(this.id)}}let Pg,kg;function Ig(){return Pg||(Pg=new Cg),Pg}Eg.Actor=Tg;const Dg=new At(0,0,0);var Lg=(e=>(e[e.PATH_RULE_UNSPECIFIED=0]="PATH_RULE_UNSPECIFIED",e[e.PATH_RULE_NON_ZERO=1]="PATH_RULE_NON_ZERO",e[e.PATH_RULE_EVEN_ODD=2]="PATH_RULE_EVEN_ODD",e))(Lg||{}),Rg=(e=>(e[e.LINE_CAP_UNSPECIFIED=0]="LINE_CAP_UNSPECIFIED",e[e.LINE_CAP_BUTT=1]="LINE_CAP_BUTT",e[e.LINE_CAP_ROUND=2]="LINE_CAP_ROUND",e[e.LINE_CAP_SQUARE=3]="LINE_CAP_SQUARE",e))(Rg||{}),zg=(e=>(e[e.LINE_JOIN_UNSPECIFIED=0]="LINE_JOIN_UNSPECIFIED",e[e.LINE_JOIN_MITER=1]="LINE_JOIN_MITER",e[e.LINE_JOIN_MITER_CLIP=2]="LINE_JOIN_MITER_CLIP",e[e.LINE_JOIN_ROUND=3]="LINE_JOIN_ROUND",e[e.LINE_JOIN_BEVEL=4]="LINE_JOIN_BEVEL",e))(zg||{}),Og=(e=>(e[e.PAINT_ORDER_UNSPECIFIED=0]="PAINT_ORDER_UNSPECIFIED",e[e.PAINT_ORDER_FILL_AND_STROKE=1]="PAINT_ORDER_FILL_AND_STROKE",e[e.PAINT_ORDER_STROKE_AND_FILL=2]="PAINT_ORDER_STROKE_AND_FILL",e))(Og||{}),Fg=(e=>(e[e.PATH_COMMAND_UNSPECIFIED=0]="PATH_COMMAND_UNSPECIFIED",e[e.PATH_COMMAND_MOVE=1]="PATH_COMMAND_MOVE",e[e.PATH_COMMAND_LINE=2]="PATH_COMMAND_LINE",e[e.PATH_COMMAND_QUAD=3]="PATH_COMMAND_QUAD",e[e.PATH_COMMAND_CUBIC=4]="PATH_COMMAND_CUBIC",e[e.PATH_COMMAND_CLOSE=5]="PATH_COMMAND_CLOSE",e))(Fg||{}),Bg=(e=>(e[e.MASK_TYPE_UNSPECIFIED=0]="MASK_TYPE_UNSPECIFIED",e[e.MASK_TYPE_LUMINANCE=1]="MASK_TYPE_LUMINANCE",e[e.MASK_TYPE_ALPHA=2]="MASK_TYPE_ALPHA",e))(Bg||{});function Ng(e,t,i){1===e&&t.icons.push(function(e,t){return function(e){if(e.usvg_tree.height||(e.usvg_tree.height=e.usvg_tree.width),!e.metadata)return e;const{metadata:t}=e;if(t.content_area){const{content_area:i}=t;null==i.top&&(i.top=i.left),null==i.width&&(i.width=e.usvg_tree.width),null==i.height&&(i.height=i.width)}return t.stretch_x&&t.stretch_x.length&&jg(t,"x"),t.stretch_y&&t.stretch_y.length&&jg(t,"y"),e}(e.readFields(Vg,{name:void 0},t))}(i,i.readVarint()+i.pos))}function jg(e,t){const i=[],r=e[`stretch_${t}`];let n=null;for(let o=0;o<r.length;o++)null===n?n=0===i.length?r[0]:i[i.length-1][1]+r[o]:(i.push([n,n+r[o]]),n=null);e[`stretch_${t}_areas`]=i}function Vg(e,t,i){1===e?t.name=i.readString():2===e?t.metadata=function(e,t){return e.readFields(Ug,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},t)}(i,i.readVarint()+i.pos):3===e&&(t.usvg_tree=function(e,t){return e.readFields(Wg,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},t)}(i,i.readVarint()+i.pos),t.data="usvg_tree")}function Ug(e,t,i){1===e?t.stretch_x=i.readPackedVarint():2===e?t.stretch_y=i.readPackedVarint():3===e?t.content_area=function(e,t){return e.readFields(Gg,{left:0},t)}(i,i.readVarint()+i.pos):4===e&&t.variables.push(function(e,t){return e.readFields(Hg,{name:void 0},t)}(i,i.readVarint()+i.pos))}function Gg(e,t,i){1===e?t.left=i.readVarint():2===e?t.width=i.readVarint():3===e?t.top=i.readVarint():4===e&&(t.height=i.readVarint())}function Hg(e,t,i){1===e?t.name=i.readString():2===e&&(t.rgb_color=Qg(i.readVarint()),t.value="rgb_color")}function Wg(e,t,i){1===e?t.width=t.height=i.readVarint():2===e?t.height=i.readVarint():3===e?t.children.push($g(i,i.readVarint()+i.pos)):4===e?t.linear_gradients.push(function(e,t){return e.readFields(ty,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},t)}(i,i.readVarint()+i.pos)):5===e?t.radial_gradients.push(function(e,t){return e.readFields(ny,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},t)}(i,i.readVarint()+i.pos)):7===e?t.clip_paths.push(function(e,t){return e.readFields(oy,{children:[]},t)}(i,i.readVarint()+i.pos)):8===e&&t.masks.push(function(e,t){const i=e.readFields(sy,{left:0,width:20,mask_type:1,children:[]},t);return null==i.height&&(i.height=i.width),null==i.top&&(i.top=i.left),i}(i,i.readVarint()+i.pos))}function $g(e,t){return e.readFields(qg,{},t)}function qg(e,t,i){1===e?(t.group=function(e,t){return e.readFields(Xg,{opacity:255,children:[]},t)}(i,i.readVarint()+i.pos),t.node="group"):2===e&&(t.path=function(e,t){return e.readFields(Kg,{paint_order:1,commands:[],step:1,diffs:[],rule:1},t)}(i,i.readVarint()+i.pos),t.node="path")}function Xg(e,t,i){1===e?t.transform=Yg(i,i.readVarint()+i.pos):2===e?t.opacity=i.readVarint():5===e?t.clip_path_idx=i.readVarint():6===e?t.mask_idx=i.readVarint():7===e&&t.children.push($g(i,i.readVarint()+i.pos))}function Yg(e,t){return e.readFields(Zg,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},t)}function Zg(e,t,i){1===e?t.sx=i.readFloat():2===e?t.ky=i.readFloat():3===e?t.kx=i.readFloat():4===e?t.sy=i.readFloat():5===e?t.tx=i.readFloat():6===e&&(t.ty=i.readFloat())}function Kg(e,t,i){1===e?t.fill=function(e,t){return e.readFields(Jg,{rgb_color:Dg,paint:"rgb_color",opacity:255},t)}(i,i.readVarint()+i.pos):2===e?t.stroke=function(e,t){return e.readFields(ey,{rgb_color:Dg,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},t)}(i,i.readVarint()+i.pos):3===e?t.paint_order=i.readVarint():5===e?i.readPackedVarint(t.commands):6===e?t.step=i.readFloat():7===e?i.readPackedSVarint(t.diffs):8===e&&(t.rule=i.readVarint())}function Jg(e,t,i){1===e?(t.rgb_color=Qg(i.readVarint()),t.paint="rgb_color"):2===e?(t.linear_gradient_idx=i.readVarint(),t.paint="linear_gradient_idx"):3===e?(t.radial_gradient_idx=i.readVarint(),t.paint="radial_gradient_idx"):5===e&&(t.opacity=i.readVarint())}function Qg(e){return new At((e>>16&255)/255,(e>>8&255)/255,(255&e)/255,1)}function ey(e,t,i){1===e?(t.rgb_color=Qg(i.readVarint()),t.paint="rgb_color"):2===e?(t.linear_gradient_idx=i.readVarint(),t.paint="linear_gradient_idx"):3===e?(t.radial_gradient_idx=i.readVarint(),t.paint="radial_gradient_idx"):5===e?i.readPackedFloat(t.dasharray):6===e?t.dashoffset=i.readFloat():7===e?t.miterlimit=i.readFloat():8===e?t.opacity=i.readVarint():9===e?t.width=i.readFloat():10===e?t.linecap=i.readVarint():11===e&&(t.linejoin=i.readVarint())}function ty(e,t,i){1===e?t.transform=Yg(i,i.readVarint()+i.pos):2===e?t.spread_method=i.readVarint():3===e?t.stops.push(iy(i,i.readVarint()+i.pos)):4===e?t.x1=i.readFloat():5===e?t.y1=i.readFloat():6===e?t.x2=i.readFloat():7===e&&(t.y2=i.readFloat())}function iy(e,t){return e.readFields(ry,{offset:0,opacity:255,rgb_color:Dg},t)}function ry(e,t,i){1===e?t.offset=i.readFloat():2===e?t.opacity=i.readVarint():3===e&&(t.rgb_color=Qg(i.readVarint()))}function ny(e,t,i){1===e?t.transform=Yg(i,i.readVarint()+i.pos):2===e?t.spread_method=i.readVarint():3===e?t.stops.push(iy(i,i.readVarint()+i.pos)):4===e?t.cx=i.readFloat():5===e?t.cy=i.readFloat():6===e?t.r=i.readFloat():7===e?t.fx=i.readFloat():8===e?t.fy=i.readFloat():9===e&&(t.fr=i.readFloat())}function oy(e,t,i){1===e?t.transform=Yg(i,i.readVarint()+i.pos):2===e?t.clip_path_idx=i.readVarint():3===e&&t.children.push($g(i,i.readVarint()+i.pos))}function sy(e,t,i){1===e?t.left=t.top=i.readFloat():2===e?t.width=t.height=i.readFloat():3===e?t.top=i.readFloat():4===e?t.height=i.readFloat():5===e?t.mask_type=i.readVarint():6===e?t.mask_idx=i.readVarint():7===e&&t.children.push($g(i,i.readVarint()+i.pos))}class ay{static calculate(e,t){const i=new Map,r=new Map;if(0===Object.keys(e).length)return i;t.forEach((e=>{r.set(e.name,e.rgb_color||new At(0,0,0))}));for(const[n,o]of Object.entries(e))r.has(n)?i.set(r.get(n).toStringPremultipliedAlpha(),o):console.warn(`Ignoring unknown image variable "${n}"`);return i}}function ly(e){let t=arguments.length>2?arguments[2]:void 0;const i=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:255)/255,r=e.toStringPremultipliedAlpha(),n=t.has(r)?t.get(r).clone():e.clone();return n.a=i,n.toString()}function cy(e,t){if(!Re()){const i=document.createElement("canvas");return i.width=e,i.height=t,i}return new OffscreenCanvas(e,t)}function uy(e,t){const i=ay.calculate(t.params,e.metadata?e.metadata.variables:[]),r=e.usvg_tree,n=r.width,o=r.height,s=t.transform?t.transform:new DOMMatrix,a=Math.max(1,Math.round(n*s.a)),l=Math.max(1,Math.round(o*s.d)),c=new DOMMatrix([a/n,0,0,l/o,0,0]),u=cy(a,l).getContext("2d");return hy(u,c,r,r,i),u.getImageData(0,0,a,l)}function hy(e,t,i,r,n){for(const o of r.children)dy(e,t,i,o,n)}function dy(e,t,i,r,n){r.group?(e.save(),function(e,t,i,r,n){const o=null!=r.mask_idx?i.masks[r.mask_idx]:null,s=null!=r.clip_path_idx?i.clip_paths[r.clip_path_idx]:null;if(r.transform&&(t=by(r.transform).preMultiplySelf(t)),!function(e,t,i){return 255!==e.opacity||t||i}(r,null!=s,null!=o))return void hy(e,t,i,r,n);const a=cy(e.canvas.width,e.canvas.height),l=a.getContext("2d");hy(l,t,i,r,n),s&&vy(l,t,i,s),o&&xy(l,t,i,o,n),e.globalAlpha=r.opacity/255,e.drawImage(a,0,0)}(e,t,i,r.group,n),e.restore()):r.path&&(e.save(),function(e,t,i,r,n){const o=wy(r);e.setTransform(t),r.paint_order===Og.PAINT_ORDER_FILL_AND_STROKE?(py(e,i,r,o,n),my(e,i,r,o,n)):(my(e,i,r,o,n),py(e,i,r,o,n))}(e,t,i,r.path,n),e.restore())}function py(e,t,i,r,n){const o=i.fill;if(!o)return;const s=o.opacity/255;switch(o.paint){case"rgb_color":e.fillStyle=ly(o.rgb_color,o.opacity,n);break;case"linear_gradient_idx":e.fillStyle=gy(e,t.linear_gradients[o.linear_gradient_idx],s,n);break;case"radial_gradient_idx":e.fillStyle=yy(e,t.radial_gradients[o.radial_gradient_idx],s,n)}e.fill(r,fy(i))}function fy(e){return e.rule===Lg.PATH_RULE_NON_ZERO?"nonzero":e.rule===Lg.PATH_RULE_EVEN_ODD?"evenodd":void 0}function my(e,t,i,r,n){const o=i.stroke;if(!o)return;e.lineWidth=o.width,e.miterLimit=o.miterlimit,e.setLineDash(o.dasharray),e.lineDashOffset=o.dashoffset;const s=o.opacity/255;switch(o.paint){case"rgb_color":e.strokeStyle=ly(o.rgb_color,o.opacity,n);break;case"linear_gradient_idx":e.strokeStyle=gy(e,t.linear_gradients[o.linear_gradient_idx],s,n);break;case"radial_gradient_idx":e.strokeStyle=yy(e,t.radial_gradients[o.radial_gradient_idx],s,n)}switch(o.linejoin){case zg.LINE_JOIN_MITER_CLIP:case zg.LINE_JOIN_MITER:e.lineJoin="miter";break;case zg.LINE_JOIN_ROUND:e.lineJoin="round";break;case zg.LINE_JOIN_BEVEL:e.lineJoin="bevel"}switch(o.linecap){case Rg.LINE_CAP_BUTT:e.lineCap="butt";break;case Rg.LINE_CAP_ROUND:e.lineCap="round";break;case Rg.LINE_CAP_SQUARE:e.lineCap="square"}e.stroke(r)}function gy(e,t,i,r){if(1===t.stops.length){const e=t.stops[0];return ly(e.rgb_color,e.opacity*i,r)}const n=by(t.transform),{x1:o,y1:s,x2:a,y2:l}=t,c=n.transformPoint(new DOMPoint(o,s)),u=n.transformPoint(new DOMPoint(a,l)),h=e.createLinearGradient(c.x,c.y,u.x,u.y);for(const d of t.stops)h.addColorStop(d.offset,ly(d.rgb_color,d.opacity*i,r));return h}function yy(e,t,i,r){if(1===t.stops.length){const e=t.stops[0];return ly(e.rgb_color,e.opacity*i,r)}const n=by(t.transform),{fx:o,fy:s,cx:a,cy:l}=t,c=n.transformPoint(new DOMPoint(o,s)),u=n.transformPoint(new DOMPoint(a,l)),h=e.createRadialGradient(c.x,c.y,0,u.x,u.y,t.r*((n.a+n.d)/2));for(const d of t.stops)h.addColorStop(d.offset,ly(d.rgb_color,d.opacity*i,r));return h}function _y(e,t,i,r){const n=r.transform?by(r.transform).preMultiplySelf(t):t,o=cy(e.canvas.width,e.canvas.height),s=o.getContext("2d");for(const l of r.children)if(l.group)_y(s,n,i,l.group);else if(l.path){const e=l.path,t=new Path2D;t.addPath(wy(e),n),s.fill(t,fy(e))}const a=null!=r.clip_path_idx?i.clip_paths[r.clip_path_idx]:null;a&&vy(s,n,i,a),e.globalCompositeOperation="source-over",e.drawImage(o,0,0)}function vy(e,t,i,r){const n=cy(e.canvas.width,e.canvas.height);_y(n.getContext("2d"),t,i,r),e.globalCompositeOperation="destination-in",e.drawImage(n,0,0)}function xy(e,t,i,r,n){if(0===r.children.length)return;const o=null!=r.mask_idx?i.masks[r.mask_idx]:null;o&&xy(e,t,i,o,n);const s=e.canvas.width,a=e.canvas.height,l=cy(s,a),c=l.getContext("2d"),u=r.width,h=r.height,d=r.left,p=r.top,f=new Path2D,m=new Path2D;m.rect(d,p,u,h),f.addPath(m,t),c.clip(f);for(const _ of r.children)dy(c,t,i,_,n);const g=c.getImageData(0,0,s,a),y=g.data;if(r.mask_type===Bg.MASK_TYPE_LUMINANCE)for(let _=0;_<y.length;_+=4)y[_+3]=y[_+3]/255*(.2126*y[_]+.7152*y[_+1]+.0722*y[_+2]);c.putImageData(g,0,0),e.globalCompositeOperation="destination-in",e.drawImage(l,0,0)}function by(e){return e?new DOMMatrix([e.sx,e.ky,e.kx,e.sy,e.tx,e.ty]):new DOMMatrix}function wy(e){const t=new Path2D,i=e.step;let r=e.diffs[0]*i,n=e.diffs[1]*i;t.moveTo(r,n);for(let o=0,s=2;o<e.commands.length;o++)switch(e.commands[o]){case Fg.PATH_COMMAND_MOVE:r+=e.diffs[s++]*i,n+=e.diffs[s++]*i,t.moveTo(r,n);break;case Fg.PATH_COMMAND_LINE:r+=e.diffs[s++]*i,n+=e.diffs[s++]*i,t.lineTo(r,n);break;case Fg.PATH_COMMAND_QUAD:{const o=r+e.diffs[s++]*i,a=n+e.diffs[s++]*i;r=o+e.diffs[s++]*i,n=a+e.diffs[s++]*i,t.quadraticCurveTo(o,a,r,n);break}case Fg.PATH_COMMAND_CUBIC:{const o=r+e.diffs[s++]*i,a=n+e.diffs[s++]*i,l=o+e.diffs[s++]*i,c=a+e.diffs[s++]*i;r=l+e.diffs[s++]*i,n=c+e.diffs[s++]*i,t.bezierCurveTo(o,a,l,c,r,n);break}case Fg.PATH_COMMAND_CLOSE:t.closePath()}return t}class Sy{constructor(e){this.capacity=e,this.cache=new Map}get(e){if(!this.cache.has(e))return;const t=this.cache.get(e);return this.cache.delete(e),this.cache.set(e,t),t}put(e,t){this.cache.has(e)?this.cache.delete(e):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(e,t)}delete(e){this.cache.delete(e)}}class Ty{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(e){return new su(e,e.data)}getFromCache(e,t,i){return this.cacheMap.has(i)||this.cacheMap.set(i,new Sy(150)),this.cacheMap.get(i).get(us(e.serialize(),t))}setInCache(e,t,i,r){this.cacheDependenciesMap.has(r)||this.cacheDependenciesMap.set(r,new Map),this.cacheMap.has(r)||this.cacheMap.set(r,new Sy(150));const n=this.cacheDependenciesMap.get(r);n.get(us(e.id,i))||n.set(us(e.id,i),new Set);const o=this.cacheMap.get(r),s=e.serialize();n.get(us(e.id,i)).add(s),o.put(us(e.serialize(),i),t)}removeImagesFromCacheByIds(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!this.cacheMap.has(i)||!this.cacheDependenciesMap.has(i))return;const r=this.cacheMap.get(i),n=this.cacheDependenciesMap.get(i);for(const o of e)if(n.has(us(o,t))){for(const e of n.get(us(o,t)))r.delete(e);n.delete(us(o,t))}}rasterize(e,t,i,r){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:uy;const o=this.getFromCache(e,i,r);if(o)return o.clone();const s=n(t.icon,e.options),a=Ty._getImage(s);return this.setInCache(e,a,i,r),a.clone()}}class My{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,t){const i=this.toIdx(e,t);return{min:this.minimums[i],max:this.maximums[i]}}isLeaf(e,t){return this.leaves[this.toIdx(e,t)]}toIdx(e,t){return t*this.size+e}}function Ay(e,t,i,r){let n=0,o=Number.MAX_VALUE;for(let s=0;s<3;s++)if(Math.abs(r[s])<1e-15){if(i[s]<e[s]||i[s]>t[s])return null}else{const a=1/r[s];let l=(e[s]-i[s])*a,c=(t[s]-i[s])*a;if(l>c){const e=l;l=c,c=e}if(l>n&&(n=l),c<o&&(o=c),n>o)return null}return n}function Cy(e,t,i,r,n,o,s,a,l,c,u){const h=r-e,d=n-t,p=o-i,f=s-e,m=a-t,g=l-i,y=u[1]*g-u[2]*m,_=u[2]*f-u[0]*g,v=u[0]*m-u[1]*f,x=h*y+d*_+p*v;if(Math.abs(x)<1e-15)return null;const b=1/x,w=c[0]-e,S=c[1]-t,T=c[2]-i,M=(w*y+S*_+T*v)*b;if(M<0||M>1)return null;const A=S*p-T*d,C=T*h-w*p,E=w*d-S*h,P=(u[0]*A+u[1]*C+u[2]*E)*b;return P<0||M+P>1?null:(f*A+m*C+g*E)*b}function Ey(e,t,i){return(e-t)/(i-t)}function Py(e,t,i,r,n,o,s,a,l){const c=1<<i,u=o-r,h=s-n,d=(e+1)/c*u+r,p=(t+0)/c*h+n,f=(t+1)/c*h+n;a[0]=(e+0)/c*u+r,a[1]=p,l[0]=d,l[1]=f}class ky{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const t=function(e){const t=Math.ceil(Math.log2(e.dim/8)),i=[];let r=Math.ceil(Math.pow(2,t));const n=1/r,o=(e,t,i,r,n)=>{const o=r?1:0,s=(e+1)*i-o,a=t*i,l=(t+1)*i-o;n[0]=e*i,n[1]=a,n[2]=s,n[3]=l};let s=new My(r);const a=[];for(let l=0;l<r*r;l++){o(l%r,Math.floor(l/r),n,!1,a);const t=Dy(a[0],a[1],e),i=Dy(a[2],a[1],e),c=Dy(a[2],a[3],e),u=Dy(a[0],a[3],e);s.minimums.push(Math.min(t,i,c,u)),s.maximums.push(Math.max(t,i,c,u)),s.leaves.push(1)}for(i.push(s),r/=2;r>=1;r/=2){const e=i[i.length-1];s=new My(r);for(let t=0;t<r*r;t++){o(t%r,Math.floor(t/r),2,!0,a);const i=e.getElevation(a[0],a[1]),n=e.getElevation(a[2],a[1]),l=e.getElevation(a[2],a[3]),c=e.getElevation(a[0],a[3]),u=e.isLeaf(a[0],a[1]),h=e.isLeaf(a[2],a[1]),d=e.isLeaf(a[2],a[3]),p=e.isLeaf(a[0],a[3]),f=Math.min(i.min,n.min,l.min,c.min),m=Math.max(i.max,n.max,l.max,c.max),g=u&&h&&d&&p;s.maximums.push(m),s.minimums.push(f),s.leaves.push(m-f<=5&&g?1:0)}i.push(s)}return i}(this.dem),i=t.length-1,r=t[i];this._addNode(r.minimums[0],r.maximums[0],r.leaves[0]),this._construct(t,0,0,i,0)}raycastRoot(e,t,i,r,n,o){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return Ay([e,t,-100],[i,r,this.maximums[0]*s],n,o)}raycast(e,t,i,r,n,o){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;if(!this.nodeCount)return null;const a=this.raycastRoot(e,t,i,r,n,o,s);if(null==a)return null;const l=[],c=[],u=[],h=[],d=[{idx:0,t:a,nodex:0,nodey:0,depth:0}];for(;d.length>0;){const{idx:a,t:p,nodex:f,nodey:m,depth:g}=d.pop();if(this.leaves[a]){Py(f,m,g,e,t,i,r,u,h);const a=1<<g,l=(f+0)/a,c=(f+1)/a,d=(m+0)/a,y=(m+1)/a,_=Dy(l,d,this.dem)*s,v=Dy(c,d,this.dem)*s,x=Dy(c,y,this.dem)*s,b=Dy(l,y,this.dem)*s,w=Cy(u[0],u[1],_,h[0],u[1],v,h[0],h[1],x,n,o),S=Cy(h[0],h[1],x,u[0],h[1],b,u[0],u[1],_,n,o),T=Math.min(null!==w?w:Number.MAX_VALUE,null!==S?S:Number.MAX_VALUE);if(T!==Number.MAX_VALUE)return T;{const e=N.vec3.scaleAndAdd([],n,o,p);if(Iy(_,v,b,x,Ey(e[0],u[0],h[0]),Ey(e[1],u[1],h[1]))>=e[2])return p}continue}let y=0;for(let d=0;d<this._siblingOffset.length;d++){Py((f<<1)+this._siblingOffset[d][0],(m<<1)+this._siblingOffset[d][1],g+1,e,t,i,r,u,h),u[2]=-100,h[2]=this.maximums[this.childOffsets[a]+d]*s;const p=Ay(u,h,n,o);if(null!=p){const e=p;l[d]=e;let t=!1;for(let i=0;i<y&&!t;i++)e>=l[c[i]]&&(c.splice(i,0,d),t=!0);t||(c[y]=d),y++}}for(let e=0;e<y;e++){const t=c[e];d.push({idx:this.childOffsets[a]+t,t:l[t],nodex:(f<<1)+this._siblingOffset[t][0],nodey:(m<<1)+this._siblingOffset[t][1],depth:g+1})}}return null}_addNode(e,t,i){return this.minimums.push(e),this.maximums.push(t),this.leaves.push(i),this.childOffsets.push(0),this.nodeCount++}_construct(e,t,i,r,n){if(1===e[r].isLeaf(t,i))return;this.childOffsets[n]||(this.childOffsets[n]=this.nodeCount);const o=r-1,s=e[o];let a=0,l=0;for(let c=0;c<this._siblingOffset.length;c++){const e=2*t+this._siblingOffset[c][0],r=2*i+this._siblingOffset[c][1],n=s.getElevation(e,r),o=s.isLeaf(e,r),u=this._addNode(n.min,n.max,o);o&&(a|=1<<c),l||(l=u)}for(let c=0;c<this._siblingOffset.length;c++)a&1<<c||this._construct(e,2*t+this._siblingOffset[c][0],2*i+this._siblingOffset[c][1],o,l+c)}}function Iy(e,t,i,r,n,o){return Et(Et(e,i,o),Et(t,r,o),n)}function Dy(e,t,i){const r=i.dim,n=Q(e*r-.5,0,r-1),o=Q(t*r-.5,0,r-1),s=Math.floor(n),a=Math.floor(o),l=Math.min(s+1,r-1),c=Math.min(a+1,r-1);return Iy(i.get(s,a),i.get(l,a),i.get(s,c),i.get(l,c),n-s,o-a)}const Ly={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Ry(e,t,i){return(256*e*256+256*t+i)/10-1e4}function zy(e,t,i){return 256*e+t+i/256-32768}class Oy{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(i&&"mapbox"!==i&&"terrarium"!==i)return void pe(`"${i}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=t.height;const n=this.dim=t.height-2,o=new Uint32Array(t.data.buffer);if(this.pixels=new Uint8Array(t.data.buffer),this.floatView=new Float32Array(t.data.buffer),this.borderReady=r,this._modifiedForSources={},!r){for(let e=0;e<n;e++)o[this._idx(-1,e)]=o[this._idx(0,e)],o[this._idx(n,e)]=o[this._idx(n-1,e)],o[this._idx(e,-1)]=o[this._idx(e,0)],o[this._idx(e,n)]=o[this._idx(e,n-1)];o[this._idx(-1,-1)]=o[this._idx(0,0)],o[this._idx(n,-1)]=o[this._idx(n-1,0)],o[this._idx(-1,n)]=o[this._idx(0,n-1)],o[this._idx(n,n)]=o[this._idx(n-1,n-1)]}const s="terrarium"===i?zy:Ry;for(let a=0;a<o.length;++a){const e=4*a;this.floatView[a]=s(this.pixels[e],this.pixels[e+1],this.pixels[e+2])}this._timestamp=ze.now()}_buildQuadTree(){this._tree=new ky(this)}get(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&(e=Q(e,-1,this.dim),t=Q(t,-1,this.dim));const i=this._idx(e,t);return this.floatView[i]}set(e,t,i){const r=this._idx(e,t),n=this.floatView[r];return this.floatView[r]=i,i-n}static getUnpackVector(e){return Ly[e]}_idx(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)}static pack(e,t){const i=[0,0,0,0],r=Oy.getUnpackVector(t);let n=Math.floor((e+r[3])/r[2]);return i[2]=n%256,n=Math.floor(n/256),i[1]=n%256,n=Math.floor(n/256),i[0]=n,i}getPixels(){return new au({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,t,i){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let r=t*this.dim,n=t*this.dim+this.dim,o=i*this.dim,s=i*this.dim+this.dim;switch(t){case-1:r=n-1;break;case 1:n=r+1}switch(i){case-1:o=s-1;break;case 1:s=o+1}const a=-t*this.dim,l=-i*this.dim;for(let c=o;c<s;c++)for(let t=r;t<n;t++){const i=4*this._idx(t,c),r=4*this._idx(t+a,c+l);this.pixels[i+0]=e.pixels[r+0],this.pixels[i+1]=e.pixels[r+1],this.pixels[i+2]=e.pixels[r+2],this.pixels[i+3]=e.pixels[r+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function Fy(e,t,i){1===e?t.headerLength=i.readFixed32():2===e?t.x=i.readVarint():3===e?t.y=i.readVarint():4===e?t.z=i.readVarint():5===e&&t.layers.push(function(e,t){return e.readFields(Uy,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},t)}(i,i.readVarint()+i.pos))}function By(e,t,i){1===e?(t.delta_filter=function(e,t){return e.readFields(Ny,{blockSize:0},t)}(i,i.readVarint()+i.pos),t.filter="delta_filter"):2===e?(i.readVarint(),t.filter="zigzag_filter"):3===e?(i.readVarint(),t.filter="bitshuffle_filter"):4===e&&(i.readVarint(),t.filter="byteshuffle_filter")}function Ny(e,t,i){1===e&&(t.blockSize=i.readVarint())}function jy(e,t,i){1===e?(i.readVarint(),t.codec="gzip_data"):2===e?(i.readVarint(),t.codec="jpeg_image"):3===e?(i.readVarint(),t.codec="webp_image"):4===e&&(i.readVarint(),t.codec="png_image")}function Vy(e,t,i){let r=0,n=0;1===e?t.firstByte=i.readFixed64():2===e?t.lastByte=i.readFixed64():3===e?t.filters.push(function(e,t){return e.readFields(By,{},t)}(i,i.readVarint()+i.pos)):4===e?t.codec=function(e,t){return e.readFields(jy,{},t)}(i,i.readVarint()+i.pos):5===e?n=i.readFloat():6===e?r=i.readFloat():7===e?t.bands.push(i.readString()):8===e?t.offset=i.readDouble():9===e&&(t.scale=i.readDouble()),0===t.offset&&(t.offset=n),0===t.scale&&(t.scale=r)}function Uy(e,t,i){1===e?t.version=i.readVarint():2===e?t.name=i.readString():3===e?t.units=i.readString():4===e?t.tileSize=i.readVarint():5===e?t.buffer=i.readVarint():6===e?t.pixelFormat=i.readVarint():7===e&&t.dataIndex.push(function(e,t){return e.readFields(Vy,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},t)}(i,i.readVarint()+i.pos))}function Gy(e,t,i){if(2===e)!function(e,t,i){e.readFields(Hy,i,t)}(i,i.readVarint()+i.pos,t);else if(3===e)throw new Error("Not implemented")}function Hy(e,t,i){if(1===e){let e=0;const r=i.readVarint()+i.pos;for(;i.pos<r;)t[e++]=i.readVarint()}}function Wy(e,t){if(4!==t.length)throw new Error(`Expected data of dimension 4 but got ${t.length}.`);let i=t[3];for(let r=2;r>=1;r--){const n=1===r?1:0,o=2===r?1:0;for(let r=0;r<t[0];r++){const s=t[1]*r;for(let r=n;r<t[1];r++){const n=t[2]*(r+s);for(let r=o;r<t[2];r++){const o=t[3]*(r+n);for(let r=0;r<t[3];r++){const t=o+r;e[t]+=e[t-i]}}}}i*=t[r]}return e}function $y(e){for(let t=0,i=e.length;t<i;t++)e[t]=e[t]>>>1^-(1&e[t]);return e}function qy(e,t){switch(t){case"uint32":return e;case"uint16":for(let t=0;t<e.length;t+=2){const i=e[t],r=e[t+1];e[t]=(240&i)>>4|(61440&i)>>8|(240&r)<<4|61440&r,e[t+1]=15&i|(3840&i)>>4|(15&r)<<8|(3840&r)<<4}return e;case"uint8":for(let t=0;t<e.length;t+=4){const i=e[t],r=e[t+1],n=e[t+2],o=e[t+3];e[t+0]=(192&i)>>6|(192&r)>>4|(192&n)>>2|192&o,e[t+1]=(48&i)>>4|(48&r)>>2|48&n|(48&o)<<2,e[t+2]=(12&i)>>2|12&r|(12&n)<<2|(12&o)<<4,e[t+3]=3&i|(3&r)<<2|(3&n)<<4|(3&o)<<6}return e;default:throw new Error(`Invalid pixel format, "${t}"`)}}ao(Oy,"DEMData"),ao(ky,"DemMinMaxQuadTree",{omit:["dem"]});var Xy=Uint8Array,Yy=Uint16Array,Zy=Int32Array,Ky=new Xy([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Jy=new Xy([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Qy=new Xy([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),e_=function(e,t){for(var i=new Yy(31),r=0;r<31;++r)i[r]=t+=1<<e[r-1];var n=new Zy(i[30]);for(r=1;r<30;++r)for(var o=i[r];o<i[r+1];++o)n[o]=o-i[r]<<5|r;return{b:i,r:n}},t_=e_(Ky,2),i_=t_.b,r_=t_.r;i_[28]=258,r_[258]=28;for(var n_=e_(Jy,0).b,o_=new Yy(32768),s_=0;s_<32768;++s_){var a_=(43690&s_)>>1|(21845&s_)<<1;o_[s_]=((65280&(a_=(61680&(a_=(52428&a_)>>2|(13107&a_)<<2))>>4|(3855&a_)<<4))>>8|(255&a_)<<8)>>1}var l_=function(e,t,i){for(var r=e.length,n=0,o=new Yy(t);n<r;++n)e[n]&&++o[e[n]-1];var s,a=new Yy(t);for(n=1;n<t;++n)a[n]=a[n-1]+o[n-1]<<1;s=new Yy(1<<t);var l=15-t;for(n=0;n<r;++n)if(e[n])for(var c=n<<4|e[n],u=t-e[n],h=a[e[n]-1]++<<u,d=h|(1<<u)-1;h<=d;++h)s[o_[h]>>l]=c;return s},c_=new Xy(288);for(s_=0;s_<144;++s_)c_[s_]=8;for(s_=144;s_<256;++s_)c_[s_]=9;for(s_=256;s_<280;++s_)c_[s_]=7;for(s_=280;s_<288;++s_)c_[s_]=8;var u_=new Xy(32);for(s_=0;s_<32;++s_)u_[s_]=5;var h_=l_(c_,9),d_=l_(u_,5),p_=function(e){for(var t=e[0],i=1;i<e.length;++i)e[i]>t&&(t=e[i]);return t},f_=function(e,t,i){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(7&t)&i},m_=function(e,t){var i=t/8|0;return(e[i]|e[i+1]<<8|e[i+2]<<16)>>(7&t)},g_=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],y_=function(e,t,i){var r=new Error(t||g_[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,y_),!i)throw r;return r},__=new Xy(0),v_="undefined"!=typeof TextDecoder&&new TextDecoder;try{v_.decode(__,{stream:!0})}catch(e){}const x_={gzip_data:"gzip"};class b_ extends Error{constructor(e){super(e),this.name="MRTError"}}const w_={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},S_={uint32:1,uint16:2,uint8:4},T_={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let M_;class A_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=e}getLayer(e){const t=this.layers[e];if(!t)throw new b_(`Layer '${e}' not found`);return t}getHeaderLength(e){const t=new Uint8Array(e),i=new DataView(e);if(13!==t[0])throw new b_("File is not a valid MRT.");return i.getUint32(1,!0)}parseHeader(e){const t=new Uint8Array(e),i=this.getHeaderLength(e);if(t.length<i)throw new b_(`Expected header with length >= ${i} but got buffer of length ${t.length}`);const r=function(e){return e.readFields(Fy,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new M_(t.subarray(0,i)));if(!isNaN(this.x)&&(this.x!==r.x||this.y!==r.y||this.z!==r.z))throw new b_(`Invalid attempt to parse header ${r.z}/${r.x}/${r.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=r.x,this.y=r.y,this.z=r.z;for(const n of r.layers)this.layers[n.name]=new C_(n,{cacheSize:this._cacheSize});return this}createDecodingTask(e){const t=[],i=this.getLayer(e.layerName);for(let r of e.blockIndices){const n=i.dataIndex[r],o=n.firstByte-e.firstByte,s=n.lastByte-e.firstByte;if(i._blocksInProgress.has(r))continue;const a={layerName:i.name,firstByte:o,lastByte:s,pixelFormat:i.pixelFormat,blockIndex:r,blockShape:[n.bands.length].concat(i.bandShape),buffer:i.buffer,codec:n.codec.codec,filters:n.filters.map((e=>e.filter))};i._blocksInProgress.add(r),t.push(a)}return new E_(t,(()=>{t.forEach((e=>i._blocksInProgress.delete(e.blockIndex)))}),((e,r)=>{if(t.forEach((e=>i._blocksInProgress.delete(e.blockIndex))),e)throw e;r.forEach((e=>{this.getLayer(e.layerName).processDecodedData(e)}))}))}}class C_{constructor(e,t){let{version:i,name:r,units:n,tileSize:o,pixelFormat:s,buffer:a,dataIndex:l}=e;if(this.version=i,1!==this.version)throw new b_(`Cannot parse raster layer encoded with MRT version ${i}`);this.name=r,this.units=n,this.tileSize=o,this.buffer=a,this.pixelFormat=w_[s],this.dataIndex=l,this.bandShape=[o+2*a,o+2*a,S_[this.pixelFormat]],this._decodedBlocks=new Sy(t?t.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return S_[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map((e=>{let{bands:t}=e;return t})).flat()}processDecodedData(e){const t=e.blockIndex.toString();this._decodedBlocks.get(t)||this._decodedBlocks.put(t,e.data)}getBlockForBand(e){let t=0;switch(typeof e){case"string":for(const[i,r]of this.dataIndex.entries()){for(const[n,o]of r.bands.entries())if(o===e)return{bandIndex:t+n,blockIndex:i,blockBandIndex:n};t+=r.bands.length}break;case"number":for(const[i,r]of this.dataIndex.entries()){if(e>=t&&e<t+r.bands.length)return{bandIndex:e,blockIndex:i,blockBandIndex:e-t};t+=r.bands.length}break;default:throw new b_(`Invalid band \`${JSON.stringify(e)}\`. Expected string or integer.`)}throw new b_(`Band not found: ${JSON.stringify(e)}`)}getDataRange(e){let t=1/0,i=-1/0;const r=[],n=new Set;for(const o of e){const{blockIndex:e}=this.getBlockForBand(o);if(e<0)throw new b_(`Invalid band: ${JSON.stringify(o)}`);const s=this.dataIndex[e];r.includes(e)||r.push(e),n.add(e),t=Math.min(t,s.firstByte),i=Math.max(i,s.lastByte)}if(n.size>this.cacheSize)throw new b_(`Number of blocks to decode (${n.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:t,lastByte:i,blockIndices:r}}hasBand(e){const{blockIndex:t}=this.getBlockForBand(e);return t>=0}hasDataForBand(e){const{blockIndex:t}=this.getBlockForBand(e);return t>=0&&!!this._decodedBlocks.get(t.toString())}getBandView(e){const{blockIndex:t,blockBandIndex:i}=this.getBlockForBand(e),r=this._decodedBlocks.get(t.toString());if(!r)throw new b_(`Data for band ${JSON.stringify(e)} of layer "${this.name}" not decoded.`);const n=this.dataIndex[t],o=this.bandShape.reduce(((e,t)=>e*t),1),s=i*o,a=r.subarray(s,s+o);return{data:a,bytes:new Uint8Array(a.buffer).subarray(a.byteOffset,a.byteOffset+a.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:n.offset,scale:n.scale}}}A_.setPbf=function(e){M_=e};class E_{constructor(e,t,i){this.tasks=e,this._onCancel=t,this._onComplete=i,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(e,t){this._finalized||(this._onComplete(e,t),this._finalized=!0)}}A_.performDecoding=function(e,t){const i=new Uint8Array(e);return Promise.all(t.tasks.map((e=>{const{layerName:t,firstByte:r,lastByte:n,pixelFormat:o,blockShape:s,blockIndex:a,filters:l,codec:c}=e,u=i.subarray(r,n+1),h=new Uint32Array(s[0]*s[1]*s[2]);let d;if("gzip_data"!==c)throw new b_(`Unhandled codec: ${c}`);return d=function(e,t){if(!globalThis.DecompressionStream&&"gzip_data"===t)return Promise.resolve(((o=function(e){31==e[0]&&139==e[1]&&8==e[2]||y_(6,"invalid gzip data");var t=e[3],i=10;4&t&&(i+=2+(e[10]|e[11]<<8));for(var r=(t>>3&1)+(t>>4&1);r>0;r-=!e[i++]);return i+(2&t)}(n=e))+8>n.length&&y_(6,"invalid gzip data"),function(e,t,i){var r=e.length;if(!r||t.f&&!t.l)return i||new Xy(0);var n=!i,o=n||2!=t.i,s=t.i;n&&(i=new Xy(3*r));var a,l,c=function(e){var t=i.length;if(e>t){var r=new Xy(Math.max(2*t,e));r.set(i),i=r}},u=t.f||0,h=t.p||0,d=t.b||0,p=t.l,f=t.d,m=t.m,g=t.n,y=8*r;do{if(!p){u=f_(e,h,1);var _=f_(e,h+1,3);if(h+=3,!_){var v=e[(k=4+((h+7)/8|0))-4]|e[k-3]<<8,x=k+v;if(x>r){s&&y_(0);break}o&&c(d+v),i.set(e.subarray(k,x),d),t.b=d+=v,t.p=h=8*x,t.f=u;continue}if(1==_)p=h_,f=d_,m=9,g=5;else if(2==_){var b=f_(e,h,31)+257,w=f_(e,h+10,15)+4,S=b+f_(e,h+5,31)+1;h+=14;for(var T=new Xy(S),M=new Xy(19),A=0;A<w;++A)M[Qy[A]]=f_(e,h+3*A,7);h+=3*w;var C=p_(M),E=(1<<C)-1,P=l_(M,C);for(A=0;A<S;){var k,I=P[f_(e,h,E)];if(h+=15&I,(k=I>>4)<16)T[A++]=k;else{var D=0,L=0;for(16==k?(L=3+f_(e,h,3),h+=2,D=T[A-1]):17==k?(L=3+f_(e,h,7),h+=3):18==k&&(L=11+f_(e,h,127),h+=7);L--;)T[A++]=D}}var R=T.subarray(0,b),z=T.subarray(b);m=p_(R),g=p_(z),p=l_(R,m),f=l_(z,g)}else y_(1);if(h>y){s&&y_(0);break}}o&&c(d+131072);for(var O=(1<<m)-1,F=(1<<g)-1,B=h;;B=h){var N=(D=p[m_(e,h)&O])>>4;if((h+=15&D)>y){s&&y_(0);break}if(D||y_(2),N<256)i[d++]=N;else{if(256==N){B=h,p=null;break}var j=N-254;N>264&&(j=f_(e,h,(1<<(G=Ky[A=N-257]))-1)+i_[A],h+=G);var V=f[m_(e,h)&F],U=V>>4;if(V||y_(3),h+=15&V,z=n_[U],U>3){var G=Jy[U];z+=m_(e,h)&(1<<G)-1,h+=G}if(h>y){s&&y_(0);break}o&&c(d+131072);var H=d+j;if(d<z){var W=0-z,$=Math.min(z,H);for(W+d<0&&y_(3);d<$;++d)i[d]=(void 0)[W+d]}for(;d<H;++d)i[d]=i[d-z]}}t.l=p,t.p=B,t.b=d,t.f=u,p&&(u=1,t.m=m,t.d=f,t.n=g)}while(!u);return d!=i.length&&n?(a=i,(null==(l=d)||l>a.length)&&(l=a.length),new Xy(a.subarray(0,l))):i.subarray(0,d)}(n.subarray(o,-8),{i:2},new Xy(((i=n)[(r=i.length)-4]|i[r-3]<<8|i[r-2]<<16|i[r-1]<<24)>>>0))));var i,r,n,o;const s=x_[t];if(!s)throw new Error(`Unhandled codec: ${t}`);const a=new globalThis.DecompressionStream(s);return new Response(new Blob([e]).stream().pipeThrough(a)).arrayBuffer().then((e=>new Uint8Array(e)))}(u,c).then((e=>(function(e,t){e.readFields(Gy,t)}(new M_(e),h),new(0,T_[o])(h.buffer)))),d.then((e=>{for(let t=l.length-1;t>=0;t--)switch(l[t]){case"delta_filter":Wy(e,s);break;case"zigzag_filter":$y(e);break;case"bitshuffle_filter":qy(e,o);break;default:throw new b_(`Unhandled filter "${l[t]}"`)}return{layerName:t,blockIndex:a,data:e}})).catch((e=>{throw e}))})))},ao(E_,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});let P_,k_,I_,D_,L_,R_=null;function z_(){return ye()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:k_||Me.DRACO_URL}function O_(){if(ye()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(D_)return D_;const e=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if("object"!=typeof WebAssembly)throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return D_=WebAssembly.validate(e)?Me.MESHOPT_SIMD_URL:Me.MESHOPT_URL,D_}const F_={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},B_={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},N_={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function j_(e,t,i){const r=i.json.bufferViews.length,n=i.buffers.length;t.bufferView=r,i.json.bufferViews[r]={buffer:n,byteLength:e.byteLength},i.buffers[n]=e}const V_="KHR_draco_mesh_compression";function U_(e,t){const i=e.extensions&&e.extensions[V_];if(!i)return;const r=new I_.Decoder,n=Y_(t,i.bufferView),o=new I_.Mesh;if(!r.DecodeArrayToMesh(n,n.byteLength,o))throw new Error("Failed to decode Draco mesh");const s=t.json.accessors[e.indices],a=F_[s.componentType],l=s.count*a.BYTES_PER_ELEMENT,c=I_._malloc(l);a===Uint16Array?r.GetTrianglesUInt16Array(o,l,c):r.GetTrianglesUInt32Array(o,l,c),j_(I_.memory.buffer.slice(c,c+l),s,t),I_._free(c);for(const u of Object.keys(i.attributes)){const n=r.GetAttributeByUniqueId(o,i.attributes[u]),s=t.json.accessors[e.attributes[u]],a=B_[s.componentType],l=s.count*N_[s.type]*F_[s.componentType].BYTES_PER_ELEMENT,c=I_._malloc(l);r.GetAttributeDataArrayForAllPoints(o,n,I_[a],l,c),j_(I_.memory.buffer.slice(c,c+l),s,t),I_._free(c)}r.destroy(),o.destroy(),delete e.extensions[V_]}const G_="EXT_meshopt_compression";function H_(e,t){if(!e.extensions||!e.extensions[G_])return;const i=e.extensions[G_],r=new Uint8Array(t.buffers[i.buffer],i.byteOffset||0,i.byteLength||0),n=new Uint8Array(i.count*i.byteStride);L_.decodeGltfBuffer(n,i.count,i.byteStride,r,i.mode,i.filter),e.buffer=t.buffers.length,e.byteOffset=0,t.buffers[e.buffer]=n.buffer,delete e.extensions[G_]}const W_=1179937895,$_=new TextDecoder("utf8");function q_(e,t){return new URL(e,t).href}function X_(e,t,i,r){return fetch(q_(e.uri,r)).then((e=>e.arrayBuffer())).then((e=>{t.buffers[i]=e}))}function Y_(e,t){const i=e.json.bufferViews[t];return new Uint8Array(e.buffers[i.buffer],i.byteOffset||0,i.byteLength)}function Z_(e,t,i,r){if(e.uri){const n=q_(e.uri,r);return fetch(n).then((e=>e.blob())).then((e=>createImageBitmap(e))).then((e=>{t.images[i]=e}))}if(void 0!==e.bufferView){const r=Y_(t,e.bufferView),n=new Blob([r],{type:e.mimeType});return createImageBitmap(n).then((e=>{t.images[i]=e}))}}function K_(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;const r={json:null,images:[],buffers:[]};if(new Uint32Array(e,t,1)[0]===W_){const i=new Uint32Array(e,t);let n=2;const o=(i[n++]>>2)-3,s=i[n++]>>2;if(n++,r.json=JSON.parse($_.decode(i.subarray(n,n+s))),n+=s,n<o){const o=i[n++];n++;const s=t+(n<<2);r.buffers[0]=e.slice(s,s+o)}}else r.json=JSON.parse($_.decode(new Uint8Array(e,t)));const{buffers:n,images:o,meshes:s,extensionsUsed:a,bufferViews:l}=r.json;let c=Promise.resolve();if(n){const e=[];for(let t=0;t<n.length;t++){const o=n[t];o.uri?e.push(X_(o,r,t,i)):r.buffers[t]||(r.buffers[t]=null)}c=Promise.all(e)}return c.then((()=>{const e=[],t=a&&a.includes(V_),n=a&&a.includes(G_);if(t&&e.push(function(){if(!I_)return null!=P_?P_:(P_=function(e){let t,i=null;function r(){t=new Uint8Array(i.buffer)}function n(){throw new Error("Unexpected Draco error.")}const o={a:{a:n,d:function(e,i,r){return t.copyWithin(e,i,i+r)},c:function(e){const n=t.length,o=Math.max(e>>>0,Math.ceil(1.2*n)),s=Math.ceil((o-n)/65536);try{return i.grow(s),r(),!0}catch(e){return!1}},b:n}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(e,o):e.then((e=>e.arrayBuffer())).then((e=>WebAssembly.instantiate(e,o)))).then((e=>{const{Rb:n,Qb:o,P:s,T:a,X:l,Ja:c,La:u,Qa:h,Va:d,Wa:p,eb:f,jb:m,f:g,e:y,yb:_,zb:v,Ab:x,Bb:b,Db:w,Gb:S}=e.instance.exports;i=y;const T=(()=>{let e=0,i=0,r=0,s=0;return a=>{r&&(n(s),n(e),i+=r,r=e=0),e||(i+=128,e=o(i));const l=a.length+7&-8;let c=e;l>=i&&(r=l,c=s=o(l));for(let e=0;e<a.length;e++)t[c+e]=a[e];return c}})();return r(),g(),{memory:y,_free:n,_malloc:o,Mesh:class{constructor(){this.ptr=s()}destroy(){a(this.ptr)}},Decoder:class{constructor(){this.ptr=c()}destroy(){m(this.ptr)}DecodeArrayToMesh(e,t,i){const r=T(e),n=u(this.ptr,r,t,i.ptr);return!!l(n)}GetAttributeByUniqueId(e,t){return{ptr:h(this.ptr,e.ptr,t)}}GetTrianglesUInt16Array(e,t,i){d(this.ptr,e.ptr,t,i)}GetTrianglesUInt32Array(e,t,i){p(this.ptr,e.ptr,t,i)}GetAttributeDataArrayForAllPoints(e,t,i,r,n){f(this.ptr,e.ptr,t.ptr,i,r,n)}},DT_INT8:_(),DT_UINT8:v(),DT_INT16:x(),DT_UINT16:b(),DT_UINT32:w(),DT_FLOAT32:S()}}))}(fetch(z_())),P_.then((e=>{I_=e,P_=void 0})))}()),n&&e.push(function(){if(L_)return;const e=function(e){let t;const i=WebAssembly.instantiateStreaming(e,{}).then((e=>{t=e.instance,t.exports.__wasm_call_ctors()})),r={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},n={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:i,supported:!0,decodeGltfBuffer(e,i,o,s,a,l){!function(e,t,i,r,n,o,s){const a=e.exports.sbrk,l=r+3&-4,c=a(l*n),u=a(o.length),h=new Uint8Array(e.exports.memory.buffer);h.set(o,u);const d=t(c,r,n,u,o.length);if(0===d&&s&&s(c,l,n),i.set(h.subarray(c,c+r*n)),a(c-a(0)),0!==d)throw new Error(`Malformed buffer data: ${d}`)}(t,t.exports[n[a]],e,i,o,s,t.exports[r[l]])}}}(fetch(O_()));return e.ready.then((()=>{L_=e}))}()),o)for(let s=0;s<o.length;s++)e.push(Z_(o[s],r,s,i));return(e.length?Promise.all(e):Promise.resolve()).then((()=>{if(t&&s)for(const{primitives:e}of s)for(const t of e)U_(t,r);if(n&&s&&l)for(const e of l)H_(e,r);return r}))}))}function J_(e,t){const i=e.json.bufferViews[t.bufferView],r=F_[t.componentType];return new r(e.buffers[i.buffer],(t.byteOffset||0)+(i.byteOffset||0),t.count*(i.byteStride&&i.byteStride!==N_[t.type]*r.BYTES_PER_ELEMENT?i.byteStride/r.BYTES_PER_ELEMENT:N_[t.type]))}function Q_(e,t,i,r){const n=F_[t.componentType],o=function(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(n),s=e.json.bufferViews[t.bufferView],a=s.byteStride?s.byteStride/n.BYTES_PER_ELEMENT:N_[t.type],l=i.float32,c=l.length/i.capacity;for(let u=0,h=0;u<t.count*a;u+=a,h+=c)for(let e=0;e<c;e++)l[h+e]=r[u+e]*o;i._trim()}function ev(e,t,i){const r=e.indices,n=e.attributes,o={};o.indexArray=new Fs;const s=t.json.accessors[r],a=s.count/3;o.indexArray.reserve(a);const l=J_(t,s);for(let d=0;d<a;d++)o.indexArray.emplaceBack(l[3*d],l[3*d+1],l[3*d+2]);o.indexArray._trim(),o.vertexArray=new Ts;const c=t.json.accessors[n.POSITION];o.vertexArray.reserve(c.count);const u=J_(t,c);for(let d=0;d<c.count;d++)o.vertexArray.emplaceBack(u[3*d],u[3*d+1],u[3*d+2]);if(o.vertexArray._trim(),o.aabb=new _c(c.min,c.max),o.centroid=function(e,t){const i=[0,0,0],r=e.length;if(r>0){for(let n=0;n<r;n++){const r=3*e[n];i[0]+=t[r],i[1]+=t[r+1],i[2]+=t[r+2]}i[0]/=r,i[1]/=r,i[2]/=r}return i}(l,u),void 0!==n.COLOR_0){const e=t.json.accessors[n.COLOR_0],i=N_[e.type],r=J_(t,e);o.colorArray=3===i?new Ts:new ks,o.colorArray.resize(e.count),Q_(t,e,o.colorArray,r)}if(void 0!==n.NORMAL){o.normalArray=new Ts;const e=t.json.accessors[n.NORMAL];o.normalArray.resize(e.count);const i=J_(t,e);Q_(t,e,o.normalArray,i)}if(void 0!==n.TEXCOORD_0&&i.length>0){o.texcoordArray=new Ws;const e=t.json.accessors[n.TEXCOORD_0];o.texcoordArray.resize(e.count);const i=J_(t,e);Q_(t,e,o.texcoordArray,i)}if(void 0!==n._FEATURE_ID_RGBA4444){const e=t.json.accessors[n._FEATURE_ID_RGBA4444];t.json.extensionsUsed&&t.json.extensionsUsed.includes("EXT_meshopt_compression")&&(o.featureData=J_(t,e))}void 0!==n._FEATURE_RGBA4444&&(o.featureData=new Uint32Array(J_(t,t.json.accessors[n._FEATURE_RGBA4444]).buffer));const h=e.material;return o.material=function(e,t){const{emissiveFactor:i=[0,0,0],alphaMode:r="OPAQUE",alphaCutoff:n=.5,normalTexture:o,occlusionTexture:s,emissiveTexture:a,doubleSided:l}=e,{baseColorFactor:c=[1,1,1,1],metallicFactor:u=1,roughnessFactor:h=1,baseColorTexture:d,metallicRoughnessTexture:p}=e.pbrMetallicRoughness||{},f=s?t[s.index]:void 0;if(s&&s.extensions&&s.extensions.KHR_texture_transform&&f){const e=s.extensions.KHR_texture_transform;f.offsetScale=[e.offset[0],e.offset[1],e.scale[0],e.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new At(...c),metallicFactor:u,roughnessFactor:h,baseColorTexture:d?t[d.index]:void 0,metallicRoughnessTexture:p?t[p.index]:void 0},doubleSided:l,emissiveFactor:i,alphaMode:r,alphaCutoff:n,normalTexture:o?t[o.index]:void 0,occlusionTexture:f,emissionTexture:a?t[a.index]:void 0,defined:void 0===e.defined}}(void 0!==h?t.json.materials[h]:{defined:!1},i),o}function tv(e,t,i){const{matrix:r,rotation:n,translation:o,scale:s,mesh:a,extras:l,children:c}=e,u={};if(u.matrix=r||N.mat4.fromRotationTranslationScale([],n||[0,0,0,1],o||[0,0,0],s||[1,1,1]),void 0!==a){u.meshes=i[a];const e=u.anchor=[0,0];for(const t of u.meshes){const{min:i,max:r}=t.aabb;e[0]+=i[0]+r[0],e[1]+=i[1]+r[1]}e[0]=Math.floor(e[0]/u.meshes.length/2),e[1]=Math.floor(e[1]/u.meshes.length/2)}if(l&&(l.id&&(u.id=l.id),l.lights&&(u.lights=function(e){if(!e.length)return[];const t=function(e){const t=atob(e),i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.codePointAt(r);return i}(e),i=[],r=t.length/24,n=new Uint16Array(t.buffer),o=new Float32Array(t.buffer);for(let s=0;s<r;s++){const e=n[2*s*6]/30,t=n[2*s*6+1]/30,r=n[2*s*6+10]/100,a=o[6*s+1],l=o[6*s+2],c=o[6*s+3],u=o[6*s+4],h=c-a,d=u-l,p=Math.hypot(h,d);i.push({pos:[a+.5*h,l+.5*d,t],normal:[d/p,-h/p,0],width:p,height:e,depth:r,points:[a,l,c,u]})}return i}(l.lights))),c){const e=[];for(const r of c)e.push(tv(t.json.nodes[r],t,i));u.children=e}return u}function iv(e){if(0===e.vertices.length||0===e.indices.length)return null;const t=new $u(e.vertices,e.indices,8,256),[i,r]=[t.min.clone(),t.max.clone()];return{vertices:e.vertices,indices:e.indices,grid:t,min:i,max:r}}function rv(e){if(!e.extras||!e.extras.ground)return null;const t=e.extras.ground;if(!t||!Array.isArray(t)||0===t.length)return null;const i=t[0];if(!i||!Array.isArray(i)||0===i.length)return null;const r=[];for(const s of i){if(!Array.isArray(s)||2!==s.length)continue;const e=s[0],t=s[1];"number"==typeof e&&"number"==typeof t&&r.push(new G(e,t))}if(r.length<3)return null;r.length>1&&r[r.length-1].equals(r[0])&&r.pop();let n=0;for(let s=0;s<r.length;s++){const e=r[s],t=r[(s+1)%r.length],i=r[(s+2)%r.length];n+=(e.x-t.x)*(i.y-t.y)-(i.x-t.x)*(e.y-t.y)}n>0&&r.reverse();const o=hu(r.flatMap((e=>[e.x,e.y])),[]);return 0===o.length?null:{vertices:r,indices:o}}function nv(e,t){const i=[],r=[];let n=0;const o=[];for(const s of e){n=i.length;const e=s.vertexArray.float32,a=s.indexArray.uint16;for(let r=0;r<s.vertexArray.length;r++)o[0]=e[3*r+0],o[1]=e[3*r+1],o[2]=e[3*r+2],N.vec3.transformMat4(o,o,t),i.push(new G(o[0],o[1]));for(let t=0;t<3*s.indexArray.length;t++)r.push(a[t]+n)}if(r.length%3!=0)return null;for(let s=0;s<r.length;s+=3){const e=i[r[s+0]],t=i[r[s+1]],n=i[r[s+2]];(e.x-t.x)*(n.y-t.y)-(n.x-t.x)*(e.y-t.y)>0&&([r[s+1],r[s+2]]=[r[s+2],r[s+1]])}return{vertices:i,indices:r}}function ov(e){const t=function(e,t){const i=[],r=WebGL2RenderingContext;if(e.json.textures)for(const n of e.json.textures){const o={magFilter:r.LINEAR,minFilter:r.NEAREST,wrapS:r.REPEAT,wrapT:r.REPEAT};void 0!==n.sampler&&Object.assign(o,e.json.samplers[n.sampler]),i.push({image:t[n.source],sampler:o,uploaded:!1})}return i}(e,e.images),i=function(e,t){const i=[];for(const r of e.json.meshes){const n=[];for(const i of r.primitives)n.push(ev(i,e,t));i.push(n)}return i}(e,t),{scenes:r,scene:n,nodes:o}=e.json,s=r?r[n||0].nodes:o,a=[];for(const l of s)a.push(tv(o[l],e,i));return function(e,t,i){const r={},n=new Set;for(let o=0;o<e.length;o++){const e=i[t[o]];if(!e.extras)continue;const s=e.extras["mapbox:footprint:version"],a=e.extras["mapbox:footprint:id"];(s||a)&&n.add(o),"1.0.0"===s&&a&&(r[a]=o)}for(let o=0;o<e.length;o++){if(n.has(o))continue;const s=e[o],a=i[t[o]];if(!a.extras)continue;let l=null;s.id in r&&(l=nv(e[r[s.id]].meshes,s.matrix)),l||(l=rv(a)),l&&(s.footprint=iv(l))}if(n.size>0){const t=Array.from(n.values()).sort(((e,t)=>e-t));for(let i=t.length-1;i>=0;i--)e.splice(t[i],1)}}(a,s,e.json.nodes),a}function sv(e){e.heightmap=new Float32Array(4096),e.heightmap.fill(-1);const t=e.vertexArray.float32,i=e.aabb.min[0]-1,r=e.aabb.min[1]-1,n=tg/(e.aabb.max[0]-i+2),o=tg/(e.aabb.max[1]-r+2);for(let s=0;s<t.length;s+=3){const a=t[s+2],l=(t[s+0]-i)*n|0,c=(t[s+1]-r)*o|0;a>e.heightmap[c*tg+l]&&(e.heightmap[c*tg+l]=a)}}function av(e,t){const i={};i.indexArray=new Fs,i.indexArray.reserve(4*e.length),i.vertexArray=new Ts,i.vertexArray.reserve(10*e.length),i.colorArray=new ks,i.vertexArray.reserve(10*e.length);let r=0;for(const s of e){const e=Math.min(10,Math.max(4,1.3*s.height))*t,n=[-s.normal[1],s.normal[0],0],o=Math.min(.29,.1*s.width/s.depth),a=s.width-2*s.depth*t*(o+.01),l=N.vec3.scaleAndAdd([],s.pos,n,a/2),c=N.vec3.scaleAndAdd([],s.pos,n,-a/2),u=[l[0],l[1],l[2]+s.height],h=[c[0],c[1],c[2]+s.height],d=N.vec3.scaleAndAdd([],s.normal,n,o);N.vec3.scale(d,d,e);const p=N.vec3.scaleAndAdd([],s.normal,n,-o);N.vec3.scale(p,p,e),N.vec3.add(d,l,d),N.vec3.add(p,c,p),l[2]+=.1,c[2]+=.1,i.vertexArray.emplaceBack(d[0],d[1],d[2]),i.vertexArray.emplaceBack(p[0],p[1],p[2]),i.vertexArray.emplaceBack(l[0],l[1],l[2]),i.vertexArray.emplaceBack(c[0],c[1],c[2]),i.vertexArray.emplaceBack(u[0],u[1],u[2]),i.vertexArray.emplaceBack(h[0],h[1],h[2]),i.vertexArray.emplaceBack(l[0],l[1],l[2]),i.vertexArray.emplaceBack(c[0],c[1],c[2]),i.vertexArray.emplaceBack(d[0],d[1],d[2]),i.vertexArray.emplaceBack(p[0],p[1],p[2]);const f=a/e/2;i.colorArray.emplaceBack(-f-o,-1,f,.8),i.colorArray.emplaceBack(f+o,-1,f,.8),i.colorArray.emplaceBack(-f,0,f,1.3),i.colorArray.emplaceBack(f,0,f,1.3),i.colorArray.emplaceBack(f+o,-.8,f,.7),i.colorArray.emplaceBack(f+o,-.8,f,.7),i.colorArray.emplaceBack(0,0,f,1.3),i.colorArray.emplaceBack(0,0,f,1.3),i.colorArray.emplaceBack(f+o,-1.2,f,.8),i.colorArray.emplaceBack(f+o,-1.2,f,.8),i.indexArray.emplaceBack(6+r,4+r,8+r),i.indexArray.emplaceBack(7+r,9+r,5+r),i.indexArray.emplaceBack(0+r,1+r,2+r),i.indexArray.emplaceBack(1+r,3+r,2+r),r+=10}const n={defined:!0,emissiveFactor:[0,0,0]},o={};return o.baseColorFactor=At.white,n.pbrMetallicRoughness=o,i.material=n,i.aabb=new _c([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),i}class lv{constructor(e){this._stringToNumber={},this._numberToString=[];for(let t=0;t<e.length;t++){const i=e[t];this._stringToNumber[i]=t,this._numberToString[t]=i}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const cv=["id","tile","layer","source","sourceLayer","state"];class uv{constructor(e,t,i,r,n){this.type="Feature",this._vectorTileFeature=e,this._z=t,this._x=i,this._y=r,this.properties=e.properties,this.id=n}clone(){const e=new uv(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(e.state=Object.assign({},this.state)),this.layer&&(e.layer=Object.assign({},this.layer)),this.source&&(e.source=this.source),this.sourceLayer&&(e.sourceLayer=this.sourceLayer),e}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const t of cv)void 0!==this[t]&&(e[t]=this[t]);return e}}class hv{constructor(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new oo(Zi,16,0),this.featureIndexArray=new aa,this.promoteId=t,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(e,t,i,r,n){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;const a=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,r,n,o);const l=this.grid;for(let c=0;c<t.length;c++){const e=t[c],i=[1/0,1/0,-1/0,-1/0];for(let t=0;t<e.length;t++){const r=e[t];i[0]=Math.min(i[0],r.x),i[1]=Math.min(i[1],r.y),i[2]=Math.max(i[2],r.x),i[3]=Math.max(i[3],r.y)}0!==s&&(i[0]-=s,i[1]-=s,i[2]+=s,i[3]+=s),i[0]<Zi&&i[1]<Zi&&i[2]>=0&&i[3]>=0&&l.insert(a,i[0],i[1],i[2],i[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new ph.VectorTile(new hp(this.rawTileData)).layers,this.sourceLayerCoder=new lv(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,t){var i=this;const{tilespaceGeometry:r,transform:n,tileTransform:o,pixelPosMatrix:s,availableImages:a}=t;this.loadVTLayers(),this.serializedLayersCache.clear();const l=r.bufferedTilespaceBounds,c=this.grid.query(l.min.x,l.min.y,l.max.x,l.max.y,((e,t,i,n)=>Gl(r.bufferedTilespaceGeometry,e,t,i,n)));c.sort(pv);let u=null;n.elevation&&c.length>0&&(u=cg.create(n.elevation,this.tileID));const h={};let d;for(let p=0;p<c.length;p++){const t=c[p];if(t===d)continue;d=t;const l=this.featureIndexArray.get(t);let f=null;this.is3DTile?this.loadMatchingModelFeature(h,l,e,r,n):this.loadMatchingFeature(h,l,e,a,(function(e,t,a){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return f||(f=El(e,i.tileID.canonical,o)),t.queryIntersectsFeature(r,e,a,f,i.z,n,s,u,l)}))}return h}loadMatchingFeature(e,t,i,r,n){const{featureIndex:o,bucketIndex:s,sourceLayerIndex:a,layoutVertexArrayOffset:l}=t,c=this.bucketLayerIDs[s],u=i.layers,h=Object.keys(u);if(h.length&&!function(e,t){for(let i=0;i<e.length;i++)if(t.indexOf(e[i])>=0)return!0;return!1}(h,c))return;const d=i.sourceCache,p=this.sourceLayerCoder.decode(a),f=this.vtLayers[p].feature(o),m=this.getId(f,p);for(let g=0;g<c.length;g++){const t=c[g];if(!u[t])continue;const{styleLayer:i,targets:s}=u[t];let a={};void 0!==m&&(a=d.getFeatureState(i.sourceLayer,m));const h=!n||n(f,i,a,l);if(!h)continue;const p=new uv(f,this.z,this.x,this.y,m);p.tile=this.tileID.canonical,p.state=a;let y=this.serializedLayersCache.get(t);y||(y=i.serialize(),y.id=t,this.serializedLayersCache.set(t,y)),p.source=y.source,p.sourceLayer=y["source-layer"],p.layer=re({},y),p.layer.paint=dv(y.paint,i.paint,f,a,r),p.layer.layout=dv(y.layout,i.layout,f,a,r);let _=!1;for(const e of s){this.updateFeatureProperties(p,e);const{filter:t}=e;if(t)if(f.properties=p.properties,t.needGeometry){const e=Pl(f,!0);if(!t.filter(new Ro(this.tileID.overscaledZ),e,this.tileID.canonical))continue}else if(!t.filter(new Ro(this.tileID.overscaledZ),f))continue;_=!0,e.targetId&&this.addFeatureVariant(p,e)}_&&this.appendToResult(e,t,o,p,h)}}loadMatchingModelFeature(e,t,i,r,n){const o=this.bucketLayerIDs[0][0],s=i.layers;if(!s[o])return;const{styleLayer:a,targets:l}=s[o];if("model"!==a.type)return;const c=r.tile,u=t.featureIndex,h=c.getBucket(a);if(!(h&&h instanceof gg))return;const d=function(e,t,i,r){const n=e.getNodesInfo()[t];if(n.hiddenByReplacement||!n.node.meshes)return;let o=Number.MAX_VALUE;const s=n.node,a=i.tile,l=r.calculatePosMatrix(a.tileID.toUnwrapped(),r.worldSize),c=n.evaluatedScale;let u=0;r.elevation&&s.elevation&&(u=s.elevation*r.elevation.exaggeration()),N.mat4.translate(l,l,[(s.anchor?s.anchor[0]:0)*(c[0]-1),(s.anchor?s.anchor[1]:0)*(c[1]-1),u]),N.mat4.scale(l,l,c);const h=i.queryGeometry,d=h.isPointQuery()?h.screenBounds:h.screenGeometry,p=function(e){const t=N.mat4.multiply([],l,e.matrix);N.mat4.multiply(t,r.expandedFarZProjMatrix,t);for(let i=0;i<e.meshes.length;++i){const n=e.meshes[i];if(i===e.lightMeshIndex)continue;const s=Nm(d,r,t,n.aabb);null!=s&&(o=Math.min(s,o))}if(e.children)for(const i of e.children)p(i)};if(p(s),o===Number.MAX_VALUE)return;const f=new nl(0,0);return xg(a.tileID.canonical,f,n.node.anchor[0],n.node.anchor[1]),{intersectionZ:o,position:f,feature:n.feature}}(h,u,r,n);if(!d)return;const{z:p,x:f,y:m}=c.tileID.canonical,{feature:g,intersectionZ:y,position:_}=d;let v={};void 0!==g.id&&(v=i.sourceCache.getFeatureState(a.sourceLayer,g.id));const x=new uv({},p,f,m,g.id);x.tile=this.tileID.canonical,x.state=v,x.properties=g.properties,x.geometry={type:"Point",coordinates:[_.lng,_.lat]};let b=this.serializedLayersCache.get(o);b||(b=a.serialize(),b.id=o,this.serializedLayersCache.set(o,b)),x.source=b.source,x.sourceLayer=b["source-layer"],x.layer=re({},b);let w=!1;for(const S of l){this.updateFeatureProperties(x,S);const{filter:e}=S;if(e)if(g.properties=x.properties,e.needGeometry){if(!e.filter(new Ro(this.tileID.overscaledZ),g,this.tileID.canonical))continue}else if(!e.filter(new Ro(this.tileID.overscaledZ),g))continue;w=!0,S.targetId&&this.addFeatureVariant(x,S)}w&&this.appendToResult(e,o,u,x,y)}updateFeatureProperties(e,t,i){if(t.properties){const r={};for(const n in t.properties){const o=t.properties[n].evaluate({zoom:this.z},e._vectorTileFeature,e.state,e.tile,i);null!=o&&(r[n]=o)}e.properties=r}}addFeatureVariant(e,t,i){const r={target:t.target,namespace:t.namespace,uniqueFeatureID:t.uniqueFeatureID};t.properties&&(r.properties=e.properties),e.variants=e.variants||{},e.variants[t.targetId]=e.variants[t.targetId]||[],e.variants[t.targetId].push(r)}appendToResult(e,t,i,r,n){let o=e[t];void 0===o&&(o=e[t]=[]),o.push({featureIndex:i,feature:r,intersectionZ:n})}lookupSymbolFeatures(e,t,i,r,n){const o={};this.loadVTLayers();for(const s of e)this.loadMatchingFeature(o,{bucketIndex:t,sourceLayerIndex:i,featureIndex:s,layoutVertexArrayOffset:0},r,n);return o}loadFeature(e){const{featureIndex:t,sourceLayerIndex:i}=e;this.loadVTLayers();const r=this.sourceLayerCoder.decode(i),n=this.vtFeatures[r];if(n[t])return n[t];const o=this.vtLayers[r].feature(t);return n[t]=o,o}hasLayer(e){for(const t of this.bucketLayerIDs)for(const i of t)if(e===i)return!0;return!1}getId(e,t){let i=e.id;if(this.promoteId){const r=Array.isArray(this.promoteId)||"object"!=typeof this.promoteId?this.promoteId:this.promoteId[t];if(null!=r)if(Array.isArray(r)){if(!this.promoteIdExpression){const e=Zn(r);if("success"!==e.result)return void pe(`Failed to create expression for promoteId: ${e.value.map((e=>`${e.key}: ${e.message}`)).join(", ")}`);this.promoteIdExpression=e.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new mi),i=this.promoteIdExpression.evaluate({zoom:0},e)}else i=e.properties[r];"boolean"==typeof i&&(i=Number(i))}return i}}function dv(e,t,i,r,n){return ce(e,((e,o)=>{const s=t instanceof Uo?t.get(o):null;return s&&s.evaluate?s.evaluate(i,r,n):s}))}function pv(e,t){return t-e}ao(hv,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const fv=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class mv{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[t,i]=new Uint8Array(e,0,2);if(219!==t)throw new Error("Data does not appear to be in a KDBush format.");const r=i>>4;if(1!==r)throw new Error(`Got v${r} data when expected v1.`);const n=fv[15&i];if(!n)throw new Error("Unrecognized array type.");const[o]=new Uint16Array(e,2,1),[s]=new Uint32Array(e,4,1);return new mv(s,o,n,e)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Float64Array,r=arguments.length>3?arguments[3]:void 0;if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.ArrayType=i,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const n=fv.indexOf(this.ArrayType),o=2*e*this.ArrayType.BYTES_PER_ELEMENT,s=e*this.IndexArrayType.BYTES_PER_ELEMENT,a=(8-s%8)%8;if(n<0)throw new Error(`Unexpected typed array class: ${i}.`);r&&r instanceof ArrayBuffer?(this.data=r,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+s+a,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+o+s+a),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+s+a,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+n]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e)}add(e,t){const i=this._pos>>1;return this.ids[i]=i,this.coords[this._pos++]=e,this.coords[this._pos++]=t,i}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return gv(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,t,i,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:n,coords:o,nodeSize:s}=this,a=[0,n.length-1,0],l=[];for(;a.length;){const c=a.pop()||0,u=a.pop()||0,h=a.pop()||0;if(u-h<=s){for(let s=h;s<=u;s++){const a=o[2*s],c=o[2*s+1];a>=e&&a<=i&&c>=t&&c<=r&&l.push(n[s])}continue}const d=h+u>>1,p=o[2*d],f=o[2*d+1];p>=e&&p<=i&&f>=t&&f<=r&&l.push(n[d]),(0===c?e<=p:t<=f)&&(a.push(h),a.push(d-1),a.push(1-c)),(0===c?i>=p:r>=f)&&(a.push(d+1),a.push(u),a.push(1-c))}return l}within(e,t,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:r,coords:n,nodeSize:o}=this,s=[0,r.length-1,0],a=[],l=i*i;for(;s.length;){const c=s.pop()||0,u=s.pop()||0,h=s.pop()||0;if(u-h<=o){for(let i=h;i<=u;i++)xv(n[2*i],n[2*i+1],e,t)<=l&&a.push(r[i]);continue}const d=h+u>>1,p=n[2*d],f=n[2*d+1];xv(p,f,e,t)<=l&&a.push(r[d]),(0===c?e-i<=p:t-i<=f)&&(s.push(h),s.push(d-1),s.push(1-c)),(0===c?e+i>=p:t+i>=f)&&(s.push(d+1),s.push(u),s.push(1-c))}return a}}function gv(e,t,i,r,n,o){if(n-r<=i)return;const s=r+n>>1;yv(e,t,s,r,n,o),gv(e,t,i,r,s-1,1-o),gv(e,t,i,s+1,n,1-o)}function yv(e,t,i,r,n,o){for(;n>r;){if(n-r>600){const s=n-r+1,a=i-r+1,l=Math.log(s),c=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*c*(s-c)/s)*(a-s/2<0?-1:1);yv(e,t,i,Math.max(r,Math.floor(i-a*c/s+u)),Math.min(n,Math.floor(i+(s-a)*c/s+u)),o)}const s=t[2*i+o];let a=r,l=n;for(_v(e,t,r,i),t[2*n+o]>s&&_v(e,t,r,n);a<l;){for(_v(e,t,a,l),a++,l--;t[2*a+o]<s;)a++;for(;t[2*l+o]>s;)l--}t[2*r+o]===s?_v(e,t,r,l):(l++,_v(e,t,l,n)),l<=i&&(r=l+1),i<=l&&(n=l-1)}}function _v(e,t,i,r){vv(e,i,r),vv(t,2*i,2*r),vv(t,2*i+1,2*r+1)}function vv(e,t,i){const r=e[t];e[t]=e[i],e[i]=r}function xv(e,t,i,r){const n=e-i,o=t-r;return n*n+o*o}e.$=Zo,e.A=ei,e.B=2,e.C=Gp,e.D=Eg,e.E=wt,e.F=Vp,e.G=class extends Xm{},e.H=hi,e.I=Ty,e.J=It,e.K=Xo,e.L=Nn,e.M=On,e.N=Bn,e.O=Yn,e.P=G,e.Q=Yo,e.R=et,e.S=Qn,e.T=fm,e.U=Zn,e.V=Xm,e.W=Ir,e.X=Lr,e.Y=kr,e.Z=gi,e._=Mt,e.a=function(e){return Me.API_CDN_URL_REGEX.test(e)},e.a$=uv,e.a0=jn,e.a1=Fn,e.a2=function(e){const t=e.value;let i=[];if(!t)return i;const r=hi(t);return"string"!==r?(i=i.concat([new Xm(e.key,t,`string expected, "${r}" found`)]),i):(Ym(t,!0)||(i=i.concat([new Xm(e.key,t,`invalid url "${t}"`)])),i)},e.a3=qo,e.a4=Fo,e.a5=$o,e.a6=Go,e.a7=class{constructor(e){this.specification=e}possiblyEvaluate(e,t){return ge(e.expression.evaluate(t))}interpolate(e,t,i){return{x:Et(e.x,t.x,i),y:Et(e.y,t.y,i),z:Et(e.z,t.z,i),azimuthal:Et(e.azimuthal,t.azimuthal,i),polar:Et(e.polar,t.polar,i)}}},e.a8=Ro,e.a9=Jn,e.aA=ul,e.aB=class{constructor(e){this.entries={},this.scheduler=e}request(e,t,i,r){const n=this.entries[e]=this.entries[e]||{callbacks:[]};if(n.result){const[e,i]=n.result;return this.scheduler?this.scheduler.add((()=>{r(e,i)}),t):r(e,i),()=>{}}return n.callbacks.push(r),n.cancel||(n.cancel=i(((i,r)=>{n.result=[i,r];for(const e of n.callbacks)this.scheduler?this.scheduler.add((()=>{e(i,r)}),t):e(i,r);setTimeout((()=>delete this.entries[e]),3e3)}))),()=>{n.result||(n.callbacks=n.callbacks.filter((e=>e!==r)),n.callbacks.length||(n.cancel(),delete this.entries[e]))}}},e.aC=us,e.aD=function(e,t,i){const r=JSON.stringify(e.request);return e.data&&(this.deduped.entries[r]={result:[null,e.data]}),this.deduped.request(r,{type:"parseTile",isSymbolTile:e.isSymbolTile,zoom:e.tileZoom},(t=>{const r=nt(e.request,((e,r,n,o)=>{e?t(e):r&&t(null,{vectorTile:i?void 0:new ph.VectorTile(new hp(r)),rawData:r,cacheControl:n,expires:o})}));return()=>{r.cancel(),t()}}),t)},e.aE=function(e){$e++,$e>je&&(e.getActor().send("enforceCacheSizeLimit",Ne),$e=0)},e.aF=function(e){return e<=1?1:Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},e.aG=nc,e.aH=bm,e.aI=Cm,e.aJ=vm,e.aK=function(e,t){const i=document.createElement("video");i.muted=!0,i.onloadstart=function(){t(null,i)};for(let r=0;r<e.length;r++){const t=document.createElement("source");ot(e[r])||(i.crossOrigin="Anonymous"),t.src=e[r],i.appendChild(t)}return{cancel:()=>{}}},e.aL=mm,e.aM=function(e){return fetch(e).then((e=>e.arrayBuffer())).then((t=>K_(t,0,e)))},e.aN=ov,e.aO=class{constructor(e,t,i,r){this.id=e,this.position=null!=t?new nl(t[0],t[1]):new nl(0,0),this.orientation=null!=i?i:[0,0,0],this.nodes=r,this.uploaded=!1,this.aabb=new _c([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(e,t){if(N.mat4.multiply(e.matrix,t,e.matrix),e.meshes)for(const i of e.meshes){const t=_c.applyTransformFast(i.aabb,e.matrix);this.aabb.encapsulate(t)}if(e.children)for(const i of e.children)this._applyTransformations(i,e.matrix)}computeBoundsAndApplyParent(){const e=N.mat4.identity([]);for(const t of this.nodes)this._applyTransformations(t,e)}computeModelMatrix(e,t,i,r,n,o){let s=arguments.length>6&&void 0!==arguments[6]&&arguments[6];rg(this.matrix,this,e.transform,this.position,t,i,r,n,o,s)}upload(e){if(!this.uploaded){for(const t of this.nodes)sg(t,e);for(const e of this.nodes)ag(e);this.uploaded=!0}}destroy(){for(const e of this.nodes)lg(e)}},e.aP=ae,e.aQ=wf,e.aR=dl,e.aS=pl,e.aT=bs,e.aU=Fs,e.aV=oe,e.aW=Qs,e.aX=em,e.aY=function(){Lo.isLoading()||Lo.isLoaded()||"deferred"!==Io()||Do()},e.aZ=Ko,e.a_=Pl,e.aa=xl,e.ab=N,e.ac=ee,e.ad=Uo,e.ae=Bc,e.af=Et,e.ag=Zi,e.ah=Pt,e.ai=q,e.aj=At,e.ak=class{constructor(e){this.specification=e}possiblyEvaluate(e,t){return function(e){let[t,i]=e;const r=ge([1,t,i]);return{x:r.x,y:r.y,z:r.z}}(e.expression.evaluate(t))}interpolate(e,t,i){return{x:Et(e.x,t.x,i),y:Et(e.y,t.y,i),z:Et(e.z,t.z,i)}}},e.al=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const n=new G(i,i),o=e.sub(n),s=t.add(n),a=[o,new G(s.x,o.y),s,new G(o.x,s.y)];return r&&a.push(o.clone()),a},e.am=function(e,t){const i=[];for(let r=0;r<e.length;r++){const n=te(r-1,-1,e.length-1),o=te(r+1,-1,e.length-1),s=e[r],a=e[o],l=e[n].sub(s).unit(),c=a.sub(s).unit(),u=c.angleWithSep(l.x,l.y),h=l.add(c).unit().mult(-1*t/Math.sin(u/2));i.push(s.add(h))}return i},e.an=Sf,e.ao=Gl,e.ap=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return N.vec3.fromValues(((t.x-i)*e.scale-e.x)*Zi,(t.y*e.scale-e.y)*Zi,fl(t.z,t.y))},e.aq=hc,e.ar=Ed,e.as=function(e){let t=1/0,i=1/0,r=-1/0,n=-1/0;for(const o of e)t=Math.min(t,o.x),i=Math.min(i,o.y),r=Math.max(r,o.x),n=Math.max(n,o.y);return{min:new G(t,i),max:new G(r,n)}},e.at=cl,e.au=Ul,e.av=wl,e.aw=Q,e.ax=$a,e.ay=function(e,t){const i={};for(let r=0;r<t.length;r++){const n=t[r];n in e&&(i[n]=e[n])}return i},e.az=ol,e.b=function(e){return Me.API_FONTS_REGEX.test(e)},e.b$=Dm,e.b0=_e,e.b1=Td,e.b2=Vu,e.b3=El,e.b4=vs,e.b5=qs,e.b6=uc,e.b7=pa,e.b8=hu,e.b9=hm,e.bA=kh,e.bB=df,e.bC=hf,e.bD=Ep,e.bE=mv,e.bF=te,e.bG=xe,e.bH=hl,e.bI=function(e,t,i){e[4*t+0]=i[0],e[4*t+1]=i[1],e[4*t+2]=i[2],e[4*t+3]=i[3]},e.bJ=Pa,e.bK=Ta,e.bL=Ma,e.bM=Sa,e.bN=wa,e.bO=nl,e.bP=Hf,e.bQ=rc,e.bR=yc,e.bS=Im,e.bT=ic,e.bU=Cc,e.bV=function(e,t,i,r,n,o,s,a,l){if("globe"===l.name)return Cc(e,t,new ic(i,r,n),!1);const c=wf({z:i,x:r,y:n},l);return new _c([(o+c.x/c.scale)*t,t*(c.y/c.scale),s],[(o+c.x2/c.scale)*t,t*(c.y2/c.scale),a])},e.bW=function(e,t,i){let r=0;for(let n=0;n<2;++n){const i=0;e[n]>i&&(r+=(e[n]-i)*(e[n]-i)),t[n]<i&&(r+=(i-t[n])*(i-t[n]))}return r},e.bX=ml,e.bY=Xa,e.bZ=function(e){const t=N.mat4.identity(new Float64Array(16));N.mat4.multiply(t,e.pixelMatrix,e.globeMatrix);const i=[0,Ja,0],r=[0,Qa,0];return N.vec3.transformMat4(i,i,t),N.vec3.transformMat4(r,r,t),[i[0]>0&&i[0]<=e.width&&i[1]>0&&i[1]<=e.height&&!jc(e,new nl(e.center.lat,90)),r[0]>0&&r[0]<=e.width&&r[1]>0&&r[1]<=e.height&&!jc(e,new nl(e.center.lat,-90))]},e.b_=function(e,t){const{scale:i}=e.tileTransform,r=i*Zi/(e.tileSize*Math.pow(2,t.zoom-e.tileID.overscaledZ+e.tileID.canonical.z));return N.mat2.scale(new Float32Array(4),t.inverseAdjustmentMatrix,[r,r])},e.ba=function(e,t){const i=Bc(t.zoom);if(0===i)return Tc(e);const r=Ec(e),n=Pc(r),o=cl(r.getWest())*t.worldSize,s=cl(r.getEast())*t.worldSize,a=ul(r.getNorth())*t.worldSize,l=ul(r.getSouth())*t.worldSize,c=[o,a,0],u=[s,a,0],h=[o,l,0],d=[s,l,0],p=N.mat4.invert([],t.globeMatrix);return N.vec3.transformMat4(c,c,p),N.vec3.transformMat4(u,u,p),N.vec3.transformMat4(h,h,p),N.vec3.transformMat4(d,d,p),n[0]=Mc(n[0],h,i),n[1]=Mc(n[1],d,i),n[2]=Mc(n[2],u,i),n[3]=Mc(n[3],c,i),_c.fromPoints(n)},e.bb=Lc,e.bc=kc,e.bd=Mc,e.be=xs,e.bf=cc,e.bg=A_,e.bh=hp,e.bi=nt,e.bj=function(e){const t=[];for(const i in e)t.push(e[i]);return t},e.bk=function(e,t){const i=[];for(const r in e)r in t||i.push(r);return i},e.bl=ie,e.bm=["type","source","source-layer","minzoom","maxzoom","filter","layout"],e.bn=H,e.bo=function(e,t){const{x:i,y:r}=e.point,n=Fc(i,r,e.worldSize/e._pixelsPerMercatorPixel,0,0);return N.mat4.multiply(n,n,Rc(Tc(t)))},e.bp=Qd,e.bq=yp,e.br=Jd,e.bs=function(e,t,i,r,n){const o=5*t+2;e.float32[o+0]=i,e.float32[o+1]=r,e.float32[o+2]=n},e.bt=Zf,e.bu=jp,e.bv=Ll,e.bw=Xd,e.bx=xh,e.by=qm,e.bz=Ph,e.c=Ce,e.c$=(e,t,i,r,n,o,s,a)=>{const l=e.transform,c=l.pitch<15?Pd(.07,.7,Q((14-l.zoom)/5,0,1)):.07,u="none"===i.paint.get("line-trim-color-use-theme").constantOr("default");return{u_matrix:Id(e,t,i,r),u_texsize:t.imageAtlasTexture?t.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:l.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:n,u_width_scale:o,u_floor_width_scale:s,u_image:0,u_tile_units_to_pixels:kd(t,l),u_units_to_pixels:[1/l.pixelsToGLUnits[0],1/l.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:a,u_trim_fade_range:i.paint.get("line-trim-fade-range"),u_trim_color:i.paint.get("line-trim-color").toRenderColor(u?null:i.lut).toArray01(),u_emissive_strength:i.paint.get("line-emissive-strength"),u_zbias_factor:c,u_tile_to_meter:vl(t.tileID.canonical,0)}},e.c0=km,e.c1=function(e){const t=km(e,!0);return N.mat2.invert([],[t[0],t[1],t[4],t[5]])},e.c2=dc,e.c3=function(e){const{x:t,y:i}=e.point,{lng:r,lat:n}=e._center;return Fc(t,i,e.worldSize,r,n)},e.c4=X,e.c5=oc,e.c6=qa,e.c7=function(e){const t=Math.round((e+45+360)%360/90)%4;return Y[t]},e.c8=45,e.c9=ll,e.cA=class extends ba{constructor(e){super(e),this.current=ka}set(e,t,i){if(this.fetchUniformLocation(e,t))for(let r=0;r<9;r++)if(i[r]!==this.current[r]){this.current=i,this.gl.uniformMatrix3fv(this.location,!1,i);break}}},e.cB=Z,e.cC=function(e,t,i){const r=Bc(i.zoom),n=e.style.map._antialias,o=e.terrain&&e.terrain.exaggeration()>0;return 0===r&&!n&&!o},e.cD=function(e){const t=e.pixelsPerMeter,i=t/hl(1,e.center.lat),r=N.mat4.identity(new Float64Array(16));return N.mat4.translate(r,r,[e.point.x,e.point.y,0]),N.mat4.scale(r,r,[i,i,t]),Float32Array.from(r)},e.cE=Ec,e.cF=function(e){const t=ml-5;e=Q(e,-t,t)/t*90;const i=Math.pow(Math.abs(Math.sin(q(e))),3);return Math.round(i*(Ka.length-1))},e.cG=function(e,t,i,r){const n=t.getNorth(),o=t.getSouth(),s=t.getWest(),a=t.getEast(),l=1<<e.z,c=a-s,u=n-o,h=c/Za,d=-u/Ka[i],p=[0,h,0,d,0,0,n,s,0];if(e.z>0){const e=180/r;N.mat3.multiply(p,p,[e/c+1,0,0,0,e/u+1,0,-.5*e/h,.5*e/d,1])}return p[2]=l,p[5]=e.x,p[8]=e.y,p},e.cH=Tc,e.cI=function(e,t,i){const r=N.mat4.identity(new Float64Array(16)),n=(t/(1<<e)-.5)*Math.PI*2;return N.mat4.rotateY(r,i.globeMatrix,n),Float32Array.from(r)},e.cJ=class{isDataAvailableAtPoint(e){const t=this._source();if(this.isUsingMockSource()||!t||e.y<0||e.y>1)return!1;const i=t.getSource().maxzoom,r=1<<i,n=Math.floor(e.x),o=Math.floor((e.x-n)*r),s=Math.floor(e.y*r),a=this.findDEMTileFor(new nc(i,n,i,o,s));return!(!a||!a.dem)}getAtPointOrZero(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.getAtPoint(e,t)||0}getAtPoint(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.isUsingMockSource())return null;null==t&&(t=null);const r=this._source();if(!r)return t;if(e.y<0||e.y>1)return t;const n=r.getSource().maxzoom,o=1<<n,s=Math.floor(e.x),a=e.x-s,l=new nc(n,s,n,Math.floor(a*o),Math.floor(e.y*o)),c=this.findDEMTileFor(l);if(!c||!c.dem)return t;const u=c.dem,h=1<<c.tileID.canonical.z,d=(a*h-c.tileID.canonical.x)*u.dim,p=(e.y*h-c.tileID.canonical.y)*u.dim,f=Math.floor(d),m=Math.floor(p);return(i?this.exaggeration():1)*Et(Et(u.get(f,m),u.get(f,m+1),p-m),Et(u.get(f+1,m),u.get(f+1,m+1),p-m),d-f)}getAtTileOffset(e,t,i){const r=1<<e.canonical.z;return this.getAtPointOrZero(new xl(e.wrap+(e.canonical.x+t/Zi)/r,(e.canonical.y+i/Zi)/r))}getAtTileOffsetFunc(e,t,i,r){return n=>{const o=this.getAtTileOffset(e,n.x,n.y),s=r.upVector(e.canonical,n.x,n.y),a=r.upVectorScale(e.canonical,t,i).metersToTile;return N.vec3.scale(s,s,o*a),s}}getForTilePoints(e,t,i,r){if(this.isUsingMockSource())return!1;const n=cg.create(this,e,r);return!!n&&(t.forEach((e=>{e[2]=this.exaggeration()*n.getElevationAt(e[0],e[1],i)})),!0)}getMinMaxForTile(e){if(this.isUsingMockSource())return null;const t=this.findDEMTileFor(e);if(!t||!t.dem)return null;const i=t.dem.tree,r=t.tileID,n=1<<e.canonical.z-r.canonical.z;let o=e.canonical.x/n-r.canonical.x,s=e.canonical.y/n-r.canonical.y,a=0;for(let l=0;l<e.canonical.z-r.canonical.z&&!i.leaves[a];l++){o*=2,s*=2;const e=2*Math.floor(s)+Math.floor(o);a=i.childOffsets[a]+e,o%=1,s%=1}return{min:this.exaggeration()*i.minimums[a],max:this.exaggeration()*i.maximums[a]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(e,t,i){throw new Error("Pure virtual method called.")}pointCoordinate(e){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(e){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const e=this.visibleDemTiles;if(0===e.length)return null;let t=!1,i=Number.MAX_VALUE,r=Number.MIN_VALUE;for(const n of e){const e=this.getMinMaxForTile(n.tileID);e&&(i=Math.min(i,e.min),r=Math.max(r,e.max),t=!0)}return t?{min:i,max:r}:null}},e.cK=au,e.cL=vc,e.cM=function(e,t){return[Math.pow(e[0],2.2)*t,Math.pow(e[1],2.2)*t,Math.pow(e[2],2.2)*t]},e.cN=Oc,e.cO=Te,e.cP=Se,e.cQ=256,e.cR=function(e,t){const i=[0,0,0],r=Lc(Tc(t.canonical));return N.vec3.transformMat4(i,i,r),N.vec3.transformMat4(i,i,e),i},e.cS=e=>({u_camera_to_center_distance:new Sa(e),u_extrude_scale:new Da(e),u_device_pixel_ratio:new Sa(e),u_matrix:new Pa(e),u_inv_rot_matrix:new Pa(e),u_merc_center:new Ta(e),u_tile_id:new Ma(e),u_zoom_transition:new Sa(e),u_up_dir:new Ma(e),u_emissive_strength:new Sa(e)}),e.cT=e=>({u_matrix:new Pa(e),u_pixels_to_tile_units:new Da(e),u_device_pixel_ratio:new Sa(e),u_width_scale:new Sa(e),u_floor_width_scale:new Sa(e),u_units_to_pixels:new Ta(e),u_dash_image:new wa(e),u_gradient_image:new wa(e),u_image_height:new Sa(e),u_texsize:new Ta(e),u_tile_units_to_pixels:new Sa(e),u_alpha_discard_threshold:new Sa(e),u_trim_offset:new Ta(e),u_trim_fade_range:new Ta(e),u_trim_color:new Aa(e),u_emissive_strength:new Sa(e),u_zbias_factor:new Sa(e),u_tile_to_meter:new Sa(e)}),e.cU=e=>({u_matrix:new Pa(e),u_texsize:new Ta(e),u_pixels_to_tile_units:new Da(e),u_device_pixel_ratio:new Sa(e),u_width_scale:new Sa(e),u_floor_width_scale:new Sa(e),u_image:new wa(e),u_units_to_pixels:new Ta(e),u_tile_units_to_pixels:new Sa(e),u_alpha_discard_threshold:new Sa(e),u_trim_offset:new Ta(e),u_trim_fade_range:new Ta(e),u_trim_color:new Aa(e),u_emissive_strength:new Sa(e),u_zbias_factor:new Sa(e),u_tile_to_meter:new Sa(e)}),e.cV=zs,e.cW=qd,e.cX=ep,e.cY=Wc,e.cZ=(e,t,i,r,n,o)=>{const s=e.transform,a="globe"===s.projection.name;let l;if("map"===o.paint.get("circle-pitch-alignment"))if(a){const e=Oc(s.zoom,t.canonical)*s._pixelsPerMercatorPixel;l=Float32Array.from([e,0,0,e])}else l=s.calculatePixelsToTileUnitsMatrix(i);else l=new Float32Array([s.pixelsToGLUnits[0],0,0,s.pixelsToGLUnits[1]]);const c={u_camera_to_center_distance:e.transform.getCameraToCenterDistance(s.projection),u_matrix:e.translatePosMatrix(t.projMatrix,i,o.paint.get("circle-translate"),o.paint.get("circle-translate-anchor")),u_device_pixel_ratio:ze.devicePixelRatio,u_extrude_scale:l,u_inv_rot_matrix:Hc,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:o.paint.get("circle-emissive-strength")};if(a){c.u_inv_rot_matrix=r,c.u_merc_center=n,c.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],c.u_zoom_transition=Bc(s.zoom);const e=n[0]*Zi,i=n[1]*Zi;c.u_up_dir=s.projection.upVector(new ic(0,0,0),e,i)}return c},e.c_=Dd,e.ca=Aa,e.cb=function(e,t,i){const r=Math.sqrt(e*e+t*t+i*i),n=r>0?Math.acos(i/r)*$:0;let o=0!==e||0!==t?Math.atan2(-t,-e)*$+90:0;return o<0&&(o+=360),[r,o,n]},e.cc=vl,e.cd=_c,e.ce=ge,e.cf=function(e){return[Math.pow(e[0],1/2.2),Math.pow(e[1],1/2.2),Math.pow(e[2],1/2.2)]},e.cg=function(e,t){return e.readFields(Ng,{icons:[]},t)},e.ch=function(e){return e({pluginStatus:Ao,pluginURL:Co}),ko.on("pluginStateChange",e),e},e.ci=Ig,e.cj=Zp,e.ck=Yp,e.cl=it,e.cm=Eo,e.cn=Fe,e.co=yt,e.cp=he,e.cq=function(e){const t=e.indexOf(cs);return t>=0?e.slice(0,t):e},e.cr=function(e){return e.indexOf(cs)>=0},e.cs=function(e){const t=e.indexOf(cs);return t>=0?e.slice(t+1):""},e.ct=function(e){const t=[],i=e.id;return void 0===i&&t.push({message:`layers.${i}: missing required property "id"`}),void 0===e.render&&t.push({message:`layers.${i}: missing required method "render"`}),e.renderingMode&&"2d"!==e.renderingMode&&"3d"!==e.renderingMode&&t.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),t},e.cu=function(e,t,i,r){return"custom"===e.type?new Em(e,t):new bg[e.type](e,t,i,r)},e.cv=ue,e.cw=class extends uv{constructor(e,t){super(e._vectorTileFeature,e._z,e._x,e._y,e.id),e.state&&(this.state=Object.assign({},e.state)),this.target=t.target,this.namespace=t.namespace,t.properties&&(this.properties=t.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=e.source,this.sourceLayer=e.sourceLayer,this.layer=e.layer)}toJSON(){const e=super.toJSON();return e.target=this.target,e.namespace=this.namespace,e}},e.cx=ko,e.cy=rt,e.cz=Ca,e.d=function(e){return Me.API_TILEJSON_REGEX.test(e)},e.d$=hv,e.d0=(e,t,i,r,n,o,s,a,l)=>{const c=e.transform,u=c.calculatePixelsToTileUnitsMatrix(t),h="none"===i.paint.get("line-trim-color-use-theme").constantOr("default"),d=c.pitch<15?Pd(.07,.7,Q((14-c.zoom)/5,0,1)):.07;return{u_matrix:Id(e,t,i,r),u_pixels_to_tile_units:u,u_device_pixel_ratio:o,u_width_scale:s,u_floor_width_scale:a,u_units_to_pixels:[1/c.pixelsToGLUnits[0],1/c.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:n,u_texsize:Ld(i)&&t.lineAtlasTexture?t.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:kd(t,e.transform),u_alpha_discard_threshold:0,u_trim_offset:l,u_trim_fade_range:i.paint.get("line-trim-fade-range"),u_trim_color:i.paint.get("line-trim-color").toRenderColor(h?null:i.lut).toArray01(),u_emissive_strength:i.paint.get("line-emissive-strength"),u_zbias_factor:d,u_tile_to_meter:vl(t.tileID.canonical,0)}},e.d1=se,e.d2=lu,e.d3=od,e.d4=sc,e.d5=Kh,e.d6=Nh,e.d7=450,e.d8=7,e.d9=xm,e.dA=J,e.dB=_l,e.dC=tl,e.dD=function(e){let[t,i,r]=e;const n=Math.hypot(t,i,r),o=Math.atan2(t,r),s=.5*Math.PI-Math.acos(-i/n);return new nl(X(o),X(s))},e.dE=Rm,e.dF=function(e){const t=e.navigator?e.navigator.userAgent:null;return!!function(e){if(null==ve){const t=e.navigator?e.navigator.userAgent:null;ve=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return ve}(e)&&t&&(t.match("Version/15.4")||t.match("Version/15.5")||t.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},e.dG=function(e,t){Ne=e,je=t},e.dH=jc,e.dI=Nc,e.dJ=function(e){const t=[0,0,0],i=N.mat4.identity(new Float64Array(16));return N.mat4.multiply(i,e.pixelMatrix,e.globeMatrix),N.vec3.transformMat4(t,t,i),new G(t[0],t[1])},e.dK=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Ao===wo||Ao===So||Ao===To)throw new Error("setRTLTextPlugin cannot be called multiple times.");Co=ze.resolveURL(e),Ao=wo,Mo=t,Po(),i||Do()},e.dL=Io,e.dM=function(){Ig().acquire(Ag)},e.dN=function(){const e=Pg;e&&(e.isPreloaded()&&1===e.numActive()?(e.release(Ag),Pg=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},e.dO=Cg,e.dP=function(e){const t=He();if(!t)return;const i=t.delete(Be);e&&i.catch(e).then((()=>e()))},e.dQ=Mg,e.dR=z_,e.dS=function(e){k_=ze.resolveURL(e),R_||(R_=new Eg(Ig(),new wt)),R_.broadcast("setDracoUrl",k_)},e.dT=O_,e.dU=function(e){D_=ze.resolveURL(e),R_||(R_=new Eg(Ig(),new wt)),R_.broadcast("setMeshoptUrl",D_)},e.dV=ao,e.dW=ou,e.dX=Xp,e.dY=ph,e.dZ=class{constructor(e,t){this.pos=e,this.dir=t}intersectsPlane(e,t,i){const r=N.vec2.dot(t,this.dir);if(Math.abs(r)<1e-6)return!1;const n=((e[0]-this.pos[0])*t[0]+(e[1]-this.pos[1])*t[1])/r;return i[0]=this.pos[0]+this.dir[0]*n,i[1]=this.pos[1]+this.dir[1]*n,!0}},e.d_=lv,e.da=ys,e.db=Zs,e.dc=256,e.dd=Rc,e.de=Ts,e.df=Vs,e.dg=Us,e.dh=function(e,t,i,r,n){return Q((e-t)/(i-t)*(n-r)+r,r,n)},e.di=An,e.dj=yl,e.dk=class{constructor(e,t,i,r){this.context=e,this.format=r,this.size=i,this.texture=e.gl.createTexture();const[n,o,s]=this.size,{gl:a}=e;a.bindTexture(a.TEXTURE_3D,this.texture),e.pixelStoreUnpackFlipY.set(!1),e.pixelStoreUnpack.set(1),e.pixelStoreUnpackPremultiplyAlpha.set(!1),a.texImage3D(a.TEXTURE_3D,0,this.format,n,o,s,0,dm(this.format),pm(this.format),t.data)}bind(e,t){const{context:i}=this,{gl:r}=i;r.bindTexture(r.TEXTURE_3D,this.texture),e!==this.minFilter&&(r.texParameteri(r.TEXTURE_3D,r.TEXTURE_MAG_FILTER,e),r.texParameteri(r.TEXTURE_3D,r.TEXTURE_MIN_FILTER,e),this.minFilter=e),t!==this.wrapS&&(r.texParameteri(r.TEXTURE_3D,r.TEXTURE_WRAP_S,t),r.texParameteri(r.TEXTURE_3D,r.TEXTURE_WRAP_T,t),this.wrapS=t)}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}},e.dl=Bm,e.dm=[1,1,1],e.dn=cg,e.dp=ig,e.dq=Ds,e.dr=Ws,e.ds=il,e.dt=Hs,e.du=Gs,e.dv=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new G(1/0,1/0),max:new G(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=Mh(new G(0,0),new G(Zi,Zi),e),r=[];if(t&&!Sh(i,this._globalClipBounds))return r;for(const n of this._activeRegions){if(n.hiddenByOverlap)continue;if(!Sh(i,n))continue;const t=Ah(n.min,n.max,e);r.push({min:t.min,max:t.max,sourceId:this._sourceIds[n.priority],footprint:n.footprint,footprintTileId:n.tileId,order:n.order,clipMask:n.clipMask,clipScope:n.clipScope})}return r}setSources(e){this._setSources(e.map((e=>({getSourceId:()=>e.cache.id,getFootprints:()=>{const t=[];for(const i of e.cache.getVisibleCoordinates()){const r=e.cache.getTile(i).buckets[e.layer];r&&r.updateFootprints(i.toUnwrapped(),t)}return t},getOrder:()=>e.order,getClipMask:()=>e.clipMask,getClipScope:()=>e.clipScope}))))}_addSource(e){const t=e.getFootprints();if(0===t.length)return;const i=e.getOrder(),r=e.getClipMask(),n=e.getClipScope();for(const o of t){if(!o.footprint)continue;const e=Mh(o.footprint.min,o.footprint.max,o.id);this._activeRegions.push({min:e.min,max:e.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:o.id,footprint:o.footprint,order:i,clipMask:r,clipScope:n})}this._sourceIds.push(e.getSourceId())}_computeReplacement(){this._activeRegions.sort(((e,t)=>e.priority-t.priority||bh(e.min,t.min)||bh(e.max,t.max)||e.order-t.order||e.clipMask-t.clipMask||function(e,t){const i=(e,t)=>e+t;return e.length-t.length||e.reduce(i,"").localeCompare(t.reduce(i,""))}(e.clipScope,t.clipScope)));let e=this._activeRegions.length!==this._prevRegions.length;if(!e){let t=0;for(;!e&&t!==this._activeRegions.length;){const i=this._activeRegions[t],r=this._prevRegions[t];e=i.priority!==r.priority||!wh(i,r)||i.order!==r.order||i.clipMask!==r.clipMask||!H(i.clipScope,r.clipScope),++t}}if(e){++this._updateTime;for(const t of this._activeRegions)t.order!==vh&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,t.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,t.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,t.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,t.max.y));const e=e=>{const t=this._activeRegions;if(e>=t.length)return e;const i=t[e].priority;for(;e<t.length&&t[e].priority===i;)++e;return e};if(this._sourceIds.length>1){let t=0,i=e(t);for(;t!==i;){let r=t;const n=t;for(;r!==i;){const e=this._activeRegions[r];e.hiddenByOverlap=!1;for(let t=0;t<n;t++){const i=this._activeRegions[t];if(!i.hiddenByOverlap&&e.order===vh&&Sh(e,i)&&(e.hiddenByOverlap=Eh(e.footprint,e.tileId,i.footprint,i.tileId),e.hiddenByOverlap))break}++r}t=i,i=e(t)}}}}_setSources(e){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let t=e.length-1;t>=0;t--)this._addSource(e[t]);this._computeReplacement()}},e.dw=class{constructor(e){this._createGrid(e),this._createPoles(e)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const e of this._poleSegments)e.destroy();for(const e of this._gridSegments)e.withSkirts.destroy(),e.withoutSkirts.destroy()}_fillGridMeshWithLods(e,t){const i=new vs,r=new Fs,n=[],o=e+1+2,s=t[0]+1,a=t[0]+1+(1+t.length),l=(e,t,i)=>{let r=e===o-1?e-2:0===e?e:e-1;return r+=i?24575:0,[r,t]};for(let c=0;c<o;++c)i.emplaceBack(...l(c,0,!0));for(let c=0;c<s;++c)for(let e=0;e<o;++e)i.emplaceBack(...l(e,c,(0===e||e===o-1)&&!0));for(let c=0;c<t.length;++c){const e=t[c];for(let t=0;t<o;++t)i.emplaceBack(...l(t,e,!0))}for(let c=0;c<t.length;++c){const e=r.length,s=t[c]+1+2,l=new Fs;for(let i=0;i<s-1;i++){const e=i===s-2,n=e?o*(a-t.length+c-i):o;for(let t=0;t<o-1;t++){const s=i*o+t;0===i||e||0===t||t===o-2?(l.emplaceBack(s+1,s,s+n),l.emplaceBack(s+n,s+n+1,s+1)):(r.emplaceBack(s+1,s,s+n),r.emplaceBack(s+n,s+n+1,s+1))}}const u=pa.simpleSegment(0,e,i.length,r.length-e);for(let t=0;t<l.uint16.length;t+=3)r.emplaceBack(l.uint16[t],l.uint16[t+1],l.uint16[t+2]);const h=pa.simpleSegment(0,e,i.length,r.length-e);n.push({withoutSkirts:u,withSkirts:h})}return{vertices:i,indices:r,segments:n}}_createGrid(e){const t=this._fillGridMeshWithLods(Za,Ka);this._gridSegments=t.segments,this._gridBuffer=e.createVertexBuffer(t.vertices,uc.members),this._gridIndexBuffer=e.createIndexBuffer(t.indices,!0)}_createPoles(e){const t=new Fs;for(let s=0;s<=Za;s++)t.emplaceBack(0,s+1,s+2);this._poleIndexBuffer=e.createIndexBuffer(t,!0);const i=new Vs,r=new Vs,n=new Vs,o=new Vs;this._poleSegments=[];for(let s=0,a=0;s<qa;s++){const e=360/(1<<s);i.emplaceBack(0,-$a,0,.5,0),r.emplaceBack(0,-$a,0,.5,1),n.emplaceBack(0,-$a,0,.5,.5),o.emplaceBack(0,-$a,0,.5,.5);for(let t=0;t<=Za;t++){let s=t/Za,a=0;const l=Et(0,e,s),[c,u,h]=el(Uc,Gc,l,$a);i.emplaceBack(c,u,h,s,a),r.emplaceBack(c,u,h,s,1-a);const d=q(l);s=.5+.5*Math.sin(d),a=.5+.5*Math.cos(d),n.emplaceBack(c,u,h,s,a),o.emplaceBack(c,u,h,s,1-a)}this._poleSegments.push(pa.simpleSegment(a,0,66,64)),a+=66}this._poleNorthVertexBuffer=e.createVertexBuffer(i,lc,!1),this._poleSouthVertexBuffer=e.createVertexBuffer(r,lc,!1),this._texturedPoleNorthVertexBuffer=e.createVertexBuffer(n,lc,!1),this._texturedPoleSouthVertexBuffer=e.createVertexBuffer(o,lc,!1)}getGridBuffers(e,t){return[this._gridBuffer,this._gridIndexBuffer,t?this._gridSegments[e].withSkirts:this._gridSegments[e].withoutSkirts]}getPoleBuffers(e,t){return[t?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,t?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[e]]}},e.dx=vh,e.dy=K,e.dz=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},e.e=Me,e.e0=xd,e.e1=ce,e.e2=Qt,e.e3=Hp,e.e4=function(e,t,i,r,n,o,s,a,l,c){let u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:1,h=arguments.length>11?arguments[11]:void 0,d=arguments.length>12?arguments[12]:void 0;e.createArrays(),e.tilePixelRatio=Zi/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;const p=e.layers[0].layout,f=e.layers[0]._unevaluatedLayout._values,m={};m.scaleFactor=u,m.textSizeScaleRange=p.get("text-size-scale-range"),m.iconSizeScaleRange=p.get("icon-size-scale-range");const[g,y]=m.textSizeScaleRange,[_,v]=m.iconSizeScaleRange;if(m.textScaleFactor=Q(m.scaleFactor,g,y),m.iconScaleFactor=Q(m.scaleFactor,_,v),"composite"===e.textSizeData.kind){const{minZoom:t,maxZoom:i}=e.textSizeData;m.compositeTextSizes=[f["text-size"].possiblyEvaluate(new Ro(t),a),f["text-size"].possiblyEvaluate(new Ro(i),a)]}if("composite"===e.iconSizeData.kind){const{minZoom:t,maxZoom:i}=e.iconSizeData;m.compositeIconSizes=[f["icon-size"].possiblyEvaluate(new Ro(t),a),f["icon-size"].possiblyEvaluate(new Ro(i),a)]}m.layoutTextSize=f["text-size"].possiblyEvaluate(new Ro(l+1),a),m.layoutIconSize=f["icon-size"].possiblyEvaluate(new Ro(l+1),a),m.textMaxSize=f["text-size"].possiblyEvaluate(new Ro(18),a);const x="map"===p.get("text-rotation-alignment")&&"point"!==p.get("symbol-placement"),b=p.get("text-size");let w=!1;for(const S of e.features)if(S.icon&&S.icon.nameSecondary){w=!0;break}for(const S of e.features){const o=p.get("text-font").evaluate(S,{},a).join(","),l=b.evaluate(S,{},a)*m.textScaleFactor,u=m.layoutTextSize.evaluate(S,{},a)*m.textScaleFactor,g=(m.layoutIconSize.evaluate(S,{},a),{horizontal:{},vertical:void 0}),y=S.text;let _,v=[0,0];if(y){const r=y.toString(),s=p.get("text-letter-spacing").evaluate(S,{},a)*Xd,c=p.get("text-line-height").evaluate(S,{},a)*Xd,h=mo(r)?s:0,d=p.get("text-anchor").evaluate(S,{},a),f=p.get("text-variable-anchor");if(!f){const e=p.get("text-radial-offset").evaluate(S,{},a);v=e?hf(d,[e*Xd,cf]):p.get("text-offset").evaluate(S,{},a).map((e=>e*Xd))}let m=x?"center":p.get("text-justify").evaluate(S,{},a);const _="point"===p.get("symbol-placement"),b=_?p.get("text-max-width").evaluate(S,{},a)*Xd:1/0,w=s=>{e.allowVerticalPlacement&&fo(r)&&(g.vertical=xp(y,t,i,n,o,b,c,d,s,h,v,yp.vertical,!0,u,l))};if(!x&&f){const e="auto"===m?f.map((e=>df(e))):[m];let r=!1;for(let s=0;s<e.length;s++){const a=e[s];if(!g.horizontal[a])if(r)g.horizontal[a]=g.horizontal[0];else{const e=xp(y,t,i,n,o,b,c,"center",a,h,v,yp.horizontal,!1,u,l);e&&(g.horizontal[a]=e,r=1===e.positionedLines.length)}}w("left")}else{if("auto"===m&&(m=df(d)),_||p.get("text-writing-mode").indexOf("horizontal")>=0||!fo(r)){const e=xp(y,t,i,n,o,b,c,d,m,h,v,yp.horizontal,!1,u,l);e&&(g.horizontal[m]=e)}w(_?"left":m)}}let T=!1;if(S.icon&&S.icon.namePrimary){const t=Zd(e.iconSizeData,f["icon-size"],a,e.zoom,S)*m.iconScaleFactor*h,i=S.icon.getPrimary().scaleSelf(t).serialize(),o=r[i];o&&(_=kp(n[i],S.icon.nameSecondary?n[S.icon.getSecondary().scaleSelf(t).serialize()]:void 0,p.get("icon-offset").evaluate(S,{},a),p.get("icon-anchor").evaluate(S,{},a)),T=o.sdf,void 0===e.sdfIcons?e.sdfIcons=o.sdf:e.sdfIcons!==o.sdf&&pe("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(o.pixelRatio!==e.pixelRatio||0!==p.get("icon-rotate").constantOr(1))&&(e.iconsNeedLinear=!0))}const M=yf(g.horizontal)||g.vertical;e.iconsInText||(e.iconsInText=!!M&&M.iconsInText),(M||_)&&pf(e,S,g,_,r,m,u,0,v,T,s,a,c,d,w)}o&&e.generateCollisionDebugBuffers(l,e.collisionBoxArray,m.textScaleFactor)},e.e5=Oy,e.e6=U,e.e7=dh,e.e8=up,e.e9=t,e.ea=function(e){let t=0;if(new Uint32Array(e,0,1)[0]!==W_){const i=new Uint32Array(e,0,7),[,,r,n,o,s]=i;t=i.byteLength+n+o+s+o,(r!==e.byteLength||t>=e.byteLength)&&pe("Invalid b3dm header information.")}return K_(e,t)},e.eb=function(e,t){const i=ov(e);for(const r of i){for(const e of r.meshes)sv(e);r.lights&&(r.lightMeshIndex=r.meshes.length,r.meshes.push(av(r.lights,t)))}return i},e.ec=gg,e.ed=Tg,e.ee=Lo,e.ef=function(e){We(),null!=Ue&&Ue.then((t=>{t.keys().then((i=>{for(let r=0;r<i.length-e;r++)t.delete(i[r])}))}))},e.f=function(e){return 0===e.indexOf("mapbox:")},e.g=function(e,t){return rt(re(e,{method:"GET"}),t)},e.h=Ae,e.i=function(e){return Me.API_STYLE_REGEX.test(e)&&!Ce(e)},e.j=function(e){return decodeURIComponent(atob(e).split("").map((e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2))).join(""))},e.k=function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,((e,t)=>String.fromCharCode(Number("0x"+t)))))},e.l=re,e.m=qe,e.n=function(e,t){return rt(re(e,{type:"json"}),t)},e.o=ct,e.p=function(e,t){return rt(re(e,{method:"POST"}),t)},e.q=ze,e.r=su,e.s=function(e){try{const t=self[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch(e){return!1}},e.t=Re,e.u=function(){return function e(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()},e.v=function(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e.w=pe,e.x=function(){return kg||(kg=new Cg),kg},e.y=vt,e.z=_t})),r(["./shared"],(function(e){function t(e){const t=e?e.url.toString():void 0;return t?performance.getEntriesByName(t):[]}function i(e){if("number"==typeof e||"boolean"==typeof e||"string"==typeof e||null==e)return JSON.stringify(e);if(Array.isArray(e)){let t="[";for(const r of e)t+=`${i(r)},`;return`${t}]`}let t="{";for(const r of Object.keys(e).sort())t+=`${r}:${i(e[r])},`;return`${t}}`}function r(t){let r="";for(const n of e.bm)("model"!==t.type||"minzoom"!==n&&"maxzoom"!==n)&&(r+=`/${i(t[n])}`);return r}class n{constructor(e){this.keyCache={},this._layers={},this._layerConfigs={},e&&this.replace(e)}replace(e,t){this._layerConfigs={},this._layers={},this.update(e,[],t)}update(t,n,o){this._options=o;for(const i of t)this._layerConfigs[i.id]=i,(this._layers[i.id]=e.cu(i,this.scope,null,this._options)).compileFilter(o),this.keyCache[i.id]&&delete this.keyCache[i.id];for(const e of n)delete this.keyCache[e],delete this._layerConfigs[e],delete this._layers[e];this.familiesBySource={};const s=function(e,t){const n={};for(let s=0;s<e.length;s++){const o=e[s];let a=t&&t[o.id];!a&&(a=r(o),"line"===o.type&&o.paint)&&function e(t){return"string"==typeof t&&"line-progress"===t||(Array.isArray(t)?t.some(e):!(!t||"object"!=typeof t)&&Object.values(t).some(e))}(o.paint["line-width"])&&(a+=`/${i(o.paint["line-width"])}`),t&&(t[o.id]=a);let l=n[a];l||(l=n[a]=[]),l.push(o)}const o=[];for(const i in n)o.push(n[i]);return o}(e.bj(this._layerConfigs),this.keyCache);for(const e of s){const t=e.map((e=>this._layers[e.id])),i=t[0];if("none"===i.visibility)continue;const r=i.source||"";let n=this.familiesBySource[r];n||(n=this.familiesBySource[r]={});const o=i.sourceLayer||"_geojsonTileLayer";let s=n[o];s||(s=n[o]=[]),s.push(t)}}}const o=1*e.dX;class s{constructor(t){const i={},r=[];for(const e in t){const n=t[e],s=i[e]={};for(const e in n.glyphs){const t=n.glyphs[+e];if(!t||0===t.bitmap.width||0===t.bitmap.height)continue;const i=t.metrics.localGlyph?o:1,a={x:0,y:0,w:t.bitmap.width+2*i,h:t.bitmap.height+2*i};r.push(a),s[e]=a}}const{w:n,h:s}=e.F(r),a=new e.dW({width:n||1,height:s||1});for(const l in t){const r=t[l];for(const t in r.glyphs){const n=r.glyphs[+t];if(!n||0===n.bitmap.width||0===n.bitmap.height)continue;const s=i[l][t],c=n.metrics.localGlyph?o:1;e.dW.copy(n.bitmap,a,{x:0,y:0},{x:s.x+c,y:s.y+c},n.bitmap)}}this.image=a,this.positions=i}}e.dV(s,"GlyphAtlas");const a="3d_elevation_id",l="hd_road_elevation";class c{constructor(){this._valid=!1}reset(e){return this.feature=e,this._valid=!0,this._geometry=e.loadGeometry(),0!==this._geometry.length&&0!==this._geometry[0].length||(this._valid=!1),this}geometry(e,t){return this._valid&&e(t(this._geometry)),this}require(e,t,i){return this.get(e,!0,t,i)}optional(e,t,i){return this.get(e,!1,t,i)}success(){return this._valid}get(e,t,i,r){const n=this.feature.properties.hasOwnProperty(e)?+this.feature.properties[e]:void 0;return this._valid&&void 0!==n?i(r?r(n):n):t&&(this._valid=!1),this}}class u{constructor(e,t){this.featureFunc=e,this.vertexFunc=t}parseFeature(e,t,i){return this.featureFunc(e,t,i)}parseVertex(e,t,i){return this.vertexFunc(e,t,i)}}const h=new u(((e,t,i)=>e.reset(t).require(a,(e=>{i.id=e})).optional("fixed_height_relative",(e=>{i.constantHeight=e}),p.decodeRelativeHeight).geometry((e=>{i.bounds=e}),p.computeBounds).success()),((e,t,i)=>e.reset(t).require(a,(e=>{i.id=e})).require("elevation_idx",(e=>{i.idx=e})).require("extent",(e=>{i.extent=e})).require("height_relative",(e=>{i.height=e}),p.decodeRelativeHeight).geometry((e=>{i.position=e}),p.getPoint).success())),d=new u(((e,t,i)=>e.reset(t).require(a,(e=>{i.id=e})).optional("fixed_height",(e=>{i.constantHeight=e}),p.decodeMetricHeight).geometry((e=>{i.bounds=e}),p.computeBounds).success()),((e,t,i)=>e.reset(t).require(a,(e=>{i.id=e})).require("elevation_idx",(e=>{i.idx=e})).require("extent",(e=>{i.extent=e})).require("height",(e=>{i.height=e}),p.decodeMetricHeight).geometry((e=>{i.position=e}),p.getPoint).success()));class p{static computeBounds(t){const i=new e.P(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),r=new e.P(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const e of t[0])i.x>e.x&&(i.x=e.x),i.y>e.y&&(i.y=e.y),r.x<e.x&&(r.x=e.x),r.y<e.y&&(r.y=e.y);return{min:i,max:r}}static getPoint(t){return e.ab.vec2.fromValues(t[0][0].x,t[0][0].y)}static decodeRelativeHeight(e){return 1e-4*e*5}static decodeMetricHeight(e){return 1e-4*e}static parse(t){const i=[],r=[],n=t.length,o=new c;for(let a=0;a<n;a++){const n=t.feature(a),l=n.properties.hasOwnProperty("version")?String(n.properties.version):void 0,c=(s=l)?"1.0.1"===s?d:void 0:h;if(void 0===c){e.w(`Unknown elevation feature version number ${l||"(unknown)"}`);continue}const u=n.properties.hasOwnProperty("type")?n.properties.type:void 0;if(u)if("Point"===e.dY.VectorTileFeature.types[n.type]&&"curve_point"===u){const e={};c.parseVertex(o,n,e)&&i.push(e)}else if("Polygon"===e.dY.VectorTileFeature.types[n.type]&&"curve_meta"===u){const e={};c.parseFeature(o,n,e)&&r.push(e)}}var s;return{vertices:i,features:r}}}class f{constructor(t,i,r,n,o,s){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this.id=t,this.heightRange={min:r,max:r},this.safeArea=i,this.constantHeight=r,null==this.constantHeight&&(null!=this.constantHeight||0!==n.length)){this.vertices=n,this.edges=o,this.edges=this.edges.filter((t=>t.a<this.vertices.length&&t.b<this.vertices.length&&!e.ab.vec2.exactEquals(this.vertices[t.a].position,this.vertices[t.b].position))),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const t of this.vertices)this.vertexProps.push({dir:e.ab.vec2.fromValues(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,t.height),this.heightRange.max=Math.max(this.heightRange.max,t.height);for(const t of this.edges){const i=this.vertices[t.a].position,r=this.vertices[t.b].position,n=e.ab.vec2.subtract(e.ab.vec2.create(),r,i),o=e.ab.vec2.length(n),s=e.ab.vec2.scale(e.ab.vec2.create(),n,1/o);this.edgeProps.push({vec:n,dir:s,len:o});const a=this.vertexProps[t.a].dir,l=this.vertexProps[t.b].dir;e.ab.vec2.add(a,a,s),e.ab.vec2.add(l,l,s)}for(const t of this.vertexProps)0===t.dir[0]&&0===t.dir[1]||e.ab.vec2.normalize(t.dir,t.dir);this.tessellate(s)}}pointElevation(e){if(null!=this.constantHeight)return this.constantHeight;const t=this.getClosestEdge(e);if(null==t)return 0;const[i,r]=t;return(1-(n=r))*this.vertices[this.edges[i].a].height+n*this.vertices[this.edges[i].b].height;var n}getClosestEdge(t){if(0===this.edges.length)return;let i=0,r=Number.POSITIVE_INFINITY,n=0;const o=e.ab.vec2.fromValues(t.x,t.y);for(let s=0;s<this.edges.length;s++){const t=this.edges[s],a=this.edgeProps[s].dir,l=new e.dZ(o,this.edgeProps[s].dir),c=this.vertices[t.a].position,u=this.vertices[t.b].position,h=e.ab.vec2.create(),d=e.ab.vec2.create(),p=l.intersectsPlane(c,this.vertexProps[t.a].dir,h),f=l.intersectsPlane(u,this.vertexProps[t.b].dir,d);if(!p||!f)continue;const m=e.ab.vec2.subtract(e.ab.vec2.create(),d,h),g=e.ab.vec2.subtract(e.ab.vec2.create(),o,h),y=e.ab.vec2.dot(m,m),_=y>0?e.ab.vec2.dot(g,m)/y:0,v=e.aw(_,0,1),x=Math.abs((_-v)*this.edgeProps[s].len),b=e.ab.vec2.subtract(e.ab.vec2.create(),o,c),w=x+Math.abs(e.ab.vec2.dot(b,e.ab.vec2.fromValues(a[1],-a[0])));w<r&&(i=s,r=w,n=v)}return[i,n]}tessellate(t){for(let i=this.edges.length-1;i>=0;--i){const r=this.edges[i].a,n=this.edges[i].b,{position:o,height:s,extent:a}=this.vertices[r],{position:l,height:c,extent:u}=this.vertices[n],h=this.vertexProps[r].dir,d=this.vertexProps[n].dir,p=e.ab.vec3.fromValues(o[0]/t,o[1]/t,s),f=e.ab.vec3.fromValues(l[0]/t,l[1]/t,c),m=e.ab.vec3.fromValues(h[1],-h[0],0);e.ab.vec3.scale(m,m,a);const g=e.ab.vec3.fromValues(d[1],-d[0],0);if(e.ab.vec3.scale(g,g,u),this.distSqLines(e.ab.vec3.fromValues(p[0]+.5*m[0],p[1]+.5*m[1],p[2]+.5*m[2]),e.ab.vec3.fromValues(f[0]-.5*g[0],f[1]-.5*g[1],f[2]-.5*g[2]),e.ab.vec3.fromValues(p[0]-.5*m[0],p[1]-.5*m[1],p[2]-.5*m[2]),e.ab.vec3.fromValues(f[0]+.5*g[0],f[1]+.5*g[1],f[2]+.5*g[2]))<=.05*.05)continue;const y=this.vertices.length,_=e.ab.vec2.add(e.ab.vec2.create(),o,l);this.vertices.push({position:e.ab.vec2.scale(_,_,.5),height:.5*(s+c),extent:.5*(a+u)});const v=e.ab.vec2.add(e.ab.vec2.create(),h,d);this.vertexProps.push({dir:e.ab.vec2.normalize(v,v)}),this.edges.splice(i,1),this.edgeProps.splice(i,1),this.edges.push({a:r,b:y}),this.edges.push({a:y,b:n});const x=e.ab.vec2.subtract(e.ab.vec2.create(),this.vertices[y].position,o),b=e.ab.vec2.length(x),w={vec:x,dir:e.ab.vec2.scale(e.ab.vec2.create(),x,1/b),len:b};this.edgeProps.push(w),this.edgeProps.push(w)}}distSqLines(t,i,r,n){const o=e.ab.vec3.subtract(e.ab.vec3.create(),i,t),s=e.ab.vec3.subtract(e.ab.vec3.create(),n,r),a=e.ab.vec3.subtract(e.ab.vec3.create(),t,r),l=e.ab.vec3.dot(o,o),c=e.ab.vec3.dot(o,s),u=e.ab.vec3.dot(o,a),h=e.ab.vec3.dot(s,s),d=e.ab.vec3.dot(s,a),p=l*h-c*c;if(0===p){const i=e.ab.vec3.dot(a,s)/e.ab.vec3.dot(s,s),o=e.ab.vec3.lerp(e.ab.vec3.create(),r,n,i);return e.ab.vec3.squaredDistance(o,t)}const f=(c*d-u*h)/p,m=(l*d-c*u)/p,g=e.ab.vec3.lerp(e.ab.vec3.create(),t,i,f),y=e.ab.vec3.lerp(e.ab.vec3.create(),r,n,m);return e.ab.vec3.squaredDistance(g,y)}}class m{static parseFrom(t,i){const r=p.parse(t);if(!r)return[];let{vertices:n,features:o}=r;const s=1/e.cc(i);o.sort(((e,t)=>e.id-t.id)),n.sort(((e,t)=>e.id-t.id||e.idx-t.idx)),n=n.filter(((e,t,i)=>t===i.findIndex((t=>t.id===e.id&&t.idx===e.idx))));const a=new Array;let l=0;const c=n.length;for(const e of o){if(e.constantHeight){a.push(new f(e.id,e.bounds,e.constantHeight));continue}for(;l!==c&&n[l].id<e.id;)l++;if(l===c||n[l].id!==e.id)continue;const t=new Array,i=new Array,r=l;for(;l!==c&&n[l].id===e.id;){const e=n[l];if(t.push({position:e.position,height:e.height,extent:e.extent}),l!==r&&n[l-1].idx===e.idx-1){const e=l-r;i.push({a:e-1,b:e})}l++}a.push(new f(e.id,e.bounds,void 0,t,i,s))}return a}}e.dV(f,"ElevationFeature");class g{constructor(t){this.tileID=new e.aG(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.lut=t.lut,this.canonical=t.tileID.canonical,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.scope=t.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.request&&t.request.collectResourceTiming,this.promoteId=t.promoteId,this.isSymbolTile=t.isSymbolTile,this.tileTransform=e.aQ(t.tileID.canonical,t.projection),this.projection=t.projection,this.worldview=t.worldview,this.localizableLayerIds=t.localizableLayerIds,this.brightness=t.brightness,this.extraShadowCaster=!!t.extraShadowCaster,this.tessellationStep=t.tessellationStep,this.scaleFactor=t.scaleFactor}parse(t,i,r,n,o){this.status="parsing",this.data=t,this.collisionBoxArray=new e.aW;const c=new e.d_(Object.keys(t.layers).sort()),u=new e.d$(this.tileID,this.promoteId);u.bucketLayerIDs=[];const h={},d=new e.e0(256,256),p={featureIndex:u,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:d,availableImages:r,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},f=i.familiesBySource[this.source];for(const s in f){const i=t.layers[s];if(!i)continue;let n=!1,o=!1,d=!1;for(const e of f[s])"symbol"===e[0].type?n=!0:o=!0,e[0].is3D()&&"model"!==e[0].type&&(d=!0);if(this.extraShadowCaster&&!d)continue;if(!0===this.isSymbolTile&&!n)continue;if(!1===this.isSymbolTile&&!o)continue;1===i.version&&e.w(`Vector tile source "${this.source}" layer "${s}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const g=c.encode(s),_=[];let v=!1;for(let e=0,t=0;e<i.length;e++){const r=i.feature(e),n=u.getId(r,s);if(this.localizableLayerIds&&this.localizableLayerIds.has(s)){const e=r.properties?r.properties.worldview:null;if(this.worldview&&"string"==typeof e)if("all"===e)r.properties.$localized=!0;else{if(!e.split(",").includes(this.worldview))continue;r.properties.$localized=!0,r.properties.worldview=this.worldview}}!v&&r.properties&&r.properties.hasOwnProperty(a)&&(v=!0),_.push({feature:r,id:n,index:t,sourceLayerIndex:g}),t++}v&&t.layers.hasOwnProperty(l)&&(p.elevationFeatures=m.parseFrom(t.layers[l],this.canonical));for(const t of f[s]){const i=t[0];(!this.extraShadowCaster||i.is3D()&&"model"!==i.type)&&(void 0!==this.isSymbolTile&&"symbol"===i.type!==this.isSymbolTile||i.minzoom&&this.zoom<Math.floor(i.minzoom)||i.maxzoom&&this.zoom>=i.maxzoom||"none"!==i.visibility&&(y(t,this.zoom,p.brightness,r),(h[i.id]=i.createBucket({index:u.bucketLayerIDs.length,layers:t,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:g,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(_,p,this.tileID.canonical,this.tileTransform),u.bucketLayerIDs.push(t.map((t=>e.aC(t.id,t.scope))))))}}let g,_,v,x;d.trim();const b={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},w=()=>{if(g)return this.status="done",o(g);if(this.extraShadowCaster)this.status="done",o(null,{buckets:e.bj(h).filter((e=>!e.isEmpty())),featureIndex:u,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:p.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(_&&v&&x){const t=new s(_),i=new e.e3(v,x,this.lut);for(const n in h){const o=h[n];o instanceof e.aX?(y(o.layers,this.zoom,p.brightness,r),e.e4(o,_,t.positions,v,i.iconPositions,this.showCollisionBoxes,r,this.tileID.canonical,this.tileZoom,this.projection,this.scaleFactor,this.pixelRatio,this.brightness)):o.hasPattern&&(o instanceof e.b1||o instanceof e.b2||o instanceof e.d5)&&(y(o.layers,this.zoom,p.brightness,r),o.addFeatures(p,this.tileID.canonical,i.patternPositions,r,this.tileTransform,this.brightness))}this.status="done",o(null,{buckets:e.bj(h).filter((e=>!e.isEmpty())),featureIndex:u,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:t.image,lineAtlas:d,imageAtlas:i,brightness:p.brightness})}};if(!this.extraShadowCaster){const t=e.e1(p.glyphDependencies,(e=>Object.keys(e).map(Number)));Object.keys(t).length?n.send("getGlyphs",{uid:this.uid,stacks:t,scope:this.scope},((e,t)=>{g||(g=e,_=t,w())}),void 0,!1,b):_={};const i=Object.keys(p.iconDependencies);i.length?n.send("getImages",{icons:i,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},((e,t)=>{if(g)return;g=e;const i={};Object.values(t).some((e=>e.usvg))?this.rasterize(n,i,t,p.iconDependencies,(()=>{v=i,w()})):(this.fillImageMap(i,p.iconDependencies,t),v=i,w())}),void 0,!1,b):v={};const r=Object.keys(p.patternDependencies);r.length?n.send("getImages",{icons:r,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},((e,t)=>{if(!g){g=e;const i={};Object.values(t).some((e=>e.usvg))?this.rasterize(n,i,t,p.patternDependencies,(()=>{x=i,w()})):(this.fillImageMap(i,p.patternDependencies,t),x=i,w())}}),void 0,!1,b):x={}}w()}fillImageMap(e,t,i){for(const r in i){const n=t[r]||[];for(const t of n)i[t.id].usvg||(e[t.serialize()]=i[t.id])}}getImageTaskQueue(e,t,i){const r={};for(const n in t){const o=i[n]||[];for(const i of o){const n=i.serialize();t[i.id].usvg?r[n]||(r[n]=i):e[n]=t[i.id]}}return r}rasterize(t,i,r,n,o){const s=this.getImageTaskQueue(i,r,n);this.rasterizeTask=t.send("rasterizeImages",{scope:this.scope,imageTasks:s},((t,n)=>{if(!t)for(const o in n){const{id:t}=e.e2.deserializeFromString(o);i[o]=Object.assign({},r[t],{data:n[o]})}o()}))}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function y(t,i,r,n){const o=new e.a8(i,{brightness:r});for(const e of t)e.recalculate(o,n)}class _ extends e.E{constructor(t,i,r,n,o,s){super(),this.actor=t,this.layerIndex=i,this.availableImages=r,this.loadVectorData=o||e.aD,this.loading={},this.loaded={},this.deduped=new e.aB(t.scheduler),this.isSpriteLoaded=n,this.scheduler=t.scheduler,this.brightness=s}loadTile(i,r){const n=i.uid,o=i&&i.request,s=o&&o.collectResourceTiming,a=this.loading[n]=new g(i);a.abort=this.loadVectorData(i,((l,c)=>{const u=!this.loading[n];if(delete this.loading[n],a.cancelRasterize(),u||l||!c)return a.status="done",u||(this.loaded[n]=a),r(l);const h=c.rawData,d={};c.expires&&(d.expires=c.expires),c.cacheControl&&(d.cacheControl=c.cacheControl),a.vectorTile=c.vectorTile||new e.dY.VectorTile(new e.bh(h));const p=()=>{a.parse(a.vectorTile,this.layerIndex,this.availableImages,this.actor,((i,n)=>{if(i||!n)return r(i);const a={};if(s){const e=t(o);e.length>0&&(a.resourceTiming=JSON.parse(JSON.stringify(e)))}r(null,e.l({rawTileData:h.slice(0)},n,d,a))}))};this.isSpriteLoaded?p():this.once("isSpriteLoaded",(()=>{this.scheduler?this.scheduler.add(p,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom}):p()})),this.loaded=this.loaded||{},this.loaded[n]=a}))}reloadTile(t,i){const r=this.loaded,n=t.uid;if(r&&r[n]){const o=r[n];o.scaleFactor=t.scaleFactor,o.showCollisionBoxes=t.showCollisionBoxes,o.projection=t.projection,o.brightness=t.brightness,o.tileTransform=e.aQ(t.tileID.canonical,t.projection),o.extraShadowCaster=t.extraShadowCaster,o.lut=t.lut;const s=(e,t)=>{const r=o.reloadCallback;r&&(delete o.reloadCallback,o.parse(o.vectorTile,this.layerIndex,this.availableImages,this.actor,r)),i(e,t)};"parsing"===o.status?o.reloadCallback=s:"done"===o.status&&(o.vectorTile?o.parse(o.vectorTile,this.layerIndex,this.availableImages,this.actor,s):s())}else i(null,void 0)}abortTile(e,t){const i=e.uid,r=this.loading[i];r&&(r.abort&&r.abort(),delete this.loading[i]),t()}removeTile(e,t){const i=this.loaded,r=e.uid;i&&i[r]&&delete i[r],t()}}class v{loadTile(t,i){const{uid:r,encoding:n,rawImageData:o,padding:s}=t,a=ImageBitmap&&o instanceof ImageBitmap?this.getImageData(o,s):o;i(null,new e.e5(r,a,n,s<1))}getImageData(e,t){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(e.width,e.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=e.width,this.offscreenCanvas.height=e.height,this.offscreenCanvasContext.drawImage(e,0,0,e.width,e.height);const i=this.offscreenCanvasContext.getImageData(-t,-t,e.width+2*t,e.height+2*t);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),i}}e.bg.setPbf(e.bh);class x{decodeRasterArray(t,i){let{task:r,buffer:n}=t;e.bg.performDecoding(n,r).then((e=>{i(null,e)}),(e=>{i(e)}))}}const b=e.dY.VectorTileFeature.prototype.toGeoJSON;class w{constructor(t){this._feature=t,this.extent=e.ag,this.type=t.type,this.properties=t.tags,"id"in t&&!isNaN(t.id)&&(this.id=parseInt(t.id,10))}loadGeometry(){if(1===this._feature.type){const t=[];for(const i of this._feature.geometry)t.push([new e.P(i[0],i[1])]);return t}{const t=[];for(const i of this._feature.geometry){const r=[];for(const t of i)r.push(new e.P(t[0],t[1]));t.push(r)}return t}}toGeoJSON(e,t,i){return b.call(this,e,t,i)}}class S{constructor(t){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.ag,this.length=t.length,this._features=t}feature(e){return new w(this._features[e])}}const T=64/4096,M=128;class A{constructor(){this.features=new Map}clear(){this.features.clear()}load(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;for(const i of e){const e=i.id;if(null==e)continue;let r=this.features.get(e);r&&this.updateCache(r,t),i.geometry?(r=E(i),this.updateCache(r,t),this.features.set(e,r)):this.features.delete(e),this.updateCache(r,t)}}updateCache(e,t){for(const{canonical:i,uid:r}of Object.values(t)){const{z:n,x:o,y:s}=i;C(e,Math.pow(2,n),o,s)&&delete t[r]}}getTile(e,t,i){const r=Math.pow(2,e),n=[];for(const o of this.features.values())C(o,r,t,i)&&n.push(D(o,r,t,i));return{features:n}}getFeatures(){return[...this.features.values()]}}function C(e,t,i,r){let{minX:n,minY:o,maxX:s,maxY:a}=e;return n<(i+1+T)/t&&o<(r+1+T)/t&&s>(i-T)/t&&a>(r-T)/t}function E(e){const{id:t,geometry:i,properties:r}=e;if(!i)return;if("GeometryCollection"===i.type)throw new Error("GeometryCollection not supported in dynamic mode.");const{type:n,coordinates:o}=i,s={id:t,type:1,geometry:[],tags:r,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},a=s.geometry;if("Point"===n)P(o,a,s);else if("MultiPoint"===n)for(const l of o)P(l,a,s);else if("LineString"===n)s.type=2,k(o,a,s);else if("MultiLineString"===n)s.type=2,I(o,a,s);else if("Polygon"===n)s.type=3,I(o,a,s,!0);else{if("MultiPolygon"!==n)throw new Error("Input data is not a valid GeoJSON object.");s.type=3;for(const e of o)I(e,a,s,!0)}return s}function P(t,i,r){let[n,o]=t;const s=e.at(n);let a=e.aA(o);a=a<0?0:a>1?1:a,i.push(s,a),r.minX=Math.min(r.minX,s),r.minY=Math.min(r.minY,a),r.maxX=Math.max(r.maxX,s),r.maxY=Math.max(r.maxY,a)}function k(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const o=[];for(const s of e)P(s,o,i);t.push(o),r&&function(e,t){let i=0;for(let r=0,n=e.length,o=n-2;r<n;o=r,r+=2)i+=(e[r]-e[o])*(e[r+1]+e[o+1]);if(i>0===t)for(let r=0,n=e.length;r<n/2;r+=2){const t=e[r],i=e[r+1];e[r]=e[n-2-r],e[r+1]=e[n-1-r],e[n-2-r]=t,e[n-1-r]=i}}(o,n)}function I(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];for(let n=0;n<e.length;n++)k(e[n],t,i,r,0===n)}function D(t,i,r,n){const{id:o,type:s,geometry:a,tags:l}=t,c=[];if(1===s)!function(t,i,r,n,o){for(let s=0;s<t.length;s+=2){const a=Math.round(e.ag*(t[s+0]*i-r)),l=Math.round(e.ag*(t[s+1]*i-n));o.push([a,l])}}(a,i,r,n,c);else for(const e of a)L(e,i,r,n,c);return{id:o,type:s,geometry:c,tags:l}}function L(t,i,r,n,o){const s=-M,a=e.ag+M;let l;for(let c=0;c<t.length-2;c+=2){let u=Math.round(e.ag*(t[c+0]*i-r)),h=Math.round(e.ag*(t[c+1]*i-n)),d=Math.round(e.ag*(t[c+2]*i-r)),p=Math.round(e.ag*(t[c+3]*i-n));const f=d-u,m=p-h;u<s&&d<s||(u<s?(h+=Math.round(m*((s-u)/f)),u=s):d<s&&(p=h+Math.round(m*((s-u)/f)),d=s),h<s&&p<s||(h<s?(u+=Math.round(f*((s-h)/m)),h=s):p<s&&(d=u+Math.round(f*((s-h)/m)),p=s),u>=a&&d>=a||(u>=a?(h+=Math.round(m*((a-u)/f)),u=a):d>=a&&(p=h+Math.round(m*((a-u)/f)),d=a),h>=a&&p>=a||(h>=a?(u+=Math.round(f*((a-h)/m)),h=a):p>=a&&(d=u+Math.round(f*((a-h)/m)),p=a),l&&u===l[l.length-1][0]&&h===l[l.length-1][1]||(l=[[u,h]],o.push(l)),l.push([d,p])))))}}var R,z,O,F={exports:{}},B=function(){if(O)return F.exports;O=1;var t=e.e8(),i=function(){if(z)return R;z=1;var t=e.e6(),i=e.e7().VectorTileFeature;function r(e,t){this.options=t||{},this.features=e,this.length=e.length}function n(e,t){this.id="number"==typeof e.id?e.id:void 0,this.type=e.type,this.rawGeometry=1===e.type?[e.geometry]:e.geometry,this.properties=e.tags,this.extent=t||4096}return R=r,r.prototype.feature=function(e){return new n(this.features[e],this.options.extent)},n.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var i=0;i<e.length;i++){for(var r=e[i],n=[],o=0;o<r.length;o++)n.push(new t(r[o][0],r[o][1]));this.geometry.push(n)}return this.geometry},n.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var e=this.geometry,t=1/0,i=-1/0,r=1/0,n=-1/0,o=0;o<e.length;o++)for(var s=e[o],a=0;a<s.length;a++){var l=s[a];t=Math.min(t,l.x),i=Math.max(i,l.x),r=Math.min(r,l.y),n=Math.max(n,l.y)}return[t,r,i,n]},n.prototype.toGeoJSON=i.prototype.toGeoJSON,R}();function r(e){var i=new t;return function(e,t){for(var i in e.layers)t.writeMessage(3,n,e.layers[i])}(e,i),i.finish()}function n(e,t){var i;t.writeVarintField(15,e.version||1),t.writeStringField(1,e.name||""),t.writeVarintField(5,e.extent||4096);var r={keys:[],values:[],keycache:{},valuecache:{}};for(i=0;i<e.length;i++)r.feature=e.feature(i),t.writeMessage(2,o,r);var n=r.keys;for(i=0;i<n.length;i++)t.writeStringField(3,n[i]);var s=r.values;for(i=0;i<s.length;i++)t.writeMessage(4,u,s[i])}function o(e,t){var i=e.feature;void 0!==i.id&&t.writeVarintField(1,i.id),t.writeMessage(2,s,e),t.writeVarintField(3,i.type),t.writeMessage(4,c,i)}function s(e,t){var i=e.feature,r=e.keys,n=e.values,o=e.keycache,s=e.valuecache;for(var a in i.properties){var l=i.properties[a],c=o[a];if(null!==l){void 0===c&&(r.push(a),o[a]=c=r.length-1),t.writeVarint(c);var u=typeof l;"string"!==u&&"boolean"!==u&&"number"!==u&&(l=JSON.stringify(l));var h=u+":"+l,d=s[h];void 0===d&&(n.push(l),s[h]=d=n.length-1),t.writeVarint(d)}}}function a(e,t){return(t<<3)+(7&e)}function l(e){return e<<1^e>>31}function c(e,t){for(var i=e.loadGeometry(),r=e.type,n=0,o=0,s=i.length,c=0;c<s;c++){var u=i[c],h=1;1===r&&(h=u.length),t.writeVarint(a(1,h));for(var d=3===r?u.length-1:u.length,p=0;p<d;p++){1===p&&1!==r&&t.writeVarint(a(2,d-1));var f=u[p].x-n,m=u[p].y-o;t.writeVarint(l(f)),t.writeVarint(l(m)),n+=f,o+=m}3===r&&t.writeVarint(a(7,1))}}function u(e,t){var i=typeof e;"string"===i?t.writeStringField(1,e):"boolean"===i?t.writeBooleanField(7,e):"number"===i&&(e%1!=0?t.writeDoubleField(3,e):e<0?t.writeSVarintField(6,e):t.writeVarintField(5,e))}return F.exports=r,F.exports.fromVectorTileJs=r,F.exports.fromGeojsonVt=function(e,t){t=t||{};var n={};for(var o in e)n[o]=new i(e[o].features,t),n[o].name=o,n[o].version=t.version,n[o].extent=t.extent;return r({layers:n})},F.exports.GeoJSONWrapper=i,F.exports}(),N=e.e9(B);const j={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e},V=Math.fround||(U=new Float32Array(1),e=>(U[0]=+e,U[0]));var U;const G=3,H=5,W=6;class ${constructor(e){this.options=Object.assign(Object.create(j),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){const{log:t,minZoom:i,maxZoom:r}=this.options;t&&console.time("total time");const n=`prepare ${e.length} points`;t&&console.time(n),this.points=e;const o=[];for(let a=0;a<e.length;a++){const t=e[a];if(!t.geometry)continue;const[i,r]=t.geometry.coordinates,n=V(Y(i)),s=V(Z(r));o.push(n,s,1/0,a,-1,1),this.options.reduce&&o.push(0)}let s=this.trees[r+1]=this._createTree(o);t&&console.timeEnd(n);for(let a=r;a>=i;a--){const e=+Date.now();s=this.trees[a]=this._createTree(this._cluster(s,a)),t&&console.log("z%d: %d clusters in %dms",a,s.numItems,+Date.now()-e)}return t&&console.timeEnd("total time"),this}getClusters(e,t){let i=((e[0]+180)%360+360)%360-180;const r=Math.max(-90,Math.min(90,e[1]));let n=180===e[2]?180:((e[2]+180)%360+360)%360-180;const o=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)i=-180,n=180;else if(i>n){const e=this.getClusters([i,r,180,o],t),s=this.getClusters([-180,r,n,o],t);return e.concat(s)}const s=this.trees[this._limitZoom(t)],a=s.range(Y(i),Z(o),Y(n),Z(r)),l=s.data,c=[];for(const u of a){const e=this.stride*u;c.push(l[e+H]>1?q(l,e,this.clusterProps):this.points[l[e+G]])}return c}getChildren(e){const t=this._getOriginId(e),i=this._getOriginZoom(e),r="No cluster with the specified id.",n=this.trees[i];if(!n)throw new Error(r);const o=n.data;if(t*this.stride>=o.length)throw new Error(r);const s=this.options.radius/(this.options.extent*Math.pow(2,i-1)),a=n.within(o[t*this.stride],o[t*this.stride+1],s),l=[];for(const c of a){const t=c*this.stride;o[t+4]===e&&l.push(o[t+H]>1?q(o,t,this.clusterProps):this.points[o[t+G]])}if(0===l.length)throw new Error(r);return l}getLeaves(e,t,i){const r=[];return this._appendLeaves(r,e,t=t||10,i=i||0,0),r}getTile(e,t,i){const r=this.trees[this._limitZoom(e)],n=Math.pow(2,e),{extent:o,radius:s}=this.options,a=s/o,l=(i-a)/n,c=(i+1+a)/n,u={features:[]};return this._addTileFeatures(r.range((t-a)/n,l,(t+1+a)/n,c),r.data,t,i,n,u),0===t&&this._addTileFeatures(r.range(1-a/n,l,1,c),r.data,n,i,n,u),t===n-1&&this._addTileFeatures(r.range(0,l,a/n,c),r.data,-1,i,n,u),u.features.length?u:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom;){const i=this.getChildren(e);if(t++,1!==i.length)break;e=i[0].properties.cluster_id}return t}_appendLeaves(e,t,i,r,n){const o=this.getChildren(t);for(const s of o){const t=s.properties;if(t&&t.cluster?n+t.point_count<=r?n+=t.point_count:n=this._appendLeaves(e,t.cluster_id,i,r,n):n<r?n++:e.push(s),e.length===i)break}return n}_createTree(t){const i=new e.bE(t.length/this.stride|0,this.options.nodeSize,Float32Array);for(let e=0;e<t.length;e+=this.stride)i.add(t[e],t[e+1]);return i.finish(),i.data=t,i}_addTileFeatures(e,t,i,r,n,o){for(const s of e){const e=s*this.stride,a=t[e+H]>1;let l,c,u;if(a)l=X(t,e,this.clusterProps),c=t[e],u=t[e+1];else{const i=this.points[t[e+G]];l=i.properties;const[r,n]=i.geometry.coordinates;c=Y(r),u=Z(n)}const h={type:1,geometry:[[Math.round(this.options.extent*(c*n-i)),Math.round(this.options.extent*(u*n-r))]],tags:l};let d;d=a||this.options.generateId?t[e+G]:this.points[t[e+G]].id,void 0!==d&&(h.id=d),o.features.push(h)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,t){const{radius:i,extent:r,reduce:n,minPoints:o}=this.options,s=i/(r*Math.pow(2,t)),a=e.data,l=[],c=this.stride;for(let u=0;u<a.length;u+=c){if(a[u+2]<=t)continue;a[u+2]=t;const i=a[u],r=a[u+1],h=e.within(a[u],a[u+1],s),d=a[u+H];let p=d;for(const e of h){const i=e*c;a[i+2]>t&&(p+=a[i+H])}if(p>d&&p>=o){let e,o=i*d,s=r*d,f=-1;const m=(u/c<<5)+(t+1)+this.points.length;for(const i of h){const r=i*c;if(a[r+2]<=t)continue;a[r+2]=t;const l=a[r+H];o+=a[r]*l,s+=a[r+1]*l,a[r+4]=m,n&&(e||(e=this._map(a,u,!0),f=this.clusterProps.length,this.clusterProps.push(e)),n(e,this._map(a,r)))}a[u+4]=m,l.push(o/p,s/p,1/0,m,-1,p),n&&l.push(f)}else{for(let e=0;e<c;e++)l.push(a[u+e]);if(p>1)for(const e of h){const i=e*c;if(!(a[i+2]<=t)){a[i+2]=t;for(let e=0;e<c;e++)l.push(a[i+e])}}}}return l}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t,i){if(e[t+H]>1){const r=this.clusterProps[e[t+W]];return i?Object.assign({},r):r}const r=this.points[e[t+G]].properties,n=this.options.map(r);return i&&n===r?Object.assign({},n):n}}function q(e,t,i){return{type:"Feature",id:e[t+G],properties:X(e,t,i),geometry:{type:"Point",coordinates:[(r=e[t],360*(r-.5)),K(e[t+1])]}};var r}function X(e,t,i){const r=e[t+H],n=r>=1e4?`${Math.round(r/1e3)}k`:r>=1e3?Math.round(r/100)/10+"k":r,o=e[t+W],s=-1===o?{}:Object.assign({},i[o]);return Object.assign(s,{cluster:!0,cluster_id:e[t+G],point_count:r,point_count_abbreviated:n})}function Y(e){return e/360+.5}function Z(e){const t=Math.sin(e*Math.PI/180),i=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return i<0?0:i>1?1:i}function K(e){const t=(180-360*e)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function J(e,t,i,r){let n=r;const o=t+(i-t>>1);let s,a=i-t;const l=e[t],c=e[t+1],u=e[i],h=e[i+1];for(let d=t+3;d<i;d+=3){const t=Q(e[d],e[d+1],l,c,u,h);if(t>n)s=d,n=t;else if(t===n){const e=Math.abs(d-o);e<a&&(s=d,a=e)}}n>r&&(s-t>3&&J(e,t,s,r),e[s+2]=n,i-s>3&&J(e,s,i,r))}function Q(e,t,i,r,n,o){let s=n-i,a=o-r;if(0!==s||0!==a){const l=((e-i)*s+(t-r)*a)/(s*s+a*a);l>1?(i=n,r=o):l>0&&(i+=s*l,r+=a*l)}return s=e-i,a=t-r,s*s+a*a}function ee(e,t,i,r){const n={id:e??null,type:t,geometry:i,tags:r,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if("Point"===t||"MultiPoint"===t||"LineString"===t)te(n,i);else if("Polygon"===t)te(n,i[0]);else if("MultiLineString"===t)for(const o of i)te(n,o);else if("MultiPolygon"===t)for(const o of i)te(n,o[0]);return n}function te(e,t){for(let i=0;i<t.length;i+=3)e.minX=Math.min(e.minX,t[i]),e.minY=Math.min(e.minY,t[i+1]),e.maxX=Math.max(e.maxX,t[i]),e.maxY=Math.max(e.maxY,t[i+1])}function ie(e,t,i,r){if(!t.geometry)return;const n=t.geometry.coordinates;if(n&&0===n.length)return;const o=t.geometry.type,s=Math.pow(i.tolerance/((1<<i.maxZoom)*i.extent),2);let a=[],l=t.id;if(i.promoteId?l=t.properties[i.promoteId]:i.generateId&&(l=r||0),"Point"===o)re(n,a);else if("MultiPoint"===o)for(const c of n)re(c,a);else if("LineString"===o)ne(n,a,s,!1);else if("MultiLineString"===o){if(i.lineMetrics){for(const i of n)a=[],ne(i,a,s,!1),e.push(ee(l,"LineString",a,t.properties));return}oe(n,a,s,!1)}else if("Polygon"===o)oe(n,a,s,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"===o){for(const n of t.geometry.geometries)ie(e,{id:l,geometry:n,properties:t.properties},i,r);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const e of n){const t=[];oe(e,t,s,!0),a.push(t)}}e.push(ee(l,o,a,t.properties))}function re(e,t){t.push(se(e[0]),ae(e[1]),0)}function ne(e,t,i,r){let n,o,s=0;for(let l=0;l<e.length;l++){const i=se(e[l][0]),a=ae(e[l][1]);t.push(i,a,0),l>0&&(s+=r?(n*a-i*o)/2:Math.sqrt(Math.pow(i-n,2)+Math.pow(a-o,2))),n=i,o=a}const a=t.length-3;t[2]=1,J(t,0,a,i),t[a+2]=1,t.size=Math.abs(s),t.start=0,t.end=t.size}function oe(e,t,i,r){for(let n=0;n<e.length;n++){const o=[];ne(e[n],o,i,r),t.push(o)}}function se(e){return e/360+.5}function ae(e){const t=Math.sin(e*Math.PI/180),i=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return i<0?0:i>1?1:i}function le(e,t,i,r,n,o,s,a){if(r/=t,o>=(i/=t)&&s<r)return e;if(s<i||o>=r)return null;const l=[];for(const c of e){const e=c.geometry;let t=c.type;const o=0===n?c.minX:c.minY,s=0===n?c.maxX:c.maxY;if(o>=i&&s<r){l.push(c);continue}if(s<i||o>=r)continue;let u=[];if("Point"===t||"MultiPoint"===t)ce(e,u,i,r,n);else if("LineString"===t)ue(e,u,i,r,n,!1,a.lineMetrics);else if("MultiLineString"===t)de(e,u,i,r,n,!1);else if("Polygon"===t)de(e,u,i,r,n,!0);else if("MultiPolygon"===t)for(const a of e){const e=[];de(a,e,i,r,n,!0),e.length&&u.push(e)}if(u.length){if(a.lineMetrics&&"LineString"===t){for(const e of u)l.push(ee(c.id,t,e,c.tags));continue}"LineString"!==t&&"MultiLineString"!==t||(1===u.length?(t="LineString",u=u[0]):t="MultiLineString"),"Point"!==t&&"MultiPoint"!==t||(t=3===u.length?"Point":"MultiPoint"),l.push(ee(c.id,t,u,c.tags))}}return l.length?l:null}function ce(e,t,i,r,n){for(let o=0;o<e.length;o+=3){const s=e[o+n];s>=i&&s<=r&&pe(t,e[o],e[o+1],e[o+2])}}function ue(e,t,i,r,n,o,s){let a=he(e);const l=0===n?fe:me;let c,u,h=e.start;for(let g=0;g<e.length-3;g+=3){const d=e[g],p=e[g+1],f=e[g+2],m=e[g+3],y=e[g+4],_=0===n?d:p,v=0===n?m:y;let x=!1;s&&(c=Math.sqrt(Math.pow(d-m,2)+Math.pow(p-y,2))),_<i?v>i&&(u=l(a,d,p,m,y,i),s&&(a.start=h+c*u)):_>r?v<r&&(u=l(a,d,p,m,y,r),s&&(a.start=h+c*u)):pe(a,d,p,f),v<i&&_>=i&&(u=l(a,d,p,m,y,i),x=!0),v>r&&_<=r&&(u=l(a,d,p,m,y,r),x=!0),!o&&x&&(s&&(a.end=h+c*u),t.push(a),a=he(e)),s&&(h+=c)}let d=e.length-3;const p=e[d],f=e[d+1],m=0===n?p:f;m>=i&&m<=r&&pe(a,p,f,e[d+2]),d=a.length-3,o&&d>=3&&(a[d]!==a[0]||a[d+1]!==a[1])&&pe(a,a[0],a[1],a[2]),a.length&&t.push(a)}function he(e){const t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function de(e,t,i,r,n,o){for(const s of e)ue(s,t,i,r,n,o,!1)}function pe(e,t,i,r){e.push(t,i,r)}function fe(e,t,i,r,n,o){const s=(o-t)/(r-t);return pe(e,o,i+(n-i)*s,1),s}function me(e,t,i,r,n,o){const s=(o-i)/(n-i);return pe(e,t+(r-t)*s,o,1),s}function ge(e,t){const i=[];for(let r=0;r<e.length;r++){const n=e[r],o=n.type;let s;if("Point"===o||"MultiPoint"===o||"LineString"===o)s=ye(n.geometry,t);else if("MultiLineString"===o||"Polygon"===o){s=[];for(const e of n.geometry)s.push(ye(e,t))}else if("MultiPolygon"===o){s=[];for(const e of n.geometry){const i=[];for(const r of e)i.push(ye(r,t));s.push(i)}}i.push(ee(n.id,o,s,n.tags))}return i}function ye(e,t){const i=[];i.size=e.size,void 0!==e.start&&(i.start=e.start,i.end=e.end);for(let r=0;r<e.length;r+=3)i.push(e[r]+t,e[r+1],e[r+2]);return i}function _e(e,t){if(e.transformed)return e;const i=1<<e.z,r=e.x,n=e.y;for(const o of e.features){const e=o.geometry,s=o.type;if(o.geometry=[],1===s)for(let a=0;a<e.length;a+=2)o.geometry.push(ve(e[a],e[a+1],t,i,r,n));else for(let a=0;a<e.length;a++){const s=[];for(let o=0;o<e[a].length;o+=2)s.push(ve(e[a][o],e[a][o+1],t,i,r,n));o.geometry.push(s)}}return e.transformed=!0,e}function ve(e,t,i,r,n,o){return[Math.round(i*(e*r-n)),Math.round(i*(t*r-o))]}function xe(e,t,i,r,n){const o=t===n.maxZoom?0:n.tolerance/((1<<t)*n.extent),s={features:[],numPoints:0,numSimplified:0,numFeatures:e.length,source:null,x:i,y:r,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const a of e)be(s,a,o,n);return s}function be(e,t,i,r){const n=t.geometry,o=t.type,s=[];if(e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),"Point"===o||"MultiPoint"===o)for(let a=0;a<n.length;a+=3)s.push(n[a],n[a+1]),e.numPoints++,e.numSimplified++;else if("LineString"===o)we(s,n,e,i,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(let a=0;a<n.length;a++)we(s,n[a],e,i,"Polygon"===o,0===a);else if("MultiPolygon"===o)for(let a=0;a<n.length;a++){const t=n[a];for(let r=0;r<t.length;r++)we(s,t[r],e,i,!0,0===r)}if(s.length){let i=t.tags||null;if("LineString"===o&&r.lineMetrics){i={};for(const e in t.tags)i[e]=t.tags[e];i.mapbox_clip_start=n.start/n.size,i.mapbox_clip_end=n.end/n.size}const a={geometry:s,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:i};null!==t.id&&(a.id=t.id),e.features.push(a)}}function we(e,t,i,r,n,o){const s=r*r;if(r>0&&t.size<(n?s:r))return void(i.numPoints+=t.length/3);const a=[];for(let l=0;l<t.length;l+=3)(0===r||t[l+2]>s)&&(i.numSimplified++,a.push(t[l],t[l+1])),i.numPoints++;n&&function(e,t){let i=0;for(let r=0,n=e.length,o=n-2;r<n;o=r,r+=2)i+=(e[r]-e[o])*(e[r+1]+e[o+1]);if(i>0===t)for(let r=0,n=e.length;r<n/2;r+=2){const t=e[r],i=e[r+1];e[r]=e[n-2-r],e[r+1]=e[n-1-r],e[n-2-r]=t,e[n-1-r]=i}}(a,o),e.push(a)}const Se={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Te{constructor(e,t){const i=(t=this.options=function(e,t){for(const i in t)e[i]=t[i];return e}(Object.create(Se),t)).debug;if(i&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");let r=function(e,t){const i=[];if("FeatureCollection"===e.type)for(let r=0;r<e.features.length;r++)ie(i,e.features[r],t,r);else ie(i,"Feature"===e.type?e:{geometry:e},t);return i}(e,t);this.tiles={},this.tileCoords=[],i&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),r=function(e,t){const i=t.buffer/t.extent;let r=e;const n=le(e,1,-1-i,i,0,-1,2,t),o=le(e,1,1-i,2+i,0,-1,2,t);return(n||o)&&(r=le(e,1,-i,1+i,0,-1,2,t)||[],n&&(r=ge(n,1).concat(r)),o&&(r=r.concat(ge(o,-1)))),r}(r,t),r.length&&this.splitTile(r,0,0,0),i&&(r.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(e,t,i,r,n,o,s){const a=[e,t,i,r],l=this.options,c=l.debug;for(;a.length;){r=a.pop(),i=a.pop(),t=a.pop(),e=a.pop();const u=1<<t,h=Me(t,i,r);let d=this.tiles[h];if(!d&&(c>1&&console.time("creation"),d=this.tiles[h]=xe(e,t,i,r,l),this.tileCoords.push({z:t,x:i,y:r}),c)){c>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,i,r,d.numFeatures,d.numPoints,d.numSimplified),console.timeEnd("creation"));const e=`z${t}`;this.stats[e]=(this.stats[e]||0)+1,this.total++}if(d.source=e,null==n){if(t===l.indexMaxZoom||d.numPoints<=l.indexMaxPoints)continue}else{if(t===l.maxZoom||t===n)continue;if(null!=n){const e=n-t;if(i!==o>>e||r!==s>>e)continue}}if(d.source=null,0===e.length)continue;c>1&&console.time("clipping");const p=.5*l.buffer/l.extent,f=.5-p,m=.5+p,g=1+p;let y=null,_=null,v=null,x=null,b=le(e,u,i-p,i+m,0,d.minX,d.maxX,l),w=le(e,u,i+f,i+g,0,d.minX,d.maxX,l);e=null,b&&(y=le(b,u,r-p,r+m,1,d.minY,d.maxY,l),_=le(b,u,r+f,r+g,1,d.minY,d.maxY,l),b=null),w&&(v=le(w,u,r-p,r+m,1,d.minY,d.maxY,l),x=le(w,u,r+f,r+g,1,d.minY,d.maxY,l),w=null),c>1&&console.timeEnd("clipping"),a.push(y||[],t+1,2*i,2*r),a.push(_||[],t+1,2*i,2*r+1),a.push(v||[],t+1,2*i+1,2*r),a.push(x||[],t+1,2*i+1,2*r+1)}}getTile(e,t,i){e=+e,t=+t,i=+i;const r=this.options,{extent:n,debug:o}=r;if(e<0||e>24)return null;const s=1<<e,a=Me(e,t=t+s&s-1,i);if(this.tiles[a])return _e(this.tiles[a],n);o>1&&console.log("drilling down to z%d-%d-%d",e,t,i);let l,c=e,u=t,h=i;for(;!l&&c>0;)c--,u>>=1,h>>=1,l=this.tiles[Me(c,u,h)];return l&&l.source?(o>1&&(console.log("found parent tile z%d-%d-%d",c,u,h),console.time("drilling down")),this.splitTile(l.source,c,u,h,e,t,i),o>1&&console.timeEnd("drilling down"),this.tiles[a]?_e(this.tiles[a],n):null):null}}function Me(e,t,i){return 32*((1<<e)*i+t)+e}function Ae(e,t){const i=e.tileID.canonical;if(!this._geoJSONIndex)return void t(null,null);const r=this._geoJSONIndex.getTile(i.z,i.x,i.y);if(!r)return void t(null,null);const n=new S(r.features);let o=N(n);0===o.byteOffset&&o.byteLength===o.buffer.byteLength||(o=new Uint8Array(o)),t(null,{vectorTile:n,rawData:o.buffer})}class Ce extends _{constructor(e,t,i,r,n,o){super(e,t,i,r,Ae,o),n&&(this.loadGeoJSON=n),this._dynamicIndex=new A}loadData(i,r){const n=i&&i.request,o=n&&n.collectResourceTiming;this.loadGeoJSON(i,((s,a)=>{if(s||!a)return r(s);if("object"!=typeof a)return r(new Error(`Input data given to '${i.source}' is not a valid GeoJSON object.`));{try{if(i.filter){const t=e.U(i.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===t.result)throw new Error(t.value.map((e=>`${e.key}: ${e.message}`)).join(", "));a.features=a.features.filter((e=>t.value.evaluate({zoom:0},e)))}i.dynamic?("Feature"===a.type&&(a={type:"FeatureCollection",features:[a]}),i.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(a.features,this.loaded),i.cluster&&(a.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=i.cluster?new $(function(t){let{superclusterOptions:i,clusterProperties:r}=t;if(!r||!i)return i;const n={},o={},s={accumulated:null,zoom:0},a={properties:null},l=Object.keys(r);for(const c of l){const[t,i]=r[c],s=e.U(i),a=e.U("string"==typeof t?[t,["accumulated"],["get",c]]:t);n[c]=s.value,o[c]=a.value}return i.map=e=>{a.properties=e;const t={};for(const i of l)t[i]=n[i].evaluate(s,a);return t},i.reduce=(e,t)=>{a.properties=t;for(const i of l)s.accumulated=e[i],e[i]=o[i].evaluate(s,a)},i}(i)).load(a.features):i.dynamic?this._dynamicIndex:function(e,t){return new Te(e,t)}(a,i.geojsonVtOptions)}catch(e){return r(e)}const s={};if(o){const e=t(n);e&&(s.resourceTiming={},s.resourceTiming[i.source]=JSON.parse(JSON.stringify(e)))}r(null,s)}}))}reloadTile(e,t){const i=this.loaded;return i&&i[e.uid]?e.partial?t(null,void 0):super.reloadTile(e,t):this.loadTile(e,t)}loadGeoJSON(t,i){if(t.request)e.n(t.request,i);else{if("string"!=typeof t.data)return i(new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`));try{return i(null,JSON.parse(t.data))}catch(e){return i(new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(e,t){try{t(null,this._geoJSONIndex.getClusterExpansionZoom(e.clusterId))}catch(e){t(e)}}getClusterChildren(e,t){try{t(null,this._geoJSONIndex.getChildren(e.clusterId))}catch(e){t(e)}}getClusterLeaves(e,t){try{t(null,this._geoJSONIndex.getLeaves(e.clusterId,e.limit,e.offset))}catch(e){t(e)}}}class Ee{constructor(t,i){this.tileID=new e.aG(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.canonical=t.tileID.canonical,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=t.projection,this.brightness=i}parse(t,i,r,n){this.status="parsing";const o=new e.aG(r.tileID.overscaledZ,r.tileID.wrap,r.tileID.canonical.z,r.tileID.canonical.x,r.tileID.canonical.y),s=[],a=i.familiesBySource[r.source],l=new e.d$(o,r.promoteId);return l.bucketLayerIDs=[],l.is3DTile=!0,e.ea(t).then((t=>{if(!t)return n(new Error("Could not parse tile"));const i=e.eb(t,1/e.cc(r.tileID.canonical)),c=t.json.extensionsUsed&&t.json.extensionsUsed.includes("MAPBOX_mesh_features")||t.json.asset.extras&&t.json.asset.extras.MAPBOX_mesh_features,u=t.json.extensionsUsed&&t.json.extensionsUsed.includes("EXT_meshopt_compression"),h=new e.a8(this.zoom,{brightness:this.brightness});for(const r in a)for(const t of a[r]){const r=t[0];l.bucketLayerIDs.push(t.map((t=>e.aC(t.id,t.scope)))),r.recalculate(h,[]);const n=new e.ec(t,i,o,c,u,this.brightness,l);c||(n.needsUpload=!0),s.push(n),n.evaluate(r)}this.status="done",n(null,{buckets:s,featureIndex:l,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})})).catch((e=>n(new Error(e.message))))}}class Pe{constructor(e,t,i,r,n,o){this.actor=e,this.layerIndex=t,this.availableImages=i,this.brightness=o,this.loading={},this.loaded={}}loadTile(t,i){const r=t.uid,n=this.loading[r]=new Ee(t,this.brightness);e.bi(t.request,((e,o)=>{const s=!this.loading[r];return delete this.loading[r],s||e?(n.status="done",s||(this.loaded[r]=n),i(e)):o&&0!==o.byteLength?void n.parse(o,this.layerIndex,t,((e,t)=>{n.status="done",this.loaded=this.loaded||{},this.loaded[r]=n,e||!t?i(e):i(null,t)})):(n.status="done",this.loaded[r]=n,i())}))}reloadTile(e,t){const i=this.loaded,r=e.uid;if(i&&i[r]){const n=i[r];n.projection=e.projection,n.brightness=e.brightness;const o=(i,r)=>{n.reloadCallback&&(delete n.reloadCallback,this.loadTile(e,t)),t(i,r)};"parsing"===n.status?n.reloadCallback=o:"done"===n.status&&this.loadTile(e,t)}}abortTile(e,t){const i=e.uid;this.loading[i]&&delete this.loading[i],t()}removeTile(e,t){const i=this.loaded,r=e.uid;i&&i[r]&&delete i[r],t()}}class ke{constructor(t){this.self=t,this.actor=new e.ed(t,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.imageRasterizer=new e.I,this.projections={},this.defaultProjection=e.bP({name:"mercator"}),this.workerSourceTypes={vector:_,geojson:Ce,"batched-model":Pe},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(e,t)=>{if(this.workerSourceTypes[e])throw new Error(`Worker source with name "${e}" already registered.`);this.workerSourceTypes[e]=t},this.self.registerRTLTextPlugin=t=>{if(e.ee.isParsed())throw new Error("RTL text plugin already registered.");e.ee.applyArabicShaping=t.applyArabicShaping,e.ee.processBidirectionalText=t.processBidirectionalText,e.ee.processStyledBidirectionalText=t.processStyledBidirectionalText}}clearCaches(e,t,i){delete this.layerIndexes[e],delete this.availableImages[e],delete this.workerSources[e],delete this.demWorkerSources[e],delete this.rasterArrayWorkerSource,i()}checkIfReady(e,t,i){i()}setReferrer(e,t){this.referrer=t}spriteLoaded(t,i){let{scope:r,isLoaded:n}=i;if(this.isSpriteLoaded[t]||(this.isSpriteLoaded[t]={}),this.isSpriteLoaded[t][r]=n,this.workerSources[t]&&this.workerSources[t][r])for(const o in this.workerSources[t][r]){const i=this.workerSources[t][r][o];for(const t in i){const r=i[t];r instanceof _&&(r.isSpriteLoaded=n,r.fire(new e.z("isSpriteLoaded")))}}}setImages(e,t,i){let{scope:r,images:n}=t;if(this.availableImages[e]||(this.availableImages[e]={}),this.availableImages[e][r]=n,this.workerSources[e]&&this.workerSources[e][r]){for(const t in this.workerSources[e][r]){const i=this.workerSources[e][r][t];for(const e in i)i[e].availableImages=n}i()}else i()}setProjection(t,i){this.projections[t]=e.bP(i)}setBrightness(e,t,i){this.brightness=t,i()}setLayers(e,t,i){this.getLayerIndex(e,t.scope).replace(t.layers,t.options),i()}updateLayers(e,t,i){this.getLayerIndex(e,t.scope).update(t.layers,t.removedIds,t.options),i()}loadTile(e,t,i){t.projection=this.projections[e]||this.defaultProjection,this.getWorkerSource(e,t.type,t.source,t.scope).loadTile(t,i)}loadDEMTile(e,t,i){this.getDEMWorkerSource(e,t.source,t.scope).loadTile(t,i)}decodeRasterArray(e,t,i){this.getRasterArrayWorkerSource().decodeRasterArray(t,i)}reloadTile(e,t,i){t.projection=this.projections[e]||this.defaultProjection,this.getWorkerSource(e,t.type,t.source,t.scope).reloadTile(t,i)}abortTile(e,t,i){this.getWorkerSource(e,t.type,t.source,t.scope).abortTile(t,i)}removeTile(e,t,i){this.getWorkerSource(e,t.type,t.source,t.scope).removeTile(t,i)}removeSource(e,t,i){if(!(this.workerSources[e]&&this.workerSources[e][t.scope]&&this.workerSources[e][t.scope][t.type]&&this.workerSources[e][t.scope][t.type][t.source]))return;const r=this.workerSources[e][t.scope][t.type][t.source];delete this.workerSources[e][t.scope][t.type][t.source],void 0!==r.removeSource?r.removeSource(t,i):i()}loadWorkerSource(e,t,i){try{this.self.importScripts(t.url),i()}catch(e){i(e.toString())}}syncRTLPluginState(t,i,r){try{e.ee.setState(i);const t=e.ee.getPluginURL();if(e.ee.isLoaded()&&!e.ee.isParsed()&&null!=t){this.self.importScripts(t);const i=e.ee.isParsed();r(i?void 0:new Error(`RTL Text Plugin failed to import scripts from ${t}`),i)}}catch(e){r(e.toString())}}setDracoUrl(e,t){this.dracoUrl=t}getAvailableImages(e,t){this.availableImages[e]||(this.availableImages[e]={});let i=this.availableImages[e][t];return i||(i=[]),i}getLayerIndex(e,t){this.layerIndexes[e]||(this.layerIndexes[e]={});let i=this.layerIndexes[e][t];return i||(i=this.layerIndexes[e][t]=new n,i.scope=t),i}getWorkerSource(e,t,i,r){return this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][r]||(this.workerSources[e][r]={}),this.workerSources[e][r][t]||(this.workerSources[e][r][t]={}),this.isSpriteLoaded[e]||(this.isSpriteLoaded[e]={}),this.workerSources[e][r][t][i]||(this.workerSources[e][r][t][i]=new this.workerSourceTypes[t]({send:(t,i,r,n,o,s)=>{this.actor.send(t,i,r,e,o,s)},scheduler:this.actor.scheduler},this.getLayerIndex(e,r),this.getAvailableImages(e,r),this.isSpriteLoaded[e][r],void 0,this.brightness)),this.workerSources[e][r][t][i]}rasterizeImages(e,t,i){const{imageTasks:r,scope:n}=t,o={};for(const s in r){const{image:t,imageIdWithOptions:i}=r[s];o[s]=this.imageRasterizer.rasterize(i,t,n,e)}i(void 0,o)}removeRasterizedImages(e,t,i){const{imageIds:r,scope:n}=t;this.imageRasterizer.removeImagesFromCacheByIds(r,n,e),i()}getDEMWorkerSource(e,t,i){return this.demWorkerSources[e]||(this.demWorkerSources[e]={}),this.demWorkerSources[e][i]||(this.demWorkerSources[e][i]={}),this.demWorkerSources[e][i][t]||(this.demWorkerSources[e][i][t]=new v),this.demWorkerSources[e][i][t]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new x),this.rasterArrayWorkerSource}enforceCacheSizeLimit(t,i){e.ef(i)}getWorkerPerformanceMetrics(e,t,i){i(void 0,void 0)}}return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new ke(self)),ke})),r(["./shared"],(function(e){var t="3.10.0";const i={create:"create",load:"load",fullLoad:"fullLoad"},r={mark(e){performance.mark(e)},measure(e,t,i){performance.measure(e,t,i)}};function n(t){const i=t.name.split("?")[0];return e.a(i)&&i.includes("mapbox-gl.js")?"javascript":e.a(i)&&i.includes("mapbox-gl.css")?"css":e.b(i)?"fontRange":e.c(i)?"sprite":e.i(i)?"style":e.d(i)?"tilejson":"other"}var o,s={},a=function(){if(o)return s;function e(e){return!t(e)}function t(t){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var e,t,i=new Blob([""],{type:"text/javascript"}),r=URL.createObjectURL(i);try{t=new Worker(r),e=!0}catch(t){e=!1}return t&&t.terminate(),URL.revokeObjectURL(r),e}()?function(){var e=document.createElement("canvas");e.width=e.height=1;var t=e.getContext("2d");if(!t)return!1;var i=t.getImageData(0,0,1,1);return i&&i.width===e.width}()?(void 0===i[r=t&&t.failIfMajorPerformanceCaveat]&&(i[r]=function(t){var i,r=function(t){var i=document.createElement("canvas"),r=Object.create(e.webGLContextAttributes);return r.failIfMajorPerformanceCaveat=t,i.getContext("webgl2",r)}(t);if(!r)return!1;try{i=r.createShader(r.VERTEX_SHADER)}catch(e){return!1}return!(!i||r.isContextLost())&&(r.shaderSource(i,"void main() {}"),r.compileShader(i),!0===r.getShaderParameter(i,r.COMPILE_STATUS))}(r)),i[r]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var r}o=1,s.supported=e,s.notSupportedReason=t;var i={};return e.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},s}();function l(e,t,i){const r=document.createElement(e);return null!=t&&(r.className=t),i&&i.appendChild(r),r}function c(e,t,i){const r=document.createElementNS("http://www.w3.org/2000/svg",e);for(const n of Object.keys(t))r.setAttributeNS(null,n,String(t[n]));return i&&i.appendChild(r),r}const u="undefined"!=typeof document?document.documentElement&&document.documentElement.style:null,h=u&&void 0!==u.userSelect?"userSelect":"WebkitUserSelect";let d;function p(){u&&h&&(d=u[h],u[h]="none")}function f(){u&&h&&(u[h]=d)}function m(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",m,!0)}function g(){window.addEventListener("click",m,!0),window.setTimeout((()=>{window.removeEventListener("click",m,!0)}),0)}function y(e,t){const i=e.getBoundingClientRect();return x(e,i,t)}function _(e,t){const i=e.getBoundingClientRect(),r=[];for(let n=0;n<t.length;n++)r.push(x(e,i,t[n]));return r}function v(e){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&2===e.button&&e.ctrlKey?0:e.button}function x(t,i,r){const n=t.offsetWidth===i.width?1:t.offsetWidth/i.width;return new e.P((r.clientX-i.left)*n,(r.clientY-i.top)*n)}const b="01",w="NO_ACCESS_TOKEN";class S{constructor(e,t,i){this._transformRequestFn=e,this._customAccessToken=t,this._silenceAuthErrors=!!i,this._createSkuToken()}_createSkuToken(){const e=function(){let e="";for(let t=0;t<10;t++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",b,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}}normalizeStyleURL(i,r){if(!e.f(i))return i;const n=M(i);return n.params.push(`sdk=js-${t}`),n.path=`/styles/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||r)}normalizeGlyphsURL(t,i){if(!e.f(t))return t;const r=M(t);return r.path=`/fonts/v1${r.path}`,this._makeAPIURL(r,this._customAccessToken||i)}normalizeModelURL(t,i){if(!e.f(t))return t;const r=M(t);return r.path=`/models/v1${r.path}`,this._makeAPIURL(r,this._customAccessToken||i)}normalizeSourceURL(t,i,r,n){if(!e.f(t))return t;const o=M(t);return o.path=`/v4/${o.authority}.json`,o.params.push("secure"),r&&o.params.push(`language=${r}`),n&&o.params.push(`worldview=${n}`),this._makeAPIURL(o,this._customAccessToken||i)}normalizeIconsetURL(t,i){const r=M(t);return e.f(t)?(r.path=`/styles/v1${r.path}/iconset.pbf`,this._makeAPIURL(r,this._customAccessToken||i)):A(r)}normalizeSpriteURL(t,i,r,n){const o=M(t);return e.f(t)?(o.path=`/styles/v1${o.path}/sprite${i}${r}`,this._makeAPIURL(o,this._customAccessToken||n)):(o.path+=`${i}${r}`,A(o))}normalizeTileURL(t,i,r){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!e.f(t))return t;const n=M(t);n.path=n.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${i||r&&"raster"!==n.authority&&512===r?"@2x":""}${e.m.supported?".webp":"$1"}`),"raster"===n.authority?n.path=`/${e.e.RASTER_URL_PREFIX}${n.path}`:"rasterarrays"===n.authority?n.path=`/${e.e.RASTERARRAYS_URL_PREFIX}${n.path}`:"3dtiles"===n.authority?n.path=`/${e.e.TILES3D_URL_PREFIX}${n.path}`:(n.path=n.path.replace(/^.+\/v4\//,"/"),n.path=`/${e.e.TILE_URL_VERSION}${n.path}`);const o=this._customAccessToken||function(e){for(const t of e){const e=t.match(/^access_token=(.*)$/);if(e)return e[1]}return null}(n.params)||e.e.ACCESS_TOKEN;return e.e.REQUIRE_ACCESS_TOKEN&&o&&this._skuToken&&n.params.push(`sku=${this._skuToken}`),this._makeAPIURL(n,o)}canonicalizeTileURL(t,i){const r=M(t);if(!r.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!r.path.match(/\.[\w]+$/))return t;let n="mapbox://";r.path.match(/^\/raster\/v1\//)?n+=`raster/${r.path.replace(`/${e.e.RASTER_URL_PREFIX}/`,"")}`:r.path.match(/^\/rasterarrays\/v1\//)?n+=`rasterarrays/${r.path.replace(`/${e.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:n+=`tiles/${r.path.replace(`/${e.e.TILE_URL_VERSION}/`,"")}`;let o=r.params;return i&&(o=o.filter((e=>!e.match(/^access_token=/)))),o.length&&(n+=`?${o.join("&")}`),n}canonicalizeTileset(t,i){const r=!!i&&e.f(i),n=[];for(const o of t.tiles||[])e.h(o)?n.push(this.canonicalizeTileURL(o,r)):n.push(o);return n}_makeAPIURL(t,i){const r="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",n=M(e.e.API_URL);if(t.protocol=n.protocol,t.authority=n.authority,"http"===t.protocol){const e=t.params.indexOf("secure");e>=0&&t.params.splice(e,1)}if("/"!==n.path&&(t.path=`${n.path}${t.path}`),!e.e.REQUIRE_ACCESS_TOKEN)return A(t);if(i=i||e.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!i)throw new Error(`An API access token is required to use Mapbox GL. ${r}`);if("s"===i[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${r}`)}return t.params=t.params.filter((e=>-1===e.indexOf("access_token"))),t.params.push(`access_token=${i||""}`),A(t)}}const T=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function M(e){const t=e.match(T);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function A(e){const t=e.params.length?`?${e.params.join("&")}`:"";return`${e.protocol}://${e.authority}${e.path}${t}`}const C="mapbox.eventData";function E(t){if(!t)return null;const i=t.split(".");if(!i||3!==i.length)return null;try{return JSON.parse(e.j(i[1]))}catch(e){return null}}class P{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){const i=E(e.e.ACCESS_TOKEN);let r="";return r=i&&i.u?e.k(i.u):e.e.ACCESS_TOKEN||"",t?`${C}.${t}:${r}`:`${C}:${r}`}fetchEventData(){const t=e.s("localStorage"),i=this.getStorageKey(),r=this.getStorageKey("uuid");if(t)try{const e=localStorage.getItem(i);e&&(this.eventData=JSON.parse(e));const t=localStorage.getItem(r);t&&(this.anonId=t)}catch(t){e.w("Unable to read from LocalStorage")}}saveEventData(){const t=e.s("localStorage"),i=this.getStorageKey(),r=this.getStorageKey("uuid"),n=this.anonId;if(t&&n)try{localStorage.setItem(r,n),Object.keys(this.eventData).length>=1&&localStorage.setItem(i,JSON.stringify(this.eventData))}catch(t){e.w("Unable to write to LocalStorage")}}processRequests(e){}postEvent(t,i,r,n){if(!e.e.EVENTS_URL)return;const o=M(e.e.EVENTS_URL);o.params.push(`access_token=${n||e.e.ACCESS_TOKEN||""}`);const s={event:this.type,created:new Date(t).toISOString()},a=i?e.l(s,i):s,l={url:A(o),headers:{"Content-Type":"text/plain"},body:JSON.stringify([a])};this.pendingRequest=e.p(l,(e=>{this.pendingRequest=null,r(e),this.saveEventData(),this.processRequests(n)}))}queueRequest(e,t){this.queue.push(e),this.processRequests(t)}}const k=new class extends P{constructor(e){super("appUserTurnstile"),this._customAccessToken=e}postTurnstileEvent(t,i){e.e.EVENTS_URL&&e.e.ACCESS_TOKEN&&Array.isArray(t)&&t.some((t=>e.f(t)||e.h(t)))&&this.queueRequest(Date.now(),i)}processRequests(i){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const r=E(e.e.ACCESS_TOKEN),n=r?r.u:e.e.ACCESS_TOKEN;let o=n!==this.eventData.tokenU;e.v(this.anonId)||(this.anonId=e.u(),o=!0);const s=this.queue.shift();if(this.eventData.lastSuccess){const e=new Date(this.eventData.lastSuccess),t=new Date(s),i=(s-this.eventData.lastSuccess)/864e5;o=o||i>=1||i<-1||e.getDate()!==t.getDate()}else o=!0;o?this.postEvent(s,{sdkIdentifier:"mapbox-gl-js",sdkVersion:t,skuId:b,"enabled.telemetry":!1,userId:this.anonId},(e=>{e||(this.eventData.lastSuccess=s,this.eventData.tokenU=n)}),i):this.processRequests()}},I=k.postTurnstileEvent.bind(k),D=new class extends P{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(t,i,r,n){this.skuToken=i,this.errorCb=n,e.e.EVENTS_URL&&(r||e.e.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},r):this.errorCb(new Error(w)))}processRequests(i){if(this.pendingRequest||0===this.queue.length)return;const{id:r,timestamp:n}=this.queue.shift();r&&this.success[r]||(this.anonId||this.fetchEventData(),e.v(this.anonId)||(this.anonId=e.u()),this.postEvent(n,{sdkIdentifier:"mapbox-gl-js",sdkVersion:t,skuId:b,skuToken:this.skuToken,userId:this.anonId},(e=>{e?this.errorCb(e):r&&(this.success[r]=!0)}),i))}remove(){this.errorCb=null}},L=D.postMapLoadEvent.bind(D),R=new class extends P{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(t){let i=this.mapInstanceIdMap.get(t);return i||(i=e.u(),this.mapInstanceIdMap.set(t,i)),i}getEventId(e){const t=this.eventIdPerMapInstanceMap.get(e)||0;return this.eventIdPerMapInstanceMap.set(e,t+1),t}postStyleLoadEvent(t,i){const{map:r,style:n,importedStyles:o}=i;if(!e.e.EVENTS_URL||!t&&!e.e.ACCESS_TOKEN)return;const s=this.getMapInstanceId(r),a={mapInstanceId:s,eventId:this.getEventId(s),style:n};o.length&&(a.importedStyles=o),this.queueRequest({timestamp:Date.now(),payload:a},t)}processRequests(e){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:t,payload:i}=this.queue.shift();this.postEvent(t,i,(()=>{}),e)}},z=R.postStyleLoadEvent.bind(R),O=new class extends P{constructor(){super("gljs.performance")}postPerformanceEvent(t,i){e.e.EVENTS_URL&&(t||e.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:i},t)}processRequests(r){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:o,performanceData:s}=this.queue.shift(),a=function(r){const o=performance.getEntriesByType("resource"),s=performance.getEntriesByType("mark"),a=function(e){const t={};if(e)for(const i in e)if("other"!==i)for(const r of e[i]){const e=`${i}ResolveRangeMin`,n=`${i}ResolveRangeMax`,o=`${i}RequestCount`,s=`${i}RequestCachedCount`;t[e]=Math.min(t[e]||1/0,r.startTime),t[n]=Math.max(t[n]||-1/0,r.responseEnd);const a=e=>{void 0===t[e]&&(t[e]=0),++t[e]};void 0!==r.transferSize&&0===r.transferSize&&a(s),a(o)}return t}(function(e,t){const i={};if(e)for(const r of e){const e=t(r);void 0===i[e]&&(i[e]=[]),i[e].push(r)}return i}(o,n)),l=window.devicePixelRatio,c=navigator.connection||navigator.mozConnection||navigator.webkitConnection,u=c?c.effectiveType:void 0,h={counters:[],metadata:[],attributes:[]},d=(e,t,i)=>{null!=i&&e.push({name:t,value:i.toString()})};for(const e in a)d(h.counters,e,a[e]);if(r.interactionRange[0]!==1/0&&r.interactionRange[1]!==-1/0&&(d(h.counters,"interactionRangeMin",r.interactionRange[0]),d(h.counters,"interactionRangeMax",r.interactionRange[1])),s)for(const e of Object.keys(i)){const t=i[e],r=s.find((e=>e.name===t));r&&d(h.counters,t,r.startTime)}return d(h.counters,"visibilityHidden",r.visibilityHidden),d(h.attributes,"style",function(t){if(t)for(const i of t){const t=i.name.split("?")[0];if(e.i(t)){const e=t.split("/").slice(-2);if(2===e.length)return`mapbox://styles/${e[0]}/${e[1]}`}}}(o)),d(h.attributes,"terrainEnabled",r.terrainEnabled?"true":"false"),d(h.attributes,"fogEnabled",r.fogEnabled?"true":"false"),d(h.attributes,"projection",r.projection),d(h.attributes,"zoom",r.zoom),d(h.metadata,"devicePixelRatio",l),d(h.metadata,"connectionEffectiveType",u),d(h.metadata,"navigatorUserAgent",navigator.userAgent),d(h.metadata,"screenWidth",window.screen.width),d(h.metadata,"screenHeight",window.screen.height),d(h.metadata,"windowWidth",window.innerWidth),d(h.metadata,"windowHeight",window.innerHeight),d(h.metadata,"mapWidth",r.width/l),d(h.metadata,"mapHeight",r.height/l),d(h.metadata,"webglRenderer",r.renderer),d(h.metadata,"webglVendor",r.vendor),d(h.metadata,"sdkVersion",t),d(h.metadata,"sdkIdentifier","mapbox-gl-js"),h}(s);for(const e of a.metadata);for(const e of a.counters);for(const e of a.attributes);this.postEvent(o,a,(()=>{}),r)}},F=O.postPerformanceEvent.bind(O),B=new class extends P{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(t,i,r,n){if(!e.e.API_URL||!e.e.SESSION_PATH)return;const o=M(e.e.API_URL+e.e.SESSION_PATH);o.params.push(`sku=${i||""}`),o.params.push(`access_token=${n||e.e.ACCESS_TOKEN||""}`);const s={url:A(o),headers:{"Content-Type":"text/plain"}};this.pendingRequest=e.g(s,(e=>{this.pendingRequest=null,r(e),this.saveEventData(),this.processRequests(n)}))}getSessionAPI(t,i,r,n){this.skuToken=i,this.errorCb=n,e.e.SESSION_PATH&&e.e.API_URL&&(r||e.e.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},r):this.errorCb(new Error(w)))}processRequests(e){if(this.pendingRequest||0===this.queue.length)return;const{id:t,timestamp:i}=this.queue.shift();t&&this.success[t]||this.getSession(i,this.skuToken,(e=>{e?this.errorCb(e):t&&(this.success[t]=!0)}),e)}remove(){this.errorCb=null}},N=B.getSessionAPI.bind(B),j=new Set;function V(e,t){t?j.add(e):j.delete(e)}class U{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(e,t){this._updatedSourceCaches[e]=t,this.setDirty()}discardSourceCacheUpdate(e){delete this._updatedSourceCaches[e]}updateLayer(e){const t=e.scope;this._updatedLayers[t]=this._updatedLayers[t]||new Set,this._updatedLayers[t].add(e.id),this.setDirty()}removeLayer(e){const t=e.scope;this._removedLayers[t]=this._removedLayers[t]||{},this._updatedLayers[t]=this._updatedLayers[t]||new Set,this._removedLayers[t][e.id]=e,this._updatedLayers[t].delete(e.id),this._updatedPaintProps.delete(e.fqid),this.setDirty()}getRemovedLayer(e){return this._removedLayers[e.scope]?this._removedLayers[e.scope][e.id]:null}discardLayerRemoval(e){this._removedLayers[e.scope]&&delete this._removedLayers[e.scope][e.id]}getLayerUpdatesByScope(){const e={};for(const t in this._updatedLayers)e[t]=e[t]||{},e[t].updatedIds=Array.from(this._updatedLayers[t].values());for(const t in this._removedLayers)e[t]=e[t]||{},e[t].removedIds=Object.keys(this._removedLayers[t]);return e}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(e){this._updatedPaintProps.add(e.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(e){this._updatedImages.add(e),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function G(e){const{userImage:t}=e;return!!(t&&t.render&&t.render())&&(e.data.replace(new Uint8Array(t.data.buffer)),!0)}class H extends e.E{constructor(t){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0,this.spriteFormat=t,"raster"!==t&&e.t()&&(this.imageRasterizerDispatcher=new e.D(e.x(),this,"Image Rasterizer Worker",1))}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new e.I),this._imageRasterizer}createScope(t){this.images[t]={},this.loaded[t]=!1,this.updatedImages[t]={},this.patterns[t]={},this.callbackDispatchedThisFrame[t]={},this.atlasImage[t]=new e.r({width:1,height:1})}isLoaded(){for(const e in this.loaded)if(!this.loaded[e])return!1;return!0}setLoaded(e,t){if(this.loaded[t]!==e&&(this.loaded[t]=e,e)){for(const{ids:e,callback:i}of this.requestors)this._notify(e,t,i);this.requestors=[]}}hasImage(e,t){return!!this.getImage(e,t)}getImage(e,t){return this.images[t][e]}addImage(e,t,i){this._validate(e,i)&&(this.images[t][e]=i)}_validate(t,i){let r=!0;return this._validateStretch(i.stretchX,i.data&&i.data.width)||(this.fire(new e.y(new Error(`Image "${t}" has invalid "stretchX" value`))),r=!1),this._validateStretch(i.stretchY,i.data&&i.data.height)||(this.fire(new e.y(new Error(`Image "${t}" has invalid "stretchY" value`))),r=!1),this._validateContent(i.content,i)||(this.fire(new e.y(new Error(`Image "${t}" has invalid "content" value`))),r=!1),r}_validateStretch(e,t){if(!e)return!0;let i=0;for(const r of e){if(r[0]<i||r[1]<r[0]||t<r[1])return!1;i=r[1]}return!0}_validateContent(e,t){if(!e)return!0;if(4!==e.length)return!1;if(!t.usvg){if(e[0]<0||t.data.width<e[0])return!1;if(e[1]<0||t.data.height<e[1])return!1;if(e[2]<0||t.data.width<e[2])return!1;if(e[3]<0||t.data.height<e[3])return!1}return!(e[2]<e[0]||e[3]<e[1])}updateImage(e,t,i){i.version=this.images[t][e].version+1,this.images[t][e]=i,this.updatedImages[t][e]=!0,this.removeFromImageRasterizerCache(e,t)}removeFromImageRasterizerCache(t,i){"raster"!==this.spriteFormat&&(e.t()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[t],scope:i}):this.imageRasterizer.removeImagesFromCacheByIds([t],i))}removeImage(e,t){const i=this.images[t][e];delete this.images[t][e],delete this.patterns[t][e],this.removeFromImageRasterizerCache(e,t),i.userImage&&i.userImage.onRemove&&i.userImage.onRemove()}listImages(e){return Object.keys(this.images[e])}getImages(e,t,i){let r=!0;const n=!!this.loaded[t];if(!n)for(const o of e)this.images[t][o]||(r=!1);n||r?this._notify(e,t,i):this.requestors.push({ids:e,scope:t,callback:i})}rasterizeImages(t,i){let{scope:r,imageTasks:n}=t;const o={};for(const e in n){const t=n[e],i=this.getImage(t.id,r);i&&(o[e]={image:i,imageIdWithOptions:t})}e.t()?this.imageRasterizerDispatcher.getActor().send("rasterizeImages",{imageTasks:o,scope:r},i):this.rasterizeImagesInMainThread({imageTasks:o,scope:r},i)}rasterizeImagesInMainThread(e,t){const{imageTasks:i,scope:r}=e,n={};for(const o in i){const{image:e,imageIdWithOptions:t}=i[o];n[o]=this.imageRasterizer.rasterize(t,e,r,"")}t(void 0,n)}getUpdatedImages(e){return this.updatedImages[e]}_notify(t,i,r){const n={};for(const o of t){this.images[i][o]||this.fire(new e.z("styleimagemissing",{id:o}));const t=this.images[i][o];t?n[o]={data:t.usvg?null:t.data.clone(),pixelRatio:t.pixelRatio,sdf:t.sdf,usvg:t.usvg,version:t.version,stretchX:t.stretchX,stretchY:t.stretchY,content:t.content,hasRenderCallback:Boolean(t.userImage&&t.userImage.render)}:e.w(`Image "${o}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}r(null,n)}getPixelSize(e){const{width:t,height:i}=this.atlasImage[e];return{width:t,height:i}}getPattern(t,i,r){const n=this.patterns[i][t],o=this.getImage(t,i);if(!o)return null;if(n&&n.position.version===o.version)return n.position;if(n)n.position.version=o.version;else{o.usvg&&!o.data&&(o.data=this.imageRasterizer.rasterize(e.A.from(t).getPrimary(),o,i,""));const r={w:o.data.width+2*e.B,h:o.data.height+2*e.B,x:0,y:0},n=new e.C(r,o,e.B);this.patterns[i][t]={bin:r,position:n}}return this._updatePatternAtlas(i,r),this.patterns[i][t].position}bind(t,i){const r=t.gl;let n=this.atlasTexture[i];n?this.dirty&&(n.update(this.atlasImage[i]),this.dirty=!1):(n=new e.T(t,this.atlasImage[i],r.RGBA8),this.atlasTexture[i]=n),n.bind(r.LINEAR,r.CLAMP_TO_EDGE)}_updatePatternAtlas(t,i){const r=[];for(const e in this.patterns[t])r.push(this.patterns[t][e].bin);const{w:n,h:o}=e.F(r),s=this.atlasImage[t];s.resize({width:n||1,height:o||1});for(const a in this.patterns[t]){const{bin:r,position:n}=this.patterns[t][a];let o=n.padding;const l=r.x+o,c=r.y+o,u=this.images[t][a].data,h=u.width,d=u.height;o=o>1?o-1:o,e.r.copy(u,s,{x:0,y:0},{x:l,y:c},{width:h,height:d},i),e.r.copy(u,s,{x:0,y:d-o},{x:l,y:c-o},{width:h,height:o},i),e.r.copy(u,s,{x:0,y:0},{x:l,y:c+d},{width:h,height:o},i),e.r.copy(u,s,{x:h-o,y:0},{x:l-o,y:c},{width:o,height:d},i),e.r.copy(u,s,{x:0,y:0},{x:l+h,y:c},{width:o,height:d},i),e.r.copy(u,s,{x:h-o,y:d-o},{x:l-o,y:c-o},{width:o,height:o},i),e.r.copy(u,s,{x:0,y:d-o},{x:l+h,y:c-o},{width:o,height:o},i),e.r.copy(u,s,{x:0,y:0},{x:l+h,y:c+d},{width:o,height:o},i),e.r.copy(u,s,{x:h-o,y:0},{x:l-o,y:c+d},{width:o,height:o},i)}this.dirty=!0}beginFrame(){for(const e in this.images)this.callbackDispatchedThisFrame[e]={}}dispatchRenderCallbacks(e,t){for(const i of e){if(this.callbackDispatchedThisFrame[t][i])continue;this.callbackDispatchedThisFrame[t][i]=!0;const e=this.images[t][i];G(e)&&this.updateImage(i,t,e)}}}function W(t){const i=t.key,r=t.value,n=t.valueSpec||{},o=t.objectElementValidators||{},s=t.style,a=t.styleSpec;let l=[];const c=e.H(r);if("object"!==c)return[new e.V(i,r,`object expected, ${c} found`)];for(const u in r){const t=u.split(".")[0];let c;o[t]?c=o[t]:n[t]?c=pe:o["*"]?c=o["*"]:n["*"]&&(c=pe),c?l=l.concat(c({key:(i?`${i}.`:i)+u,value:r[u],valueSpec:n[t]||n["*"],style:s,styleSpec:a,object:r,objectKey:u},r)):l.push(new e.G(i,r[u],`unknown property "${u}"`))}for(const u in n)o[u]||n[u].required&&void 0===n[u].default&&void 0===r[u]&&l.push(new e.V(i,r,`missing required property "${u}"`));return l}function $(t){const i=t.value,r=t.valueSpec,n=t.style,o=t.styleSpec,s=t.key,a=t.arrayElementValidator||pe;if("array"!==e.H(i))return[new e.V(s,i,`array expected, ${e.H(i)} found`)];if(r.length&&i.length!==r.length)return[new e.V(s,i,`array length ${r.length} expected, length ${i.length} found`)];if(r["min-length"]&&i.length<r["min-length"])return[new e.V(s,i,`array length at least ${r["min-length"]} expected, length ${i.length} found`)];let l={type:r.value,values:r.values,minimum:r.minimum,maximum:r.maximum,function:void 0};o.$version<7&&(l.function=r.function),"object"===e.H(r.value)&&(l=r.value);let c=[];for(let e=0;e<i.length;e++)c=c.concat(a({array:i,arrayIndex:e,value:i[e],valueSpec:l,style:n,styleSpec:o,key:`${s}[${e}]`},!0));return c}function q(t){const i=t.key,r=t.value,n=t.valueSpec;let o=e.H(r);if("number"===o&&r!=r&&(o="NaN"),"number"!==o)return[new e.V(i,r,`number expected, ${o} found`)];if("minimum"in n){let o=n.minimum;if("array"===e.H(n.minimum)&&(o=n.minimum[t.arrayIndex]),r<o)return[new e.V(i,r,`${r} is less than the minimum value ${o}`)]}if("maximum"in n){let o=n.maximum;if("array"===e.H(n.maximum)&&(o=n.maximum[t.arrayIndex]),r>o)return[new e.V(i,r,`${r} is greater than the maximum value ${o}`)]}return[]}function X(t){const i=t.valueSpec,r=e.K(t.value.type);let n,o,s,a={};const l="categorical"!==r&&void 0===t.value.property,c=!l,u="array"===e.H(t.value.stops)&&"array"===e.H(t.value.stops[0])&&"object"===e.H(t.value.stops[0][0]),h=W({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===r)return[new e.V(t.key,t.value,'identity function may not have a "stops" property')];let i=[];const n=t.value;return i=i.concat($({key:t.key,value:n,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:d})),"array"===e.H(n)&&0===n.length&&i.push(new e.V(t.key,n,"array must have at least one stop")),i},default:function(e){return pe({key:e.key,value:e.value,valueSpec:i,style:e.style,styleSpec:e.styleSpec})}}});return"identity"===r&&l&&h.push(new e.V(t.key,t.value,'missing required property "property"')),"identity"===r||t.value.stops||h.push(new e.V(t.key,t.value,'missing required property "stops"')),"exponential"===r&&t.valueSpec.expression&&!e.L(t.valueSpec)&&h.push(new e.V(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(c&&!e.M(t.valueSpec)?h.push(new e.V(t.key,t.value,"property functions not supported")):l&&!e.N(t.valueSpec)&&h.push(new e.V(t.key,t.value,"zoom functions not supported"))),"categorical"!==r&&!u||void 0!==t.value.property||h.push(new e.V(t.key,t.value,'"property" property is required')),h;function d(t){let r=[];const n=t.value,l=t.key;if("array"!==e.H(n))return[new e.V(l,n,`array expected, ${e.H(n)} found`)];if(2!==n.length)return[new e.V(l,n,`array length 2 expected, length ${n.length} found`)];if(u){if("object"!==e.H(n[0]))return[new e.V(l,n,`object expected, ${e.H(n[0])} found`)];if(void 0===n[0].zoom)return[new e.V(l,n,"object stop key must have zoom")];if(void 0===n[0].value)return[new e.V(l,n,"object stop key must have value")];const i=e.K(n[0].zoom);if("number"!=typeof i)return[new e.V(l,n[0].zoom,"stop zoom values must be numbers")];if(s&&s>i)return[new e.V(l,n[0].zoom,"stop zoom values must appear in ascending order")];i!==s&&(s=i,o=void 0,a={}),r=r.concat(W({key:`${l}[0]`,value:n[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:q,value:p}}))}else r=r.concat(p({key:`${l}[0]`,value:n[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec},n));return e.O(e.Q(n[1]))?r.concat([new e.V(`${l}[1]`,n[1],"expressions are not allowed in function stops.")]):r.concat(pe({key:`${l}[1]`,value:n[1],valueSpec:i,style:t.style,styleSpec:t.styleSpec}))}function p(t,s){const l=e.H(t.value),c=e.K(t.value),u=null!==t.value?t.value:s;if(n){if(l!==n)return[new e.V(t.key,u,`${l} stop domain type must match previous stop domain type ${n}`)]}else n=l;if("number"!==l&&"string"!==l&&"boolean"!==l&&"number"!=typeof c&&"string"!=typeof c&&"boolean"!=typeof c)return[new e.V(t.key,u,"stop domain value must be a number, string, or boolean")];if("number"!==l&&"categorical"!==r){let n=`number expected, ${l} found`;return e.M(i)&&void 0===r&&(n+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new e.V(t.key,u,n)]}return"categorical"!==r||"number"!==l||"number"==typeof c&&isFinite(c)&&Math.floor(c)===c?"categorical"!==r&&"number"===l&&"number"==typeof c&&"number"==typeof o&&void 0!==o&&c<o?[new e.V(t.key,u,"stop domain values must appear in ascending order")]:(o=c,"categorical"===r&&c in a?[new e.V(t.key,u,"stop domain values must be unique")]:(a[c]=!0,[])):[new e.V(t.key,u,`integer expected, found ${String(c)}`)]}}function Y(t){const i=("property"===t.expressionContext?e.S:e.U)(e.Q(t.value),t.valueSpec);if("error"===i.result)return i.value.map((i=>new e.V(`${t.key}${i.key}`,t.value,i.message)));const r=i.value.expression||i.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!r.outputDefined())return[new e.V(t.key,t.value,`Invalid data expression for "${t.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===t.expressionContext&&"layout"===t.propertyType&&!e.W(r))return[new e.V(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext)return Z(r,t);if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!e.X(r,["zoom","feature-state"]))return[new e.V(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!e.Y(r))return[new e.V(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Z(t,i){const r=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(i.valueSpec&&i.valueSpec.expression)for(const e of i.valueSpec.expression.parameters)r.delete(e);if(0===r.size)return[];const n=[];return t instanceof e.Z&&r.has(t.name)?[new e.V(i.key,i.value,`["${t.name}"] expression is not supported in a filter for a ${i.object.type} layer with id: ${i.object.id}`)]:(t.eachChild((e=>{n.push(...Z(e,i))})),n)}function K(t){const i=t.key,r=t.value,n=t.valueSpec,o=[];return Array.isArray(n.values)?-1===n.values.indexOf(e.K(r))&&o.push(new e.V(i,r,`expected one of [${n.values.join(", ")}], ${JSON.stringify(r)} found`)):-1===Object.keys(n.values).indexOf(e.K(r))&&o.push(new e.V(i,r,`expected one of [${Object.keys(n.values).join(", ")}], ${JSON.stringify(r)} found`)),o}function J(t){return e.$(e.Q(t.value))?Y(e.J({},t,{expressionContext:"filter",valueSpec:t.styleSpec[`filter_${t.layerType||"fill"}`]})):Q(t)}function Q(t){const i=t.value,r=t.key;if("array"!==e.H(i))return[new e.V(r,i,`array expected, ${e.H(i)} found`)];const n=t.styleSpec;let o,s=[];if(i.length<1)return[new e.V(r,i,"filter array must have at least 1 element")];switch(s=s.concat(K({key:`${r}[0]`,value:i[0],valueSpec:n.filter_operator,style:t.style,styleSpec:t.styleSpec})),e.K(i[0])){case"<":case"<=":case">":case">=":i.length>=2&&"$type"===e.K(i[1])&&s.push(new e.V(r,i,`"$type" cannot be use with operator "${i[0]}"`));case"==":case"!=":3!==i.length&&s.push(new e.V(r,i,`filter array for operator "${i[0]}" must have 3 elements`));case"in":case"!in":i.length>=2&&(o=e.H(i[1]),"string"!==o&&s.push(new e.V(`${r}[1]`,i[1],`string expected, ${o} found`)));for(let a=2;a<i.length;a++)o=e.H(i[a]),"$type"===e.K(i[1])?s=s.concat(K({key:`${r}[${a}]`,value:i[a],valueSpec:n.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==o&&"number"!==o&&"boolean"!==o&&s.push(new e.V(`${r}[${a}]`,i[a],`string, number, or boolean expected, ${o} found`));break;case"any":case"all":case"none":for(let e=1;e<i.length;e++)s=s.concat(Q({key:`${r}[${e}]`,value:i[e],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":o=e.H(i[1]),2!==i.length?s.push(new e.V(r,i,`filter array for "${i[0]}" operator must have 2 elements`)):"string"!==o&&s.push(new e.V(`${r}[1]`,i[1],`string expected, ${o} found`))}return s}function ee(t,i){const r=t.key,n=t.style,o=t.layer,s=t.styleSpec,a=t.value,l=t.objectKey,c=s[`${i}_${t.layerType}`];if(!c)return[];const u=l.match(/^(.*)-use-theme$/);if("paint"===i&&u&&c[u[1]])return e.O(a)?[].concat(pe({key:t.key,value:a,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:n,styleSpec:s,expressionContext:"property",propertyType:i,propertyKey:l})):pe({key:r,value:a,valueSpec:{type:"string"},style:n,styleSpec:s});const h=l.match(/^(.*)-transition$/);if("paint"===i&&h&&c[h[1]]&&c[h[1]].transition)return pe({key:r,value:a,valueSpec:s.transition,style:n,styleSpec:s});const d=t.valueSpec||c[l];if(!d)return[new e.G(r,a,`unknown property "${l}"`)];let p;if("string"===e.H(a)&&e.M(d)&&!d.tokens&&(p=/^{([^}]+)}$/.exec(a))){const t=`\`{ "type": "identity", "property": ${p?JSON.stringify(p[1]):'"_"'} }\``;return[new e.V(r,a,`"${l}" does not support interpolation syntax\nUse an identity property function instead: ${t}.`)]}const f=[];if("symbol"===t.layerType)"text-field"!==l||!n||n.glyphs||n.imports||f.push(new e.V(r,a,'use of "text-field" requires a style "glyphs" property')),"text-font"===l&&e.a0(e.Q(a))&&"identity"===e.K(a.type)&&f.push(new e.V(r,a,'"text-font" does not support identity functions'));else if("model"===t.layerType&&"paint"===i&&o&&o.layout&&o.layout.hasOwnProperty("model-id")&&e.M(d)&&(e.a1(d)||e.N(d))){const t=e.S(e.Q(a),d),i=t.value.expression||t.value._styleExpression.expression;i&&!e.X(i,["measure-light"])&&("model-emissive-strength"===l&&e.Y(i)&&e.W(i)||f.push(new e.V(r,a,`${l} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return f.concat(pe({key:t.key,value:a,valueSpec:d,style:n,styleSpec:s,expressionContext:"property",propertyType:i,propertyKey:l}))}function te(e){return ee(e,"paint")}function ie(e){return ee(e,"layout")}function re(t){let i=[];const r=t.value,n=t.key,o=t.style,s=t.styleSpec;r.type||r.ref||i.push(new e.V(n,r,'either "type" or "ref" is required'));let a=e.K(r.type);const l=e.K(r.ref);if(r.id){const s=e.K(r.id);for(let a=0;a<t.arrayIndex;a++){const t=o.layers[a];e.K(t.id)===s&&i.push(new e.V(n,r.id,`duplicate layer id "${r.id}", previously used at line ${t.id.__line__}`))}}if("ref"in r){let t;["type","source","source-layer","filter","layout"].forEach((t=>{t in r&&i.push(new e.V(n,r[t],`"${t}" is prohibited for ref layers`))})),o.layers.forEach((i=>{e.K(i.id)===l&&(t=i)})),t?t.ref?i.push(new e.V(n,r.ref,"ref cannot reference another ref layer")):a=e.K(t.type):"string"==typeof l&&i.push(new e.V(n,r.ref,`ref layer "${l}" not found`))}else if("background"!==a&&"sky"!==a&&"slot"!==a)if(r.source){const t=o.sources&&o.sources[r.source],s=t&&e.K(t.type);t?"vector"===s&&"raster"===a?i.push(new e.V(n,r.source,`layer "${r.id}" requires a raster source`)):"raster"===s&&"raster"!==a?i.push(new e.V(n,r.source,`layer "${r.id}" requires a vector source`)):"vector"!==s||r["source-layer"]?"raster-dem"===s&&"hillshade"!==a?i.push(new e.V(n,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"raster-array"!==s||["raster","raster-particle"].includes(a)?"line"!==a||!r.paint||!r.paint["line-gradient"]&&!r.paint["line-trim-offset"]||"geojson"===s&&t.lineMetrics?"raster-particle"===a&&"raster-array"!==s&&i.push(new e.V(n,r.source,`layer "${r.id}" requires a 'raster-array' source.`)):i.push(new e.V(n,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):i.push(new e.V(n,r.source,"raster-array source can only be used with layer type 'raster'.")):i.push(new e.V(n,r,`layer "${r.id}" must specify a "source-layer"`)):i.push(new e.V(n,r.source,`source "${r.source}" not found`))}else i.push(new e.V(n,r,'missing required property "source"'));return i=i.concat(W({key:n,value:r,valueSpec:s.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":()=>[],type:()=>pe({key:`${n}.type`,value:r.type,valueSpec:s.layer.type,style:t.style,styleSpec:t.styleSpec,object:r,objectKey:"type"}),filter:t=>J(e.J({layerType:a},t)),layout:t=>W({layer:r,key:t.key,value:t.value,valueSpec:{},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":t=>ie(e.J({layerType:a},t))}}),paint:t=>W({layer:r,key:t.key,value:t.value,valueSpec:{},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":t=>te(e.J({layerType:a,layer:r},t))}})}})),i}function ne(t){const i=t.value,r=t.key,n=e.H(i);return"string"!==n?[new e.V(r,i,`string expected, ${n} found`)]:[]}const oe={promoteId:function t(i){let{key:r,value:n}=i;if("string"===e.H(n))return ne({key:r,value:n});if(Array.isArray(n)){const t=[],i=e.Q(n),o=e.U(i);return"error"===o.result&&o.value.forEach((i=>{t.push(new e.V(`${r}${i.key}`,null,`${i.message}`))})),e.X(o.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||t.push(new e.V(`${r}`,null,"promoteId expression should be only feature dependent")),t}{const e=[];for(const i in n)e.push(...t({key:`${r}.${i}`,value:n[i]}));return e}}};function se(t){const i=t.value,r=t.key,n=t.styleSpec,o=t.style;if(!i.type)return[new e.V(r,i,'"type" is required')];const s=e.K(i.type);let a=[];switch(["vector","raster","raster-dem","raster-array"].includes(s)&&(i.url||i.tiles||a.push(new e.G(r,i,'Either "url" or "tiles" is required.'))),s){case"vector":case"raster":case"raster-dem":case"raster-array":return a=a.concat(W({key:r,value:i,valueSpec:n[`source_${s.replace("-","_")}`],style:t.style,styleSpec:n,objectElementValidators:oe})),a;case"geojson":if(a=W({key:r,value:i,valueSpec:n.source_geojson,style:o,styleSpec:n,objectElementValidators:oe}),i.cluster)for(const e in i.clusterProperties){const[t,n]=i.clusterProperties[e],o="string"==typeof t?[t,["accumulated"],["get",e]]:t;a.push(...Y({key:`${r}.${e}.map`,value:n,expressionContext:"cluster-map"})),a.push(...Y({key:`${r}.${e}.reduce`,value:o,expressionContext:"cluster-reduce"}))}return a;case"video":return W({key:r,value:i,valueSpec:n.source_video,style:o,styleSpec:n});case"image":return W({key:r,value:i,valueSpec:n.source_image,style:o,styleSpec:n});case"canvas":return[new e.V(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return K({key:`${r}.type`,value:i.type,valueSpec:{values:ae(n)},style:o,styleSpec:n})}}function ae(e){return e.source.reduce(((t,i)=>{const r=e[i];return"enum"===r.type.type&&(t=t.concat(Object.keys(r.type.values))),t}),[])}function le(t){const i=t.value,r=t.styleSpec,n=r.light,o=t.style;let s=[];const a=e.H(i);if(void 0===i)return s;if("object"!==a)return s=s.concat([new e.V("light",i,`object expected, ${a} found`)]),s;for(const l in i){const t=l.match(/^(.*)-transition$/),a=l.match(/^(.*)-use-theme$/);s=s.concat(a&&n[a[1]]?pe({key:l,value:i[l],valueSpec:{type:"string"},style:o,styleSpec:r}):t&&n[t[1]]&&n[t[1]].transition?pe({key:l,value:i[l],valueSpec:r.transition,style:o,styleSpec:r}):n[l]?pe({key:l,value:i[l],valueSpec:n[l],style:o,styleSpec:r}):[new e.V(l,i[l],`unknown property "${l}"`)])}return s}function ce(t){const i=t.value;let r=[];if(!i)return r;const n=e.H(i);if("object"!==n)return r=r.concat([new e.V("light-3d",i,`object expected, ${n} found`)]),r;const o=t.styleSpec,s=o["light-3d"],a=t.key,l=t.style,c=t.style.lights;for(const d of["type","id"])if(!(d in i))return r=r.concat([new e.V("light-3d",i,`missing property ${d} on light`)]),r;if(i.type&&c)for(let d=0;d<t.arrayIndex;d++){const t=e.K(i.type),n=c[d];e.K(n.type)===t&&r.push(new e.V(a,i.id,`duplicate light type "${i.type}", previously defined at line ${n.id.__line__}`))}const u=`properties_light_${i.type}`;if(!(u in o))return r=r.concat([new e.V("light-3d",i,`Invalid light type ${i.type}`)]),r;const h=o[u];for(const d in i)if("properties"===d){const n=i[d],s=e.H(n);if("object"!==s)return r=r.concat([new e.V("properties",n,`object expected, ${s} found`)]),r;for(const i in n)r=r.concat(h[i]?pe({key:i,value:n[i],valueSpec:h[i],style:l,styleSpec:o}):[new e.G(t.key,n[i],`unknown property "${i}"`)])}else{const t=d.match(/^(.*)-transition$/),n=d.match(/^(.*)-use-theme$/);r=r.concat(n&&s[n[1]]?pe({key:d,value:i[d],valueSpec:{type:"string"},style:l,styleSpec:o}):t&&s[t[1]]&&s[t[1]].transition?pe({key:d,value:i[d],valueSpec:o.transition,style:l,styleSpec:o}):s[d]?pe({key:d,value:i[d],valueSpec:s[d],style:l,styleSpec:o}):[new e.G(d,i[d],`unknown property "${d}"`)])}return r}function ue(t){const i=t.value,r=t.key,n=t.style,o=t.styleSpec,s=o.terrain;let a=[];const l=e.H(i);if(void 0===i)return a;if("null"===l)return a;if("object"!==l)return a=a.concat([new e.V("terrain",i,`object expected, ${l} found`)]),a;for(const c in i){const t=c.match(/^(.*)-transition$/),r=c.match(/^(.*)-use-theme$/);a=a.concat(r&&s[r[1]]?pe({key:c,value:i[c],valueSpec:{type:"string"},style:n,styleSpec:o}):t&&s[t[1]]&&s[t[1]].transition?pe({key:c,value:i[c],valueSpec:o.transition,style:n,styleSpec:o}):s[c]?pe({key:c,value:i[c],valueSpec:s[c],style:n,styleSpec:o}):[new e.G(c,i[c],`unknown property "${c}"`)])}if(i.source){const t=n.sources&&n.sources[i.source],o=t&&e.K(t.type);t?"raster-dem"!==o&&a.push(new e.V(r,i.source,`terrain cannot be used with a source of type ${String(o)}, it only be used with a "raster-dem" source type`)):a.push(new e.V(r,i.source,`source "${i.source}" not found`))}else a.push(new e.V(r,i,'terrain is missing required property "source"'));return a}function he(t){const i=t.value,r=t.style,n=t.styleSpec,o=n.fog;let s=[];const a=e.H(i);if(void 0===i)return s;if("object"!==a)return s=s.concat([new e.V("fog",i,`object expected, ${a} found`)]),s;for(const l in i){const t=l.match(/^(.*)-transition$/),a=l.match(/^(.*)-use-theme$/);s=s.concat(a&&o[a[1]]?pe({key:l,value:i[l],valueSpec:{type:"string"},style:r,styleSpec:n}):t&&o[t[1]]&&o[t[1]].transition?pe({key:l,value:i[l],valueSpec:n.transition,style:r,styleSpec:n}):o[l]?pe({key:l,value:i[l],valueSpec:o[l],style:r,styleSpec:n}):[new e.G(l,i[l],`unknown property "${l}"`)])}return s}const de={"*":()=>[],array:$,boolean:function(t){const i=t.value,r=t.key,n=e.H(i);return"boolean"!==n?[new e.V(r,i,`boolean expected, ${n} found`)]:[]},number:q,color:function(t){const i=t.key,r=t.value,n=e.H(r);return"string"!==n?[new e.V(i,r,`color expected, ${n} found`)]:null===e._.parseCSSColor(r)?[new e.V(i,r,`color expected, "${r}" found`)]:[]},enum:K,filter:J,function:X,layer:re,object:W,source:se,model:e.a2,light:le,"light-3d":ce,terrain:ue,fog:he,string:ne,formatted:function(e){return 0===ne(e).length?[]:Y(e)},resolvedImage:function(e){return 0===ne(e).length?[]:Y(e)},projection:function(t){const i=t.value,r=t.styleSpec,n=r.projection,o=t.style;let s=[];const a=e.H(i);if("object"===a)for(const e in i)s=s.concat(pe({key:e,value:i[e],valueSpec:n[e],style:o,styleSpec:r}));else"string"!==a&&(s=s.concat([new e.V("projection",i,`object or string expected, ${a} found`)]));return s},import:function(t){const{value:i,styleSpec:r}=t,{data:n,...o}=i;Object.defineProperty(o,"__line__",{value:i.__line__,enumerable:!1});let s=W(e.J({},t,{value:o,valueSpec:r.import}));return""===e.K(o.id)&&s.push(new e.V(`${t.key}.id`,o,"import id can't be an empty string")),n&&(s=s.concat(me(n,r,{key:`${t.key}.data`}))),s}};function pe(t){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=t.value,n=t.valueSpec,o=t.styleSpec;if(n.expression&&e.a0(e.K(r)))return X(t);if(n.expression&&e.O(e.Q(r)))return Y(t);if(n.type&&de[n.type]){const r=de[n.type](t);return!0===i&&r.length>0&&"array"===e.H(t.value)?Y(t):r}return W(e.J({},t,{valueSpec:n.type?o[n.type]:n}))}function fe(t){const i=t.value,r=t.key,n=ne(t);return n.length||(-1===i.indexOf("{fontstack}")&&n.push(new e.V(r,i,'"glyphs" url must include a "{fontstack}" token')),-1===i.indexOf("{range}")&&n.push(new e.V(r,i,'"glyphs" url must include a "{range}" token'))),n}function me(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.a3;return pe({key:(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).key||"",value:t,valueSpec:i.$root,styleSpec:i,style:t,objectElementValidators:{glyphs:fe,"*":()=>[]}})}function ge(t){return Pe(me(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.a3))}const ye=e=>Pe(se(e)),_e=e=>Pe(le(e)),ve=e=>Pe(ce(e)),xe=e=>Pe(ue(e)),be=e=>Pe(he(e)),we=t=>Pe(function(t){const i=t.value,r=t.style,n=t.styleSpec,o=n.snow;let s=[];const a=e.H(i);if(void 0===i)return s;if("object"!==a)return s=s.concat([new e.V("snow",i,`object expected, ${a} found`)]),s;for(const l in i){const t=l.match(/^(.*)-transition$/);s=s.concat(t&&o[t[1]]&&o[t[1]].transition?pe({key:l,value:i[l],valueSpec:n.transition,style:r,styleSpec:n}):o[l]?pe({key:l,value:i[l],valueSpec:o[l],style:r,styleSpec:n}):[new e.G(l,i[l],`unknown property "${l}"`)])}return s}(t)),Se=t=>Pe(function(t){const i=t.value,r=t.style,n=t.styleSpec,o=n.rain;let s=[];const a=e.H(i);if(void 0===i)return s;if("object"!==a)return s=s.concat([new e.V("rain",i,`object expected, ${a} found`)]),s;for(const l in i){const t=l.match(/^(.*)-transition$/);s=s.concat(t&&o[t[1]]&&o[t[1]].transition?pe({key:l,value:i[l],valueSpec:n.transition,style:r,styleSpec:n}):o[l]?pe({key:l,value:i[l],valueSpec:o[l],style:r,styleSpec:n}):[new e.G(l,i[l],`unknown property "${l}"`)])}return s}(t)),Te=e=>Pe(re(e)),Me=e=>Pe(J(e)),Ae=e=>Pe(te(e)),Ce=e=>Pe(ie(e)),Ee=t=>Pe(e.a2(t));function Pe(e){return e.slice().sort(((e,t)=>e.line&&t.line?e.line-t.line:0))}function ke(t,i){let r=!1;if(i&&i.length)for(const n of i)n instanceof e.G?e.w(n.message):(t.fire(new e.y(new Error(n.message))),r=!0);return r}let Ie;class De extends e.E{constructor(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"flat";super(),this._transitionable=new e.a4(Ie||(Ie=new e.a5({anchor:new e.a6(e.a3.light.anchor),position:new e.a7(e.a3.light.position),color:new e.a6(e.a3.light.color),intensity:new e.a6(e.a3.light.intensity)}))),this.setLight(t,i),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._validate(_e,e,i)||(this._transitionable.setTransitionOrValue(e),this.id=t)}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(t,i,r){return(!r||!1!==r.validate)&&ke(this,t.call(ge,e.l({value:i,style:{glyphs:!0,sprite:!0},styleSpec:e.a3})))}}let Le=class extends e.E{constructor(t,i,r,n){super(),this.scope=r,this._transitionable=new e.a4(new e.a5({source:new e.a6(e.a3.terrain.source),exaggeration:new e.a6(e.a3.terrain.exaggeration)}),r,n),this._transitionable.setTransitionOrValue(t,n),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=i}get(){return this._transitionable.serialize()}set(e,t){this._transitionable.setTransitionOrValue(e,t)}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}getExaggeration(t){return this._transitioning.possiblyEvaluate(new e.a8(t)).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const t=this._transitionable._values.exaggeration;if(!t)return null;const i=t.value.expression;if(!i)return null;let r=-1,n=-1,o=1;for(const s of i.zoomStops)o=i.evaluate(new e.a8(s)),o>.01?(r=s,n=-1):n=s;return o<.01&&r>0&&n>r?[r,n]:null}isZoomDependent(){const t=this._transitionable._values.exaggeration;return null!=t&&null!=t.value&&null!=t.value.expression&&t.value.expression instanceof e.a9}};const Re=45,ze=65,Oe=.05;function Fe(t,i,r,n){const o=e.ac(Re,ze,r),[s,a]=Be(t,n);let l=1-Math.min(1,Math.exp((i-s)/(a-s)*-6));return l*=l*l,l=Math.min(1,1.00747*l),l*o*t.alpha}function Be(e,t){const i=.5/Math.tan(.5*t);return[e.range[0]+i,e.range[1]+i]}function Ne(t,i,r,n,o){const s=e.ab.vec3.transformMat4([],[i,r,n],o.mercatorFogMatrix);return Fe(t,e.ab.vec3.length(s),o.pitch,o._fov)}function je(t,i,r,n,o,s,a){const l=[[r,n,0],[o,n,0],[o,s,0],[r,s,0]];let c=Number.MAX_VALUE,u=-Number.MAX_VALUE;for(const h of l){const t=e.ab.vec3.transformMat4([],h,i),r=e.ab.vec3.length(t);c=Math.min(c,r),u=Math.max(u,r)}return[Fe(t,c,a.pitch,a._fov),Fe(t,u,a.pitch,a._fov)]}class Ve extends e.E{constructor(t,i,r,n){super();const o=new e.a5({range:new e.a6(e.a3.fog.range),color:new e.a6(e.a3.fog.color),"color-use-theme":new e.a6({type:"string","property-type":"data-constant",default:"default"}),"high-color":new e.a6(e.a3.fog["high-color"]),"high-color-use-theme":new e.a6({type:"string","property-type":"data-constant",default:"default"}),"space-color":new e.a6(e.a3.fog["space-color"]),"space-color-use-theme":new e.a6({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new e.a6(e.a3.fog["horizon-blend"]),"star-intensity":new e.a6(e.a3.fog["star-intensity"]),"vertical-range":new e.a6(e.a3.fog["vertical-range"])});this._transitionable=new e.a4(o,r,new Map(n)),this.set(t,n),this._transitioning=this._transitionable.untransitioned(),this._transform=i,this.properties=new e.ad(o),this.scope=r}get state(){const t=this._transform,i="globe"===t.projection.name,r=e.ae(t.zoom),n=this.properties.get("range"),o=[.5,3];return{range:i?[e.af(o[0],n[0],r),e.af(o[1],n[1],r)]:n,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(t,i){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._validate(be,t,r))return;const n=e.l({},t);for(const o of Object.keys(e.a3.fog))void 0===n[o]&&(n[o]=e.a3.fog[o].default);this._options=n,this._transitionable.setTransitionOrValue(this._options,i)}getOpacity(t){if(!this._transform.projection.supportsFog)return 0;const i=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:e.ac(Re,ze,t))*i.a}getOpacityAtLatLng(t,i){return this._transform.projection.supportsFog?function(t,i,r){const n=e.aa.fromLngLat(i),o=r.elevation?r.elevation.getAtPointOrZero(n):0;return Ne(t,n.x,n.y,o,r)}(this.state,t,i):0}getOpacityForTile(t){if(!this._transform.projection.supportsFog)return[1,1];const i=this._transform.calculateFogTileMatrix(t.toUnwrapped());return je(this.state,i,0,0,e.ag,e.ag,this._transform)}getOpacityForBounds(e,t,i,r,n){return this._transform.projection.supportsFog?je(this.state,e,t,i,r,n,this._transform):[1,1]}getFovAdjustedRange(e){return this._transform.projection.supportsFog?Be(this.state,e):[0,1]}isVisibleOnFrustum(t){if(!this._transform.projection.supportsFog)return!1;const i=[4,5,6,7];for(const r of i){const i=t.points[r];let n;if(i[2]>=0)n=i;else{const o=t.points[r-4];n=e.ah(o,i,o[2]/(o[2]-i[2]))}if(Ne(this.state,n[0],n[1],0,this._transform)>=Oe)return!0}return!1}updateConfig(e){this._transitionable.setTransitionOrValue(this._options,new Map(e))}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(t,i,r){return(!r||!1!==r.validate)&&ke(this,t.call(ge,e.l({value:i,style:{glyphs:!0,sprite:!0},styleSpec:e.a3})))}}let Ue,Ge,He,We,$e=class extends e.E{constructor(t,i,r,n){super();const o=Ue||(Ue=new e.a5({density:new e.a6(e.a3.snow.density),intensity:new e.a6(e.a3.snow.intensity),color:new e.a6(e.a3.snow.color),opacity:new e.a6(e.a3.snow.opacity),vignette:new e.a6(e.a3.snow.vignette),"vignette-color":new e.a6(e.a3.snow["vignette-color"]),"center-thinning":new e.a6(e.a3.snow["center-thinning"]),direction:new e.a6(e.a3.snow.direction),"flake-size":new e.a6(e.a3.snow["flake-size"])}));this._transitionable=new e.a4(o,r,new Map(n)),this.set(t,n),this._transitioning=this._transitionable.untransitioned(),this.properties=new e.ad(o),this.scope=r}get state(){const t=this.properties.get("opacity"),i=this.properties.get("color"),r=this.properties.get("direction"),n=e.ai(r[0]),o=-Math.max(e.ai(r[1]),.01),s=[Math.cos(n)*Math.cos(o),Math.sin(n)*Math.cos(o),Math.sin(o)],a=this.properties.get("vignette"),l=this.properties.get("vignette-color");return l.a=a,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new e.aj(i.r,i.g,i.b,i.a*t),direction:s,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:l}}get(){return this._transitionable.serialize()}set(t,i){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._validate(we,t,r))return;const n=e.l({},t);for(const o of Object.keys(e.a3.snow))void 0===n[o]&&(n[o]=e.a3.snow[o].default);this._options=n,this._transitionable.setTransitionOrValue(this._options,i)}updateConfig(e){this._transitionable.setTransitionOrValue(this._options,new Map(e))}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(t,i,r){return(!r||!1!==r.validate)&&ke(this,t.call(ge,e.l({value:i,style:{glyphs:!0,sprite:!0},styleSpec:e.a3})))}},qe=class extends e.E{constructor(t,i,r,n){super();const o=Ge||(Ge=new e.a5({density:new e.a6(e.a3.rain.density),intensity:new e.a6(e.a3.rain.intensity),color:new e.a6(e.a3.rain.color),opacity:new e.a6(e.a3.rain.opacity),vignette:new e.a6(e.a3.rain.vignette),"vignette-color":new e.a6(e.a3.rain["vignette-color"]),"center-thinning":new e.a6(e.a3.rain["center-thinning"]),direction:new e.a6(e.a3.rain.direction),"droplet-size":new e.a6(e.a3.rain["droplet-size"]),"distortion-strength":new e.a6(e.a3.rain["distortion-strength"])}));this._transitionable=new e.a4(o,r,new Map(n)),this.set(t,n),this._transitioning=this._transitionable.untransitioned(),this.properties=new e.ad(o),this.scope=r}get state(){const t=this.properties.get("opacity"),i=this.properties.get("color"),r=this.properties.get("direction"),n=e.ai(r[0]),o=-Math.max(e.ai(r[1]),.01),s=[Math.cos(n)*Math.cos(o),Math.sin(n)*Math.cos(o),Math.sin(o)],a=this.properties.get("vignette-color");return a.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new e.aj(i.r,i.g,i.b,i.a*t),direction:s,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:a}}get(){return this._transitionable.serialize()}set(t,i){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._validate(Se,t,r))return;const n=e.l({},t);for(const o of Object.keys(e.a3.rain))void 0===n[o]&&(n[o]=e.a3.rain[o].default);this._options=n,this._transitionable.setTransitionOrValue(this._options,i)}updateConfig(e){this._transitionable.setTransitionOrValue(this._options,new Map(e))}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(t,i,r){return(!r||!1!==r.validate)&&ke(this,t.call(ge,e.l({value:i,style:{glyphs:!0,sprite:!0},styleSpec:e.a3})))}};class Xe extends e.E{constructor(t,i,r,n){super(),this.scope=r,this._options=t,this.properties=new e.ad(i),this._transitionable=new e.a4(i,r,new Map(n)),this._transitionable.setTransitionOrValue(t.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(e){this._transitionable.setTransitionOrValue(this._options.properties,new Map(e))}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(e,t){this._options=e,this._transitionable.setTransitionOrValue(e.properties,t)}shadowsEnabled(){return!!this.properties&&!0===this.properties.get("cast-shadows")}}class Ye{constructor(e,t,i,r){this.screenBounds=e,this.cameraPoint=t,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=i,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,r)}static createFromScreenPoints(t,i){let r,n;if(t instanceof e.P||"number"==typeof t[0]){const o=e.P.convert(t);r=[o],n=i.isPointAboveHorizon(o)}else{const o=e.P.convert(t[0]),s=e.P.convert(t[1]);r=[o,s],n=e.al(o,s).every((e=>i.isPointAboveHorizon(e)))}return new Ye(r,i.getCameraPoint(),n,i)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(t){return e.al(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],t)}bufferedCameraGeometry(t){const i=this.screenBounds[0],r=1===this.screenBounds.length?this.screenBounds[0].add(new e.P(1,1)):this.screenBounds[1],n=e.al(i,r,0,!1);return this.cameraPoint.y>r.y&&(this.cameraPoint.x>i.x&&this.cameraPoint.x<r.x?n.splice(3,0,this.cameraPoint):this.cameraPoint.x>=r.x?n[2]=this.cameraPoint:this.cameraPoint.x<=i.x&&(n[3]=this.cameraPoint)),e.am(n,t)}bufferedCameraGeometryGlobe(t){const i=this.screenBounds[0],r=1===this.screenBounds.length?this.screenBounds[0].add(new e.P(1,1)):this.screenBounds[1],n=e.al(i,r,t),o=this.cameraPoint.clone();switch(3*((o.y>i.y)+(o.y>r.y))+((o.x>i.x)+(o.x>r.x))){case 0:n[0]=o,n[4]=o.clone();break;case 1:n.splice(1,0,o);break;case 2:n[1]=o;break;case 3:n.splice(4,0,o);break;case 5:n.splice(2,0,o);break;case 6:n[3]=o;break;case 7:n.splice(3,0,o);break;case 8:n[2]=o}return n}containsTile(t,i,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const o=t.queryPadding/i._pixelsPerMercatorPixel+1,s=r?this._bufferedCameraMercator(o,i):this._bufferedScreenMercator(o,i);let a=t.tileID.wrap+(s.unwrapped?n:0);const l=s.polygon.map((i=>e.an(t.tileTransform,i,a)));if(!e.ao(l,0,0,e.ag,e.ag))return;a=t.tileID.wrap+(this.screenGeometryMercator.unwrapped?n:0);const c=this.screenGeometryMercator.polygon.map((i=>e.ap(t.tileTransform,i,a))),u=c.map((t=>new e.P(t[0],t[1]))),h=i.getFreeCameraOptions().position||new e.aa(0,0,0),d=e.ap(t.tileTransform,h,a),p=c.map((t=>{const i=e.ab.vec3.sub(t,t,d);return e.ab.vec3.normalize(i,i),new e.aq(d,i)})),f=e.ar(t,1,i.zoom)*i._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:u,tilespaceRays:p,bufferedTilespaceGeometry:l,bufferedTilespaceBounds:(m=e.as(l),m.min.x=e.aw(m.min.x,0,e.ag),m.min.y=e.aw(m.min.y,0,e.ag),m.max.x=e.aw(m.max.x,0,e.ag),m.max.y=e.aw(m.max.y,0,e.ag),m),tile:t,tileID:t.tileID,pixelToTileUnitsFactor:f};var m}_bufferedScreenMercator(e,t){const i=Je(e);if(this._screenRaycastCache[i])return this._screenRaycastCache[i];{let r;return r="globe"===t.projection.name?this._projectAndResample(this.bufferedScreenGeometry(e),t):{polygon:this.bufferedScreenGeometry(e).map((e=>t.pointCoordinate3D(e))),unwrapped:!0},this._screenRaycastCache[i]=r,r}}_bufferedCameraMercator(e,t){const i=Je(e);if(this._cameraRaycastCache[i])return this._cameraRaycastCache[i];{let r;return r="globe"===t.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(e),t):{polygon:this.bufferedCameraGeometry(e).map((e=>t.pointCoordinate3D(e))),unwrapped:!0},this._cameraRaycastCache[i]=r,r}}_projectAndResample(t,i){const r=function(t,i){const r=e.ab.mat4.multiply([],i.pixelMatrix,i.globeMatrix),n=[0,-e.ax,0,1],o=[0,e.ax,0,1],s=[0,0,0,1];e.ab.vec4.transformMat4(n,n,r),e.ab.vec4.transformMat4(o,o,r),e.ab.vec4.transformMat4(s,s,r);const a=new e.P(n[0]/n[3],n[1]/n[3]),l=new e.P(o[0]/o[3],o[1]/o[3]),c=e.au(t,a)&&n[3]<s[3],u=e.au(t,l)&&o[3]<s[3];if(!c&&!u)return null;const h=function(e,t,i){for(let r=1;r<e.length;r++){const n=Ke(t.pointCoordinate3D(e[r-1]).x),o=Ke(t.pointCoordinate3D(e[r]).x);if(i<0){if(n<o)return{idx:r,t:-n/(o-1-n)}}else if(o<n)return{idx:r,t:(1-n)/(o+1-n)}}return null}(t,i,c?-1:1);if(!h)return null;const{idx:d,t:p}=h;let f=d>1?Ze(t.slice(0,d),i):[],m=d<t.length?Ze(t.slice(d),i):[];f=f.map((t=>new e.P(Ke(t.x),t.y))),m=m.map((t=>new e.P(Ke(t.x),t.y)));const g=[...f];0===g.length&&g.push(m[m.length-1]);const y=e.af(g[g.length-1].y,(0===m.length?f[0]:m[0]).y,p);let _;return _=c?[new e.P(0,y),new e.P(0,0),new e.P(1,0),new e.P(1,y)]:[new e.P(1,y),new e.P(1,1),new e.P(0,1),new e.P(0,y)],g.push(..._),0===m.length?g.push(f[0]):g.push(...m),{polygon:g.map((t=>new e.aa(t.x,t.y))),unwrapped:!1}}(t,i);if(r)return r;const n=function(t,i){let r=!1,n=-1/0,o=0;for(let e=0;e<t.length-1;e++)t[e].x>n&&(n=t[e].x,o=e);for(let e=0;e<t.length-1;e++){const i=(o+e)%(t.length-1),n=t[i],s=t[i+1];Math.abs(n.x-s.x)>.5&&(n.x<s.x?(n.x+=1,0===i&&(t[t.length-1].x+=1)):(s.x+=1,i+1===t.length-1&&(t[0].x+=1)),r=!0)}const s=e.at(i.center.lng);return r&&s<Math.abs(s-1)&&t.forEach((e=>{e.x-=1})),{polygon:t,unwrapped:r}}(Ze(t,i).map((t=>new e.P(Ke(t.x),t.y))),i);return{polygon:n.polygon.map((t=>new e.aa(t.x,t.y))),unwrapped:n.unwrapped}}}function Ze(t,i){return e.av(t,(e=>{const t=i.pointCoordinate3D(e);e.x=t.x,e.y=t.y}),1/256)}function Ke(e){return e<0?1+e%1:e%1}function Je(e){return 100*e|0}function Qe(t,i,r,n,o){const s=function(r,n){if(r)return o(r);if(n){if(t.url&&n.tiles&&t.tiles&&delete t.tiles,n.variants){if(!Array.isArray(n.variants))return o(new Error("variants must be an array"));for(const t of n.variants){if(null==t||"object"!=typeof t||t.constructor!==Object)return o(new Error("variant must be an object"));if(!Array.isArray(t.capabilities))return o(new Error("capabilities must be an array"));if(1===t.capabilities.length&&"meshopt"===t.capabilities[0]){n=e.l(n,t);break}}}const r=e.ay(e.l({},n,t),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);r.tiles=i.canonicalizeTileset(r,t.url),o(null,r)}},a=function(e,t,i){if(!e)return null;if(!t&&!i)return e;i=i||e.worldview_default;const r=Object.values(e.language||{});if(0===r.length)return null;const n=Object.values(e.worldview||{});if(0===n.length)return null;const o=r.every((e=>e===t)),s=n.every((e=>e===i));return o&&s?e:t in(e.language_options||{})||i in(e.worldview_options||{})?null:e.language_options&&e.worldview_options?e:null}(t.data,r,n);return a?e.q.frame((()=>s(null,a))):t.url?e.n(i.transformRequest(i.normalizeSourceURL(t.url,null,r,n),e.R.Source),s):e.q.frame((()=>{const{data:e,...i}=t;s(null,i)}))}class et{constructor(t,i,r){this.bounds=e.az.convert(this.validateBounds(t)),this.minzoom=i||0,this.maxzoom=r||24}validateBounds(e){return Array.isArray(e)&&4===e.length?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(t){const i=Math.pow(2,t.z),r=Math.floor(e.at(this.bounds.getWest())*i),n=Math.floor(e.aA(this.bounds.getNorth())*i),o=Math.ceil(e.at(this.bounds.getEast())*i),s=Math.ceil(e.aA(this.bounds.getSouth())*i);return t.x>=r&&t.x<o&&t.y>=n&&t.y<s}}class tt extends e.E{constructor(t,i,r,n){if(super(),this.id=t,this.dispatcher=r,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.l(this,e.ay(i,["url","scheme","tileSize","promoteId"])),this._options=e.l({type:"vector"},i),this._collectResourceTiming=!!i.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(n),this._tileWorkers={},this._deduped=new e.aB}load(t){this._loaded=!1,this.fire(new e.z("dataloading",{dataType:"source"}));const i=Array.isArray(this.map._language)?this.map._language.join():this.map._language,r=this.map.getWorldview();this._tileJSONRequest=Qe(this._options,this.map._requestManager,i,r,((n,o)=>{if(this._tileJSONRequest=null,this._loaded=!0,n)i&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${i}`),r&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${r}`),this.fire(new e.y(n));else if(o){if(e.l(this,o),this.hasWorldviews=!!o.worldview_options,o.worldview_default&&(this.worldviewDefault=o.worldview_default),o.vector_layers){this.vectorLayers=o.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const e of o.vector_layers)this.vectorLayerIds.push(e.id),o.worldview&&o.worldview[e.source]&&this.localizableLayerIds.add(e.id)}o.bounds&&(this.tileBounds=new et(o.bounds,this.minzoom,this.maxzoom)),I(o.tiles,this.map._requestManager._customAccessToken),this.fire(new e.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.z("data",{dataType:"source",sourceDataType:"content"}))}t&&t(n)}))}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}reload(){this.cancelTileJSONRequest();const t=e.aC(this.id,this.scope);this.load((()=>this.map.style.clearSource(t)))}setTiles(e){return this._options.tiles=e,this.reload(),this}setUrl(e){return this.url=e,this._options.url=e,this.reload(),this}onRemove(e){this.cancelTileJSONRequest()}serialize(){return e.l({},this._options)}loadTile(t,i){const r=t.tileID.canonical.url(this.tiles,this.scheme),n=this.map._requestManager.normalizeTileURL(r),o=this.map._requestManager.transformRequest(n,e.R.Tile),s=this.map.style?this.map.style.getLut(this.scope):null,a=s?{image:s.image.clone()}:null,l={request:o,data:void 0,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,lut:a,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:e.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:t.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:t.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor()};if(this.hasWorldviews&&e.f(r)&&(l.worldview=this.map.getWorldview()||this.worldviewDefault,l.localizableLayerIds=this.localizableLayerIds),l.request.collectResourceTiming=this._collectResourceTiming,t.actor&&"expired"!==t.state)"loading"===t.state?t.reloadCallback=i:t.request=t.actor.send("reloadTile",l,c.bind(this));else if(t.actor=this._tileWorkers[n]=this._tileWorkers[n]||this.dispatcher.getActor(),this.dispatcher.ready)t.request=t.actor.send("loadTile",l,c.bind(this),void 0,!0);else{const i=e.aD.call({deduped:this._deduped},l,((e,i)=>{e||!i?c.call(this,e):(l.data={cacheControl:i.cacheControl,expires:i.expires,rawData:i.rawData.slice(0)},t.actor&&t.actor.send("loadTile",l,c.bind(this),void 0,!0))}),!0);t.request={cancel:i}}function c(r,n){return delete t.request,t.aborted?i(null):r&&404!==r.status?i(r):(n&&n.resourceTiming&&(t.resourceTiming=n.resourceTiming),this.map._refreshExpiredTiles&&n&&t.setExpiryData(n),t.loadVectorData(n,this.map.painter),e.aE(this.dispatcher),i(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}}abortTile(e){e.request&&(e.request.cancel(),delete e.request),e.actor&&e.actor.send("abortTile",{uid:e.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(e,t){e.actor&&e.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id,scope:this.scope}),e.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class it extends e.E{constructor(t,i,r,n){super(),this.id=t,this.dispatcher=r,this.setEventedParent(n),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.l({type:"raster"},i),e.l(this,e.ay(i,["url","scheme","tileSize"]))}load(t){this._loaded=!1,this.fire(new e.z("dataloading",{dataType:"source"})),this._tileJSONRequest=Qe(this._options,this.map._requestManager,null,null,((i,r)=>{this._tileJSONRequest=null,this._loaded=!0,i?this.fire(new e.y(i)):r&&(e.l(this,r),r.raster_layers&&(this.rasterLayers=r.raster_layers,this.rasterLayerIds=this.rasterLayers.map((e=>e.id))),r.bounds&&(this.tileBounds=new et(r.bounds,this.minzoom,this.maxzoom)),I(r.tiles),this.fire(new e.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.z("data",{dataType:"source",sourceDataType:"content"}))),t&&t(i)}))}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}reload(){this.cancelTileJSONRequest();const t=e.aC(this.id,this.scope);this.load((()=>this.map.style.clearSource(t)))}setTiles(e){return this._options.tiles=e,this.reload(),this}setUrl(e){return this.url=e,this._options.url=e,this.reload(),this}onRemove(e){this.cancelTileJSONRequest()}serialize(){return e.l({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(t,i){const r=e.q.devicePixelRatio>=2,n=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),r,this.tileSize);t.request=e.o(this.map._requestManager.transformRequest(n,e.R.Tile),((r,n,o,s)=>(delete t.request,t.aborted?(t.state="unloaded",i(null)):r?(t.state="errored",i(r)):n?(this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:o,expires:s}),t.setTexture(n,this.map.painter),t.state="loaded",e.aE(this.dispatcher),void i(null)):i(null))))}abortTile(e,t){e.request&&(e.request.cancel(),delete e.request),t&&t()}unloadTile(t,i){t.texture&&t.texture instanceof e.T?(t.destroy(!0),t.texture&&t.texture instanceof e.T&&this.map.painter.saveTileTexture(t.texture)):t.destroy(),i&&i()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class rt extends it{constructor(t,i,r,n){super(t,i,r,n),this.type="raster-array",this.maxzoom=22,this._options=e.l({type:"raster-array"},i)}triggerRepaint(e){const t=this.map.painter._terrain,i=this.map.style.getSourceCache(this.id);t&&t.enabled&&i&&t._clearRenderCacheForTile(i.id,e.tileID),this.map.triggerRepaint()}loadTile(t,i){const r=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),n=this.map._requestManager.transformRequest(r,e.R.Tile);t.requestParams=n,t.actor||(t.actor=this.dispatcher.getActor()),t.request=t.fetchHeader(void 0,((e,r,n,o)=>{if(delete t.request,t.aborted)return t.state="unloaded",i(null);if(e){if(20===e.code)return;return t.state="errored",i(e)}this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:n,expires:o}),t.state="empty",i(null)}))}unloadTile(t,i){const r=t.texture;r&&r instanceof e.T?(t.destroy(!0),this.map.painter.saveTileTexture(r)):(t.destroy(),t.flushQueues(),t._isHeaderLoaded=!1,delete t._mrt,delete t.textureDescriptor),t.fbo&&(t.fbo.destroy(),delete t.fbo),delete t.request,delete t.requestParams,delete t.neighboringTiles,t.state="unloaded"}prepareTile(t,i,r){t._isHeaderLoaded&&("empty"!==t.state&&(t.state="reloading"),t.fetchBand(i,r,((i,r)=>{if(i)return t.state="errored",this.fire(new e.y(i)),void this.triggerRepaint(t);r&&(t.setTexture(r,this.map.painter),t.state="loaded",this.triggerRepaint(t))})))}getInitialBand(e){if(!this.rasterLayers)return 0;const t=this.rasterLayers.find((t=>{let{id:i}=t;return i===e})),i=t&&t.fields,r=i&&i.bands&&i.bands;return r?r[0]:0}getTextureDescriptor(t,i,r){if(!t)return;const n=i.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!n)return;let o=null;i instanceof e.aH?o=i.paint.get("raster-array-band"):i instanceof e.aI&&(o=i.paint.get("raster-particle-array-band"));const s=o||this.getInitialBand(n);if(null!=s)if(t.textureDescriptor){if(!t.updateNeeded(n,s)||r)return Object.assign({},t.textureDescriptor,{texture:t.texture})}else this.prepareTile(t,n,s)}}const nt={vector:tt,raster:it,"raster-dem":class extends it{constructor(t,i,r,n){super(t,i,r,n),this.type="raster-dem",this.maxzoom=22,this._options=e.l({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox"}loadTile(t,i){const r=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function n(e,r){e&&(t.state="errored",i(e)),r&&(t.dem=r,t.dem.onDeserialize(),t.needsHillshadePrepare=!0,t.needsDEMTextureUpload=!0,t.state="loaded",i(null))}t.request=e.o(this.map._requestManager.transformRequest(r,e.R.Tile),function(r,o,s,a){if(delete t.request,t.aborted)t.state="unloaded",i(null);else if(r)t.state="errored",i(r);else if(o){this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:s,expires:a});const i=ImageBitmap&&o instanceof ImageBitmap&&e.t(),r=1-(o.width-e.aF(o.width))/2;r<1||t.neighboringTiles||(t.neighboringTiles=this._getNeighboringTiles(t.tileID));const l=i?o:e.q.getImageData(o,r),c={uid:t.uid,coord:t.tileID,source:this.id,scope:this.scope,rawImageData:l,encoding:this.encoding,padding:r};t.actor&&"expired"!==t.state||(t.actor=this.dispatcher.getActor(),t.actor.send("loadDEMTile",c,n.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(t){const i=t.canonical,r=Math.pow(2,i.z),n=(i.x-1+r)%r,o=0===i.x?t.wrap-1:t.wrap,s=(i.x+1+r)%r,a=i.x+1===r?t.wrap+1:t.wrap,l={};return l[new e.aG(t.overscaledZ,o,i.z,n,i.y).key]={backfilled:!1},l[new e.aG(t.overscaledZ,a,i.z,s,i.y).key]={backfilled:!1},i.y>0&&(l[new e.aG(t.overscaledZ,o,i.z,n,i.y-1).key]={backfilled:!1},l[new e.aG(t.overscaledZ,t.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},l[new e.aG(t.overscaledZ,a,i.z,s,i.y-1).key]={backfilled:!1}),i.y+1<r&&(l[new e.aG(t.overscaledZ,o,i.z,n,i.y+1).key]={backfilled:!1},l[new e.aG(t.overscaledZ,t.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},l[new e.aG(t.overscaledZ,a,i.z,s,i.y+1).key]={backfilled:!1}),l}},"raster-array":rt,geojson:class extends e.E{constructor(t,i,r,n){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=r.getActor(),this.setEventedParent(n),this._data=i.data,this._options=e.l({},i),this._collectResourceTiming=i.collectResourceTiming,void 0!==i.maxzoom&&(this.maxzoom=i.maxzoom),void 0!==i.minzoom&&(this.minzoom=i.minzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId;const o=e.ag/this.tileSize;this.workerOptions=e.l({source:this.id,scope:this.scope,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(void 0!==i.buffer?i.buffer:128)*o,tolerance:(void 0!==i.tolerance?i.tolerance:.375)*o,extent:e.ag,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:void 0!==i.clusterMaxZoom?i.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:e.ag,radius:(void 0!==i.clusterRadius?i.clusterRadius:50)*o,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter,dynamic:i.dynamic},i.workerOptions)}onAdd(e){this.map=e,this.setData(this._data)}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(t){if(!this._options.dynamic)return this.fire(new e.y(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if("string"!=typeof t&&("Feature"===t.type&&(t={type:"FeatureCollection",features:[t]}),"FeatureCollection"!==t.type))return this.fire(new e.y(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&"string"!=typeof t&&"string"!=typeof this._data&&"FeatureCollection"===this._data.type){const e=new Map;for(const t of this._data.features)e.set(t.id,t);for(const i of t.features)e.set(i.id,i);this._data.features=[...e.values()]}else this._data=t;return this._updateWorkerData(!0),this}getClusterExpansionZoom(e,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:e,source:this.id,scope:this.scope},t),this}getClusterChildren(e,t){return this.actor.send("geojson.getClusterChildren",{clusterId:e,source:this.id,scope:this.scope},t),this}getClusterLeaves(e,t,i,r){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:e,limit:t,offset:i},r),this}_updateWorkerData(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new e.z("dataloading",{dataType:"source"})),this._loaded=!1;const i=e.l({append:t},this.workerOptions);i.scope=this.scope;const r=this._data;"string"==typeof r?(i.request=this.map._requestManager.transformRequest(e.q.resolveURL(r),e.R.Source),i.request.collectResourceTiming=this._collectResourceTiming):i.data=JSON.stringify(r),this._pendingLoad=this.actor.send(`${this.type}.loadData`,i,((i,r)=>{if(this._loaded=!0,this._pendingLoad=null,i)this.fire(new e.y(i));else{const i={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&r&&r.resourceTiming&&r.resourceTiming[this.id]&&(i.resourceTiming=r.resourceTiming[this.id]),t&&(this._partialReload=!0),this.fire(new e.z("data",i)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(t),this._coalesce=!1)}))}loaded(){return this._loaded}reload(){const t=e.aC(this.id,this.scope);this.map.style.clearSource(t),this._updateWorkerData()}loadTile(t,i){const r=t.actor?"reloadTile":"loadTile";t.actor=this.actor;const n=this.map.style?this.map.style.getLut(this.scope):null,o=n?{image:n.image.clone()}:null,s=this._partialReload,a={type:this.type,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:o,scope:this.scope,pixelRatio:e.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,scaleFactor:this.map.getScaleFactor(),partial:s};t.request=this.actor.send(r,a,((e,n)=>s&&!n?(t.state="loaded",i(null)):(delete t.request,t.destroy(),t.aborted?i(null):e?i(e):(t.loadVectorData(n,this.map.painter,"reloadTile"===r),i(null)))),void 0,"loadTile"===r)}abortTile(e){e.request&&(e.request.cancel(),delete e.request),e.aborted=!0}unloadTile(e,t){this.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id,scope:this.scope}),e.destroy()}onRemove(e){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return e.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends e.aJ{constructor(e,t,i,r){super(e,t,i,r),this.roundZoom=!0,this.type="video",this.options=t}load(){this._loaded=!1;const t=this.options;this.urls=[];for(const i of t.urls)this.urls.push(this.map._requestManager.transformRequest(i,e.R.Source).url);e.aK(this.urls,((t,i)=>{this._loaded=!0,t?this.fire(new e.y(t)):i&&(this.video=i,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading())}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const i=this.video.seekable;t<i.start(0)||t>i.end(0)?this.fire(new e.y(new e.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${i.start(0)} and ${i.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const t=this.map.painter.context,i=t.gl;this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new e.T(t,this.video,i.RGBA8),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(t)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:e.aJ,model:class extends e.E{constructor(e,t,i,r){super(),this.id=e,this.type="model",this.models=[],this._loaded=!1,this._options=t}load(){const t=[];for(const i in this._options.models){const r=this._options.models[i],n=e.aM(this.map._requestManager.transformRequest(r.uri,e.R.Model).url).then((t=>{if(!t)return;const n=e.aN(t),o=new e.aO(i,r.position,r.orientation,n);o.computeBoundsAndApplyParent(),this.models.push(o)})).catch((t=>{this.fire(new e.y(new Error(`Could not load model ${i} from ${r.uri}: ${t.message}`)))}));t.push(n)}return Promise.allSettled(t).then((()=>{this._loaded=!0,this.fire(new e.z("data",{dataType:"source",sourceDataType:"metadata"}))})).catch((t=>{this.fire(new e.y(new Error(`Could not load models: ${t.message}`)))}))}onAdd(e){this.map=e,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(e,t){}serialize(){return{type:"model"}}},"batched-model":class extends e.E{constructor(e,t,i,r){super(),this.type="batched-model",this.id=e,this.tileSize=512,this._options=t,this.tiles=this._options.tiles,this.maxzoom=t.maxzoom||19,this.minzoom=t.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=i,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(r)}onAdd(e){this.map=e,this.load()}reload(){this.cancelTileJSONRequest();const t=e.aC(this.id,this.scope);this.load((()=>this.map.style.clearSource(t)))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(t){this._loaded=!1,this.fire(new e.z("dataloading",{dataType:"source"}));const i=Array.isArray(this.map._language)?this.map._language.join():this.map._language,r=this.map.getWorldview();this._tileJSONRequest=Qe(this._options,this.map._requestManager,i,r,((n,o)=>{this._tileJSONRequest=null,this._loaded=!0,n?(i&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${i}`),r&&2!==r.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${r}`),this.fire(new e.y(n))):o&&(e.l(this,o),o.bounds&&(this.tileBounds=new et(o.bounds,this.minzoom,this.maxzoom)),I(o.tiles,this.map._requestManager._customAccessToken),this.fire(new e.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.z("data",{dataType:"source",sourceDataType:"content"}))),t&&t(n)}))}hasTransition(){return!1}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loaded(){return this._loaded}loadTile(t,i){const r=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme)),n={request:this.map._requestManager.transformRequest(r,e.R.Tile),data:void 0,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:t.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,lut:null,maxZoom:null,promoteId:null,pixelRatio:null,scaleFactor:null};if(t.actor&&"expired"!==t.state)if("loading"===t.state)t.reloadCallback=i;else{if(t.buckets){const e=Object.values(t.buckets);for(const t of e)t.dirty=!0;return void(t.state="loaded")}t.request=t.actor.send("reloadTile",n,o.bind(this))}else t.actor=this.dispatcher.getActor(),t.request=t.actor.send("loadTile",n,o.bind(this),void 0,!0);function o(e,r){return t.aborted?i(null):e&&404!==e.status?i(e):(this.map._refreshExpiredTiles&&r&&t.setExpiryData(r),t.loadModelData(r,this.map.painter),t.state="loaded",void i(null))}}serialize(){return e.l({},this._options)}},canvas:class extends e.aJ{constructor(t,i,r,n){super(t,i,r,n),i.coordinates?Array.isArray(i.coordinates)&&4===i.coordinates.length&&!i.coordinates.some((e=>!Array.isArray(e)||2!==e.length||e.some((e=>"number"!=typeof e))))||this.fire(new e.y(new e.V(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.y(new e.V(`sources.${t}`,null,'missing required property "coordinates"'))),i.animate&&"boolean"!=typeof i.animate&&this.fire(new e.y(new e.V(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),i.canvas?"string"==typeof i.canvas||i.canvas instanceof HTMLCanvasElement||this.fire(new e.y(new e.V(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.y(new e.V(`sources.${t}`,null,'missing required property "canvas"'))),this.options=i,this.animate=void 0===i.animate||i.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.y(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(e){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const i=this.map.painter.context;this.texture?!t&&!this._playing||this.texture instanceof e.aL||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.T(i,this.canvas,i.gl.RGBA8,{premultiply:!0}),this._prepareData(i)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}},custom:class extends e.E{constructor(t,i,r,n){super(),this.id=t,this.type="custom",this._dataType="raster",this._dispatcher=r,this._implementation=i,this.setEventedParent(n),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new e.y(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new e.y(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new et(this._implementation.bounds,this.minzoom,this.maxzoom)),i.update=this._update.bind(this),i.clearTiles=this._clearTiles.bind(this),i.coveringTiles=this._coveringTiles.bind(this),e.l(this,e.ay(i,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return e.ay(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new e.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.z("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(t){this.map=t,this._loaded=!1,this.fire(new e.z("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(t),this.load()}onRemove(e){this._implementation.onRemove&&this._implementation.onRemove(e)}hasTile(e){if(this._implementation.hasTile){const{x:t,y:i,z:r}=e.canonical;return this._implementation.hasTile({x:t,y:i,z:r})}return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e,t){const{x:i,y:r,z:n}=e.tileID.canonical,o=new AbortController;e.request=Promise.resolve(this._implementation.loadTile({x:i,y:r,z:n},{signal:o.signal})).then(function(i){return delete e.request,e.aborted?(e.state="unloaded",t(null)):void 0===i?(e.state="errored",t(null)):null===i?(this.loadTileData(e,{width:this.tileSize,height:this.tileSize,data:null}),e.state="loaded",t(null)):function(e){return e instanceof ImageData||e instanceof HTMLCanvasElement||e instanceof ImageBitmap||e instanceof HTMLImageElement}(i)?(this.loadTileData(e,i),e.state="loaded",void t(null)):(e.state="errored",t(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}.bind(this)).catch((i=>{20!==i.code&&(e.state="errored",t(i))})),e.request.cancel=()=>o.abort()}loadTileData(e,t){e.setTexture(t,this.map.painter)}unloadTile(t,i){if(t.texture&&t.texture instanceof e.T?(t.destroy(!0),t.texture&&t.texture instanceof e.T&&this.map.painter.saveTileTexture(t.texture)):t.destroy(),this._implementation.unloadTile){const{x:e,y:i,z:r}=t.tileID.canonical;this._implementation.unloadTile({x:e,y:i,z:r})}i&&i()}abortTile(e,t){e.request&&e.request.cancel&&(e.request.cancel(),delete e.request),t&&t()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map((e=>({x:e.canonical.x,y:e.canonical.y,z:e.canonical.z})))}_clearTiles(){const t=e.aC(this.id,this.scope);this.map.style.clearSource(t)}_update(){this.fire(new e.z("data",{dataType:"source",sourceDataType:"content"}))}}},ot=function(t,i,r,n){const o=new nt[i.type](t,i,r,n);if(o.id!==t)throw new Error(`Expected Source id to be ${t} instead of ${o.id}`);return e.aP(["load","abort","unload","serialize","prepare"],o),o};function st(e,t){return`${arguments.length>2&&void 0!==arguments[2]?arguments[2]:""}:${t.id||""}:${t.layer.id}:${function(e){if("layerId"in e)return`layer:${e.layerId}`;{const{featuresetId:t,importId:i}=e;return`featureset:${t}${i?`:import:${i}`:""}`}}(e.target)}`}function at(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";if(e.uniqueFeatureID){const n=st(e,t,r);if(i.has(n))return!0;i.add(n)}return!1}function lt(e,t,i,r){let n=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const o=t.sourceCache.transform,s=t.sourceCache.tilesIn(e,t.has3DLayers,n);s.sort(ht);const a=[];for(const l of s){const e=l.tile.queryRenderedFeatures(t,l,i,r,o,n);Object.keys(e).length&&a.push({wrappedTileID:l.tile.tileID.wrapped().key,queryResults:e})}return 0===a.length?{}:function(e){const t={},i={};for(const r of e){const e=r.queryResults,n=r.wrappedTileID,o=i[n]=i[n]||{};for(const i in e){const r=e[i],n=o[i]=o[i]||{},s=t[i]=t[i]||[];for(const e of r)n[e.featureIndex]||(n[e.featureIndex]=!0,s.push(e))}}return t}(a)}function ct(e,t,i,r,n){const o={},s=r.queryRenderedSymbols(e),a=[];for(const l of Object.keys(s).map(Number))a.push(n[l]);a.sort(ht);for(const l of a){const e=l.featureIndex.lookupSymbolFeatures(s[l.bucketInstanceId],l.bucketIndex,l.sourceLayerIndex,t,i);for(const t in e){const i=o[t]=o[t]||[],r=e[t];r.sort(((e,t)=>{const i=l.featureSortOrder;if(i){const r=i.indexOf(e.featureIndex);return i.indexOf(t.featureIndex)-r}return t.featureIndex-e.featureIndex}));for(const e of r)i.push(e)}}return o}function ut(e,t){const i=e.getRenderableIds().map((t=>e.getTileByID(t))),r=[],n={};for(let o=0;o<i.length;o++){const e=i[o],s=e.tileID.canonical.key;n[s]||(n[s]=!0,e.querySourceFeatures(r,t))}return r}function ht(e,t){const i=e.tileID,r=t.tileID;return i.overscaledZ-r.overscaledZ||i.canonical.y-r.canonical.y||i.wrap-r.wrap||i.canonical.x-r.canonical.x}function dt(e,t){const i={};if(!t)return i;for(const r of e){const e=r.layerIds.map((e=>t.getLayer(e))).filter(Boolean);if(0!==e.length){r.layers=e,r.stateDependentLayerIds&&(r.stateDependentLayers=r.stateDependentLayerIds.map((t=>e.filter((e=>e.id===t))[0])));for(const t of e)i[t.fqid]=r}}return i}const pt=32,ft=33,mt=new Uint16Array(8184);for(let _l=0;_l<2046;_l++){let e=_l+2,t=0,i=0,r=0,n=0,o=0,s=0;for(1&e?r=n=o=pt:t=i=s=pt;(e>>=1)>1;){const a=t+r>>1,l=i+n>>1;1&e?(r=t,n=i,t=o,i=s):(t=r,i=n,r=o,n=s),o=a,s=l}const a=4*_l;mt[a+0]=t,mt[a+1]=i,mt[a+2]=r,mt[a+3]=n}const gt=new Uint16Array(2178),yt=new Uint8Array(1089),_t=new Uint16Array(1089);function vt(e){return 0===e?-.03125:32===e?.03125:0}const xt={type:2,extent:e.ag,loadGeometry:()=>[[new e.P(0,0),new e.P(e.ag+1,0),new e.P(e.ag+1,e.ag+1),new e.P(0,e.ag+1),new e.P(0,0)]]};class bt{constructor(t,i,r,n,o){this.tileID=t,this.uid=e.aV(),this.uses=0,this.tileSize=i,this.tileZoom=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=o,n&&n.style&&(this._lastUpdatedBrightness=n.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",n&&n.transform&&(this.projection=n.transform.projection)}registerFadeDuration(t){const i=t+this.timeAdded;i<e.q.now()||this.fadeEndTime&&i<this.fadeEndTime||(this.fadeEndTime=i)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=e.aQ(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(t,i,r){if(this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=dt(t.buckets,i.style),this.hasSymbolBuckets=!1;for(const t in this.buckets){const i=this.buckets[t];if(i instanceof e.aX){if(this.hasSymbolBuckets=!0,!r)break;i.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const t in this.buckets){const i=this.buckets[t];if(i instanceof e.aX&&i.hasRTLText){this.hasRTLText=!0,e.aY();break}}this.queryPadding=0;for(const e in this.buckets){const t=this.buckets[e],r=i.style.getOwnLayer(e);if(!r)continue;const n=r.queryRadius(t);this.queryPadding=Math.max(this.queryPadding,n)}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),t.lineAtlas&&(this.lineAtlas=t.lineAtlas),this._lastUpdatedBrightness=t.brightness}else this.collisionBoxArray=new e.aW}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(e,t,i){e&&(e.resourceTiming&&(this.resourceTiming=e.resourceTiming),this.buckets=Object.assign({},this.buckets,dt(e.buckets,t.style)),e.featureIndex&&(this.latestFeatureIndex=e.featureIndex))}getBucket(e){return this.buckets[e.fqid]}upload(t){for(const e in this.buckets){const i=this.buckets[e];i.uploadPending()&&i.upload(t)}const i=t.gl,r=this.imageAtlas;if(r&&!r.uploaded){const n=!!Object.keys(r.patternPositions).length;this.imageAtlasTexture=new e.T(t,r.image,i.RGBA8,{useMipmap:n}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new e.T(t,this.glyphAtlasImage,i.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new e.T(t,this.lineAtlas.image,i.R8),this.lineAtlas.uploaded=!0)}prepare(e,t,i){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture,i),!t||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const r=t.style.getBrightness();(this._lastUpdatedBrightness||r)&&(this._lastUpdatedBrightness&&r&&Math.abs(this._lastUpdatedBrightness-r)<.001||(this.updateBuckets(t,this._lastUpdatedBrightness!==r),this._lastUpdatedBrightness=r))}queryRenderedFeatures(t,i,r,n,o,s){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const a=function(t,i){const r=e.ab.mat4.fromScaling([],[.5*t.width,.5*-t.height,1]);return e.ab.mat4.translate(r,r,[1,-1,0]),e.ab.mat4.multiply(r,r,t.calculateProjMatrix(i.toUnwrapped())),Float32Array.from(r)}(o,this.tileID);return this.latestFeatureIndex.query(t,{tilespaceGeometry:i,pixelPosMatrix:a,transform:n,availableImages:r,tileTransform:this.tileTransform})}querySourceFeatures(t,i){const r=this.latestFeatureIndex;if(!r||!r.rawTileData)return;const n=r.loadVTLayers(),o=i?i.sourceLayer:"",s=n._geojsonTileLayer||n[o];if(!s)return;const a=e.aZ(i&&i.filter),{z:l,x:c,y:u}=this.tileID.canonical,h={z:l,x:c,y:u};for(let d=0;d<s.length;d++){const i=s.feature(d);if(a.needGeometry){const t=e.a_(i,!0);if(!a.filter(new e.a8(this.tileID.overscaledZ),t,this.tileID.canonical))continue}else if(!a.filter(new e.a8(this.tileID.overscaledZ),i))continue;const n=r.getId(i,o),p=new e.a$(i,l,c,u,n);p.tile=h,t.push(p)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const i=this.expirationTime;if(t.cacheControl){const i=e.b0(t.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const e=Date.now();let t=!1;if(this.expirationTime>e)t=!1;else if(i)if(this.expirationTime<i)t=!0;else{const r=this.expirationTime-i;r?this.expirationTime=e+Math.max(r,3e4):t=!0}else t=!0;t?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}refreshFeatureState(e){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&e&&this.updateBuckets(e)}updateBuckets(t,i){if(!this.latestFeatureIndex)return;if(!t.style)return;const r=this.latestFeatureIndex.loadVTLayers(),n=t.style.listImages(),o=t.style.getBrightness();for(const s in this.buckets){if(!t.style.hasLayer(s))continue;const a=this.buckets[s],l=a.layers[0],c=l.sourceLayer||"_geojsonTileLayer",u=r[c],h=t.style.getLayerSourceCache(l);let d={};h&&(d=h._state.getState(c,void 0));const p=this.imageAtlas&&this.imageAtlas.patternPositions||{},f=Object.keys(d).length>0&&!i;f&&!a.stateDependentLayers.length&&!i||a.update(d,u,n,p,f?a.stateDependentLayers:a.layers,i,o),(a instanceof e.b1||a instanceof e.b2)&&t._terrain&&t._terrain.enabled&&h&&a.programConfigurations.needsUpload&&t._terrain._clearRenderCacheForTile(h.id,this.tileID);const m=t&&t.style&&t.style.getOwnLayer(s);m&&(this.queryPadding=Math.max(this.queryPadding,m.queryRadius(a)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<e.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=e.q.now()+t}setTexture(t,i){const r=i.context,n=r.gl;this.texture=this.texture||i.getTileTexture(t.width),this.texture&&this.texture instanceof e.T?this.texture.update(t):(this.texture=new e.T(r,t,n.RGBA8,{useMipmap:!0}),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE))}setDependencies(e,t){const i={};for(const r of t)i[r]=!0;this.dependencies[e]=i}hasDependency(e,t){for(const i of e){const e=this.dependencies[i];if(e)for(const i of t)if(e[i])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(t,i){if(!i||"mercator"===i.name||this._tileDebugBuffer)return;const r=e.b3(xt,this.tileID.canonical,this.tileTransform)[0],n=new e.b4,o=new e.b5;for(let e=0;e<r.length;e++){const{x:t,y:i}=r[e];n.emplaceBack(t,i),o.emplaceBack(e)}o.emplaceBack(0),this._tileDebugIndexBuffer=t.createIndexBuffer(o),this._tileDebugBuffer=t.createVertexBuffer(n,e.b6.members),this._tileDebugSegments=e.b7.simpleSegment(0,0,n.length,o.length)}_makeTileBoundsBuffers(t,i){if(this._tileBoundsBuffer||!i||"mercator"===i.name)return;const r=e.b3(xt,this.tileID.canonical,this.tileTransform)[0];let n,o;if(this.isRaster){const t=function(t,i){const r=e.aQ(t,i),n=Math.pow(2,t.z);for(let u=0;u<ft;u++)for(let o=0;o<ft;o++){const s=e.aR((t.x+(o+vt(o))/pt)/n),a=e.aS((t.y+(u+vt(u))/pt)/n),l=i.project(s,a),c=u*ft+o;gt[2*c+0]=Math.round((l.x*r.scale-r.x)*e.ag),gt[2*c+1]=Math.round((l.y*r.scale-r.y)*e.ag)}yt.fill(0),_t.fill(0);for(let e=2045;e>=0;e--){const t=4*e,i=mt[t+0],r=mt[t+1],n=mt[t+2],o=mt[t+3],s=i+n>>1,a=r+o>>1,l=s+a-r,c=a+i-s,u=r*ft+i,h=o*ft+n,d=a*ft+s,p=Math.hypot((gt[2*u+0]+gt[2*h+0])/2-gt[2*d+0],(gt[2*u+1]+gt[2*h+1])/2-gt[2*d+1])>=16;yt[d]=yt[d]||(p?1:0),e<1022&&(yt[d]=yt[d]||yt[(r+c>>1)*ft+(i+l>>1)]||yt[(o+c>>1)*ft+(n+l>>1)])}const o=new e.aT,s=new e.aU;let a=0;function l(t,i){const r=i*ft+t;return 0===_t[r]&&(o.emplaceBack(gt[2*r+0],gt[2*r+1],t*e.ag/pt,i*e.ag/pt),_t[r]=++a),_t[r]-1}function c(e,t,i,r,n,o){const a=e+i>>1,u=t+r>>1;if(Math.abs(e-n)+Math.abs(t-o)>1&&yt[u*ft+a])c(n,o,e,t,a,u),c(i,r,n,o,a,u);else{const a=l(e,t),c=l(i,r),u=l(n,o);s.emplaceBack(a,c,u)}}return c(0,0,pt,pt,pt,0),c(pt,pt,0,0,0,pt),{vertices:o,indices:s}}(this.tileID.canonical,i);n=t.vertices,o=t.indices}else{n=new e.aT,o=new e.aU;for(const{x:e,y:i}of r)n.emplaceBack(e,i,0,0);const t=e.b8(n.int16,void 0,4);for(let e=0;e<t.length;e+=3)o.emplaceBack(t[e],t[e+1],t[e+2])}this._tileBoundsBuffer=t.createVertexBuffer(n,e.b9.members),this._tileBoundsIndexBuffer=t.createIndexBuffer(o),this._tileBoundsSegments=e.b7.simpleSegment(0,0,n.length,o.length)}_makeGlobeTileDebugBuffers(t,i){const r=i.projection;if(!r||"globe"!==r.name||i.freezeTileCoverage)return;const n=this.tileID.canonical,o=e.ba(n,i),s=e.bb(o),a=e.ae(i.zoom);let l;a>0&&(l=e.ab.mat4.invert(new Float64Array(16),i.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(t,n,i,s,l,a),this._makeGlobeTileDebugTextBuffer(t,n,i,s,l,a)}_globePoint(t,i,r,n,o,s,a){let l=e.bc(t,i,r);if(s){const o=1<<r.z,c=e.at(n.center.lng),u=e.aA(n.center.lat),h=(r.x+.5)/o-c;let d=0;h>.5?d=-1:h<-.5&&(d=1);let p=(t/e.ag+r.x)/o+d,f=(i/e.ag+r.y)/o;p=(p-c)*n._pixelsPerMercatorPixel+c,f=(f-u)*n._pixelsPerMercatorPixel+u;const m=[p*n.worldSize,f*n.worldSize,0];e.ab.vec3.transformMat4(m,m,s),l=e.bd(l,m,a)}return e.ab.vec3.transformMat4(l,l,o)}_makeGlobeTileDebugBorderBuffer(t,i,r,n,o,s){const a=new e.b4,l=new e.b5,c=new e.be,u=(e,t,u,h,d)=>{const p=(u-e)/(d-1),f=(h-t)/(d-1),m=a.length;for(let g=0;g<d;g++){const u=e+g*p,h=t+g*f;a.emplaceBack(u,h);const d=this._globePoint(u,h,i,r,n,o,s);c.emplaceBack(d[0],d[1],d[2]),l.emplaceBack(m+g)}},h=e.ag;u(0,0,h,0,16),u(h,0,h,h,16),u(h,h,0,h,16),u(0,h,0,0,16),this._tileDebugIndexBuffer=t.createIndexBuffer(l),this._tileDebugBuffer=t.createVertexBuffer(a,e.b6.members),this._globeTileDebugBorderBuffer=t.createVertexBuffer(c,e.bf.members),this._tileDebugSegments=e.b7.simpleSegment(0,0,a.length,l.length)}_makeGlobeTileDebugTextBuffer(t,i,r,n,o,s){const a=e.ag/4,l=new e.b4,c=new e.aU,u=new e.be,h=25;c.reserve(32),l.reserve(h),u.reserve(h);const d=(e,t)=>h*e+t;for(let e=0;e<h;e++){const t=e*a;for(let e=0;e<h;e++){const c=e*a;l.emplaceBack(c,t);const h=this._globePoint(c,t,i,r,n,o,s);u.emplaceBack(h[0],h[1],h[2])}}for(let e=0;e<4;e++)for(let t=0;t<4;t++){const i=d(e,t),r=d(e,t+1),n=d(e+1,t),o=d(e+1,t+1);c.emplaceBack(i,r,n),c.emplaceBack(n,r,o)}this._tileDebugTextIndexBuffer=t.createIndexBuffer(c),this._tileDebugTextBuffer=t.createVertexBuffer(l,e.b6.members),this._globeTileDebugTextBuffer=t.createVertexBuffer(u,e.bf.members),this._tileDebugTextSegments=e.b7.simpleSegment(0,0,h,32)}destroy(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!t&&this.texture&&this.texture instanceof e.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}e.bg.setPbf(e.bh);class wt extends bt{constructor(e,t,i,r,n){super(e,t,i,r,n),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(t,i){const r=i.context,n=r.gl;this.texture=this.texture||i.getTileTexture(t.width),this.texture&&this.texture instanceof e.T?this.texture.update(t,{premultiply:!1}):this.texture=new e.T(r,t,n.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16384,i=arguments.length>1?arguments[1]:void 0;const r=this._mrt=new e.bg(30),n=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(t-1)}});return this.entireBuffer=null,this.request=e.bi(n,((e,n,o,s)=>{if(e)i(e);else try{const e=r.getHeaderLength(n);if(e>t)return void(this.request=this.fetchHeader(e,i));r.parseHeader(n),this._isHeaderLoaded=!0;let a=0;for(const t of Object.values(r.layers))a=Math.max(a,t.dataIndex[t.dataIndex.length-1].last_byte);n.byteLength>=a&&(this.entireBuffer=n),i(null,this.entireBuffer||n,o,s)}catch(e){i(e)}})),this.request}fetchBand(t,i,r){const n=this._mrt;if(!this._isHeaderLoaded||!n)return void r(new Error("Tile header is not ready"));const o=this.actor;if(!o)return void r(new Error("Can't fetch tile band without an actor"));let s;const a=(e,n)=>{s.complete(e,n),e?r(e):(this.updateTextureDescriptor(t,i),r(null,this.textureDescriptor&&this.textureDescriptor.img))},l=(e,t)=>{if(e)return r(e);const i=o.send("decodeRasterArray",{buffer:t,task:s},a,void 0,!0);this._workQueue.push((()=>{i&&i.cancel(),s.cancel()}))},c=n.getLayer(t);if(!c)return void r(new Error(`Unknown sourceLayer "${t}"`));if(c.hasDataForBand(i))return this.updateTextureDescriptor(t,i),void r(null,this.textureDescriptor?this.textureDescriptor.img:null);const u=c.getDataRange([i]);if(s=n.createDecodingTask(u),!s||s.tasks.length)if(this.flushQueues(),this.entireBuffer)l(null,this.entireBuffer.slice(u.firstByte,u.lastByte+1));else{const t=Object.assign({},this.requestParams,{headers:{Range:`bytes=${u.firstByte}-${u.lastByte}`}}),i=e.bi(t,l);this._fetchQueue.push((()=>{i.cancel(),s.cancel()}))}else r(null)}updateNeeded(e,t){return(!this.textureDescriptor||this.textureDescriptor.band!==t||this.textureDescriptor.layer!==e)&&"errored"!==this.state}updateTextureDescriptor(t,i){if(!this._mrt)return;const r=this._mrt.getLayer(t);if(!r||!r.hasBand(i)||!r.hasDataForBand(i))return;const{bytes:n,tileSize:o,buffer:s,offset:a,scale:l}=r.getBandView(i),c=o+2*s,u={data:n,width:c,height:c},h=this.texture;h&&h instanceof e.T&&h.update(u,{premultiply:!1}),this.textureDescriptor={layer:t,band:i,img:u,buffer:s,offset:a,tileSize:o,format:r.pixelFormat,mix:[l,256*l,65536*l,16777216*l]}}}class St{constructor(e,t){this.max=e,this.onRemove=t,this.reset()}reset(){for(const e in this.data)for(const t of this.data[e])t.timeout&&clearTimeout(t.timeout),this.onRemove(t.value);return this.data={},this.order=[],this}add(e,t,i){const r=e.wrapped().key;void 0===this.data[r]&&(this.data[r]=[]);const n={value:t,timeout:void 0};if(void 0!==i&&(n.timeout=setTimeout((()=>{this.remove(e,n)}),i)),this.data[r].push(n),this.order.push(r),this.order.length>this.max){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const t=this.data[e].shift();return t.timeout&&clearTimeout(t.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),t.value}getByKey(e){const t=this.data[e];return t?t[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,t){if(!this.has(e))return this;const i=e.wrapped().key,r=void 0===t?0:this.data[i].indexOf(t),n=this.data[i][r];return this.data[i].splice(r,1),n.timeout&&clearTimeout(n.timeout),0===this.data[i].length&&delete this.data[i],this.onRemove(n.value),this.order.splice(this.order.indexOf(i),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}filter(e){const t=[];for(const i in this.data)for(const r of this.data[i])e(r.value)||t.push(r);for(const i of t)this.remove(i.value.tileID,i)}}class Tt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,i,r){const n=String(i);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][n]=this.stateChanges[t][n]||{},e.l(this.stateChanges[t][n],r),null===this.deletedStates[t]){this.deletedStates[t]={};for(const e in this.state[t])e!==n&&(this.deletedStates[t][e]=null)}else if(this.deletedStates[t]&&null===this.deletedStates[t][n]){this.deletedStates[t][n]={};for(const e in this.state[t][n])r[e]||(this.deletedStates[t][n][e]=null)}else for(const e in r)this.deletedStates[t]&&this.deletedStates[t][n]&&null===this.deletedStates[t][n][e]&&delete this.deletedStates[t][n][e]}removeFeatureState(e,t,i){if(null===this.deletedStates[e])return;const r=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},i&&void 0!==t)null!==this.deletedStates[e][r]&&(this.deletedStates[e][r]=this.deletedStates[e][r]||{},this.deletedStates[e][r][i]=null);else if(void 0!==t)if(this.stateChanges[e]&&this.stateChanges[e][r])for(i in this.deletedStates[e][r]={},this.stateChanges[e][r])this.deletedStates[e][r][i]=null;else this.deletedStates[e][r]=null;else this.deletedStates[e]=null}getState(t,i){const r=this.state[t]||{},n=this.stateChanges[t]||{},o=this.deletedStates[t];if(null===o)return{};if(void 0!==i){const t=String(i),s=e.l({},r[t],n[t]);if(o){const e=o[i];if(null===e)return{};for(const t in e)delete s[t]}return s}const s=e.l({},r,n);if(o)for(const e in o)delete s[e];return s}initializeTileState(e,t){e.refreshFeatureState(t)}coalesceChanges(t,i){const r={};for(const n in this.stateChanges){this.state[n]=this.state[n]||{};const t={};for(const i in this.stateChanges[n])this.state[n][i]||(this.state[n][i]={}),e.l(this.state[n][i],this.stateChanges[n][i]),t[i]=this.state[n][i];r[n]=t}for(const n in this.deletedStates){this.state[n]=this.state[n]||{};const t={};if(null===this.deletedStates[n])for(const e in this.state[n])t[e]={},this.state[n][e]={};else for(const e in this.deletedStates[n]){if(null===this.deletedStates[n][e])this.state[n][e]={};else if(this.state[n][e])for(const t of Object.keys(this.deletedStates[n][e]))delete this.state[n][e][t];t[e]=this.state[n][e]}r[n]=r[n]||{},e.l(r[n],t)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(r).length)for(const e in t)t[e].refreshFeatureState(i)}}class Mt extends e.E{constructor(e,t,i){super(),this.id=e,this._onlySymbols=i,t.on("data",(e=>{"source"===e.dataType&&"metadata"===e.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===e.dataType&&"content"===e.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))})),t.on("error",(()=>{this._sourceErrored=!0})),this._source=t,this._tiles={},this._cache=new St(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=t.minTileCacheSize,this._maxTileCacheSize=t.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Tt,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"raster-array"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(e){this.map=e,this._minTileCacheSize=void 0===this._minTileCacheSize&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(const e in this._tiles){const t=this._tiles[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,t){return e.isSymbolTile=this._onlySymbols,e.isExtraShadowCaster=this._shadowCasterTiles[e.tileID.key],this._source.loadTile(e,t)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e)}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e)}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const t in this._tiles){const i=this._tiles[t];i.upload(e),i.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return e.bj(this._tiles).map((e=>e.tileID)).sort(At).map((e=>e.key))}getRenderableIds(t,i){const r=[];for(const e in this._tiles)this._isIdRenderable(+e,t,i)&&r.push(this._tiles[e]);return t?r.sort(((t,i)=>{const r=t.tileID,n=i.tileID,o=new e.P(r.canonical.x,r.canonical.y)._rotate(this.transform.angle),s=new e.P(n.canonical.x,n.canonical.y)._rotate(this.transform.angle);return r.overscaledZ-n.overscaledZ||s.y-o.y||s.x-o.x})).map((e=>e.tileID.key)):r.map((e=>e.tileID)).sort(At).map((e=>e.key))}hasRenderableParent(e){const t=this.findLoadedParent(e,0);return!!t&&this._isIdRenderable(t.tileID.key)}_isIdRenderable(e,t,i){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(t||!this._tiles[e].holdingForFade())&&(i||!this._shadowCasterTiles[e])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(+e,"reloading")}}_reloadTile(e,t){const i=this._tiles[e];i&&("loading"!==i.state&&(i.state=t),this._loadTile(i,this._tileLoaded.bind(this,i,e,t)))}_tileLoaded(t,i,r,n){if(n)if(t.state="errored",404!==n.status)this._source.fire(new e.y(n,{tile:t}));else{if(this._source.fire(new e.z("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:t})),!(t.tileID.key in this._loadedParentTiles))return;if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const e=this.map.painter.terrain;this.update(this.transform,e.getScaledDemTileSize(),!0),e.resetTileLookupCache(this.id)}else this.update(this.transform)}else t.timeAdded=e.q.now(),"expired"===r&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(i,t),"raster-dem"===this._source.type&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new e.z("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const t=this.getRenderableIds();for(let r=0;r<t.length;r++){const n=t[r];if(e.neighboringTiles&&e.neighboringTiles[n]){const t=this.getTileByID(n);i(e,t),i(t,e)}}function i(e,t){if(!e.dem||e.dem.borderReady)return;e.needsHillshadePrepare=!0,e.needsDEMTextureUpload=!0;let i=t.tileID.canonical.x-e.tileID.canonical.x;const r=t.tileID.canonical.y-e.tileID.canonical.y,n=Math.pow(2,e.tileID.canonical.z),o=t.tileID.key;0===i&&0===r||Math.abs(r)>1||(Math.abs(i)>1&&(1===Math.abs(i+n)?i+=n:1===Math.abs(i-n)&&(i-=n)),t.dem&&e.dem&&(e.dem.backfillBorder(t.dem,i,r),e.neighboringTiles&&e.neighboringTiles[o]&&(e.neighboringTiles[o].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,t,i,r){for(const n in this._tiles){let o=this._tiles[n];if(r[n]||!o.hasData()||o.tileID.overscaledZ<=t||o.tileID.overscaledZ>i)continue;let s=o.tileID;for(;o&&o.tileID.overscaledZ>t+1;){const e=o.tileID.scaledTo(o.tileID.overscaledZ-1);o=this._tiles[e.key],o&&o.hasData()&&(s=e)}let a=s;for(;a.overscaledZ>t;)if(a=a.scaledTo(a.overscaledZ-1),e[a.key]){r[s.key]=s;break}}}findLoadedParent(e,t){if(e.key in this._loadedParentTiles){const i=this._loadedParentTiles[e.key];return i&&i.tileID.overscaledZ>=t?i:null}for(let i=e.overscaledZ-1;i>=t;i--){const t=e.scaledTo(i),r=this._getLoadedTile(t);if(r)return r}}_getLoadedTile(e){const t=this._tiles[e.key];return t&&t.hasData()?t:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,t){t=t||this._source.tileSize;const i=Math.ceil(e.width/t)+1,r=Math.ceil(e.height/t)+1,n=Math.floor(i*r*5),o="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,n):n,s="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,o):o;this._cache.setMaxSize(s)}handleWrapJump(e){const t=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,t){const e={};for(const i in this._tiles){const r=this._tiles[i];r.tileID=r.tileID.unwrapTo(r.tileID.wrap+t),e[r.tileID.key]=r}this._tiles=e;for(const t in this._timers)clearTimeout(this._timers[t]),delete this._timers[t];for(const t in this._tiles)this._setTileReloadTimer(+t,this._tiles[t])}}update(t,i,r,n){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage)return;if(this.usedForTerrain&&!r)return;this.updateCacheSize(t,i),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const o="batched-model"===this._source.type;let s,a=this._source.maxzoom;const l=this.map&&this.map.painter?this.map.painter._terrain:null;if(l&&l.sourceCache===this&&l.attenuationRange()){const e=l.attenuationRange()[0],t=Math.floor(e)-Math.log2(l.getDemUpscale());a>t&&(a=t)}if(this.used||this.usedForTerrain){if(this._source.tileID)s=t.getVisibleUnwrappedCoordinates(this._source.tileID).map((t=>new e.aG(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y)));else if(0!==this.tileCoverLift){const n=t.clone();n.tileCoverLift=this.tileCoverLift,s=n.coveringTiles({tileSize:i||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:a,roundZoom:this._source.roundZoom&&!r,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:o}),this._source.minzoom<=1&&"globe"===t.projection.name&&(s.push(new e.aG(1,0,1,0,0)),s.push(new e.aG(1,0,1,1,0)),s.push(new e.aG(1,0,1,0,1)),s.push(new e.aG(1,0,1,1,1)))}else if(s=t.coveringTiles({tileSize:i||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:a,roundZoom:this._source.roundZoom&&!r,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:o}),this._source.hasTile){const e=this._source.hasTile.bind(this._source);s=s.filter((t=>e(t)))}}else s=[];if(s.length>0&&this.castsShadows&&n&&"globe"!==this.transform.projection.name&&!this.usedForTerrain&&!Ct(this._source.type)){const e=t.coveringZoomLevel({tileSize:i||this._source.tileSize,roundZoom:this._source.roundZoom&&!r}),a=Math.min(e,this._source.maxzoom);if(o){const e=t.extendTileCover(s,a);for(const t of e)s.push(t)}else{const e=t.extendTileCover(s,a,n);for(const t of e)this._shadowCasterTiles[t.key]=!0,s.push(t)}}const c=this._updateRetainedTiles(s);if(Ct(this._source.type)&&0!==s.length){const t={},i={},r=Object.keys(c);for(const o of r){const r=c[o],n=this._tiles[o];if(!n||n.fadeEndTime&&n.fadeEndTime<=e.q.now())continue;const s=this.findLoadedParent(r,Math.max(r.overscaledZ-Mt.maxOverzooming,this._source.minzoom));s&&(this._addTile(s.tileID),t[s.tileID.key]=s.tileID),i[o]=r}const n=s[s.length-1].overscaledZ;for(const e in this._tiles){const t=this._tiles[e];if(c[e]||!t.hasData())continue;let r=t.tileID;for(;r.overscaledZ>n;){r=r.scaledTo(r.overscaledZ-1);const n=this._tiles[r.key];if(n&&n.hasData()&&i[r.key]){c[e]=t.tileID;break}}}for(const e in t)c[e]||(this._coveredTiles[e]=!0,c[e]=t[e])}for(const e in c)this._tiles[e].clearFadeHold();const u=e.bk(this._tiles,c);for(const e of u){const t=this._tiles[e];t.hasSymbolBuckets&&!t.holdingForFade()?t.setHoldDuration(this.map._fadeDuration):t.hasSymbolBuckets&&!t.symbolFadeFinished()||this._removeTile(+e)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const t={};if(0===e.length)return t;const i={},r=e.reduce(((e,t)=>Math.min(e,t.overscaledZ)),1/0),n=e[0].overscaledZ,o=Math.max(n-Mt.maxOverzooming,this._source.minzoom),s=Math.max(n+Mt.maxUnderzooming,this._source.minzoom),a={};for(const l of e){const e=this._addTile(l);t[l.key]=l,e.hasData()||r<this._source.maxzoom&&(a[l.key]=l)}this._retainLoadedChildren(a,r,s,t);for(const l of e){let e=this._tiles[l.key];if(e.hasData())continue;if(l.canonical.z>=this._source.maxzoom){const e=l.children(this._source.maxzoom)[0],i=this.getTile(e);if(i&&i.hasData()){t[e.key]=e;continue}}else{const e=l.children(this._source.maxzoom);if(t[e[0].key]&&t[e[1].key]&&t[e[2].key]&&t[e[3].key])continue}let r=e.wasRequested();for(let n=l.overscaledZ-1;n>=o;--n){const o=l.scaledTo(n);if(i[o.key])break;if(i[o.key]=!0,e=this.getTile(o),!e&&r&&(e=this._addTile(o)),e&&(t[o.key]=o,r=e.wasRequested(),e.hasData()))break}}return t}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const t=[];let i,r=this._tiles[e].tileID;for(;r.overscaledZ>0;){if(r.key in this._loadedParentTiles){i=this._loadedParentTiles[r.key];break}t.push(r.key);const e=r.scaledTo(r.overscaledZ-1);if(i=this._getLoadedTile(e),i)break;r=e}for(const e of t)this._loadedParentTiles[e]=i}}_addTile(t){let i=this._tiles[t.key];if(i)return!0!==i.isExtraShadowCaster||!!this._shadowCasterTiles[t.key]||this._reloadTile(t.key,"reloading"),i;i=this._cache.getAndRemove(t),i&&(this._setTileReloadTimer(t.key,i),i.tileID=t,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,i)));const r=Boolean(i);if(!r){const e=this.map?this.map.painter:null,r=this._source.tileSize*t.overscaleFactor();i="raster-array"===this._source.type?new wt(t,r,this.transform.tileZoom,e,this._isRaster):new bt(t,r,this.transform.tileZoom,e,this._isRaster),this._loadTile(i,this._tileLoaded.bind(this,i,t.key,i.state))}return i?(i.uses++,this._tiles[t.key]=i,r||this._source.fire(new e.z("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i):null}_setTileReloadTimer(e,t){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const i=t.getExpiryTimeout();i&&(this._timers[e]=setTimeout((()=>{this._reloadTile(e,"expired"),delete this._timers[e]}),i))}_removeTile(e){const t=this._tiles[e];t&&(t.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),t.uses>0||(t.hasData()&&"reloading"!==t.state||"empty"===t.state?this._cache.add(t.tileID,t,t.getExpiryTimeout()):(t.aborted=!0,this._abortTile(t),this._unloadTile(t))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(t,i,r){const n=[],o=this.transform;if(!o)return n;const s="globe"===o.projection.name,a=e.at(o.center.lng);for(const l in this._tiles){const c=this._tiles[l];if(r&&c.clearQueryDebugViz(),c.holdingForFade())continue;let u;if(s){const t=c.tileID.canonical;if(0===t.z){const i=[Math.abs(e.aw(a,...Et(t,-1))-a),Math.abs(e.aw(a,...Et(t,1))-a)];u=[0,2*i.indexOf(Math.min(...i))-1]}else{const i=[Math.abs(e.aw(a,...Et(t,-1))-a),Math.abs(e.aw(a,...Et(t,0))-a),Math.abs(e.aw(a,...Et(t,1))-a)];u=[i.indexOf(Math.min(...i))-1]}}else u=[0];for(const e of u){const r=t.containsTile(c,o,i,e);r&&n.push(r)}}return n}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(e){return this._getRenderableCoordinates(e)}_getRenderableCoordinates(e,t){const i=this.getRenderableIds(e,t).map((e=>this._tiles[e].tileID)),r="globe"===this.transform.projection.name;for(const n of i)n.projMatrix=this.transform.calculateProjMatrix(n.toUnwrapped()),n.expandedProjMatrix=r?this.transform.calculateProjMatrix(n.toUnwrapped(),!1,!0):n.projMatrix;return i}sortCoordinatesByDistance(e){const t=e.slice(),i=this.transform._camera.position,r=this.transform._camera.forward(),n={};for(const o of t){const e=1/(1<<o.canonical.z);n[o.key]=((o.canonical.x+.5)*e+o.wrap-i[0])*r[0]+((o.canonical.y+.5)*e-i[1])*r[1]-i[2]*r[2]}return t.sort(((e,t)=>n[e.key]-n[t.key])),t}hasTransition(){if(this._source.hasTransition())return!0;if(Ct(this._source.type))for(const t in this._tiles){const i=this._tiles[t];if(void 0!==i.fadeEndTime&&i.fadeEndTime>=e.q.now())return!0}return!1}setFeatureState(e,t,i){this._state.updateState(e=e||"_geojsonTileLayer",t,i)}removeFeatureState(e,t,i){this._state.removeFeatureState(e=e||"_geojsonTileLayer",t,i)}getFeatureState(e,t){return this._state.getState(e=e||"_geojsonTileLayer",t)}setDependencies(e,t,i){const r=this._tiles[e];r&&r.setDependencies(t,i)}reloadTilesForDependencies(e,t){for(const i in this._tiles)this._tiles[i].hasDependency(e,t)&&this._reloadTile(+i,"reloading");this._cache.filter((i=>!i.hasDependency(e,t)))}_preloadTiles(t,i){if(!this._sourceLoaded){const e=()=>{this._sourceLoaded&&(this._source.off("data",e),this._preloadTiles(t,i))};return void this._source.on("data",e)}const r=new Map,n=Array.isArray(t)?t:[t],o=this.map.painter.terrain,s=this.usedForTerrain&&o?o.getScaledDemTileSize():this._source.tileSize;for(const e of n){const t=e.coveringTiles({tileSize:s,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const e of t)r.set(e.key,e);this.usedForTerrain&&e.updateElevation(!1)}const a=Array.from(r.values());e.bl(a,((e,t)=>{const i=new bt(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(i,(e=>{"raster-dem"===this._source.type&&i.dem&&this._backfillDEM(i),t(e,i)}))}),i)}}function At(e,t){const i=Math.abs(2*e.wrap)-+(e.wrap<0),r=Math.abs(2*t.wrap)-+(t.wrap<0);return e.overscaledZ-t.overscaledZ||r-i||t.canonical.y-e.canonical.y||t.canonical.x-e.canonical.x}function Ct(e){return"raster"===e||"image"===e||"video"===e||"custom"===e}function Et(e,t){const i=1<<e.z;return[e.x/i+t,(e.x+1)/i+t]}Mt.maxOverzooming=10,Mt.maxUnderzooming=3;class Pt{constructor(e){this.style=e,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const e=!1,t=!1;for(const i in this.style._mergedLayers){const r=this.style._mergedLayers[i];if("fill-extrusion"===r.type)this.layers.push({layer:r,visible:e,visibilityChanged:t});else if("model"===r.type){const i=this.style.getLayerSource(r);i&&"batched-model"===i.type&&this.layers.push({layer:r,visible:e,visibilityChanged:t})}}}onNewFrame(e){this.layersGotHidden=!1;for(const t of this.layers){const i=t.layer;let r=!1;"fill-extrusion"===i.type?r=!i.isHidden(e)&&i.paint.get("fill-extrusion-opacity")>0:"model"===i.type&&(r=!i.isHidden(e)&&i.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!r&&t.visible,t.visible=r}}updateZOffset(e,t){this.currentBuildingBuckets=[];for(const r of this.layers){const e=r.layer,i=this.style.getLayerSourceCache(e);let n=1;"fill-extrusion"===e.type&&(n=r.visible?e.paint.get("fill-extrusion-vertical-scale"):0);let o=i?i.getTile(t):null;if(!o&&i&&t.canonical.z>i.getSource().minzoom){let e=t.scaledTo(Math.min(i.getSource().maxzoom,t.overscaledZ-1));for(;e.overscaledZ>=i.getSource().minzoom&&(o=i.getTile(e),!o&&0!==e.overscaledZ);)e=e.scaledTo(e.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:o?o.getBucket(e):null,tileID:o?o.tileID:t,verticalScale:n})}e.hasAnyZOffset=!1;let i=!1;for(let r=0;r<e.symbolInstances.length;r++){const n=e.symbolInstances.get(r),o=n.zOffset,s=this._getHeightAtTileOffset(t,n.tileAnchorX,n.tileAnchorY);n.zOffset=s!==Number.NEGATIVE_INFINITY?s:o,i||o===n.zOffset||(i=!0),e.hasAnyZOffset||0===n.zOffset||(e.hasAnyZOffset=!0)}i&&(e.zOffsetBuffersNeedUpload=!0,e.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(t,i,r,n){let o=i,s=r;if(t.canonical.z!==n.canonical.z){const a=n.canonical,l=1/(1<<t.canonical.z-a.z);o=(i+t.canonical.x*e.ag)*l-a.x*e.ag|0,s=(r+t.canonical.y*e.ag)*l-a.y*e.ag|0}return{tileX:o,tileY:s}}_getHeightAtTileOffset(e,t,i){let r,n;for(let o=0;o<this.layers.length;++o){if("fill-extrusion"!==this.layers[o].layer.type)continue;const{bucket:s,tileID:a,verticalScale:l}=this.currentBuildingBuckets[o];if(!s)continue;const{tileX:c,tileY:u}=this._mapCoordToOverlappingTile(e,t,i,a),h=s.getHeightAtTileCoord(c,u);h&&void 0!==h.height&&(h.hidden?r=h.height:n=Math.max(h.height*l,n||0))}if(void 0!==n)return n;for(let o=0;o<this.layers.length;++o){const n=this.layers[o];if("model"!==n.layer.type||!n.visible)continue;const{bucket:s,tileID:a}=this.currentBuildingBuckets[o];if(!s)continue;const{tileX:l,tileY:c}=this._mapCoordToOverlappingTile(e,t,i,a),u=s.getHeightAtTileCoord(l,c);if(u&&!u.hidden)return void 0===u.height&&void 0!==r?Math.min(u.maxHeight,r)*u.verticalScale:u.height?u.height*u.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function kt(t,i){const r={};for(const e in t)"ref"!==e&&(r[e]=t[e]);return e.bm.forEach((e=>{e in i&&(r[e]=i[e])})),r}function It(e){e=e.slice();const t=Object.create(null);for(let i=0;i<e.length;i++)t[e[i].id]=e[i];for(let i=0;i<e.length;i++)"ref"in e[i]&&(e[i]=kt(e[i],t[e[i].ref]));return e}const Dt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function Lt(e,t,i){i.push({command:Dt.addSource,args:[e,t[e]]})}function Rt(e,t,i){t.push({command:Dt.removeSource,args:[e]}),i[e]=!0}function zt(e,t,i,r){Rt(e,i,r),Lt(e,t,i)}function Ot(t,i,r){let n;for(n in t[r])if(t[r].hasOwnProperty(n)&&"data"!==n&&!e.bn(t[r][n],i[r][n]))return!1;for(n in i[r])if(i[r].hasOwnProperty(n)&&"data"!==n&&!e.bn(t[r][n],i[r][n]))return!1;return!0}function Ft(t,i,r,n,o,s){let a;for(a in i=i||{},t=t||{})t.hasOwnProperty(a)&&(e.bn(t[a],i[a])||r.push({command:s,args:[n,a,i[a],o]}));for(a in i)i.hasOwnProperty(a)&&!t.hasOwnProperty(a)&&(e.bn(t[a],i[a])||r.push({command:s,args:[n,a,i[a],o]}))}function Bt(e){return e.id}function Nt(e,t){return e[t.id]=t,e}class jt{constructor(e,t){this.reset(e,t)}reset(e,t){this.points=e||[],this._distances=[0];for(let i=1;i<this.points.length;i++)this._distances[i]=this._distances[i-1]+this.points[i].dist(this.points[i-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(t||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(1===this.points.length)return this.points[0];t=e.aw(t,0,1);let i=1,r=this._distances[i];const n=t*this.paddedLength+this.padding;for(;r<n&&i<this._distances.length;)r=this._distances[++i];const o=i-1,s=this._distances[o],a=r-s,l=a>0?(n-s)/a:0;return this.points[o].mult(1-l).add(this.points[i].mult(l))}}class Vt{constructor(e,t,i){const r=this.boxCells=[],n=this.circleCells=[];this.xCellCount=Math.ceil(e/i),this.yCellCount=Math.ceil(t/i);for(let o=0;o<this.xCellCount*this.yCellCount;o++)r.push([]),n.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=t,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/t,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,t,i,r,n){this._forEachCell(t,i,r,n,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(r),this.bboxes.push(n)}insertCircle(e,t,i,r){this._forEachCell(t-r,i-r,t+r,i+r,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(t),this.circles.push(i),this.circles.push(r)}_insertBoxCell(e,t,i,r,n,o){this.boxCells[n].push(o)}_insertCircleCell(e,t,i,r,n,o){this.circleCells[n].push(o)}_query(e,t,i,r,n,o){if(i<0||e>this.width||r<0||t>this.height)return!n&&[];const s=[];if(e<=0&&t<=0&&this.width<=i&&this.height<=r){if(n)return!0;for(let e=0;e<this.boxKeys.length;e++)s.push({key:this.boxKeys[e],x1:this.bboxes[4*e],y1:this.bboxes[4*e+1],x2:this.bboxes[4*e+2],y2:this.bboxes[4*e+3]});for(let e=0;e<this.circleKeys.length;e++){const t=this.circles[3*e],i=this.circles[3*e+1],r=this.circles[3*e+2];s.push({key:this.circleKeys[e],x1:t-r,y1:i-r,x2:t+r,y2:i+r})}return o?s.filter(o):s}return this._forEachCell(e,t,i,r,this._queryCell,s,{hitTest:n,seenUids:{box:{},circle:{}}},o),n?s.length>0:s}_queryCircle(e,t,i,r,n){const o=e-i,s=e+i,a=t-i,l=t+i;if(s<0||o>this.width||l<0||a>this.height)return!r&&[];const c=[];return this._forEachCell(o,a,s,l,this._queryCellCircle,c,{hitTest:r,circle:{x:e,y:t,radius:i},seenUids:{box:{},circle:{}}},n),r?c.length>0:c}query(e,t,i,r,n){return this._query(e,t,i,r,!1,n)}hitTest(e,t,i,r,n){return this._query(e,t,i,r,!0,n)}hitTestCircle(e,t,i,r){return this._queryCircle(e,t,i,!0,r)}_queryCell(e,t,i,r,n,o,s,a){const l=s.seenUids,c=this.boxCells[n];if(null!==c){const n=this.bboxes;for(const u of c)if(!l.box[u]){l.box[u]=!0;const c=4*u;if(e<=n[c+2]&&t<=n[c+3]&&i>=n[c+0]&&r>=n[c+1]&&(!a||a(this.boxKeys[u]))){if(s.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[u],x1:n[c],y1:n[c+1],x2:n[c+2],y2:n[c+3]})}}}const u=this.circleCells[n];if(null!==u){const n=this.circles;for(const c of u)if(!l.circle[c]){l.circle[c]=!0;const u=3*c;if(this._circleAndRectCollide(n[u],n[u+1],n[u+2],e,t,i,r)&&(!a||a(this.circleKeys[c]))){if(s.hitTest)return o.push(!0),!0;{const e=n[u],t=n[u+1],i=n[u+2];o.push({key:this.circleKeys[c],x1:e-i,y1:t-i,x2:e+i,y2:t+i})}}}}}_queryCellCircle(e,t,i,r,n,o,s,a){const l=s.circle,c=s.seenUids,u=this.boxCells[n];if(null!==u){const e=this.bboxes;for(const t of u)if(!c.box[t]){c.box[t]=!0;const i=4*t;if(this._circleAndRectCollide(l.x,l.y,l.radius,e[i+0],e[i+1],e[i+2],e[i+3])&&(!a||a(this.boxKeys[t])))return o.push(!0),!0}}const h=this.circleCells[n];if(null!==h){const e=this.circles;for(const t of h)if(!c.circle[t]){c.circle[t]=!0;const i=3*t;if(this._circlesCollide(e[i],e[i+1],e[i+2],l.x,l.y,l.radius)&&(!a||a(this.circleKeys[t])))return o.push(!0),!0}}}_forEachCell(e,t,i,r,n,o,s,a){const l=this._convertToXCellCoord(e),c=this._convertToYCellCoord(t),u=this._convertToXCellCoord(i),h=this._convertToYCellCoord(r);for(let d=l;d<=u;d++)for(let l=c;l<=h;l++)if(n.call(this,e,t,i,r,this.xCellCount*l+d,o,s,a))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,t,i,r,n,o){const s=r-e,a=n-t,l=i+o;return l*l>s*s+a*a}_circleAndRectCollide(e,t,i,r,n,o,s){const a=(o-r)/2,l=Math.abs(e-(r+a));if(l>a+i)return!1;const c=(s-n)/2,u=Math.abs(t-(n+c));if(u>c+i)return!1;if(l<=a||u<=c)return!0;const h=l-a,d=u-c;return h*h+d*d<=i*i}}const Ut={unknown:0,flipRequired:1,flipNotRequired:2},Gt=Math.tan(85*Math.PI/180);function Ht(t,i,r,n,o,s,a){const l=e.ab.mat4.create();if(r)if("globe"===s.name){const t=e.bo(o,i);e.ab.mat4.multiply(l,l,t)}else{const t=e.ab.mat2.invert([],a);l[0]=t[0],l[1]=t[1],l[4]=t[2],l[5]=t[3],n||e.ab.mat4.rotateZ(l,l,o.angle)}else e.ab.mat4.multiply(l,o.labelPlaneMatrix,t);return l}function Wt(e,t,i,r,n,o,s){const a=Ht(e,t,i,r,n,o,s);return"globe"===o.name&&i||(a[2]=a[6]=a[10]=a[14]=0),a}function $t(t,i,r,n,o,s,a){if(r){if("globe"===s.name){const l=Ht(t,i,r,n,o,s,a);return e.ab.mat4.invert(l,l),e.ab.mat4.multiply(l,t,l),l}{const i=e.ab.mat4.clone(t),r=e.ab.mat4.identity([]);return r[0]=a[0],r[1]=a[1],r[4]=a[2],r[5]=a[3],e.ab.mat4.multiply(i,i,r),n||e.ab.mat4.rotateZ(i,i,-o.angle),i}}return o.glCoordMatrix}function qt(t,i,r,n){const o=[t,i,r,1];r?e.ab.vec4.transformMat4(o,o,n):ni(o,o,n);const s=o[3];return o[0]/=s,o[1]/=s,o[2]/=s,o}function Xt(e,t){return Math.min(.5+e/t*.5,1.5)}function Yt(e,t){const i=e[0]/e[3],r=e[1]/e[3];return i>=-t[0]&&i<=t[0]&&r>=-t[1]&&r<=t[1]}function Zt(t,i,r,n,o,s,a,l,c,u){const h=r.transform,d=n?t.textSizeData:t.iconSizeData,p=e.bp(d,r.transform.zoom),f="globe"===h.projection.name,m=[256/r.width*2+1,256/r.height*2+1],g=n?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;g.clear();let y=null;f&&(y=n?t.text.globeExtVertexArray:t.icon.globeExtVertexArray);const _=t.lineVertexArray,v=n?t.text.placedSymbolArray:t.icon.placedSymbolArray,x=r.transform.width/r.transform.height;let b,w=!1;for(let S=0;S<v.length;S++){const n=v.get(S),{numGlyphs:f,writingMode:T}=n;if(T!==e.bq.vertical||w||b===e.bq.horizontal||(w=!0),b=T,(n.hidden||T===e.bq.vertical)&&!w){ri(f,g);continue}w=!1;const M=new e.P(n.tileAnchorX,n.tileAnchorY);let{x:A,y:C,z:E}=h.projection.projectTilePoint(M.x,M.y,u.canonical);if(c){const[e,t,i]=c(M);A+=e,C+=t,E+=i}const P=[A,C,E,1];if(e.ab.vec4.transformMat4(P,P,i),!Yt(P,m)){ri(f,g);continue}const k=P[3],I=Xt(r.transform.getCameraToCenterDistance(h.projection),k),D=e.br(d,p,n),L=a?D/I:D*I,R=qt(A,C,E,o);if(R[3]<=0){ri(f,g);continue}let z={};const O=a?null:c,F=Qt(n,L,!1,l,i,o,s,t.glyphOffsetArray,_,g,y,R,M,z,x,O,h.projection,u,a);w=F.useVertical,O&&F.needsFlipping&&(z={}),(F.notEnoughRoom||w||F.needsFlipping&&Qt(n,L,!0,l,i,o,s,t.glyphOffsetArray,_,g,y,R,M,z,x,O,h.projection,u,a).notEnoughRoom)&&ri(f,g)}n?(t.text.dynamicLayoutVertexBuffer.updateData(g),y&&t.text.globeExtVertexBuffer&&t.text.globeExtVertexBuffer.updateData(y)):(t.icon.dynamicLayoutVertexBuffer.updateData(g),y&&t.icon.globeExtVertexBuffer&&t.icon.globeExtVertexBuffer.updateData(y))}function Kt(e,t,i,r,n,o,s,a,l,c,u,h,d,p,f,m){const{lineStartIndex:g,glyphStartIndex:y,segment:_}=a,v=y+a.numGlyphs,x=g+a.lineLength,b=t.getoffsetX(y),w=t.getoffsetX(v-1),S=ii(e*b,i,r,n,o,s,_,g,x,l,c,u,h,d,!0,p,f,m);if(!S)return null;const T=ii(e*w,i,r,n,o,s,_,g,x,l,c,u,h,d,!0,p,f,m);return T?{first:S,last:T}:null}function Jt(t,i,r,n){return t===e.bq.horizontal&&Math.abs(n)>Math.abs(r)?{useVertical:!0}:t===e.bq.vertical?n>0?{needsFlipping:!0}:null:i!==Ut.unknown&&function(e,t){return 0===e||Math.abs(t/e)>Gt}(r,n)?i===Ut.flipRequired?{needsFlipping:!0}:null:r<0?{needsFlipping:!0}:null}function Qt(t,i,r,n,o,s,a,l,c,u,h,d,p,f,m,g,y,_,v){const x=i/24,b=t.lineOffsetX*x,w=t.lineOffsetY*x,{lineStartIndex:S,glyphStartIndex:T,numGlyphs:M,segment:A,writingMode:C,flipState:E}=t,P=S+t.lineLength,k=t=>{if(h){const[i,r,n]=t.up,o=u.length;e.bs(h,o+0,i,r,n),e.bs(h,o+1,i,r,n),e.bs(h,o+2,i,r,n),e.bs(h,o+3,i,r,n)}const[i,r,n]=t.point;e.bt(u,i,r,n,t.angle)};if(M>1){const e=Kt(x,l,b,w,r,d,p,t,c,s,f,g,!1,y,_,v);if(!e)return{notEnoughRoom:!0};if(n&&!r){let[i,r,n]=e.first.point,[o,s,l]=e.last.point;[i,r]=qt(i,r,n,a),[o,s]=qt(o,s,l,a);const c=Jt(C,E,(o-i)*m,s-r);if(t.flipState=c&&c.needsFlipping?Ut.flipRequired:Ut.flipNotRequired,c)return c}k(e.first);for(let t=T+1;t<T+M-1;t++){const e=ii(x*l.getoffsetX(t),b,w,r,d,p,A,S,P,c,s,f,g,!1,!1,y,_,v);if(!e)return u.length-=4*(t-T),{notEnoughRoom:!0};k(e)}k(e.last)}else{if(n&&!r){const i=qt(p.x,p.y,0,o),r=S+A+1,n=new e.P(c.getx(r),c.gety(r)),s=qt(n.x,n.y,0,o),a=s[3]>0?s:ti(p,n,i,1,o,void 0,y,_.canonical),l=Jt(C,E,(a[0]-i[0])*m,a[1]-i[1]);if(t.flipState=l&&l.needsFlipping?Ut.flipRequired:Ut.flipNotRequired,l)return l}const i=ii(x*l.getoffsetX(T),b,w,r,d,p,A,S,P,c,s,f,g,!1,!1,y,_,v);if(!i)return{notEnoughRoom:!0};k(i)}return{}}function ei(e,t,i,r,n){const{x:o,y:s,z:a}=r.projectTilePoint(e.x,e.y,t);if(!n)return qt(o,s,a,i);const[l,c,u]=n(e);return qt(o+l,s+c,a+u,i)}function ti(t,i,r,n,o,s,a,l){const c=ei(t.sub(i)._unit()._add(t),l,o,a,s);return e.ab.vec3.sub(c,r,c),e.ab.vec3.normalize(c,c),e.ab.vec3.scaleAndAdd(c,r,c,n)}function ii(t,i,r,n,o,s,a,l,c,u,h,d,p,f,m,g,y,_){const v=n?t-i:t+i;let x=v>0?1:-1,b=0;n&&(x*=-1,b=Math.PI),x<0&&(b+=Math.PI);let w=l+a+(x>0?0:1)|0,S=o,T=o,M=0,A=0;const C=Math.abs(v),E=[],P=[];let k=s,I=k;const D=()=>ti(I,k,T,C-M+1,h,p,g,y.canonical);for(;M+A<=C;){if(w+=x,w<l||w>=c)return null;if(T=S,I=k,E.push(T),f&&P.push(I),k=new e.P(u.getx(w),u.gety(w)),S=d[w],!S){const e=ei(k,y.canonical,h,g,p);S=e[3]>0?d[w]=e:D()}M+=A,A=e.ab.vec3.distance(T,S)}m&&p&&(d[w]&&(S=D(),A=e.ab.vec3.distance(T,S)),d[w]=S);const L=(C-M)/A,R=k.sub(I)._mult(L)._add(I),z=e.ab.vec3.sub([],S,T),O=e.ab.vec3.scaleAndAdd([],T,z,L);let F=[0,0,1],B=z[0],N=z[1];if(_&&(F=g.upVector(y.canonical,R.x,R.y),0!==F[0]||0!==F[1]||1!==F[2])){const t=[F[2],0,-F[0]],i=e.ab.vec3.cross([],F,t);e.ab.vec3.normalize(t,t),e.ab.vec3.normalize(i,i),B=e.ab.vec3.dot(z,t),N=e.ab.vec3.dot(z,i)}if(r){const t=e.ab.vec3.cross([],F,z);e.ab.vec3.normalize(t,t),e.ab.vec3.scaleAndAdd(O,O,t,r*x)}const j=b+Math.atan2(N,B);return E.push(O),f&&P.push(R),{point:O,angle:j,path:E,tilePath:P,up:F}}function ri(e,t){const i=t.length,r=i+4*e;t.resize(r),t.float32.fill(-1/0,4*i,4*r)}function ni(e,t,i){const r=t[0],n=t[1];return e[0]=i[0]*r+i[4]*n+i[12],e[1]=i[1]*r+i[5]*n+i[13],e[3]=i[3]*r+i[7]*n+i[15],e}const oi=100;class si{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Vt(e.width+200,e.height+200,25),r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Vt(e.width+200,e.height+200,25);this.transform=e,this.grid=i,this.ignoredGrid=r,this.pitchfactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+oi,this.screenBottomBoundary=e.height+oi,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.fogState=t}placeCollisionBox(e,t,i,r,n,o,s,a){let l=i.projectedAnchorX,c=i.projectedAnchorY,u=i.projectedAnchorZ;const h=i.elevation,d=i.tileID,p=e.getProjection();if(h&&d){const[e,t,r]=p.upVector(d.canonical,i.tileAnchorX,i.tileAnchorY),n=p.upVectorScale(d.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;l+=e*h*n,c+=t*h*n,u+=r*h*n}const f=this.projectAndGetPerspectiveRatio(s,l,c,u,i.tileID,"globe"===p.name||!!h||this.transform.pitch>0,p),m=o*f.perspectiveRatio,g=(i.x1*t+r.x-i.padding)*m+f.point.x,y=(i.y1*t+r.y-i.padding)*m+f.point.y,_=(i.x2*t+r.x+i.padding)*m+f.point.x,v=(i.y2*t+r.y+i.padding)*m+f.point.y,x=f.perspectiveRatio<=.55||f.occluded;return!this.isInsideGrid(g,y,_,v)||!n&&this.grid.hitTest(g,y,_,v,a)||x?{box:[],offscreen:!1,occluded:f.occluded}:{box:[g,y,_,v],offscreen:this.isOffscreen(g,y,_,v),occluded:!1}}placeCollisionCircles(t,i,r,n,o,s,a,l,c,u,h,d,p,f,m){const g=[],y=this.transform.elevation,_=t.getProjection(),v=y?y.getAtTileOffsetFunc(m,this.transform.center.lat,this.transform.worldSize,_):null,x=new e.P(r.tileAnchorX,r.tileAnchorY);let{x:b,y:w,z:S}=_.projectTilePoint(x.x,x.y,m.canonical);if(v){const[e,t,i]=v(x);b+=e,w+=t,S+=i}const T="globe"===_.name,M=this.projectAndGetPerspectiveRatio(a,b,w,S,m,T||!!y||this.transform.pitch>0,_),{perspectiveRatio:A}=M,C=(h?s/A:s*A)/e.bw,E=qt(b,w,S,l),P=M.signedDistanceFromCamera>0?Kt(C,o,r.lineOffsetX*C,r.lineOffsetY*C,!1,E,x,r,n,l,{},y&&!h?v:null,h&&!!y,_,m,h):null;let k=!1,I=!1,D=!0;if(P&&!M.occluded){const t=.5*p*A+f,r=new e.P(-100,-100),n=new e.P(this.screenRightBoundary,this.screenBottomBoundary),o=new jt,{first:s,last:a}=P,l=s.path.length;let h=[];for(let e=l-1;e>=1;e--)h.push(s.path[e]);for(let e=1;e<a.path.length;e++)h.push(a.path[e]);const m=2.5*t;c&&(h=h.map(((e,t)=>{let[i,r,n]=e;return v&&!T&&(n=v(t<l-1?s.tilePath[l-1-t]:a.tilePath[t-l+2])[2]),qt(i,r,n,c)})),h.some((e=>e[3]<=0))&&(h=[]));let y=[];if(h.length>0){let t=1/0,i=-1/0,o=1/0,s=-1/0;for(const e of h)t=Math.min(t,e[0]),o=Math.min(o,e[1]),i=Math.max(i,e[0]),s=Math.max(s,e[1]);i>=r.x&&t<=n.x&&s>=r.y&&o<=n.y&&(y=[h.map((t=>new e.P(t[0],t[1])))],(t<r.x||i>n.x||o<r.y||s>n.y)&&(y=e.bu(y,r.x,r.y,n.x,n.y)))}for(const e of y){o.reset(e,.25*t);let r=0;r=o.length<=.5*t?1:Math.ceil(o.paddedLength/m)+1;for(let e=0;e<r;e++){const n=e/Math.max(r-1,1),s=o.lerp(n),a=s.x+oi,l=s.y+oi;g.push(a,l,t,0);const c=a-t,h=l-t,p=a+t,f=l+t;if(D=D&&this.isOffscreen(c,h,p,f),I=I||this.isInsideGrid(c,h,p,f),!i&&this.grid.hitTestCircle(a,l,t,d)&&(k=!0,!u))return{circles:[],offscreen:!1,collisionDetected:k,occluded:!1}}}}return{circles:!u&&k||!I?[]:g,offscreen:D,collisionDetected:k,occluded:M.occluded}}queryRenderedSymbols(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const i=[];let r=1/0,n=1/0,o=-1/0,s=-1/0;for(const u of t){const t=new e.P(u.x+oi,u.y+oi);r=Math.min(r,t.x),n=Math.min(n,t.y),o=Math.max(o,t.x),s=Math.max(s,t.y),i.push(t)}const a=this.grid.query(r,n,o,s).concat(this.ignoredGrid.query(r,n,o,s)),l={},c={};for(const u of a){const t=u.key;if(void 0===l[t.bucketInstanceId]&&(l[t.bucketInstanceId]={}),l[t.bucketInstanceId][t.featureIndex])continue;const r=[new e.P(u.x1,u.y1),new e.P(u.x2,u.y1),new e.P(u.x2,u.y2),new e.P(u.x1,u.y2)];e.bv(i,r)&&(l[t.bucketInstanceId][t.featureIndex]=!0,void 0===c[t.bucketInstanceId]&&(c[t.bucketInstanceId]=[]),c[t.bucketInstanceId].push(t.featureIndex))}return c}insertCollisionBox(e,t,i,r,n){(t?this.ignoredGrid:this.grid).insert({bucketInstanceId:i,featureIndex:r,collisionGroupID:n},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,t,i,r,n){const o=t?this.ignoredGrid:this.grid,s={bucketInstanceId:i,featureIndex:r,collisionGroupID:n};for(let a=0;a<e.length;a+=4)o.insertCircle(s,e[a],e[a+1],e[a+2])}projectAndGetPerspectiveRatio(t,i,r,n,o,s,a){const l=[i,r,n,1];let c=!1;if(n||this.transform.pitch>0){if(e.ab.vec4.transformMat4(l,l,t),this.fogState&&o&&"globe"!==a.name){const t=function(t,i,r,n,o,s){const a=s.calculateFogTileMatrix(o),l=[i,r,n];return e.ab.vec3.transformMat4(l,l,a),Fe(t,e.ab.vec3.length(l),s.pitch,s._fov)}(this.fogState,i,r,n,o.toUnwrapped(),this.transform);c=t>.9}}else ni(l,l,t);const u=l[3];return{point:new e.P((l[0]/u+1)/2*this.transform.width+oi,(-l[1]/u+1)/2*this.transform.height+oi),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(a)/u*.5,1.5),signedDistanceFromCamera:u,occluded:s&&l[2]>u||c}}isOffscreen(e,t,i,r){return i<oi||e>=this.screenRightBoundary||r<oi||t>this.screenBottomBoundary}isInsideGrid(e,t,i,r){return i>=0&&e<this.gridRightBoundary&&r>=0&&t<this.gridBottomBoundary}getViewportMatrix(){const t=e.ab.mat4.identity([]);return e.ab.mat4.translate(t,t,[-100,-100,0]),t}}function ai(t,i,r){const n=i.createTileMatrix(t,t.worldSize,r.toUnwrapped());return e.ab.mat4.multiply(new Float32Array(16),t.projMatrix,n)}function li(e,t,i){if(t.projection.name===i.projection.name)return e.projMatrix;const r=i.clone();return r.setProjection(t.projection),ai(r,t.getProjection(),e)}function ci(e,t,i){return t.name===i.projection.name?e.projMatrix:ai(i,t,e)}class ui{constructor(e,t,i,r){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?t:-t))):r&&i?1:0,this.placed=i}isHidden(){return 0===this.opacity&&!this.placed}}class hi{constructor(e,t,i,r,n){let o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.text=new ui(e?e.text:null,t,i,n),this.icon=new ui(e?e.icon:null,t,r,n),this.clipped=o}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class di{constructor(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.text=e,this.icon=t,this.skipFade=i,this.clipped=r}}class pi{constructor(){this.invProjMatrix=e.ab.mat4.create(),this.viewportMatrix=e.ab.mat4.create(),this.circles=[]}}class fi{constructor(e,t,i,r,n){this.bucketInstanceId=e,this.featureIndex=t,this.sourceLayerIndex=i,this.bucketIndex=r,this.tileID=n}}class mi{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const t=++this.maxGroupID;this.collisionGroups[e]={ID:t,predicate:e=>e.collisionGroupID===t}}return this.collisionGroups[e]}}function gi(t,i,r,n,o){const{horizontalAlign:s,verticalAlign:a}=e.bD(t),l=-(s-.5)*i,c=-(a-.5)*r,u=e.bC(t,n);return new e.P(l+u[0]*o,c+u[1]*o)}function yi(t,i,r,n,o){const s=new e.P(t,i);return r&&s._rotate(n?o:-o),s}class _i{constructor(e,t,i,r,n,o){this.transform=e.clone(),this.projection=e.projection.name,this.collisionIndex=new si(this.transform,n),this.buildingIndex=o,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=t,this.retainedQueryData={},this.collisionGroups=new mi(i),this.collisionCircleArrays={},this.prevPlacement=r,r&&(r.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,i,r,n){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;const s=r.getBucket(i),a=r.latestFeatureIndex;if(!s||!a||i.fqid!==s.layerIds[0])return;const l=s.layers[0].layout,c=s.layers[0].paint,u=r.collisionBoxArray,h=Math.pow(2,this.transform.zoom-r.tileID.overscaledZ),d=r.tileSize/e.ag,p=r.tileID.toUnwrapped();this.transform.setProjection(s.projection);const f=(m=r.tileID,g=s.getProjection(),y=this.transform,g.name===this.projection?y.calculateProjMatrix(m.toUnwrapped()):ai(y,g,m));var m,g,y;const _="map"===l.get("text-pitch-alignment"),v="map"===l.get("text-rotation-alignment");i.compileFilter(i.options);const x=i.dynamicFilter(),b=i.dynamicFilterNeedsFeature(),w=this.transform.calculatePixelsToTileUnitsMatrix(r),S=Wt(f,r.tileID.canonical,_,v,this.transform,s.getProjection(),w);let T=null;if(_){const t=$t(f,r.tileID.canonical,_,v,this.transform,s.getProjection(),w);T=e.ab.mat4.multiply([],this.transform.labelPlaneMatrix,t)}let M=null;x&&r.latestFeatureIndex&&(M={unwrappedTileID:p,dynamicFilter:x,dynamicFilterNeedsFeature:b}),this.retainedQueryData[s.bucketInstanceId]=new fi(s.bucketInstanceId,a,s.sourceLayerIndex,s.index,r.tileID);const[A,C]=s.layers[0].layout.get("text-size-scale-range"),E=e.aw(o,A,C),[P,k]=l.get("icon-size-scale-range"),I=e.aw(o,P,k),D={bucket:s,layout:l,paint:c,posMatrix:f,textLabelPlaneMatrix:S,labelToScreenMatrix:T,clippingData:M,scale:h,textPixelRatio:d,holdingForFade:r.holdingForFade(),collisionBoxArray:u,partiallyEvaluatedTextSize:e.bp(s.textSizeData,this.transform.zoom,E),partiallyEvaluatedIconSize:e.bp(s.iconSizeData,this.transform.zoom,I),collisionGroup:this.collisionGroups.get(s.sourceID),latestFeatureIndex:r.latestFeatureIndex};if(n)for(const e of s.sortKeyRanges){const{sortKey:i,symbolInstanceStart:r,symbolInstanceEnd:n}=e;t.push({sortKey:i,symbolInstanceStart:r,symbolInstanceEnd:n,parameters:D})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:s.symbolInstances.length,parameters:D})}attemptAnchorPlacement(e,t,i,r,n,o,s,a,l,c,u,h,d,p,f,m,g,y){const{textOffset0:_,textOffset1:v,crossTileID:x}=h,b=[_,v],w=gi(e,i,r,b,n),S=this.collisionIndex.placeCollisionBox(p,n,t,yi(w.x,w.y,o,s,this.transform.angle),u,a,l,c.predicate);if(m){const e=p.getSymbolInstanceIconSize(y,this.transform.zoom,h.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(p,e,m,yi(w.x,w.y,o,s,this.transform.angle),u,a,l,c.predicate).box.length)return}if(S.box.length>0){let t;return this.prevPlacement&&this.prevPlacement.variableOffsets[x]&&this.prevPlacement.placements[x]&&this.prevPlacement.placements[x].text&&(t=this.prevPlacement.variableOffsets[x].anchor),this.variableOffsets[x]={textOffset:b,width:i,height:r,anchor:e,textScale:n,prevAnchor:t},this.markUsedJustification(p,e,h,f),p.allowVerticalPlacement&&(this.markUsedOrientation(p,f,h),this.placedOrientations[x]=f),{shift:w,placedGlyphBoxes:S}}}placeLayerBucketPart(t,i,r,n){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;const{bucket:s,layout:a,paint:l,posMatrix:c,textLabelPlaneMatrix:u,labelToScreenMatrix:h,clippingData:d,textPixelRatio:p,holdingForFade:f,collisionBoxArray:m,partiallyEvaluatedTextSize:g,partiallyEvaluatedIconSize:y,collisionGroup:_,latestFeatureIndex:v}=t.parameters,x=a.get("text-optional"),b=a.get("icon-optional"),w=a.get("text-allow-overlap"),S=a.get("icon-allow-overlap"),T="map"===a.get("text-rotation-alignment"),M="map"===a.get("text-pitch-alignment"),A=a.get("symbol-z-elevate"),C=l.get("symbol-z-offset"),E="sea"===a.get("symbol-elevation-reference"),[P,k]=a.get("text-size-scale-range"),[I,D]=a.get("icon-size-scale-range"),L=e.aw(o,P,k),R=e.aw(o,I,D);this.transform.setProjection(s.projection);let z=w&&(S||!s.hasIconData()||b),O=S&&(w||!s.hasTextData()||x);const F=!C.isConstant();!s.collisionArrays&&m&&s.deserializeCollisionBoxes(m),r&&n&&s.updateCollisionDebugBuffers(this.transform.zoom,m,L,R);const B=(t,n,l)=>{const{crossTileID:m,numVerticalGlyphVertices:A}=t;let P=null;if(d&&d.dynamicFilterNeedsFeature||F){const e=this.retainedQueryData[s.bucketInstanceId];P=v.loadFeature({featureIndex:t.featureIndex,bucketIndex:e.bucketIndex,sourceLayerIndex:e.sourceLayerIndex,layoutVertexArrayOffset:0})}if(d&&!(0,d.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},P,this.retainedQueryData[s.bucketInstanceId].tileID.canonical,new e.P(t.tileAnchorX,t.tileAnchorY),this.transform.calculateDistanceTileData(d.unwrappedTileID)))return this.placements[m]=new di(!1,!1,!1,!0),void i.add(m);const k=C.evaluate(P,{});if(i.has(m))return;if(f)return void(this.placements[m]=new di(!1,!1,!1));let I=!1,D=!1,L=!0,R=!1,B=!1,N=null,j={box:null,offscreen:null,occluded:null},V={box:null,offscreen:null,occluded:null},U=null,G=null,H=null,W=0,$=0,q=0;l.textFeatureIndex?W=l.textFeatureIndex:t.useRuntimeCollisionCircles&&(W=t.featureIndex),l.verticalTextFeatureIndex&&($=l.verticalTextFeatureIndex);const X=e=>{e.tileID=this.retainedQueryData[s.bucketInstanceId].tileID;const i=this.transform.elevation;e.elevation=E?k:k+(i?i.getAtTileOffset(e.tileID,e.tileAnchorX,e.tileAnchorY):0),e.elevation+=t.zOffset},Y=l.textBox;if(Y){X(Y);const i=i=>{let r=e.bq.horizontal;if(s.allowVerticalPlacement&&!i&&this.prevPlacement){const e=this.prevPlacement.placedOrientations[m];e&&(this.placedOrientations[m]=e,r=e,this.markUsedOrientation(s,r,t))}return r},r=(t,i)=>{if(s.allowVerticalPlacement&&A>0&&l.verticalTextBox){for(const r of s.writingModes)if(r===e.bq.vertical?(j=i(),V=j):j=t(),j&&j.box&&j.box.length)break}else j=t()};if(a.get("text-variable-anchor")){let o=a.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[m]){const e=this.prevPlacement.variableOffsets[m];o.indexOf(e.anchor)>0&&(o=o.filter((t=>t!==e.anchor)),o.unshift(e.anchor))}const u=(e,i,r)=>{const a=s.getSymbolInstanceTextSize(g,t,this.transform.zoom,n),l=(e.x2-e.x1)*a+2*e.padding,u=(e.y2-e.y1)*a+2*e.padding,h=t.hasIconTextFit&&!S?i:null;h&&X(h);let d={box:[],offscreen:!1,occluded:!1};const f=w?2*o.length:o.length;for(let m=0;m<f;++m){const i=this.attemptAnchorPlacement(o[m%o.length],e,l,u,a,T,M,p,c,_,m>=o.length,t,n,s,r,h,g,y);if(i&&(d=i.placedGlyphBoxes,d&&d.box&&d.box.length)){I=!0,N=i.shift;break}}return d};r((()=>u(Y,l.iconBox,e.bq.horizontal)),(()=>{const t=l.verticalTextBox;return t&&X(t),s.allowVerticalPlacement&&!(j&&j.box&&j.box.length)&&A>0&&t?u(t,l.verticalIconBox,e.bq.vertical):{box:null,offscreen:null,occluded:null}})),j&&(I=j.box,L=j.offscreen,R=j.occluded);const h=i(!(!j||!j.box));if(!I&&this.prevPlacement){const e=this.prevPlacement.variableOffsets[m];e&&(this.variableOffsets[m]=e,this.markUsedJustification(s,e.anchor,t,h))}}else{const a=(i,r)=>{const a=s.getSymbolInstanceTextSize(g,t,this.transform.zoom,n,o),l=this.collisionIndex.placeCollisionBox(s,a,i,new e.P(0,0),w,p,c,_.predicate);return l&&l.box&&l.box.length&&(this.markUsedOrientation(s,r,t),this.placedOrientations[m]=r),l};r((()=>a(Y,e.bq.horizontal)),(()=>{const t=l.verticalTextBox;return s.allowVerticalPlacement&&A>0&&t?(X(t),a(t,e.bq.vertical)):{box:null,offscreen:null,occluded:null}})),i(!!(j&&j.box&&j.box.length))}}if(U=j,I=U&&U.box&&U.box.length>0,L=U&&U.offscreen,R=U&&U.occluded,t.useRuntimeCollisionCircles){const i=s.text.placedSymbolArray.get(t.centerJustifiedTextSymbolIndex>=0?t.centerJustifiedTextSymbolIndex:t.verticalPlacedTextSymbolIndex),n=e.br(s.textSizeData,g,i),o=a.get("text-padding");G=this.collisionIndex.placeCollisionCircles(s,w,i,s.lineVertexArray,s.glyphOffsetArray,n,c,u,h,r,M,_.predicate,t.collisionCircleDiameter*n/e.bw,o,this.retainedQueryData[s.bucketInstanceId].tileID),I=w||G.circles.length>0&&!G.collisionDetected,L=L&&G.offscreen,R=G.occluded}if(l.iconFeatureIndex&&(q=l.iconFeatureIndex),l.iconBox){const i=i=>{X(i);const r=t.hasIconTextFit&&N?yi(N.x,N.y,T,M,this.transform.angle):new e.P(0,0),n=s.getSymbolInstanceIconSize(y,this.transform.zoom,t.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(s,n,i,r,S,p,c,_.predicate)};V&&V.box&&V.box.length&&l.verticalIconBox?(H=i(l.verticalIconBox),D=H.box.length>0):(H=i(l.iconBox),D=H.box.length>0),L=L&&H.offscreen,B=H.occluded}const Z=x||0===t.numHorizontalGlyphVertices&&0===A,K=b||0===t.numIconVertices;if(Z||K?K?Z||(D=D&&I):I=D&&I:D=I=D&&I,I&&U&&U.box&&this.collisionIndex.insertCollisionBox(U.box,a.get("text-ignore-placement"),s.bucketInstanceId,V&&V.box&&$?$:W,_.ID),D&&H&&this.collisionIndex.insertCollisionBox(H.box,a.get("icon-ignore-placement"),s.bucketInstanceId,q,_.ID),G&&(I&&this.collisionIndex.insertCollisionCircles(G.circles,a.get("text-ignore-placement"),s.bucketInstanceId,W,_.ID),r)){const e=s.bucketInstanceId;let t=this.collisionCircleArrays[e];void 0===t&&(t=this.collisionCircleArrays[e]=new pi);for(let i=0;i<G.circles.length;i+=4)t.circles.push(G.circles[i+0]),t.circles.push(G.circles[i+1]),t.circles.push(G.circles[i+2]),t.circles.push(G.collisionDetected?1:0)}const J="globe"!==s.projection.name;z=z&&(J||!R),O=O&&(J||!B),this.placements[m]=new di(I||z,D||O,L||s.justReloaded),i.add(m)};if(A&&this.buildingIndex&&(this.buildingIndex.updateZOffset(s,this.retainedQueryData[s.bucketInstanceId].tileID),s.updateZOffset()),s.sortFeaturesByY){const t=s.getSortedSymbolIndexes(this.transform.angle);for(let e=t.length-1;e>=0;--e){const i=t[e];B(s.symbolInstances.get(i),i,s.collisionArrays[i])}s.hasAnyZOffset&&e.w(`${s.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(s.hasAnyZOffset){const e=s.getSortedIndexesByZOffset();for(let t=0;t<e.length;++t){const i=e[t];B(s.symbolInstances.get(i),i,s.collisionArrays[i])}}else for(let e=t.symbolInstanceStart;e<t.symbolInstanceEnd;e++)B(s.symbolInstances.get(e),e,s.collisionArrays[e]);if(r&&s.bucketInstanceId in this.collisionCircleArrays){const t=this.collisionCircleArrays[s.bucketInstanceId];e.ab.mat4.invert(t.invProjMatrix,c),t.viewportMatrix=this.collisionIndex.getViewportMatrix()}s.justReloaded=!1}markUsedJustification(t,i,r,n){const{leftJustifiedTextSymbolIndex:o,centerJustifiedTextSymbolIndex:s,rightJustifiedTextSymbolIndex:a,verticalPlacedTextSymbolIndex:l,crossTileID:c}=r,u=e.bB(i),h=n===e.bq.vertical?l:"left"===u?o:"center"===u?s:"right"===u?a:-1;o>=0&&(t.text.placedSymbolArray.get(o).crossTileID=h>=0&&o!==h?0:c),s>=0&&(t.text.placedSymbolArray.get(s).crossTileID=h>=0&&s!==h?0:c),a>=0&&(t.text.placedSymbolArray.get(a).crossTileID=h>=0&&a!==h?0:c),l>=0&&(t.text.placedSymbolArray.get(l).crossTileID=h>=0&&l!==h?0:c)}markUsedOrientation(t,i,r){const n=i===e.bq.horizontal||i===e.bq.horizontalOnly?i:0,o=i===e.bq.vertical?i:0,{leftJustifiedTextSymbolIndex:s,centerJustifiedTextSymbolIndex:a,rightJustifiedTextSymbolIndex:l,verticalPlacedTextSymbolIndex:c}=r,u=t.text.placedSymbolArray;s>=0&&(u.get(s).placedOrientation=n),a>=0&&(u.get(a).placedOrientation=n),l>=0&&(u.get(l).placedOrientation=n),c>=0&&(u.get(c).placedOrientation=o)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const t=this.prevPlacement;let i=!1;this.prevZoomAdjustment=t?t.zoomAdjustment(this.transform.zoom):0;const r=t?t.symbolFadeChange(e):1,n=t?t.opacities:{},o=t?t.variableOffsets:{},s=t?t.placedOrientations:{};for(const a in this.placements){const e=this.placements[a],t=n[a];t?(this.opacities[a]=new hi(t,r,e.text,e.icon,null,e.clipped),i=i||e.text!==t.text.placed||e.icon!==t.icon.placed):(this.opacities[a]=new hi(null,r,e.text,e.icon,e.skipFade,e.clipped),i=i||e.text||e.icon)}for(const a in n){const e=n[a];if(!this.opacities[a]){const t=new hi(e,r,!1,!1);t.isHidden()||(this.opacities[a]=t,i=i||e.text.placed||e.icon.placed)}}for(const a in o)this.variableOffsets[a]||!this.opacities[a]||this.opacities[a].isHidden()||(this.variableOffsets[a]=o[a]);for(const a in s)this.placedOrientations[a]||!this.opacities[a]||this.opacities[a].isHidden()||(this.placedOrientations[a]=s[a]);i?this.lastPlacementChangeTime=e:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)}updateLayerOpacities(e,t,i,r){const n=new Set;for(const o of t){const t=o.getBucket(e);t&&o.latestFeatureIndex&&e.fqid===t.layerIds[0]&&(this.updateBucketOpacities(t,n,o,o.collisionBoxArray,i,r,o.tileID,e.scope),t.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(t,o.tileID),t.updateZOffset()))}}updateBucketOpacities(t,i,r,n,o,s,a,l){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const c=t.layers[0].layout,u=t.layers[0].paint,h=!!t.layers[0].dynamicFilter(),d=new hi(null,0,!1,!1,!0),p=c.get("text-allow-overlap"),f=c.get("icon-allow-overlap"),m=c.get("text-variable-anchor"),g="map"===c.get("text-rotation-alignment"),y="map"===c.get("text-pitch-alignment"),_=u.get("symbol-z-offset"),v="sea"===c.get("symbol-elevation-reference"),x=!_.isConstant(),b=new hi(null,0,p&&(f||!t.hasIconData()||c.get("icon-optional")),f&&(p||!t.hasTextData()||c.get("text-optional")),!0);!t.collisionArrays&&n&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(n);const w=(e,t,i)=>{for(let r=0;r<t/4;r++)e.opacityVertexArray.emplaceBack(i)};let S=0;s&&t.updateReplacement(a,s);for(let T=0;T<t.symbolInstances.length;T++){const n=t.symbolInstances.get(T),{numHorizontalGlyphVertices:c,numVerticalGlyphVertices:u,crossTileID:p,numIconVertices:f,tileAnchorX:M,tileAnchorY:A}=n;let C=null;const E=this.retainedQueryData[t.bucketInstanceId];x&&n&&E&&(C=r.latestFeatureIndex.loadFeature({featureIndex:n.featureIndex,bucketIndex:E.bucketIndex,sourceLayerIndex:E.sourceLayerIndex,layoutVertexArrayOffset:0}));const P=_.evaluate(C,{}),k=i.has(p);let I=this.opacities[p];k?I=d:I||(I=b,this.opacities[p]=I),i.add(p);const D=c>0||u>0,L=f>0,R=this.placedOrientations[p],z=R===e.bq.vertical,O=R===e.bq.horizontal||R===e.bq.horizontalOnly;!D&&!L||I.isHidden()||S++;let F=!1;if((D||L)&&s)for(const i of t.activeReplacements){if(e.bx(i,o,e.by.Symbol,l))continue;if(i.min.x>M||M>i.max.x||i.min.y>A||A>i.max.y)continue;const t=e.bz(M,A,a.canonical,i.footprintTileId.canonical);if(F=e.bA(t,i.footprint),F)break}if(D){const e=F?Ei:Ci(I.text);w(t.text,c,z?Ei:e),w(t.text,u,O?Ei:e);const i=I.text.isHidden(),{leftJustifiedTextSymbolIndex:r,centerJustifiedTextSymbolIndex:o,rightJustifiedTextSymbolIndex:s,verticalPlacedTextSymbolIndex:a}=n,l=t.text.placedSymbolArray,h=i||z?1:0;r>=0&&(l.get(r).hidden=h),o>=0&&(l.get(o).hidden=h),s>=0&&(l.get(s).hidden=h),a>=0&&(l.get(a).hidden=i||O?1:0);const d=this.variableOffsets[p];d&&this.markUsedJustification(t,d.anchor,n,R);const f=this.placedOrientations[p];f&&(this.markUsedJustification(t,"left",n,f),this.markUsedOrientation(t,f,n))}if(L){const e=F?Ei:Ci(I.icon),{placedIconSymbolIndex:i,verticalPlacedIconSymbolIndex:r}=n,o=t.icon.placedSymbolArray,s=I.icon.isHidden()?1:0;i>=0&&(w(t.icon,f,z?Ei:e),o.get(i).hidden=s),r>=0&&(w(t.icon,n.numVerticalIconVertices,O?Ei:e),o.get(r).hidden=s)}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const i=t.collisionArrays[T];if(i){let r=new e.P(0,0),o=!0;if(i.textBox||i.verticalTextBox){if(m){const e=this.variableOffsets[p];e?(r=gi(e.anchor,e.width,e.height,e.textOffset,e.textScale),g&&r._rotate(y?this.transform.angle:-this.transform.angle)):o=!1}h&&(o=!I.clipped),i.textBox&&vi(t.textCollisionBox.collisionVertexArray,I.text.placed,!o||z,P,v,r.x,r.y),i.verticalTextBox&&vi(t.textCollisionBox.collisionVertexArray,I.text.placed,!o||O,P,v,r.x,r.y)}const s=o&&Boolean(!O&&i.verticalIconBox);i.iconBox&&vi(t.iconCollisionBox.collisionVertexArray,I.icon.placed,s,P,v,n.hasIconTextFit?r.x:0,n.hasIconTextFit?r.y:0),i.verticalIconBox&&vi(t.iconCollisionBox.collisionVertexArray,I.icon.placed,!s,P,v,n.hasIconTextFit?r.x:0,n.hasIconTextFit?r.y:0)}}}if(t.fullyClipped=0===S,t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.bucketInstanceId in this.collisionCircleArrays){const e=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=e.invProjMatrix,t.placementViewportMatrix=e.viewportMatrix,t.collisionCircleArray=e.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(e){return 0===this.fadeDuration?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,t){const i=this.zoomAtLastRecencyCheck===t?1-this.zoomAdjustment(t):1;return this.zoomAtLastRecencyCheck=t,this.commitTime+this.fadeDuration*i>e}setStale(){this.stale=!0}}function vi(e,t,i,r,n,o,s){e.emplaceBack(t?1:0,i?1:0,o||0,s||0,r,n?1:0),e.emplaceBack(t?1:0,i?1:0,o||0,s||0,r,n?1:0),e.emplaceBack(t?1:0,i?1:0,o||0,s||0,r,n?1:0),e.emplaceBack(t?1:0,i?1:0,o||0,s||0,r,n?1:0)}const xi=Math.pow(2,25),bi=Math.pow(2,24),wi=Math.pow(2,17),Si=Math.pow(2,16),Ti=Math.pow(2,9),Mi=Math.pow(2,8),Ai=Math.pow(2,1);function Ci(e){if(0===e.opacity&&!e.placed)return 0;if(1===e.opacity&&e.placed)return 4294967295;const t=e.placed?1:0,i=Math.floor(127*e.opacity);return i*xi+t*bi+i*wi+t*Si+i*Ti+t*Mi+i*Ai+t}const Ei=0;class Pi{constructor(e){this._sortAcrossTiles="viewport-y"!==e.layout.get("symbol-z-order")&&void 0!==e.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(e,t,i,r,n,o){const s=this._bucketParts;for(;this._currentTileIndex<e.length;)if(t.getBucketParts(s,r,e[this._currentTileIndex],this._sortAcrossTiles,o),this._currentTileIndex++,n())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,s.sort(((e,t)=>e.sortKey-t.sortKey)));this._currentPartIndex<s.length;){const e=s[this._currentPartIndex];if(t.placeLayerBucketPart(e,this._seenCrossTileIDs,i,0===e.symbolInstanceStart,o),this._currentPartIndex++,n())return!0}return!1}}class ki{constructor(e,t,i,r,n,o,s,a,l){this.placement=new _i(e,n,o,s,a,l),this._currentPlacementIndex=t.length-1,this._forceFullPlacement=i,this._showCollisionBoxes=r,this._done=!1}isDone(){return this._done}continuePlacement(t,i,r,n,o){const s=e.q.now(),a=()=>{const t=e.q.now()-s;return!this._forceFullPlacement&&t>2};for(;this._currentPlacementIndex>=0;){const s=i[t[this._currentPlacementIndex]],l=this.placement.collisionIndex.transform.zoom;if("symbol"===s.type&&(!s.minzoom||s.minzoom<=l)&&(!s.maxzoom||s.maxzoom>l)){const t=s,i=t.layout.get("symbol-z-elevate"),l=void 0!==t.layout.get("symbol-sort-key").constantOr(1),c=t.layout.get("symbol-z-order"),u="viewport-y"===c||"auto"===c&&!("viewport-y"!==c&&l),h=t.layout.get("text-allow-overlap")||t.layout.get("icon-allow-overlap")||t.layout.get("text-ignore-placement")||t.layout.get("icon-ignore-placement"),d=u&&h,p=this._inProgressLayer=this._inProgressLayer||new Pi(t),f=e.aC(s.source,s.scope);if(p.continuePlacement(i||d?n[f]:r[f],this.placement,this._showCollisionBoxes,s,a,o))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const Ii=512/e.ag/2;class Di{constructor(t,i,r){this.tileID=t,this.bucketInstanceId=r,this.index=new e.bE(i.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const n=t.canonical.x*e.ag,o=t.canonical.y*e.ag;for(let e=0;e<i.length;e++){const{key:t,crossTileID:r,tileAnchorX:s,tileAnchorY:a}=i.get(e),l=Math.floor((n+s)*Ii),c=Math.floor((o+a)*Ii);this.index.add(l,c),this.keys.push(t),this.crossTileIDs.push(r)}this.index.finish()}findMatches(t,i,r){const n=this.tileID.canonical.z<i.canonical.z?1:Math.pow(2,this.tileID.canonical.z-i.canonical.z),o=Ii/Math.pow(2,i.canonical.z-this.tileID.canonical.z),s=i.canonical.x*e.ag,a=i.canonical.y*e.ag;for(let e=0;e<t.length;e++){const i=t.get(e);if(i.crossTileID)continue;const{key:l,tileAnchorX:c,tileAnchorY:u}=i,h=Math.floor((s+c)*o),d=Math.floor((a+u)*o),p=this.index.range(h-n,d-n,h+n,d+n);for(const e of p){const t=this.crossTileIDs[e];if(this.keys[e]===l&&!r.has(t)){r.add(t),i.crossTileID=t;break}}}}}class Li{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ri{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const t=Math.round((e-this.lng)/360);if(0!==t)for(const i in this.indexes){const e=this.indexes[i],r={};for(const i in e){const n=e[i];n.tileID=n.tileID.unwrapTo(n.tileID.wrap+t),r[n.tileID.key]=n}this.indexes[i]=r}this.lng=e}addBucket(e,t,i){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===t.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let n=0;n<t.symbolInstances.length;n++)t.symbolInstances.get(n).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]=new Set);const r=this.usedCrossTileIDs[e.overscaledZ];for(const n in this.indexes){const i=this.indexes[n];if(Number(n)>e.overscaledZ)for(const n in i){const o=i[n];o.tileID.isChildOf(e)&&o.findMatches(t.symbolInstances,e,r)}else{const o=i[e.scaledTo(Number(n)).key];o&&o.findMatches(t.symbolInstances,e,r)}}for(let n=0;n<t.symbolInstances.length;n++){const e=t.symbolInstances.get(n);e.crossTileID||(e.crossTileID=i.generate(),r.add(e.crossTileID))}return void 0===this.indexes[e.overscaledZ]&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Di(e,t.symbolInstances,t.bucketInstanceId),!0}removeBucketCrossTileIDs(e,t){for(const i of t.crossTileIDs)this.usedCrossTileIDs[e].delete(i)}removeStaleBuckets(e){let t=!1;for(const i in this.indexes){const r=this.indexes[i];for(const n in r)e[r[n].bucketInstanceId]||(this.removeBucketCrossTileIDs(i,r[n]),delete r[n],t=!0)}return t}}class zi{constructor(){this.layerIndexes={},this.crossTileIDs=new Li,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,t,i,r){let n=this.layerIndexes[e.fqid];void 0===n&&(n=this.layerIndexes[e.fqid]=new Ri);let o=!1;const s={};"globe"!==r.name&&n.handleWrapJump(i);for(const a of t){const t=a.getBucket(e);t&&e.fqid===t.layerIds[0]&&(t.bucketInstanceId||(t.bucketInstanceId=++this.maxBucketInstanceId),n.addBucket(a.tileID,t,this.crossTileIDs)&&(o=!0),s[t.bucketInstanceId]=!0)}return n.removeStaleBuckets(s)&&(o=!0),o}pruneUnusedLayers(e){const t={};e.forEach((e=>{t[e]=!0}));for(const i in this.layerIndexes)t[i]||delete this.layerIndexes[i]}}const Oi=771;class Fi{constructor(e,t,i,r){this.blendFunction=e,this.blendColor=t,this.mask=i,this.blendEquation=r}}Fi.Replace=[1,0,1,0],Fi.disabled=new Fi(Fi.Replace,e.aj.transparent,[!1,!1,!1,!1]),Fi.unblended=new Fi(Fi.Replace,e.aj.transparent,[!0,!0,!0,!0]),Fi.alphaBlended=new Fi([1,Oi,1,Oi],e.aj.transparent,[!0,!0,!0,!0]),Fi.alphaBlendedNonPremultiplied=new Fi([770,Oi,770,Oi],e.aj.transparent,[!0,!0,!0,!0]),Fi.multiply=new Fi([774,0,774,0],e.aj.transparent,[!0,!0,!0,!0]);class Bi{constructor(e,t,i){this.func=e,this.mask=t,this.range=i}}Bi.ReadOnly=!1,Bi.ReadWrite=!0,Bi.disabled=new Bi(519,Bi.ReadOnly,[0,1]);const Ni=7680;class ji{constructor(e,t,i,r,n,o){this.test=e,this.ref=t,this.mask=i,this.fail=r,this.depthFail=n,this.pass=o}}ji.disabled=new ji({func:519,mask:0},0,0,Ni,Ni,Ni);const Vi=1029,Ui=2305;class Gi{constructor(e,t,i){this.enable=e,this.mode=t,this.frontFace=i}}function Hi(t,i){const r=e.bG(t,3);e.ab.mat4.fromQuat(t,i),e.bI(t,3,r)}function Wi(t,i){const r=e.ab.quat.identity([]);return e.ab.quat.rotateZ(r,r,-i),e.ab.quat.rotateX(r,r,-t),r}function $i(t,i){const r=[t[0],t[1],0],n=[i[0],i[1],0];if(e.ab.vec3.length(r)>=1e-15){const t=e.ab.vec3.normalize([],r);e.ab.vec3.scale(n,t,e.ab.vec3.dot(n,t)),i[0]=n[0],i[1]=n[1]}const o=e.ab.vec3.cross([],i,t);if(e.ab.vec3.len(o)<1e-15)return null;const s=Math.atan2(-o[1],o[0]);return Wi(Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2]),s)}Gi.disabled=new Gi(!1,Vi,Ui),Gi.backCCW=new Gi(!0,Vi,Ui),Gi.backCW=new Gi(!0,Vi,2304),Gi.frontCW=new Gi(!0,1028,2304),Gi.frontCCW=new Gi(!0,1028,Ui);class qi{constructor(e,t){this.position=e,this.orientation=t}get position(){return this._position}set position(t){if(t){const i=t instanceof e.aa?t:new e.aa(t[0],t[1],t[2]);this._renderWorldCopies&&(i.x=e.bF(i.x,0,1)),this._position=i}else this._position=null}lookAtPoint(t,i){if(this.orientation=null,!this.position)return;const r=this.position,n=this._elevation?this._elevation.getAtPointOrZero(e.aa.fromLngLat(t)):0,o=e.aa.fromLngLat(t,n),s=[o.x-r.x,o.y-r.y,o.z-r.z];i||(i=[0,0,1]),i[2]=Math.abs(i[2]),this.orientation=$i(s,i)}setPitchBearing(t,i){this.orientation=Wi(e.ai(t),e.ai(-i))}}class Xi{constructor(t,i){this._transform=e.ab.mat4.identity([]),this.orientation=i,this.position=t}get mercatorPosition(){const t=this.position;return new e.aa(t[0],t[1],t[2])}get position(){const t=e.bG(this._transform,3);return[t[0],t[1],t[2]]}set position(t){var i;t&&e.bI(this._transform,3,[(i=t)[0],i[1],i[2],1])}get orientation(){return this._orientation}set orientation(t){this._orientation=t||e.ab.quat.identity([]),t&&Hi(this._transform,this._orientation)}getPitchBearing(){const e=this.forward(),t=this.right();return{bearing:Math.atan2(-t[1],t[0]),pitch:Math.atan2(Math.sqrt(e[0]*e[0]+e[1]*e[1]),-e[2])}}setPitchBearing(e,t){this._orientation=Wi(e,t),Hi(this._transform,this._orientation)}forward(){const t=e.bG(this._transform,2);return[-t[0],-t[1],-t[2]]}up(){const t=e.bG(this._transform,1);return[-t[0],-t[1],-t[2]]}right(){const t=e.bG(this._transform,0);return[t[0],t[1],t[2]]}getCameraToWorld(t,i){const r=new Float64Array(16);return e.ab.mat4.invert(r,this.getWorldToCamera(t,i)),r}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(t,i,r){const n=this.position;e.ab.vec3.scale(n,n,-t);const o=new Float64Array(16);return e.ab.mat4.fromScaling(o,[r,r,r]),e.ab.mat4.translate(o,o,n),o[10]*=i,o}getWorldToCamera(t,i){const r=new Float64Array(16),n=new Float64Array(4),o=this.position;return e.ab.quat.conjugate(n,this._orientation),e.ab.vec3.scale(o,o,-t),e.ab.mat4.fromQuat(r,n),e.ab.mat4.translate(r,r,o),r[1]*=-1,r[5]*=-1,r[9]*=-1,r[13]*=-1,r[8]*=i,r[9]*=i,r[10]*=i,r[11]*=i,r}getCameraToClipPerspective(t,i,r,n){const o=new Float64Array(16);return e.ab.mat4.perspective(o,t,i,r,n),o}getCameraToClipOrthographic(t,i,r,n,o,s){const a=new Float64Array(16);return e.ab.mat4.ortho(a,t,i,r,n,o,s),a}getDistanceToElevation(t){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=0===t?0:e.bH(t,i?e.aS(this.position[1]):this.position[1]),n=this.forward();return(r-this.position[2])/n[2]}clone(){return new Xi([...this.position],[...this.orientation])}}const Yi={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class Zi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(isNaN(e)||e<0||isNaN(t)||t<0||isNaN(i)||i<0||isNaN(r)||r<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=t,this.left=i,this.right=r}interpolate(t,i,r){return null!=i.top&&null!=t.top&&(this.top=e.af(t.top,i.top,r)),null!=i.bottom&&null!=t.bottom&&(this.bottom=e.af(t.bottom,i.bottom,r)),null!=i.left&&null!=t.left&&(this.left=e.af(t.left,i.left,r)),null!=i.right&&null!=t.right&&(this.right=e.af(t.right,i.right,r)),this}getCenter(t,i){const r=e.aw((this.left+t-this.right)/2,0,t),n=e.aw((this.top+i-this.bottom)/2,0,i);return new e.P(r,n)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new Zi(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Ki=(e,t,i)=>(1-i)*e+i*t,Ji=e=>e*e*e*e*e;class Qi{constructor(t,i,r,n,o,s,a){this.tileSize=512,this._renderWorldCopies=void 0===o||o,this._minZoom=t||0,this._maxZoom=i||22,this._minPitch=r??0,this._maxPitch=n??60,this.setProjection(s),this.setMaxBounds(a),this.width=0,this.height=0,this._center=new e.bO(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Zi,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new Xi,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const e=new Qi(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return e._elevation=this._elevation,e._centerAltitude=this._centerAltitude,e._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,e.tileSize=this.tileSize,e.mercatorFromTransition=this.mercatorFromTransition,e.width=this.width,e.height=this.height,e.cameraElevationReference=this.cameraElevationReference,e._center=this._center,e._setZoom(this.zoom),e._seaLevelZoom=this._seaLevelZoom,e.angle=this.angle,e._fov=this._fov,e._pitch=this._pitch,e._nearZ=this._nearZ,e._farZ=this._farZ,e._averageElevation=this._averageElevation,e._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,e._unmodified=this._unmodified,e._edgeInsets=this._edgeInsets.clone(),e._camera=this._camera.clone(),e._calcMatrices(),e.freezeTileCoverage=this.freezeTileCoverage,e.frustumCorners=this.frustumCorners,e}get isOrthographic(){return"globe"!==this.projection.name&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(e){this._elevation!==e&&(this._elevation=e,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return"globe"!==this.projection.name&&!this.isOrthographic}updateElevation(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||i)&&this._updateCameraOnTerrain(),(e||i)&&this._constrainCamera(t),this._calcMatrices()}getProjection(){return e.ay(this.projection,["name","center","parallels"])}setProjection(t){this.projectionOptions=t||{name:"mercator"};const i=this.projection?this.getProjection():void 0;this.projection=e.bP(this.projectionOptions);const r=this.getProjection(),n=!e.bn(i,r);return n&&this._calcMatrices(),this.mercatorFromTransition=!1,n}setOrthographicProjectionAtLowPitch(e){return this._orthographicProjectionAtLowPitch!==e&&(this._orthographicProjectionAtLowPitch=e,this._calcMatrices(),!0)}setMercatorFromTransition(){const t=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=e.bP({name:"mercator"});const i=t!==this.projection.name;return i&&this._calcMatrices(),i}get minZoom(){return this._minZoom}set minZoom(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}get maxZoom(){return this._maxZoom}set maxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}get minPitch(){return this._minPitch}set minPitch(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}get maxPitch(){return this._maxPitch}set maxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(e){void 0===e?e=!0:null===e&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const e=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(e))}get cameraWorldSize(){const e=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(e))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return e.bH(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new e.P(this.width,this.height)}get bearing(){return e.bF(this.rotation,-180,180)}set bearing(e){this.rotation=e}get rotation(){return-this.angle/Math.PI*180}set rotation(t){const i=-t*Math.PI/180;this.angle!==i&&(this._unmodified=!1,this.angle=i,this._calcMatrices(),this.rotationMatrix=e.ab.mat2.create(),e.ab.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const i=e.aw(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==i&&(this._unmodified=!1,this._pitch=i,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const e=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/e)}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=e.ai(t),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(e){this._averageElevation=e,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(e){const t=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==t&&(this._unmodified=!1,this._setZoom(t),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(e){this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(e){this._tileCoverLift!==e&&(this._tileCoverLift=e)}_updateCameraOnTerrain(){const e=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,t=this.elevation&&e===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||e===Number.NEGATIVE_INFINITY&&(!t||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const i=this._elevation;t||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&i.exaggeration()&&this._centerAltitudeValidForExaggeration!==i.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*i.exaggeration(),this._centerAltitudeValidForExaggeration=i.exaggeration()):(this._centerAltitude=e||0,this._centerAltitudeValidForExaggeration=i.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const t=this._elevation,i=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],r=this.horizonLineFromTop();let n=0,o=0;for(let s=0;s<i.length;s++){const a=new e.P(i[s][0]*this.width,r+i[s][1]*(this.height-r)),l=t.pointCoordinate(a);if(!l)continue;const c=1/Math.hypot(l[0]-this._camera.position[0],l[1]-this._camera.position[1]);n+=l[3]*c,o+=c}return 0===o?NaN:n/o}get center(){return this._center}set center(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const e=this._seaLevelZoom,t=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),i=this.pixelsPerMeter/this.worldSize*t,r=this._mercatorZfromZoom(e),n=this._mercatorZfromZoom(this._maxZoom),o=Math.max(r-i,n);this._setZoom(this._zoomFromMercatorZ(o))}get padding(){return this._edgeInsets.toJSON()}set padding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}computeZoomRelativeTo(t){const i=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,t.toAltitude()));let r;r=t.z<this._camera.position[2]?[i.x,i.y,i.z]:[t.x,t.y,t.z];const n=e.ab.vec3.length(e.ab.vec3.sub([],this._camera.position,r));return e.aw(this._zoomFromMercatorZ(n),this._minZoom,this._maxZoom)}setFreeCameraOptions(t){if(!this.height)return;if(!t.position&&!t.orientation)return;this._updateCameraState();let i=!1;if(t.orientation&&!e.ab.quat.exactEquals(t.orientation,this._camera.orientation)&&(i=this._setCameraOrientation(t.orientation)),t.position){const r=[t.position.x,t.position.y,t.position.z];e.ab.vec3.exactEquals(r,this._camera.position)||(this._setCameraPosition(r),i=!0)}i&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const t=this._camera.position,i=new qi;return i.position=new e.aa(t[0],t[1],t[2]),i.orientation=this._camera.orientation,i._elevation=this.elevation,i._renderWorldCopies=this.renderWorldCopies,i}_setCameraOrientation(t){if(!e.ab.quat.length(t))return!1;e.ab.quat.normalize(t,t);const i=e.ab.vec3.transformQuat([],[0,0,-1],t),r=e.ab.vec3.transformQuat([],[0,-1,0],t);if(r[2]<0)return!1;const n=$i(i,r);return!!n&&(this._camera.orientation=n,!0)}_setCameraPosition(t){const i=this.zoomScale(this.minZoom)*this.tileSize,r=this.zoomScale(this.maxZoom)*this.tileSize,n=this.cameraToCenterDistance;t[2]=e.aw(t[2],n/r,n/i),this._camera.position=t}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,t,i){this._unmodified=!1,this._edgeInsets.interpolate(e,t,i),this._constrain(),this._calcMatrices()}coveringZoomLevel(e){const t=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,t)}getVisibleUnwrappedCoordinates(t){const i=[new e.bQ(0,t)];if(this.renderWorldCopies){const r=this.pointCoordinate(new e.P(0,0)),n=this.pointCoordinate(new e.P(this.width,0)),o=this.pointCoordinate(new e.P(this.width,this.height)),s=this.pointCoordinate(new e.P(0,this.height)),a=Math.floor(Math.min(r.x,n.x,o.x,s.x)),l=Math.floor(Math.max(r.x,n.x,o.x,s.x)),c=1;for(let u=a-c;u<=l+c;u++)0!==u&&i.push(new e.bQ(u,t))}return i}isLODDisabled(e){return(!e||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(t,i,r){let n=[];const o=void 0!==r,s=!o;if(s&&this.zoom<i)return n;if(o&&0===r[0]&&0===r[1])return n;const a=new Set,l=(t,i,r,o,s)=>{const l=e.c5(i,t,r,o,s);a.has(l)||(n.push(new e.aG(t,i,r,o,s)),a.add(l))};for(let e=0;e<t.length;e++){const n=t[e];if(s&&n.canonical.z!==i)continue;const a=n.canonical,c=n.overscaledZ,u=n.wrap,h=1<<a.z,d=a.x+1<h,p=a.x>0,f=a.y+1<h,m=a.y>0,g=n.wrap-(p?0:1),y=n.wrap+(d?0:1),_=p?a.x-1:h-1,v=d?a.x+1:0;if(o)r[0]<0?(l(c,y,a.z,v,a.y),r[1]<0&&f&&(l(c,u,a.z,a.x,a.y+1),l(c,y,a.z,v,a.y+1)),r[1]>0&&m&&(l(c,u,a.z,a.x,a.y-1),l(c,y,a.z,v,a.y-1))):r[0]>0?(l(c,g,a.z,_,a.y),r[1]<0&&f&&(l(c,u,a.z,a.x,a.y+1),l(c,g,a.z,_,a.y+1)),r[1]>0&&m&&(l(c,u,a.z,a.x,a.y-1),l(c,g,a.z,_,a.y-1))):r[1]<0&&f?l(c,u,a.z,a.x,a.y+1):m&&l(c,u,a.z,a.x,a.y-1);else{const e=n.visibleQuadrants;1&e&&(l(c,g,a.z,_,a.y),m&&(l(c,u,a.z,a.x,a.y-1),l(c,g,a.z,_,a.y-1))),2&e&&(l(c,y,a.z,v,a.y),m&&(l(c,u,a.z,a.x,a.y-1),l(c,y,a.z,v,a.y-1))),4&e&&(l(c,g,a.z,_,a.y),f&&(l(c,u,a.z,a.x,a.y+1),l(c,g,a.z,_,a.y+1))),8&e&&(l(c,y,a.z,v,a.y),f&&(l(c,u,a.z,a.x,a.y+1),l(c,y,a.z,v,a.y+1)))}}const c=[];for(const e of n)n.some((t=>e.isChildOf(t)))||c.push(e);if(n=c.filter((e=>!t.some((t=>!!(e.overscaledZ<i&&t.isChildOf(e))||e.equals(t)||e.isChildOf(t))))),s){const e=1<<i,t="globe"===this.projection.name?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),r=[e*t.x,e*t.y],o=4,s=o*o;n=n.filter((e=>{const t=e.canonical.x+.5-r[0],i=e.canonical.y+.5-r[1];return t*t+i*i<s}))}return n}coveringTiles(t){let i=this.coveringZoomLevel(t);const r=i,n=this.elevation&&this.elevation.exaggeration(),o=n&&!t.isTerrainDEM,s="mercator"===this.projection.name;if(void 0!==t.minzoom&&i<t.minzoom)return[];void 0!==t.maxzoom&&i>t.maxzoom&&(i=t.maxzoom);const a=this.locationCoordinate(this.center),l=this.center.lat,c=1<<i,u=[c*a.x,c*a.y,0],h="globe"===this.projection.name,d=!h,p=e.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,i,d),f=h?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),m=c*e.bH(1,this.center.lat),g=this._camera.position[2]/e.bH(1,this.center.lat),y=[c*f.x,c*f.y,g*(d?1:m)],_=h||n,v=this.cameraToCenterDistance/t.tileSize*(t.roundZoom?1:.502),x=this.isLODDisabled(!0)?i:0;let b;if(this._elevation&&t.isTerrainDEM)b=1e4*this._elevation.exaggeration();else if(this._elevation){const e=this._elevation.getMinMaxForVisibleTiles();b=e?e.max:this._centerAltitude}else b=this._centerAltitude;const w=t.isTerrainDEM?-b:this._elevation?this._elevation.getMinElevationBelowMSL():0,S=this.projection.isReprojectedInTileSpace?e.bS(this):1,T=t=>{const i=1/4e4,r=new e.aa(t.x+i,t.y,t.z),n=new e.aa(t.x,t.y+i,t.z),o=t.toLngLat(),s=r.toLngLat(),a=n.toLngLat(),l=this.locationCoordinate(o),c=this.locationCoordinate(s),u=this.locationCoordinate(a),h=Math.hypot(c.x-l.x,c.y-l.y),d=Math.hypot(u.x-l.x,u.y-l.y);return Math.sqrt(h*d)*S/i},M=t=>{const i=b,r=w;return{aabb:e.bV(this,c,0,0,0,t,r,i,this.projection),zoom:0,x:0,y:0,minZ:r,maxZ:i,wrap:t,fullyVisible:!1}},A=[];let C=[];const E=i,P=t.reparseOverscaled?r:i,k=(g-this._centerAltitude)*m,I=e=>{if(!this._elevation||!e.tileID||!s)return;const t=this._elevation.getMinMaxForTile(e.tileID),i=e.aabb;t?(i.min[2]=t.min,i.max[2]=t.max,i.center[2]=(i.min[2]+i.max[2])/2):(e.shouldSplit=L(e),e.shouldSplit||(i.min[2]=i.max[2]=i.center[2]=this._centerAltitude))},D=(e,t)=>{if(.707*t<e)return 1;const i=t/e;return i/(1.4144271570014144+(Math.pow(1.1,i-1.4144271570014144+1)-1)/(1.1-1)-1)},L=t=>{if(t.zoom<x)return!0;if(t.zoom===E)return!1;if(null!=t.shouldSplit)return t.shouldSplit;const i=t.aabb.distanceX(y),n=t.aabb.distanceY(y);let a=k,c=1;if(h){a=t.aabb.distanceZ(y);const i=Math.pow(2,t.zoom),r=e.aS((t.y+1)/i),n=e.aS(t.y/i),o=Math.min(Math.max(l,r),n),s=e.c9(o)/e.c9(l);if(c=o===l?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,s/this._mercatorScaleRatio),this.zoom<=e.c6&&t.zoom===E-1&&s>=.9)return!0}else if(o&&(a=t.aabb.distanceZ(y)*m),this.projection.isReprojectedInTileSpace&&r<=5){const i=Math.pow(2,t.zoom),r=T(new e.aa((t.x+.5)/i,(t.y+.5)/i));c=r>.85?1:r}if(!s){const e=Math.sqrt(i*i+n*n+a*a);let r=(1<<E-t.zoom)*v*c;return r*=D(Math.max(a,k),e),e<r}let d=Number.MAX_VALUE,p=0;const f=t.aabb.getCorners(),g=[];for(const r of f){e.ab.vec3.sub(g,r,y),h||(o?g[2]*=m:g[2]=k);const t=e.ab.vec3.dot(g,this._camera.forward());t<d&&(d=t,p=Math.abs(g[2]))}let _=(1<<E-t.zoom)*v*c;if(_*=D(Math.max(p,k),d),d<_)return!0;const b=t.aabb.closestPoint(u);return b[0]===u[0]&&b[1]===u[1]};if(this.renderWorldCopies)for(let e=1;e<=3;e++)A.push(M(-e)),A.push(M(e));for(A.push(M(0));A.length>0;){const r=A.pop(),n=r.x,a=r.y;let l=r.fullyVisible;const d=()=>"globe"===this.projection.name&&(0===r.y||r.y===(1<<r.zoom)-1);if(!l){let t=_?r.aabb.intersects(p):r.aabb.intersectsFlat(p);if(0===t&&d()){const i=new e.bT(r.zoom,n,a);t=e.bU(this,c,i,!0).intersects(p)}if(0===t)continue;l=2===t}if(r.zoom!==E&&L(r))for(let t=0;t<4;t++){const i=(n<<1)+t%2,u=(a<<1)+(t>>1),d={aabb:s?r.aabb.quadrant(t):e.bV(this,c,r.zoom+1,i,u,r.wrap,r.minZ,r.maxZ,this.projection),zoom:r.zoom+1,x:i,y:u,wrap:r.wrap,fullyVisible:l,tileID:void 0,shouldSplit:void 0,minZ:r.minZ,maxZ:r.maxZ};o&&!h&&(d.tileID=new e.aG(r.zoom+1===E?P:r.zoom+1,r.wrap,r.zoom+1,i,u),I(d)),A.push(d)}else{const o=r.zoom===E?P:r.zoom;if(t.minzoom&&t.minzoom>o)continue;let s=0;if(!l){let i=_?r.aabb.intersectsPrecise(p):r.aabb.intersectsPreciseFlat(p);if(0===i&&d()){const t=new e.bT(r.zoom,n,a);i=e.bU(this,c,t,!0).intersectsPrecise(p)}if(0===i)continue;if(t.calculateQuadrantVisibility)if(p.containsPoint(r.aabb.center))s=15;else for(let e=0;e<4;e++)0!==r.aabb.quadrant(e).intersects(p)&&(s|=1<<e)}const h=u[0]-(.5+n+(r.wrap<<r.zoom))*(1<<i-r.zoom),f=u[1]-.5-a,m=r.tileID?r.tileID:new e.aG(o,r.wrap,r.zoom,n,a);t.calculateQuadrantVisibility&&(m.visibleQuadrants=s),C.push({tileID:m,distanceSq:h*h+f*f})}}if(this.fogCullDistSq){const i=this.fogCullDistSq,r=this.horizonLineFromTop();C=C.filter((n=>{const o=[0,0,0,1],s=[e.ag,e.ag,0,1],a=this.calculateFogTileMatrix(n.tileID.toUnwrapped());e.ab.vec4.transformMat4(o,o,a),e.ab.vec4.transformMat4(s,s,a);const l=e.ab.vec4.min([],o,s),c=e.ab.vec4.max([],o,s),u=e.bW(l,c);if(0===u)return!0;let h=!1;const d=this._elevation;if(d&&u>i&&0!==r){const i=this.calculateProjMatrix(n.tileID.toUnwrapped());let o;t.isTerrainDEM||(o=d.getMinMaxForTile(n.tileID)),o||(o={min:w,max:b});const s=e.c7(this.rotation),a=[s[0]*e.ag,s[1]*e.ag,o.max];e.ab.vec3.transformMat4(a,a,i),h=(1-a[1])*this.height*.5<r}return u<i||h}))}return C.sort(((e,t)=>e.distanceSq-t.distanceSq)).map((e=>e.tileID))}resize(e,t){this.width=e,this.height=t,this.pixelsToGLUnits=[2/e,-2/t],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(e){return Math.pow(2,e)}scaleZoom(e){return Math.log(e)/Math.LN2}project(t){const i=e.aw(t.lat,-e.bX,e.bX),r=this.projection.project(t.lng,i);return new e.P(r.x*this.worldSize,r.y*this.worldSize)}unproject(e){return this.projection.unproject(e.x/this.worldSize,e.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/e.bH(1,this.center.lat)/this.worldSize}setLocationAtPoint(t,i){let r,n;const o=this.centerPoint;if("globe"===this.projection.name){const e=this.worldSize;r=(i.x-o.x)/e,n=(i.y-o.y)/e}else{const e=this.pointCoordinate(i),t=this.pointCoordinate(o);r=e.x-t.x,n=e.y-t.y}const s=this.locationCoordinate(t);this.setLocation(new e.aa(s.x-r,s.y-n))}setLocation(e){this.center=this.coordinateLocation(e),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(e){return this.projection.locationPoint(this,e)}locationPoint3D(e){return this.projection.locationPoint(this,e,!0)}pointLocation(e){return this.coordinateLocation(this.pointCoordinate(e))}pointLocation3D(e){return this.coordinateLocation(this.pointCoordinate3D(e))}locationCoordinate(t,i){const r=i?e.bH(i,t.lat):void 0,n=this.projection.project(t.lng,t.lat);return new e.aa(n.x,n.y,r)}coordinateLocation(e){return this.projection.unproject(e.x,e.y)}pointRayIntersection(t,i){const r=null!=i?i:this._centerAltitude,n=[t.x,t.y,0,1],o=[t.x,t.y,1,1];e.ab.vec4.transformMat4(n,n,this.pixelMatrixInverse),e.ab.vec4.transformMat4(o,o,this.pixelMatrixInverse);const s=o[3];e.ab.vec4.scale(n,n,1/n[3]),e.ab.vec4.scale(o,o,1/s);const a=n[2],l=o[2];return{p0:n,p1:o,t:a===l?0:(r-a)/(l-a)}}screenPointToMercatorRay(t){const i=[t.x,t.y,0,1],r=[t.x,t.y,1,1];return e.ab.vec4.transformMat4(i,i,this.pixelMatrixInverse),e.ab.vec4.transformMat4(r,r,this.pixelMatrixInverse),e.ab.vec4.scale(i,i,1/i[3]),e.ab.vec4.scale(r,r,1/r[3]),i[2]=e.bH(i[2],this._center.lat)*this.worldSize,r[2]=e.bH(r[2],this._center.lat)*this.worldSize,e.ab.vec4.scale(i,i,1/this.worldSize),e.ab.vec4.scale(r,r,1/this.worldSize),new e.aq([i[0],i[1],i[2]],e.ab.vec3.normalize([],e.ab.vec3.sub([],r,i)))}rayIntersectionCoordinate(t){const{p0:i,p1:r,t:n}=t,o=e.bH(i[2],this._center.lat),s=e.bH(r[2],this._center.lat);return new e.aa(e.af(i[0],r[0],n)/this.worldSize,e.af(i[1],r[1],n)/this.worldSize,e.af(o,s,n))}pointCoordinate(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._centerAltitude;return this.projection.pointCoordinate(this,e.x,e.y,t)}pointCoordinate3D(t){if(!this.elevation)return this.pointCoordinate(t);let i=this.projection.pointCoordinate3D(this,t.x,t.y);if(i)return new e.aa(i[0],i[1],i[2]);let r=0,n=this.horizonLineFromTop();if(t.y>n)return this.pointCoordinate(t);const o=.02*n,s=t.clone();for(let a=0;a<10&&n-r>o;a++){s.y=e.af(r,n,.66);const t=this.projection.pointCoordinate3D(this,s.x,s.y);t?(n=s.y,i=t):r=s.y}return i?new e.aa(i[0],i[1],i[2]):this.pointCoordinate(t)}isPointAboveHorizon(e){return this.projection.isPointAboveHorizon(this,e)}isPointOnSurface(t){if(t.y<0||t.y>this.height||t.x<0||t.x>this.width)return!1;if(this.elevation||this.zoom>=e.bY)return!this.isPointAboveHorizon(t);const i=this.pointCoordinate(t);return i.y>=0&&i.y<=1}_coordinatePoint(t,i){const r=i&&this.elevation?this.elevation.getAtPointOrZero(t,this._centerAltitude):this._centerAltitude,n=[t.x*this.worldSize,t.y*this.worldSize,r+t.toAltitude(),1];return e.ab.vec4.transformMat4(n,n,this.pixelMatrix),n[3]>0?new e.P(n[0]/n[3],n[1]/n[3]):new e.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:t,left:i}=this._edgeInsets,r=this.height-this._edgeInsets.bottom,n=this.width-this._edgeInsets.right,o=this.pointLocation3D(new e.P(i,t)),s=this.pointLocation3D(new e.P(n,t)),a=this.pointLocation3D(new e.P(n,r)),l=this.pointLocation3D(new e.P(i,r));let c=Math.min(o.lng,s.lng,a.lng,l.lng),u=Math.max(o.lng,s.lng,a.lng,l.lng),h=Math.min(o.lat,s.lat,a.lat,l.lat),d=Math.max(o.lat,s.lat,a.lat,l.lat);const p=Math.pow(2,-this.zoom)/16*270,f="globe"===this.projection.name?1:4,m=(t,i,r,n,o)=>{const s=(t+r)/2,a=(i+n)/2,l=new e.P(s,a),{lng:g,lat:y}=this.pointLocation3D(l),_=Math.max(0,c-g,h-y,g-u,y-d);c=Math.min(c,g),u=Math.max(u,g),h=Math.min(h,y),d=Math.max(d,y),(o<f||_>p)&&(m(t,i,s,a,o+1),m(s,a,r,n,o+1))};if(m(i,t,n,t,1),m(n,t,n,r,1),m(n,r,i,r,1),m(i,r,i,t,1),"globe"===this.projection.name){const[t,i]=e.bZ(this);t?(d=90,u=180,c=-180):i&&(h=-90,u=180,c=-180)}return new e.az(new e.bO(c,h),new e.bO(u,d))}_getBoundsRectangular(t,i){const{top:r,left:n}=this._edgeInsets,o=this.height-this._edgeInsets.bottom,s=this.width-this._edgeInsets.right,a=new e.P(n,r),l=new e.P(s,r),c=new e.P(s,o),u=new e.P(n,o);let h=this.pointCoordinate(a,t),d=this.pointCoordinate(l,t);const p=this.pointCoordinate(c,i),f=this.pointCoordinate(u,i),m=(e,t)=>(t.y-e.y)/(t.x-e.x);return h.y>1&&d.y>=0?h=new e.aa((1-f.y)/m(f,h)+f.x,1):h.y<0&&d.y<=1&&(h=new e.aa(-f.y/m(f,h)+f.x,0)),d.y>1&&h.y>=0?d=new e.aa((1-p.y)/m(p,d)+p.x,1):d.y<0&&h.y<=1&&(d=new e.aa(-p.y/m(p,d)+p.x,0)),(new e.az).extend(this.coordinateLocation(h)).extend(this.coordinateLocation(d)).extend(this.coordinateLocation(f)).extend(this.coordinateLocation(p))}_getBoundsRectangularTerrain(){const e=this.elevation;if(!e.visibleDemTiles.length||e.isUsingMockSource())return this._getBoundsRectangular(0,0);const t=e.visibleDemTiles.reduce(((e,t)=>{if(t.dem){const i=t.dem.tree;e.min=Math.min(e.min,i.minimums[0]),e.max=Math.max(e.max,i.maximums[0])}return e}),{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(t.min*e.exaggeration(),t.max*e.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,i=this.height/2-t*(1-this._horizonShift);return e?Math.max(0,i):i}getMaxBounds(){return this.maxBounds}setMaxBounds(t){this.maxBounds=t,this.minLat=-e.bX,this.maxLat=e.bX,this.minLng=-180,this.maxLng=180,t&&(this.minLat=t.getSouth(),this.maxLat=t.getNorth(),this.minLng=t.getWest(),this.maxLng=t.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=e.at(this.minLng)*this.tileSize,this.worldMaxX=e.at(this.maxLng)*this.tileSize,this.worldMinY=e.aA(this.maxLat)*this.tileSize,this.worldMaxY=e.aA(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(e,t){return this.projection.createTileMatrix(this,t,e)}calculateDistanceTileData(t){const i=t.key,r=this._distanceTileDataCache;if(r[i])return r[i];const n=t.canonical,o=1/this.height,s=this.cameraWorldSize,a=s/this.zoomScale(n.z),l=(n.x+Math.pow(2,n.z)*t.wrap)*a,c=n.y*a,u=this.point;u.x*=s/this.worldSize,u.y*=s/this.worldSize;const h=this.angle,d=Math.sin(-h),p=-Math.cos(-h);return r[i]={bearing:[d,p],center:[(u.x-l)*o,(u.y-c)*o],scale:a/e.ag*o},r[i]}calculateFogTileMatrix(t){const i=t.key,r=this._fogTileMatrixCache;if(r[i])return r[i];const n=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,t);return e.ab.mat4.multiply(n,this.worldToFogMatrix,n),r[i]=new Float32Array(n),r[i]}calculateProjMatrix(t){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=t.key;let o;if(o=r?this._expandedProjMatrixCache:i?this._alignedProjMatrixCache:this._projMatrixCache,o[n])return o[n];const s=this.calculatePosMatrix(t,this.worldSize);let a;return a=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:r?this.expandedFarZProjMatrix:i?this.alignedProjMatrix:this.projMatrix,e.ab.mat4.multiply(s,a,s),o[n]=new Float32Array(s),o[n]}calculatePixelsToTileUnitsMatrix(t){const i=t.tileID.key,r=this._pixelsToTileUnitsCache;if(r[i])return r[i];const n=e.b_(t,this);return r[i]=n,r[i]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const t=1/this.worldSize,i=e.ab.mat4.fromScaling([],[t,t,t]);return e.ab.mat4.multiply(i,i,this.globeMatrix),i}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const t=this._elevation;this._updateCameraState();const i=e.bH(1,this._center.lat)*this.worldSize,r=this._computeCameraPosition(i),n=this._camera.forward(),o=e.bH(1,this._center.lat);r[2]/=o,n[2]/=o,e.ab.vec3.normalize(n,n);const s=t.raycast(r,n,t.exaggeration());if(s){const t=e.ab.vec3.scaleAndAdd([],r,n,s),i=new e.aa(t[0],t[1],e.bH(t[2],e.aS(t[1]))),a=(i.z+e.ab.vec3.length([i.x-r[0],i.y-r[1],i.z-r[2]*o]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(a),this._centerAltitude=i.toAltitude(),this._center=this.coordinateLocation(i),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this._elevation)return;const i=this._elevation,r=e.bH(1,this._center.lat)*this.worldSize,n=this._computeCameraPosition(r),o=i.getAtPointOrZero(new e.aa(...n)),s=this.pixelsPerMeter/this.worldSize*o,a=this._minimumHeightOverTerrain(),l=n[2]-s;if(l<=a)if(l<0||t){const t=this.locationCoordinate(this._center,this._centerAltitude),i=[n[0],n[1],t.z-n[2]],r=e.ab.vec3.length(i);i[2]-=(a-l)/this._pixelsPerMercatorPixel;const o=e.ab.vec3.length(i);if(0===o)return;e.ab.vec3.scale(i,i,r/o*this._pixelsPerMercatorPixel),this._camera.position=[n[0],n[1],t.z*this._pixelsPerMercatorPixel-i[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const t="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||t){const i=this.center;return i.lat=e.aw(i.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!t)&&(i.lng=e.aw(i.lng,this.minLng,this.maxLng)),this.center=i,void(this._constraining=!1)}const i=this._unmodified,{x:r,y:n}=this.point;let o=0,s=r,a=n;const l=this.width/2,c=this.height/2,u=this.worldMinY*this.scale,h=this.worldMaxY*this.scale;if(n-c<u&&(a=u+c),n+c>h&&(a=h-c),h-u<this.height&&(o=Math.max(o,this.height/(h-u)),a=(h+u)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const e=this.worldMinX*this.scale,t=this.worldMaxX*this.scale,i=this.worldSize/2-(e+t)/2;s=(r+i+this.worldSize)%this.worldSize-i,s-l<e&&(s=e+l),s+l>t&&(s=t-l),t-e<this.width&&(o=Math.max(o,this.width/(t-e)),s=(t+e)/2)}s===r&&a===n||(this.center=this.unproject(new e.P(s,a))),o&&(this.zoom+=this.scaleZoom(o)),this._constrainCamera(),this._unmodified=i,this._constraining=!1}_minZoomForBounds(){let e=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(e=Math.max(e,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),e}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,i="globe"===this.projection.name,r=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=e.bH(1,this.center.lat)/e.bH(1,e.c8));const n=e.b$(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,n),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const o="meters"===this.projection.zAxisUnit?r:1,s=this._camera.getWorldToCamera(this.worldSize,o);let a;const l=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(l[8]=2*-t.x/this.width,l[9]=2*t.y/this.height,this.isOrthographic){let e=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),i=e*this.aspect,r=-i,n=-e;i-=t.x,r-=t.x,e+=t.y,n+=t.y,a=this._camera.getCameraToClipOrthographic(r,i,n,e,this._nearZ,this._farZ),((e,t,i,r)=>{for(let n=0;n<16;n++)e[n]=Ki(t[n],i[n],r)})(a,a,l,Ji(this.pitch>=15?1:this.pitch/15))}else a=l;const c=e.ab.mat4.mul([],l,s);let u=e.ab.mat4.mul([],a,s);if(this.projection.isReprojectedInTileSpace){const t=this.locationCoordinate(this.center),i=e.ab.mat4.identity([]);e.ab.mat4.translate(i,i,[t.x*this.worldSize,t.y*this.worldSize,0]),e.ab.mat4.multiply(i,i,e.c0(this)),e.ab.mat4.translate(i,i,[-t.x*this.worldSize,-t.y*this.worldSize,0]),e.ab.mat4.multiply(u,u,i),e.ab.mat4.multiply(c,c,i),this.inverseAdjustmentMatrix=e.c1(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=e.ab.mat4.scale([],u,[this.worldSize,this.worldSize,this.worldSize/o,1]),this.projMatrix=u,this.invProjMatrix=e.ab.mat4.invert(new Float64Array(16),this.projMatrix),i){const i=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);i[8]=2*-t.x/this.width,i[9]=2*t.y/this.height,this.expandedFarZProjMatrix=e.ab.mat4.mul([],i,s)}else this.expandedFarZProjMatrix=this.projMatrix;const h=e.ab.mat4.invert([],a);this.frustumCorners=e.c2.fromInvProjectionMatrix(h,this.horizonLineFromTop(),this.height),this.cameraFrustum=e.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!i);const d=new Float32Array(16);e.ab.mat4.identity(d),e.ab.mat4.scale(d,d,[1,-1,1]),e.ab.mat4.rotateX(d,d,this._pitch),e.ab.mat4.rotateZ(d,d,this.angle);const p=e.ab.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=e.ab.mat4.clone(p);const f=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;p[8]=2*-t.x/this.width,p[9]=2*(t.y+f)/this.height,this.skyboxMatrix=e.ab.mat4.multiply(d,p,d);const m=this.point,g=m.x,y=m.y,_=this.width%2/2,v=this.height%2/2,x=Math.cos(this.angle),b=Math.sin(this.angle),w=g-Math.round(g)+x*_+b*v,S=y-Math.round(y)+x*v+b*_,T=new Float64Array(u);if(e.ab.mat4.translate(T,T,[w>.5?w-1:w,S>.5?S-1:S,0]),this.alignedProjMatrix=T,u=e.ab.mat4.create(),e.ab.mat4.scale(u,u,[this.width/2,-this.height/2,1]),e.ab.mat4.translate(u,u,[1,-1,0]),this.labelPlaneMatrix=u,u=e.ab.mat4.create(),e.ab.mat4.scale(u,u,[1,-1,1]),e.ab.mat4.translate(u,u,[-1,-1,0]),e.ab.mat4.scale(u,u,[2/this.width,2/this.height,1]),this.glCoordMatrix=u,this.pixelMatrix=e.ab.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,c),this._calcFogMatrices(),this._distanceTileDataCache={},u=e.ab.mat4.invert(new Float64Array(16),this.pixelMatrix),!u)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=u,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=e.c3(this);const t=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=e.ab.vec3.transformMat4(t,t,s),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=u;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const t=this.cameraWorldSizeForFog,i=this.cameraPixelsPerMeter,r=this._camera.position,n=1/this.height/this._pixelsPerMercatorPixel,o=[t,t,i];e.ab.vec3.scale(o,o,n),e.ab.vec3.scale(r,r,-1),e.ab.vec3.multiply(r,r,o);const s=e.ab.mat4.create();e.ab.mat4.translate(s,s,r),e.ab.mat4.scale(s,s,o),this.mercatorFogMatrix=s,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(t,i,n)}_computeCameraPosition(e){const t=(e=e||this.pixelsPerMeter)/this.pixelsPerMeter,i=this._camera.forward(),r=this.point,n=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*t-e/this.worldSize*this._centerAltitude;return[r.x/this.worldSize-i[0]*n,r.y/this.worldSize-i[1]*n,e/this.worldSize*this._centerAltitude-i[2]*n]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(t){const i=this._maxCameraBoundsDistance()*Math.cos(this._pitch),r=this._camera.position[2],n=t[2];let o=1;this.projection.wrap&&(this.center=this.center.wrap()),n>0&&(o=Math.min((i-r)/n,1)),this._camera.position=e.ab.vec3.scaleAndAdd([],this._camera.position,t,o),this._updateStateFromCamera()}_updateStateFromCamera(){const t=this._camera.position,i=this._camera.forward(),{pitch:r,bearing:n}=this._camera.getPitchBearing(),o=e.bH(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,s=this._mercatorZfromZoom(this._maxZoom)*Math.cos(e.ai(this._maxPitch)),a=Math.max((t[2]-o)/Math.cos(r),s),l=this._zoomFromMercatorZ(a);e.ab.vec3.scaleAndAdd(t,t,i,a),this._pitch=e.aw(r,e.ai(this.minPitch),e.ai(this.maxPitch)),this.angle=e.bF(n,-Math.PI,Math.PI),this._setZoom(e.aw(l,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new e.aa(t[0],t[1],t[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(e){return Math.pow(2,e)*this.tileSize}_mercatorZfromZoom(e){return this.cameraToCenterDistance/this._worldSizeFromZoom(e)}_minimumHeightOverTerrain(){const e=Math.min(null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(e)}_zoomFromMercatorZ(e){return this.scaleZoom(this.cameraToCenterDistance/(e*this.tileSize))}zoomFromMercatorZAdjusted(t){let i=0,r=e.bY,n=0,o=1/0;for(;r-i>1e-6&&r>i;){const e=i+.5*(r-i),s=this.tileSize*Math.pow(2,e),a=this.getCameraToCenterDistance(this.projection,e,s),l=this.scaleZoom(a/(t*this.tileSize)),c=Math.abs(e-l);c<o&&(o=c,n=e),e<l?i=e:r=e}return n}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(e.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(t,i){const r=Math.min(t.x,i.x),n=Math.max(t.x,i.x),o=Math.min(t.y,i.y),s=Math.max(t.y,i.y);if(o<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const a=[new e.P(r,o),new e.P(n,s),new e.P(r,s),new e.P(n,o)],l=this.renderWorldCopies?-3:0,c=this.renderWorldCopies?4:1;for(const e of a){const t=this.pointRayIntersection(e);if(t.t<0)return!0;const i=this.rayIntersectionCoordinate(t);if(i.x<l||i.y<0||i.x>c||i.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+e.c4(this.fovAboveCenter)>88||this.anyCornerOffEdge(new e.P(0,0),new e.P(this.width,this.height))}zoomDeltaToMovement(t,i){const r=e.ab.vec3.length(e.ab.vec3.sub([],this._camera.position,t)),n=this._zoomFromMercatorZ(r)+i;return r-this._mercatorZfromZoom(n)}getCameraPoint(){if("globe"===this.projection.name){const t=function(t,i){let[r,n,o]=t;const s=[r,n,o,1];e.ab.vec4.transformMat4(s,s,i);const a=s[3]=Math.max(s[3],1e-6);return s[0]/=a,s[1]/=a,s[2]/=a,s}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new e.P(t[0],t[1])}{const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.P(0,t))}}getCameraToCenterDistance(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.zoom,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.worldSize;const n=e.b$(t,i,this.width,this.height,1024),o=t.pixelSpaceConversion(this.center.lat,r,n);let s=.5/Math.tan(.5*this._fov)*this.height*o;return this.isOrthographic&&(s=Ki(1,s,Ji(this.pitch>=15?1:this.pitch/15))),s}getWorldToCameraMatrix(){const t=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&e.ab.mat4.multiply(t,t,this.globeMatrix),t}getFrustum(t){return e.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,t,"meters"===this.projection.zAxisUnit)}}const er=(t,i)=>{if(i>0&&t.terrain&&e.w("Cutoff is currently disabled on terrain"),i<=0||t.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const r=t.transform,n=Math.max(Math.abs(r._zoom-(t.minCutoffZoom-1)),1),o=r.isLODDisabled(!1)?e.ac(60,45,r.pitch):e.ac(30,15,r.pitch),s=r._farZ-r._nearZ,a=i*r.height,l=((1-(c=o))*r.cameraToCenterDistance+c*(r._farZ+a))*n;var c;return{shouldRenderCutoff:o<1,uniformValues:{u_cutoff_params:[r._nearZ,r._farZ,(l-r._nearZ)/s,(l-a-r._nearZ)/s]}}},tr={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class ir{constructor(e,t){this.aabb=e,this.lastCascade=t}}class rr{add(e,t){const i=this.receivers[e.key];void 0!==i?(i.aabb.min[0]=Math.min(i.aabb.min[0],t.min[0]),i.aabb.min[1]=Math.min(i.aabb.min[1],t.min[1]),i.aabb.min[2]=Math.min(i.aabb.min[2],t.min[2]),i.aabb.max[0]=Math.max(i.aabb.max[0],t.max[0]),i.aabb.max[1]=Math.max(i.aabb.max[1],t.max[1]),i.aabb.max[2]=Math.max(i.aabb.max[2],t.max[2])):this.receivers[e.key]=new ir(t,null)}clear(){this.receivers={}}get(e){return this.receivers[e.key]}computeRequiredCascades(t,i,r){const n=e.cd.fromPoints(t.points);let o=0;for(const s in this.receivers){const t=this.receivers[s];if(!t)continue;if(!n.intersectsAabb(t.aabb))continue;t.aabb.min=n.closestPoint(t.aabb.min),t.aabb.max=n.closestPoint(t.aabb.max);const a=t.aabb.getCorners();for(let n=0;n<r.length;n++){let s=!0;for(const t of a){const o=[t[0]*i,t[1]*i,t[2]];if(e.ab.vec3.transformMat4(o,o,r[n].matrix),o[0]<-1||o[0]>1||o[1]<-1||o[1]>1){s=!1;break}}if(t.lastCascade=n,o=Math.max(o,n),s)break}}return o+1}}class nr{constructor(e){this.painter=e,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new rr,this._depthMode=new Bi(e.context.gl.LEQUAL,Bi.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,e.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},(()=>{this.painter.style.map.triggerRepaint()})),e.tp.registerParameter(tr,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),e.tp.registerParameter(tr,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),e.tp.registerParameter(tr,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),e.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const e of this._cascades)e.texture.destroy(),e.framebuffer.destroy();this._cascades=[]}updateShadowParameters(t,i){const r=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!i||!i.properties)return;const n=i.properties.get("shadow-intensity");if(!i.shadowsEnabled()||n<=0)return;if(this._shadowLayerCount=r.style.order.reduce(((e,i)=>{const n=r.style._mergedLayers[i];return e+(n.hasShadowPass()&&!n.isHidden(t.zoom)?1:0)}),0),this._enabled=this._shadowLayerCount>0,!this.enabled)return;const o=r.context,s=tr.shadowMapResolution,a=tr.shadowMapResolution;if(0===this._cascades.length||tr.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let t=0;t<tr.cascadeCount;++t){const t=r._shadowMapDebug,i=o.gl,n=o.createFramebuffer(s,a,t,"texture"),l=new e.T(o,{width:s,height:a,data:null},i.DEPTH_COMPONENT16);if(n.depthAttachment.set(l.texture),t){const t=new e.T(o,{width:s,height:a,data:null},i.RGBA8);n.colorAttachment.set(t.texture)}this._cascades.push({framebuffer:n,texture:l,matrix:[],far:0,boundingSphereRadius:0,frustum:new e.bR,scale:0})}}this.shadowDirection=sr(i);let l=0;if(t.elevation){const e=t.elevation,i=[1e4,-1e4];e.visibleDemTiles.filter((e=>e.dem)).forEach((e=>{const t=e.dem.tree;i[0]=Math.min(i[0],t.minimums[0]),i[1]=Math.max(i[1],t.maximums[0])})),1e4!==i[0]&&(l=(i[1]-i[0])*e.exaggeration())}const c=1.5*t.cameraToCenterDistance,u=3*c,h=new Float64Array(16);for(let f=0;f<this._cascades.length;++f){const i=this._cascades[f];let r=t.height/50,n=1;1===tr.cascadeCount?n=u:0===f?n=c:(r=c,n=u);const[o,s]=lr(t,this.shadowDirection,r,n,tr.shadowMapResolution,l);i.scale=t.scale,i.matrix=o,i.boundingSphereRadius=s,e.ab.mat4.invert(h,i.matrix),i.frustum=e.bR.fromInvProjectionMatrix(h,1,0,!0),i.far=n}const d=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[d].far,this._cascades[d].far],this._uniformValues.u_shadow_intensity=n,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/tr.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=tr.shadowMapResolution,this._uniformValues.u_shadowmap_0=Yi.ShadowMap0,this._uniformValues.u_shadowmap_1=Yi.ShadowMap0+1,this._groundShadowTiles=r.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const p=r.transform.elevation;for(const e of this._groundShadowTiles){let t={min:0,max:0};if(p){const i=p.getMinMaxForTile(e);i&&(t=i)}this.addShadowReceiver(e.toUnwrapped(),t.min,t.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(e){this._enabled=e}drawShadowPass(t,i){if(!this.enabled)return;const r=this.painter,n=r.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(r.transform.getFrustum(0),r.transform.worldSize,this._cascades),n.viewport.set([0,0,tr.shadowMapResolution,tr.shadowMapResolution]);for(let o=0;o<this._numCascadesToRender;++o){r.currentShadowCascade=o,n.bindFramebuffer.set(this._cascades[o].framebuffer.framebuffer),n.clear({color:e.aj.white,depth:1});for(const e of t.order){const n=t._mergedLayers[e];if(!n.hasShadowPass()||n.isHidden(r.transform.zoom))continue;const o=t.getLayerSourceCache(n),s=o?i[o.id]:void 0;("model"===n.type||s&&s.length)&&r.renderLayer(r,o,n,s)}}r.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const e=this.painter,t=e.style,i=e.context,r=t.directionalLight,n=t.ambientLight;if(!r||!n)return;const o=[],s=er(e,e.longestCutoffRange);s.shouldRenderCutoff&&o.push("RENDER_CUTOFF"),o.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&o.push("NORMAL_OFFSET");const a=ar(t,r,n),l=new Bi(i.gl.LEQUAL,Bi.ReadOnly,e.depthRangeFor3D);for(const c of this._groundShadowTiles){const t=c.toUnwrapped(),r=e.isTileAffectedByFog(c),n=e.getOrCreateProgram("groundShadow",{defines:o,overrideFog:r});this.setupShadows(t,n),e.uploadCommonUniforms(i,n,t,null,s);const u={u_matrix:e.transform.calculateProjMatrix(t),u_ground_shadow_factor:a};n.draw(e,i.gl.TRIANGLES,l,ji.disabled,Fi.multiply,Gi.disabled,u,"ground_shadow",e.tileExtentBuffer,e.quadTriangleIndexBuffer,e.tileExtentSegments,{},e.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Fi.unblended:Fi.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(t){const i=this.painter.transform,r=i.calculatePosMatrix(t,i.worldSize);return e.ab.mat4.multiply(r,this._cascades[this.painter.currentShadowCascade].matrix,r),Float32Array.from(r)}calculateShadowPassMatrixFromMatrix(t){return e.ab.mat4.multiply(t,this._cascades[this.painter.currentShadowCascade].matrix,t),Float32Array.from(t)}setupShadows(t,i,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!this.enabled)return;const o=this.painter.transform,s=this.painter.context,a=s.gl,l=this._uniformValues,c=new Float64Array(16),u=o.calculatePosMatrix(t,o.worldSize);for(let h=0;h<this._cascades.length;h++)e.ab.mat4.multiply(c,this._cascades[h].matrix,u),l[0===h?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(c),s.activeTexture.set(a.TEXTURE0+Yi.ShadowMap0+h),this._cascades[h].texture.bind(a.NEAREST,a.CLAMP_TO_EDGE);if(this.useNormalOffset=!!r,this.useNormalOffset){const i=e.cc(t.canonical),s=2/o.tileSize*e.ag/tr.shadowMapResolution,a=s*this._cascades[0].boundingSphereRadius,c=s*this._cascades[this._cascades.length-1].boundingSphereRadius,u=("vector-tile"===r?1:3)/Math.pow(2,n-t.canonical.z-(1-o.zoom+Math.floor(o.zoom)));l.u_shadow_normal_offset=[i,a*u,c*u],l.u_shadow_bias=[6e-5,.0012,.012]}else l.u_shadow_bias=[36e-5,.0012,.012];i.setShadowUniformValues(s,l)}setupShadowsFromMatrix(t,i){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.enabled)return;const n=this.painter.context,o=n.gl,s=this._uniformValues,a=new Float64Array(16);for(let l=0;l<tr.cascadeCount;l++)e.ab.mat4.multiply(a,this._cascades[l].matrix,t),s[0===l?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(a),n.activeTexture.set(o.TEXTURE0+Yi.ShadowMap0+l),this._cascades[l].texture.bind(o.NEAREST,o.CLAMP_TO_EDGE);if(this.useNormalOffset=r,r){const e=tr.normalOffset;s.u_shadow_normal_offset=[1,e,e],s.u_shadow_bias=[6e-5,.0012,.012]}else s.u_shadow_bias=[36e-5,.0012,.012];i.setShadowUniformValues(n,s)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(t,i,r,n){if(n[2]>=0)return{};const o=function(t,i,r){const n=r/(1<<t.canonical.z);return new e.cd([t.canonical.x*n+t.wrap*r,t.canonical.y*n+t.wrap*r,0],[(t.canonical.x+1)*n+t.wrap*r,(t.canonical.y+1)*n+t.wrap*r,i])}(t,i,r).getCorners(),s=i/-n[2];n[0]<0?(e.ab.vec3.add(o[0],o[0],[n[0]*s,0,0]),e.ab.vec3.add(o[3],o[3],[n[0]*s,0,0])):n[0]>0&&(e.ab.vec3.add(o[1],o[1],[n[0]*s,0,0]),e.ab.vec3.add(o[2],o[2],[n[0]*s,0,0])),n[1]<0?(e.ab.vec3.add(o[0],o[0],[0,n[1]*s,0]),e.ab.vec3.add(o[1],o[1],[0,n[1]*s,0])):n[1]>0&&(e.ab.vec3.add(o[2],o[2],[0,n[1]*s,0]),e.ab.vec3.add(o[3],o[3],[0,n[1]*s,0]));const a={};return a.vertices=o,a.planes=[or(o[1],o[0],o[4]),or(o[2],o[1],o[5]),or(o[3],o[2],o[6]),or(o[0],o[3],o[7])],a}addShadowReceiver(t,i,r){this._receivers.add(t,e.cd.fromTileIdAndHeight(t,i,r))}getMaxCascadeForTile(e){const t=this._receivers.get(e);return t&&t.lastCascade?t.lastCascade:0}}function or(t,i,r){const n=e.ab.vec3.sub([],r,i),o=e.ab.vec3.sub([],t,i),s=e.ab.vec3.cross([],n,o),a=e.ab.vec3.length(s);return 0===a?[0,0,1,0]:(e.ab.vec3.scale(s,s,1/a),[s[0],s[1],s[2],-e.ab.vec3.dot(s,i)])}function sr(t){const i=t.properties.get("direction"),r=e.cb(i.x,i.y,i.z);r[2]=e.aw(r[2],0,75);const n=e.ce([r[0],r[1],r[2]]);return e.ab.vec3.fromValues(n.x,n.y,n.z)}function ar(t,i,r){const n="none"===i.properties.get("color-use-theme"),o=i.properties.get("color"),s=i.properties.get("intensity"),a=i.properties.get("direction"),l=[a.x,a.y,a.z],c="none"===r.properties.get("color-use-theme"),u=r.properties.get("color"),h=r.properties.get("intensity"),d=Math.max(e.ab.vec3.dot([0,0,1],l),0),p=[0,0,0];e.ab.vec3.scale(p,u.toRenderColor(c?null:t.getLut(i.scope)).toArray01Linear().slice(0,3),h);const f=[0,0,0];return e.ab.vec3.scale(f,o.toRenderColor(n?null:t.getLut(r.scope)).toArray01Linear().slice(0,3),d*s),e.cf([p[0]>0?p[0]/(p[0]+f[0]):0,p[1]>0?p[1]/(p[1]+f[1]):0,p[2]>0?p[2]/(p[2]+f[2]):0])}function lr(t,i,r,n,o,s){const a=t.zoom,l=t.scale,c=t.worldSize,u=1/c,h=t.aspect,d=Math.sqrt(1+h*h)*Math.tan(.5*t.fovX),p=d*d,f=n-r,m=n+r;let g,y;p>f/m?(g=n,y=n*d):(g=.5*m*(1+p),y=.5*Math.sqrt(f*f+2*(n*n+r*r)*p+m*m*p*p));const _=t.projection.pixelsPerMeter(t.center.lat,c),v=t._camera.getCameraToWorldMercator(),x=[0,0,-g*u];e.ab.vec3.transformMat4(x,x,v);let b=y*u;const w=t._edgeInsets;if(!(0===w.left&&0===w.top&&0===w.right&&0===w.bottom||w.left===w.right&&w.top===w.bottom)){const i=t._camera.getWorldToCamera(t.worldSize,"meters"===t.projection.zAxisUnit?_:1),o=t._camera.getCameraToClipPerspective(t._fov,t.width/t.height,r,n);o[8]=2*-t.centerOffset.x/t.width,o[9]=2*t.centerOffset.y/t.height;const s=new Float64Array(16);e.ab.mat4.mul(s,o,i);const u=new Float64Array(16);e.ab.mat4.invert(u,s);const h=e.bR.fromInvProjectionMatrix(u,c,a,!0);for(const r of h.points){const i=((S=r)[0]/=l,S[1]/=l,S[2]=e.bH(S[2],t._center.lat),S);b=Math.max(b,e.ab.vec3.len(e.ab.vec3.subtract([],x,i)))}}var S;b*=o/(o-1);const T=Math.acos(i[2]),M=Math.atan2(-i[0],-i[1]),A=new Xi;A.position=x,A.setPitchBearing(T,M);const C=A.getWorldToCamera(c,_),E=b*c,P=Math.min(t._mercatorZfromZoom(17)*c*-2,-2*E),k=A.getCameraToClipOrthographic(-E,E,-E,E,P,(E+s*_)/i[2]),I=new Float64Array(16);e.ab.mat4.multiply(I,k,C);const D=e.ab.vec3.fromValues(Math.floor(1e6*x[0])/1e6*c,Math.floor(1e6*x[1])/1e6*c,0),L=.5*o,R=[0,0,0];e.ab.vec3.transformMat4(R,D,I),e.ab.vec3.scale(R,R,L);const z=[Math.floor(R[0]),Math.floor(R[1]),Math.floor(R[2])],O=[0,0,0];e.ab.vec3.sub(O,R,z),e.ab.vec3.scale(O,O,-1/L);const F=new Float64Array(16);return e.ab.mat4.identity(F),e.ab.mat4.translate(F,F,O),e.ab.mat4.multiply(I,F,I),[I,E]}class cr extends e.E{constructor(e){super(),this.requestManager=e,this.models={"":{}},this.modelUris={"":{}},this.numModelsLoading={}}loadModel(t,i){return e.aM(this.requestManager.transformRequest(i,e.R.Model).url).then((i=>{if(!i)return;const r=e.aN(i),n=new e.aO(t,void 0,void 0,r);return n.computeBoundsAndApplyParent(),n})).catch((r=>{if(r&&404===r.status)return null;this.fire(new e.y(new Error(`Could not load model ${t} from ${i}: ${r.message}`)))}))}load(t,i){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{keepNumReferences:!1};this.models[i]||(this.models[i]={});const n=Object.keys(t);this.numModelsLoading[i]=(this.numModelsLoading[i]||0)+n.length;const o=[];for(const e of n)o.push(this.loadModel(e,t[e]));Promise.allSettled(o).then((t=>{for(let e=0;e<t.length;e++){const{status:o,value:s}=t[e];if("fulfilled"===o&&s){const t=this.models[i][n[e]];this.models[i][n[e]]={model:s,numReferences:r.keepNumReferences&&t?t.numReferences:1}}}this.numModelsLoading[i]-=n.length,this.fire(new e.z("data",{dataType:"style"}))})).catch((t=>{this.fire(new e.y(new Error(`Could not load models: ${t.message}`)))}))}isLoaded(){for(const e in this.numModelsLoading)if(this.numModelsLoading[e]>0)return!1;return!0}hasModel(e,t){return!!this.getModel(e,t)}getModel(e,t){return this.models[t]||(this.models[t]={}),this.models[t][e]?this.models[t][e].model:void 0}addModel(e,t,i){this.models[i]||(this.models[i]={}),this.modelUris[i]||(this.modelUris[i]={}),this.hasModel(e,i)&&this.models[i][e].numReferences++,this.modelUris[i][e]=this.requestManager.normalizeModelURL(t),this.load({[e]:this.modelUris[i][e]},i)}addModels(e,t){this.models[t]||(this.models[t]={}),this.modelUris[t]||(this.modelUris[t]={});const i=this.modelUris[t];for(const r in e)this.models[t][r]={},i[r]=this.requestManager.normalizeModelURL(e[r]);this.load(i,t,{keepNumReferences:!0})}reloadModels(e){this.load(this.modelUris[e],e)}addModelsFromBucket(e,t){this.models[t]||(this.models[t]={}),this.modelUris[t]||(this.modelUris[t]={});const i={};for(const r of e)this.hasModel(r,t)?this.models[t][r].numReferences++:(this.modelUris[t][r]=this.requestManager.normalizeModelURL(r),i[r]=this.modelUris[t][r]);this.load(i,t)}removeModel(e,t){if(this.models[t]&&this.models[t][e]&&(this.models[t][e].numReferences--,0===this.models[t][e].numReferences)){const i=this.models[t][e].model;delete this.models[t][e],delete this.modelUris[t][e],i.destroy()}}listModels(e){return this.models[e]||(this.models[e]={}),Object.keys(this.models[e])}upload(e,t){this.models[t]||(this.models[t]={});for(const i in this.models[t])this.models[t][i].model&&this.models[t][i].model.upload(e.context)}}const ur=new e.a5({data:new e.a6(e.a3.colorTheme.data)}),hr={"mbx-indoor-active-floorplans":{default:["literal",[]]},"mbx-indoor-underground":{default:["literal",!1]},"mbx-indoor-loaded-levels":{default:["literal",[]]},"mbx-indoor-level-height":{default:["literal",{}]},"mbx-indoor-level-base":{default:["literal",{}]},"mbx-indoor-level-selected":{default:["literal",{}]},"mbx-indoor-level-overlapped":{default:["literal",{}]}};function dr(e){return e=e||{},Object.assign(e,hr)}class pr extends e.E{constructor(t){super(),this.mergeFloors=!0,this._scope=void 0,this._queryFeatureSetId=void 0,this._buildingEntryFeatureSetId=void 0,this._selectedFloorplan=void 0,this._indoorData=void 0,this._selectedLevel=void 0,this._floorplanStates={},e.aP(["_onLoad","_onMove","_checkFloorplanVisible"],this),this._map=t,this._checkFloorplanVisible(!0),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=void 0}_onLoad(){this._map.style.forEachFragmentStyle((t=>{t.stylesheet.indoor&&(this._queryFeatureSetId?this.fire(new e.y(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._queryFeatureSetId=t.stylesheet.indoor.floorplanFeaturesetId,this._buildingEntryFeatureSetId=t.stylesheet.indoor.buildingFeaturesetId,this._scope=t.scope))})),this._queryFeatureSetId&&this._buildingEntryFeatureSetId&&this._map.addInteraction("mbx-indoor-buildingclick",{type:"click",target:{featuresetId:this._buildingEntryFeatureSetId,importId:this._scope},handler:e=>(e.feature&&e.feature.properties.floorplan&&this.selectFloorplan(e.feature.properties.floorplan),!0)}),this._checkFloorplanVisible(!0)}_onMove(){this._checkFloorplanVisible(!1)}_checkFloorplanVisible(t){if(!this._queryFeatureSetId)return;if(!this._map.isStyleLoaded())return;if(this._map.transform.zoom<13)return;this._indoorData&&!function(e,t){const[i,r]=e,{center:n,radius:o}=t,[s,a]=n,l=Math.abs(i-s);return Math.sqrt((l>180?360-l:l)**2+(r-a)**2)<=o}([this._map.getCenter().lng,this._map.getCenter().lat],this._indoorData.circumCircle)&&(this._indoorData=void 0,this._selectedFloorplan=void 0,this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[]]),this.fire(new e.z("floorplangone")));const i={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},r=new e.P(this._map.transform.width/2,this._map.transform.height/2),n=[new e.P(0,0),new e.P(this._map.transform.width,this._map.transform.height)],o=this._map.queryRenderedFeatures(t?n:r,i);o.length>0&&(this._selectedFloorplan&&o[0].properties.id===this._selectedFloorplan.properties.id||(this._selectedFloorplan=o[0],this._floorplanSelected(!1)))}_floorplanSelected(t){this._indoorData=JSON.parse(this._selectedFloorplan.properties["indoor-data"]),this._indoorData.id=this._selectedFloorplan.properties.id,this._indoorData.circumCircle=function(e){const[[t,i],[r,n]]=e,o=(r-t+360)%360,s=o>180?360-o:o;return{center:[(t+s/2+360)%360,(i+n)/2],radius:Math.sqrt(s**2+(n-i)**2)/2}}(this._indoorData.extent),this._floorplanStates[this._indoorData.id]||(this._floorplanStates[this._indoorData.id]={});const i=this._floorplanStates[this._indoorData.id].selectedBuilding,r=this._floorplanStates[this._indoorData.id].selectedLevel;let n;if(this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",this._indoorData.floorplanIDs),this._selectedLevel)for(const e of this._indoorData.levels)e.id===this._selectedLevel.id&&(n=e.id);if(this.fire(new e.z("floorplanselected",{buildings:this._indoorData.buildings,levels:this._indoorData.levels,selectedLevelId:n})),i){const e=this._indoorData.buildings.find((e=>e.id===i));this._buildingSelected(e,!1)}else this._indoorData.buildings.length>0&&this._buildingSelected(this._indoorData.buildings[0],!1);if(r){const e=this._indoorData.levels.find((e=>e.id===r));this._updateLevels(e,t)}else t&&this._indoorData["default-levels"].length>0&&this.selectLevel(this._indoorData["default-levels"][0])}_buildingSelected(t,i){i&&t&&t.extent&&this._map.fitBounds(t.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),this._floorplanStates[this._indoorData.id].selectedBuilding=t?t.id:void 0;const r=this._indoorData.levels.filter((e=>t.levels.includes(e.id)));this.fire(new e.z("buildingselected",{buildingId:t.id,levels:r}))}_levelSelected(t){if("overview"===t)this._updateLevels(void 0,!0);else{const e=this._indoorData.levels.find((e=>e.id===t));this._updateLevels(e,!0)}this.fire(new e.z("levelselected",{levelId:"overview"===t?void 0:t}))}_updateLevels(e,t){if(!e)return this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",[]]),this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._floorplanStates[this._indoorData.id].selectedLevel=void 0,void(t&&this._indoorData.extent&&this._map.fitBounds(this._indoorData.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}));function i(e){const t=e.indexOf("/floor/");if(-1===t)return e;const i=t+7,r=e.indexOf("/",i);return-1===r?e.slice(i):e.slice(i,r)}this._selectedLevel=e,this._floorplanStates[this._indoorData.id].selectedLevel=e?e.id:void 0;const r=[],n={},o={},s={},a={};for(const l of this._indoorData.levels)if(r.push(l.id),n[l.id]=l.height,o[l.id]=l.base,e){if(this.mergeFloors){const t=i(e.id),r=i(l.id);s[l.id]=r===t?"true":"false"}else s[l.id]=l.id===e.id?"true":"false";a[l.id]=l.base<e.base?"true":"false"}else a[l.id]=!0;if(this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",r]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-height",["literal",n]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-base",["literal",o]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",s]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-overlapped",["literal",a]),e&&(this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!!e.isUnderground),t&&e.extent)){const t=this._map.cameraForBounds(e.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),i=this._map.getZoom(),r=t.zoom?Math.abs(i-t.zoom):0;this._map.fitBounds(e.extent,r>=1?{pitch:this._map.getPitch(),bearing:this._map.getBearing()}:{pitch:this._map.getPitch(),bearing:this._map.getBearing(),zoom:i})}}selectFloorplan(t){const i={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},r=[new e.P(0,0),new e.P(this._map.transform.width,this._map.transform.height)],n=this._map.queryRenderedFeatures(r,i);if(n.length>0)for(const e of n)if(JSON.parse(e.properties["indoor-data"]).floorplanIDs.includes(t)){this._selectedFloorplan=e,this._floorplanSelected(!0);break}}selectBuilding(e){const t=this._indoorData.buildings.find((t=>t.id===e));this._buildingSelected(t,!0)}selectLevel(e){this._levelSelected(e)}}function fr(t){if(!t.metadata||!t.metadata.content_area)return;const i=e.q.devicePixelRatio,{left:r,top:n,width:o,height:s}=t.metadata.content_area,a=r*i,l=n*i;return[a,l,a+o*i,l+s*i]}function mr(t){if(t)return t.map((t=>{let[i,r]=t;return[i*e.q.devicePixelRatio,r*e.q.devicePixelRatio]}))}const gr=(e,t)=>ke(e,t&&t.filter((e=>"source.canvas"!==e.identifier))),yr=e.ay(Dt,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport"]),_r=e.ay(Dt,["setCenter","setZoom","setBearing","setPitch"]),vr=new Set(["background","sky","slot","custom"]),xr={version:8,layers:[],sources:{}},br={duration:300,delay:0};class wr extends e.E{constructor(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.map=t,this.scope=i.scope||"",this.globalId=null,this.fragments=[],this.importDepth=i.importDepth||0,this.importsCache=i.importsCache||new Map,this.resolvedImports=i.resolvedImports||new Set,this.transition=e.l({},br),this._buildingIndex=new Pt(this),this.crossTileSymbolIndex=new zi,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=i.styleChanges||new U,this.dispatcher=i.dispatcher?i.dispatcher:new e.D(e.ci(),this),i.imageManager?this.imageManager=i.imageManager:(this.imageManager=new H(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=i.glyphManager?i.glyphManager:new e.cj(t._requestManager,i.localFontFamily?e.ck.all:i.localIdeographFontFamily?e.ck.ideographs:e.ck.none,i.localFontFamily||i.localIdeographFontFamily),i.modelManager?this.modelManager=i.modelManager:(this.modelManager=new cr(t._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=i.configOptions?i.configOptions:new Map,this._configDependentLayers=i.configDependentLayers?i.configDependentLayers:new Set,this._config=i.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:i.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=i.initialConfig,this.dispatcher.broadcast("setReferrer",e.cl());const r=this;this._rtlTextPluginCallback=wr.registerForPluginStateChange((t=>{r.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:t.pluginStatus,pluginURL:t.pluginURL},((t,i)=>{if(e.cm(t),i&&i.every((e=>e)))for(const e in r._sourceCaches){const t=r._sourceCaches[e],i=t.getSource().type;"vector"!==i&&"geojson"!==i||t.reload()}}))})),this.on("data",(e=>{if("source"!==e.dataType||"metadata"!==e.sourceDataType)return;const t=this.getOwnSource(e.sourceId);if(t&&t.vectorLayerIds)for(const i in this._layers){const e=this._layers[i];e.source===t.id&&this._validateLayer(e)}}))}load(e){return e?("string"==typeof e?this.loadURL(e):this.loadJSON(e),this):this}_getGlobalId(t){if(!t)return null;if("string"==typeof t){if(e.f(t))return t;const i=e.cn(t);if(!i.startsWith("http"))try{return new URL(i,location.href).toString()}catch(e){return i}return i}return`json://${e.co(JSON.stringify(t))}`}_diffStyle(t,i,r){this.globalId=this._getGlobalId(t);const n=(e,t)=>{try{t(null,this.setState(e,r))}catch(e){t(e,!1)}};if("string"==typeof t){const r=this.map._requestManager.normalizeStyleURL(t),o=this.map._requestManager.transformRequest(r,e.R.Style);e.n(o,((t,r)=>{t?this.fire(new e.y(t)):r&&n(r,i)}))}else"object"==typeof t&&n(t,i)}loadURL(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.fire(new e.z("dataloading",{dataType:"style"}));const r="boolean"==typeof i.validate?i.validate:!e.f(t);this.globalId=this._getGlobalId(t),t=this.map._requestManager.normalizeStyleURL(t,i.accessToken),this.resolvedImports.add(t);const n=this.importsCache.get(t);if(n)return this._load(n,r);const o=this.map._requestManager.transformRequest(t,e.R.Style);this._request=e.n(o,((i,n)=>{if(this._request=null,i)this.fire(new e.y(i));else if(n)return this.importsCache.set(t,n),this._load(n,r)}))}loadJSON(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.fire(new e.z("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(t),this._request=e.q.frame((()=>{this._request=null,this._load(t,!1!==i.validate)}))}loadEmpty(){this.fire(new e.z("dataloading",{dataType:"style"})),this._load(xr,!1)}_loadImports(t,i,r){if(this.importDepth>=4)return e.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const n=[];for(const e of t){const t=this._createFragmentStyle(e),o=new Promise((e=>{t.once("style.import.load",e),t.once("error",e)})).then((()=>this.mergeAll()));if(n.push(o),this.resolvedImports.has(e.url)){t.loadEmpty();continue}const s=e.data||this.importsCache.get(e.url);s?(t.loadJSON(s,{validate:i}),this._isInternalStyle(s)&&(t.globalId=null)):e.url?t.loadURL(e.url,{validate:i}):t.loadEmpty();const a={style:t,id:e.id,config:e.config};if(r){const e=this.fragments.findIndex((e=>{let{id:t}=e;return t===r}));this.fragments=this.fragments.slice(0,e).concat(a).concat(this.fragments.slice(e))}else this.fragments.push(a)}return Promise.allSettled(n)}getImportGlobalIds(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Set;for(const i of e.fragments)i.style.globalId&&t.add(i.style.globalId),this.getImportGlobalIds(i.style,t);return[...t.values()]}_createFragmentStyle(t){const i=this.scope?e.aC(t.id,this.scope):t.id;let r;const n=this._initialConfig&&this._initialConfig[i];(t.config||n)&&(r=e.l({},t.config,n));const o=new wr(this.map,{scope:i,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:r,configOptions:this.options,colorThemeOverride:t["color-theme"],configDependentLayers:this._configDependentLayers});return o.setEventedParent(this.map,{style:o}),o}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(e){return this.isRootStyle()&&(e.fragment||!!e.schema&&!1!==e.fragment)}_load(t,i){const r=t.indoor?dr(t.schema):t.schema;if(this._isInternalStyle(t)){const r=e.l({},xr,{imports:[{id:"basemap",data:t,url:""}]});return void this._load(r,i)}if(this.updateConfig(this._config,r),i&&gr(this,ge(t)))return;this._loaded=!0,this.stylesheet=e.cp(t);const n=()=>{for(const e in t.sources)this.addSource(e,t.sources[e],{validate:!1,isInitialLoad:!0});t.sprite?this._loadIconset(t.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(t.glyphs,this.scope);const r=It(this.stylesheet.layers);if(this._order=r.map((e=>e.id)),this.stylesheet.light&&e.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(1===this.stylesheet.lights.length&&"flat"===this.stylesheet.lights[0].type){const e=this.stylesheet.lights[0];this.light=new De(e.properties,e.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new De(this.stylesheet.light)),this._layers={};for(const t of r){const i=e.cu(t,this.scope,this._styleColorTheme.lut,this.options);0!==i.configDependencies.size&&this._configDependentLayers.add(i.fqid),i.setEventedParent(this,{layer:{id:i.id}}),this._layers[i.id]=i;const r=this.getOwnLayerSourceCache(i),n=!!this.directionalLight&&this.directionalLight.shadowsEnabled();r&&i.canCastShadows()&&n&&(r.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const n=this.stylesheet.terrain;n&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(n,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new e.z("data",{dataType:"style"}));const o=this.isRootStyle();t.imports?this._loadImports(t.imports,i).then((()=>{this._reloadImports(),this.fire(new e.z(o?"style.load":"style.import.load"))})):(this._reloadImports(),this.fire(new e.z(o?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const o=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(o){const t=this._evaluateColorThemeData(o);this._loadColorTheme(t).then((()=>{n()})).catch((t=>{e.w(`Couldn't load color theme from the stylesheet: ${t}`),n()}))}else this._styleColorTheme.lut=null,n()}isRootStyle(){return 0===this.importDepth}mergeAll(){let t,i,r,n,o,s,a,l,c,u;const h={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle((e=>{if(e.stylesheet){if(null!=e.light&&(t=e.light),e.stylesheet.lights)for(const t of e.stylesheet.lights)"ambient"===t.type&&null!=e.ambientLight&&(i=e.ambientLight),"directional"===t.type&&null!=e.directionalLight&&(r=e.directionalLight);n=this._prioritizeTerrain(n,e.terrain,e.stylesheet.terrain),e.stylesheet.fog&&null!=e.fog&&(o=e.fog),e.stylesheet.snow&&null!=e.snow&&(s=e.snow),e.stylesheet.rain&&null!=e.rain&&(a=e.rain),null!=e.stylesheet.camera&&(u=e.stylesheet.camera),null!=e.stylesheet.projection&&(l=e.stylesheet.projection),null!=e.stylesheet.transition&&(c=e.stylesheet.transition),h[e.scope]=e._styleColorTheme}})),this.light=t,this.ambientLight=i,this.directionalLight=r,this.fog=o,this.snow=s,this.rain=a,this._styleColorThemeForScope=h,null===n?delete this.terrain:this.terrain=n,this.camera=u||{"camera-projection":"perspective"},this.projection=l||{name:"mercator"},this.transition=e.l({},br,c),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(e){const t=i=>{for(const e of i.fragments)t(e.style);e(i)};t(this)}_prioritizeTerrain(e,t,i){const r=e&&0===e.drapeRenderMode;return null===i?t&&0===t.drapeRenderMode?t:r?e:null:null!=t&&(!e||r||t&&1===t.drapeRenderMode)?t:e}mergeTerrain(){let e;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle((t=>{e=this._prioritizeTerrain(e,t.terrain,t.stylesheet.terrain)})),null===e?delete this.terrain:this.terrain=e}mergeProjection(){let e;this.forEachFragmentStyle((t=>{null!=t.stylesheet.projection&&(e=t.stylesheet.projection)})),this.projection=e||{name:"mercator"}}mergeSources(){const t={},i={},r={};this.forEachFragmentStyle((n=>{for(const i in n._sourceCaches){const r=e.aC(i,n.scope);t[r]=n._sourceCaches[i]}for(const t in n._otherSourceCaches){const r=e.aC(t,n.scope);i[r]=n._otherSourceCaches[t]}for(const t in n._symbolSourceCaches){const i=e.aC(t,n.scope);r[i]=n._symbolSourceCaches[t]}})),this._mergedSourceCaches=t,this._mergedOtherSourceCaches=i,this._mergedSymbolSourceCaches=r}mergeLayers(){var t=this;const i={},r=[],n={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle((t=>{for(const n of t._order){const o=t._layers[n];if("slot"===o.type){const t=e.cq(n);if(i[t])continue;i[t]=[]}o.slot&&i[o.slot]?i[o.slot].push(o):r.push(o)}})),this._mergedOrder=[];const o=function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];for(const s of r)if("slot"===s.type){const r=e.cq(s.id);i[r]&&o(i[r]),t._mergedSlots.push(r)}else{const i=e.aC(s.id,s.scope);t._mergedOrder.push(i),n[i]=s,s.is3D()&&(t._has3DLayers=!0),"circle"===s.type&&(t._hasCircleLayers=!0),"symbol"===s.type&&(t._hasSymbolLayers=!0),"clip"===s.type&&(t._clipLayerPresent=!0)}};o(r),this._mergedOrder.sort(((e,t)=>{const i=n[e],r=n[t];return i.hasInitialOcclusionOpacityProperties?r.is3D()?1:0:i.is3D()&&r.hasInitialOcclusionOpacityProperties?-1:0})),this._mergedLayers=n,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}getCamera(){return this.stylesheet.camera}setCamera(t){return this.stylesheet.camera=e.l({},this.stylesheet.camera,t),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(t){return t.data?function(t,i,r){const n=e.l({},i);for(const s of Object.keys(e.a3.colorTheme))void 0===n[s]&&(n[s]=e.a3.colorTheme[s].default);const o=new e.a4(ur,t,new Map(r));return o.setTransitionOrValue(n,r),o.untransitioned().possiblyEvaluate(new e.a8(0))}(this.scope,t,this.options).get("data"):null}_loadColorTheme(t){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const i=this._styleColorTheme.lutLoadingCorrelationID;return new Promise(((r,n)=>{const o="data:image/png;base64,";if(!t||0===t.length)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void r();let s=t;s.startsWith(o)||(s=o+s);const a="mapbox-reserved-lut",l=new Image;l.src=s,l.onerror=()=>{this._styleColorTheme.lutLoading=!1,n(new Error("Failed to load image data"))},l.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==i)return void r();this._styleColorTheme.lutLoading=!1;const{width:o,height:s,data:c}=e.q.getImageData(l);if(s>32)return void n(new Error("The height of the image must be less than or equal to 32 pixels."));if(o!==s*s)return void n(new Error("The width of the image must be equal to the height squared."));this.getImage(a)&&this.removeImage(a),this.addImage(a,{data:new e.r({width:o,height:s},c),pixelRatio:1,sdf:!1,usvg:!1,version:0});const u=this.imageManager.getImage(a,this.scope);u?(this._styleColorTheme.lut={image:u.data,data:t},r()):n(new Error("Missing LUT image."))}}))}getLut(e){const t=this._styleColorThemeForScope[e];return t?t.lut:null}setProjection(e){e?this.stylesheet.projection=e:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(t){this._spriteRequest=function(t,i,r){let n,o,s;const a=e.q.devicePixelRatio>1?"@2x":"";let l=e.n(i.transformRequest(i.normalizeSpriteURL(t,a,".json"),e.R.SpriteJSON),((e,t)=>{l=null,s||(s=e,n=t,u())})),c=e.o(i.transformRequest(i.normalizeSpriteURL(t,a,".png"),e.R.SpriteImage),((e,t)=>{c=null,s||(s=e,o=t,u())}));function u(){if(s)r(s);else if(n&&o){const t=e.q.getImageData(o),i={};for(const r in n){const{width:o,height:s,x:a,y:l,sdf:c,pixelRatio:u,stretchX:h,stretchY:d,content:p}=n[r],f=new e.r({width:o,height:s});e.r.copy(t,f,{x:a,y:l},{x:0,y:0},{width:o,height:s},null),i[r]={data:f,pixelRatio:u,sdf:c,stretchX:h,stretchY:d,content:p,usvg:!1}}r(null,i)}}return{cancel(){l&&(l.cancel(),l=null),c&&(c.cancel(),c=null)}}}(t,this.map._requestManager,((t,i)=>{if(this._spriteRequest=null,t)this.fire(new e.y(t));else if(i)for(const e in i)this.imageManager.addImage(e,this.scope,i[e]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new e.z("data",{dataType:"style"}))}))}_loadIconset(t){if(!e.f(t)&&"icon_set"!==this.map._spriteFormat||"raster"===this.map._spriteFormat)return void this._loadSprite(t);const i="auto"===this.map._spriteFormat;var r,n;this._spriteRequest=(n=(r,n)=>{if(this._spriteRequest=null,r)i?this._loadSprite(t):this.fire(new e.y(r));else if(n)for(const e in n)this.imageManager.addImage(e,this.scope,n[e]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new e.z("data",{dataType:"style"}))},e.bi((r=this.map._requestManager).transformRequest(r.normalizeIconsetURL(t),e.R.Iconset),((t,i)=>{if(t)return void n(t);const r={},o=e.cg(new e.bh(i));for(const n of o.icons){const t={version:1,pixelRatio:e.q.devicePixelRatio,content:fr(n),stretchX:n.metadata?mr(n.metadata.stretch_x_areas):void 0,stretchY:n.metadata?mr(n.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:n};r[n.name]=t}n(null,r)})))}_validateLayer(t){const i=this.getOwnSource(t.source);if(!i)return;const r=t.sourceLayer;r&&("geojson"===i.type||i.vectorLayerIds&&-1===i.vectorLayerIds.indexOf(r))&&this.fire(new e.y(new Error(`Source layer "${r}" does not exist on source "${i.id}" as specified by style layer "${t.id}"`)))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const e in this._sourceCaches)if(!this._sourceCaches[e].loaded())return!1;if(!this.imageManager.isLoaded())return!1;if(!this.modelManager.isLoaded())return!1;if(this._styleColorTheme.lutLoading)return!1;for(const{style:e}of this.fragments)if(!e.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map(((e,t)=>{const i=this.fragments[t];return i&&i.style&&(e.data=i.style.serialize()),e}))}_serializeSources(){const e={};for(const t in this._sourceCaches){const i=this._sourceCaches[t].getSource();e[i.id]||(e[i.id]=i.serialize())}return e}_serializeLayers(e){const t=[];for(const i of e){const e=this._layers[i];e&&"custom"!==e.type&&t.push(e.serialize())}return t}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions())return!0;if(this.hasFogTransition())return!0;if(this.hasSnowTransition())return!0;if(this.hasRainTransition())return!0;for(const e in this._sourceCaches)if(this._sourceCaches[e].hasTransition())return!0;for(const e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(e){return e?this.order:this._mergedOrder}isLayerDraped(e){return!!this.terrain&&e.isDraped(this.getLayerSourceCache(e))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(t){const i=this.getOwnLayer(t);if(i)return i;this.fire(new e.y(new Error(`The layer '${t}' does not exist in the map's style.`)))}_checkSource(t){const i=this.getOwnSource(t);if(i)return i;this.fire(new e.y(new Error(`The source '${t}' does not exist in the map's style.`)))}precompilePrograms(e,t){const i=this.map.painter;if(i)for(let r=e.minzoom||0;r<(e.maxzoom||25.5);r++){const r=e.getProgramIds();if(r)for(const n of r){const r=e.getDefaultProgramParams(n,t.zoom,this._styleColorTheme.lut);r&&(i.style=this,this.fog&&(i._fogVisible=!0,r.overrideFog=!0,i.getOrCreateProgram(n,r)),i._fogVisible=!1,r.overrideFog=!1,i.getOrCreateProgram(n,r),(this.stylesheet.terrain||this.stylesheet.projection&&"globe"===this.stylesheet.projection.name)&&(r.overrideRtt=!0,i.getOrCreateProgram(n,r)))}}}update(t){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(t),this.directionalLight&&this.directionalLight.recalculate(t);const i=this.calculateLightsBrightness();t.brightness=i||0,i!==this._brightness&&(this._brightness=i,this.dispatcher.broadcast("setBrightness",i));const r=this._changes.isDirty();let n=!1;if(this._changes.isDirty()){const e=this._changes.getLayerUpdatesByScope();for(const t in e){const{updatedIds:i,removedIds:r}=e[t];(i||r)&&(this._updateWorkerLayers(t,i,r),n=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(t),this.light&&this.light.updateTransitions(t),this.ambientLight&&this.ambientLight.updateTransitions(t),this.directionalLight&&this.directionalLight.updateTransitions(t),this.fog&&this.fog.updateTransitions(t),this.snow&&this.snow.updateTransitions(t),this.rain&&this.rain.updateTransitions(t),this._changes.reset()}const o={};for(const e in this._mergedSourceCaches){const t=this._mergedSourceCaches[e];o[e]=t.used,t.used=!1,t.tileCoverLift=0}for(const e of this._mergedOrder){const i=this._mergedLayers[e];if(i.recalculate(t,this._availableImages),!i.isHidden(t.zoom)){const e=this.getLayerSourceCache(i);e&&(e.used=!0,e.tileCoverLift=Math.max(e.tileCoverLift,i.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback((()=>{this.precompilePrograms(i,t)})):this.precompilePrograms(i,t))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&n&&this.mergeLayers();for(const s in o){const t=this._mergedSourceCaches[s];o[s]!==t.used&&t.getSource().fire(new e.z("data",{sourceDataType:"visibility",dataType:"source",sourceId:t.getSource().id}))}this.light&&this.light.recalculate(t),this.terrain&&this.terrain.recalculate(t),this.fog&&this.fog.recalculate(t),this.snow&&this.snow.recalculate(t),this.rain&&this.rain.recalculate(t),this.z=t.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),r&&this.fire(new e.z("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=this._changes.getUpdatedImages();if(e.length){for(const t in this._sourceCaches)this._sourceCaches[t].reloadTilesForDependencies(["icons","patterns"],e);this._changes.resetUpdatedImages()}}_updateWorkerLayers(e,t,i){const r=this.getFragmentStyle(e);r&&this.dispatcher.broadcast("updateLayers",{layers:t?r._serializeLayers(t):[],scope:e,removedIds:i||[],options:r.options})}setState(t,i){if(this._checkLoaded(),gr(this,ge(t)))return!1;(t=e.cp(t)).layers=It(t.layers);const r=function(t,i){if(!t)return[{command:Dt.setStyle,args:[i]}];let r=[];try{if(!e.bn(t.version,i.version))return[{command:Dt.setStyle,args:[i]}];if(e.bn(t.center,i.center)||r.push({command:Dt.setCenter,args:[i.center]}),e.bn(t.zoom,i.zoom)||r.push({command:Dt.setZoom,args:[i.zoom]}),e.bn(t.bearing,i.bearing)||r.push({command:Dt.setBearing,args:[i.bearing]}),e.bn(t.pitch,i.pitch)||r.push({command:Dt.setPitch,args:[i.pitch]}),e.bn(t.sprite,i.sprite)||r.push({command:Dt.setSprite,args:[i.sprite]}),e.bn(t.glyphs,i.glyphs)||r.push({command:Dt.setGlyphs,args:[i.glyphs]}),e.bn(t.imports,i.imports)||function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;i=i||[];const n=(t=t||[]).map(Bt),o=i.map(Bt),s=t.reduce(Nt,{}),a=i.reduce(Nt,{}),l=n.slice();let c,u,h,d;for(c=0,u=0;c<n.length;c++)h=n[c],a.hasOwnProperty(h)?u++:(r.push({command:Dt.removeImport,args:[h]}),l.splice(l.indexOf(h,u),1));for(c=0,u=0;c<o.length;c++)h=o[o.length-1-c],l[l.length-1-c]!==h&&(s.hasOwnProperty(h)?(r.push({command:Dt.removeImport,args:[h]}),l.splice(l.lastIndexOf(h,l.length-u),1)):u++,d=l[l.length-c],r.push({command:Dt.addImport,args:[a[h],d]}),l.splice(l.length-c,0,h));for(const p of i){const t=s[p.id];t&&!e.bn(t,p)&&r.push({command:Dt.updateImport,args:[p.id,p]})}}(t.imports,i.imports,r),e.bn(t.transition,i.transition)||r.push({command:Dt.setTransition,args:[i.transition]}),e.bn(t.light,i.light)||r.push({command:Dt.setLight,args:[i.light]}),e.bn(t.fog,i.fog)||r.push({command:Dt.setFog,args:[i.fog]}),e.bn(t.snow,i.snow)||r.push({command:Dt.setSnow,args:[i.snow]}),e.bn(t.rain,i.rain)||r.push({command:Dt.setRain,args:[i.rain]}),e.bn(t.projection,i.projection)||r.push({command:Dt.setProjection,args:[i.projection]}),e.bn(t.lights,i.lights)||r.push({command:Dt.setLights,args:[i.lights]}),e.bn(t.camera,i.camera)||r.push({command:Dt.setCamera,args:[i.camera]}),!e.bn(t["color-theme"],i["color-theme"]))return[{command:Dt.setStyle,args:[i]}];const n={},o=[];!function(t,i,r,n){let o;for(o in i=i||{},t=t||{})t.hasOwnProperty(o)&&(i.hasOwnProperty(o)||Rt(o,r,n));for(o in i){if(!i.hasOwnProperty(o))continue;const s=i[o];t.hasOwnProperty(o)?e.bn(t[o],s)||("geojson"===t[o].type&&"geojson"===s.type&&Ot(t,i,o)?r.push({command:Dt.setGeoJSONSourceData,args:[o,s.data]}):zt(o,i,r,n)):Lt(o,i,r)}}(t.sources,i.sources,o,n);const s=[];t.layers&&t.layers.forEach((e=>{e.source&&n[e.source]?r.push({command:Dt.removeLayer,args:[e.id]}):s.push(e)}));let a=t.terrain;a&&n[a.source]&&(r.push({command:Dt.setTerrain,args:[void 0]}),a=void 0),r=r.concat(o),e.bn(a,i.terrain)||r.push({command:Dt.setTerrain,args:[i.terrain]}),function(t,i,r){i=i||[];const n=(t=t||[]).map(Bt),o=i.map(Bt),s=t.reduce(Nt,{}),a=i.reduce(Nt,{}),l=n.slice(),c=Object.create(null);let u,h,d,p,f,m,g;for(u=0,h=0;u<n.length;u++)d=n[u],a.hasOwnProperty(d)?h++:(r.push({command:Dt.removeLayer,args:[d]}),l.splice(l.indexOf(d,h),1));for(u=0,h=0;u<o.length;u++)d=o[o.length-1-u],l[l.length-1-u]!==d&&(s.hasOwnProperty(d)?(r.push({command:Dt.removeLayer,args:[d]}),l.splice(l.lastIndexOf(d,l.length-h),1)):h++,m=l[l.length-u],r.push({command:Dt.addLayer,args:[a[d],m]}),l.splice(l.length-u,0,d),c[d]=!0);for(u=0;u<o.length;u++)if(d=o[u],p=s[d],f=a[d],!c[d]&&!e.bn(p,f))if(e.bn(p.source,f.source)&&e.bn(p["source-layer"],f["source-layer"])&&e.bn(p.type,f.type)){for(g in Ft(p.layout,f.layout,r,d,null,Dt.setLayoutProperty),Ft(p.paint,f.paint,r,d,null,Dt.setPaintProperty),e.bn(p.slot,f.slot)||r.push({command:Dt.setSlot,args:[d,f.slot]}),e.bn(p.filter,f.filter)||r.push({command:Dt.setFilter,args:[d,f.filter]}),e.bn(p.minzoom,f.minzoom)&&e.bn(p.maxzoom,f.maxzoom)||r.push({command:Dt.setLayerZoomRange,args:[d,f.minzoom,f.maxzoom]}),p)p.hasOwnProperty(g)&&"layout"!==g&&"paint"!==g&&"filter"!==g&&"metadata"!==g&&"minzoom"!==g&&"maxzoom"!==g&&"slot"!==g&&(0===g.indexOf("paint.")?Ft(p[g],f[g],r,d,g.slice(6),Dt.setPaintProperty):e.bn(p[g],f[g])||r.push({command:Dt.setLayerProperty,args:[d,g,f[g]]}));for(g in f)f.hasOwnProperty(g)&&!p.hasOwnProperty(g)&&"layout"!==g&&"paint"!==g&&"filter"!==g&&"metadata"!==g&&"minzoom"!==g&&"maxzoom"!==g&&"slot"!==g&&(0===g.indexOf("paint.")?Ft(p[g],f[g],r,d,g.slice(6),Dt.setPaintProperty):e.bn(p[g],f[g])||r.push({command:Dt.setLayerProperty,args:[d,g,f[g]]}))}else r.push({command:Dt.removeLayer,args:[d]}),m=l[l.lastIndexOf(d)+1],r.push({command:Dt.addLayer,args:[f,m]})}(s,i.layers,r)}catch(e){console.warn("Unable to compute style diff:",e),r=[{command:Dt.setStyle,args:[i]}]}return r}(this.serialize(),t).filter((e=>!(e.command in _r)));if(0===r.length)return!1;const n=r.filter((e=>!(e.command in yr)));if(n.length>0)throw new Error(`Unimplemented: ${n.map((e=>e.command)).join(", ")}.`);const o=[];return r.forEach((e=>{o.push(this[e.command].apply(this,e.args))})),i&&Promise.all(o).then(i),this.stylesheet=t,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(t,i){return this.getImage(t)?this.fire(new e.y(new Error("An image with this name already exists."))):(this.imageManager.addImage(t,this.scope,i),this._afterImageUpdated(t),this)}updateImage(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.imageManager.updateImage(e,this.scope,t),i&&this._afterImageUpdated(e)}getImage(e){return this.imageManager.getImage(e,this.scope)}removeImage(t){return this.getImage(t)?(this.imageManager.removeImage(t,this.scope),this._afterImageUpdated(t),this):this.fire(new e.y(new Error("No image with this name exists.")))}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(t),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new e.z("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._checkLoaded(),this._validate(Ee,`models.${e}`,t,null,i)||(this.modelManager.addModel(e,t,this.scope),this._changes.setDirty()),this}hasModel(e){return this.modelManager.hasModel(e,this.scope)}removeModel(t){return this.hasModel(t)?(this.modelManager.removeModel(t,this.scope),this):this.fire(new e.y(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(t,i){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._checkLoaded(),void 0!==this.getOwnSource(t))throw new Error(`There is already a source with ID "${t}".`);if(!i.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(i).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(i.type)>=0&&this._validate(ye,`sources.${t}`,i,null,r))return;this.map&&this.map._collectResourceTiming&&(i.collectResourceTiming=!0);const n=ot(t,i,this.dispatcher,this);n.scope=this.scope,n.setEventedParent(this,(()=>({isSourceLoaded:this._isSourceCacheLoaded(n.id),source:n.serialize(),sourceId:n.id})));const o=t=>{const i=(t?"symbol:":"other:")+n.id,r=e.aC(i,this.scope),o=this._sourceCaches[i]=new Mt(r,n,t);(t?this._symbolSourceCaches:this._otherSourceCaches)[n.id]=o,o.onAdd(this.map)};o(!1),"vector"!==i.type&&"geojson"!==i.type||o(!0),n.onAdd&&n.onAdd(this.map),r.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(t){this._checkLoaded();const i=this.getOwnSource(t);if(!i)throw new Error("There is no source with this ID");for(const n in this._layers)if(this._layers[n].source===t)return this.fire(new e.y(new Error(`Source "${t}" cannot be removed while layer "${n}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===t)return this.fire(new e.y(new Error(`Source "${t}" cannot be removed while terrain is using it.`)));const r=this.getOwnSourceCaches(t);for(const n of r){const t=e.cq(n.id);delete this._sourceCaches[t],this._changes.discardSourceCacheUpdate(n.id),n.fire(new e.z("data",{sourceDataType:"metadata",dataType:"source",sourceId:n.getSource().id})),n.setEventedParent(null),n.clearTiles()}return delete this._otherSourceCaches[t],delete this._symbolSourceCaches[t],this.mergeSources(),i.setEventedParent(null),i.onRemove&&i.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(e,t){this._checkLoaded(),this.getOwnSource(e).setData(t),this._changes.setDirty()}getOwnSource(e){const t=this.getOwnSourceCache(e);return t&&t.getSource()}getOwnSources(){const e=[];for(const t in this._otherSourceCaches){const i=this.getOwnSourceCache(t);i&&e.push(i.getSource())}return e}areTilesLoaded(){const e=this._mergedSourceCaches;for(const t in e){const i=e[t]._tiles;for(const e in i){const t=i[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}}return!0}setLights(t){if(this._checkLoaded(),!t)return delete this.ambientLight,void delete this.directionalLight;const i=this._getTransitionParameters();for(const n of t){if(this._validate(ve,"lights",n))return;switch(n.type){case"ambient":if(this.ambientLight){const e=this.ambientLight;e.set(n),e.updateTransitions(i)}else this.ambientLight=new Xe(n,He||(He=new e.a5({color:new e.a6(e.a3.properties_light_ambient.color),"color-use-theme":new e.a6({type:"string",default:"default","property-type":"data-constant"}),intensity:new e.a6(e.a3.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const e=this.directionalLight;e.set(n),e.updateTransitions(i)}else this.directionalLight=new Xe(n,We||(We=new e.a5({direction:new e.ak(e.a3.properties_light_directional.direction),color:new e.a6(e.a3.properties_light_directional.color),"color-use-theme":new e.a6({type:"string",default:"default","property-type":"data-constant"}),intensity:new e.a6(e.a3.properties_light_directional.intensity),"cast-shadows":new e.a6(e.a3.properties_light_directional["cast-shadows"]),"shadow-quality":new e.a6(e.a3.properties_light_directional["shadow-quality"]),"shadow-intensity":new e.a6(e.a3.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const r=new e.a8(this.z||0,i);this.ambientLight&&this.ambientLight.recalculate(r),this.directionalLight&&this.directionalLight.recalculate(r),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const t=this.directionalLight,i=this.ambientLight;if(!t||!i)return;const r=e=>.2126*(e[0]<=.03928?e[0]/12.92:Math.pow((e[0]+.055)/1.055,2.4))+.7152*(e[1]<=.03928?e[1]/12.92:Math.pow((e[1]+.055)/1.055,2.4))+.0722*(e[2]<=.03928?e[2]/12.92:Math.pow((e[2]+.055)/1.055,2.4)),n=t.properties.get("color").toRenderColor(null).toArray01(),o=t.properties.get("intensity"),s=t.properties.get("direction"),a=1-e.cb(s.x,s.y,s.z)[2]/90,l=r(n)*o*a,c=i.properties.get("color").toRenderColor(null).toArray01(),u=i.properties.get("intensity"),h=r(c)*u;return Number(((l+h)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const e=[];return this.directionalLight&&e.push(this.directionalLight.get()),this.ambientLight&&e.push(this.ambientLight.get()),e}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(t){if(!t)return this;if(e.cr(t)){const i=e.cs(t),r=this.fragments.find((e=>{let{id:t}=e;return t===i}));if(!r)throw new Error(`Style import '${t}' not found`);const n=e.cq(t);return r.style.getFragmentStyle(n)}{const e=this.fragments.find((e=>{let{id:i}=e;return i===t}));return e?e.style:void 0}}setFeaturesetSelectors(t){if(!t)return;const i={},r=function(e){return`${e}::${arguments.length>1&&void 0!==arguments[1]?arguments[1]:""}`};this._featuresetSelectors={};for(const n in t){const o=this._featuresetSelectors[n]=[];for(const s of t[n].selectors){if(s.featureNamespace){const t=this.getOwnLayer(s.layer);if(!t){e.w(`Layer is undefined for selector: ${s.layer}`);continue}const o=r(t.source,t.sourceLayer);if(o in i&&i[o]!==s.featureNamespace){e.w(`"featureNamespace ${s.featureNamespace} of featureset ${n}'s selector is not associated to the same source, skip this selector`);continue}i[o]=s.featureNamespace}let t;if(s.properties)for(const i in s.properties){const r=e.U(s.properties[i]);"success"===r.result&&(t=t||{},t[i]=r.value)}o.push({layerId:s.layer,namespace:s.featureNamespace,properties:t,uniqueFeatureID:s._uniqueFeatureID})}}}getFeaturesetDescriptors(e){const t=this.getFragmentStyle(e);if(!t||!t.stylesheet.featuresets)return[];const i=[];for(const r in t.stylesheet.featuresets)i.push({featuresetId:r,importId:t.scope?t.scope:void 0});return i}getFeaturesetLayers(t,i){const r=this.getFragmentStyle(i),n=r.stylesheet.featuresets;if(!n||!n[t])return this.fire(new e.y(new Error(`The featureset '${t}' does not exist in the map's style and cannot be queried.`))),[];const o=[];for(const e of n[t].selectors){const t=r.getOwnLayer(e.layer);t&&o.push(t)}return o}getConfigProperty(t,i){const r=this.getFragmentStyle(t);if(!r)return null;const n=e.aC(i,r.scope),o=r.options.get(n),s=o?o.value||o.default:null;return s?s.serialize():null}setConfigProperty(t,i,r){const n=this.getFragmentStyle(t);if(!n)return;const o=n.stylesheet.indoor?dr(n.stylesheet.schema):n.stylesheet.schema;if(!o||!o[i])return;const s=e.U(r);if("success"!==s.result)return void gr(this,s.value);const a=s.value.expression,l=e.aC(i,n.scope),c=n.options.get(l);if(!c)return;let u;const{minValue:h,maxValue:d,stepValue:p,type:f,values:m}=o[i],g=e.U(o[i].default);"success"===g.result&&(u=g.value.expression),u?(this.options.set(l,Object.assign({},c,{value:a,default:u,minValue:h,maxValue:d,stepValue:p,type:f,values:m})),this.updateConfigDependencies(i)):this.fire(new e.y(new Error(`No schema defined for the config option "${i}" in the "${t}" fragment.`)))}getConfig(t){const i=this.getFragmentStyle(t);if(!i)return null;const r=i.stylesheet.schema;if(!r)return null;const n={};for(const o in r){const t=e.aC(o,i.scope),r=i.options.get(t),s=r?r.value||r.default:null;n[o]=s?s.serialize():null}return n}setConfig(e,t){const i=this.getFragmentStyle(e);i&&(i.updateConfig(t,i.stylesheet.schema),this.updateConfigDependencies())}getSchema(e){const t=this.getFragmentStyle(e);return t?t.stylesheet.schema:null}setSchema(e,t){const i=this.getFragmentStyle(e);i&&(i.stylesheet.schema=t,i.updateConfig(i._config,t),this.updateConfigDependencies())}updateConfig(t,i){if(this._config=t,t||i)if(i)for(const r in i){let n,o;const s=e.U(i[r].default);if("success"===s.result&&(n=s.value.expression),t&&void 0!==t[r]){const i=e.U(t[r]);"success"===i.result&&(o=i.value.expression)}const{minValue:a,maxValue:l,stepValue:c,type:u,values:h}=i[r];if(n){const t=e.aC(r,this.scope);this.options.set(t,{default:n,value:o,minValue:a,maxValue:l,stepValue:c,type:u,values:h})}else this.fire(new e.y(new Error(`No schema defined for config option "${r}".`)))}else this.fire(new e.y(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(e){for(const t of this._configDependentLayers){const i=this.getLayer(t);if(i){if(e&&!i.configDependencies.has(e))continue;i.possiblyEvaluateVisibility(),this._updateLayer(i)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle((e=>{const t=e._styleColorTheme.colorThemeOverride?e._styleColorTheme.colorThemeOverride:e._styleColorTheme.colorTheme;if(t){const i=e._evaluateColorThemeData(t);(!e._styleColorTheme.lut&&""!==i||e._styleColorTheme.lut&&i!==e._styleColorTheme.lut.data)&&e.setColorTheme(t)}})),this._changes.setDirty()}addLayer(t,i){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();const n=t.id;if(this._layers[n])return void this.fire(new e.y(new Error(`Layer with id "${n}" already exists on this map`)));let o;if("custom"===t.type){if(gr(this,e.ct(t)))return;o=e.cu(t,this.scope,this._styleColorTheme.lut,this.options)}else{if("object"==typeof t.source&&(this.addSource(n,t.source),t=e.cp(t),t=e.l(t,{source:n})),this._validate(Te,`layers.${n}`,t,{arrayIndex:-1},r))return;o=e.cu(t,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(o),o.setEventedParent(this,{layer:{id:n}})}0!==o.configDependencies.size&&this._configDependentLayers.add(o.fqid);let s=this._order.length;if(i){const t=this._order.indexOf(i);if(-1===t)return void this.fire(new e.y(new Error(`Layer with id "${i}" does not exist on this map.`)));o.slot===this._layers[i].slot?s=t:e.w(`Layer with id "${i}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(s,0,n),this._layerOrderChanged=!0,this._layers[n]=o;const a=this.getOwnLayerSourceCache(o),l=!!this.directionalLight&&this.directionalLight.shadowsEnabled();a&&o.canCastShadows()&&l&&(a.castsShadows=!0);const c=this._changes.getRemovedLayer(o);if(c&&o.source&&a&&"custom"!==o.type){this._changes.discardLayerRemoval(o);const t=e.aC(o.source,o.scope);c.type!==o.type?this._changes.updateSourceCache(t,"clear"):(this._changes.updateSourceCache(t,"reload"),a.pause())}this._updateLayer(o),o.onAdd&&o.onAdd(this.map),o.scope=this.scope,this.mergeLayers()}moveLayer(t,i){this._checkLoaded();const r=this._checkLayer(t);if(!r)return;if(t===i)return;const n=this._order.indexOf(t);this._order.splice(n,1);let o=this._order.length;if(i){const t=this._order.indexOf(i);if(-1===t)return void this.fire(new e.y(new Error(`Layer with id "${i}" does not exist on this map.`)));r.slot===this._layers[i].slot?o=t:e.w(`Layer with id "${i}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(o,0,t),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(e){this._checkLoaded();const t=this._checkLayer(e);if(!t)return;t.setEventedParent(null);const i=this._order.indexOf(e);this._order.splice(i,1),delete this._layers[e],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(t.fqid),this._changes.removeLayer(t);const r=this.getOwnLayerSourceCache(t);if(r&&r.castsShadows){let e=!1;for(const i in this._layers)if(this._layers[i].source===t.source&&this._layers[i].canCastShadows()){e=!0;break}r.castsShadows=e}t.onRemove&&t.onRemove(this.map),this.mergeLayers()}getOwnLayer(e){return this._layers[e]}hasLayer(e){return e in this._mergedLayers}hasLayerType(e){for(const t in this._layers)if(this._layers[t].type===e)return!0;return!1}setLayerZoomRange(e,t,i){this._checkLoaded();const r=this._checkLayer(e);r&&(r.minzoom===t&&r.maxzoom===i||(null!=t&&(r.minzoom=t),null!=i&&(r.maxzoom=i),this._updateLayer(r)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(e,t){this._checkLoaded();const i=this._checkLayer(e);i&&i.slot!==t&&(i.slot=t,this._updateLayer(i))}setFilter(t,i){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();const n=this._checkLayer(t);if(n&&!e.bn(n.filter,i))return null==i?(n.filter=void 0,void this._updateLayer(n)):void(this._validate(Me,`layers.${n.id}.filter`,i,{layerType:n.type},r)||(n.filter=e.cp(i),this._updateLayer(n)))}getFilter(t){const i=this._checkLayer(t);if(i)return e.cp(i.filter)}setLayoutProperty(t,i,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._checkLoaded();const o=this._checkLayer(t);if(o&&!e.bn(o.getLayoutProperty(i),r)){if(null!=r&&(!n||!1!==n.validate)&&gr(o,Ce.call(ge,{key:`layers.${t}.layout.${i}`,layerType:o.type,objectKey:i,value:r,styleSpec:e.a3,style:{glyphs:!0,sprite:!0}})))return;o.setLayoutProperty(i,r),0!==o.configDependencies.size&&this._configDependentLayers.add(o.fqid),this._updateLayer(o)}}getLayoutProperty(e,t){const i=this._checkLayer(e);if(i)return i.getLayoutProperty(t)}setPaintProperty(t,i,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._checkLoaded();const o=this._checkLayer(t);if(!o)return;if(e.bn(o.getPaintProperty(i),r))return;if(null!=r&&(!n||!1!==n.validate)&&gr(o,Ae.call(ge,{key:`layers.${t}.paint.${i}`,layerType:o.type,objectKey:i,value:r,styleSpec:e.a3})))return;const s=o.setPaintProperty(i,r);0!==o.configDependencies.size&&this._configDependentLayers.add(o.fqid),s&&this._updateLayer(o),this._changes.updatePaintProperties(o)}getPaintProperty(e,t){const i=this._checkLayer(e);if(i)return i.getPaintProperty(t)}setFeatureState(t,i){if(this._checkLoaded(),"target"in t){if("featuresetId"in t.target){const{featuresetId:e,importId:r}=t.target,n=this.getFragmentStyle(r),o=n.getFeaturesetLayers(e);for(const{source:s,sourceLayer:a}of o)n.setFeatureState({id:t.id,source:s,sourceLayer:a},i)}else if("layerId"in t.target){const{layerId:e}=t.target,r=this.getLayer(e);this.setFeatureState({id:t.id,source:r.source,sourceLayer:r.sourceLayer},i)}return}const r=t.source,n=t.sourceLayer,o=this._checkSource(r);if(!o)return;const s=o.type;if("geojson"===s&&n)return void this.fire(new e.y(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===s&&!n)return void this.fire(new e.y(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===t.id&&this.fire(new e.y(new Error("The feature id parameter must be provided.")));const a=this.getOwnSourceCaches(r);for(const e of a)e.setFeatureState(n,t.id,i)}removeFeatureState(t,i){if(this._checkLoaded(),"target"in t){if("featuresetId"in t.target){const{featuresetId:e,importId:r}=t.target,n=this.getFragmentStyle(r),o=n.getFeaturesetLayers(e);for(const{source:s,sourceLayer:a}of o)n.removeFeatureState({id:t.id,source:s,sourceLayer:a},i)}else if("layerId"in t.target){const{layerId:e}=t.target,r=this.getLayer(e);this.removeFeatureState({id:t.id,source:r.source,sourceLayer:r.sourceLayer},i)}return}const r=t.source,n=this._checkSource(r);if(!n)return;const o=n.type,s="vector"===o?t.sourceLayer:void 0;if("vector"===o&&!s)return void this.fire(new e.y(new Error("The sourceLayer parameter must be provided for vector source types.")));if(i&&"string"!=typeof t.id&&"number"!=typeof t.id)return void this.fire(new e.y(new Error("A feature id is required to remove its specific state property.")));const a=this.getOwnSourceCaches(r);for(const e of a)e.removeFeatureState(s,t.id,i)}getFeatureState(t){if(this._checkLoaded(),"target"in t){let i;if("featuresetId"in t.target){const{featuresetId:r,importId:n}=t.target,o=this.getFragmentStyle(n),s=o.getFeaturesetLayers(r);for(const{source:a,sourceLayer:l}of s){const r=o.getFeatureState({id:t.id,source:a,sourceLayer:l});if(r&&!i)i=r;else if(!e.bn(i,r))return void this.fire(new e.y(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in t.target){const{layerId:e}=t.target,r=this.getLayer(e);i=this.getFeatureState({id:t.id,source:r.source,sourceLayer:r.sourceLayer})}return i}const i=t.source,r=t.sourceLayer,n=this._checkSource(i);if(n){if("vector"!==n.type||r)return void 0===t.id&&this.fire(new e.y(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(i)[0].getFeatureState(r,t.id);this.fire(new e.y(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(t){return this.stylesheet.transition=e.l({},this.stylesheet.transition,t),this.transition=this.stylesheet.transition,this}getTransition(){return e.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const t=this.getTerrain(),i=t&&this.terrain&&this.terrain.scope===this.scope?t:this.stylesheet.terrain;return e.cv({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:i,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},(e=>void 0!==e))}_updateFilteredLayers(e){for(const t of Object.values(this._mergedLayers))e(t)&&this._updateLayer(t)}_updateLayer(t){this._changes.updateLayer(t);const i=this.getLayerSourceCache(t),r=e.aC(t.source,t.scope),n=this._changes.getUpdatedSourceCaches();t.source&&!n[r]&&i&&"raster"!==i.getSource().type&&(this._changes.updateSourceCache(r,"reload"),i.pause()),t.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(e){const t=e=>this._mergedLayers[e].is3D(),i=this.order,r={},n=[];for(let s=i.length-1;s>=0;s--){const o=i[s];if(t(o)){r[o]=s;for(const t of e){const e=t[o];if(e)for(const t of e)n.push(t)}}}n.sort(((e,t)=>t.intersectionZ-e.intersectionZ));const o=[];for(let s=i.length-1;s>=0;s--){const a=i[s];if(t(a))for(let e=n.length-1;e>=0;e--){const t=n[e].feature;if(t.layer&&r[t.layer.id]<s)break;o.push(t),n.pop()}else for(const t of e){const e=t[a];if(e)for(const t of e)o.push(t.feature)}}return o}queryRenderedFeatures(t,i,r){let n;i&&!Array.isArray(i)&&i.filter&&(this._validate(Me,"queryRenderedFeatures.filter",i.filter,null,i),n=e.aZ(i.filter));const o={},s=e=>{if(vr.has(e.type))return;const t=this.getOwnLayerSourceCache(e),i=o[t.id]=o[t.id]||{sourceCache:t,layers:{},has3DLayers:!1};e.is3D()&&(i.has3DLayers=!0),i.layers[e.fqid]=i.layers[e.fqid]||{styleLayer:e,targets:[]},i.layers[e.fqid].targets.push({filter:n})};if(i&&i.layers){if(!Array.isArray(i.layers))return this.fire(new e.y(new Error("parameters.layers must be an Array."))),[];for(const t of i.layers){const i=this._layers[t];if(!i)return this.fire(new e.y(new Error(`The layer '${t}' does not exist in the map's style and cannot be queried for features.`))),[];s(i)}}else for(const e in this._layers)s(this._layers[e]);const a=this._queryRenderedFeatures(t,o,r),l=this._flattenAndSortRenderedFeatures(a),c=[];for(const u of l)e.cs(u.layer.id)===this.scope&&c.push(u);return c}queryRenderedFeatureset(t,i,r){let n;i&&!Array.isArray(i)&&i.filter&&(this._validate(Me,"queryRenderedFeatures.filter",i.filter,null,i),n=e.aZ(i.filter));const o="mock",s=[];if(i&&i.target)s.push(Object.assign({},i,{targetId:o,filter:n}));else{const e=this.getFeaturesetDescriptors();for(const t of e)s.push({targetId:o,filter:n,target:t});for(const{style:t}of this.fragments){const e=t.getFeaturesetDescriptors();for(const t of e)s.push({targetId:o,filter:n,target:t})}}const a=this.queryRenderedTargets(t,s,r),l=[],c=new Set;for(const u of a)for(const t of u.variants[o])at(t,u,c)||l.push(new e.cw(u,t));return l}queryRenderedTargets(t,i,r){const n={},o=(e,t,i,r)=>{const o=n[t.id]=n[t.id]||{sourceCache:t,layers:{},has3DLayers:!1};if(o.layers[e.fqid]=o.layers[e.fqid]||{styleLayer:e,targets:[]},e.is3D()&&(o.has3DLayers=!0),!r)return i.uniqueFeatureID=!1,void o.layers[e.fqid].targets.push(i);o.layers[e.fqid].targets.push(Object.assign({},i,{namespace:r.namespace,properties:r.properties,uniqueFeatureID:r.uniqueFeatureID}))};for(const a of i)if("featuresetId"in a.target){const{featuresetId:t,importId:i}=a.target,r=this.getFragmentStyle(i);if(!r||!r._featuresetSelectors)continue;const n=r._featuresetSelectors[t];if(!n){this.fire(new e.y(new Error(`The featureset '${t}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const e of n){const t=r.getOwnLayer(e.layerId);t&&!vr.has(t.type)&&o(t,r.getOwnLayerSourceCache(t),a,e)}}else if("layerId"in a.target){const{layerId:e}=a.target,t=this.getLayer(e);if(!t||vr.has(t.type))continue;o(t,this.getLayerSourceCache(t),a)}const s=this._queryRenderedFeatures(t,n,r);return this._flattenAndSortRenderedFeatures(s)}_queryRenderedFeatures(e,t,i){const r=[],n=!!this.map._showQueryGeometry,o=Ye.createFromScreenPoints(e,i);for(const s in t){const e=lt(o,t[s],this._availableImages,i,n);Object.keys(e).length&&r.push(e)}if(this.placement)for(const s in t){if(!t[s].sourceCache._onlySymbols)continue;const e=ct(o.screenGeometry,t[s],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData);Object.keys(e).length&&r.push(e)}return r}querySourceFeatures(e,t){const i=t&&t.filter;i&&this._validate(Me,"querySourceFeatures.filter",i,null,t);let r=[];const n=this.getOwnSourceCaches(e);for(const o of n)r=r.concat(ut(o,t));return r}addSourceType(e,t,i){return wr.getSourceType(e)?i(new Error(`A source type called "${e}" already exists.`)):(wr.setSourceType(e,t),t.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:e,url:t.workerSourceURL},i):i(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(t,i){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();const n=this.light.getLight();let o=!1;for(const a in t)if(!e.bn(t[a],n[a])){o=!0;break}if(!o)return;const s=this._getTransitionParameters();this.light.setLight(t,i,r),this.light.updateTransitions(s)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){void 0===this.disableElevatedTerrain&&(this.disableElevatedTerrain=e.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&e.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this._checkLoaded(),!t)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),0===i&&delete this.terrain,null===t?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let r=t;const n=null==t.source;if(1===i){if(this.disableElevatedTerrain)return;if("object"==typeof r.source){const t="terrain-dem-src";this.addSource(t,r.source),r=e.cp(r),r=e.l(r,{source:t})}const t=e.l({},r),i={};if(this.terrain&&n){t.source=this.terrain.get().source;const e=this.terrain?this.getFragmentStyle(this.terrain.scope):null;e&&(i.style=e.serialize())}if(this._validate(xe,"terrain",t,i))return}if(!this.terrain||this.terrain.scope!==this.scope&&!n||this.terrain&&i!==this.terrain.drapeRenderMode){if(!r)return;this._createTerrain(r,i),this.fire(new e.z("data",{dataType:"style"}))}else{const i=this.terrain,n=i.get();for(const t of Object.keys(e.a3.terrain))!r.hasOwnProperty(t)&&e.a3.terrain[t].default&&(r[t]=e.a3.terrain[t].default);for(const r in t)if(!e.bn(t[r],n[r])){i.set(t,this.options),this.stylesheet.terrain=t;const r=this._getTransitionParameters({duration:0});i.updateTransitions(r),this.fire(new e.z("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(e){const t=this.fog=new Ve(e,this.map.transform,this.scope,this.options);this.stylesheet.fog=t.get();const i=this._getTransitionParameters({duration:0});t.updateTransitions(i)}_createSnow(e){const t=this.snow=new $e(e,this.map.transform,this.scope,this.options);this.stylesheet.snow=t.get();const i=this._getTransitionParameters({duration:0});t.updateTransitions(i)}_createRain(e){const t=this.rain=new qe(e,this.map.transform,this.scope,this.options);this.stylesheet.rain=t.get();const i=this._getTransitionParameters({duration:0});t.updateTransitions(i)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask((()=>{for(const e of this.map._markers)e._evaluateOpacity()}))}getFog(){return this.fog?this.fog.get():null}setFog(t){if(this._checkLoaded(),!t)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const i=this.fog;if(!e.bn(i.get(),t)){i.set(t,this.options),this.stylesheet.fog=i.get();const e=this._getTransitionParameters({duration:0});i.updateTransitions(e)}}else this._createFog(t);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(t){if(this._checkLoaded(),!t)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const i=this.snow;if(!e.bn(i.get(),t)){i.set(t,this.options),this.stylesheet.snow=i.get();const e=this._getTransitionParameters({duration:0});i.updateTransitions(e)}}else this._createSnow(t);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(t){if(this._checkLoaded(),!t)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const i=this.rain;if(!e.bn(i.get(),t)){i.set(t,this.options),this.stylesheet.rain=i.get();const e=this._getTransitionParameters({duration:0});i.updateTransitions(e)}}else this._createRain(t);this._markersNeedUpdate=!0}_reloadColorTheme(){const t=()=>{for(const e in this._layers)this._layers[e].lut=this._styleColorTheme.lut;for(const e in this._sourceCaches)this._sourceCaches[e].clearTiles()},i=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!i)return this._styleColorTheme.lut=null,void t();const r=this._evaluateColorThemeData(i);this._loadColorTheme(r).then((()=>{this.fire(new e.z("colorthemeset")),t()})).catch((t=>{e.w(`Couldn't set color theme: ${t}`)}))}setColorTheme(t){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&e.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=t,this._reloadColorTheme()}setImportColorTheme(e,t){const i=this.getFragmentStyle(e);i&&(i._styleColorTheme.colorThemeOverride=t,i._reloadColorTheme())}_getTransitionParameters(t){return{now:e.q.now(),transition:e.l(this.transition,t)}}updateDrapeFirstLayers(){if(!this.terrain)return;const e=[],t=[];for(const i of this._mergedOrder)this.isLayerDraped(this._mergedLayers[i])?e.push(i):t.push(i);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...e),this._drapedFirstOrder.push(...t)}_createTerrain(e,t){const i=this.terrain=new Le(e,t,this.scope,this.options);1===t&&(this.stylesheet.terrain=e),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const r=this._getTransitionParameters({duration:0});i.updateTransitions(r)}_force3DLayerUpdate(){for(const e in this._layers){const t=this._layers[e];"fill-extrusion"===t.type&&this._updateLayer(t)}}_forceSymbolLayerUpdate(){for(const e in this._layers){const t=this._layers[e];"symbol"===t.type&&this._updateLayer(t)}}_validate(t,i,r,n){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(o&&!1===o.validate)return!1;const s=e.l({},this.serialize());return gr(this,t.call(ge,e.l({key:i,style:s,value:r,styleSpec:e.a3},n)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.cx.off("pluginStateChange",this._rtlTextPluginCallback);for(const e in this._mergedLayers)this._mergedLayers[e].setEventedParent(null);for(const e in this._mergedSourceCaches)this._mergedSourceCaches[e].clearTiles(),this._mergedSourceCaches[e].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(e){const t=this.getSourceCaches(e);for(const i of t)i.clearTiles()}clearSources(){for(const e in this._mergedSourceCaches)this._mergedSourceCaches[e].clearTiles()}reloadSource(e){const t=this.getSourceCaches(e);for(const i of t)i.resume(),i.reload()}reloadSources(){for(const e of this.getSources())e.reload&&e.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle((e=>{e.modelManager.reloadModels(e.scope)}))}updateSources(e){let t;this.directionalLight&&(t=sr(this.directionalLight));for(const i in this._mergedSourceCaches)this._mergedSourceCaches[i].update(e,void 0,void 0,t)}_generateCollisionBoxes(){for(const e in this._sourceCaches){const t=this._sourceCaches[e];t.resume(),t.reload()}}_updatePlacement(t,i,r,n,o,s){let a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=!1,c=!1;const u={},h={};for(const d of this._mergedOrder){const t=this._mergedLayers[d];if("symbol"!==t.type)continue;const r=e.aC(t.source,t.scope);let n=u[r];if(!n){const e=this.getLayerSourceCache(t);if(!e)continue;const i=e.getRenderableIds(!0).map((t=>e.getTileByID(t)));h[r]=i.slice(),n=u[r]=i.sort(((e,t)=>t.tileID.overscaledZ-e.tileID.overscaledZ||(e.tileID.isLessThan(t.tileID)?-1:1)))}const o=this.crossTileSymbolIndex.addLayer(t,n,i.center.lng,i.projection);l=l||o}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),a=a||this._layerOrderChanged||0===n,this._layerOrderChanged&&this.fire(new e.z("neworder")),(a||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.q.now(),i.zoom))&&(this.pauseablePlacement=new ki(i,this._mergedOrder,a,r,n,o,this.placement,this.fog&&i.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,u,h,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.q.now()),c=!0),l&&this.pauseablePlacement.placement.setStale()),c||l){this._buildingIndex.onNewFrame(i.zoom);for(let t=0;t<this._mergedOrder.length;t++){const i=this._mergedLayers[this._mergedOrder[t]];if("symbol"!==i.type)continue;const r=this.isLayerClipped(i);this.placement.updateLayerOpacities(i,u[e.aC(i.source,i.scope)],t,r?s:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.q.now())}}_releaseSymbolFadeTiles(){for(const e in this._sourceCaches)this._sourceCaches[e].releaseSymbolFadeTiles()}addImport(t,i){this._checkLoaded();const r=this.stylesheet.imports=this.stylesheet.imports||[];if(-1!==r.findIndex((e=>{let{id:i}=e;return i===t.id})))return void this.fire(new e.y(new Error(`Import with id '${t.id}' already exists in the map's style.`)));if(!i)return r.push(t),this._loadImports([t],!0);const n=r.findIndex((e=>{let{id:t}=e;return t===i}));return-1===n&&this.fire(new e.y(new Error(`Import with id "${i}" does not exist on this map.`))),this.stylesheet.imports=r.slice(0,n).concat(t).concat(r.slice(n)),this._loadImports([t],!0,i)}updateImport(t,i){this._checkLoaded();const r=this.stylesheet.imports||[],n=this.getImportIndex(t);return-1===n?this:"string"==typeof i?(this.setImportUrl(t,i),this):(i.url&&i.url!==r[n].url&&this.setImportUrl(t,i.url),e.bn(i.config,r[n].config)||this.setImportConfig(t,i.config,i.data.schema),e.bn(i.data,r[n].data)||this.setImportData(t,i.data),this)}moveImport(e,t){this._checkLoaded();let i=this.stylesheet.imports||[];const r=this.getImportIndex(e);if(-1===r)return this;const n=this.getImportIndex(t);if(-1===n)return this;const o=i[r],s=this.fragments[r];return i=i.filter((t=>{let{id:i}=t;return i!==e})),this.fragments=this.fragments.filter((t=>{let{id:i}=t;return i!==e})),this.stylesheet.imports=i.slice(0,n).concat(o).concat(i.slice(n)),this.fragments=this.fragments.slice(0,n).concat(s).concat(this.fragments.slice(n)),this.mergeLayers(),this}setImportUrl(e,t){this._checkLoaded();const i=this.stylesheet.imports||[],r=this.getImportIndex(e);if(-1===r)return this;i[r].url=t;const n=this.fragments[r];return n.style=this._createFragmentStyle(i[r]),n.style.on("style.import.load",(()=>this.mergeAll())),n.style.loadURL(t),this}setImportData(e,t){this._checkLoaded();const i=this.getImportIndex(e),r=this.stylesheet.imports||[];return-1===i?this:t?(this.fragments[i].style.setState(t),this._reloadImports(),this):(delete r[i].data,this.setImportUrl(e,r[i].url))}setImportConfig(e,t,i){this._checkLoaded();const r=this.getImportIndex(e),n=this.stylesheet.imports||[];if(-1===r)return this;t?n[r].config=t:delete n[r].config;const o=this.fragments[r];i&&o.style.stylesheet&&(o.style.stylesheet.schema=i);const s=o.style.stylesheet&&o.style.stylesheet.schema;return o.config=t,o.style.updateConfig(t,s),this.updateConfigDependencies(),this}removeImport(e){this._checkLoaded();const t=this.stylesheet.imports||[],i=this.getImportIndex(e);-1!==i&&(t.splice(i,1),this.fragments[i].style._remove(),this.fragments.splice(i,1),this._reloadImports())}getImportIndex(t){const i=(this.stylesheet.imports||[]).findIndex((e=>e.id===t));return-1===i&&this.fire(new e.y(new Error(`Import '${t}' does not exist in the map's style and cannot be updated.`))),i}getLayer(e){return this._mergedLayers[e]}getSources(){const e=[];for(const t in this._mergedOtherSourceCaches){const i=this._mergedOtherSourceCaches[t];i&&e.push(i.getSource())}return e}getSource(e,t){const i=this.getSourceCache(e,t);return i&&i.getSource()}getLayerSource(e){const t=this.getLayerSourceCache(e);return t&&t.getSource()}getSourceCache(t,i){const r=e.aC(t,i);return this._mergedOtherSourceCaches[r]}getLayerSourceCache(t){const i=e.aC(t.source,t.scope);return"symbol"===t.type?this._mergedSymbolSourceCaches[i]:this._mergedOtherSourceCaches[i]}getSourceCaches(e){if(null==e)return Object.values(this._mergedSourceCaches);const t=[];return this._mergedOtherSourceCaches[e]&&t.push(this._mergedOtherSourceCaches[e]),this._mergedSymbolSourceCaches[e]&&t.push(this._mergedSymbolSourceCaches[e]),t}updateSourceCaches(){const e=this._changes.getUpdatedSourceCaches();for(const t in e){const i=e[t];"reload"===i?this.reloadSource(t):"clear"===i&&this.clearSource(t)}}updateLayers(e){const t=this._changes.getUpdatedPaintProperties();for(const i of t){const t=this.getLayer(i);t&&t.updateTransitions(e)}}getImages(e,t,i){this.imageManager.getImages(t.icons,t.scope,i),this._updateTilesForChangedImages();const r=e=>{e&&e.setDependencies(t.tileID.key,t.type,t.icons)};r(this._otherSourceCaches[t.source]),r(this._symbolSourceCaches[t.source])}rasterizeImages(e,t,i){this.imageManager.rasterizeImages(t,i)}getGlyphs(e,t,i){this.glyphManager.getGlyphs(t.stacks,t.scope,i)}getResource(t,i,r){return e.cy(i,r)}getOwnSourceCache(e){return this._otherSourceCaches[e]}getOwnLayerSourceCache(e){return"symbol"===e.type?this._symbolSourceCaches[e.source]:this._otherSourceCaches[e.source]}getOwnSourceCaches(e){const t=[];return this._otherSourceCaches[e]&&t.push(this._otherSourceCaches[e]),this._symbolSourceCaches[e]&&t.push(this._symbolSourceCaches[e]),t}_isSourceCacheLoaded(t){const i=this.getOwnSourceCaches(t);return 0===i.length?(this.fire(new e.y(new Error(`There is no source with ID '${t}'`))),!1):i.every((e=>e.loaded()))}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(e,t){if(!this._clipLayerPresent&&"fill-extrusion"!==e.type)return!1;const i="fill-extrusion"===e.type&&"building"===e.sourceLayer;if(e.is3D()){if(i||t&&"batched-model"===t.type)return!0;if("model"===e.type)return!0}else if("symbol"===e.type)return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach((e=>{e.style._remove()})),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}wr.getSourceType=function(e){return nt[e]},wr.setSourceType=function(e,t){nt[e]=t},wr.registerForPluginStateChange=e.ch;var Sr="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#ifdef RENDER_CUTOFF\nfloat cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}\n#endif",Tr="\nout vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}\n#ifdef INDICATOR_CUTOUT\nuniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;\n#endif\nvec4 applyCutout(vec4 color,float height) {\n#ifdef INDICATOR_CUTOUT\nfloat verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);\n#else\nreturn color;\n#endif\n}\n#ifdef DEBUG_WIREFRAME\n#define HANDLE_WIREFRAME_DEBUG \\\nglFragColor=vec4(0.7,0.0,0.0,0.7); \\\ngl_FragDepth=gl_FragCoord.z-0.0001;\n#else\n#define HANDLE_WIREFRAME_DEBUG\n#endif\n#ifdef RENDER_CUTOFF\nuniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;\n#endif\nvec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}",Mr="\n#define EXTENT 8192.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}\n#ifdef RENDER_CUTOFF\nuniform vec4 u_cutoff_params;out float v_cutoff_opacity;\n#endif\nconst vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}",Ar="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Cr="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\n#ifdef TERRAIN\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nvec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }\n#endif\n#ifdef DEPTH_OCCLUSION\nuniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;\n#ifdef DEPTH_D24\nfloat unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}\n#else\nhighp float unpack_depth_rgba(vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}\n#endif\nbool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;\n#ifdef DEPTH_D24\nfloat depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);\n#else\nfloat depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));\n#endif\nreturn coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;\n#ifdef DEPTH_D24\nhighp vec4 depth=vec4(\ntexture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r\n);depth=unpack_depth4(depth);\n#else\nhighp vec4 depth=vec4(\nunpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))\n);\n#endif\nreturn depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {\n#ifdef DEPTH_D24\nhighp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);\n#else\nhighp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));\n#endif\nres+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}\n#else\nbool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }\n#endif//DEPTH_OCCLUSION",Er="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",Pr="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif",kr="#ifdef RASTER_ARRAY\nuniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)\n);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)\n);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}\n#endif",Ir="#ifdef RASTER_ARRAY\nuniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}\n#endif\nuniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}",Dr="#ifdef RENDER_SHADOWS\nuniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}\n#endif//RENDER_SHADOWS",Lr="#ifdef RENDER_SHADOWS\n#ifdef DEPTH_TEXTURE\nuniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;\n#else\nuniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;\n#endif\nuniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;\n#ifdef DEPTH_TEXTURE\nshadow_depth=texture(u_shadowmap_1,uv).r;\n#else\nshadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;\n#endif\nreturn step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;\n#ifdef DEPTH_TEXTURE\nshadow_depth=texture(u_shadowmap_0,uv).r;\n#else\nshadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;\n#endif\nreturn step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;\n#ifdef TEXTURE_GATHER\nhighp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));\n#else\nhighp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(\nshadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)\n);\n#endif\nvec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {\n#ifdef SHADOWS_SINGLE_CASCADE\nlight_view_pos0.xyz/=light_view_pos0.w;vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);\n#else\nlight_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));\n#endif\n}highp float calculate_shadow_bias(float NDotL) {\n#ifdef NORMAL_OFFSET\nreturn 0.5*u_shadow_bias.x;\n#else\nreturn 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));\n#endif\n}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)\n{highp vec2 biasUV=vec2(\npos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}\n#endif";const Rr=[];jr(Sr,Rr),jr(Mr,Rr),jr(Tr,Rr);const zr={"_prelude_fog.vertex.glsl":Er,"_prelude_terrain.vertex.glsl":Cr,"_prelude_shadow.vertex.glsl":Dr,"_prelude_fog.fragment.glsl":Pr,"_prelude_shadow.fragment.glsl":Lr,"_prelude_lighting.glsl":"\n#ifdef LIGHTING_3D_MODE\nuniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}\n#endif//LIGHTING_3D_MODE","_prelude_raster_array.glsl":kr,"_prelude_raster_particle.glsl":Ir},Or={};Vr("",Cr),Vr(Pr,Er),Vr(Lr,Dr),Vr(kr,""),Vr(Ir,"");const Fr=Vr(Tr,Mr),Br=Sr;var Nr={background:Vr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nin vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_lighting.glsl"\nin vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),backgroundPattern:Vr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),circle:Vr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin vec3 v_data;in float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nuniform float u_emissive_strength;void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? \nsmoothstep(0.0,-antialiased_blur,1.0-extrude_length) : \nsmoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\nglFragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\n#ifdef ELEVATED_ROADS\nin float a_circle_z_offset;\n#endif\nout vec3 v_data;out float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\n#ifdef ELEVATED_ROADS\nworld_center.z+=a_circle_z_offset+ELEVATION_BIAS;\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}'),clippingMask:Vr("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Vr('#include "_prelude_fog.fragment.glsl"\nuniform highp float u_intensity;in vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nout vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),heatmapTexture:Vr("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(0.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}","in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Vr("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",'#include "_prelude_terrain.vertex.glsl"\nin vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}'),collisionCircle:Vr("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}","in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Vr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",'#include "_prelude_terrain.vertex.glsl"\nin vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;\n#endif\nout vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}'),fill:Vr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nuniform float u_emissive_strength;\n#ifdef RENDER_SHADOWS\nuniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;\n#endif\n#ifdef INDICATOR_CUTOUT\nin highp float v_z_offset;\n#endif\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#ifdef RENDER_SHADOWS\nfloat light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);\n#endif\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nout_color*=opacity;\n#ifdef INDICATOR_CUTOUT\nif (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\nin vec2 a_pos;\n#ifdef ELEVATED_ROADS\nin float a_road_z_offset;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;\n#endif\n#ifdef INDICATOR_CUTOUT\nout highp float v_z_offset;\n#endif\nuniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp float z_offset\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp float z_offset\n#ifdef ELEVATED_ROADS\nz_offset+=a_road_z_offset;\n#endif\nfloat hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nvec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);\n#ifdef NORMAL_OFFSET\nvec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n#ifdef INDICATOR_CUTOUT\nv_z_offset=z_offset;\n#endif\n}'),fillOutline:Vr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_shadow.fragment.glsl"\nin highp vec2 v_pos;uniform float u_emissive_strength;\n#ifdef RENDER_SHADOWS\nuniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;\n#endif\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#ifdef RENDER_SHADOWS\nfloat light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);\n#endif\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\nin vec2 a_pos;\n#ifdef ELEVATED_ROADS\nin float a_road_z_offset;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;\n#endif\nuniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp float z_offset\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp float z_offset\n#ifdef ELEVATED_ROADS\nz_offset+=a_road_z_offset;\n#endif\nfloat hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef RENDER_SHADOWS\nvec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);\n#ifdef NORMAL_OFFSET\nvec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillOutlinePattern:Vr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_shadow.fragment.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;\n#ifdef RENDER_SHADOWS\nuniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;\n#endif\nin highp vec2 v_pos;in highp vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#ifdef RENDER_SHADOWS\nfloat light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);\n#endif\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;\n#ifdef ELEVATED_ROADS\nin float a_road_z_offset;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;\n#endif\nout highp vec2 v_pos;out highp vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define highp float z_offset\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize highp float z_offset\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;\n#ifdef ELEVATED_ROADS\nz_offset+=a_road_z_offset;\n#endif\nfloat hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef RENDER_SHADOWS\nvec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);\n#ifdef NORMAL_OFFSET\nvec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillPattern:Vr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_shadow.fragment.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;\n#ifdef RENDER_SHADOWS\nuniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;\n#endif\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#ifdef RENDER_SHADOWS\nfloat light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);\n#endif\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;\n#ifdef ELEVATED_ROADS\nin float a_road_z_offset;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;\n#endif\nout highp vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define highp float z_offset\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize highp float z_offset\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;\n#ifdef ELEVATED_ROADS\nz_offset+=a_road_z_offset;\n#endif\nfloat hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef RENDER_SHADOWS\nvec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);\n#ifdef NORMAL_OFFSET\nvec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillExtrusion:Vr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin vec4 v_color;in vec4 v_flat;\n#ifdef RENDER_SHADOWS\nin highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;\n#endif\nuniform lowp float u_opacity;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;in vec2 v_ao;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nin vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nin highp vec3 v_normal;\n#endif\nuniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;\n#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)\nin float v_flood_radius;in float v_has_floodlight;\n#endif\nin float v_height;\n#pragma mapbox: define highp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp float emissive_strength\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nvec3 normal=normalize(v_normal);\n#endif\nfloat z;vec4 color=v_color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);\n#ifdef LIGHTING_3D_MODE\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#else\ncolor=mix(v_color,v_roof_color,z);\n#endif\n#endif\nfloat h=max(0.0,v_height);float ao_shade=1.0;\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);\n#ifdef LIGHTING_3D_MODE\n#ifdef FLOOD_LIGHT\ncolor.rgb*=mix(ao_shade,1.0,v_has_floodlight);\n#else\ncolor.rgb*=ao_shade;\n#endif\n#else\ncolor.rgb*=ao_shade;\n#endif\n#endif\n#ifdef LIGHTING_3D_MODE\nfloat flood_radiance=0.0;\n#ifdef FLOOD_LIGHT\nflood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef FLOOD_LIGHT\nfloat ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);\n#else\nfloat shadowed_lighting_factor;\n#ifdef RENDER_CUTOFF\nshadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}\n#else\nshadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);\n#endif\ncolor.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);\n#endif\n#else\ncolor.rgb=apply_lighting(color.rgb,normal);\n#ifdef FLOOD_LIGHT\ncolor.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);\n#endif\n#endif\ncolor.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));\n#endif\n#ifdef INDICATOR_CUTOUT\ncolor=applyCutout(color,h);\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\n#include "_prelude_lighting.glsl"\nuniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#ifdef RENDER_WALL_MODE\nin vec3 a_join_normal_inside;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\n#ifdef TERRAIN\nuniform int u_height_type;uniform int u_base_type;\n#endif\nuniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nout vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nout highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;out vec2 v_ao;\n#endif\n#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)\nout float v_flood_radius;out float v_has_floodlight;\n#endif\nout float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define highp float flood_light_wall_radius\n#pragma mapbox: define highp float line_width\n#pragma mapbox: define highp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize highp float flood_light_wall_radius\n#pragma mapbox: initialize highp float line_width\n#pragma mapbox: initialize highp float emissive_strength\nbase*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nv_normal=normal;\n#endif\nbase=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;\n#ifdef TERRAIN\nbool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat cutoff=1.0;vec3 scaled_pos=pos;\n#ifdef RENDER_CUTOFF\nvec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);\n#endif\nfloat hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));\n#ifdef RENDER_WALL_MODE\nvec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;\n#endif\ngl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;\n#ifdef RENDER_SHADOWS\nvec3 shd_pos0=pos;vec3 shd_pos1=pos;\n#ifdef NORMAL_OFFSET\nvec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifndef LIGHTING_3D_MODE\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#endif\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\n#ifdef FLOOD_LIGHT\nfloat is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;\n#endif\nv_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);\n#else\nv_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),fillExtrusionDepth:Vr("in highp float v_depth;void main() {\n#ifndef DEPTH_TEXTURE\nglFragColor=pack_depth(v_depth);\n#endif\n}",'#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;\n#ifdef TERRAIN\nuniform int u_height_type;uniform int u_base_type;\n#endif\nin vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#ifdef RENDER_WALL_MODE\nin vec3 a_join_normal_inside;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp float line_width\n#pragma mapbox: define highp vec4 color\nout highp float v_depth;void main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp float line_width\n#pragma mapbox: initialize highp vec4 color\nbase*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nvec3 pos;\n#ifdef TERRAIN\nbool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);\n#else\npos=vec3(pos_nx.xy,t > 0.0 ? height : base);\n#endif\n#ifdef RENDER_WALL_MODE\nvec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;\n#endif\nfloat hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}'),fillExtrusionPattern:Vr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;in vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nin vec3 v_normal;\n#endif\nin highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define highp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize highp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef INDICATOR_CUTOUT\nout_color=applyCutout(out_color,height);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_lighting.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#ifdef RENDER_WALL_MODE\nin vec3 a_join_normal_inside;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\n#ifdef TERRAIN\nuniform int u_height_type;uniform int u_base_type;\n#endif\nout highp vec2 v_pos;out vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;out vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nout vec3 v_normal;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define highp float pixel_ratio\n#pragma mapbox: define highp float line_width\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize highp float pixel_ratio\n#pragma mapbox: initialize highp float line_width\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\n#ifdef RENDER_WALL_MODE\nvec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;\n#endif\nfloat hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_normal=normal;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}'),groundShadow:Vr('#include "_prelude_shadow.fragment.glsl"\nprecision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;\n#ifdef FOG\nin float v_fog_opacity;\n#endif\nvoid main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);\n#ifdef RENDER_CUTOFF\nshadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));\n#endif\n#ifdef FOG\nshadow=mix(shadow,vec3(1.0),v_fog_opacity);\n#endif\n#ifdef INDICATOR_CUTOUT\nshadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);\n#endif\nglFragColor=vec4(shadow,1.0);}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;\n#ifdef FOG\nout float v_fog_opacity;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);\n#endif\n}'),fillExtrusionGroundEffect:Vr("uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;\n#ifdef SDF_SUBPASS\nin highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}\n#ifdef FOG\nin highp float v_fog;\n#endif\n#endif\nvoid main() {\n#ifdef CLEAR_SUBPASS\nvec4 color=vec4(1.0);\n#ifdef CLEAR_FROM_TEXTURE\ncolor=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));\n#endif\nglFragColor=color;\n#else\n#ifdef SDF_SUBPASS\nhighp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;\n#ifdef FOG\nfog=v_fog;\n#endif\n#ifdef RENDER_CUTOFF\nfog*=v_cutoff_opacity;\n#endif\nglFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));\n#else\nvec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);\n#ifdef OVERDRAW_INSPECTOR\ncolor=vec4(1.0);\n#endif\nglFragColor=color;\n#endif\nHANDLE_WIREFRAME_DEBUG;\n#endif\n}",'#include "_prelude_fog.vertex.glsl"\nin highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;\n#ifdef SDF_SUBPASS\nout highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;\n#ifdef FOG\nout highp float v_fog;\n#endif\n#endif\nuniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;\n#pragma mapbox: define highp float flood_light_ground_radius\nconst float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {\n#pragma mapbox: initialize highp float flood_light_ground_radius\nvec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;\n#ifdef SDF_SUBPASS\nv_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);\n#ifdef FOG\nv_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);\n#endif\n#endif\nfloat hidden_by_landmark=0.0;\n#ifdef HAS_CENTROID\nhidden_by_landmark=a_hidden_by_landmark;\n#endif\nfloat isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));\n#ifdef RENDER_CUTOFF\nv_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);\n#endif\n}'),hillshadePrepare:Vr("precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}","uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Vr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\nglFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);\n#endif\n#ifdef FOG\nglFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),line:Vr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_shadow.fragment.glsl"\nuniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;\n#ifdef ELEVATED_ROADS\nin highp float v_road_z_offset;\n#endif\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;in vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\n#ifdef INDICATOR_CUTOUT\nin highp float v_z_offset;\n#endif\n#ifdef RENDER_SHADOWS\nuniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;\n#endif\nfloat luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float border_width\n#pragma mapbox: define lowp vec4 border_color\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float border_width\n#pragma mapbox: initialize lowp vec4 border_color\nfloat dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trim_alpha=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}\n#endif\nif (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#ifdef RENDER_SHADOWS\nfloat light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#ifdef ELEVATED_ROADS\nout_color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);\n#else\nout_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);\n#endif\n#endif\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nout_color*=(alpha*opacity);\n#ifdef INDICATOR_CUTOUT\nout_color=applyCutout(out_color,v_z_offset);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#define EXTRUDE_SCALE 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;\n#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)\nin vec3 a_z_offset_width;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nin highp vec3 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nin float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;\n#ifdef ELEVATED\nuniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {\n#ifdef ELEVATION_REFERENCE_SEA\nreturn 0.0;\n#else\nreturn elevation(apos);\n#endif\n}\n#endif\nout vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;\n#ifdef ELEVATED_ROADS\nout highp float v_road_z_offset;\n#endif\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#ifdef INDICATOR_CUTOUT\nout highp float v_z_offset;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float border_width\n#pragma mapbox: define lowp vec4 border_color\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float border_width\n#pragma mapbox: initialize lowp vec4 border_color\nfloat a_z_offset;\n#if defined(ELEVATED) || defined(ELEVATED_ROADS)\na_z_offset=a_z_offset_width.x;\n#endif\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;\n#ifdef VARIABLE_LINE_WIDTH\nfloat left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;\n#else\nhalfwidth=(u_width_scale*width)/2.0;\n#endif\noffset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;\n#ifdef ELEVATED_ROADS\nv_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;\n#else\n#ifdef ELEVATED\nvec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;\n#ifdef CROSS_SLOPE_VERTICAL\nfloat top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);\n#else\n#ifdef CROSS_SLOPE_HORIZONTAL\nfloat ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;\n#else\nfloat ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;\n#endif\n#endif\ngl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);\n#else\ngl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);\n#endif\n#endif\n#ifdef ELEVATED_ROADS\n#ifdef RENDER_SHADOWS\nvec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;\n#ifdef NORMAL_OFFSET\nvec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;\n#endif\n#endif\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nhighp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);\n#else\nv_uv=vec3(a_uv_x,0.0,line_progress);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n#ifdef INDICATOR_CUTOUT\nv_z_offset=a_z_offset;\n#endif\n}'),linePattern:Vr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_shadow.fragment.glsl"\nuniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;\n#ifdef RENDER_LINE_TRIM_OFFSET\nin highp vec3 v_uv;\n#endif\n#ifdef ELEVATED_ROADS\nin highp float v_road_z_offset;\n#endif\n#ifdef LINE_JOIN_NONE\nin vec2 v_pattern_data;\n#endif\n#ifdef INDICATOR_CUTOUT\nin highp float v_z_offset;\n#endif\n#ifdef RENDER_SHADOWS\nuniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;\n#endif\nuniform float u_emissive_strength;\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define mediump float pixel_ratio\n#pragma mapbox: define mediump float blur\n#pragma mapbox: define mediump float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize mediump float pixel_ratio\n#pragma mapbox: initialize mediump float blur\n#pragma mapbox: initialize mediump float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}\n#endif\n#ifdef LINE_JOIN_NONE\nhighp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}\n#endif\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting_with_emission_ground(color,u_emissive_strength);\n#ifdef RENDER_SHADOWS\nfloat light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#ifdef ELEVATED_ROADS\ncolor.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);\n#else\ncolor.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);\n#endif\n#endif\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ncolor*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}\n#ifdef INDICATOR_CUTOUT\ncolor=applyCutout(color,v_z_offset);\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#define scale 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;\n#if defined(ELEVATED) || defined(ELEVATED_ROADS)\nin vec3 a_z_offset_width;\n#endif\n#ifdef RENDER_LINE_TRIM_OFFSET\nin highp vec3 a_packed;\n#endif\nin highp float a_linesofar;\n#ifdef LINE_JOIN_NONE\nin highp vec3 a_pattern_data;out vec2 v_pattern_data;\n#endif\n#ifdef INDICATOR_CUTOUT\nout highp float v_z_offset;\n#endif\nuniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;\n#ifdef ELEVATED\nuniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {\n#ifdef ELEVATION_REFERENCE_SEA\nreturn 0.0;\n#else\nreturn elevation(apos);\n#endif\n}\n#endif\nout vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;\n#ifdef RENDER_LINE_TRIM_OFFSET\nout highp vec3 v_uv;\n#endif\n#ifdef ELEVATED_ROADS\nout highp float v_road_z_offset;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;\n#endif\n#pragma mapbox: define mediump float blur\n#pragma mapbox: define mediump float opacity\n#pragma mapbox: define mediump float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define mediump float floorwidth\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define mediump float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize mediump float blur\n#pragma mapbox: initialize mediump float opacity\n#pragma mapbox: initialize mediump float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize mediump float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize mediump float pixel_ratio\nfloat a_z_offset;\n#if defined(ELEVATED) || defined(ELEVATED_ROADS)\na_z_offset=a_z_offset_width.x;\n#endif\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;\n#ifdef ELEVATED_ROADS\nv_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;\n#else\n#ifdef ELEVATED\nvec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;\n#ifdef CROSS_SLOPE_VERTICAL\nfloat top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);\n#else\n#ifdef CROSS_SLOPE_HORIZONTAL\nfloat ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;\n#else\nfloat ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;\n#endif\n#endif\ngl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);\n#else\ngl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);\n#endif\n#endif\n#ifdef ELEVATED_ROADS\n#ifdef RENDER_SHADOWS\nvec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;\n#ifdef NORMAL_OFFSET\nvec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;\n#endif\n#endif\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));\n#else\nv_gamma_scale=1.0;\n#endif\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);\n#ifdef LINE_JOIN_NONE\nv_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n#ifdef INDICATOR_CUTOUT\nv_z_offset=a_z_offset;\n#endif\n}'),raster:Vr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_raster_array.glsl"\nuniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;\n#ifdef PROJECTION_GLOBE_VIEW\nin float v_split_fade;\n#endif\nuniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;\n#ifndef RASTER_ARRAY\nuniform highp sampler2D u_image0;uniform sampler2D u_image1;\n#endif\n#ifdef RASTER_COLOR\nuniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;\n#endif\nvoid main() {vec4 color0,color1,color;vec2 value;\n#ifdef RASTER_COLOR\n#ifdef RASTER_ARRAY\n#ifdef RASTER_ARRAY_LINEAR\nvalue=mix(\nraTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t\n);\n#else\nvalue=mix(\nraTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t\n);\n#endif\nif (value.y > 0.0) value.x/=value.y;\n#else\ncolor=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);\n#endif\ncolor=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;\n#else\ncolor0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);\n#endif\ncolor.a*=u_opacity;\n#ifdef GLOBE_POLES\ncolor.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);\n#endif\nvec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;\n#endif\n#ifdef FOG\nhighp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));\n#endif\nglFragColor=vec4(out_color*color.a,color.a);\n#ifdef PROJECTION_GLOBE_VIEW\nglFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));\n#endif\n#ifdef RENDER_CUTOFF\nglFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;\n#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8\n#ifdef GLOBE_POLES\nin vec3 a_globe_pos;in vec2 a_uv;\n#else\nin vec2 a_pos;in vec2 a_texture_pos;\n#endif\nout vec2 v_pos0;out vec2 v_pos1;out float v_depth;\n#ifdef PROJECTION_GLOBE_VIEW\nout float v_split_fade;\n#endif\nvoid main() {vec2 uv;\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);\n#endif\n#else\nfloat w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    \nv_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n#else\ngl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n#endif\n#endif\nv_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;\n#ifdef RENDER_CUTOFF\nv_depth=gl_Position.z;\n#endif\n}'),rasterParticle:Vr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;\n#endif\n#ifdef FOG\nhighp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));\n#endif\nglFragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;\n#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8\nin vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n#else\nuv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n#endif\nv_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}'),rasterParticleDraw:Vr("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",'#include "_prelude_raster_particle.glsl"\nin float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(\nmod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}'),rasterParticleTexture:Vr("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Vr('#include "_prelude_raster_particle.glsl"\nuniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(\nlinearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)\n);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}',"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:Vr('#include "_prelude_lighting.glsl"\n#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;\n#ifdef ICON_TRANSITION\nuniform float u_icon_transition;\n#endif\n#ifdef COLOR_ADJUSTMENT\nuniform mat4 u_color_adj_mat;\n#endif\n#ifdef INDICATOR_CUTOUT\nin highp float v_z_offset;\n#endif\nin vec2 v_tex_a;\n#ifdef ICON_TRANSITION\nin vec2 v_tex_b;\n#endif\nin float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;\n#ifdef RENDER_TEXT_AND_SYMBOL\nin float is_sdf;in vec2 v_tex_a_icon;\n#endif\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nvec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];\n#ifdef RENDER_TEXT_AND_SYMBOL\nif (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nreturn;}\n#endif\n#ifdef RENDER_SDF\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;\n#else\n#ifdef ICON_TRANSITION\nvec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);\n#else\nout_color=texture(u_texture,v_tex_a);\n#endif\n#ifdef COLOR_ADJUSTMENT\nout_color=u_color_adj_mat*out_color;\n#endif\n#endif\nout_color*=opacity*fade_opacity;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,emissive_strength);\n#endif\n#ifdef INDICATOR_CUTOUT\nout_color=applyCutout(out_color,v_z_offset);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\nin vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;\n#ifdef Z_OFFSET\nin float a_auto_z_offset;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_globe_anchor;in vec3 a_globe_normal;\n#endif\n#ifdef ICON_TRANSITION\nin vec2 a_texb;\n#endif\n#ifdef OCCLUSION_QUERIES\nin float a_occlusion_query_opacity;\n#endif\n#ifdef INDICATOR_CUTOUT\nout highp float v_z_offset;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nout vec2 v_tex_a;\n#ifdef ICON_TRANSITION\nout vec2 v_tex_b;\n#endif\nout float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;\n#ifdef RENDER_TEXT_AND_SYMBOL\nout float is_sdf;out vec2 v_tex_a_icon;\n#endif\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\n#pragma mapbox: define lowp float occlusion_opacity\n#pragma mapbox: define lowp float z_offset\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\n#pragma mapbox: initialize lowp float occlusion_opacity\n#pragma mapbox: initialize lowp float z_offset\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);\n#ifdef Z_OFFSET\ne+=a_auto_z_offset;\n#endif\nvec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;\n#endif\nvec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\n#ifdef PROJECTED_POS_ON_VIEWPORT\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);\n#else\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    \n#endif\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\n#ifdef Z_OFFSET\nz+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;\n#else\nz+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;\n#endif\nfloat occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));\n#ifdef DEPTH_OCCLUSION\nfloat depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;\n#endif\n#ifdef OCCLUSION_QUERIES\nfloat occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;\n#endif\nfloat alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);\n#endif\nfloat gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;\n#ifdef RENDER_TEXT_AND_SYMBOL\nis_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;\n#endif\n#ifdef ICON_TRANSITION\nv_tex_b=a_texb/u_texsize;\n#endif\n#ifdef INDICATOR_CUTOUT\nv_z_offset=e;\n#endif\n}'),terrainRaster:Vr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image0;in vec2 v_pos0;\n#ifdef FOG\nin float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nin vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;\n#endif\nuniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;\n#ifdef LIGHTING_3D_MODE\nconst vec3 normal=vec3(0.0,0.0,1.0);\n#ifdef RENDER_SHADOWS\nfloat cutoffOpacity=1.0;\n#ifdef RENDER_CUTOFF\ncutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);\n#endif\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\nvec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;\n#else\nfloat lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));\n#endif\n#else\nfloat lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\ncolor.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;\n#endif\n#endif\n#else\ncolor=image_color;\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;\n#ifdef FOG\nout float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;\n#endif\nvoid main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);\n#endif\n}'),terrainDepth:Vr("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",'#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}'),skybox:Vr('#include "_prelude_fog.fragment.glsl"\nin lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}',Ar),skyboxGradient:Vr('#include "_prelude_fog.fragment.glsl"\nin highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;glFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}',Ar),skyboxCapture:Vr("\nin highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}","in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Vr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nhighp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);\n#ifdef LIGHTING_3D_MODE\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\nraster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);\n#else\nraster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#endif\n#else\ncolor=vec4(raster.rgb*antialias,raster.a*antialias);\n#endif\n#else\ncolor=texture(u_image0,v_pos0);\n#ifdef LIGHTING_3D_MODE\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\ncolor=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;\n#else\ncolor=apply_lighting_ground(color);\n#endif\n#endif\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ncolor*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nin vec3 a_globe_pos;in vec2 a_uv;\n#else\nin vec2 a_pos;\n#endif\nout vec2 v_pos0;void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);globe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}'),globeAtmosphere:Vr('#include "_prelude_fog.fragment.glsl"\nuniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {\n#ifdef ALPHA_PASS\nglFragColor=vec4(0,0,0,0);return;\n#else\n#ifdef NATIVE\nglFragColor=vec4(1,1,1,1);\n#else\nglFragColor=vec4(0,0,0,1);\n#endif\nreturn;\n#endif\n}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;\n#ifdef ALPHA_PASS\nfloat a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);\n#else\nvec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);\n#endif\n}',"in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}"),model:Vr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;\n#ifdef RENDER_SHADOWS\nin highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;\n#endif\n#ifdef OCCLUSION_TEXTURE_TRANSFORM\nuniform vec4 u_occlusionTextureTransform;\n#endif\n#pragma mapbox: define-attribute highp vec3 normal_3f\n#pragma mapbox: define-attribute highp vec3 color_3f\n#pragma mapbox: define-attribute highp vec4 color_4f\n#pragma mapbox: define-attribute highp vec2 uv_2f\n#pragma mapbox: initialize-attribute highp vec3 normal_3f\n#pragma mapbox: initialize-attribute highp vec3 color_3f\n#pragma mapbox: initialize-attribute highp vec4 color_4f\n#pragma mapbox: initialize-attribute highp vec2 uv_2f\n#ifdef HAS_ATTRIBUTE_a_pbr\nin lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;\n#endif\n#ifdef HAS_TEXTURE_u_baseColorTexture\nuniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;\n#endif\n#ifdef HAS_TEXTURE_u_metallicRoughnessTexture\nuniform sampler2D u_metallicRoughnessTexture;\n#endif\n#ifdef HAS_TEXTURE_u_occlusionTexture\nuniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;\n#endif\n#ifdef HAS_TEXTURE_u_normalTexture\nuniform sampler2D u_normalTexture;\n#endif\n#ifdef HAS_TEXTURE_u_emissionTexture\nuniform sampler2D u_emissionTexture;\n#endif\n#ifdef APPLY_LUT_ON_GPU\nuniform highp sampler3D u_lutTexture;\n#endif\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nin highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;\n#ifdef DEPTH_D24\nhighp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}\n#else\nhighp float unpack_depth_rgba(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}\n#endif\nbool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;\n#ifdef DEPTH_D24\nhighp float depth=unpack_depth(texture(u_depthTexture,coord).r);\n#else\nhighp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));\n#endif\nreturn v_depth > depth+0.0005;}\n#endif\n#define saturate(_x) clamp(_x,0.,1.)\nvec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)\n{\n#ifdef LIGHTING_3D_MODE\nvec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;\n#ifdef RENDER_SHADOWS\nlighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);\n#else\nlighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));\n#endif\nreturn apply_lighting(albedo,transformed_normal,lighting_factor);\n#else\nvec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;\n#endif\n}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;\n#ifdef HAS_ATTRIBUTE_a_color_3f\nalbedo*=vec4(color_3f,1.0);\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\n#else\n#ifdef HAS_ATTRIBUTE_a_color_4f\nalbedo*=color_4f;\n#endif\n#endif\n#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)\nvec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}\n#ifdef UNPREMULT_TEXTURE_IN_SHADER\nif(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;\n#endif\nif(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}\n#endif\nvec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);\n#ifdef APPLY_LUT_ON_GPU\ncolor=applyLUT(u_lutTexture,color);\n#endif\nreturn color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {\n#ifdef HAS_TEXTURE_u_normalTexture\nhighp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;\n#else\nreturn mat3(1.0);\n#endif\n}highp vec3 getNormal(){highp vec3 n;\n#ifdef HAS_ATTRIBUTE_a_normal_3f\nn=normalize(normal_3f);\n#else\nhighp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;\n#endif\n#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\nvec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);\n#endif\nreturn n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;\n#ifdef HAS_ATTRIBUTE_a_pbr\nmat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;\n#endif\n#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) \nvec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;\n#endif\nconst float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)\n{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)\n{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)\n{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)\n{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)\n{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)\n{\n#ifdef LIGHTING_3D_MODE\nreturn mat.diffuseColor;\n#else\nreturn mat.diffuseColor/PI;\n#endif\n}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)\n{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)\n{vec3 env_light=vec3(0.65,0.65,0.65);\n#ifdef LIGHTING_3D_MODE\nfloat ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;\n#endif\nvec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)\n{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;\n#ifdef RENDER_SHADOWS\nlighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);\n#else\nlighting_factor=NdotL;\n#endif\nvec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;\n#if !defined(LIGHTING_3D_MODE)\nconst vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);\n#endif\ncolor*=intensityFactor;return color;}void main() {\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nif (isOccluded()) {discard;}\n#endif\nvec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;\n#ifdef LIGHTING_3D_MODE\nlightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;\n#endif\nvec4 finalColor;\n#ifdef DIFFUSE_SHADED\nvec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);\n#ifdef HAS_TEXTURE_u_occlusionTexture\nfloat ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;\n#endif\nfinalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;\n#else\nMaterial mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;\n#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\n#ifdef OCCLUSION_TEXTURE_TRANSFORM\nvec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;\n#else\nvec2 uv=uv_2f;\n#endif\nao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;\n#endif\nvec4 emissive=u_emissiveFactor;\n#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\nemissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);\n#endif\n#ifdef APPLY_LUT_ON_GPU\nfloat emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;\n#endif\ncolor+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;\n#ifdef HAS_ATTRIBUTE_a_pbr\nfloat resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;\n#ifdef APPLY_LUT_ON_GPU\ncolor_mix=applyLUT(u_lutTexture,color_mix);\n#endif\ncolor=mix(color,color_mix,min(1.0,resEmission));\n#ifdef HAS_ATTRIBUTE_a_color_4f\nfloat distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);\n#endif\n#endif\nvec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);\n#endif\n#ifdef FOG\nfinalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));\n#endif\n#ifdef RENDER_CUTOFF\nfinalColor*=v_cutoff_opacity;\n#endif\n#ifdef INDICATOR_CUTOUT\nfinalColor=applyCutout(finalColor,v_position_height.w);\n#endif\nglFragColor=finalColor;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\nin vec3 a_pos_3f;\n#pragma mapbox: define-attribute highp vec3 normal_3f\n#pragma mapbox: define-attribute highp vec2 uv_2f\n#pragma mapbox: define-attribute highp vec3 color_3f\n#pragma mapbox: define-attribute highp vec4 color_4f\n#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr\n#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength\nuniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;\n#ifdef INSTANCED_ARRAYS\nin vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;\n#else\nuniform highp mat4 u_normal_matrix;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;\n#endif\nout vec4 v_position_height;out lowp vec4 v_color_mix;\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nout highp float v_depth;\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\nout lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;\n#endif\nvec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {\n#pragma mapbox: initialize-attribute highp vec3 normal_3f\n#pragma mapbox: initialize-attribute highp vec2 uv_2f\n#pragma mapbox: initialize-attribute highp vec3 color_3f\n#pragma mapbox: initialize-attribute highp vec4 color_4f\n#pragma mapbox: initialize-attribute-custom highp vec4 pbr\n#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength\nhighp mat4 normal_matrix;\n#ifdef INSTANCED_ARRAYS\nnormal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);\n#else\nnormal_matrix=u_normal_matrix;\n#endif\nvec3 local_pos;mat3 rs;\n#ifdef MODEL_POSITION_ON_GPU\nvec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;\n#else\nlocal_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);\n#endif\nv_position_height.w=a_pos_3f.z;\n#ifdef HAS_ATTRIBUTE_a_pbr\nvec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(local_pos);\n#endif\n#ifdef RENDER_CUTOFF\nv_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);\n#endif\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef HAS_ATTRIBUTE_a_normal_3f\n#ifdef MODEL_POSITION_ON_GPU\nfloat x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);\n#else\nnormal_3f=vec3(normal_matrix*vec4(normal_3f,0));\n#endif\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\n#ifdef HAS_ATTRIBUTE_a_color_4f\nv_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);\n#ifdef NORMAL_OFFSET\n#ifdef HAS_ATTRIBUTE_a_normal_3f\n#ifdef MODEL_POSITION_ON_GPU\nvec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();\n#else\nvec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();\n#endif\n#endif\n#endif\nv_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;\n#endif\n}'),modelDepth:Vr("in highp float v_depth;void main() {\n#ifndef DEPTH_TEXTURE\nglFragColor=pack_depth(v_depth);\n#endif\n}","in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;\n#ifdef MODEL_POSITION_ON_GPU\n#ifdef INSTANCED_ARRAYS\nin vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;\n#else\nuniform highp mat4 u_instance;\n#endif\nuniform highp mat4 u_node_matrix;\n#endif\nvoid main() {\n#ifdef MODEL_POSITION_ON_GPU\nhighp mat4 instance;\n#ifdef INSTANCED_ARRAYS\ninstance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);\n#else\ninstance=u_instance;\n#endif\nvec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);\n#else\ngl_Position=u_matrix*vec4(a_pos_3f,1);\n#endif\nv_depth=gl_Position.z/gl_Position.w;}"),stars:Vr("in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)\n{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}","\nin vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}"),snowParticle:Vr("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}","\nin highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; \nuniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; \nuniform float u_horizontalOscillationRate; \nuniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+\nlocalY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}"),rainParticle:Vr("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}","\nin highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; \nuniform float u_velocity; \nuniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; \npos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+\nlocalY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}"),vignette:Vr("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:Vr("uniform vec4 u_color;void main() {glFragColor=u_color;}",'#include "_prelude_terrain.vertex.glsl"\nin highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;\n#ifdef TERRAIN\nfloat e=elevation(world_pos.xy);world_pos.z+=e;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}')};function jr(e,t){const i=e.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let r of i)if(r=r.trim(),"#"===r[0]&&r.includes("if")&&!r.includes("endif")){r=r.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const e=r.split(" ");for(const i of e)t.includes(i)||t.push(i)}}function Vr(e,t){const i=/#include\s+"([^"]+)"/g,r=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let n=t.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);n&&(n=n.map((e=>{const t=e.split(" ");return t[t.length-1]})),n=[...new Set(n)]);const o={},s=[],a=[];if(e=e.replace(i,((e,t)=>(a.push(t),""))),(t=t.replace(i,((e,t)=>(s.push(t),"")))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let l=[...Rr];jr(e,l),jr(t,l);for(const c of[...s,...a])zr[c]||console.error(`Undefined include: ${c}`),Or[c]||(Or[c]=[],jr(zr[c],Or[c])),l=[...l,...Or[c]];return{fragmentSource:e=e.replace(r,((e,t,i,r,n)=>(o[n]=!0,"define"===t?`\n#ifndef HAS_UNIFORM_u_${n}\nin ${i} ${r} ${n};\n#else\nuniform ${i} ${r} u_${n};\n#endif\n`:"initialize"===t?`\n#ifdef HAS_UNIFORM_u_${n}\n    ${i} ${r} ${n} = u_${n};\n#endif\n`:"define-attribute"===t?`\n#ifdef HAS_ATTRIBUTE_a_${n}\n    in ${i} ${r} ${n};\n#endif\n`:"initialize-attribute"===t?"":void 0))),vertexSource:t=t.replace(r,((e,t,i,r,n)=>{const s="float"===r?"vec2":r,a=n.match(/color/)?"color":s;return"define-attribute-vertex-shader-only"===t?`\n#ifdef HAS_ATTRIBUTE_a_${n}\nin ${i} ${r} a_${n};\n#endif\n`:o[n]?"define"===t?`\n#ifndef HAS_UNIFORM_u_${n}\nuniform lowp float u_${n}_t;\nin ${i} ${s} a_${n};\nout ${i} ${r} ${n};\n#else\nuniform ${i} ${r} u_${n};\n#endif\n`:"initialize"===t?"vec4"===a?`\n#ifndef HAS_UNIFORM_u_${n}\n    ${n} = a_${n};\n#else\n    ${i} ${r} ${n} = u_${n};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${n}\n    ${n} = unpack_mix_${a}(a_${n}, u_${n}_t);\n#else\n    ${i} ${r} ${n} = u_${n};\n#endif\n`:"define-attribute"===t?`\n#ifdef HAS_ATTRIBUTE_a_${n}\n    in ${i} ${r} a_${n};\n    out ${i} ${r} ${n};\n#endif\n`:"initialize-attribute"===t?`\n#ifdef HAS_ATTRIBUTE_a_${n}\n    ${n} = a_${n};\n#endif\n`:void 0:"define"===t?`\n#ifndef HAS_UNIFORM_u_${n}\nuniform lowp float u_${n}_t;\nin ${i} ${s} a_${n};\n#else\nuniform ${i} ${r} u_${n};\n#endif\n`:"define-instanced"===t?"mat4"===a?`\n#ifdef INSTANCED_ARRAYS\nin vec4 a_${n}0;\nin vec4 a_${n}1;\nin vec4 a_${n}2;\nin vec4 a_${n}3;\n#else\nuniform ${i} ${r} u_${n};\n#endif\n`:`\n#ifdef INSTANCED_ARRAYS\nin ${i} ${s} a_${n};\n#else\nuniform ${i} ${r} u_${n};\n#endif\n`:"initialize-attribute-custom"===t?`\n#ifdef HAS_ATTRIBUTE_a_${n}\n    ${i} ${r} ${n} = a_${n};\n#endif\n`:"vec4"===a?`\n#ifndef HAS_UNIFORM_u_${n}\n    ${i} ${r} ${n} = a_${n};\n#else\n    ${i} ${r} ${n} = u_${n};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${n}\n    ${i} ${r} ${n} = unpack_mix_${a}(a_${n}, u_${n}_t);\n#else\n    ${i} ${r} ${n} = u_${n};\n#endif\n`})),staticAttributes:n,usedDefines:l,vertexIncludes:s,fragmentIncludes:a}}class Ur{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(e,t,i,r,n,o,s,a){this.context=e;let l=this.boundPaintVertexBuffers.length!==r.length;for(let u=0;!l&&u<r.length;u++)this.boundPaintVertexBuffers[u]!==r[u]&&(l=!0);let c=this.boundDynamicVertexBuffers.length!==s.length;for(let u=0;!c&&u<s.length;u++)this.boundDynamicVertexBuffers[u]!==s[u]&&(c=!0);if(!this.vao||this.boundProgram!==t||this.boundLayoutVertexBuffer!==i||l||c||this.boundIndexBuffer!==n||this.boundVertexOffset!==o)this.freshBind(t,i,r,n,o,s,a);else{e.bindVertexArrayOES.set(this.vao);for(const i of s)i&&(i.bind(),a&&i.instanceCount&&i.setVertexAttribDivisor(e.gl,t,a));n&&n.dynamicDraw&&n.bind()}}freshBind(e,t,i,r,n,o,s){const a=e.numAttributes,l=this.context,c=l.gl;this.vao&&this.destroy(),this.vao=l.gl.createVertexArray(),l.bindVertexArrayOES.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=t,this.boundPaintVertexBuffers=i,this.boundIndexBuffer=r,this.boundVertexOffset=n,this.boundDynamicVertexBuffers=o,t.enableAttributes(c,e),t.bind(),t.setVertexAttribPointers(c,e,n);for(const u of i)u.enableAttributes(c,e),u.bind(),u.setVertexAttribPointers(c,e,n);for(const u of o)u&&(u.enableAttributes(c,e),u.bind(),u.setVertexAttribPointers(c,e,n),s&&u.instanceCount&&u.setVertexAttribDivisor(c,e,s));r&&r.bind(),l.currentNumAttributes=a}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function Gr(t,i){const r=Math.pow(2,i.canonical.z),n=i.canonical.y;return[new e.aa(0,n/r).toLngLat().lat,new e.aa(0,(n+1)/r).toLngLat().lat]}function Hr(t,i,r,n,o,s,a){const l=t.context,c=l.gl,u=r.hillshadeFBO;if(!u)return;t.prepareDrawTile();const h=t.isTileAffectedByFog(i),d=t.getOrCreateProgram("hillshade",{overrideFog:h});l.activeTexture.set(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,u.colorAttachment.get());const p=((t,i,r,n)=>{const o=r.paint.get("hillshade-shadow-color"),s="none"===r.paint.get("hillshade-shadow-color-use-theme").constantOr("default"),a=r.paint.get("hillshade-highlight-color"),l="none"===r.paint.get("hillshade-highlight-color-use-theme").constantOr("default"),c=r.paint.get("hillshade-accent-color"),u="none"===r.paint.get("hillshade-accent-color-use-theme").constantOr("default"),h=r.paint.get("hillshade-emissive-strength");let d=e.ai(r.paint.get("hillshade-illumination-direction"));if("viewport"===r.paint.get("hillshade-illumination-anchor"))d-=t.transform.angle;else if(t.style&&t.style.enable3dLights()&&t.style.directionalLight){const i=t.style.directionalLight.properties.get("direction"),r=e.cb(i.x,i.y,i.z);d=e.ai(r[1])}const p=!t.options.moving;return{u_matrix:n||t.transform.calculateProjMatrix(i.tileID.toUnwrapped(),p),u_image:0,u_latrange:Gr(0,i.tileID),u_light:[r.paint.get("hillshade-exaggeration"),d],u_shadow:o.toRenderColor(s?null:r.lut),u_highlight:a.toRenderColor(l?null:r.lut),u_emissive_strength:h,u_accent:c.toRenderColor(u?null:r.lut)}})(t,r,n,t.terrain?i.projMatrix:null);t.uploadCommonUniforms(l,d,i.toUnwrapped());const{tileBoundsBuffer:f,tileBoundsIndexBuffer:m,tileBoundsSegments:g}=t.getTileBoundsBuffers(r);d.draw(t,c.TRIANGLES,o,s,a,Gi.disabled,p,n.id,f,m,g)}function Wr(t,i,r){if(!i.needsDEMTextureUpload)return;const n=t.context,o=n.gl;n.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||t.getTileTexture(r.stride);const s=r.getPixels();i.demTexture?i.demTexture.update(s,{premultiply:!1}):i.demTexture=new e.T(n,s,o.R32F,{premultiply:!1}),i.needsDEMTextureUpload=!1}function $r(t,i,r){const n=t.context,o=n.gl;if(!i.dem)return;const s=i.dem;if(n.activeTexture.set(o.TEXTURE1),Wr(t,i,s),!i.demTexture)return;i.demTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE);const a=s.dim;n.activeTexture.set(o.TEXTURE0);let l=i.hillshadeFBO;if(!l){const t=new e.T(n,{width:a,height:a,data:null},o.RGBA8);t.bind(o.LINEAR,o.CLAMP_TO_EDGE),l=i.hillshadeFBO=n.createFramebuffer(a,a,!0,"renderbuffer"),l.colorAttachment.set(t.texture)}n.bindFramebuffer.set(l.framebuffer),n.viewport.set([0,0,a,a]);const{tileBoundsBuffer:c,tileBoundsIndexBuffer:u,tileBoundsSegments:h}=t.getMercatorTileBoundsBuffers(),d=[];t.linearFloatFilteringSupported()&&d.push("TERRAIN_DEM_FLOAT_FORMAT"),t.getOrCreateProgram("hillshadePrepare",{defines:d}).draw(t,o.TRIANGLES,Bi.disabled,ji.disabled,Fi.unblended,Gi.disabled,((t,i)=>{const r=i.stride,n=e.ab.mat4.create();return e.ab.mat4.ortho(n,0,e.ag,-e.ag,0,0,1),e.ab.mat4.translate(n,n,[0,-e.ag,0]),{u_matrix:n,u_image:1,u_dimension:[r,r],u_zoom:t.overscaledZ}})(i.tileID,s),r.id,c,u,h),i.needsHillshadePrepare=!1}class qr{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Xr extends qr{getDefault(){return e.aj.transparent}set(e){const t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Yr extends qr{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Zr extends qr{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class Kr extends qr{getDefault(){return[!0,!0,!0,!0]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Jr extends qr{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class Qr extends qr{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class en extends qr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const t=this.current;(e.func!==t.func||e.ref!==t.ref||e.mask!==t.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class tn extends qr{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class rn extends qr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.current=e,this.dirty=!1}}class nn extends qr{getDefault(){return[0,1]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class on extends qr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this.current=e,this.dirty=!1}}class sn extends qr{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class an extends qr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.BLEND):t.disable(t.BLEND),this.current=e,this.dirty=!1}}class ln extends qr{getDefault(){const e=this.gl;return[e.ONE,e.ZERO,e.ONE,e.ZERO]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.blendFuncSeparate(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class cn extends qr{getDefault(){return e.aj.transparent}set(e){const t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class un extends qr{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(e,e),this.current=e,this.dirty=!1)}}class hn extends qr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this.current=e,this.dirty=!1}}class dn extends qr{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class pn extends qr{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}let fn=class extends qr{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}};class mn extends qr{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class gn extends qr{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class yn extends qr{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class _n extends qr{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindRenderbuffer(t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class vn extends qr{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindTexture(t.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class xn extends qr{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class bn extends qr{getDefault(){return null}set(e){const t=this.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class wn extends qr{getDefault(){return null}set(e){this.gl&&(e!==this.current||this.dirty)&&(this.gl.bindVertexArray(e),this.current=e,this.dirty=!1)}}class Sn extends qr{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class Tn extends qr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class Mn extends qr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class An extends qr{constructor(e,t){super(e),this.context=e,this.parent=t}getDefault(){return null}}class Cn extends An{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class En extends An{attachment(){return this.gl.DEPTH_ATTACHMENT}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,this.attachment(),t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Pn extends An{attachment(){return this.gl.DEPTH_ATTACHMENT}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferTexture2D(t.FRAMEBUFFER,this.attachment(),t.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class kn extends En{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const In=(e,t,i)=>({u_matrix:e,u_image0:0,u_skirt_height:t,u_ground_shadow_factor:i}),Dn=(e,t,i,r,n,o,s,a,l,c,u,h,d,p,f,m)=>({u_proj_matrix:Float32Array.from(e),u_globe_matrix:t,u_normalize_matrix:Float32Array.from(r),u_merc_matrix:i,u_zoom_transition:n,u_merc_center:o,u_image0:0,u_frustum_tl:s,u_frustum_tr:a,u_frustum_br:l,u_frustum_bl:c,u_globe_pos:u,u_globe_radius:h,u_viewport:d,u_grid_matrix:m?Float32Array.from(m):new Float32Array(9),u_skirt_height:p,u_far_z_cutoff:f});function Ln(e,t){return null!=e&&null!=t&&!(!e.hasData()||!t.hasData())&&null!=e.demTexture&&null!=t.demTexture&&e.tileID.key!==t.tileID.key}const Rn=new class{constructor(){this.operations={}}newMorphing(e,t,i,r,n){if(e in this.operations){const t=this.operations[e];t.to.tileID.key!==i.tileID.key&&(t.queued=i)}else this.operations[e]={startTime:r,phase:0,duration:n,from:t,to:i,queued:null}}getMorphValuesForProxy(e){if(!(e in this.operations))return null;const t=this.operations[e];return{from:t.from,to:t.to,phase:t.phase}}update(e){for(const t in this.operations){const i=this.operations[t];for(i.phase=(e-i.startTime)/i.duration;i.phase>=1||!this._validOp(i);)if(!this._nextOp(i,e)){delete this.operations[t];break}}}_nextOp(e,t){return!!e.queued&&(e.from=e.to,e.to=e.queued,e.queued=null,e.phase=0,e.startTime=t,!0)}_validOp(e){return e.from.hasData()&&e.to.hasData()}},zn={0:null,1:"TERRAIN_VERTEX_MORPHING"};function On(e,t,i){if(0===t)return 0;const r=t<1&&514===i?.25/t:1;return 6*Math.pow(1.5,22-e)*Math.max(t,1)*r}function Fn(e,t){const i=1<<e.z;return!t&&(0===e.x||e.x===i-1)||0===e.y||e.y===i-1}const Bn=e=>({u_matrix:e});function Nn(t,i,r,n,o){if(o>0){const s=e.q.now(),a=(s-t.timeAdded)/o,l=i?(s-i.timeAdded)/o:-1,c=r.getSource(),u=n.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom}),h=!i||Math.abs(i.tileID.overscaledZ-u)>Math.abs(t.tileID.overscaledZ-u),d=h&&t.refreshedUponExpiration?1:e.aw(h?a:1-l,0,1);return t.refreshedUponExpiration&&a>=1&&(t.refreshedUponExpiration=!1),i?{opacity:1,mix:1-d}:{opacity:d,mix:0}}return{opacity:1,mix:0}}class jn extends Mt{constructor(t){const i={type:"raster-dem",maxzoom:t.transform.maxZoom},r=new e.D(e.ci(),null),n=ot("mock-dem",i,r,t.style);super("mock-dem",n,!1),n.setEventedParent(this),this._sourceLoaded=!0}_loadTile(e,t){e.state="loaded",t(null)}}class Vn extends Mt{constructor(t){const i=ot("proxy",{type:"geojson",maxzoom:t.transform.maxZoom},new e.D(e.ci(),null),t.style);super("proxy",i,!1),i.setEventedParent(this),this.map=this.getSource().map=t,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(e,t,i){if(e.freezeTileCoverage)return;this.transform=e;const r=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce(((t,i)=>{if(t[i.key]="",!this._tiles[i.key]){const t=new bt(i,this._source.tileSize*i.overscaleFactor(),e.tileZoom);t.state="loaded",this._tiles[i.key]=t}return t}),{});for(const n in this._tiles)n in r||(this.freeFBO(n),this._tiles[n].unloadVectorData(),delete this._tiles[n])}freeFBO(e){const t=this.proxyCachedFBO[e];if(void 0!==t){const i=Object.values(t);this.renderCachePool.push(...i),delete this.proxyCachedFBO[e]}}deallocRenderCache(){this.renderCache.forEach((e=>e.fb.destroy())),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Un extends e.aG{constructor(e,t,i){super(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y),this.proxyTileKey=t,this.projMatrix=i}}class Gn extends e.cJ{constructor(t,i){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},t.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},(()=>{this._style.map.triggerRepaint()})),t.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},(()=>{this._style.map.triggerRepaint()})),t.tp.registerButton(["Terrain"],"Invalidate Render Cache",(()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()})),this.painter=t,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[r,n,o]=function(){const t=new e.b4,i=new e.aU,r=131;t.reserve(17161),i.reserve(33800);const n=e.ag/128,o=e.ag+n/2,s=o+n;for(let l=-n;l<s;l+=n)for(let i=-n;i<s;i+=n){const r=i<0||i>o||l<0||l>o?24575:0,n=e.aw(Math.round(i),0,e.ag),s=e.aw(Math.round(l),0,e.ag);t.emplaceBack(n+r,s)}const a=(e,t)=>{const n=t*r+e;i.emplaceBack(n+1,n,n+r),i.emplaceBack(n+r,n+r+1,n+1)};for(let e=1;e<129;e++)for(let t=1;t<129;t++)a(t,e);return[0,129].forEach((e=>{for(let t=0;t<130;t++)a(t,e),a(e,t)})),[t,i,32768]}(),s=t.context;this.gridBuffer=s.createVertexBuffer(r,e.b6.members),this.gridIndexBuffer=s.createIndexBuffer(n),this.gridSegments=e.b7.simpleSegment(0,0,r.length,n.length),this.gridNoSkirtSegments=e.b7.simpleSegment(0,0,r.length,o),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Vn(i.map),this.orthoMatrix=e.ab.mat4.create(),e.ab.mat4.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,e.ag,0,e.ag,0,1);const a=s.gl;this._overlapStencilMode=new ji({func:a.GEQUAL,mask:255},0,255,a.KEEP,a.KEEP,a.REPLACE),this._previousZoom=t.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=i,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new jn(i.map),this._pendingGroundEffectLayers=[]}set style(e){e.on("data",this._onStyleDataEvent.bind(this)),this._style=e,this._style.map.on("moveend",(()=>{this._clearLineLayersFromRenderCache()}))}update(t,i,r){if(t&&t.terrain){this._style!==t&&(this.style=t,this._evaluationZoom=void 0);const n=t.terrain.properties,o=0===t.terrain.drapeRenderMode,s=t.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=e.q.now();const a=t.terrain&&t.terrain.scope,l=n.get("source"),c=o?this._mockSourceCache:t.getSourceCache(l,a);if(!c)return void e.w(`Couldn't find terrain source "${l}".`);if(this.sourceCache=c,this._attenuationRange=t.terrain.getAttenuationRange(),this._exaggeration=s?this.calculateExaggeration(i):n.get("exaggeration"),!i.projection.requiresDraping&&s&&0===this._exaggeration)return void this._disable();this.enabled=!0;const u=()=>{this.sourceCache.used&&e.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const t=this.getScaledDemTileSize();this.sourceCache.update(i,t,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,u(),this._initializing=!0),u(),i.updateElevation(!0,r),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(i),this._emptyDEMTextureDirty=!0,this._previousZoom=i.zoom}else this._disable()}calculateExaggeration(t){if(this._attenuationRange&&t.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(t.zoom);const i=this._previousCameraAltitude,r=t.getFreeCameraOptions().position.z/t.pixelsPerMeter*t.worldSize;this._previousCameraAltitude=r;const n=null!=i?r-i:Number.MAX_VALUE;if(Math.abs(n)<2)return this._exaggeration;const o=t.zoom,s=this._style.terrain;if(!this._previousUpdateTimestamp)return s.getExaggeration(o);let a=o-this._previousZoom;const l=this._previousUpdateTimestamp;let c=o;null!=this._evaluationZoom&&(c=this._evaluationZoom,Math.abs(o-c)>.5&&(a=.5*(o-c+a)),a*n<0&&(c+=a)),this._evaluationZoom=c;const u=s.getExaggeration(c),h=u===s.getExaggeration(Math.max(0,c-.1));if(h&&Math.abs(u-this._exaggeration)<.01)return u;let d=Math.min(.1,.00375*(this._updateTimestamp-l));return(h||u<.1||Math.abs(a)<1e-4)&&(d=Math.min(.2,4*d)),e.af(this._exaggeration,u,d)}resetTileLookupCache(e){this._findCoveringTileCache[e]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(e){e.coord&&"source"===e.dataType?this._clearRenderCacheForTile(e.sourceCacheId,e.coord):"style"===e.dataType&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const e in this._style._mergedSourceCaches)this._style._mergedSourceCaches[e].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach((e=>e.fb.destroy())),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const e=2*this.proxySourceCache.getSource().tileSize;return[e,e]}set useVertexMorphing(e){this._useVertexMorphing=e}updateTileBinding(t){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const i=this.proxySourceCache,r=this.painter.transform;this._initializing&&(this._initializing=0===r._centerAltitude&&-1===this.getAtPointOrZero(e.aa.fromLngLat(r.center),-1),this._emptyDEMTextureDirty=!this._initializing);const n=this.proxyCoords=i.getIds().map((e=>{const t=i.getTileByID(e).tileID;return t.projMatrix=r.calculateProjMatrix(t.toUnwrapped()),t}));!function(t,i){const r=i.transform.pointCoordinate(i.transform.getCameraPoint()),n=new e.P(r.x,r.y);t.sort(((t,i)=>{if(i.overscaledZ-t.overscaledZ)return i.overscaledZ-t.overscaledZ;const r=new e.P(t.canonical.x+(1<<t.canonical.z)*t.wrap,t.canonical.y),o=new e.P(i.canonical.x+(1<<i.canonical.z)*i.wrap,i.canonical.y),s=n.mult(1<<t.canonical.z);return s.x-=.5,s.y-=.5,s.distSqr(r)-s.distSqr(o)}))}(n,this.painter);const o=this.proxyToSource||{};this.proxyToSource={},n.forEach((e=>{this.proxyToSource[e.key]={}})),this.terrainTileForTile={};const s=this._style._mergedSourceCaches;for(const e in s){const i=s[e];if(!i.used)continue;if(i!==this.sourceCache&&this.resetTileLookupCache(i.id),this._setupProxiedCoordsForOrtho(i,t[e],o),i.usedForTerrain)continue;const r=t[e];i.getSource().reparseOverscaled&&this._assignTerrainTiles(r)}this.proxiedCoords[i.id]=n.map((e=>new Un(e,e.key,this.orthoMatrix))),this._assignTerrainTiles(n),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(o),this.renderingToTexture=!1;const a={};this._visibleDemTiles=[];for(const e of this.proxyCoords){const t=this.terrainTileForTile[e.key];if(!t)continue;const i=t.tileID.key;i in a||(this._visibleDemTiles.push(t),a[i]=i)}}_assignTerrainTiles(e){this._initializing||e.forEach((e=>{if(this.terrainTileForTile[e.key])return;const t=this._findTileCoveringTileID(e,this.sourceCache);t&&(this.terrainTileForTile[e.key]=t)}))}_prepareDEMTextures(){const e=this.painter.context,t=e.gl;for(const i in this.terrainTileForTile){const r=this.terrainTileForTile[i],n=r.dem;!n||r.demTexture&&!r.needsDEMTextureUpload||(e.activeTexture.set(t.TEXTURE1),Wr(this.painter,r,n))}}_prepareDemTileUniforms(e,t,i,r){if(!t||null==t.demTexture)return!1;const n=e.tileID.canonical,o=Math.pow(2,t.tileID.canonical.z-n.z),s=r||"";return i[`u_dem_tl${s}`]=[n.x*o%1,n.y*o%1],i[`u_dem_scale${s}`]=o,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let e=0;const t=this._visibleDemTiles.reduce(((t,i)=>{if(!i.dem)return t;const r=i.dem.tree.minimums[0];return r>0&&e++,t+r}),0);return e?t/e:0}_updateEmptyDEMTexture(){const t=this.painter.context,i=t.gl;t.activeTexture.set(i.TEXTURE2);const r=this._getLoadedAreaMinimum(),n=new e.cK({width:1,height:1},new Float32Array([r]));this._emptyDEMTextureDirty=!1;let o=this._emptyDEMTexture;return o?o.update(n,{premultiply:!1}):o=this._emptyDEMTexture=new e.T(t,n,i.R32F,{premultiply:!1}),o}setupElevationDraw(t,i,r){const n=this.painter.context,o=n.gl,s={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};s.u_exaggeration=this.exaggeration();let a=null,l=null,c=1;if(r&&r.morphing&&this._useVertexMorphing){const e=r.morphing.srcDemTile,i=r.morphing.dstDemTile;c=r.morphing.phase,e&&i&&(this._prepareDemTileUniforms(t,e,s,"_prev")&&(l=e),this._prepareDemTileUniforms(t,i,s)&&(a=i))}const u=e=>e&&e.demTexture&&this.painter.linearFloatFilteringSupported()?o.LINEAR:o.NEAREST;let h=null;var d;if(this.enabled?l&&a?(h=a.demTexture,n.activeTexture.set(o.TEXTURE4),l.demTexture.bind(u(l),o.CLAMP_TO_EDGE),s.u_dem_lerp=c):(a=this.terrainTileForTile[t.tileID.key],h=this._prepareDemTileUniforms(t,a,s)?a.demTexture:this.emptyDEMTexture):h=this.emptyDEMTexture,n.activeTexture.set(o.TEXTURE2),h&&(s.u_dem_size=1===(d=h).size[0]?1:d.size[0]-2,h.bind(u(a),o.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(r&&r.useDepthForOcclusion,i,s),r&&r.useMeterToDem&&a){const t=(1<<a.tileID.canonical.z)*e.bH(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;s.u_meter_to_dem=t}if(r&&r.labelPlaneMatrixInv&&(s.u_label_plane_matrix_inv=r.labelPlaneMatrixInv),i.setTerrainUniformValues(n,s),"globe"===this.painter.transform.projection.name){const e=this.globeUniformValues(this.painter.transform,t.tileID.canonical,r&&r.useDenormalizedUpVectorScale);i.setGlobeUniformValues(n,e)}}globeUniformValues(t,i,r){const n=t.projection;return{u_tile_tl_up:n.upVector(i,0,0),u_tile_tr_up:n.upVector(i,e.ag,0),u_tile_br_up:n.upVector(i,e.ag,e.ag),u_tile_bl_up:n.upVector(i,0,e.ag),u_tile_up_scale:r?e.cL(1):n.upVectorScale(i,t.center.lat,t.worldSize).metersToTile}}renderToBackBuffer(t){const i=this.painter,r=this.painter.context;0!==t.length&&(r.bindFramebuffer.set(null),r.viewport.set([0,0,i.width,i.height]),i.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(t,i,r,n,o){if("globe"===t.transform.projection.name)!function(t,i,r,n,o){const s=t.context,a=s.gl;let l,c;const u=t.transform,h=e.cC(t,s,u),d=(e,i)=>{if(c===i)return;const r=[zn[i],"PROJECTION_GLOBE_VIEW"];h&&r.push("CUSTOM_ANTIALIASING");const n=t.isTileAffectedByFog(e);l=t.getOrCreateProgram("globeRaster",{defines:r,overrideFog:n}),c=i},p=t.colorModeForRenderPass(),f=new Bi(a.LEQUAL,Bi.ReadWrite,t.depthRangeFor3D);Rn.update(o);const m=e.cD(u),g=[e.at(u.center.lng),e.aA(u.center.lat)],y=t.globeSharedBuffers,_=[u.width*e.q.devicePixelRatio,u.height*e.q.devicePixelRatio],v=Float32Array.from(u.globeMatrix),x={useDenormalizedUpVectorScale:!0};{const u=t.transform,h=On(u.zoom,i.exaggeration(),i.sourceCache._source.tileSize);c=-1;const b=a.TRIANGLES;for(const c of n){const n=r.getTile(c),w=ji.disabled,S=i.prevTerrainTileForTile[c.key],T=i.terrainTileForTile[c.key];Ln(S,T)&&Rn.newMorphing(c.key,S,T,o,250),s.activeTexture.set(a.TEXTURE0),n.texture&&n.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE);const M=Rn.getMorphValuesForProxy(c.key),A=M?1:0;M&&e.J(x,{morphing:{srcDemTile:M.from,dstDemTile:M.to,phase:e.cB(M.phase)}});const C=e.cE(c.canonical),E=e.cF(C.getCenter().lat),P=e.cG(c.canonical,C,E,u.worldSize/u._pixelsPerMercatorPixel),k=e.bb(e.cH(c.canonical)),I=Dn(u.expandedFarZProjMatrix,v,m,k,e.ae(u.zoom),g,u.frustumCorners.TL,u.frustumCorners.TR,u.frustumCorners.BR,u.frustumCorners.BL,u.globeCenterInViewSpace,u.globeRadius,_,h,u._farZ,P);if(d(c,A),l&&(i.setupElevationDraw(n,l,x),t.uploadCommonUniforms(s,l,c.toUnwrapped()),y)){const[e,i,r]=y.getGridBuffers(E,0!==h);l.draw(t,b,f,w,p,Gi.backCCW,I,"globe_raster",e,i,r)}}}if(y&&(t.renderDefaultNorthPole||t.renderDefaultSouthPole)){const o=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];h&&o.push("CUSTOM_ANTIALIASING"),l=t.getOrCreateProgram("globeRaster",{defines:o});for(const c of n){const{x:n,y:o,z:h}=c.canonical,d=0===o,m=o===(1<<h)-1,[v,b,w,S]=y.getPoleBuffers(h,!1);if(S&&(d||m)){const o=r.getTile(c);s.activeTexture.set(a.TEXTURE0),o.texture&&o.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE);let y=e.cI(h,n,u);const T=e.bb(e.cH(c.canonical)),M=(e,i)=>e.draw(t,a.TRIANGLES,f,ji.disabled,p,Gi.disabled,Dn(u.expandedFarZProjMatrix,y,y,T,0,g,u.frustumCorners.TL,u.frustumCorners.TR,u.frustumCorners.BR,u.frustumCorners.BL,u.globeCenterInViewSpace,u.globeRadius,_,0,u._farZ),"globe_pole_raster",i,w,S);i.setupElevationDraw(o,l,x),t.uploadCommonUniforms(s,l,c.toUnwrapped()),d&&t.renderDefaultNorthPole&&M(l,v),m&&t.renderDefaultSouthPole&&(y=e.ab.mat4.scale(e.ab.mat4.create(),y,[1,-1,1]),M(l,b))}}}}(t,i,r,n,o);else{const s=t.context,a=s.gl;let l,c;const u=t.shadowRenderer,h=er(t,t.longestCutoffRange),d=e=>{if(c===e)return;const i=[];i.push(zn[e]),h.shouldRenderCutoff&&i.push("RENDER_CUTOFF"),u&&(i.push("RENDER_SHADOWS","DEPTH_TEXTURE"),u.useNormalOffset&&i.push("NORMAL_OFFSET")),l=t.getOrCreateProgram("terrainRaster",{defines:i}),c=e},p=t.colorModeForRenderPass(),f=new Bi(a.LEQUAL,Bi.ReadWrite,t.depthRangeFor3D);Rn.update(o);const m=t.transform,g=On(m.zoom,i.exaggeration(),i.sourceCache._source.tileSize);let y=[0,0,0];if(u){const e=t.style.directionalLight,i=t.style.ambientLight;e&&i&&(y=ar(t.style,e,i))}{c=-1;const _=a.TRIANGLES,[v,x]=[i.gridIndexBuffer,i.gridSegments];for(const c of n){const n=r.getTile(c),b=ji.disabled,w=i.prevTerrainTileForTile[c.key],S=i.terrainTileForTile[c.key];Ln(w,S)&&Rn.newMorphing(c.key,w,S,o,250),s.activeTexture.set(a.TEXTURE0),n.texture&&n.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE);const T=Rn.getMorphValuesForProxy(c.key),M=T?1:0;let A;T&&(A={morphing:{srcDemTile:T.from,dstDemTile:T.to,phase:e.cB(T.phase)}});const C=In(c.projMatrix,Fn(c.canonical,m.renderWorldCopies)?g/10:g,y);if(d(M),!l)continue;i.setupElevationDraw(n,l,A);const E=c.toUnwrapped();u&&u.setupShadows(E,l),t.uploadCommonUniforms(s,l,E,null,h),l.draw(t,_,f,b,p,Gi.backCCW,C,"terrain_raster",i.gridBuffer,v,x)}}}}(i,this,this.proxySourceCache,t,this._updateTimestamp),this.renderingToTexture=!0,i.gpuTimingDeferredRenderEnd(),t.splice(0,t.length))}renderBatch(t){if(0===this._drapedRenderBatches.length)return t+1;this.renderingToTexture=!0;const i=this.painter,r=this.painter.context,n=this.proxySourceCache,o=this.proxiedCoords[n.id],s=this._drapedRenderBatches.shift(),a=i.style.order,l=[];let c=0;for(const u of o){const o=n.getTileByID(u.proxyTileKey),h=n.proxyCachedFBO[u.key]?n.proxyCachedFBO[u.key][t]:void 0,d=void 0!==h?n.renderCache[h]:this.pool[c++],p=void 0!==h;if(o.texture=d.tex,p&&!d.dirty){l.push(o.tileID);continue}let f;r.bindFramebuffer.set(d.fb.framebuffer),this.renderedToTile=!1,d.dirty&&(r.clear({color:e.aj.transparent,stencil:0}),d.dirty=!1);for(let e=s.start;e<=s.end;++e){const t=i.style._mergedLayers[a[e]];if(t.isHidden(i.transform.zoom))continue;const n=i.style.getLayerSourceCache(t),o=n?this.proxyToSource[u.key][n.id]:[u];if(!o)continue;const s=o;r.viewport.set([0,0,d.fb.width,d.fb.height]),f!==(n?n.id:null)&&(this._setupStencil(d,o,t,n),f=n?n.id:null),i.renderLayer(i,n,t,s)}if(0===this._drapedRenderBatches.length)for(const e of this._pendingGroundEffectLayers){const t=i.style._mergedLayers[a[e]];if(t.isHidden(i.transform.zoom))continue;const n=i.style.getLayerSourceCache(t),o=n?this.proxyToSource[u.key][n.id]:[u];if(!o)continue;const s=o;r.viewport.set([0,0,d.fb.width,d.fb.height]),f!==(n?n.id:null)&&(this._setupStencil(d,o,t,n),f=n?n.id:null),i.renderLayer(i,n,t,s)}this.renderedToTile?(d.dirty=!0,l.push(o.tileID)):p||--c,5===c&&(c=0,this.renderToBackBuffer(l))}return this.renderToBackBuffer(l),this.renderingToTexture=!1,r.bindFramebuffer.set(null),r.viewport.set([0,0,i.width,i.height]),s.end+1}postRender(){}isLayerOrderingCorrect(e){const t=e.order.length;let i=-1,r=t;for(let n=0;n<t;++n)this._style.isLayerDraped(e._mergedLayers[e.order[n]])?i=Math.max(i,n):r=Math.min(r,n);return r>i}getMinElevationBelowMSL(){let e=0;return this._visibleDemTiles.filter((e=>e.dem)).forEach((t=>{e=Math.min(e,t.dem.tree.minimums[0])})),0===e?e:(e-30)*this._exaggeration}raycast(e,t,i){if(!this._visibleDemTiles)return null;const r=this._visibleDemTiles.filter((e=>e.dem)).map((r=>{const n=r.tileID,o=1<<n.overscaledZ,{x:s,y:a}=n.canonical,l=s/o,c=(s+1)/o,u=a/o,h=(a+1)/o;return{minx:l,miny:u,maxx:c,maxy:h,t:r.dem.tree.raycastRoot(l,u,c,h,e,t,i),tile:r}}));r.sort(((e,t)=>(null!==e.t?e.t:Number.MAX_VALUE)-(null!==t.t?t.t:Number.MAX_VALUE)));for(const n of r){if(null==n.t)return null;const r=n.tile.dem.tree.raycast(n.minx,n.miny,n.maxx,n.maxy,e,t,i);if(null!=r)return r}return null}_createFBO(){const t=this.painter.context,i=t.gl,r=this.drapeBufferSize;t.activeTexture.set(i.TEXTURE0);const n=new e.T(t,{width:r[0],height:r[1],data:null},i.RGBA8);n.bind(i.LINEAR,i.CLAMP_TO_EDGE);const o=t.createFramebuffer(r[0],r[1],!0,null);return o.colorAttachment.set(n.texture),o.depthAttachment=new kn(t,o.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=t.createRenderbuffer(t.gl.DEPTH_STENCIL,r[0],r[1]),this._stencilRef=0,o.depthAttachment.set(this._sharedDepthStencil),t.clear({stencil:0})):o.depthAttachment.set(this._sharedDepthStencil),t.extTextureFilterAnisotropic&&i.texParameterf(i.TEXTURE_2D,t.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.extTextureFilterAnisotropicMax),{fb:o,tex:n,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache)return!0;if(this._style.hasLightTransitions())return!0;for(const e in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[e].hasTransition())return!0;return this._style.order.some((e=>{const t=this._style._mergedLayers[e],i=t.isHidden(this.painter.transform.zoom);return"hillshade"===t.type||"custom"===t.type?!i&&t.shouldRedrape():!i&&t.hasTransition()}))}_clearLineLayersFromRenderCache(){let t=!1;for(const e of this._style.getSources())if(e instanceof tt){t=!0;break}if(!t)return;const i={};for(let r=0;r<this._style.order.length;++r){const t=this._style._mergedLayers[this._style.order[r]],n=this._style.getLayerSourceCache(t);if(n&&!i[n.id]&&!t.isHidden(this.painter.transform.zoom)&&"line"===t.type&&t.widthExpression()instanceof e.a9){i[n.id]=!0;for(const e of this.proxyCoords){const t=this.proxyToSource[e.key][n.id];if(t)for(const e of t)this._clearRenderCacheForTile(n.id,e)}}}}_clearRasterLayersFromRenderCache(){let e=!1;for(const i in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[i]._source instanceof it){e=!0;break}if(!e)return;const t={};for(let i=0;i<this._style.order.length;++i){const e=this._style._mergedLayers[this._style.order[i]],r=this._style.getLayerSourceCache(e);if(!r||t[r.id])continue;if(e.isHidden(this.painter.transform.zoom)||"raster"!==e.type)continue;const n=e.paint.get("raster-fade-duration");for(const t of this.proxyCoords){const e=this.proxyToSource[t.key][r.id];if(e)for(const t of e){const e=Nn(r.getTile(t),r.findLoadedParent(t,0),r,this.painter.transform,n);(1!==e.opacity||0!==e.mix)&&this._clearRenderCacheForTile(r.id,t)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const t=this._style.order,i=t.length;if(0===i)return;const r=[];this._pendingGroundEffectLayers=[];let n,o=0,s=this._style._mergedLayers[t[o]];for(;!this._style.isLayerDraped(s)&&s.isHidden(this.painter.transform.zoom)&&++o<i;)s=this._style._mergedLayers[t[o]];for(;o<i;++o){const e=this._style._mergedLayers[t[o]];e.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(e)?void 0===n&&(n=o):("fill-extrusion"===e.type&&this._pendingGroundEffectLayers.push(o),void 0!==n&&(r.push({start:n,end:o-1}),n=void 0)))}if(void 0!==n&&r.push({start:n,end:o-1}),0!==r.length){const t=r[r.length-1];this._pendingGroundEffectLayers.every((e=>e>t.end))||e.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=r}_setupRenderCache(e){const t=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,t.renderCache.length>t.renderCachePool.length){const e=Object.values(t.proxyCachedFBO);t.proxyCachedFBO={};for(let i=0;i<e.length;++i){const r=Object.values(e[i]);t.renderCachePool.push(...r)}}return}this._clearRasterLayersFromRenderCache();const i=this.proxyCoords,r=this._tilesDirty;for(let o=i.length-1;o>=0;o--){const n=i[o];if(t.getTileByID(n.key),void 0!==t.proxyCachedFBO[n.key]){const i=e[n.key],o=this.proxyToSource[n.key];let s=0;for(const e in o){const t=o[e],n=i[e];if(!n||n.length!==t.length||t.some(((t,i)=>t!==n[i]||r[e]&&r[e].hasOwnProperty(t.key)))){s=-1;break}++s}for(const e in t.proxyCachedFBO[n.key])t.renderCache[t.proxyCachedFBO[n.key][e]].dirty=s<0||s!==Object.values(i).length}}const n=[...this._drapedRenderBatches];n.sort(((e,t)=>t.end-t.start-(e.end-e.start)));for(const o of n)for(const e of i){if(t.proxyCachedFBO[e.key])continue;let i=t.renderCachePool.pop();void 0===i&&t.renderCache.length<50&&(i=t.renderCache.length,t.renderCache.push(this._createFBO())),void 0!==i&&(t.proxyCachedFBO[e.key]={},t.proxyCachedFBO[e.key][o.start]=i,t.renderCache[i].dirty=!0)}this._tilesDirty={}}_setupStencil(e,t,i,r){if(!r||!this._sourceTilesOverlap[r.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const n=this.painter.context,o=n.gl;if(t.length<=1)return void(this._overlapStencilType=!1);let s;if(i.isTileClipped())s=t.length,this._overlapStencilMode.test={func:o.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(t[0].overscaledZ>t[t.length-1].overscaledZ))return void(this._overlapStencilType=!1);s=1,this._overlapStencilMode.test={func:o.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+s>255&&(n.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=s,this._overlapStencilMode.ref=this._stencilRef,i.isTileClipped()&&this._renderTileClippingMasks(t,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(e){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[e.key]),this._overlapStencilMode):ji.disabled}_renderTileClippingMasks(e,t){const i=this.painter,r=this.painter.context,n=r.gl;i._tileClippingMaskIDs={},r.setColorMode(Fi.disabled),r.setDepthMode(Bi.disabled);const o=i.getOrCreateProgram("clippingMask");for(const s of e){const e=i._tileClippingMaskIDs[s.key]=--t;o.draw(i,n.TRIANGLES,Bi.disabled,new ji({func:n.ALWAYS,mask:0},e,255,n.KEEP,n.KEEP,n.REPLACE),Fi.disabled,Gi.disabled,Bn(s.projMatrix),"$clipping",i.tileExtentBuffer,i.quadTriangleIndexBuffer,i.tileExtentSegments)}}pointCoordinate(t){const i=this.painter.transform;if(t.x<0||t.x>i.width||t.y<0||t.y>i.height)return null;const r=[t.x,t.y,1,1];e.ab.vec4.transformMat4(r,r,i.pixelMatrixInverse),e.ab.vec4.scale(r,r,1/r[3]),r[0]/=i.worldSize,r[1]/=i.worldSize;const n=i._camera.position,o=e.bH(1,i.center.lat),s=[n[0],n[1],n[2]/o,0],a=e.ab.vec3.subtract([],r.slice(0,3),s);e.ab.vec3.normalize(a,a);const l=this.raycast(s,a,this._exaggeration);return null!==l&&l?(e.ab.vec3.scaleAndAdd(s,s,a,l),s[3]=s[2],s[2]*=o,s):null}_setupProxiedCoordsForOrtho(t,i,r){if(t.getSource()instanceof e.aJ)return this._setupProxiedCoordsForImageSource(t,i,r);this._findCoveringTileCache[t.id]=this._findCoveringTileCache[t.id]||{};const n=this.proxiedCoords[t.id]=[],o=this.proxyCoords;for(let e=0;e<o.length;e++){const i=o[e],s=this._findTileCoveringTileID(i,t);if(s){const e=this._createProxiedId(i,s,r[i.key]&&r[i.key][t.id]);n.push(e),this.proxyToSource[i.key][t.id]=[e]}}let s=!1;const a=new Set;for(let e=0;e<i.length;e++){const o=t.getTile(i[e]);if(!o||!o.hasData())continue;const l=this._findTileCoveringTileID(o.tileID,this.proxySourceCache);if(l&&l.tileID.canonical.z!==o.tileID.canonical.z){const e=this.proxyToSource[l.tileID.key][t.id],i=this._createProxiedId(l.tileID,o,r[l.tileID.key]&&r[l.tileID.key][t.id]);e?e.splice(e.length-1,0,i):this.proxyToSource[l.tileID.key][t.id]=[i];const c=this.proxyToSource[l.tileID.key][t.id];a.has(c)||a.add(c),n.push(i),s=!0}}if(this._sourceTilesOverlap[t.id]=s,s&&this._debugParams.sortTilesHiZFirst)for(const e of a)e.sort(((e,t)=>t.overscaledZ-e.overscaledZ))}_setupProxiedCoordsForImageSource(t,i,r){if(!t.getSource().loaded())return;const n=this.proxiedCoords[t.id]=[],o=this.proxyCoords,s=t.getSource(),a=s.tileID;if(!a)return;const l=new e.P(a.x,a.y)._div(1<<a.z),c=s.coordinates.map(e.aa.fromLngLat).reduce(((e,t)=>(e.min.x=Math.min(e.min.x,t.x-l.x),e.min.y=Math.min(e.min.y,t.y-l.y),e.max.x=Math.max(e.max.x,t.x-l.x),e.max.y=Math.max(e.max.y,t.y-l.y),e)),{min:new e.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new e.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),u=(t,i)=>{const r=t.wrap+t.canonical.x/(1<<t.canonical.z),n=t.canonical.y/(1<<t.canonical.z),o=e.ag/(1<<t.canonical.z),s=i.wrap+i.canonical.x/(1<<i.canonical.z),a=i.canonical.y/(1<<i.canonical.z);return r+o<s+c.min.x||r>s+c.max.x||n+o<a+c.min.y||n>a+c.max.y};for(let e=0;e<o.length;e++){const s=o[e];for(let e=0;e<i.length;e++){const o=t.getTile(i[e]);if(!o||!o.hasData())continue;if(u(s,o.tileID))continue;const a=this._createProxiedId(s,o,r[s.key]&&r[s.key][t.id]),l=this.proxyToSource[s.key][t.id];l?l.push(a):this.proxyToSource[s.key][t.id]=[a],n.push(a)}}}_createProxiedId(t,i,r){let n=this.orthoMatrix;if(r){const e=r.find((e=>e.key===i.tileID.key));if(e)return e}if(i.tileID.key!==t.key){const r=t.canonical.z-i.tileID.canonical.z;let o,s,a;n=e.ab.mat4.create();const l=i.tileID.wrap-t.wrap<<t.overscaledZ;r>0?(o=e.ag>>r,s=o*((i.tileID.canonical.x<<r)-t.canonical.x+l),a=o*((i.tileID.canonical.y<<r)-t.canonical.y)):(o=e.ag<<-r,s=e.ag*(i.tileID.canonical.x-(t.canonical.x+l<<-r)),a=e.ag*(i.tileID.canonical.y-(t.canonical.y<<-r))),e.ab.mat4.ortho(n,0,o,0,o,0,1),e.ab.mat4.translate(n,n,[s,a,0])}return new Un(i.tileID,t.key,n)}_findTileCoveringTileID(t,i){let r=i.getTile(t);if(r&&r.hasData())return r;const n=this._findCoveringTileCache[i.id],o=n[t.key];if(r=o?i.getTileByID(o):null,r&&r.hasData()||null===o)return r;let s=r?r.tileID:t,a=s.overscaledZ;const l=i.getSource().minzoom,c=[];if(!o){const n=i.getSource().maxzoom;if(t.canonical.z>=n){const r=t.canonical.z-n;i.getSource().reparseOverscaled?(a=Math.max(t.canonical.z+2,i.transform.tileZoom),s=new e.aG(a,t.wrap,n,t.canonical.x>>r,t.canonical.y>>r)):0!==r&&(a=n,s=new e.aG(a,t.wrap,n,t.canonical.x>>r,t.canonical.y>>r))}s.key!==t.key&&(c.push(s.key),r=i.getTile(s))}const u=e=>{c.forEach((t=>{n[t]=e})),c.length=0};for(a-=1;a>=l&&(!r||!r.hasData());a--){r&&u(r.tileID.key);const e=s.calculateScaledKey(a);if(r=i.getTileByID(e),r&&r.hasData())break;const t=n[e];if(null===t)break;void 0===t?c.push(e):r=i.getTileByID(t)}return u(r?r.tileID.key:null),r&&r.hasData()?r:null}findDEMTileFor(e){return this.enabled?this._findTileCoveringTileID(e,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(e,t){let i=this._tilesDirty[e];i||(i=this._tilesDirty[e]={}),i[t.key]=!0}}function Hn(t,i,r){const n=function(t,i,r){const n=e.ab.vec3.dot(i,t),o=e.ab.vec3.dot(r,[.2126,.7152,.0722]),s=(e,t,i)=>(1-i)*e+i*t,a=s(1-.3*Math.min(o,1),1,Math.min(n+1,1));return s(.92,1,Math.asin(e.aw(i[2],-1,1))/Math.PI+.5)*a}(t,[0,0,1],i),o=[0,0,0];e.ab.vec3.scale(o,r.slice(0,3),n);const s=[0,0,0];e.ab.vec3.scale(s,i.slice(0,3),t[2]);const a=[0,0,0];return e.ab.vec3.add(a,o,s),e.cf(a)}const Wn=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],$n=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","model","symbol"];class qn{static cacheKey(e,t,i,r){let n=`${t}${r?r.cacheKey:""}`;for(const o of i)e.usedDefines.includes(o)&&(n+=`/${o}`);return n}constructor(t,i,r,n,o,s){const a=t.gl;this.program=a.createProgram(),this.configuration=n,this.name=i,this.fixedDefines=[...s];const l=n?n.getBinderAttributes():[],c=(r.staticAttributes||[]).concat(l);let u=n?n.defines():[];u=u.concat(s.map((e=>`#define ${e}`)));const h="#version 300 es\n";let d=h+u.concat("precision mediump float;",Br,Fr.fragmentSource).join("\n");for(const e of r.fragmentIncludes)d+=`\n${zr[e]}`;d+=`\n${r.fragmentSource}`;let p=h+u.concat("precision highp float;",Br,Fr.vertexSource).join("\n");for(const e of r.vertexIncludes)p+=`\n${zr[e]}`;this.forceManualRenderingForInstanceIDShaders=t.forceManualRenderingForInstanceIDShaders&&-1!==r.vertexSource.indexOf("gl_InstanceID"),this.forceManualRenderingForInstanceIDShaders&&(p+="\nuniform int u_instanceID;\n"),p+=`\n${r.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(p=p.replaceAll("gl_InstanceID","u_instanceID"));const f=a.createShader(a.FRAGMENT_SHADER);if(a.isContextLost())return void(this.failedToCreate=!0);a.shaderSource(f,d),a.compileShader(f),a.attachShader(this.program,f);const m=a.createShader(a.VERTEX_SHADER);if(a.isContextLost())this.failedToCreate=!0;else{a.shaderSource(m,p),a.compileShader(m),a.attachShader(this.program,m),this.attributes={},this.numAttributes=c.length;for(let e=0;e<this.numAttributes;e++)if(c[e]){const t=c[e].startsWith("a_")?c[e]:`a_${c[e]}`;a.bindAttribLocation(this.program,e,t),this.attributes[t]=e}a.linkProgram(this.program),a.deleteShader(m),a.deleteShader(f),this.fixedUniforms=o(t),this.binderUniforms=n?n.getUniforms(t):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(t=>({u_instanceID:new e.bN(t)}))(t)),(s.includes("TERRAIN")||-1!==i.indexOf("symbol")||-1!==i.indexOf("circle"))&&(this.terrainUniforms=(t=>({u_dem:new e.bN(t),u_dem_prev:new e.bN(t),u_dem_tl:new e.bK(t),u_dem_scale:new e.bM(t),u_dem_tl_prev:new e.bK(t),u_dem_scale_prev:new e.bM(t),u_dem_size:new e.bM(t),u_dem_lerp:new e.bM(t),u_exaggeration:new e.bM(t),u_depth:new e.bN(t),u_depth_size_inv:new e.bK(t),u_depth_range_unpack:new e.bK(t),u_occluder_half_size:new e.bM(t),u_occlusion_depth_offset:new e.bM(t),u_meter_to_dem:new e.bM(t),u_label_plane_matrix_inv:new e.bJ(t)}))(t)),s.includes("GLOBE")&&(this.globeUniforms=(t=>({u_tile_tl_up:new e.bL(t),u_tile_tr_up:new e.bL(t),u_tile_br_up:new e.bL(t),u_tile_bl_up:new e.bL(t),u_tile_up_scale:new e.bM(t)}))(t)),s.includes("FOG")&&(this.fogUniforms=(t=>({u_fog_matrix:new e.bJ(t),u_fog_range:new e.bK(t),u_fog_color:new e.ca(t),u_fog_horizon_blend:new e.bM(t),u_fog_vertical_limit:new e.bK(t),u_fog_temporal_offset:new e.bM(t),u_frustum_tl:new e.bL(t),u_frustum_tr:new e.bL(t),u_frustum_br:new e.bL(t),u_frustum_bl:new e.bL(t),u_globe_pos:new e.bL(t),u_globe_radius:new e.bM(t),u_globe_transition:new e.bM(t),u_is_globe:new e.bN(t),u_viewport:new e.bK(t)}))(t)),s.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(t=>({u_cutoff_params:new e.ca(t)}))(t)),s.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(t=>({u_lighting_ambient_color:new e.bL(t),u_lighting_directional_dir:new e.bL(t),u_lighting_directional_color:new e.bL(t),u_ground_radiance:new e.bL(t)}))(t)),s.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(t=>({u_light_matrix_0:new e.bJ(t),u_light_matrix_1:new e.bJ(t),u_fade_range:new e.bK(t),u_shadow_normal_offset:new e.bL(t),u_shadow_intensity:new e.bM(t),u_shadow_texel_size:new e.bM(t),u_shadow_map_resolution:new e.bM(t),u_shadow_direction:new e.bL(t),u_shadow_bias:new e.bL(t),u_shadowmap_0:new e.bN(t),u_shadowmap_1:new e.bN(t)}))(t))}}setTerrainUniformValues(e,t){if(!this.terrainUniforms)return;const i=this.terrainUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const e in t)i[e]&&i[e].set(this.program,e,t[e])}}setGlobeUniformValues(e,t){if(!this.globeUniforms)return;const i=this.globeUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const e in t)i[e]&&i[e].set(this.program,e,t[e])}}setFogUniformValues(e,t){if(!this.fogUniforms)return;const i=this.fogUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const e in t)i[e].set(this.program,e,t[e])}}setCutoffUniformValues(e,t){if(!this.cutoffUniforms)return;const i=this.cutoffUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const e in t)i[e].set(this.program,e,t[e])}}setLightsUniformValues(e,t){if(!this.lightsUniforms)return;const i=this.lightsUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const e in t)i[e].set(this.program,e,t[e])}}setShadowUniformValues(e,t){if(this.failedToCreate||!this.shadowUniforms)return;const i=this.shadowUniforms;e.program.set(this.program);for(const r in t)i[r].set(this.program,r,t[r])}_drawDebugWireframe(t,i,r,n,o,s,a,l,c,u){const h=t.options.wireframe;if(!1===h.terrain&&!1===h.layers2D&&!1===h.layers3D)return;const d=t.context;if(!(()=>!(!h.terrain||"terrainRaster"!==this.name&&"globeRaster"!==this.name)||!(!h.layers2D||t._terrain&&t._terrain.renderingToTexture||!Wn.includes(this.name))||!(!h.layers3D||!$n.includes(this.name)))())return;const p=d.gl,f=t.wireframeDebugCache.getLinesFromTrianglesBuffer(t.frameCounter,o,d);if(!f)return;const m=[...this.fixedDefines];m.push("DEBUG_WIREFRAME");const g=t.getOrCreateProgram(this.name,{config:this.configuration,defines:m});d.program.set(g.program);const y=(e,t,i)=>{if(t[e]&&i[e])for(const r in t[e])i[e][r]&&i[e][r].set(i.program,r,t[e][r].current)};c&&c.setUniforms(g.program,d,g.binderUniforms,a,{zoom:l}),y("fixedUniforms",this,g),y("terrainUniforms",this,g),y("globeUniforms",this,g),y("fogUniforms",this,g),y("lightsUniforms",this,g),y("shadowUniforms",this,g),f.bind(),d.setColorMode(new Fi([p.ONE,p.ONE_MINUS_SRC_ALPHA,p.ZERO,p.ONE],e.aj.transparent,[!0,!0,!0,!1])),d.setDepthMode(new Bi(i.func===p.LESS?p.LEQUAL:i.func,Bi.ReadOnly,i.range)),d.setStencilMode(ji.disabled);const _=3*s.primitiveLength*2,v=3*s.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const e=u||1;for(let t=0;t<e;++t)g.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",t),p.drawElements(p.LINES,_,p.UNSIGNED_SHORT,v)}else u&&u>1?p.drawElementsInstanced(p.LINES,_,p.UNSIGNED_SHORT,v,u):p.drawElements(p.LINES,_,p.UNSIGNED_SHORT,v);o.bind(),d.program.set(this.program),d.setDepthMode(i),d.setStencilMode(r),d.setColorMode(n)}checkUniforms(e,t,i){if(this.fixedDefines.includes(t))for(const r of Object.keys(i))if(!i[r].initialized)throw new Error(`Program '${this.name}', from draw '${e}': uniform ${r} not set but required by ${t} being defined`)}draw(e,t,i,r,n,o,s,a,l,c,u,h,d,p,f,m){const g=e.context,y=g.gl;if(this.failedToCreate)return;g.program.set(this.program),g.setDepthMode(i),g.setStencilMode(r),g.setColorMode(n),g.setCullFace(o);for(const x of Object.keys(this.fixedUniforms))this.fixedUniforms[x].set(this.program,x,s[x]);p&&p.setUniforms(this.program,g,this.binderUniforms,h,{zoom:d});const _={[y.POINTS]:1,[y.LINES]:2,[y.TRIANGLES]:3,[y.LINE_STRIP]:1}[t];this.checkUniforms(a,"RENDER_SHADOWS",this.shadowUniforms);const v=m&&m>0?1:void 0;for(const x of u.get()){const o=x.vaos||(x.vaos={});if((o[a]||(o[a]=new Ur)).bind(g,this,l,p?p.getPaintVertexBuffers():[],c,x.vertexOffset,f||[],v),this.forceManualRenderingForInstanceIDShaders){const e=m||1;for(let i=0;i<e;++i)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",i),c?y.drawElements(t,x.primitiveLength*_,y.UNSIGNED_SHORT,x.primitiveOffset*_*2):y.drawArrays(t,x.vertexOffset,x.vertexLength)}else m&&m>1?y.drawElementsInstanced(t,x.primitiveLength*_,y.UNSIGNED_SHORT,x.primitiveOffset*_*2,m):c?y.drawElements(t,x.primitiveLength*_,y.UNSIGNED_SHORT,x.primitiveOffset*_*2):y.drawArrays(t,x.vertexOffset,x.vertexLength);t===y.TRIANGLES&&c&&this._drawDebugWireframe(e,i,r,n,c,x,h,d,p,m)}}}function Xn(t,i){const r=Math.pow(2,i.tileID.overscaledZ),n=i.tileSize*Math.pow(2,t.transform.tileZoom)/r,o=n*(i.tileID.canonical.x+i.tileID.wrap*r),s=n*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture?i.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/e.ar(i,1,t.transform.tileZoom),u_pixel_coord_upper:[o>>16,s>>16],u_pixel_coord_lower:[65535&o,65535&s]}}const Yn={terrain:0,flat:1},Zn=e.ab.mat4.create(),Kn=(t,i,r,n,o,s,a,l,c,u,h,d,p,f,m,g,y,_)=>{const v=i.style.light,x=v.properties.get("position"),b=[x.x,x.y,x.z],w=e.ab.mat3.create();"viewport"===v.properties.get("anchor")&&(e.ab.mat3.fromRotation(w,-i.transform.angle),e.ab.vec3.transformMat3(b,b,w));const S=v.properties.get("color"),T=i.transform,M={u_matrix:t,u_lightpos:b,u_lightintensity:v.properties.get("intensity"),u_lightcolor:[S.r,S.g,S.b],u_vertical_gradient:+r,u_opacity:n,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Zn,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:Yn[u],u_base_type:Yn[h],u_ao:o,u_edge_radius:s,u_width_scale:a,u_flood_light_color:m,u_vertical_scale:g,u_flood_light_intensity:y,u_ground_shadow_factor:_};return"globe"===T.projection.name&&(M.u_tile_id=[l.canonical.x,l.canonical.y,1<<l.canonical.z],M.u_zoom_transition=d,M.u_inv_rot_matrix=f,M.u_merc_center=p,M.u_up_dir=T.projection.upVector(new e.bT(0,0,0),p[0]*e.ag,p[1]*e.ag),M.u_height_lift=c),M},Jn=(e,t,i,r,n,o)=>({u_matrix:e,u_edge_radius:t,u_width_scale:i,u_vertical_scale:r,u_height_type:Yn[n],u_base_type:Yn[o]}),Qn=(t,i,r,n,o,s,a,l,c,u,h,d,p,f,m,g,y)=>{const _=Kn(t,i,r,n,o,s,a,l,u,h,d,p,f,m,g,y,1,[0,0,0]),v={u_height_factor:-Math.pow(2,l.overscaledZ)/c.tileSize/8};return e.l(_,Xn(i,c),v)},eo=(e,t)=>({u_matrix:e,u_emissive_strength:t}),to=(t,i,r,n)=>e.l(eo(t,i),Xn(r,n)),io=(e,t,i)=>({u_matrix:e,u_world:i,u_emissive_strength:t}),ro=(t,i,r,n,o)=>e.l(to(t,i,r,n),{u_world:o}),no=(t,i,r,n)=>{const o=e.ag/r.tileSize;return{u_matrix:t,u_camera_to_center_distance:i.getCameraToCenterDistance(n),u_extrude_scale:[i.pixelsToGLUnits[0]/o,i.pixelsToGLUnits[1]/o]}},oo=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return{u_matrix:e,u_color:t.toRenderColor(null),u_overlay:0,u_overlay_scale:i}},so=e.ab.mat4.create(),ao=(t,i,r,n,o,s,a)=>{const l=t.transform,c="globe"===l.projection.name,u=c?e.cN(l.zoom,i.canonical)*l._pixelsPerMercatorPixel:e.ar(r,1,s),h={u_matrix:i.projMatrix,u_extrude_scale:u,u_intensity:a,u_inv_rot_matrix:so,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(c){h.u_inv_rot_matrix=n,h.u_merc_center=o,h.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],h.u_zoom_transition=e.ae(l.zoom);const t=o[0]*e.ag,r=o[1]*e.ag;h.u_up_dir=l.projection.upVector(new e.bT(0,0,0),t,r)}return h};function lo(e,t,i){let[r,n,o,s]=t,[a,l]=i;if(a===l)return[0,0,0,0];const c=255*(e-1)/(e*(l-a));return[r*c,n*c,o*c,s*c]}function co(e,t,i){let[r,n]=i;return r===n?0:.5/e+(t-r)*(e-1)/(e*(n-r))}const uo=(t,i,r,n,o,s,a,l,c,u,h,d,p,f,m,g,y,_,v,x,b)=>({u_matrix:t,u_normalize_matrix:i,u_globe_matrix:r,u_merc_matrix:n,u_grid_matrix:o,u_tl_parent:s,u_scale_parent:u,u_fade_t:h.mix,u_opacity:h.opacity*d.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:d.paint.get("raster-brightness-min"),u_brightness_high:d.paint.get("raster-brightness-max"),u_saturation_factor:e.cO(d.paint.get("raster-saturation")),u_contrast_factor:e.cP(d.paint.get("raster-contrast")),u_spin_weights:ho(d.paint.get("raster-hue-rotate")),u_perspective_transform:p,u_raster_elevation:f,u_zoom_transition:a,u_merc_center:l,u_cutoff_params:c,u_colorization_mix:lo(e.cQ,g,_),u_colorization_offset:co(e.cQ,y,_),u_color_ramp:m,u_texture_offset:[x/(v+2*x),v/(v+2*x)],u_texture_res:[v+2*x,v+2*x],u_emissive_strength:b});function ho(e){e*=Math.PI/180;const t=Math.sin(e),i=Math.cos(e);return[(2*i+1)/3,(-Math.sqrt(3)*t-i+1)/3,(Math.sqrt(3)*t-i+1)/3]}const po=.05,fo=(e,t,i,r,n,o,s,a,l,c,u,h)=>({u_matrix:e,u_normalize_matrix:t,u_globe_matrix:i,u_merc_matrix:r,u_grid_matrix:n,u_tl_parent:o,u_scale_parent:c,u_fade_t:u.mix,u_opacity:u.opacity,u_image0:0,u_image1:1,u_raster_elevation:h,u_zoom_transition:s,u_merc_center:a,u_cutoff_params:l}),mo=(e,t,i,r,n,o,s,a,l,c)=>({u_particle_texture:e,u_particle_texture_side_len:t,u_tile_offset:i,u_velocity:r,u_color_ramp:o,u_velocity_res:n,u_max_speed:s,u_uv_offset:a,u_data_scale:[255*l[0],255*l[1]],u_data_offset:c,u_particle_pos_scale:1.1,u_particle_pos_offset:[po,po]}),go=(e,t,i,r,n,o,s,a,l,c)=>({u_particle_texture:e,u_particle_texture_side_len:t,u_velocity:i,u_velocity_res:r,u_max_speed:n,u_speed_factor:o,u_reset_rate:s,u_rand_seed:Math.random(),u_uv_offset:a,u_data_scale:[255*l[0],255*l[1]],u_data_offset:c,u_particle_pos_scale:1.1,u_particle_pos_offset:[po,po]}),yo=e.ab.mat4.create(),_o=(t,i,r,n,o,s,a,l,c,u,h,d,p,f,m,g,y,_,v,x,b,w)=>{const S=o.transform,T={u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:S.getCameraToCenterDistance(v),u_rotate_symbol:+r,u_aspect_ratio:S.width/S.height,u_fade_change:o.options.fadeDuration?o.symbolFadeChange:1,u_matrix:s,u_label_plane_matrix:a,u_coord_matrix:l,u_is_text:+u,u_elevation_from_sea:c?1:0,u_pitch_with_map:+n,u_texsize:h,u_texsize_icon:d,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:yo,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:yo,u_up_vector:[0,-1,0],u_color_adj_mat:x,u_icon_transition:b||0,u_gamma_scale:n?o.transform.getCameraToCenterDistance(v)*Math.cos(o.terrain?0:o.transform._pitch):1,u_device_pixel_ratio:e.q.devicePixelRatio,u_is_halo:+p,u_scale_factor:w||1};return"globe"===v.name&&(T.u_tile_id=[f.canonical.x,f.canonical.y,1<<f.canonical.z],T.u_zoom_transition=m,T.u_inv_rot_matrix=y,T.u_merc_center=g,T.u_camera_forward=S._camera.forward(),T.u_ecef_origin=e.cR(S.globeMatrix,f.toUnwrapped()),T.u_tile_matrix=Float32Array.from(S.globeMatrix),T.u_up_vector=_),T},vo=(e,t,i,r)=>({u_matrix:e,u_emissive_strength:t,u_opacity:i,u_color:r}),xo=(t,i,r,n,o,s,a,l,c)=>e.l(function(t,i,r,n,o,s){const{width:a,height:l}=n.imageManager.getPixelSize(i),c=Math.pow(2,s.tileID.overscaledZ),u=s.tileSize*Math.pow(2,n.transform.tileZoom)/c,h=u*(s.tileID.canonical.x+s.tileID.wrap*c),d=u*s.tileID.canonical.y;return{u_image:0,u_pattern_tl:r.tl,u_pattern_br:r.br,u_texsize:[a,l],u_pattern_size:r.displaySize,u_pattern_units_to_pixels:o?[n.transform.width,-1*n.transform.height]:[1/e.ar(s,1,n.transform.tileZoom),1/e.ar(s,1,n.transform.tileZoom)],u_pixel_coord_upper:[h>>16,d>>16],u_pixel_coord_lower:[65535&h,65535&d]}}(0,s,a,n,l,c),{u_matrix:t,u_emissive_strength:i,u_opacity:r}),bo=new Float32Array(e.ab.mat4.identity([])),wo=function(t,i,r,n,o,s,a,l,c,u,h,d,p){let f=arguments.length>13&&void 0!==arguments[13]?arguments[13]:[0,0,0],m=arguments.length>14?arguments[14]:void 0;const g=o.style.light,y=g.properties.get("position"),_=[-y.x,-y.y,y.z],v=e.ab.mat3.create();"viewport"===g.properties.get("anchor")&&(e.ab.mat3.fromRotation(v,-o.transform.angle),e.ab.vec3.transformMat3(_,_,v));const x="MASK"===h.alphaMode,b=g.properties.get("color").toRenderColor(null),w=p.paint.get("model-ambient-occlusion-intensity"),S=p.paint.get("model-color").constantOr(e.aj.white).toRenderColor(null),T=p.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:t,u_lighting_matrix:i,u_normal_matrix:r,u_node_matrix:n||bo,u_lightpos:_,u_lightintensity:g.properties.get("intensity"),u_lightcolor:[b.r,b.g,b.b],u_camera_pos:f,u_opacity:s,u_baseTextureIsAlpha:0,u_alphaMask:+x,u_alphaCutoff:h.alphaCutoff,u_baseColorFactor:[a.r,a.g,a.b,a.a],u_emissiveFactor:[l[0],l[1],l[2],1],u_metallicFactor:c,u_roughnessFactor:u,u_baseColorTexture:Yi.BaseColor,u_metallicRoughnessTexture:Yi.MetallicRoughness,u_normalTexture:Yi.Normal,u_occlusionTexture:Yi.Occlusion,u_emissionTexture:Yi.Emission,u_lutTexture:Yi.LUT,u_color_mix:[S.r,S.g,S.b,T],u_aoIntensity:w,u_emissive_strength:d,u_occlusionTextureTransform:m||[0,0,0,0]}},So=function(e){return{u_matrix:e,u_instance:arguments.length>1&&void 0!==arguments[1]?arguments[1]:bo,u_node_matrix:arguments.length>2&&void 0!==arguments[2]?arguments[2]:bo}},To={fillExtrusion:t=>({u_matrix:new e.bJ(t),u_lightpos:new e.bL(t),u_lightintensity:new e.bM(t),u_lightcolor:new e.bL(t),u_vertical_gradient:new e.bM(t),u_opacity:new e.bM(t),u_edge_radius:new e.bM(t),u_width_scale:new e.bM(t),u_ao:new e.bK(t),u_height_type:new e.bN(t),u_base_type:new e.bN(t),u_tile_id:new e.bL(t),u_zoom_transition:new e.bM(t),u_inv_rot_matrix:new e.bJ(t),u_merc_center:new e.bK(t),u_up_dir:new e.bL(t),u_height_lift:new e.bM(t),u_flood_light_color:new e.bL(t),u_vertical_scale:new e.bM(t),u_flood_light_intensity:new e.bM(t),u_ground_shadow_factor:new e.bL(t)}),fillExtrusionDepth:t=>({u_matrix:new e.bJ(t),u_edge_radius:new e.bM(t),u_width_scale:new e.bM(t),u_vertical_scale:new e.bM(t),u_height_type:new e.bN(t),u_base_type:new e.bN(t)}),fillExtrusionPattern:t=>({u_matrix:new e.bJ(t),u_lightpos:new e.bL(t),u_lightintensity:new e.bM(t),u_lightcolor:new e.bL(t),u_vertical_gradient:new e.bM(t),u_height_factor:new e.bM(t),u_edge_radius:new e.bM(t),u_width_scale:new e.bM(t),u_ao:new e.bK(t),u_height_type:new e.bN(t),u_base_type:new e.bN(t),u_tile_id:new e.bL(t),u_zoom_transition:new e.bM(t),u_inv_rot_matrix:new e.bJ(t),u_merc_center:new e.bK(t),u_up_dir:new e.bL(t),u_height_lift:new e.bM(t),u_image:new e.bN(t),u_texsize:new e.bK(t),u_pixel_coord_upper:new e.bK(t),u_pixel_coord_lower:new e.bK(t),u_tile_units_to_pixels:new e.bM(t),u_opacity:new e.bM(t)}),fillExtrusionGroundEffect:t=>({u_matrix:new e.bJ(t),u_opacity:new e.bM(t),u_ao_pass:new e.bM(t),u_meter_to_tile:new e.bM(t),u_ao:new e.bK(t),u_flood_light_intensity:new e.bM(t),u_flood_light_color:new e.bL(t),u_attenuation:new e.bM(t),u_edge_radius:new e.bM(t),u_fb:new e.bN(t),u_fb_size:new e.bM(t),u_dynamic_offset:new e.bM(t)}),fill:t=>({u_matrix:new e.bJ(t),u_emissive_strength:new e.bM(t)}),fillPattern:t=>({u_matrix:new e.bJ(t),u_emissive_strength:new e.bM(t),u_image:new e.bN(t),u_texsize:new e.bK(t),u_pixel_coord_upper:new e.bK(t),u_pixel_coord_lower:new e.bK(t),u_tile_units_to_pixels:new e.bM(t)}),fillOutline:t=>({u_matrix:new e.bJ(t),u_emissive_strength:new e.bM(t),u_world:new e.bK(t)}),fillOutlinePattern:t=>({u_matrix:new e.bJ(t),u_emissive_strength:new e.bM(t),u_world:new e.bK(t),u_image:new e.bN(t),u_texsize:new e.bK(t),u_pixel_coord_upper:new e.bK(t),u_pixel_coord_lower:new e.bK(t),u_tile_units_to_pixels:new e.bM(t)}),circle:e.cS,collisionBox:t=>({u_matrix:new e.bJ(t),u_camera_to_center_distance:new e.bM(t),u_extrude_scale:new e.bK(t)}),collisionCircle:t=>({u_matrix:new e.bJ(t),u_inv_matrix:new e.bJ(t),u_camera_to_center_distance:new e.bM(t),u_viewport_size:new e.bK(t)}),debug:t=>({u_color:new e.cz(t),u_matrix:new e.bJ(t),u_overlay:new e.bN(t),u_overlay_scale:new e.bM(t)}),clippingMask:t=>({u_matrix:new e.bJ(t)}),heatmap:t=>({u_extrude_scale:new e.bM(t),u_intensity:new e.bM(t),u_matrix:new e.bJ(t),u_inv_rot_matrix:new e.bJ(t),u_merc_center:new e.bK(t),u_tile_id:new e.bL(t),u_zoom_transition:new e.bM(t),u_up_dir:new e.bL(t)}),heatmapTexture:t=>({u_image:new e.bN(t),u_color_ramp:new e.bN(t),u_opacity:new e.bM(t)}),hillshade:t=>({u_matrix:new e.bJ(t),u_image:new e.bN(t),u_latrange:new e.bK(t),u_light:new e.bK(t),u_shadow:new e.cz(t),u_highlight:new e.cz(t),u_emissive_strength:new e.bM(t),u_accent:new e.cz(t)}),hillshadePrepare:t=>({u_matrix:new e.bJ(t),u_image:new e.bN(t),u_dimension:new e.bK(t),u_zoom:new e.bM(t)}),line:e.cT,linePattern:e.cU,raster:t=>({u_matrix:new e.bJ(t),u_normalize_matrix:new e.bJ(t),u_globe_matrix:new e.bJ(t),u_merc_matrix:new e.bJ(t),u_grid_matrix:new e.cA(t),u_tl_parent:new e.bK(t),u_scale_parent:new e.bM(t),u_fade_t:new e.bM(t),u_opacity:new e.bM(t),u_image0:new e.bN(t),u_image1:new e.bN(t),u_brightness_low:new e.bM(t),u_brightness_high:new e.bM(t),u_saturation_factor:new e.bM(t),u_contrast_factor:new e.bM(t),u_spin_weights:new e.bL(t),u_perspective_transform:new e.bK(t),u_raster_elevation:new e.bM(t),u_zoom_transition:new e.bM(t),u_merc_center:new e.bK(t),u_cutoff_params:new e.ca(t),u_colorization_mix:new e.ca(t),u_colorization_offset:new e.bM(t),u_color_ramp:new e.bN(t),u_texture_offset:new e.bK(t),u_texture_res:new e.bK(t),u_emissive_strength:new e.bM(t)}),rasterParticle:t=>({u_matrix:new e.bJ(t),u_normalize_matrix:new e.bJ(t),u_globe_matrix:new e.bJ(t),u_merc_matrix:new e.bJ(t),u_grid_matrix:new e.cA(t),u_tl_parent:new e.bK(t),u_scale_parent:new e.bM(t),u_fade_t:new e.bM(t),u_opacity:new e.bM(t),u_image0:new e.bN(t),u_image1:new e.bN(t),u_raster_elevation:new e.bM(t),u_zoom_transition:new e.bM(t),u_merc_center:new e.bK(t),u_cutoff_params:new e.ca(t)}),rasterParticleTexture:t=>({u_texture:new e.bN(t),u_opacity:new e.bM(t)}),rasterParticleDraw:t=>({u_particle_texture:new e.bN(t),u_particle_texture_side_len:new e.bM(t),u_tile_offset:new e.bK(t),u_velocity:new e.bN(t),u_color_ramp:new e.bN(t),u_velocity_res:new e.bK(t),u_max_speed:new e.bM(t),u_uv_offset:new e.bK(t),u_data_scale:new e.bK(t),u_data_offset:new e.bM(t),u_particle_pos_scale:new e.bM(t),u_particle_pos_offset:new e.bK(t)}),rasterParticleUpdate:t=>({u_particle_texture:new e.bN(t),u_particle_texture_side_len:new e.bM(t),u_velocity:new e.bN(t),u_velocity_res:new e.bK(t),u_max_speed:new e.bM(t),u_speed_factor:new e.bM(t),u_reset_rate:new e.bM(t),u_rand_seed:new e.bM(t),u_uv_offset:new e.bK(t),u_data_scale:new e.bK(t),u_data_offset:new e.bM(t),u_particle_pos_scale:new e.bM(t),u_particle_pos_offset:new e.bK(t)}),symbol:t=>({u_is_size_zoom_constant:new e.bN(t),u_is_size_feature_constant:new e.bN(t),u_size_t:new e.bM(t),u_size:new e.bM(t),u_camera_to_center_distance:new e.bM(t),u_rotate_symbol:new e.bN(t),u_aspect_ratio:new e.bM(t),u_fade_change:new e.bM(t),u_matrix:new e.bJ(t),u_label_plane_matrix:new e.bJ(t),u_coord_matrix:new e.bJ(t),u_is_text:new e.bN(t),u_elevation_from_sea:new e.bN(t),u_pitch_with_map:new e.bN(t),u_texsize:new e.bK(t),u_texsize_icon:new e.bK(t),u_texture:new e.bN(t),u_texture_icon:new e.bN(t),u_gamma_scale:new e.bM(t),u_device_pixel_ratio:new e.bM(t),u_tile_id:new e.bL(t),u_zoom_transition:new e.bM(t),u_inv_rot_matrix:new e.bJ(t),u_merc_center:new e.bK(t),u_camera_forward:new e.bL(t),u_tile_matrix:new e.bJ(t),u_up_vector:new e.bL(t),u_ecef_origin:new e.bL(t),u_is_halo:new e.bN(t),u_icon_transition:new e.bM(t),u_color_adj_mat:new e.bJ(t),u_scale_factor:new e.bM(t)}),background:t=>({u_matrix:new e.bJ(t),u_emissive_strength:new e.bM(t),u_opacity:new e.bM(t),u_color:new e.cz(t)}),backgroundPattern:t=>({u_matrix:new e.bJ(t),u_emissive_strength:new e.bM(t),u_opacity:new e.bM(t),u_image:new e.bN(t),u_pattern_tl:new e.bK(t),u_pattern_br:new e.bK(t),u_texsize:new e.bK(t),u_pattern_size:new e.bK(t),u_pixel_coord_upper:new e.bK(t),u_pixel_coord_lower:new e.bK(t),u_pattern_units_to_pixels:new e.bK(t)}),terrainRaster:t=>({u_matrix:new e.bJ(t),u_image0:new e.bN(t),u_skirt_height:new e.bM(t),u_ground_shadow_factor:new e.bL(t)}),skybox:t=>({u_matrix:new e.bJ(t),u_sun_direction:new e.bL(t),u_cubemap:new e.bN(t),u_opacity:new e.bM(t),u_temporal_offset:new e.bM(t)}),skyboxGradient:t=>({u_matrix:new e.bJ(t),u_color_ramp:new e.bN(t),u_center_direction:new e.bL(t),u_radius:new e.bM(t),u_opacity:new e.bM(t),u_temporal_offset:new e.bM(t)}),skyboxCapture:t=>({u_matrix_3f:new e.cA(t),u_sun_direction:new e.bL(t),u_sun_intensity:new e.bM(t),u_color_tint_r:new e.ca(t),u_color_tint_m:new e.ca(t),u_luminance:new e.bM(t)}),globeRaster:t=>({u_proj_matrix:new e.bJ(t),u_globe_matrix:new e.bJ(t),u_normalize_matrix:new e.bJ(t),u_merc_matrix:new e.bJ(t),u_zoom_transition:new e.bM(t),u_merc_center:new e.bK(t),u_image0:new e.bN(t),u_grid_matrix:new e.cA(t),u_skirt_height:new e.bM(t),u_far_z_cutoff:new e.bM(t),u_frustum_tl:new e.bL(t),u_frustum_tr:new e.bL(t),u_frustum_br:new e.bL(t),u_frustum_bl:new e.bL(t),u_globe_pos:new e.bL(t),u_globe_radius:new e.bM(t),u_viewport:new e.bK(t)}),globeAtmosphere:t=>({u_frustum_tl:new e.bL(t),u_frustum_tr:new e.bL(t),u_frustum_br:new e.bL(t),u_frustum_bl:new e.bL(t),u_horizon:new e.bM(t),u_transition:new e.bM(t),u_fadeout_range:new e.bM(t),u_color:new e.ca(t),u_high_color:new e.ca(t),u_space_color:new e.ca(t),u_temporal_offset:new e.bM(t),u_horizon_angle:new e.bM(t)}),model:t=>({u_matrix:new e.bJ(t),u_lighting_matrix:new e.bJ(t),u_normal_matrix:new e.bJ(t),u_node_matrix:new e.bJ(t),u_lightpos:new e.bL(t),u_lightintensity:new e.bM(t),u_lightcolor:new e.bL(t),u_camera_pos:new e.bL(t),u_opacity:new e.bM(t),u_baseColorFactor:new e.ca(t),u_emissiveFactor:new e.ca(t),u_metallicFactor:new e.bM(t),u_roughnessFactor:new e.bM(t),u_baseTextureIsAlpha:new e.bN(t),u_alphaMask:new e.bN(t),u_alphaCutoff:new e.bM(t),u_baseColorTexture:new e.bN(t),u_metallicRoughnessTexture:new e.bN(t),u_normalTexture:new e.bN(t),u_occlusionTexture:new e.bN(t),u_emissionTexture:new e.bN(t),u_lutTexture:new e.bN(t),u_color_mix:new e.ca(t),u_aoIntensity:new e.bM(t),u_emissive_strength:new e.bM(t),u_occlusionTextureTransform:new e.ca(t)}),modelDepth:t=>({u_matrix:new e.bJ(t),u_instance:new e.bJ(t),u_node_matrix:new e.bJ(t)}),groundShadow:t=>({u_matrix:new e.bJ(t),u_ground_shadow_factor:new e.bL(t)}),stars:t=>({u_matrix:new e.bJ(t),u_up:new e.bL(t),u_right:new e.bL(t),u_intensity_multiplier:new e.bM(t)}),snowParticle:t=>({u_modelview:new e.bJ(t),u_projection:new e.bJ(t),u_time:new e.bM(t),u_cam_pos:new e.bL(t),u_velocityConeAperture:new e.bM(t),u_velocity:new e.bM(t),u_horizontalOscillationRadius:new e.bM(t),u_horizontalOscillationRate:new e.bM(t),u_boxSize:new e.bM(t),u_billboardSize:new e.bM(t),u_simpleShapeParameters:new e.bK(t),u_screenSize:new e.bK(t),u_thinningCenterPos:new e.bK(t),u_thinningShape:new e.bL(t),u_thinningAffectedRatio:new e.bM(t),u_thinningParticleOffset:new e.bM(t),u_particleColor:new e.ca(t),u_direction:new e.bL(t)}),rainParticle:t=>({u_modelview:new e.bJ(t),u_projection:new e.bJ(t),u_time:new e.bM(t),u_cam_pos:new e.bL(t),u_texScreen:new e.bN(t),u_velocityConeAperture:new e.bM(t),u_velocity:new e.bM(t),u_boxSize:new e.bM(t),u_rainDropletSize:new e.bK(t),u_distortionStrength:new e.bM(t),u_rainDirection:new e.bL(t),u_color:new e.ca(t),u_screenSize:new e.bK(t),u_thinningCenterPos:new e.bK(t),u_thinningShape:new e.bL(t),u_thinningAffectedRatio:new e.bM(t),u_thinningParticleOffset:new e.bM(t),u_shapeDirectionalPower:new e.bM(t),u_shapeNormalPower:new e.bM(t),u_mode:new e.bM(t)}),vignette:t=>({u_vignetteShape:new e.bL(t),u_vignetteColor:new e.ca(t)}),occlusion:t=>({u_matrix:new e.bJ(t),u_anchorPos:new e.bL(t),u_screenSizePx:new e.bK(t),u_occluderSizePx:new e.bK(t),u_color:new e.ca(t)})};class Mo{constructor(e,t,i,r){this.id=Mo.uniqueIdxCounter,Mo.uniqueIdxCounter++,this.context=e;const n=e.gl;this.buffer=n.createBuffer(),this.dynamicDraw=Boolean(i),this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||r||t.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){this.id=Mo.uniqueIdxCounter,Mo.uniqueIdxCounter++;const t=this.context.gl;this.context.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Mo.uniqueIdxCounter=0;const Ao={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Co{constructor(e,t,i,r,n,o){this.length=t.length,this.attributes=i,this.itemSize=t.bytesPerElement,this.dynamicDraw=r,this.instanceCount=o,this.context=e;const s=e.gl;this.buffer=s.createBuffer(),e.bindVertexBuffer.set(this.buffer),s.bufferData(s.ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?s.DYNAMIC_DRAW:s.STATIC_DRAW),this.dynamicDraw||n||t.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){const t=this.context.gl;this.bind(),t.bufferSubData(t.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,t){for(let i=0;i<this.attributes.length;i++){const r=t.attributes[this.attributes[i].name];void 0!==r&&e.enableVertexAttribArray(r)}}setVertexAttribPointers(e,t,i){for(let r=0;r<this.attributes.length;r++){const n=this.attributes[r],o=t.attributes[n.name];void 0!==o&&e.vertexAttribPointer(o,n.components,e[Ao[n.type]],!1,this.itemSize,n.offset+this.itemSize*(i||0))}}setVertexAttribDivisor(e,t,i){for(let r=0;r<this.attributes.length;r++){const n=t.attributes[this.attributes[r].name];void 0!==n&&this.instanceCount&&this.instanceCount>0&&e.vertexAttribDivisor(n,i)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Eo{constructor(e,t,i,r,n){this.context=e,this.width=t,this.height=i;const o=this.framebuffer=e.gl.createFramebuffer();r&&(this.colorAttachment=new Cn(e,o)),n&&(this.depthAttachmentType=n,this.depthAttachment="renderbuffer"===n?new En(e,o):new Pn(e,o))}destroy(){const e=this.context.gl;if(this.colorAttachment){const t=this.colorAttachment.get();t&&e.deleteTexture(t)}if(this.depthAttachment&&this.depthAttachmentType)if("renderbuffer"===this.depthAttachmentType){const t=this.depthAttachment.get();t&&e.deleteRenderbuffer(t)}else{const t=this.depthAttachment.get();t&&e.deleteTexture(t)}e.deleteFramebuffer(this.framebuffer)}}class Po{constructor(e,t){this.gl=e,this.clearColor=new Xr(this),this.clearDepth=new Yr(this),this.clearStencil=new Zr(this),this.colorMask=new Kr(this),this.depthMask=new Jr(this),this.stencilMask=new Qr(this),this.stencilFunc=new en(this),this.stencilOp=new tn(this),this.stencilTest=new rn(this),this.depthRange=new nn(this),this.depthTest=new on(this),this.depthFunc=new sn(this),this.blend=new an(this),this.blendFunc=new ln(this),this.blendColor=new cn(this),this.blendEquation=new un(this),this.cullFace=new hn(this),this.cullFaceSide=new dn(this),this.frontFace=new pn(this),this.program=new fn(this),this.activeTexture=new mn(this),this.viewport=new gn(this),this.bindFramebuffer=new yn(this),this.bindRenderbuffer=new _n(this),this.bindTexture=new vn(this),this.bindVertexBuffer=new xn(this),this.bindElementBuffer=new bn(this),this.bindVertexArrayOES=new wn(this),this.pixelStoreUnpack=new Sn(this),this.pixelStoreUnpackPremultiplyAlpha=new Tn(this),this.pixelStoreUnpackFlipY=new Mn(this),this.options=t?Object.assign({},t):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=e.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=e.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=e.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=t&&!!t.forceManualRenderingForInstanceIDShaders||this.renderer&&-1!==this.renderer.indexOf("PowerVR"),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=e.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=e.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=e.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),this.maxPointSize=e.getParameter(e.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,t,i){return new Mo(this,e,t,i)}createVertexBuffer(e,t,i,r,n){return new Co(this,e,t,i,r,n)}createRenderbuffer(e,t,i){const r=this.gl,n=r.createRenderbuffer();return this.bindRenderbuffer.set(n),r.renderbufferStorage(r.RENDERBUFFER,e,t,i),this.bindRenderbuffer.set(null),n}createFramebuffer(e,t,i,r){return new Eo(this,e,t,i,r)}clear(e){let{color:t,depth:i,stencil:r,colorMask:n}=e;const o=this.gl;let s=0;t&&(s|=o.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set(n||[!0,!0,!0,!0])),void 0!==i&&(s|=o.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(i),this.depthMask.set(!0)),void 0!==r&&(s|=o.STENCIL_BUFFER_BIT,this.clearStencil.set(r),this.stencilMask.set(255)),o.clear(s)}setCullFace(e){!1===e.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(t){e.bn(t.blendFunction,Fi.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor),t.blendEquation?this.blendEquation.set(t.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(t.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let ko;function Io(t,i,r,n,o,s,a){const l=t.context,c=l.gl,u=t.transform,h=t.getOrCreateProgram("collisionBox"),d=[];let p=0,f=0;for(let b=0;b<n.length;b++){const l=n[b],m=i.getTile(l),g=m.getBucket(r);if(!g)continue;const y=li(l,g,u);let _=y;0===o[0]&&0===o[1]||(_=t.translatePosMatrix(y,m,o,s));const v=a?g.textCollisionBox:g.iconCollisionBox,x=g.collisionCircleArray;if(x.length>0){const t=e.ab.mat4.create(),i=_;e.ab.mat4.mul(t,g.placementInvProjMatrix,u.glCoordMatrix),e.ab.mat4.mul(t,t,g.placementViewportMatrix),d.push({circleArray:x,circleOffset:f,transform:i,invTransform:t,projection:g.getProjection()}),p+=x.length/4,f=p}v&&(t.terrain&&t.terrain.setupElevationDraw(m,h),h.draw(t,c.LINES,Bi.disabled,ji.disabled,t.colorModeForRenderPass(),Gi.disabled,no(_,u,m,g.getProjection()),r.id,v.layoutVertexBuffer,v.indexBuffer,v.segments,null,u.zoom,null,[v.collisionVertexBuffer,v.collisionVertexBufferExt]))}if(!a||!d.length)return;const m=t.getOrCreateProgram("collisionCircle"),g=new e.cV;g.resize(4*p),g._trim();let y=0;for(const e of d)for(let t=0;t<e.circleArray.length/4;t++){const i=4*t,r=e.circleArray[i+0],n=e.circleArray[i+1],o=e.circleArray[i+2],s=e.circleArray[i+3];g.emplace(y++,r,n,o,s,0),g.emplace(y++,r,n,o,s,1),g.emplace(y++,r,n,o,s,2),g.emplace(y++,r,n,o,s,3)}(!ko||ko.length<2*p)&&(ko=function(t){const i=2*t,r=new e.aU;r.resize(i),r._trim();for(let e=0;e<i;e++){const t=6*e;r.uint16[t+0]=4*e+0,r.uint16[t+1]=4*e+1,r.uint16[t+2]=4*e+2,r.uint16[t+3]=4*e+2,r.uint16[t+4]=4*e+3,r.uint16[t+5]=4*e+0}return r}(p));const _=l.createIndexBuffer(ko,!0),v=l.createVertexBuffer(g,e.cW.members,!0);for(const b of d){const i={u_matrix:b.transform,u_inv_matrix:b.invTransform,u_camera_to_center_distance:(x=u).getCameraToCenterDistance(b.projection),u_viewport_size:[x.width,x.height]};m.draw(t,c.TRIANGLES,Bi.disabled,ji.disabled,t.colorModeForRenderPass(),Gi.disabled,i,r.id,v,_,e.b7.simpleSegment(0,2*b.circleOffset,b.circleArray.length,b.circleArray.length/2),null,u.zoom)}var x;v.destroy(),_.destroy()}const Do=e.ab.mat4.create();function Lo(t){const i=t._camera.getWorldToCamera(t.worldSize,1),r=e.ab.mat4.multiply([],i,t.globeMatrix);e.ab.mat4.invert(r,r);const n=[0,0,0],o=[0,1,0,0];return e.ab.vec4.transformMat4(o,o,r),n[0]=o[0],n[1]=o[1],n[2]=o[2],e.ab.vec3.normalize(n,n),n}function Ro(t,i){let{width:r,height:n,anchor:o,textOffset:s,textScale:a}=t;const{horizontalAlign:l,verticalAlign:c}=e.bD(o),u=-(l-.5)*r,h=-(c-.5)*n,d=e.bC(o,s);return new e.P((u/a+d[0])*i,(h/a+d[1])*i)}function zo(t,i,r,n,o,s,a,l,c,u,h){const d=t.text.placedSymbolArray,p=t.text.dynamicLayoutVertexArray,f=t.icon.dynamicLayoutVertexArray,m={},g=t.getProjection(),y=ci(l,g,s),_=s.elevation,v=g.upVectorScale(l.canonical,s.center.lat,s.worldSize).metersToTile;p.clear();for(let x=0;x<d.length;x++){const f=d.get(x),{tileAnchorX:b,tileAnchorY:w,numGlyphs:S}=f,T=f.hidden||!f.crossTileID||t.allowVerticalPlacement&&!f.placedOrientation?null:n[f.crossTileID];if(T){let n=0,d=0,x=0;if(_){const e=_?_.getAtTileOffset(l,b,w):0,[t,i,r]=g.upVector(l.canonical,b,w);n=e*t*v,d=e*i*v,x=e*r*v}let[M,A,C,E]=qt(f.projectedAnchorX+n,f.projectedAnchorY+d,f.projectedAnchorZ+x,r?y:a);const P=Xt(s.getCameraToCenterDistance(g),E);let k=o.evaluateSizeForFeature(t.textSizeData,u,f)*P/e.bw;r&&(k*=t.tilePixelRatio/c);const I=Ro(T,k);r?(({x:M,y:A,z:C}=g.projectTilePoint(b+I.x,w+I.y,l.canonical)),[M,A,C]=qt(M+n,A+d,C+x,a)):(i&&I._rotate(-s.angle),M+=I.x,A+=I.y,C=0);const D=t.allowVerticalPlacement&&f.placedOrientation===e.bq.vertical?Math.PI/2:0;for(let t=0;t<S;t++)e.bt(p,M,A,C,D);h&&f.associatedIconIndex>=0&&(m[f.associatedIconIndex]={x:M,y:A,z:C,angle:D})}else ri(S,p)}if(h){f.clear();const i=t.icon.placedSymbolArray;for(let t=0;t<i.length;t++){const r=i.get(t),{numGlyphs:n}=r,o=m[t];if(r.hidden||!o)ri(n,f);else{const{x:t,y:i,z:r,angle:s}=o;for(let o=0;o<n;o++)e.bt(f,t,i,r,s)}}t.icon.dynamicLayoutVertexBuffer.updateData(f)}t.text.dynamicLayoutVertexBuffer.updateData(p)}function Oo(t,i,r,n,o,s){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};const l=r.paint.get("icon-translate"),c=r.paint.get("text-translate"),u=r.paint.get("icon-translate-anchor"),h=r.paint.get("text-translate-anchor"),d=r.layout.get("icon-rotation-alignment"),p=r.layout.get("text-rotation-alignment"),f=r.layout.get("icon-pitch-alignment"),m=r.layout.get("text-pitch-alignment"),g=r.layout.get("icon-keep-upright"),y=r.layout.get("text-keep-upright"),_=r.paint.get("icon-color-saturation"),v=r.paint.get("icon-color-contrast"),x=r.paint.get("icon-color-brightness-min"),b=r.paint.get("icon-color-brightness-max"),w="sea"===r.layout.get("symbol-elevation-reference"),S=t.context,T=S.gl,M=t.transform,A="map"===d,C="map"===p,E="map"===f,P="map"===m,k=void 0!==r.layout.get("symbol-sort-key").constantOr(1);let I=!1;const D=t.depthModeForSublayer(0,Bi.ReadOnly),L=[e.at(M.center.lng),e.aA(M.center.lat)],R=r.layout.get("text-variable-anchor"),z="globe"===M.projection.name,O=[],F=[0,-1,0];for(const B of n){const n=i.getTile(B),o=n.getBucket(r);if(!o)continue;if("mercator"===o.projection.name&&z)continue;if(o.fullyClipped)continue;const s="globe"===o.projection.name,d=s?e.ae(M.zoom):0,p=ci(B,o.getProjection(),M),f=M.calculatePixelsToTileUnitsMatrix(n),m=R&&o.hasTextData(),S=o.hasIconTextFit()&&m&&o.hasIconData(),D=o.getProjection().createInversionMatrix(M,B.canonical),N=e=>{M.depthOcclusionForSymbolsAndCircles&&(r.hasInitialOcclusionOpacityProperties||t.terrain)&&(e.push("DEPTH_D24"),e.push("DEPTH_OCCLUSION"))},j=()=>{const i=A&&"point"!==r.layout.get("symbol-placement"),a=[];N(a);const c=i||S,h=r.paint.get("icon-image-cross-fade").constantOr(0);t.terrainRenderModeElevated()&&E&&a.push("PITCH_WITH_MAP_TERRAIN"),s&&(a.push("PROJECTION_GLOBE_VIEW"),c&&a.push("PROJECTED_POS_ON_VIEWPORT")),h>0&&a.push("ICON_TRANSITION"),o.icon.zOffsetVertexBuffer&&a.push("Z_OFFSET"),0===_&&0===v&&0===x&&1===b||a.push("COLOR_ADJUSTMENT"),o.sdfIcons&&a.push("RENDER_SDF");const m=o.icon.programConfigurations.get(r.id),y=t.getOrCreateProgram("symbol",{config:m,defines:a}),C=n.imageAtlasTexture?n.imageAtlasTexture.size:[0,0],P=o.iconSizeData,k=e.bp(P,M.zoom),I=E||0!==M.pitch,R=Ht(p,n.tileID.canonical,E,A,M,o.getProjection(),f),O=$t(p,n.tileID.canonical,E,A,M,o.getProjection(),f),j=t.translatePosMatrix(O,n,l,u,!0),V=t.translatePosMatrix(p,n,l,u),U=c?Do:R,G=A&&!E&&!i;let H=F;!z&&!M.mercatorFromTransition||A||(H=Lo(M));const W=s?H:F,$=r.getColorAdjustmentMatrix(_,v,x,b),q=_o(P.kind,k,G,E,t,V,U,j,w,!1,C,[0,0],!0,B,d,L,D,W,o.getProjection(),$,h),X=n.imageAtlasTexture?n.imageAtlasTexture:null,Y=1!==r.layout.get("icon-size").constantOr(0)||o.iconsNeedLinear,Z=o.sdfIcons||t.options.rotating||t.options.zooming||Y||I?T.LINEAR:T.NEAREST,K=o.sdfIcons&&0!==r.paint.get("icon-halo-width").constantOr(1),J=t.terrain&&E&&i?e.ab.mat4.invert(e.ab.mat4.create(),R):Do;if(i&&o.icon){const e=M.elevation,i=e?e.getAtTileOffsetFunc(B,M.center.lat,M.worldSize,o.getProjection()):null,r=Wt(p,n.tileID.canonical,E,A,M,o.getProjection(),f);Zt(o,p,t,!1,r,O,E,g,i,B)}return{program:y,buffers:o.icon,uniformValues:q,atlasTexture:X,atlasTextureIcon:null,atlasInterpolation:Z,atlasInterpolationIcon:null,isSDF:o.sdfIcons,hasHalo:K,tile:n,labelPlaneMatrixInv:J}},V=()=>{const i=C&&"point"!==r.layout.get("symbol-placement"),a=[],l=i||R||S;t.terrainRenderModeElevated()&&P&&a.push("PITCH_WITH_MAP_TERRAIN"),s&&(a.push("PROJECTION_GLOBE_VIEW"),l&&a.push("PROJECTED_POS_ON_VIEWPORT")),o.text.zOffsetVertexBuffer&&a.push("Z_OFFSET"),o.iconsInText&&a.push("RENDER_TEXT_AND_SYMBOL"),a.push("RENDER_SDF"),N(a);const u=o.text.programConfigurations.get(r.id),m=t.getOrCreateProgram("symbol",{config:u,defines:a});let g,_=[0,0],v=null;const x=o.textSizeData;o.iconsInText&&(_=n.imageAtlasTexture?n.imageAtlasTexture.size:[0,0],v=n.imageAtlasTexture?n.imageAtlasTexture:null,g=P||0!==M.pitch||t.options.rotating||t.options.zooming||"composite"===x.kind||"camera"===x.kind?T.LINEAR:T.NEAREST);const b=n.glyphAtlasTexture?n.glyphAtlasTexture.size:[0,0],A=r.layout.get("text-size-scale-range"),E=e.aw(t.scaleFactor,A[0],A[1]),k=e.bp(x,M.zoom,E),I=Ht(p,n.tileID.canonical,P,C,M,o.getProjection(),f),O=$t(p,n.tileID.canonical,P,C,M,o.getProjection(),f),j=t.translatePosMatrix(O,n,c,h,!0),V=t.translatePosMatrix(p,n,c,h),U=l?Do:I,G=C&&!P&&!i;let H=F;!z&&!M.mercatorFromTransition||C||(H=Lo(M));const W=_o(x.kind,k,G,P,t,V,U,j,w,!0,b,_,!0,B,d,L,D,s?H:F,o.getProjection(),null,null,E),$=n.glyphAtlasTexture?n.glyphAtlasTexture:null,q=T.LINEAR,X=0!==r.paint.get("text-halo-width").constantOr(1),Y=t.terrain&&P&&i?e.ab.mat4.invert(e.ab.mat4.create(),I):Do;if(i&&o.text){const e=M.elevation,i=e?e.getAtTileOffsetFunc(B,M.center.lat,M.worldSize,o.getProjection()):null,r=Wt(p,n.tileID.canonical,P,C,M,o.getProjection(),f);Zt(o,p,t,!0,r,O,P,y,i,B)}return{program:m,buffers:o.text,uniformValues:W,atlasTexture:$,atlasTextureIcon:v,atlasInterpolation:q,atlasInterpolationIcon:g,isSDF:!0,hasHalo:X,tile:n,labelPlaneMatrixInv:Y}},U=o.icon.segments.get().length,G=o.text.segments.get().length,H=U&&!a.onlyText?j():null,W=G&&!a.onlyIcons?V():null,$=r.paint.get("icon-opacity").constantOr(1),q=r.paint.get("text-opacity").constantOr(1);if(k&&o.canOverlap){I=!0;const t=$&&!a.onlyText?o.icon.segments.get():[],i=q&&!a.onlyIcons?o.text.segments.get():[];for(const r of t)O.push({segments:new e.b7([r]),sortKey:r.sortKey,state:H});for(const r of i)O.push({segments:new e.b7([r]),sortKey:r.sortKey,state:W})}else a.onlyText||O.push({segments:$?o.icon.segments:new e.b7([]),sortKey:0,state:H}),a.onlyIcons||O.push({segments:q?o.text.segments:new e.b7([]),sortKey:0,state:W})}I&&O.sort(((e,t)=>e.sortKey-t.sortKey));for(const e of O){const i=e.state;if(i)if(t.terrain?t.terrain.setupElevationDraw(i.tile,i.program,{useDepthForOcclusion:M.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:i.labelPlaneMatrixInv}):t.setupDepthForOcclusion(M.depthOcclusionForSymbolsAndCircles,i.program),S.activeTexture.set(T.TEXTURE0),i.atlasTexture&&i.atlasTexture.bind(i.atlasInterpolation,T.CLAMP_TO_EDGE,!0),i.atlasTextureIcon&&(S.activeTexture.set(T.TEXTURE1),i.atlasTextureIcon&&i.atlasTextureIcon.bind(i.atlasInterpolationIcon,T.CLAMP_TO_EDGE,!0)),t.uploadCommonLightUniforms(t.context,i.program),i.hasHalo){const n=i.uniformValues;n.u_is_halo=1,Fo(i.buffers,e.segments,r,t,i.program,D,o,s,n,2),n.u_is_halo=0}else{if(i.isSDF){const n=i.uniformValues;i.hasHalo&&(n.u_is_halo=1,Fo(i.buffers,e.segments,r,t,i.program,D,o,s,n,1)),n.u_is_halo=0}Fo(i.buffers,e.segments,r,t,i.program,D,o,s,i.uniformValues,1)}}}function Fo(e,t,i,r,n,o,s,a,l,c){const u=[e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer,e.iconTransitioningVertexBuffer,e.globeExtVertexBuffer,e.zOffsetVertexBuffer];n.draw(r,r.context.gl.TRIANGLES,o,s,a,Gi.disabled,l,i.id,e.layoutVertexBuffer,e.indexBuffer,t,i.paint,r.transform.zoom,e.programConfigurations.get(i.id),u,c)}function Bo(t,i,r,n,o,s,a){const l=t.context.gl,c=r.paint.get("fill-pattern"),u=r.is3D(),h=u?t.stencilModeFor3D():ji.disabled,d=c&&c.constantOr(1);let p,f,m,g,y;a?(f=d&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",p=l.LINES):(f=d?"fillPattern":"fill",p=l.TRIANGLES);for(const _ of n){const n=i.getTile(_);if(d&&!n.patternsLoaded())continue;const v=n.getBucket(r);if(!v)continue;t.prepareDrawTile();const x=v.programConfigurations.get(r.id),b=t.isTileAffectedByFog(_),w=t.getOrCreateProgram(f,{config:x,overrideFog:b});d&&(t.context.activeTexture.set(l.TEXTURE0),n.imageAtlasTexture&&n.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),x.updatePaintBuffers());const S=c.constantOr(null);if(S&&n.imageAtlas){const t=n.imageAtlas,i=e.A.from(S).getPrimary().scaleSelf(e.q.devicePixelRatio).serialize(),r=t.patternPositions[i];r&&x.setConstantPatternPositions(r)}const T=t.translatePosMatrix(_.projMatrix,n,r.paint.get("fill-translate"),r.paint.get("fill-translate-anchor")),M=r.paint.get("fill-emissive-strength");if(a){g=v.indexBuffer2,y=v.segments2;const e=t.terrain&&t.terrain.renderingToTexture?t.terrain.drapeBufferSize:[l.drawingBufferWidth,l.drawingBufferHeight];m="fillOutlinePattern"===f&&d?ro(T,M,t,n,e):io(T,M,e)}else g=v.indexBuffer,y=v.segments,m=d?to(T,M,t,n):eo(T,M);t.uploadCommonUniforms(t.context,w,_.toUnwrapped()),w.draw(t,p,o,u?h:t.stencilModeForClipping(_),s,Gi.disabled,m,r.id,v.layoutVertexBuffer,g,y,r.paint,t.transform.zoom,x,void 0)}}function No(t,i,r,n,o,s,a,l){r.resetLayerRenderingStats(t);const c=t.context,u=c.gl,h=t.transform,d=r.paint.get("fill-extrusion-pattern"),p=d.constantOr(1),f=r.paint.get("fill-extrusion-opacity"),m=t.style.enable3dLights(),g=r.paint.get(m&&!p?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),y=[r.paint.get("fill-extrusion-ambient-occlusion-intensity"),g],_=r.layout.get("fill-extrusion-edge-radius"),v=_>0&&!r.paint.get("fill-extrusion-rounded-roof"),x=v?0:_,b="globe"===h.projection.name?e.d3():0,w="globe"===h.projection.name,S=w?e.ae(h.zoom):0,T=[e.at(h.center.lng),e.aA(h.center.lat)],M="none"===r.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default"),A=r.paint.get("fill-extrusion-flood-light-color").toRenderColor(M?null:r.lut).toArray01().slice(0,3),C=r.paint.get("fill-extrusion-flood-light-intensity"),E=r.paint.get("fill-extrusion-vertical-scale"),P=0!==r.paint.get("fill-extrusion-line-width").constantOr(1),k=r.paint.get("fill-extrusion-height-alignment"),I=r.paint.get("fill-extrusion-base-alignment"),D=er(t,r.paint.get("fill-extrusion-cutoff-fade-range")),L=[];let R;w&&L.push("PROJECTION_GLOBE_VIEW"),y[0]>0&&L.push("FAUX_AO"),v&&L.push("ZERO_ROOF_RADIUS"),l&&L.push("HAS_CENTROID"),C>0&&L.push("FLOOD_LIGHT"),D.shouldRenderCutoff&&L.push("RENDER_CUTOFF"),P&&L.push("RENDER_WALL_MODE");const z="shadow"===t.renderPass,O=t.shadowRenderer,F=z&&!!O;t.shadowRenderer&&(t.shadowRenderer.useNormalOffset=!0);let B=[0,0,0];if(O){const e=t.style.directionalLight,i=t.style.ambientLight;e&&i&&(B=ar(t.style,e,i)),z||(L.push("RENDER_SHADOWS","DEPTH_TEXTURE"),O.useNormalOffset&&L.push("NORMAL_OFFSET")),R=L.concat(["SHADOWS_SINGLE_CASCADE"])}const N=F?"fillExtrusionDepth":p?"fillExtrusionPattern":"fillExtrusion",j=r.getLayerRenderingStats();for(const V of n){const n=i.getTile(V),m=n.getBucket(r);if(!m||m.projection.name!==h.projection.name)continue;let g=!1;O&&(g=0===O.getMaxCascadeForTile(V.toUnwrapped()));const _=t.isTileAffectedByFog(V),v=m.programConfigurations.get(r.id),M=t.getOrCreateProgram(N,{config:v,defines:g?R:L,overrideFog:_});if(t.terrain&&t.terrain.setupElevationDraw(n,M,{useMeterToDem:!0}),!m.centroidVertexBuffer){const e=M.attributes.a_centroid_pos;void 0!==e&&u.vertexAttrib2f(e,0,0)}!z&&O&&O.setupShadows(n.tileID.toUnwrapped(),M,"vector-tile",n.tileID.overscaledZ),p&&(t.context.activeTexture.set(u.TEXTURE0),n.imageAtlasTexture&&n.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),v.updatePaintBuffers());const F=d.constantOr(null);if(F&&n.imageAtlas){const t=n.imageAtlas,i=e.A.from(F).getPrimary().scaleSelf(e.q.devicePixelRatio),r=t.patternPositions[i.serialize()];r&&v.setConstantPatternPositions(r)}const U=r.paint.get("fill-extrusion-vertical-gradient"),G=1/m.tileToMeter;let H;if(z&&O){if(Wo(n.tileID,m,t))continue;const e=O.calculateShadowPassMatrixFromTile(n.tileID.toUnwrapped());H=Jn(e,x,G,E,k,I)}else{const e=t.translatePosMatrix(V.expandedProjMatrix,n,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),i=h.projection.createInversionMatrix(h,V.canonical);H=p?Qn(e,t,U,f,y,x,G,V,n,b,k,I,S,T,i,A,E):Kn(e,t,U,f,y,x,G,V,b,k,I,S,T,i,A,E,C,B)}t.uploadCommonUniforms(c,M,V.toUnwrapped(),null,D);let W=m.segments;if("mercator"===h.projection.name&&!z&&(W=m.getVisibleSegments(n.tileID,t.terrain,t.transform.getFrustum(0)),!W.get().length))continue;if(j)if(z)for(const e of W.get())j.numRenderedVerticesInShadowPass+=e.primitiveLength;else for(const e of W.get())j.numRenderedVerticesInTransparentPass+=e.primitiveLength;const $=[];(t.terrain||l)&&$.push(m.centroidVertexBuffer),w&&$.push(m.layoutVertexExtBuffer),P&&$.push(m.wallVertexBuffer),M.draw(t,c.gl.TRIANGLES,o,s,a,Gi.backCCW,H,r.id,m.layoutVertexBuffer,m.indexBuffer,W,r.paint,t.transform.zoom,v,$)}t.shadowRenderer&&(t.shadowRenderer.useNormalOffset=!1)}function jo(t,i,r,n,o,s,a,l,c,u,h,d,p,f,m,g,y,_,v){const x=t.context,b=x.gl,w=t.transform,S=t.transform.zoom,T=[],M=er(t,r.paint.get("fill-extrusion-cutoff-fade-range"));"clear"===u?(T.push("CLEAR_SUBPASS"),v&&(T.push("CLEAR_FROM_TEXTURE"),x.activeTexture.set(b.TEXTURE0),v.bind(b.LINEAR,b.CLAMP_TO_EDGE))):"sdf"===u&&T.push("SDF_SUBPASS"),y&&T.push("HAS_CENTROID"),M.shouldRenderCutoff&&T.push("RENDER_CUTOFF");const A=r.layout.get("fill-extrusion-edge-radius"),C=(e,i,n,u,_)=>{const b=i.programConfigurations.get(r.id),w=t.isTileAffectedByFog(e),C=t.getOrCreateProgram("fillExtrusionGroundEffect",{config:b,defines:T,overrideFog:w}),E=((e,t,i,r,n,o,s,a,l,c,u)=>({u_matrix:t,u_opacity:i,u_ao_pass:r?1:0,u_meter_to_tile:n,u_ao:o,u_flood_light_intensity:s,u_flood_light_color:a,u_attenuation:l,u_edge_radius:c,u_fb:0,u_fb_size:u,u_dynamic_offset:1}))(0,u,h,c,_,[d,p*_],f,m,g,S>=17?0:A*_,v?v.size[0]:0),P=[];y&&P.push(i.hiddenByLandmarkVertexBuffer),t.uploadCommonUniforms(x,C,e.toUnwrapped(),null,M),C.draw(t,x.gl.TRIANGLES,o,s,a,l,E,r.id,i.vertexBuffer,i.indexBuffer,n,r.paint,S,b,P)};for(const E of n){const n=i.getTile(E),o=n.getBucket(r);if(!o||o.projection.name!==w.projection.name||!o.groundEffect||o.groundEffect&&!o.groundEffect.hasData())continue;const s=o.groundEffect,a=1/o.tileToMeter;{const e=t.translatePosMatrix(E.projMatrix,n,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),i=s.getDefaultSegment();C(E,s,i,e,a)}if(_)for(let l=0;l<4;l++){const o=e.d4[l](E),s=i.getTile(o);if(!s)continue;const c=s.getBucket(r);if(!c||c.projection.name!==w.projection.name||!c.groundEffect||c.groundEffect&&!c.groundEffect.hasData())continue;const u=c.groundEffect;let h,d;0===l?(h=[-e.ag,0,0],d=1):1===l?(h=[e.ag,0,0],d=0):2===l?(h=[0,-e.ag,0],d=3):(h=[0,e.ag,0],d=2);const p=u.regionSegments[d];if(!p)continue;const f=new Float32Array(16);e.ab.mat4.translate(f,E.projMatrix,h),C(E,u,p,t.translatePosMatrix(f,n,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),a)}}}function Vo(t,i,r,n,o,s,a){0===n.centroidVertexArray.length&&n.createCentroidsBuffer();const l=s?s.findDEMTileFor(r):null;if(!(l&&l.dem||a))return;s&&l&&l.dem&&n.selfDEMTileTimestamp!==l.dem._timestamp&&(n.borderDoneWithNeighborZ=[-1,-1,-1,-1],n.selfDEMTileTimestamp=l.dem._timestamp);const c=t=>new e.P(Math.ceil((t+e.d7)*e.d8),0),u=e=>{const t=i.getSource().minzoom,r=e=>{const t=i.getTileByID(e);if(t&&t.hasData())return t.getBucket(o)},n=[0,-1,1];for(const i of n){if(e.overscaledZ+i<t)continue;const n=r(e.calculateScaledKey(e.overscaledZ+i));if(n)return n}},h=[0,0,0],d=(t,i)=>(h[0]=Math.min(t.min.y,i.min.y),h[1]=Math.max(t.max.y,i.max.y),h[2]=e.ag-i.min.x>t.max.x?i.min.x-e.ag:t.max.x,h),p=(t,i)=>(h[0]=Math.min(t.min.x,i.min.x),h[1]=Math.max(t.max.x,i.max.x),h[2]=e.ag-i.min.y>t.max.y?i.min.y-e.ag:t.max.y,h),f=[(e,t)=>d(e,t),(e,t)=>d(t,e),(e,t)=>p(e,t),(e,t)=>p(t,e)],m=(t,i,n,o,a,c,u)=>{if(!s)return 0;const h=[[c?n:t,c?t:n,0],[c?n:i,c?i:n,0]],d=u<0?e.ag+u:u,p=[c?d:(t+i)/2,c?(t+i)/2:d,0];return 0===n&&u<0||0!==n&&u>0?s.getForTilePoints(a,[p],!0,o):h.push(p),s.getForTilePoints(r,h,!0,l),Math.max(h[0][2],h[1][2],p[2])/s.exaggeration()};for(let _=0;_<4;_++){const t=n.borderFeatureIndices[_];if(0===t.length)continue;const i=e.d4[_](r),o=u(i);if(!(o&&o instanceof e.d5))continue;const l=s?s.findDEMTileFor(i):null;if(!(l&&l.dem||a))continue;if(s&&l&&l.dem&&n.borderDEMTileTimestamp[_]!==l.dem._timestamp&&(n.borderDoneWithNeighborZ[_]=-1,n.borderDEMTileTimestamp[_]=l.dem._timestamp),n.borderDoneWithNeighborZ[_]===o.canonical.z)continue;0===o.centroidVertexArray.length&&o.createCentroidsBuffer();const h=(_<2?1:5)-_,d=o.borderDoneWithNeighborZ[h]!==n.canonical.z,p=o.borderFeatureIndices[h];let v=0;if(n.canonical.z!==o.canonical.z){for(const e of t)n.showCentroid(n.featuresOnBorder[e]);if(d)for(const e of p)o.showCentroid(o.featuresOnBorder[e]);n.borderDoneWithNeighborZ[_]=o.canonical.z,o.borderDoneWithNeighborZ[h]=n.canonical.z}for(const r of t){const t=n.featuresOnBorder[r],s=n.centroidData[t.centroidDataIndex],u=t.borders[_];let d;for(;v<p.length;){d=o.featuresOnBorder[p[v]];const e=d.borders[h];if(e[1]>u[0]+3||e[0]>u[0]-3)break;o.showCentroid(d),v++}if(d&&v<p.length){const r=v;let x=0;for(;!(d.borders[h][0]>u[1]-3)&&(x++,++v!==p.length);)d=o.featuresOnBorder[p[v]];d=o.featuresOnBorder[p[r]];let b=!1;if(x>=1){const e=d.borders[h];Math.abs(u[0]-e[0])<3&&Math.abs(u[1]-e[1])<3&&(x=1,b=!0,v=r+1)}else if(0===x){n.showCentroid(t);continue}const w=o.centroidData[d.centroidDataIndex];a&&b&&(((g=s).flags|(y=w).flags)&e.d6?(g.flags|=e.d6,y.flags|=e.d6):(g.flags&=~e.d6,y.flags&=~e.d6));const S=t.intersectsCount()>1||d.intersectsCount()>1;if(x>1)v=r,s.centroidXY=w.centroidXY=new e.P(0,0);else if(l&&l.dem&&!S){const t=f[_](s,w),r=_%2?e.ag-1:0,n=m(t[0],Math.min(e.ag-1,t[1]),r,l,i,_<2,t[2]);s.centroidXY=w.centroidXY=c(n)}else S?s.centroidXY=w.centroidXY=new e.P(0,0):(s.centroidXY=n.encodeBorderCentroid(t),w.centroidXY=o.encodeBorderCentroid(d));n.writeCentroidToBuffer(s),o.writeCentroidToBuffer(w)}else n.showCentroid(t)}n.borderDoneWithNeighborZ[_]=o.canonical.z,o.borderDoneWithNeighborZ[h]=n.canonical.z}var g,y;(n.needsCentroidUpdate||!n.centroidVertexBuffer&&0!==n.centroidVertexArray.length)&&n.uploadCentroid(t)}const Uo=[1,0,0],Go=[0,1,0],Ho=[0,0,1];function Wo(t,i,r){const n=r.transform,o=r.shadowRenderer;if(!o)return!0;const s=t.toUnwrapped(),a=n.tileSize*o._cascades[r.currentShadowCascade].scale;let l=i.maxHeight;if(n.elevation){const e=n.elevation.getMinMaxForTile(t);e&&(l+=e.max)}const c=[...o.shadowDirection];c[2]=-c[2];const u=o.computeSimplifiedTileShadowVolume(s,l,a,c);if(!u)return!1;const h=[Uo,Go,Ho,c,[c[0],0,c[2]],[0,c[1],c[2]]],d="globe"===n.projection.name,p=n.scaleZoom(a),f=e.bR.fromInvProjectionMatrix(n.invProjMatrix,n.worldSize,p,!d),m=o.getCurrentCascadeFrustum();return 0===f.intersectsPrecise(u.vertices,u.planes,h)||0===m.intersectsPrecise(u.vertices,u.planes,h)}function $o(t){return[t[0]*e.d9,t[1]*e.d9,t[2]*e.d9,0]}function qo(t,i,r,n,o,s,a,l,c){const u=n.getSource(),h=r.globeSharedBuffers;if(!h)return;let d,p,f;if(i&&(d=n.getTile(i)),u instanceof e.aJ?(p=u.texture,f=e.cI(0,0,r.transform)):d&&i&&(p=d.texture,f=e.cI(i.canonical.z,i.canonical.x,r.transform)),!p||!f)return;t||(f=e.ab.mat4.scale(e.ab.mat4.create(),f,[1,-1,1]));const m=r.context,g=m.gl,y="nearest"===o.paint.get("raster-resampling")?g.NEAREST:g.LINEAR,_=r.colorModeForDrapableLayerRenderPass(s),v=a.defines;v.push("GLOBE_POLES");const x=new Bi(g.LEQUAL,Bi.ReadWrite,r.depthRangeFor3D),b=Float32Array.from(r.transform.expandedFarZProjMatrix),w=Float32Array.from(e.bb(e.cH(new e.bT(0,0,0))));r.terrain&&r.terrain.prepareDrawTile(),m.activeTexture.set(g.TEXTURE0),p.bind(y,g.CLAMP_TO_EDGE),m.activeTexture.set(g.TEXTURE1),p.bind(y,g.CLAMP_TO_EDGE),p.useMipmap&&m.extTextureFilterAnisotropic&&r.transform.pitch>20&&g.texParameterf(g.TEXTURE_2D,m.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,m.extTextureFilterAnisotropicMax);const[S,T,M,A]=i?h.getPoleBuffers(i.canonical.z,!1):h.getPoleBuffers(0,!0),C=o.paint.get("raster-elevation");let E;t?(E=S,r.renderDefaultNorthPole=0!==C):(E=T,r.renderDefaultSouthPole=0!==C);const P=$o(a.mix),k=((e,t,i,r,n,o,s,a,l,c,u,h,d)=>uo(e,t,i,new Float32Array(16),new Float32Array(9),[0,0],r,[0,0],[0,0,0,0],1,{opacity:1,mix:0},o,[0,0]||0,a,2,c,u,h,1,0,d))(b,w,f,e.ae(r.transform.zoom),0,o,0,C,0,P,a.offset,a.range,s),I=r.getOrCreateProgram("raster",{defines:v});r.uploadCommonUniforms(m,I,null),I.draw(r,g.TRIANGLES,x,c,_,l,k,o.id,E,M,A)}function Xo(e){const t=e._nearZ,i=e.projection.farthestPixelDistance(e),r=i-t,n=.2*e.height,o=t+n;return[t,i,(o-n-t)/r,(o-t)/r]}function Yo(e,t,i,r){if(e)return t instanceof rt&&e instanceof wt?t.getTextureDescriptor(e,i,!0):{texture:e.texture,mix:$o(r.mix),offset:r.offset,buffer:0,tileSize:1}}var Zo=e.da([{name:"a_index",type:"Int16",components:1}]);class Ko{constructor(t,i,r,n){const o={width:r[0],height:r[1],data:null},s=t.gl;this.targetColorTexture=new e.T(t,o,s.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new e.T(t,o,s.RGBA8,{useMipmap:!1}),this.context=t,this.updateParticleTexture(i,n),this.lastInvalidatedAt=0}updateParticleTexture(t,i){if(this.particleTextureDimension===i.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const r=this.context.gl,n=i.width*i.height;this.particleTexture0=new e.T(this.context,i,r.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new e.T(this.context,i,r.RGBA8,{premultiply:!1,useMipmap:!1});const o=new e.db;o.reserve(n);for(let e=0;e<n;e++)o.emplaceBack(e);this.particleIndexBuffer=this.context.createVertexBuffer(o,Zo.members,!0),this.particleSegment=e.b7.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=i.width}update(t){return!(this.lastInvalidatedAt<t&&(this.lastInvalidatedAt=e.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function Jo(t,i,r){if(!t)return null;const n=i.getTextureDescriptor(t,r,!0);if(!n)return null;let{texture:o,mix:s,offset:a,tileSize:l,buffer:c,format:u}=n;if(!o||!u)return null;let h=!1;return"uint32"===u&&(h=!0,s[3]=0,s=lo(e.dc,s,[0,r.paint.get("raster-particle-max-speed")]),a=co(e.dc,a,[0,r.paint.get("raster-particle-max-speed")])),{texture:o,textureOffset:[c/(l+2*c),l/(l+2*c)],tileSize:l,scalarData:h,scale:s,offset:a,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[u]]}}function Qo(e){const t=e._nearZ,i=e.projection.farthestPixelDistance(e),r=i-t,n=.2*e.height,o=t+n;return[t,i,(o-n-t)/r,(o-t)/r]}const es=new e.aj(1,0,0,1),ts=new e.aj(0,1,0,1),is=new e.aj(0,0,1,1),rs=new e.aj(1,0,1,1),ns=new e.aj(0,1,1,1);function os(t,i,r,n,o,s,a){const l=t.context,c=t.transform,u=l.gl,h="globe"===c.projection.name,d=h?["PROJECTION_GLOBE_VIEW"]:[];let p=e.ab.mat4.clone(r.projMatrix);if(h&&e.ae(c.zoom)>0){const t=e.ba(r.canonical,c),i=e.dd(t);p=e.ab.mat4.multiply(new Float32Array(16),c.globeMatrix,i),e.ab.mat4.multiply(p,c.projMatrix,p)}const f=e.ab.mat4.create();f[12]+=2*o/(e.q.devicePixelRatio*c.width),f[13]+=2*s/(e.q.devicePixelRatio*c.height),e.ab.mat4.multiply(p,f,p);const m=t.getOrCreateProgram("debug",{defines:d}),g=i.getTileByID(r.key);t.terrain&&t.terrain.setupElevationDraw(g,m);const y=Bi.disabled,_=ji.disabled,v=t.colorModeForRenderPass(),x="$debug";l.activeTexture.set(u.TEXTURE0),t.emptyTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),h?g._makeGlobeTileDebugBuffers(t.context,c):g._makeDebugTileBoundsBuffers(t.context,c.projection);const b=g._tileDebugBuffer||t.debugBuffer,w=g._tileDebugIndexBuffer||t.debugIndexBuffer,S=g._tileDebugSegments||t.debugSegments;if(m.draw(t,u.LINE_STRIP,y,_,v,Gi.disabled,oo(p,n),x,b,w,S,null,null,null,[g._globeTileDebugBorderBuffer]),a){const e=g.latestRawTileData,i=Math.floor((e&&e.byteLength||0)/1024);let n=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(n+=` => ${r.overscaledZ}`),n+=` ${g.state}`,n+=` ${i}kb`,function(e,t){e.initDebugOverlayCanvas();const i=e.debugOverlayCanvas,r=e.context.gl,n=e.debugOverlayCanvas.getContext("2d");n.clearRect(0,0,i.width,i.height),n.shadowColor="white",n.shadowBlur=2,n.lineWidth=1.5,n.strokeStyle="white",n.textBaseline="top",n.font="bold 36px Open Sans, sans-serif",n.fillText(t,5,5),n.strokeText(t,5,5),e.debugOverlayTexture.update(i),e.debugOverlayTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}(t,n)}const T=i.getTile(r).tileSize,M=512/Math.min(T,512)*(r.overscaledZ/c.zoom)*.5,A=g._tileDebugTextBuffer||t.debugBuffer,C=g._tileDebugTextIndexBuffer||t.quadTriangleIndexBuffer,E=g._tileDebugTextSegments||t.debugSegments;m.draw(t,u.TRIANGLES,y,_,Fi.alphaBlended,Gi.disabled,oo(p,e.aj.transparent,M),x,A,C,E,null,null,null,[g._globeTileDebugTextBuffer])}function ss(e,t,i,r){ls(e,0,t+i/2,e.transform.width,i,r)}function as(e,t,i,r){ls(e,t-i/2,0,i,e.transform.height,r)}function ls(t,i,r,n,o,s){const a=t.context,l=a.gl;l.enable(l.SCISSOR_TEST),l.scissor(i*e.q.devicePixelRatio,r*e.q.devicePixelRatio,n*e.q.devicePixelRatio,o*e.q.devicePixelRatio),a.clear({color:s}),l.disable(l.SCISSOR_TEST)}const cs=e.da([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:us}=cs;function hs(e,t,i,r){e.emplaceBack(t,i,r)}class ds{constructor(t){this.vertexArray=new e.de,this.indices=new e.aU,hs(this.vertexArray,-1,-1,1),hs(this.vertexArray,1,-1,1),hs(this.vertexArray,-1,1,1),hs(this.vertexArray,1,1,1),hs(this.vertexArray,-1,-1,-1),hs(this.vertexArray,1,-1,-1),hs(this.vertexArray,-1,1,-1),hs(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=t.createVertexBuffer(this.vertexArray,us),this.indexBuffer=t.createIndexBuffer(this.indices),this.segment=e.b7.simpleSegment(0,0,36,12)}}function ps(t,i,r,n,o,s){const a=t.context.gl,l=i.paint.get("sky-atmosphere-color"),c=i.paint.get("sky-atmosphere-halo-color"),u=i.paint.get("sky-atmosphere-sun-intensity"),h=((e,t,i,r,n)=>({u_matrix_3f:e,u_sun_direction:t,u_sun_intensity:i,u_color_tint_r:[r.r,r.g,r.b,r.a],u_color_tint_m:[n.r,n.g,n.b,n.a],u_luminance:5e-5}))(e.ab.mat3.fromMat4(e.ab.mat3.create(),n),o,u,l,c);a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_CUBE_MAP_POSITIVE_X+s,i.skyboxTexture,0),r.draw(t,a.TRIANGLES,Bi.disabled,ji.disabled,Fi.unblended,Gi.frontCW,h,"skyboxCapture",i.skyboxGeometry.vertexBuffer,i.skyboxGeometry.indexBuffer,i.skyboxGeometry.segment)}const fs=e.da([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class ms{constructor(t){const i=new e.df;i.emplaceBack(-1,1,1,0,0),i.emplaceBack(1,1,1,1,0),i.emplaceBack(1,-1,1,1,1),i.emplaceBack(-1,-1,1,0,1);const r=new e.aU;r.emplaceBack(0,1,2),r.emplaceBack(2,3,0),this.vertexBuffer=t.createVertexBuffer(i,fs.members),this.indexBuffer=t.createIndexBuffer(r),this.segments=e.b7.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const gs=e.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class ys{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class _s{constructor(t){this.colorModeAlphaBlendedWriteRGB=new Fi([1,Oi,1,Oi],e.aj.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Fi([1,0,1,0],e.aj.transparent,[!1,!1,!1,!0]),this.params=new ys,this.updateNeeded=!0,t.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},(()=>{this.updateNeeded=!0})),t.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),t.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},(()=>{this.updateNeeded=!0})),t.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},(()=>{this.updateNeeded=!0}))}update(t){const i=t.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new ms(i);const t=this.params.sizeRange,r=this.params.intensityRange,n=function(t){const i=e.di(30),r=[];for(let n=0;n<t;++n){const t=2*Math.PI*i(),n=Math.acos(1-2*i())-.5*Math.PI;r.push(e.ab.vec3.fromValues(Math.cos(n)*Math.cos(t),Math.cos(n)*Math.sin(t),Math.sin(n)))}return r}(this.params.starsCount),o=e.di(300),s=new e.dg,a=new e.aU;let l=0;for(let i=0;i<n.length;++i){const c=e.ab.vec3.scale([],n[i],200),u=Math.max(0,1+.01*t*(1*o()-.5)),h=Math.max(0,1+.01*r*(1*o()-.5));s.emplaceBack(c[0],c[1],c[2],-1,-1,u,h),s.emplaceBack(c[0],c[1],c[2],1,-1,u,h),s.emplaceBack(c[0],c[1],c[2],1,1,u,h),s.emplaceBack(c[0],c[1],c[2],-1,1,u,h),a.emplaceBack(l+0,l+1,l+2),a.emplaceBack(l+0,l+2,l+3),l+=4}this.starsVx=i.createVertexBuffer(s,gs.members),this.starsIdx=i.createIndexBuffer(a),this.starsSegments=e.b7.simpleSegment(0,0,s.length,a.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(t,i){const r=t.context,n=r.gl,o=t.transform,s=new Bi(n.LEQUAL,Bi.ReadOnly,[0,1]),a=e.ae(o.zoom),l=t.style.getLut(i.scope),c="none"===i.properties.get("color-use-theme"),u=i.properties.get("color").toRenderColor(c?null:l).toArray01(),h="none"===i.properties.get("high-color-use-theme"),d=i.properties.get("high-color").toRenderColor(h?null:l).toArray01(),p="none"===i.properties.get("space-color-use-theme"),f=i.properties.get("space-color").toRenderColor(p?null:l).toArray01PremultipliedAlpha(),m=5e-4,g=e.dh(i.properties.get("horizon-blend"),0,1,m,.25),y=e.cC(t,r,o)&&g===m?o.worldSize/(2*Math.PI*1.025)-1:o.globeRadius,_=t.frameCounter/1e3%1,v=e.ab.vec3.length(o.globeCenterInViewSpace),x=Math.sqrt(Math.pow(v,2)-Math.pow(y,2)),b=Math.acos(x/v),w=e=>{const i="globe"===o.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];e&&i.push("ALPHA_PASS");const l=t.getOrCreateProgram("globeAtmosphere",{defines:i}),c=((e,t,i,r,n,o,s,a,l,c,u,h)=>({u_frustum_tl:e,u_frustum_tr:t,u_frustum_br:i,u_frustum_bl:r,u_horizon:n,u_transition:o,u_fadeout_range:s,u_color:a,u_high_color:l,u_space_color:c,u_temporal_offset:u,u_horizon_angle:h}))(o.frustumCorners.TL,o.frustumCorners.TR,o.frustumCorners.BR,o.frustumCorners.BL,o.frustumCorners.horizon,a,g,u,d,f,_,b);t.uploadCommonUniforms(r,l);const h=this.atmosphereBuffer;h&&l.draw(t,n.TRIANGLES,s,ji.disabled,e?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Gi.backCW,c,e?"atmosphere_glow_alpha":"atmosphere_glow",h.vertexBuffer,h.indexBuffer,h.segments)};w(!1),w(!0)}drawStars(t,i){const r=e.aw(i.properties.get("star-intensity"),0,1);if(0===r)return;const n=t.context,o=n.gl,s=t.transform,a=t.getOrCreateProgram("stars"),l=e.ab.quat.identity([]);e.ab.quat.rotateX(l,l,-s._pitch),e.ab.quat.rotateZ(l,l,-s.angle),e.ab.quat.rotateX(l,l,e.ai(s._center.lat)),e.ab.quat.rotateY(l,l,-e.ai(s._center.lng));const c=e.ab.mat4.fromQuat(new Float32Array(16),l),u=e.ab.mat4.multiply([],s.starsProjMatrix,c),h=e.ab.mat3.fromMat4([],c),d=e.ab.mat3.invert([],h),p=[0,1,0];e.ab.vec3.transformMat3(p,p,d),e.ab.vec3.scale(p,p,this.params.sizeMultiplier);const f=[1,0,0];e.ab.vec3.transformMat3(f,f,d),e.ab.vec3.scale(f,f,this.params.sizeMultiplier);const m=(g=p,y=f,_=r,{u_matrix:Float32Array.from(u),u_up:g,u_right:y,u_intensity_multiplier:_});var g,y,_;t.uploadCommonUniforms(n,a),this.starsVx&&this.starsIdx&&a.draw(t,o.TRIANGLES,Bi.disabled,ji.disabled,this.colorModeAlphaBlendedWriteRGB,Gi.disabled,m,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function vs(t,i){const r=[...t],n=i.cameraWorldSizeForFog/i.worldSize,o=e.ab.mat4.identity([]);return e.ab.mat4.scale(o,o,[n,n,1]),e.ab.mat4.multiply(r,o,r),e.ab.mat4.multiply(r,i.worldToFogMatrix,r),r}function xs(t,i,r,n,o){const s=r.material,a=n.context,{baseColorTexture:l,metallicRoughnessTexture:c}=s.pbrMetallicRoughness,{normalTexture:u,occlusionTexture:h,emissionTexture:d}=s;function p(e,i,r){if(e&&(t.push(i),a.activeTexture.set(a.gl.TEXTURE0+r),e.gfxTexture)){const{minFilter:t,magFilter:i,wrapS:r,wrapT:n}=e.sampler;e.gfxTexture.bindExtraParam(t,i,r,n)}}p(l,"HAS_TEXTURE_u_baseColorTexture",Yi.BaseColor),p(c,"HAS_TEXTURE_u_metallicRoughnessTexture",Yi.MetallicRoughness),p(u,"HAS_TEXTURE_u_normalTexture",Yi.Normal),p(h,"HAS_TEXTURE_u_occlusionTexture",Yi.Occlusion),p(d,"HAS_TEXTURE_u_emissionTexture",Yi.Emission),o&&(o.texture||(o.texture=new e.dk(n.context,o.image,[o.image.height,o.image.height,o.image.height],a.gl.RGBA8)),a.activeTexture.set(a.gl.TEXTURE0+Yi.LUT),o.texture&&o.texture.bind(a.gl.LINEAR,a.gl.CLAMP_TO_EDGE),t.push("APPLY_LUT_ON_GPU")),r.texcoordBuffer&&(t.push("HAS_ATTRIBUTE_a_uv_2f"),i.push(r.texcoordBuffer)),r.colorBuffer&&(t.push(12===r.colorBuffer.itemSize?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),i.push(r.colorBuffer)),r.normalBuffer&&(t.push("HAS_ATTRIBUTE_a_normal_3f"),i.push(r.normalBuffer)),r.pbrBuffer&&(t.push("HAS_ATTRIBUTE_a_pbr"),t.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),i.push(r.pbrBuffer)),"OPAQUE"!==s.alphaMode&&"MASK"!==s.alphaMode||t.push("UNPREMULT_TEXTURE_IN_SHADER"),s.defined||t.push("DIFFUSE_SHADED");const f=n.shadowRenderer;f&&(t.push("RENDER_SHADOWS","DEPTH_TEXTURE"),f.useNormalOffset&&t.push("NORMAL_OFFSET"))}function bs(t,i,r,n,o,s){const a=r.paint.get("model-opacity").constantOr(1),l=i.context,c=new Bi(i.context.gl.LEQUAL,Bi.ReadWrite,i.depthRangeFor3D),u=i.transform,h=t.mesh,d=h.material,p=d.pbrMetallicRoughness,f=i.style.fog;let m;m="pixels"===i.transform.projection.zAxisUnit?[...t.nodeModelMatrix]:e.ab.mat4.multiply([],n.zScaleMatrix,t.nodeModelMatrix),e.ab.mat4.multiply(m,n.negCameraPosMatrix,m);const g=e.ab.mat4.invert([],m);e.ab.mat4.transpose(g,g);const y="none"===r.paint.get("model-color-use-theme").constantOr("default"),_=r.paint.get("model-emissive-strength").constantOr(0),v=wo(new Float32Array(t.worldViewProjection),new Float32Array(m),new Float32Array(g),null,i,a,p.baseColorFactor.toRenderColor(null),d.emissiveFactor,p.metallicFactor,p.roughnessFactor,d,_,r),x={defines:[]},b=[],w=i.shadowRenderer;w&&(w.useNormalOffset=!1),xs(x.defines,b,h,i,y?null:r.lut);let S=null;if(f){const e=vs(t.nodeModelMatrix,i.transform);if(S=new Float32Array(e),"globe"!==u.projection.name){const t=h.aabb.min,i=h.aabb.max,[r,n]=f.getOpacityForBounds(e,t[0],t[1],i[0],i[1]);x.overrideFog=r>=Oe||n>=Oe}}const T=er(i,r.paint.get("model-cutoff-fade-range"));T.shouldRenderCutoff&&x.defines.push("RENDER_CUTOFF");const M=i.getOrCreateProgram("model",x);i.uploadCommonUniforms(l,M,null,S,T),"shadow"!==i.renderPass&&w&&w.setupShadowsFromMatrix(t.nodeModelMatrix,M),M.draw(i,l.gl.TRIANGLES,c,o,s,h.material.doubleSided?Gi.disabled:Gi.backCCW,v,r.id,h.vertexBuffer,h.indexBuffer,h.segments,r.paint,i.transform.zoom,void 0,b)}function ws(t,i,r,n,o,s,a){let l;l="globe"===t.projection.name?e.dl(r,t):[...r],e.ab.mat4.multiply(l,l,i.matrix);const c=e.ab.mat4.multiply([],n,l);if(i.meshes)for(const u of i.meshes){if("BLEND"!==u.material.alphaMode){a.push({mesh:u,depth:0,modelIndex:o,worldViewProjection:c,nodeModelMatrix:l});continue}const i=e.ab.vec3.transformMat4([],u.centroid,c);!t.isOrthographic&&i[2]<=0||s.push({mesh:u,depth:i[2],modelIndex:o,worldViewProjection:c,nodeModelMatrix:l})}if(i.children)for(const e of i.children)ws(t,e,r,n,o,s,a)}function Ss(e,t,i,r){const n=i.shadowRenderer;if(!n)return;const o=n.getShadowPassDepthMode(),s=n.getShadowPassColorMode(),a=n.calculateShadowPassMatrixFromMatrix(t),l=So(a);i.getOrCreateProgram("modelDepth",{defines:i._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(i,i.context.gl.TRIANGLES,o,ji.disabled,s,Gi.backCCW,l,r.id,e.vertexBuffer,e.indexBuffer,e.segments,r.paint,i.transform.zoom,void 0,void 0)}function Ts(t,i,r){const n=i.updateZoomBasedPaintProperties(),o=function(t,i,r){let n,o,s,a=t.terrain?t.terrain.exaggeration():0;if(t.terrain&&a>0){const i=t.terrain,o=i.findDEMTileFor(r);o&&o.dem?n=e.dn.create(i,r,o):a=0}if(0===a&&(i.terrainElevationMin=0,i.terrainElevationMax=0),a===i.validForExaggeration&&(0===a||n&&n._demTile&&n._demTile.tileID===i.validForDEMTile.id&&n._dem._timestamp===i.validForDEMTile.timestamp))return!1;for(const e in i.instancesPerModel){const t=i.instancesPerModel[e];for(let e=0;e<t.instancedDataArray.length;++e){const r=(n?a*n.getElevationAt(0|t.instancedDataArray.float32[16*e],0|t.instancedDataArray.float32[16*e+1],!0,!0):0)+t.instancesEvaluatedElevation[e];t.instancedDataArray.float32[16*e+6]=r,o=o?Math.min(i.terrainElevationMin,r):r,s=s?Math.max(i.terrainElevationMax,r):r}}return i.terrainElevationMin=o||0,i.terrainElevationMax=s||0,i.validForExaggeration=a,i.validForDEMTile=n&&n._demTile?{id:n._demTile.tileID,timestamp:n._dem._timestamp}:{id:void 0,timestamp:0},!0}(t,i,r);(n||o)&&(i.uploaded=!1,i.upload(t.context))}const Ms={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new e.cd([0,0,0],[e.ag,e.ag,0])};function As(t,i){const r=1<<t.canonical.z,n=i.getFreeCameraOptions().position,o=i.elevation,s=t.canonical.x/r,a=(t.canonical.x+1)/r,l=t.canonical.y/r,c=(t.canonical.y+1)/r;let u=i._centerAltitude;if(o){const e=o.getMinMaxForTile(t);e&&e.max>u&&(u=e.max)}const h=e.aw(n.x,s,a)-n.x,d=e.aw(n.y,l,c)-n.y,p=e.bH(u,i.center.lat)-n.z;return i._zoomFromMercatorZ(Math.sqrt(h*h+d*d+p*p))}function Cs(e,t,i,r,n,o,s){const a=e.context,l="shadow"===e.renderPass,c=e.shadowRenderer,u=l&&c?c.getShadowPassDepthMode():new Bi(a.gl.LEQUAL,Bi.ReadWrite,e.depthRangeFor3D),h=e.isTileAffectedByFog(o);if(i.meshes)for(const d of i.meshes){const p=["MODEL_POSITION_ON_GPU"],f=[];let m,g,y;r.instancedDataArray.length>20&&p.push("INSTANCED_ARRAYS");const _=er(e,t.paint.get("model-cutoff-fade-range"));if(_.shouldRenderCutoff&&p.push("RENDER_CUTOFF"),l&&c)m=e.getOrCreateProgram("modelDepth",{defines:p}),g=So(s.shadowTileMatrix,s.shadowTileMatrix,Float32Array.from(i.matrix)),y=c.getShadowPassColorMode();else{xs(p,f,d,e,"none"===t.paint.get("model-color-use-theme").constantOr("default")?null:t.lut),m=e.getOrCreateProgram("model",{defines:p,overrideFog:h});const r=d.material,l=r.pbrMetallicRoughness,u=t.paint.get("model-opacity").constantOr(1),v=t.paint.get("model-emissive-strength").constantOr(0);g=wo(o.expandedProjMatrix,Float32Array.from(i.matrix),new Float32Array(16),null,e,u,l.baseColorFactor.toRenderColor(null),r.emissiveFactor,l.metallicFactor,l.roughnessFactor,r,v,t,n),c&&(s.shadowUniformsInitialized?m.setShadowUniformValues(a,c.getShadowUniformValues()):(c.setupShadows(o.toUnwrapped(),m,"model-tile",o.overscaledZ),s.shadowUniformsInitialized=!0)),y=_.shouldRenderCutoff||u<1||"OPAQUE"!==r.alphaMode?Fi.alphaBlended:Fi.unblended}e.uploadCommonUniforms(a,m,o.toUnwrapped(),null,_);const v=d.material.doubleSided?Gi.disabled:Gi.backCCW;if(r.instancedDataArray.length>20)f.push(r.instancedDataBuffer),m.draw(e,a.gl.TRIANGLES,u,ji.disabled,y,v,g,t.id,d.vertexBuffer,d.indexBuffer,d.segments,t.paint,e.transform.zoom,void 0,f,r.instancedDataArray.length);else{const i=l?"u_instance":"u_normal_matrix";for(let n=0;n<r.instancedDataArray.length;++n)g[i]=new Float32Array(r.instancedDataArray.arrayBuffer,64*n,16),m.draw(e,a.gl.TRIANGLES,u,ji.disabled,y,v,g,t.id,d.vertexBuffer,d.indexBuffer,d.segments,t.paint,e.transform.zoom,void 0,f)}}if(i.children)for(const d of i.children)Cs(e,t,d,r,n,o,s)}const Es=[1,-1,1];function Ps(t,i,r,n){if(!r.modelManager)return!0;const o=r.modelManager;if(!r.shadowRenderer)return!0;const s=r.shadowRenderer,a=i.aabb;let l=!0,c=t.maxHeight;if(0===c){let e=0;for(const i in t.instancesPerModel){const t=o.getModel(i,n);t?e=Math.max(e,Math.max(Math.max(t.aabb.max[0],t.aabb.max[1]),t.aabb.max[2])):l=!1}c=t.maxScale*e*1.41+t.maxVerticalOffset,l&&(t.maxHeight=c)}a.max[2]=c,a.min[2]+=t.terrainElevationMin,a.max[2]+=t.terrainElevationMax,e.ab.vec3.transformMat4(a.min,a.min,i.tileMatrix),e.ab.vec3.transformMat4(a.max,a.max,i.tileMatrix);const u=a.intersects(s.getCurrentCascadeFrustum());return 0===r.currentShadowCascade&&(t.isInsideFirstShadowMapFrustum=2===u),0===u}function ks(t,i){const r=t.uniformValues.u_cutoff_params[0],n=t.uniformValues.u_cutoff_params[1],o=t.uniformValues.u_cutoff_params[2],s=t.uniformValues.u_cutoff_params[3];return n===r||s===o?1:e.aw(((i-r)/(n-r)-o)/(s-o),0,1)}function Is(t,i,r,n){if(i.pitch<20)return 1;const o=i.getWorldToCameraMatrix();e.ab.mat4.multiply(o,o,t);const s=e.ab.vec4.fromValues(r.min[0],r.min[1],r.min[2],1);let a=e.ab.vec4.transformMat4(e.ab.vec4.create(),s,o),l=a,c=a;s[1]=r.max[1],a=e.ab.vec4.transformMat4(e.ab.vec4.create(),s,o),l=a[1]<l[1]?a:l,c=a[1]>c[1]?a:c,s[0]=r.max[0],a=e.ab.vec4.transformMat4(e.ab.vec4.create(),s,o),l=a[1]<l[1]?a:l,c=a[1]>c[1]?a:c,s[1]=r.min[1],a=e.ab.vec4.transformMat4(e.ab.vec4.create(),s,o),l=a[1]<l[1]?a:l,c=a[1]>c[1]?a:c;const u=e.aw(n[0],0,1),h=100*i.pixelsPerMeter*e.aw(n[1],0,1),d=e.aw(n[2],0,1),p=e.ab.vec4.lerp(e.ab.vec4.create(),l,c,u),f=Math.tan(.5*i.fovX),m=-p[2]*f;if(0===h)return p[1]<-Math.abs(m)?d:1;const g=(-Math.abs(m)-p[1])/h,y=(e,t,i)=>(1-i)*e+i*t,_=e.aw(y(1,d,g),d,1);return y(1,_,e.aw((i.pitch-20)/20,0,1))}class Ds{}class Ls{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(t,i,r){{const e=this._storage.get(i.id);if(e)return e.lastUsedFrameIdx=t,e.buf}const n=r.gl,o=n.getBufferParameter(n.ELEMENT_ARRAY_BUFFER,n.BUFFER_SIZE),s=new ArrayBuffer(o),a=new Int16Array(s);n.getBufferSubData(n.ELEMENT_ARRAY_BUFFER,0,new Int16Array(s));const l=new e.dq;for(let e=0;e<o/2;e+=3){const t=a[e],i=a[e+1],r=a[e+2];l.emplaceBack(t,i),l.emplaceBack(i,r),l.emplaceBack(r,t)}const c=r.bindVertexArrayOES.current,u=new Ds;return u.buf=new Mo(r,l),u.lastUsedFrameIdx=t,this._storage.set(i.id,u),r.bindVertexArrayOES.set(c),u.buf}update(e){for(const[t,i]of this._storage)e-i.lastUsedFrameIdx>30&&(i.buf.destroy(),this._storage.delete(t))}destroy(){for(const[e,t]of this._storage)t.buf.destroy(),this._storage.delete(e)}}class Rs{constructor(e){this.occluderSize=30,this.depthOffset=-1e-4,e.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),e.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const zs=e.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class Os{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class Fs{constructor(e,t){this.revealStart=11,this.revealRange=2,e.registerParameter(this,[...t,"Reveal"],"revealStart",{min:0,max:17,step:.05}),e.registerParameter(this,[...t,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const Bs=e.da([{type:"Float32",name:"a_pos_2f",components:2}]);class Ns{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(t,i){const r=t.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const i=new e.dr,r=new e.aU;i.emplaceBack(-1,-1),i.emplaceBack(1,-1),i.emplaceBack(1,1),i.emplaceBack(-1,1),r.emplaceBack(0,1,2),r.emplaceBack(0,2,3),this.vignetteVx=t.context.createVertexBuffer(i,Bs.members),this.vignetteIdx=t.context.createIndexBuffer(r)}const n=e.b7.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){t.uploadCommonUniforms(t.context,r);const e={u_vignetteShape:(o={vignetteShape:[i.start,i.range,Math.pow(10,i.fadePower)],vignetteColor:[i.color.r,i.color.g,i.color.b,i.color.a*i.strength]}).vignetteShape,u_vignetteColor:o.vignetteColor};r.draw(t,t.context.gl.TRIANGLES,Bi.disabled,ji.disabled,Fi.alphaBlended,Gi.disabled,e,"vignette",this.vignetteVx,this.vignetteIdx,n,{})}var o}}class js{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(t,i){const r=t.getFreeCameraOptions().position,n=r.toAltitude(),o=r.toLngLat(),s=e.ai(o.lng),a=e.ai(o.lat),l=t.pixelsPerMeter/i,c=s*e.ds,u=e.ds*Math.log(Math.tan(Math.PI/4+a/2));if(void 0===this._offsetXPrev)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const e=-this._offsetYPrev+u,t=-this._elevationPrev+n;this._accumulatedOffsetX+=(-this._offsetXPrev+c)*l,this._accumulatedOffsetY+=e*l,this._accumulatedElevation+=t*l,this._offsetXPrev=c,this._offsetYPrev=u,this._elevationPrev=n}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function Vs(e,t){return[-(e[0]-Math.floor(e[0]/t)*t),-(e[1]-Math.floor(e[1]/t)*t),-(e[2]-Math.floor(e[2]/t)*t)]}function Us(t){const i=e.di(1323123451230),r=[];for(let n=0;n<t;++n){const t=2*i()-1,n=2*i()-1,o=2*i()-1;r.push(e.ab.vec3.fromValues(t,n,o))}return r}function Gs(t,i,r,n,o){const s=e.aw((o-r)/(n-r),0,1);return(1-s)*t+s*i}class Hs{constructor(e){this._movement=new js,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new Ns,this._ppmScaleFactor=e}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(t,i){const r=t.transform;this._movement.update(r,this._ppmScaleFactor);const n=r.starsProjMatrix,o=e.ab.quat.identity([]);e.ab.quat.rotateX(o,o,e.ai(90)-r._pitch),e.ab.quat.rotateZ(o,o,-r.angle);const s=e.ab.mat4.fromQuat(new Float32Array(16),o),a=e.ab.mat4.fromValues(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),l=e.ab.mat4.transpose([],a),c=e.ab.mat4.multiply([],l,s),u=Date.now()/1e3;return this._accumulatedTimeFromStart+=(u-this._prevTime)*i,this._prevTime=u,{projectionMatrix:n,modelviewMatrix:c}}}class Ws extends Hs{constructor(e){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new Fs(e.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(t){const i=t.context;if(!this.particlesVx){const t=Us(this.particlesCount),r=new e.dt,n=new e.aU;let o=0;const s=e.di(1323123451230);for(let e=0;e<t.length;++e){const i=t[e],a=[2*s()-1,s(),s(),s()];r.emplaceBack(i[0],i[1],i[2],-1,-1,...a),r.emplaceBack(i[0],i[1],i[2],1,-1,...a),r.emplaceBack(i[0],i[1],i[2],1,1,...a),r.emplaceBack(i[0],i[1],i[2],-1,1,...a),n.emplaceBack(o+0,o+1,o+2),n.emplaceBack(o+0,o+2,o+3),o+=4}this.particlesVx=i.createVertexBuffer(r,zs.members),this.particlesIdx=i.createIndexBuffer(n)}}draw(t){if(!this._params.overrideStyleParameters&&!t.style.rain)return;const i=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},r=t.transform.zoom;if(i.revealStart>r)return;const n=Gs(0,1,i.revealStart,i.revealStart+i.revealRange,r);if(!this.particlesVx||!this.particlesIdx)return;const o=structuredClone(this._params);let s=[-o.direction.x,o.direction.y,-100];e.ab.vec3.normalize(s,s);const a=structuredClone(this._vignetteParams);a.strength*=n,o.overrideStyleParameters||(o.intensity=t.style.rain.state.density,o.timeFactor=t.style.rain.state.intensity,o.color=structuredClone(t.style.rain.state.color),s=structuredClone(t.style.rain.state.direction),o.screenThinning.intensity=t.style.rain.state.centerThinning,o.dropletSizeX=t.style.rain.state.dropletSize[0],o.dropletSizeYScale=t.style.rain.state.dropletSize[1]/t.style.rain.state.dropletSize[0],o.distortionStrength=100*t.style.rain.state.distortionStrength,a.strength=1,a.color=structuredClone(t.style.rain.state.vignetteColor));const l=this.updateOnRender(t,o.timeFactor),c=t.context,u=c.gl,h=t.transform;this.screenTexture&&this.screenTexture.size[0]===t.width&&this.screenTexture.size[1]===t.height||(this.screenTexture=new e.T(c,{width:t.width,height:t.height,data:null},u.RGBA8)),o.distortionStrength>0&&(c.activeTexture.set(u.TEXTURE0),this.screenTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.copyTexSubImage2D(u.TEXTURE_2D,0,0,0,0,0,t.width,t.height));const d=t.getOrCreateProgram("rainParticle");t.uploadCommonUniforms(c,d),c.activeTexture.set(u.TEXTURE0),this.screenTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE);const p=[o.color.r,o.color.g,o.color.b,o.color.a],f=(i,r)=>{const n=Vs(this._movement.getPosition(),i),a=o.dropletSizeX,c=o.dropletSizeX*o.dropletSizeYScale,f=t.width/2,m=t.height/2,g=Gs(0,o.screenThinning.start,0,1,o.screenThinning.intensity),y=Gs(.001,o.screenThinning.range,0,1,o.screenThinning.intensity),_=Gs(0,o.screenThinning.particleOffset,0,1,o.screenThinning.intensity),v=(x={modelview:l.modelviewMatrix,projection:l.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:n,velocityConeAperture:o.velocityConeAperture,velocity:o.velocity,boxSize:i,rainDropletSize:[a,c],distortionStrength:o.distortionStrength,rainDirection:s,color:p,screenSize:[h.width,h.height],thinningCenterPos:[f,m],thinningShape:[g,y,Math.pow(10,o.screenThinning.fadePower)],thinningAffectedRatio:o.screenThinning.affectedRatio,thinningParticleOffset:_,shapeDirectionalPower:o.shapeDirPower,shapeNormalPower:o.shapeNormalPower,mode:r?0:1},{u_modelview:Float32Array.from(x.modelview),u_projection:Float32Array.from(x.projection),u_time:x.time,u_cam_pos:x.camPos,u_texScreen:0,u_velocityConeAperture:x.velocityConeAperture,u_velocity:x.velocity,u_boxSize:x.boxSize,u_rainDropletSize:x.rainDropletSize,u_distortionStrength:x.distortionStrength,u_rainDirection:x.rainDirection,u_color:x.color,u_screenSize:x.screenSize,u_thinningCenterPos:x.thinningCenterPos,u_thinningShape:x.thinningShape,u_thinningAffectedRatio:x.thinningAffectedRatio,u_thinningParticleOffset:x.thinningParticleOffset,u_shapeDirectionalPower:x.shapeDirectionalPower,u_shapeNormalPower:x.shapeNormalPower,u_mode:x.mode});var x;const b=Math.round(o.intensity*this.particlesCount),w=e.b7.simpleSegment(0,0,4*b,2*b);d.draw(t,u.TRIANGLES,Bi.disabled,ji.disabled,Fi.alphaBlended,Gi.disabled,v,"rain_particles",this.particlesVx,this.particlesIdx,w,{})};o.distortionStrength>0&&f(o.boxSize,!0),f(o.boxSize,!1),this._vignette.draw(t,a)}}const $s=e.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class qs extends Hs{constructor(e){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new Fs(e.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(t){const i=t.context;if(!this.particlesVx){const t=Us(this.particlesCount),r=new e.du,n=new e.aU;let o=0;const s=e.di(1323123451230);for(let e=0;e<t.length;++e){const i=t[e],a=s(),l=s(),c=s(),u=[e/t.length,a,l,c],h=[s(),s()];r.emplaceBack(i[0],i[1],i[2],-1,-1,...u,...h),r.emplaceBack(i[0],i[1],i[2],1,-1,...u,...h),r.emplaceBack(i[0],i[1],i[2],1,1,...u,...h),r.emplaceBack(i[0],i[1],i[2],-1,1,...u,...h),n.emplaceBack(o+0,o+1,o+2),n.emplaceBack(o+0,o+2,o+3),o+=4}this.particlesVx=i.createVertexBuffer(r,$s.members),this.particlesIdx=i.createIndexBuffer(n)}}draw(t){if(!this._params.overrideStyleParameters&&!t.style.snow)return;const i=structuredClone(this._params);let r=[-i.direction.x,i.direction.y,-100];e.ab.vec3.normalize(r,r);const n=structuredClone(this._vignetteParams),o=i.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},s=t.transform.zoom;if(o.revealStart>s)return;const a=Gs(0,1,o.revealStart,o.revealStart+o.revealRange,s);n.strength*=a,i.overrideStyleParameters||(i.intensity=t.style.snow.state.density,i.timeFactor=t.style.snow.state.intensity,i.color=structuredClone(t.style.snow.state.color),r=structuredClone(t.style.snow.state.direction),i.screenThinning.intensity=t.style.snow.state.centerThinning,i.billboardSize=2.79*t.style.snow.state.flakeSize,n.strength=1,n.color=structuredClone(t.style.snow.state.vignetteColor));const l=this.updateOnRender(t,i.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const c=t.context,u=c.gl,h=t.transform,d=t.getOrCreateProgram("snowParticle");t.uploadCommonUniforms(c,d),((i,n,o)=>{const s=Vs(this._movement.getPosition(),i),a=h.width/2,c=h.height/2,p=Gs(0,o.screenThinning.start,0,1,o.screenThinning.intensity),f=Gs(.001,o.screenThinning.range,0,1,o.screenThinning.intensity),m=Gs(0,o.screenThinning.particleOffset,0,1,o.screenThinning.intensity),g=(y={modelview:l.modelviewMatrix,projection:l.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:s,velocityConeAperture:o.velocityConeAperture,velocity:o.velocity,horizontalOscillationRadius:o.horizontalOscillationRadius,horizontalOscillationRate:o.horizontalOscillationRate,boxSize:i,billboardSize:1*o.billboardSize,simpleShapeParameters:[o.shapeFadeStart,o.shapeFadePower],screenSize:[h.width,h.height],thinningCenterPos:[a,c],thinningShape:[p,f,Math.pow(10,o.screenThinning.fadePower)],thinningAffectedRatio:o.screenThinning.affectedRatio,thinningParticleOffset:m,color:[o.color.r,o.color.g,o.color.b,o.color.a],direction:r},{u_modelview:Float32Array.from(y.modelview),u_projection:Float32Array.from(y.projection),u_time:y.time,u_cam_pos:y.camPos,u_velocityConeAperture:y.velocityConeAperture,u_velocity:y.velocity,u_horizontalOscillationRadius:y.horizontalOscillationRadius,u_horizontalOscillationRate:y.horizontalOscillationRate,u_boxSize:y.boxSize,u_billboardSize:y.billboardSize,u_simpleShapeParameters:y.simpleShapeParameters,u_screenSize:y.screenSize,u_thinningCenterPos:y.thinningCenterPos,u_thinningShape:y.thinningShape,u_thinningAffectedRatio:y.thinningAffectedRatio,u_thinningParticleOffset:y.thinningParticleOffset,u_particleColor:y.color,u_direction:y.direction});var y;const _=Math.round(o.intensity*this.particlesCount),v=e.b7.simpleSegment(0,0,4*_,2*_);this.particlesVx&&this.particlesIdx&&d.draw(t,u.TRIANGLES,Bi.disabled,ji.disabled,Fi.alphaBlended,Gi.disabled,g,"snow_particles",this.particlesVx,this.particlesIdx,v,{})})(i.boxSize,0,i),this._vignette.draw(t,n)}}const Xs={symbol:function(t,i,r,n,o){if("translucent"!==t.renderPass)return;const s=ji.disabled,a=t.colorModeForRenderPass(),l=r.layout.get("text-variable-anchor"),c=r.layout.get("text-size-scale-range"),u=e.aw(t.scaleFactor,c[0],c[1]);l&&function(t,i,r,n,o,s,a,l){const c=i.transform,u="map"===o,h="map"===s;for(const d of t){const t=n.getTile(d),i=t.getBucket(r);if(!i||!i.text||!i.text.segments.get().length)continue;const o=e.bp(i.textSizeData,c.zoom,l),s=ci(d,i.getProjection(),c),p=c.calculatePixelsToTileUnitsMatrix(t),f=Ht(s,t.tileID.canonical,h,u,c,i.getProjection(),p),m=i.hasIconTextFit()&&i.hasIconData();if(o){const r=Math.pow(2,c.zoom-t.tileID.overscaledZ);zo(i,u,h,a,e.cX,c,f,d,r,o,m)}}}(n,t,r,i,r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),o,u);const h=0!==r.paint.get("icon-opacity").constantOr(1),d=0!==r.paint.get("text-opacity").constantOr(1);void 0!==r.layout.get("symbol-sort-key").constantOr(1)&&(h||d)?Oo(t,i,r,n,s,a):(h&&Oo(t,i,r,n,s,a,{onlyIcons:!0}),d&&Oo(t,i,r,n,s,a,{onlyText:!0})),i.map.showCollisionBoxes&&(Io(t,i,r,n,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),!0),Io(t,i,r,n,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),!1))},circle:function(t,i,r,n){if("translucent"!==t.renderPass)return;const o=r.paint.get("circle-opacity"),s=r.paint.get("circle-stroke-width"),a=r.paint.get("circle-stroke-opacity"),l=void 0!==r.layout.get("circle-sort-key").constantOr(1),c=r.paint.get("circle-emissive-strength");if(0===o.constantOr(1)&&(0===s.constantOr(1)||0===a.constantOr(1)))return;const u=t.context,h=u.gl,d=t.transform,p=t.depthModeForSublayer(0,Bi.ReadOnly),f=ji.disabled,m=t.colorModeForDrapableLayerRenderPass(c),g="globe"===d.projection.name,y=[e.at(d.center.lng),e.aA(d.center.lat)],_=[];for(let x=0;x<n.length;x++){const o=n[x],s=i.getTile(o),a=s.getBucket(r);if(!a||a.projection.name!==d.projection.name)continue;const c=a.programConfigurations.get(r.id),u=e.cY(r),h=t.isTileAffectedByFog(o);g&&u.push("PROJECTION_GLOBE_VIEW"),u.push("DEPTH_D24"),t.terrain&&d.depthOcclusionForSymbolsAndCircles&&u.push("DEPTH_OCCLUSION");const p=t.getOrCreateProgram("circle",{config:c,defines:u,overrideFog:h}),f=a.layoutVertexBuffer,m=a.globeExtVertexBuffer,v=a.indexBuffer,b=d.projection.createInversionMatrix(d,o.canonical),w={programConfiguration:c,program:p,layoutVertexBuffer:f,globeExtVertexBuffer:m,indexBuffer:v,uniformValues:e.cZ(t,o,s,b,y,r),tile:s};if(l){const t=a.segments.get();for(const i of t)_.push({segments:new e.b7([i]),sortKey:i.sortKey,state:w})}else _.push({segments:a.segments,sortKey:0,state:w})}l&&_.sort(((e,t)=>e.sortKey-t.sortKey));const v={useDepthForOcclusion:d.depthOcclusionForSymbolsAndCircles};for(const e of _){const{programConfiguration:i,program:n,layoutVertexBuffer:o,globeExtVertexBuffer:s,indexBuffer:a,uniformValues:l,tile:c}=e.state,g=e.segments;t.terrain&&t.terrain.setupElevationDraw(c,n,v),t.uploadCommonUniforms(u,n,c.tileID.toUnwrapped()),n.draw(t,h.TRIANGLES,p,f,m,Gi.disabled,l,r.id,o,a,g,r.paint,d.zoom,i,[s])}},heatmap:function(t,i,r,n){if(0!==r.paint.get("heatmap-opacity"))if("offscreen"===t.renderPass){const o=t.context,s=o.gl,a=ji.disabled,l=new Fi([s.ONE,s.ONE,s.ONE,s.ONE],e.aj.transparent,[!0,!0,!0,!0]);!function(e,t,i,r){const n=e.gl,o=t.width*r,s=t.height*r;e.activeTexture.set(n.TEXTURE1),e.viewport.set([0,0,o,s]);let a=i.heatmapFbo;if(!a||a&&(a.width!==o||a.height!==s)){a&&a.destroy();const t=n.createTexture();n.bindTexture(n.TEXTURE_2D,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),a=i.heatmapFbo=e.createFramebuffer(o,s,!0,null),function(e,t,i,r,n,o){const s=e.gl;s.texImage2D(s.TEXTURE_2D,0,e.extRenderToTextureHalfFloat?s.RGBA16F:s.RGBA,n,o,0,s.RGBA,e.extRenderToTextureHalfFloat?s.HALF_FLOAT:s.UNSIGNED_BYTE,null),r.colorAttachment.set(i)}(e,0,t,a,o,s)}else n.bindTexture(n.TEXTURE_2D,a.colorAttachment.get()),e.bindFramebuffer.set(a.framebuffer)}(o,t,r,"globe"===t.transform.projection.name?.5:.25),o.clear({color:e.aj.transparent});const c=t.transform,u="globe"===c.projection.name,h=u?["PROJECTION_GLOBE_VIEW"]:[],d=u?Gi.frontCCW:Gi.disabled,p=[e.at(c.center.lng),e.aA(c.center.lat)];for(let e=0;e<n.length;e++){const f=n[e];if(i.hasRenderableParent(f))continue;const m=i.getTile(f),g=m.getBucket(r);if(!g||g.projection.name!==c.projection.name)continue;const y=t.isTileAffectedByFog(f),_=g.programConfigurations.get(r.id),v=t.getOrCreateProgram("heatmap",{config:_,defines:h,overrideFog:y}),{zoom:x}=t.transform;t.terrain&&t.terrain.setupElevationDraw(m,v),t.uploadCommonUniforms(o,v,f.toUnwrapped());const b=c.projection.createInversionMatrix(c,f.canonical);v.draw(t,s.TRIANGLES,Bi.disabled,a,l,d,ao(t,f,m,b,p,x,r.paint.get("heatmap-intensity")),r.id,g.layoutVertexBuffer,g.indexBuffer,g.segments,r.paint,t.transform.zoom,_,u?[g.globeExtVertexBuffer]:null)}o.viewport.set([0,0,t.width,t.height])}else"translucent"===t.renderPass&&(t.context.setColorMode(t.colorModeForRenderPass()),function(t,i){const r=t.context,n=r.gl,o=i.heatmapFbo;if(!o)return;r.activeTexture.set(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,o.colorAttachment.get()),r.activeTexture.set(n.TEXTURE1);let s=i.colorRampTexture;s||(s=i.colorRampTexture=new e.T(r,i.colorRamp,n.RGBA8)),s.bind(n.LINEAR,n.CLAMP_TO_EDGE),t.getOrCreateProgram("heatmapTexture").draw(t,n.TRIANGLES,Bi.disabled,ji.disabled,t.colorModeForRenderPass(),Gi.disabled,((e,t)=>({u_image:0,u_color_ramp:1,u_opacity:t.paint.get("heatmap-opacity")}))(0,i),i.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,i.paint,t.transform.zoom)}(t,r))},line:function(t,i,r,n){if("translucent"!==t.renderPass)return;const o=r.paint.get("line-opacity"),s=r.paint.get("line-width");if(0===o.constantOr(1)||0===s.constantOr(1))return;const a=r.paint.get("line-emissive-strength"),l=r.paint.get("line-occlusion-opacity"),c=r.layout.get("line-elevation-reference"),u="meters"===r.layout.get("line-width-unit"),h="sea"===c,d=t.context,p=d.gl;if(r.hasElevatedBuckets&&"globe"===t.transform.projection.name)return;const f=r.layout.get("line-cross-slope"),m=void 0!==f,g=f<1,y=t.colorModeForDrapableLayerRenderPass(a),_=t.terrain&&t.terrain.renderingToTexture,v=_?1:e.q.devicePixelRatio,x=r.paint.get("line-dasharray"),b=x.constantOr(1),w=r.layout.get("line-cap"),S=x.constantOr(null),T=w.constantOr(null),M=r.paint.get("line-pattern"),A=M.constantOr(1),C=M.constantOr(null),E=r.paint.get("line-opacity").constantOr(1);let P=!A&&1!==E||t.depthOcclusion&&l>0&&l<1;const k=r.paint.get("line-gradient"),I=A?"linePattern":"line",D=e.c_(r);let L;if(_&&t.terrain&&t.terrain.clipOrMaskOverlapStencilType()&&(P=!1),0!==l&&t.depthOcclusion){const t=r.paint._values["line-opacity"];t&&t.value&&"constant"===t.value.kind?L=t.value:e.w(`Occlusion opacity for layer ${r.id} is supported only when line-opacity isn't data-driven.`)}"constant"!==s.value.kind&&!1===s.value.isLineProgressConstant&&D.push("VARIABLE_LINE_WIDTH");const R=(n,o,s,a,c)=>{for(const f of n){const n=i.getTile(f);if(A&&!n.patternsLoaded())continue;const m=n.getBucket(r);if(!m)continue;if(m.hasZOffset&&!c||!m.hasZOffset&&c)continue;t.prepareDrawTile();const g=m.programConfigurations.get(r.id),x=t.isTileAffectedByFog(f),w=t.getOrCreateProgram(I,{config:g,defines:o,overrideFog:x,overrideRtt:!c&&void 0});if(C&&n.imageAtlas){const t=e.A.from(C).getPrimary().scaleSelf(v).serialize(),i=n.imageAtlas.patternPositions[t];i&&g.setConstantPatternPositions(i)}if(!A&&S&&T&&n.lineAtlas){const e=n.lineAtlas.getDash(S,T);e&&g.setConstantPatternPositions(e)}let[M,D]=r.paint.get("line-trim-offset");if("round"===T||"square"===T){const e=1;M!==D&&(0===M&&(M-=e),1===D&&(D+=e))}const R=_?f.projMatrix:null,z=u?1/m.tileToMeter/e.ar(n,1,t.transform.zoom):1,O=u?1/m.tileToMeter/e.ar(n,1,Math.floor(t.transform.zoom)):1,F=A?e.c$(t,n,r,R,v,z,O,[M,D]):e.d0(t,n,r,R,m.lineClipsArray.length,v,z,O,[M,D]);if(k){const n=m.gradients[r.id];let o=n.texture;if(r.gradientVersion!==n.version){let s=256;if(r.stepInterpolant){const r=i.getSource().maxzoom,n=f.canonical.z===r?Math.ceil(1<<t.transform.maxZoom-f.canonical.z):1;s=e.aw(e.d1(m.maxLineLength/e.ag*1024*n),256,d.maxTextureSize)}n.gradient=e.d2({expression:r.gradientExpression(),evaluationKey:"lineProgress",resolution:s,image:n.gradient||void 0,clips:m.lineClipsArray}),n.texture?n.texture.update(n.gradient):n.texture=new e.T(d,n.gradient,p.RGBA8),n.version=r.gradientVersion,o=n.texture}d.activeTexture.set(p.TEXTURE1),o.bind(r.stepInterpolant?p.NEAREST:p.LINEAR,p.CLAMP_TO_EDGE)}b&&(d.activeTexture.set(p.TEXTURE0),n.lineAtlasTexture&&n.lineAtlasTexture.bind(p.LINEAR,p.REPEAT),g.updatePaintBuffers()),A&&(d.activeTexture.set(p.TEXTURE0),n.imageAtlasTexture&&n.imageAtlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE),g.updatePaintBuffers()),c&&!h&&t.terrain.setupElevationDraw(n,w),t.uploadCommonUniforms(d,w,f.toUnwrapped());const B=e=>{null!=L&&(L.value=E*l),w.draw(t,p.TRIANGLES,s,e,y,Gi.disabled,F,r.id,m.layoutVertexBuffer,m.indexBuffer,m.segments,r.paint,t.transform.zoom,g,[m.layoutVertexBuffer2,m.patternVertexBuffer,m.zOffsetVertexBuffer]),null!=L&&(L.value=E)};if(P&&!c){const e=t.stencilModeForClipping(f).ref;0===e&&_&&d.clear({stencil:0});const i={func:p.EQUAL,mask:255};F.u_alpha_discard_threshold=.8,B(new ji(i,e,255,p.KEEP,p.KEEP,p.INVERT)),F.u_alpha_discard_threshold=0,B(new ji(i,e,255,p.KEEP,p.KEEP,p.KEEP))}else P&&c&&(F.u_alpha_discard_threshold=.001),B(c?a:t.stencilModeForClipping(f))}};if(r.hasNonElevatedBuckets){const i=!_&&t.terrain;0!==l&&i?e.w(`Occlusion opacity for layer ${r.id} is supported on terrain only if the layer has line-z-offset enabled.`):i?e.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${r.id}.`):R(n,D,t.depthModeForSublayer(0,Bi.ReadOnly),ji.disabled,!1)}if(r.hasElevatedBuckets){D.push("ELEVATED"),m&&D.push(g?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),h&&D.push("ELEVATION_REFERENCE_SEA");const e=P?t.stencilModeFor3D():ji.disabled,i=new Bi(t.depthOcclusion?p.GREATER:p.LEQUAL,Bi.ReadOnly,t.depthRangeFor3D);t.forceTerrainMode=!0,R(n,D,i,e,!0),t.forceTerrainMode=!1}P&&(t.resetStencilClippingMasks(),_&&d.clear({stencil:0})),0===l||t.depthOcclusion||_||t.layersWithOcclusionOpacity.push(t.currentLayer)},fill:function(t,i,r,n){const o=r.paint.get("fill-color"),s=r.paint.get("fill-opacity"),a=r.is3D(),l=new Bi(t.context.gl.LEQUAL,Bi.ReadWrite,t.depthRangeFor3D);if(0===s.constantOr(1))return;const c=r.paint.get("fill-emissive-strength"),u=t.colorModeForDrapableLayerRenderPass(c),h=r.paint.get("fill-pattern"),d=t.opaquePassEnabledForLayer()&&!h.constantOr(1)&&1===o.constantOr(e.aj.transparent).a&&1===s.constantOr(0)?"opaque":"translucent";if(t.renderPass===d){const e=a?l:t.depthModeForSublayer(1,"opaque"===t.renderPass?Bi.ReadWrite:Bi.ReadOnly);Bo(t,i,r,n,e,u,!1)}if(!a&&"translucent"===t.renderPass&&r.paint.get("fill-antialias")){const e=a?l:t.depthModeForSublayer(r.getPaintProperty("fill-outline-color")?2:0,Bi.ReadOnly);Bo(t,i,r,n,e,u,!0)}},"fill-extrusion":function(t,i,r,n){const o=r.paint.get("fill-extrusion-opacity"),s=t.context,a=s.gl,l=t.terrain,c=l&&l.renderingToTexture;if(0===o)return;const u=t.conflationActive&&t.style.isLayerClipped(r,i.getSource()),h=t.style.order.indexOf(r.fqid);if(u&&function(e,t,i,r,n){for(const o of r){const r=t.getTile(o).getBucket(i);r&&(r.updateReplacement(o,e.replacementSource,n),r.uploadCentroid(e.context))}}(t,i,r,n,h),l||u)for(const e of n){const n=i.getTile(e).getBucket(r);n&&Vo(t.context,i,e,n,r,l,u)}if("shadow"===t.renderPass&&t.shadowRenderer){const s=t.shadowRenderer;if(l&&o<.65&&r._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof e.a9)return;const a=s.getShadowPassDepthMode(),c=s.getShadowPassColorMode();No(t,i,r,n,a,ji.disabled,c,u)}else if("translucent"===t.renderPass){const h=!r.paint.get("fill-extrusion-pattern").constantOr(1),d=r.paint.get("fill-extrusion-color").constantOr(e.aj.white);if(!c&&0!==d.a){const e=new Bi(t.context.gl.LEQUAL,Bi.ReadWrite,t.depthRangeFor3D);1===o&&h?No(t,i,r,n,e,ji.disabled,Fi.unblended,u):(No(t,i,r,n,e,ji.disabled,Fi.disabled,u),No(t,i,r,n,e,t.stencilModeFor3D(),t.colorModeForRenderPass(),u),t.resetStencilClippingMasks())}if(t.style.enable3dLights()&&h&&(!l&&"globe"!==t.transform.projection.name||c)){const o=r.paint.get("fill-extrusion-opacity"),h=r.paint.get("fill-extrusion-ambient-occlusion-intensity"),d=r.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),p=r.paint.get("fill-extrusion-flood-light-intensity"),f="none"===r.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default"),m=r.paint.get("fill-extrusion-flood-light-color").toRenderColor(f?null:r.lut).toArray01().slice(0,3),g=h>0&&d>0,y=p>0,_=(e,t,i)=>(1-i)*e+i*t,v=s=>{const l=t.depthModeForSublayer(1,Bi.ReadOnly,a.LEQUAL,!0),c=r.paint.get(s?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),f=_(.1,3,c),g=t._showOverdrawInspector;if(!g){const c=new ji({func:a.ALWAYS,mask:255},255,255,a.KEEP,a.KEEP,a.REPLACE),g=new Fi([a.ONE,a.ONE,a.ONE,a.ONE],e.aj.transparent,[!1,!1,!1,!0],a.MIN);jo(t,i,r,n,l,c,g,Gi.disabled,s,"sdf",o,h,d,p,m,f,u,!1)}{const c=g?ji.disabled:new ji({func:a.EQUAL,mask:255},255,255,a.KEEP,a.DECR,a.DECR),y=g?t.colorModeForRenderPass():new Fi([a.ONE_MINUS_DST_ALPHA,a.DST_ALPHA,a.ONE,a.ONE],e.aj.transparent,[!0,!0,!0,!0]);jo(t,i,r,n,l,c,y,Gi.disabled,s,"color",o,h,d,p,m,f,u,!1)}};if(c){const c=(s,l,c)=>{const f=t.depthModeForSublayer(1,Bi.ReadOnly,a.LEQUAL,!1),g=r.paint.get(s?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),y=_(.1,3,g);{const c=new Fi([a.ONE,a.ONE,a.ONE,a.ONE],e.aj.transparent,[!1,!1,!1,!0]);jo(t,i,r,n,f,ji.disabled,c,Gi.disabled,s,"clear",o,h,d,p,m,y,u,l)}{const c=new ji({func:a.ALWAYS,mask:255},255,255,a.KEEP,a.KEEP,a.REPLACE),g=new Fi([a.ONE,a.ONE,a.ONE,a.ONE],e.aj.transparent,[!1,!1,!1,!0],a.MIN);jo(t,i,r,n,f,c,g,Gi.disabled,s,"sdf",o,h,d,p,m,y,u,l)}{const c=s?a.ZERO:a.ONE_MINUS_DST_ALPHA,g=new ji({func:a.EQUAL,mask:255},255,255,a.KEEP,a.DECR,a.DECR),_=new Fi([c,a.DST_ALPHA,a.ONE_MINUS_DST_ALPHA,a.ZERO],e.aj.transparent,[!0,!0,!0,!0]);jo(t,i,r,n,f,g,_,Gi.disabled,s,"color",o,h,d,p,m,y,u,l)}{const g=new Fi([a.ONE,a.ONE,a.ONE,s?a.ZERO:a.ONE],e.aj.transparent,[!1,!1,!1,!0],s?a.FUNC_ADD:a.MAX);jo(t,i,r,n,f,ji.disabled,g,Gi.disabled,s,"clear",o,h,d,p,m,y,u,l,c)}};if(g||y){let i;if(t.prepareDrawTile(),l){const t=l.drapeBufferSize[0],r=l.drapeBufferSize[1];i=l.framebufferCopyTexture,i&&(!i||i.size[0]===t&&i.size[1]===r)||(i&&i.destroy(),i=l.framebufferCopyTexture=new e.T(s,new e.r({width:t,height:r}),a.RGBA8)),i.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.copyTexSubImage2D(a.TEXTURE_2D,0,0,0,0,0,t,r)}g&&c(!0,!1,i),y&&c(!1,!0,i)}}else g&&v(!0),y&&v(!1),(g||y)&&t.resetStencilClippingMasks()}}},hillshade:function(e,t,i,r){if("offscreen"!==e.renderPass&&"translucent"!==e.renderPass)return;if(e.style.disableElevatedTerrain)return;const n=e.context,o=e.terrain&&e.terrain.renderingToTexture,[s,a]="translucent"!==e.renderPass||o?[{},r]:e.stencilConfigForOverlap(r);for(const l of a){const r=t.getTile(l);if(r.needsHillshadePrepare&&"offscreen"===e.renderPass)$r(e,r,i);else if("translucent"===e.renderPass){const t=e.depthModeForSublayer(0,Bi.ReadOnly),n=i.paint.get("hillshade-emissive-strength"),a=e.colorModeForDrapableLayerRenderPass(n),c=o&&e.terrain?e.terrain.stencilModeForRTTOverlap(l):s[l.overscaledZ];Hr(e,l,r,i,t,c,a)}}n.viewport.set([0,0,e.width,e.height]),e.resetStencilClippingMasks()},raster:function(t,i,r,n,o,s){if("translucent"!==t.renderPass)return;if(0===r.paint.get("raster-opacity"))return;const a="globe"===t.transform.projection.name,l=0!==r.paint.get("raster-elevation"),c=l&&a;if(t.renderElevatedRasterBackface&&!c)return;const u=t.context,h=u.gl,d=i.getSource(),p=function(t,i,r,n){const o=i.paint.get("raster-color"),s="raster-array"===t.type,a=[],l=i.paint.get("raster-resampling"),c=i.paint.get("raster-color-mix");let u=i.paint.get("raster-color-range");const h=[c[0],c[1],c[2],0],d=c[3];let p="nearest"===l?n.NEAREST:n.LINEAR;if(s&&(a.push("RASTER_ARRAY"),o||a.push("RASTER_COLOR"),"linear"===l&&a.push("RASTER_ARRAY_LINEAR"),p=n.NEAREST,!u&&t.rasterLayers)){const e=t.rasterLayers.find((e=>{let{id:t}=e;return t===i.sourceLayer}));e&&e.fields&&e.fields.range&&(u=e.fields.range)}if(u=u||[0,1],o){a.push("RASTER_COLOR"),r.activeTexture.set(n.TEXTURE2),i.updateColorRamp(u);let t=i.colorRampTexture;t||(t=i.colorRampTexture=new e.T(r,i.colorRamp,n.RGBA8)),t.bind(n.LINEAR,n.CLAMP_TO_EDGE)}return{mix:h,range:u,offset:d,defines:a,resampling:p}}(d,r,u,h);if(d instanceof e.aJ&&!n.length&&!a)return;const f=r.paint.get("raster-emissive-strength"),m=t.colorModeForDrapableLayerRenderPass(f),g=t.terrain&&t.terrain.renderingToTexture,y=!t.options.moving,_="nearest"===r.paint.get("raster-resampling")?h.NEAREST:h.LINEAR;if(d instanceof e.aJ&&!n.length&&(d.onNorthPole||d.onSouthPole)){const e=l?t.stencilModeFor3D():ji.disabled;return void qo(!!d.onNorthPole,null,t,i,r,f,p,Gi.disabled,e)}if(!n.length)return;const[v,x]=d instanceof e.aJ||g?[{},n]:t.stencilConfigForOverlap(n),b=x[x.length-1].overscaledZ;c&&p.defines.push("PROJECTION_GLOBE_VIEW"),l&&p.defines.push("RENDER_CUTOFF");const w=(n,o,x)=>{for(const w of n){const n=w.toUnwrapped(),S=i.getTile(w);if(g&&(!S||!S.hasData()))continue;u.activeTexture.set(h.TEXTURE0);const T=Yo(S,d,r,p);if(!T||!T.texture)continue;const{texture:M,mix:A,offset:C,tileSize:E,buffer:P}=T;let k,I;g?(k=Bi.disabled,I=w.projMatrix):l?(k=new Bi(h.LEQUAL,Bi.ReadWrite,t.depthRangeFor3D),I=a?Float32Array.from(t.transform.expandedFarZProjMatrix):t.transform.calculateProjMatrix(n,y)):(k=t.depthModeForSublayer(w.overscaledZ-b,1===r.paint.get("raster-opacity")?Bi.ReadWrite:Bi.ReadOnly,h.LESS),I=t.transform.calculateProjMatrix(n,y));const D=t.terrain&&g?t.terrain.stencilModeForRTTOverlap(w):v[w.overscaledZ],L=s?0:r.paint.get("raster-fade-duration");S.registerFadeDuration(L);const R=i.findLoadedParent(w,0),z=Nn(S,R,i,t.transform,L);let O,F;t.terrain&&t.terrain.prepareDrawTile(),u.activeTexture.set(h.TEXTURE0),M.bind(_,h.CLAMP_TO_EDGE),u.activeTexture.set(h.TEXTURE1),R?(R.texture&&R.texture.bind(_,h.CLAMP_TO_EDGE),O=Math.pow(2,R.tileID.overscaledZ-S.tileID.overscaledZ),F=[S.tileID.canonical.x*O%1,S.tileID.canonical.y*O%1]):M.bind(_,h.CLAMP_TO_EDGE),M.useMipmap&&u.extTextureFilterAnisotropic&&t.transform.pitch>20&&h.texParameterf(h.TEXTURE_2D,u.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,u.extTextureFilterAnisotropicMax);const B=t.transform;let N;const j=l?Xo(B):[0,0,0,0];let V,U,G,H,W,$=0;if(c&&d instanceof e.aJ&&d.coordinates.length>3)V=Float32Array.from(e.bb(e.cH(new e.bT(0,0,0)))),U=Float32Array.from(B.globeMatrix),G=Float32Array.from(e.cD(B)),H=[e.at(B.center.lng),e.aA(B.center.lat)],N=d.elevatedGlobePerspectiveTransform,W=d.elevatedGlobeGridMatrix||new Float32Array(9);else if(c){const t=e.cE(w.canonical);$=e.cF(t.getCenter().lat),V=Float32Array.from(e.bb(e.cH(w.canonical))),U=Float32Array.from(B.globeMatrix),G=Float32Array.from(e.cD(B)),H=[e.at(B.center.lng),e.aA(B.center.lat)],N=[0,0],W=Float32Array.from(e.cG(w.canonical,t,$,B.worldSize/B._pixelsPerMercatorPixel))}else N=d instanceof e.aJ?d.perspectiveTransform:[0,0],V=new Float32Array(16),U=new Float32Array(9),G=new Float32Array(16),H=[0,0],W=new Float32Array(9);const q=uo(I,V,U,G,W,F||[0,0],e.ae(t.transform.zoom),H,j,O||1,z,r,N,l?r.paint.get("raster-elevation"):0,2,A,C,p.range,E,P,f),X=t.isTileAffectedByFog(w),Y=t.getOrCreateProgram("raster",{defines:p.defines,overrideFog:X});if(t.uploadCommonUniforms(u,Y,n),d instanceof e.aJ){const i=d.elevatedGlobeVertexBuffer,n=d.elevatedGlobeIndexBuffer;if(g||!a)d.boundsBuffer&&d.boundsSegments&&Y.draw(t,h.TRIANGLES,k,ji.disabled,m,Gi.disabled,q,r.id,d.boundsBuffer,t.quadTriangleIndexBuffer,d.boundsSegments);else if(i&&n){const s=B.zoom<=e.c6?d.elevatedGlobeSegments:d.getSegmentsForLongitude(B.center.lng);s&&Y.draw(t,h.TRIANGLES,k,ji.disabled,m,o,q,r.id,i,n,s)}}else if(c){k=new Bi(h.LEQUAL,Bi.ReadOnly,t.depthRangeFor3D);const e=t.globeSharedBuffers;if(e){const[i,n,s]=e.getGridBuffers($,!1);Y.draw(t,h.TRIANGLES,k,x||D,t.colorModeForRenderPass(),o,q,r.id,i,n,s)}}else{const{tileBoundsBuffer:e,tileBoundsIndexBuffer:i,tileBoundsSegments:n}=t.getTileBoundsBuffers(S);Y.draw(t,h.TRIANGLES,k,D,m,Gi.disabled,q,r.id,e,i,n)}}if(!(d instanceof e.aJ)&&c)for(const e of n){const n=e.canonical.y===(1<<e.canonical.z)-1;0===e.canonical.y&&qo(!0,e,t,i,r,f,p,o,x||ji.disabled),n&&qo(!1,e,t,i,r,f,p,o===Gi.frontCW?Gi.backCW:Gi.frontCW,x||ji.disabled)}};c?w(x,t.renderElevatedRasterBackface?Gi.backCW:Gi.frontCW,t.stencilModeFor3D()):w(x,Gi.disabled,void 0),t.resetStencilClippingMasks()},"raster-particle":function(t,i,r,n,o,s){"offscreen"===t.renderPass&&function(t,i,r,n){if(!n.length)return;const o=t.context,s=o.gl,a=i.getSource();if(!(a instanceof rt))return;const l=Math.ceil(Math.sqrt(r.paint.get("raster-particle-count")));let c=r.particlePositionRGBAImage;if(!c||c.width!==l){const t=function(e){const t=e*e,i=new Uint8Array(4*t),r=function(e){return e|=0,e=Math.imul(2747636419^e,2654435769),e=Math.imul(e^e>>>16,2654435769),((e=Math.imul(e^e>>>16,2654435769))>>>0)/4294967296},n=1/1.1;for(let o=0;o<t;o++){const e=n*(r(2*o+0)+po),t=n*(r(2*o+1)+po),s=255*e%1,a=255*t%1,l=s,c=t-a/255,u=a;i[4*o+0]=255*(e-s/255),i[4*o+1]=255*l,i[4*o+2]=255*c,i[4*o+3]=255*u}return i}(l);c=r.particlePositionRGBAImage=new e.r({width:l,height:l},t)}let u=r.particleFramebuffer;u?u.width!==l&&(u.destroy(),u=r.particleFramebuffer=o.createFramebuffer(l,l,!0,null)):u=r.particleFramebuffer=o.createFramebuffer(l,l,!0,null);const h=[];for(const e of n){const t=i.getTile(e);if(!(t instanceof wt))continue;const n=Jo(t,a,r);if(!n)continue;const s=[t.tileSize,t.tileSize];let u=r.tileFramebuffer;u||(u=r.tileFramebuffer=o.createFramebuffer(s[0],s[1],!0,null));let d=t.rasterParticleState;d||(d=t.rasterParticleState=new Ko(o,e,s,c));const p=d.update(r.lastInvalidatedAt);d.particleTextureDimension!==l&&d.updateParticleTexture(e,c);const f=d.targetColorTexture;d.targetColorTexture=d.backgroundColorTexture,d.backgroundColorTexture=f;const m=d.particleTexture0;d.particleTexture0=d.particleTexture1,d.particleTexture1=m,h.push([e,n,d,p])}if(0===h.length)return;const d=e.q.now(),p=r.previousDrawTimestamp?.001*(d-r.previousDrawTimestamp):.0167;if(r.previousDrawTimestamp=d,r.hasColorMap()){o.activeTexture.set(s.TEXTURE0+2);let t=r.colorRampTexture;t||(t=r.colorRampTexture=new e.T(o,r.colorRamp,s.RGBA8)),t.bind(s.LINEAR,s.CLAMP_TO_EDGE)}o.bindFramebuffer.set(r.tileFramebuffer.framebuffer),function(t,i,r){const n=t.context,o=n.gl,s=i.tileFramebuffer;n.activeTexture.set(o.TEXTURE0);const a={u_texture:0,u_opacity:1.05*(c=i.paint.get("raster-particle-fade-opacity-factor"))/(c+.05)},l=t.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var c;for(const u of r){const[,,r,c]=u;s.colorAttachment.set(r.targetColorTexture.texture),n.viewport.set([0,0,s.width,s.height]),n.clear({color:e.aj.transparent}),c&&(r.backgroundColorTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE),l.draw(t,o.TRIANGLES,Bi.disabled,ji.disabled,Fi.alphaBlended,Gi.disabled,a,i.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments))}}(t,r,h),function(t,i,r,n){const o=t.context,s=o.gl,a=r.tileFramebuffer,l="globe"===t.transform.projection.name,c=r.paint.get("raster-particle-max-speed");for(const u of n){const[n,h,d]=u;o.activeTexture.set(s.TEXTURE0+0),h.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),a.colorAttachment.set(d.targetColorTexture.texture);const p=t.getOrCreateProgram("rasterParticleDraw",{defines:h.defines,overrideFog:!1});o.activeTexture.set(s.TEXTURE0+1);const f=h.scalarData?[]:[0,1,2,3].map((t=>e.d4[t](n)));f.push(n);const m=n.canonical.x,g=n.canonical.y;for(const e of f){const o=i.getTile(l?e.wrapped():e);if(!o)continue;const a=o.rasterParticleState;if(!a)continue;const u=e.canonical.x+(1<<e.canonical.z)*(e.wrap-n.wrap),d=e.canonical.y;a.particleTexture0.bind(s.NEAREST,s.CLAMP_TO_EDGE);const f=mo(1,a.particleTexture0.size[0],[u-m,d-g],0,h.texture.size,2,c,h.textureOffset,h.scale,h.offset);p.draw(t,s.POINTS,Bi.disabled,ji.disabled,Fi.alphaBlended,Gi.disabled,f,r.id,a.particleIndexBuffer,void 0,a.particleSegment)}}}(t,i,r,h),o.bindFramebuffer.set(r.particleFramebuffer.framebuffer),function(t,i,r,n){const o=t.context,s=o.gl,a=i.paint.get("raster-particle-max-speed"),l=n*i.paint.get("raster-particle-speed-factor")*.15,c=function(e){return Math.pow(e,6)}(.01+1*i.paint.get("raster-particle-reset-rate-factor")),u=i.particleFramebuffer;o.viewport.set([0,0,u.width,u.height]);for(const h of r){const[,r,n]=h;o.activeTexture.set(s.TEXTURE0+0),r.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),o.activeTexture.set(s.TEXTURE0+1);const d=n.particleTexture0;d.bind(s.NEAREST,s.CLAMP_TO_EDGE);const p=go(1,d.size[0],0,r.texture.size,a,l,c,r.textureOffset,r.scale,r.offset);u.colorAttachment.set(n.particleTexture1.texture),o.clear({color:e.aj.transparent}),t.getOrCreateProgram("rasterParticleUpdate",{defines:r.defines}).draw(t,s.TRIANGLES,Bi.disabled,ji.disabled,Fi.unblended,Gi.disabled,p,i.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments)}}(t,r,h,p)}(t,i,r,n),"translucent"===t.renderPass&&(function(t,i,r,n){const o=t.context,s=o.gl,a=i.getSource().tileSize,l=5*(1-e.ac(e.bY,e.bY+1,t.transform.zoom))*a+r.paint.get("raster-particle-elevation"),c=!t.options.moving,u="globe"===t.transform.projection.name;if(!n.length)return;const[h,d]=t.stencilConfigForOverlap(n),p=[];u&&p.push("PROJECTION_GLOBE_VIEW");const f=t.stencilModeFor3D();for(const m of d){const n=m.toUnwrapped(),a=i.getTile(m);if(!a.rasterParticleState)continue;const d=a.rasterParticleState,g=100;a.registerFadeDuration(g);const y=i.findLoadedParent(m,0),_=Nn(a,y,i,t.transform,g);let v,x;t.terrain&&t.terrain.prepareDrawTile(),o.activeTexture.set(s.TEXTURE0),d.targetColorTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE),o.activeTexture.set(s.TEXTURE1),y&&y.rasterParticleState?(y.rasterParticleState.targetColorTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE),v=Math.pow(2,y.tileID.overscaledZ-a.tileID.overscaledZ),x=[a.tileID.canonical.x*v%1,a.tileID.canonical.y*v%1]):d.targetColorTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE);const b=u?Float32Array.from(t.transform.expandedFarZProjMatrix):t.transform.calculateProjMatrix(n,c),w=t.transform,S=Qo(w),T=e.cE(m.canonical),M=e.cF(T.getCenter().lat);let A,C,E,P,k;u?(A=Float32Array.from(e.bb(e.cH(m.canonical))),C=Float32Array.from(w.globeMatrix),E=Float32Array.from(e.cD(w)),P=[e.at(w.center.lng),e.aA(w.center.lat)],k=Float32Array.from(e.cG(m.canonical,T,M,w.worldSize/w._pixelsPerMercatorPixel))):(A=new Float32Array(16),C=new Float32Array(9),E=new Float32Array(16),P=[0,0],k=new Float32Array(9));const I=fo(b,A,C,E,k,x||[0,0],e.ae(t.transform.zoom),P,S,v||1,_,l),D=t.isTileAffectedByFog(m),L=t.getOrCreateProgram("rasterParticle",{defines:p,overrideFog:D});if(t.uploadCommonUniforms(o,L,n),u){const e=new Bi(s.LEQUAL,Bi.ReadOnly,t.depthRangeFor3D),i=0,n=t.globeSharedBuffers;if(n){const[o,a,l]=n.getGridBuffers(M,0!==i);L.draw(t,s.TRIANGLES,e,f,Fi.alphaBlended,t.renderElevatedRasterBackface?Gi.frontCCW:Gi.backCCW,I,r.id,o,a,l)}}else{const e=t.depthModeForSublayer(0,Bi.ReadOnly),i=h[m.overscaledZ],{tileBoundsBuffer:n,tileBoundsIndexBuffer:o,tileBoundsSegments:l}=t.getTileBoundsBuffers(a);L.draw(t,s.TRIANGLES,e,i,Fi.alphaBlended,Gi.disabled,I,r.id,n,o,l)}}t.resetStencilClippingMasks()}(t,i,r,n),t.style.map.triggerRepaint())},background:function(t,i,r,n){const o=r.paint.get("background-color"),s="none"===r.paint.get("background-color-use-theme").constantOr("default"),a=r.paint.get("background-opacity"),l=r.paint.get("background-emissive-strength"),c="viewport"===r.paint.get("background-pitch-alignment");if(0===a)return;const u=t.context,h=u.gl,d=t.transform,p=d.tileSize,f=r.paint.get("background-pattern");let m;if(void 0!==f){if(null===f)return;if(m=t.imageManager.getPattern(f.toString(),r.scope,t.style.getLut(r.scope)),!m)return}const g=!f&&1===o.a&&1===a&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass!==g)return;const y=ji.disabled,_=t.depthModeForSublayer(0,"opaque"===g?Bi.ReadWrite:Bi.ReadOnly),v=t.colorModeForDrapableLayerRenderPass(l),x=f?"backgroundPattern":"background";let b,w=n;if(w||(b=t.getBackgroundTiles(),w=Object.values(b).map((e=>e.tileID))),f&&(u.activeTexture.set(h.TEXTURE0),t.imageManager.bind(t.context,r.scope)),c){const i=t.getOrCreateProgram(x,{overrideFog:!1,overrideRtt:!0}),n=new Float32Array(e.ab.mat4.identity([])),u=new e.aG(0,0,0,0,0),d=f?xo(n,l,a,t,0,r.scope,m,c,{tileID:u,tileSize:p}):vo(n,l,a,o.toRenderColor(s?null:r.lut));i.draw(t,h.TRIANGLES,_,y,v,Gi.disabled,d,r.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments)}else for(const e of w){const g=t.isTileAffectedByFog(e),w=t.getOrCreateProgram(x,{overrideFog:g}),S=e.toUnwrapped(),T=n?e.projMatrix:t.transform.calculateProjMatrix(S);t.prepareDrawTile();const M=i?i.getTile(e):b?b[e.key]:new bt(e,p,d.zoom,t),A=f?xo(T,l,a,t,0,r.scope,m,c,{tileID:e,tileSize:p}):vo(T,l,a,o.toRenderColor(s?null:r.lut));t.uploadCommonUniforms(u,w,S);const{tileBoundsBuffer:C,tileBoundsIndexBuffer:E,tileBoundsSegments:P}=t.getTileBoundsBuffers(M);w.draw(t,h.TRIANGLES,_,y,v,Gi.disabled,A,r.id,C,E,P)}},sky:function(t,i,r){const n=t._atmosphere?e.ae(t.transform.zoom):1,o=r.paint.get("sky-opacity")*n;if(0===o)return;const s=t.context,a=r.paint.get("sky-type"),l=new Bi(s.gl.LEQUAL,Bi.ReadOnly,[0,1]),c=t.frameCounter/1e3%1;"atmosphere"===a?"offscreen"===t.renderPass?r.needsSkyboxCapture(t)&&(function(t,i){const r=t.context,n=r.gl;let o=i.skyboxFbo;if(!o){o=i.skyboxFbo=r.createFramebuffer(32,32,!0,null),i.skyboxGeometry=new ds(r),i.skyboxTexture=r.gl.createTexture(),n.bindTexture(n.TEXTURE_CUBE_MAP,i.skyboxTexture),n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_MAG_FILTER,n.LINEAR);for(let e=0;e<6;++e)n.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,n.RGBA,32,32,0,n.RGBA,n.UNSIGNED_BYTE,null)}r.bindFramebuffer.set(o.framebuffer),r.viewport.set([0,0,32,32]);const s=i.getCenter(t,!0),a=t.getOrCreateProgram("skyboxCapture"),l=new Float64Array(16);e.ab.mat4.identity(l),e.ab.mat4.rotateY(l,l,.5*-Math.PI),ps(t,i,a,l,s,0),e.ab.mat4.identity(l),e.ab.mat4.rotateY(l,l,.5*Math.PI),ps(t,i,a,l,s,1),e.ab.mat4.identity(l),e.ab.mat4.rotateX(l,l,.5*-Math.PI),ps(t,i,a,l,s,2),e.ab.mat4.identity(l),e.ab.mat4.rotateX(l,l,.5*Math.PI),ps(t,i,a,l,s,3),e.ab.mat4.identity(l),ps(t,i,a,l,s,4),e.ab.mat4.identity(l),e.ab.mat4.rotateY(l,l,Math.PI),ps(t,i,a,l,s,5),r.viewport.set([0,0,t.width,t.height])}(t,r),r.markSkyboxValid(t)):"sky"===t.renderPass&&function(e,t,i,r,n){const o=e.context,s=o.gl,a=e.transform,l=e.getOrCreateProgram("skybox");o.activeTexture.set(s.TEXTURE0),s.bindTexture(s.TEXTURE_CUBE_MAP,t.skyboxTexture);const c=((e,t,i,r,n)=>({u_matrix:e,u_sun_direction:t,u_cubemap:0,u_opacity:r,u_temporal_offset:n}))(a.skyboxMatrix,t.getCenter(e,!1),0,r,n);e.uploadCommonUniforms(o,l),l.draw(e,s.TRIANGLES,i,ji.disabled,e.colorModeForRenderPass(),Gi.backCW,c,"skybox",t.skyboxGeometry.vertexBuffer,t.skyboxGeometry.indexBuffer,t.skyboxGeometry.segment)}(t,r,l,o,c):"gradient"===a&&"sky"===t.renderPass&&function(t,i,r,n,o){const s=t.context,a=s.gl,l=t.transform,c=t.getOrCreateProgram("skyboxGradient");i.skyboxGeometry||(i.skyboxGeometry=new ds(s)),s.activeTexture.set(a.TEXTURE0);let u=i.colorRampTexture;u||(u=i.colorRampTexture=new e.T(s,i.colorRamp,a.RGBA8)),u.bind(a.LINEAR,a.CLAMP_TO_EDGE);const h=((t,i,r,n,o)=>({u_matrix:t,u_color_ramp:0,u_center_direction:i,u_radius:e.ai(r),u_opacity:n,u_temporal_offset:o}))(l.skyboxMatrix,i.getCenter(t,!1),i.paint.get("sky-gradient-radius"),n,o);t.uploadCommonUniforms(s,c),c.draw(t,a.TRIANGLES,r,ji.disabled,t.colorModeForRenderPass(),Gi.backCW,h,"skyboxGradient",i.skyboxGeometry.vertexBuffer,i.skyboxGeometry.indexBuffer,i.skyboxGeometry.segment)}(t,r,l,o,c)},debug:function(t,i,r,n,o,s){for(let a=0;a<r.length;a++)if(o){const o=1,l=.8,c=new e.aj(n.r*l,n.g*l,n.b*l,1);os(t,i,r[a],n,-o,-o,s),os(t,i,r[a],n,-o,o,s),os(t,i,r[a],n,o,o,s),os(t,i,r[a],n,o,-o,s),os(t,i,r[a],c,0,0,s)}else os(t,i,r[a],n,0,0,s)},custom:function(t,i,r,n){const o=t.context,s=r.implementation;if(!t.transform.projection.unsupportedLayers||!t.transform.projection.unsupportedLayers.includes("custom")||t.terrain&&(t.terrain.renderingToTexture||"offscreen"===t.renderPass)&&r.isDraped(i)){if("offscreen"===t.renderPass){const i=s.prerender;if(i){if(t.setCustomLayerDefaults(),o.setColorMode(t.colorModeForRenderPass()),"globe"===t.transform.projection.name){const r=t.transform.pointMerc;i.call(s,o.gl,t.transform.customLayerMatrix(),t.transform.getProjection(),t.transform.globeToMercatorMatrix(),e.ae(t.transform.zoom),[r.x,r.y],t.transform.pixelsPerMeterRatio)}else i.call(s,o.gl,t.transform.customLayerMatrix());o.setDirty(),t.setBaseState()}}else if("translucent"===t.renderPass){if(t.terrain&&t.terrain.renderingToTexture){const i=s.renderToTile;if(i){const r=n[0].canonical,a=new e.aa(r.x+n[0].wrap*(1<<r.z),r.y,r.z);o.setDepthMode(Bi.disabled),o.setStencilMode(ji.disabled),o.setColorMode(t.colorModeForRenderPass()),t.setCustomLayerDefaults(),i.call(s,o.gl,a),o.setDirty(),t.setBaseState()}return}t.setCustomLayerDefaults(),o.setColorMode(t.colorModeForRenderPass()),o.setStencilMode(ji.disabled);const i="3d"===s.renderingMode?new Bi(t.context.gl.LEQUAL,Bi.ReadWrite,t.depthRangeFor3D):t.depthModeForSublayer(0,Bi.ReadOnly);if(o.setDepthMode(i),"globe"===t.transform.projection.name){const i=t.transform.pointMerc;s.render(o.gl,t.transform.customLayerMatrix(),t.transform.getProjection(),t.transform.globeToMercatorMatrix(),e.ae(t.transform.zoom),[i.x,i.y],t.transform.pixelsPerMeterRatio)}else s.render(o.gl,t.transform.customLayerMatrix());o.setDirty(),t.setBaseState(),o.bindFramebuffer.set(null)}}else e.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(t,i,r,n){if("opaque"===t.renderPass)return;const o=r.paint.get("model-opacity").constantOr(1);if(0===o)return;const s=r.paint.get("model-cast-shadows");if("shadow"===t.renderPass){if(!s)return;if(t.terrain&&o<.65&&r._transitionablePaint._values["model-opacity"].value.expression instanceof e.a9)return}const a=t.shadowRenderer,l=r.paint.get("model-receive-shadows");a&&(a.useNormalOffset=!0,l||(a.enabled=!1));const c=()=>{a&&(a.useNormalOffset=!0,l||(a.enabled=!0))},u=i.getSource();if("light-beam"===t.renderPass&&"batched-model"!==u.type)return;if("vector"===u.type||"geojson"===u.type)return function(t,i,r,n,o){const s=t.transform;if("mercator"!==s.projection.name)return void e.w(`Drawing 3D models for ${s.projection.name} projection is not yet implemented`);const a=s.getFreeCameraOptions().position;if(!t.modelManager)return;const l=t.modelManager;r.modelManager=l;const c=t.shadowRenderer;if(!r._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const u=r._unevaluatedLayout._values["model-id"],h=Object.assign({},r.layout.get("model-id").parameters),d=t.style.order.indexOf(r.fqid);for(const p of n){const n=i.getTile(p).getBucket(r);if(!n||n.projection.name!==s.projection.name)continue;const f=n.getModelUris();f&&!n.modelsRequested&&(l.addModelsFromBucket(f,o),n.modelsRequested=!0);const m=As(p,s);h.zoom=m;const g=u.possiblyEvaluate(h);if(Ts(t,n,p),Ms.shadowUniformsInitialized=!1,Ms.useSingleShadowCascade=!!c&&0===c.getMaxCascadeForTile(p.toUnwrapped()),"shadow"===t.renderPass&&c){if(1===t.currentShadowCascade&&n.isInsideFirstShadowMapFrustum)continue;const i=s.calculatePosMatrix(p.toUnwrapped(),s.worldSize);if(Ms.tileMatrix.set(i),Ms.shadowTileMatrix=Float32Array.from(c.calculateShadowPassMatrixFromMatrix(i)),Ms.aabb.min.fill(0),Ms.aabb.max[0]=Ms.aabb.max[1]=e.ag,Ms.aabb.max[2]=0,Ps(n,Ms,t,r.scope))continue}const y=1<<p.canonical.z,_=[((a.x-p.wrap)*y-p.canonical.x)*e.ag,(a.y*y-p.canonical.y)*e.ag,a.z*y*e.ag];t.conflationActive&&Object.keys(n.instancesPerModel).length>0&&t.style.isLayerClipped(r,i.getSource())&&n.updateReplacement(p,t.replacementSource,d,o)&&(n.uploaded=!1,n.upload(t.context));for(let e in n.instancesPerModel){const i=n.instancesPerModel[e];i.features.length>0&&(e=g.evaluate(i.features[0].feature,{}));const s=l.getModel(e,o);if(s&&s.uploaded)for(const e of s.nodes)Cs(t,r,e,i,_,p,Ms)}}}(t,i,r,n,"vector"===u.type?r.scope:""),void c();if(!u.loaded())return;if("batched-model"===u.type)return function(t,i,r,n){r.resetLayerRenderingStats(t);const o=t.context,s=t.transform,a=t.style.fog,l=t.shadowRenderer;if("mercator"!==s.projection.name)return void e.w(`Drawing 3D landmark models for ${s.projection.name} projection is not yet implemented`);const c=t.transform.getFreeCameraOptions().position,u=e.ab.vec3.scale([],[c.x,c.y,c.z],t.transform.worldSize),h=e.ab.vec3.negate([],u),d=e.ab.mat4.identity([]),p=e.dj(s.center.lat,s.zoom),f=e.ab.mat4.fromScaling([],[1,1,1/p]);e.ab.mat4.translate(d,d,h);const m=r.paint.get("model-opacity").constantOr(1),g=new Bi(o.gl.LEQUAL,Bi.ReadWrite,t.depthRangeFor3D),y=new Bi(o.gl.LEQUAL,Bi.ReadOnly,t.depthRangeFor3D),_=new e.cd([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),v="shadow"===t.renderPass,x=v&&l?l.getCurrentCascadeFrustum():s.getFrustum(s.scaleZoom(s.worldSize)),b=r.paint.get("model-front-cutoff"),w=b[2]<1,S=er(t,r.paint.get("model-cutoff-fade-range")),T=r.getLayerRenderingStats();(function(e,t,i,r){const n=e.terrain?e.terrain.exaggeration():0,o=e.transform.zoom;for(const s of r){const r=t.getTile(s).getBucket(i);r&&(e.conflationActive&&r.updateReplacement(s,e.replacementSource),r.evaluateScale(e,i),e.terrain&&n>0&&r.elevationUpdate(e.terrain,n,s,i.source),r.needsReEvaluation(e,o,i)&&r.evaluate(i))}})(t,i,r,n),function(){let c,h,M;w?(c=n.length-1,h=-1,M=-1):(c=0,h=n.length,M=1);const A=new Float64Array(16),C=e.ab.vec3.create(),E=new e.P(0,0);for(let P=c;P!==h;P+=M){const c=n[P],h=i.getTile(c).getBucket(r);if(!h||!h.uploaded)continue;let M=!1;l&&(M=0===l.getMaxCascadeForTile(c.toUnwrapped()));const k=s.calculatePosMatrix(c.toUnwrapped(),s.worldSize),I=h.modelTraits;!v&&w&&(e.ab.mat4.invert(A,k),e.ab.vec3.transformMat4(C,u,A),E.x=C[0],E.y=C[1]);const D=[];for(const i of h.getNodesInfo()){if(i.hiddenByReplacement)continue;if(!i.node.meshes)continue;const r=i.node;let n=0;t.terrain&&r.elevation&&(n=r.elevation*t.terrain.exaggeration());const o=(()=>{const t=i.aabb;return _.min=[...t.min],_.max=[...t.max],_.min[2]+=n,_.max[2]+=n,e.ab.vec3.transformMat4(_.min,_.min,k),e.ab.vec3.transformMat4(_.max,_.max,k),_})(),a=i.evaluatedScale;if(a[0]<=1&&a[1]<=1&&a[2]<=1&&0===o.intersects(x))continue;if(!v&&w){const t=1/6;i.cameraCollisionOpacity=u[0]>o.min[0]&&u[0]<o.max[0]&&u[1]>o.min[1]&&u[1]<o.max[1]&&u[2]*p<o.max[2]&&r.footprint&&e.bA(E,r.footprint)?Math.max(i.cameraCollisionOpacity-t,0):Math.min(1,i.cameraCollisionOpacity+t)}const l=[...k],c=r.anchor?r.anchor[0]:0,h=r.anchor?r.anchor[1]:0;e.ab.mat4.translate(l,l,[c*(a[0]-1),h*(a[1]-1),n]),e.ab.vec3.exactEquals(a,e.dm)||e.ab.mat4.scale(l,l,a);const d=e.ab.mat4.multiply([],l,r.matrix),f=e.ab.mat4.multiply([],s.expandedFarZProjMatrix,d),g=e.ab.mat4.multiply([],s.expandedFarZProjMatrix,l),y=e.ab.vec4.transformMat4([],[c,h,n,1],f)[2];r.hidden=!1;let T=m;v||(w&&(T*=i.cameraCollisionOpacity,T*=Is(l,s,i.aabb,b)),T*=ks(S,y)),0!==T?D.push({nodeInfo:i,depth:y,opacity:T,wvpForNode:f,wvpForTile:g,nodeModelMatrix:d,tileModelMatrix:l}):r.hidden=!0}v||D.sort(((e,t)=>!w||1===e.opacity&&1===t.opacity?e.depth<t.depth?-1:1:1===e.opacity?-1:1===t.opacity?1:e.depth>t.depth?-1:1));for(const i of D){const n=i.nodeInfo,c=n.node;let u=e.ab.mat4.multiply([],f,i.tileModelMatrix);e.ab.mat4.multiply(u,d,u);const h=e.ab.mat4.invert([],u);e.ab.mat4.transpose(h,h),e.ab.mat4.scale(h,h,Es),u=e.ab.mat4.multiply(u,u,c.matrix);const p="light-beam"===t.renderPass,m="none"===r.paint.get("model-color-use-theme").constantOr("default"),_=I&e.dp.HasMapboxMeshFeatures,x=_?0:n.evaluatedRMEA[0][2];for(let e=0;e<c.meshes.length;++e){const d=c.meshes[e],f=e===c.lightMeshIndex;let b=i.wvpForNode;if(f){if(!p&&!t.terrain&&t.shadowRenderer){t.currentLayer<t.firstLightBeamLayer&&(t.firstLightBeamLayer=t.currentLayer);continue}b=i.wvpForTile}else if(p)continue;const w={defines:[]},S=[];if(!v&&l&&(l.useNormalOffset=!!d.normalBuffer),xs(w.defines,S,d,t,m?null:r.lut),_||w.defines.push("DIFFUSE_SHADED"),M&&w.defines.push("SHADOWS_SINGLE_CASCADE"),T&&(v?T.numRenderedVerticesInShadowPass+=d.vertexArray.length:T.numRenderedVerticesInTransparentPass+=d.vertexArray.length),v){Ss(d,i.nodeModelMatrix,t,r);continue}let A=null;if(a){const e=vs(i.nodeModelMatrix,t.transform);if(A=new Float32Array(e),"globe"!==s.projection.name){const t=d.aabb.min,i=d.aabb.max,[r,n]=a.getOpacityForBounds(e,t[0],t[1],i[0],i[1]);w.overrideFog=r>=Oe||n>=Oe}}const C=d.material;let E;C.occlusionTexture&&C.occlusionTexture.offsetScale&&(E=C.occlusionTexture.offsetScale,w.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const P=t.getOrCreateProgram("model",w);!v&&l&&l.setupShadowsFromMatrix(i.tileModelMatrix,P,l.useNormalOffset),t.uploadCommonUniforms(o,P,null,A);const k=C.pbrMetallicRoughness;k.metallicFactor=.9,k.roughnessFactor=.5;const I=wo(new Float32Array(b),new Float32Array(u),new Float32Array(h),new Float32Array(c.matrix),t,i.opacity,k.baseColorFactor.toRenderColor(null),C.emissiveFactor,k.metallicFactor,k.roughnessFactor,C,x,r,[0,0,0],E);!f&&(n.hasTranslucentParts||i.opacity<1)&&P.draw(t,o.gl.TRIANGLES,g,ji.disabled,Fi.disabled,Gi.backCCW,I,r.id,d.vertexBuffer,d.indexBuffer,d.segments,r.paint,t.transform.zoom,void 0,S),P.draw(t,o.gl.TRIANGLES,f?y:g,ji.disabled,f||i.opacity<1||n.hasTranslucentParts?Fi.alphaBlended:Fi.unblended,Gi.backCCW,I,r.id,d.vertexBuffer,d.indexBuffer,d.segments,r.paint,t.transform.zoom,void 0,S)}}}}()}(t,i,r,n),void c();if("model"!==u.type)return;const h=u.getModels(),d=[],p=t.transform.getFreeCameraOptions().position,f=e.ab.vec3.scale([],[p.x,p.y,p.z],t.transform.worldSize);e.ab.vec3.negate(f,f);const m=[],g=[];let y=0;for(const _ of h){const i=r.paint.get("model-rotation").constantOr(null),n=r.paint.get("model-scale").constantOr(null),o=r.paint.get("model-translation").constantOr(null);_.computeModelMatrix(t,i,n,o,!0,!0,!1);const s=e.ab.mat4.identity([]),a=e.dj(_.position.lat,t.transform.zoom),l=e.ab.mat4.fromScaling([],[1,1,1/a]);e.ab.mat4.translate(s,s,f),d.push({zScaleMatrix:l,negCameraPosMatrix:s});for(const e of _.nodes)ws(t.transform,e,_.matrix,t.transform.expandedFarZProjMatrix,y,m,g);y++}if(m.sort(((e,t)=>t.depth-e.depth)),"shadow"!==t.renderPass){if(1===o)for(const e of g)bs(e,t,r,d[e.modelIndex],ji.disabled,t.colorModeForRenderPass());else{for(const e of g)bs(e,t,r,d[e.modelIndex],ji.disabled,Fi.disabled);for(const e of g)bs(e,t,r,d[e.modelIndex],t.stencilModeFor3D(),t.colorModeForRenderPass());t.resetStencilClippingMasks()}for(const e of m)bs(e,t,r,d[e.modelIndex],ji.disabled,t.colorModeForRenderPass());c()}else{for(const e of g)Ss(e.mesh,e.nodeModelMatrix,t,r);for(const e of m)Ss(e.mesh,e.nodeModelMatrix,t,r);c()}}},Ys={line:function(e,t,i){if(e.hasElevatedBuckets=!1,e.hasNonElevatedBuckets=!1,void 0!==e._unevaluatedLayout.getValue("line-elevation-reference")||void 0!==e._unevaluatedLayout.getValue("line-z-offset")){if(t){const i=t.getVisibleCoordinates();for(const r of i){const i=t.getTile(r).getBucket(e);if(i&&(i.hasZOffset?e.hasElevatedBuckets=!0:e.hasNonElevatedBuckets=!0,e.hasElevatedBuckets&&e.hasNonElevatedBuckets))break}}}else e.hasNonElevatedBuckets=!0},model:function(e,t,i){const r=t.getSource();if(!r.loaded())return;if("vector"===r.type||"geojson"===r.type)return void(i.modelManager&&i.modelManager.upload(i,"vector"===r.type?e.scope:""));if("batched-model"===r.type)return;if("model"!==r.type)return;const n=r.getModels();for(const o of n)o.upload(i.context)},raster:function(e,t,i){const r=t.getSource();if(!(r instanceof rt&&r.loaded()))return;const n=e.sourceLayer||r.rasterLayerIds&&r.rasterLayerIds[0];if(!n)return;const o=e.paint.get("raster-array-band")||r.getInitialBand(n);if(null==o)return;const s=t.getIds().map((e=>t.getTileByID(e)));for(const a of s)a.updateNeeded(n,o)&&r.prepareTile(a,n,o)},"raster-particle":function(e,t,i){const r=t.getSource();if(!(r instanceof rt&&r.loaded()))return;const n=e.sourceLayer||r.rasterLayerIds&&r.rasterLayerIds[0];if(!n)return;const o=e.paint.get("raster-particle-array-band")||r.getInitialBand(n);if(null==o)return;const s=t.getIds().map((e=>t.getTileByID(e)));for(const a of s)a.updateNeeded(n,o)&&r.prepareTile(a,n,o)}};class Zs{constructor(t,i,r,n,o){this.context=new Po(t,i),this.transform=r,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=o,this._timeStamp=e.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const s=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const e of s)this._debugParams.enabledLayers[e]=!0;o.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},(()=>{this.style.map.triggerRepaint()})),o.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),o.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),o.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),o.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),o.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const e of s)o.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],e);this.occlusionParams=new Rs(o),this.setup(),this.numSublayers=Mt.maxUnderzooming+Mt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new e.dv,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new nr(this),this._wireframeDebugCache=new Ls,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const a=new e.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new e.T(this.context,a,t.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=n}updateTerrain(e,t){const i=!!e&&!!e.terrain&&this.transform.projection.supportsTerrain;if(!(i||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Gn(this,e));const r=this._terrain;this.transform.elevation=i?r:null,r.update(e,this.transform,t),this.transform.elevation&&!r.enabled&&(this.transform.elevation=null)}_updateFog(e){const t=e.fog;if(!t||"globe"===this.transform.projection.name||t.getOpacity(this.transform.pitch)<1||t.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[i,r]=t.getFovAdjustedRange(this.transform._fov);if(i>r)return void(this.transform.fogCullDistSq=null);const n=i+.78*(r-i);this.transform.fogCullDistSq=n*n}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(e){e&&!this._terrain&&(this._terrain=new Gn(this,this.style)),this._forceTerrainMode=e}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(t,i){if(this.width=t*e.q.devicePixelRatio,this.height=i*e.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const e of this.style.order)this.style._mergedLayers[e].resize()}setup(){const t=this.context,i=new e.b4;i.emplaceBack(0,0),i.emplaceBack(e.ag,0),i.emplaceBack(0,e.ag),i.emplaceBack(e.ag,e.ag),this.tileExtentBuffer=t.createVertexBuffer(i,e.b6.members),this.tileExtentSegments=e.b7.simpleSegment(0,0,4,2);const r=new e.b4;r.emplaceBack(0,0),r.emplaceBack(e.ag,0),r.emplaceBack(0,e.ag),r.emplaceBack(e.ag,e.ag),this.debugBuffer=t.createVertexBuffer(r,e.b6.members),this.debugSegments=e.b7.simpleSegment(0,0,4,5);const n=new e.b4;n.emplaceBack(-1,-1),n.emplaceBack(1,-1),n.emplaceBack(-1,1),n.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(n,e.b6.members),this.viewportSegments=e.b7.simpleSegment(0,0,4,2);const o=new e.aT;o.emplaceBack(0,0,0,0),o.emplaceBack(e.ag,0,e.ag,0),o.emplaceBack(0,e.ag,0,e.ag),o.emplaceBack(e.ag,e.ag,e.ag,e.ag),this.mercatorBoundsBuffer=t.createVertexBuffer(o,e.b9.members),this.mercatorBoundsSegments=e.b7.simpleSegment(0,0,4,2);const s=new e.aU;s.emplaceBack(0,1,2),s.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(s);const a=new e.b5;for(const e of[0,1,3,2,0])a.emplaceBack(e);this.debugIndexBuffer=t.createIndexBuffer(a),this.emptyTexture=new e.T(t,new e.r({width:1,height:1},Uint8Array.of(0,0,0,0)),t.gl.RGBA8),this.identityMat=e.ab.mat4.create();const l=this.context.gl;this.stencilClearMode=new ji({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(e){return e._makeTileBoundsBuffers(this.context,this.transform.projection),e._tileBoundsBuffer?{tileBoundsBuffer:e._tileBoundsBuffer,tileBoundsIndexBuffer:e._tileBoundsIndexBuffer,tileBoundsSegments:e._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const e=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,e.TRIANGLES,Bi.disabled,this.stencilClearMode,Fi.disabled,Gi.disabled,Bn(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(e,t,i){if(!t||this.currentStencilSource===t.id||!e.isTileClipped()||!i||0===i.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let e=!1;for(const t of i)if(void 0===this._tileClippingMaskIDs[t.key]){e=!0;break}if(!e)return}this.currentStencilSource=t.id;const r=this.context,n=r.gl;this.nextStencilID+i.length>256&&this.clearStencil(),r.setColorMode(Fi.disabled),r.setDepthMode(Bi.disabled);const o=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const s of i){const e=t.getTile(s),i=this._tileClippingMaskIDs[s.key]=this.nextStencilID++,{tileBoundsBuffer:r,tileBoundsIndexBuffer:a,tileBoundsSegments:l}=this.getTileBoundsBuffers(e);o.draw(this,n.TRIANGLES,Bi.disabled,new ji({func:n.ALWAYS,mask:0},i,255,n.KEEP,n.KEEP,n.REPLACE),Fi.disabled,Gi.disabled,Bn(s.projMatrix),"$clipping",r,a,l)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,t=this.context.gl;return new ji({func:t.NOTEQUAL,mask:255},e,255,t.KEEP,t.KEEP,t.REPLACE)}stencilModeForClipping(e){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(e);const t=this.context.gl;return new ji({func:t.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,t.KEEP,t.KEEP,t.REPLACE)}stencilConfigForOverlap(e){const t=this.context.gl,i=e.sort(((e,t)=>t.overscaledZ-e.overscaledZ)),r=i[i.length-1].overscaledZ,n=i[0].overscaledZ-r+1;if(n>1){this.currentStencilSource=void 0,this.nextStencilID+n>256&&this.clearStencil();const e={};for(let i=0;i<n;i++)e[i+r]=new ji({func:t.GEQUAL,mask:255},i+this.nextStencilID,255,t.KEEP,t.KEEP,t.REPLACE);return this.nextStencilID+=n,[e,i]}return[{[r]:ji.disabled},i]}colorModeForRenderPass(){const t=this.context.gl;if(this._showOverdrawInspector){const i=1/8;return new Fi([t.CONSTANT_COLOR,t.ONE,t.CONSTANT_COLOR,t.ONE],new e.aj(i,i,i,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?Fi.unblended:Fi.alphaBlended}colorModeForDrapableLayerRenderPass(t){const i=this.context.gl;return(()=>this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture)()&&"translucent"===this.renderPass?new Fi([i.ONE,i.ONE_MINUS_SRC_ALPHA,i.CONSTANT_ALPHA,i.ONE_MINUS_SRC_ALPHA],new e.aj(0,0,0,void 0===t?0:t),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.depthOcclusion)return new Bi(this.context.gl.GREATER,Bi.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!r)return Bi.disabled;const n=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Bi(i||this.context.gl.LEQUAL,t,[n,n])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const t=this.context.gl,i=Math.ceil(this.width),r=Math.ceil(this.height),n=this.context.bindFramebuffer.get(),o=t.getParameter(t.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===i&&this.depthFBO.height===r||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),0!==i&&0!==r&&(this.depthFBO=new Eo(this.context,i,r,!1,"texture"),this.depthTexture=new e.T(this.context,{width:i,height:r,data:null},t.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(n),t.bindTexture(t.TEXTURE_2D,o),this.depthFBO&&(t.bindFramebuffer(t.READ_FRAMEBUFFER,null),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),t.blitFramebuffer(0,0,i,r,0,0,i,r,t.DEPTH_BUFFER_BIT,t.NEAREST),t.bindFramebuffer(t.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(0===this._dt?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce(((e,t)=>e+t/this._fpsHistory.length),0))}render(t,i){const r=e.q.now();this._dt=r-this._timeStamp,this._timeStamp=r,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=t.map.repaint,this.style=t,this.options=i;const n=this.style._mergedLayers,o=!(!this.terrain||!this.terrain.enabled),s=()=>this.style._getOrder(o).filter((e=>{const t=n[e];return!(t.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[t.type]}));let a=s(),l=!1,c=!1;for(const e of a){const t=n[e];"circle"===t.type&&(l=!0),"symbol"===t.type&&(t.hasInitialOcclusionOpacityProperties?c=!0:l=!0)}let u=a.map((e=>n[e]));const h=this.style._mergedSourceCaches;this.imageManager=t.imageManager,this.modelManager=t.modelManager,this.symbolFadeChange=t.placement.symbolFadeChange(e.q.now()),this.imageManager.beginFrame();let d=0,p=!1;for(const e in h){const t=h[e];t.used&&(t.prepare(this.context),t.getSource().usedInConflation&&++d)}let f=!1;for(const e of u)e.isHidden(this.transform.zoom)||("clip"===e.type&&(f=!0),this.prepareLayer(e));const m={},g={},y={},_={},v={};for(const e in h){const t=h[e];m[e]=t.getVisibleCoordinates(),g[e]=m[e].slice().reverse(),y[e]=t.getVisibleCoordinates(!0).reverse(),_[e]=t.getShadowCasterCoordinates(),v[e]=t.sortCoordinatesByDistance(m[e])}const x=e=>{const t=this.style.getLayerSourceCache(e);return t&&t.used?t.getSource():null};if(d||f||this._clippingActiveLastFrame){const t=[],i=[];let r=0;for(const e of u)this.isSourceForClippingOrConflation(e,x(e))&&(t.push(e),i.push(r)),r++;if(t&&(f||t.length>1)||this._clippingActiveLastFrame){f=!1;const r=[];for(let n=0;n<t.length;n++){const o=t[n],s=i[n],a=this.style.getLayerSourceCache(o);if(!a||!a.used||!a.getSource().usedInConflation&&"clip"!==o.type)continue;let l=e.dx,c=e.by.None;const u=[];let h=!0;if("clip"===o.type){l=s;for(const t of o.layout.get("clip-layer-types"))c|="model"===t?e.by.Model:"symbol"===t?e.by.Symbol:e.by.FillExtrusion;for(const e of o.layout.get("clip-layer-scope"))u.push(e);o.isHidden(this.transform.zoom)?h=!1:f=!0}h&&r.push({layer:o.fqid,cache:a,order:l,clipMask:c,clipScope:u})}this.replacementSource.setSources(r),p=!0}}this._clippingActiveLastFrame=f,p||this.replacementSource.clear(),this.conflationActive=p,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let e=0;e<u.length;e++){const t=u[e],i=t.cutoffRange();if(this.longestCutoffRange=Math.max(i,this.longestCutoffRange),i>0){const e=x(t);e&&(this.minCutoffZoom=Math.max(e.minzoom,this.minCutoffZoom)),t.minzoom&&(this.minCutoffZoom=Math.max(t.minzoom,this.minCutoffZoom))}t.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=e),this._lastOcclusionLayer=e)}const b=this.style&&this.style.fog;b?(this._fogVisible=0!==b.getOpacity(this.transform.pitch),this._fogVisible&&"globe"!==this.transform.projection.name&&(this._fogVisible=b.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(y),this.opaquePassCutoff=0,a=s(),u=a.map((e=>n[e])));const w=this._shadowRenderer;if(w){w.updateShadowParameters(this.transform,this.style.directionalLight);for(const e in h)for(const t of m[e]){let e={min:0,max:0};this.terrain&&(e=this.terrain.getMinMaxForTile(t)||e),w.addShadowReceiver(t.toUnwrapped(),e.min,e.max)}}"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new e.dw(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new _s(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const S=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),T=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(S&&!this._snow&&(this._snow=new qs(this)),!S&&this._snow&&(this._snow.destroy(),delete this._snow),T&&!this._rain&&(this._rain=new Ws(this)),!T&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),!j.has(this.context.gl))return;this.renderPass="offscreen";for(const e of u){const i=t.getLayerSourceCache(e);if(!e.hasOffscreenPass()||e.isHidden(this.transform.zoom))continue;const r=i?g[i.id]:void 0;("custom"===e.type||"raster"===e.type||"raster-particle"===e.type||e.isSky()||r&&r.length)&&this.renderLayer(this,i,e,r)}this.depthRangeFor3D=[0,1-(u.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,_)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const M="globe"===this.transform.projection.name||this.transform.isHorizonVisible(),A=(()=>{if(i.showOverdrawInspector)return e.aj.black;const t=this.style.fog;if(t&&this.transform.projection.supportsFog){const i=this.style.getLut(t.scope);if(!M){const r="none"===t.properties.get("color-use-theme"),n=t.properties.get("color").toRenderColor(r?null:i).toArray01();return new e.aj(...n)}if(M){const r="none"===t.properties.get("space-color-use-theme"),n=t.properties.get("space-color").toRenderColor(r?null:i).toArray01();return new e.aj(...n)}}return e.aj.transparent})();if(this.context.clear({color:A,depth:1}),this.clearStencil(),this._showOverdrawInspector=i.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&M&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=a.length-1;this.currentLayer>=0;this.currentLayer--){const e=u[this.currentLayer],i=t.getLayerSourceCache(e);if(e.isSky())continue;const r=i?(e.is3D()?v:g)[i.id]:void 0;this._renderTileClippingMasks(e,i,r),this.renderLayer(this,i,e,r)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&M&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||e.ae(this.transform.zoom)>0)&&("globe"===this.transform.projection.name||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<a.length;this.currentLayer++){const e=u[this.currentLayer],i=t.getLayerSourceCache(e);e.isSky()&&this.renderLayer(this,i,e,i?g[i.id]:void 0)}function C(e,t){let i;return t&&(i=("symbol"===e.type?y:e.is3D()?v:g)[t.id]),i}if(this.renderPass="translucent","globe"===this.transform.projection.name){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<a.length;){const e=u[this.currentLayer];if("raster"===e.type||"raster-particle"===e.type){const i=t.getLayerSourceCache(e);this.renderLayer(this,i,e,C(e,i))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let E=0;w&&(E=w.getShadowCastingLayerCount());let P=!1,k=-1;for(let e=0;e<a.length;++e){const t=u[e];t.isHidden(this.transform.zoom)||t.is3D()&&(k=e)}for(c&&-1===k&&(l=!0);this.currentLayer<a.length;){const e=u[this.currentLayer],i=t.getLayerSourceCache(e);if(e.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(e)){if(e.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(l&&!P&&this.terrain&&!this.transform.isOrthographic&&(P=!0,this.blitDepth()),c&&-1!==k&&this.currentLayer===k+1&&!this.transform.isOrthographic&&this.blitDepth(),e.is3D()||this.terrain||this._renderTileClippingMasks(e,i,i?m[i.id]:void 0),this.renderLayer(this,i,e,C(e,i)),!this.terrain&&w&&E>0&&e.hasShadowPass()&&0==--E&&(w.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const e=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=e;this.currentLayer++){const e=u[this.currentLayer];if(!e.hasLightBeamPass())continue;const i=t.getLayerSourceCache(e);this.renderLayer(this,i,e,i?g[i.id]:void 0)}this.currentLayer=e,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const e=this.currentLayer;this.depthOcclusion=!0;for(const i of this.layersWithOcclusionOpacity){this.currentLayer=i;const e=u[this.currentLayer],r=t.getLayerSourceCache(e),n=r?g[r.id]:void 0;e.is3D()||this.terrain||this._renderTileClippingMasks(e,r,r?m[r.id]:void 0),this.renderLayer(this,r,e,n)}this.depthOcclusion=!1,this.currentLayer=e,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let i=null;u.forEach((e=>{const r=t.getLayerSourceCache(e);r&&!e.isHidden(this.transform.zoom)&&r.getVisibleCoordinates().length&&(!i||i.getSource().maxzoom<r.getSource().maxzoom)&&(i=r)})),i&&this.options.showTileBoundaries&&Xs.debug(this,i,i.getVisibleCoordinates(),e.aj.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Xs.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new e.aj(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(e){const t=e.transform.padding;ss(e,e.transform.height-(t.top||0),3,es),ss(e,t.bottom||0,3,ts),as(e,t.left||0,3,is),as(e,e.transform.width-(t.right||0),3,rs);const i=e.transform.centerPoint;!function(e,t,i,r){ls(e,t-1,i-10,2,20,r),ls(e,t-10,i-1,20,2,r)}(e,i.x,e.transform.height-i.y,ns)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),p||(this.conflationActive=!1)}prepareLayer(e){this.gpuTimingStart(e);const{unsupportedLayers:t}=this.transform.projection,i=!t||!t.includes(e.type);if(Ys[e.type]&&(i||this.terrain&&"custom"===e.type)){const t=this.style.getLayerSourceCache(e);Ys[e.type](e,t,this)}this.gpuTimingEnd()}renderLayer(e,t,i,r){i.isHidden(this.transform.zoom)||("background"===i.type||"sky"===i.type||"custom"===i.type||"model"===i.type||"raster"===i.type||"raster-particle"===i.type||r&&r.length)&&(this.id=i.id,this.gpuTimingStart(i),e.transform.projection.unsupportedLayers&&e.transform.projection.unsupportedLayers.includes(i.type)&&(!e.terrain||"custom"!==i.type)||"clip"===i.type||Xs[i.type](e,t,i,r,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(e){if(!this.options.gpuTiming)return;const t=this.context.extTimerQuery,i=this.context.gl;let r=this.gpuTimers[e.id];r||(r=this.gpuTimers[e.id]={calls:0,cpuTime:0,query:i.createQuery()}),r.calls++,i.beginQuery(t.TIME_ELAPSED_EXT,r.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const e=this.context.extTimerQuery,t=this.context.gl,i=t.createQuery();this.deferredRenderGpuTimeQueries.push(i),t.beginQuery(e.TIME_ELAPSED_EXT,i)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const e=this.gpuTimers;return this.gpuTimers={},e}collectDeferredRenderGpuQueries(){const e=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],e}queryGpuTimers(e){const t={};for(const i in e){const r=e[i],n=this.context.extTimerQuery,o=n.getQueryParameter(r.query,this.context.gl.QUERY_RESULT)/1e6;n.deleteQueryEXT(r.query),t[i]=o}return t}queryGpuTimeDeferredRender(e){if(!this.options.gpuTimingDeferredRender)return 0;const t=this.context.gl;let i=0;for(const r of e)i+=t.getQueryParameter(r,t.QUERY_RESULT)/1e6,t.deleteQuery(r);return i}translatePosMatrix(t,i,r,n,o){if(!r[0]&&!r[1])return t;const s=o?"map"===n?this.transform.angle:0:"viewport"===n?-this.transform.angle:0;if(s){const e=Math.sin(s),t=Math.cos(s);r=[r[0]*t-r[1]*e,r[0]*e+r[1]*t]}const a=[o?r[0]:e.ar(i,r[0],this.transform.zoom),o?r[1]:e.ar(i,r[1],this.transform.zoom),0],l=new Float32Array(16);return e.ab.mat4.translate(l,t,a),l}saveTileTexture(e){const t=e.size[0],i=this._tileTextures[t];i?i.push(e):this._tileTextures[t]=[e]}getTileTexture(e){const t=this._tileTextures[e];return t&&t.length>0?t.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return null!=this.context.extTextureFloatLinear}currentGlobalDefines(e,t,i){const r=void 0===i?this.terrain&&this.terrain.renderingToTexture:i,n=[];return this.style&&this.style.enable3dLights()&&("globeRaster"===e||"terrainRaster"===e?(n.push("LIGHTING_3D_MODE"),n.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):r||n.push("LIGHTING_3D_MODE")),"shadow"===this.renderPass&&(this._shadowMapDebug||n.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(n.push("TERRAIN"),this.linearFloatFilteringSupported()&&n.push("TERRAIN_DEM_FLOAT_FORMAT")),"globe"===this.transform.projection.name&&n.push("GLOBE"),!this._fogVisible||r||void 0!==t&&!t||n.push("FOG","FOG_DITHERING"),r&&n.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&n.push("OVERDRAW_INSPECTOR"),n}getOrCreateProgram(e,t){this.cache=this.cache||{};const i=t&&t.defines||[],r=t&&t.config,n=this.currentGlobalDefines(e,t&&t.overrideFog,t&&t.overrideRtt).concat(i),o=qn.cacheKey(Nr[e],e,n,r);return this.cache[o]||(this.cache[o]=new qn(this.context,e,Nr[e],r,To[e],n)),this.cache[o]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new e.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(t,i){if(this.style.enable3dLights()){const r=this.style.directionalLight,n=this.style.ambientLight;if(r&&n){const o=((t,i,r)=>{const n=t.properties.get("direction"),o="none"===t.properties.get("color-use-theme"),s=t.properties.get("color").toRenderColor(o?null:r.getLut(t.scope)).toArray01(),a=t.properties.get("intensity"),l="none"===i.properties.get("color-use-theme"),c=i.properties.get("color").toRenderColor(l?null:r.getLut(i.scope)).toArray01(),u=i.properties.get("intensity"),h=[n.x,n.y,n.z],d=e.cM(c,u),p=e.cM(s,a);return{u_lighting_ambient_color:d,u_lighting_directional_dir:h,u_lighting_directional_color:p,u_ground_radiance:Hn(h,p,d)}})(r,n,this.style);i.setLightsUniformValues(t,o)}}}uploadCommonUniforms(t,i,r,n,o){if(this.uploadCommonLightUniforms(t,i),this.terrain&&this.terrain.renderingToTexture)return;const s=this.style.fog;if(s){const o=s.getOpacity(this.transform.pitch),a=((t,i,r,n,o,s,a,l,c,u,h,d)=>{const p=t.transform,f="none"===i.properties.get("color-use-theme"),m=i.properties.get("color").toRenderColor(f?null:t.style.getLut(i.scope)).toArray01();m[3]=n;const g=t.frameCounter/1e3%1,[y,_]=i.properties.get("vertical-range");return{u_fog_matrix:r?p.calculateFogTileMatrix(r):d||t.identityMat,u_fog_range:i.getFovAdjustedRange(p._fov),u_fog_color:m,u_fog_horizon_blend:i.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(y,_),_],u_fog_temporal_offset:g,u_frustum_tl:o,u_frustum_tr:s,u_frustum_br:a,u_frustum_bl:l,u_globe_pos:c,u_globe_radius:u,u_viewport:h,u_globe_transition:e.ae(p.zoom),u_is_globe:+("globe"===p.projection.name)}})(this,s,r,o,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*e.q.devicePixelRatio,this.transform.height*e.q.devicePixelRatio],n);i.setFogUniformValues(t,a)}o&&i.setCutoffUniformValues(t,o.uniformValues)}setTileLoadedFlag(e){this.tileLoaded=e}saveCanvasCopy(){const e=this.canvasCopy();e&&(this.frameCopies.push(e),this.tileLoaded=!1)}canvasCopy(){const e=this.context.gl,t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.copyTexImage2D(e.TEXTURE_2D,0,e.RGBA,0,0,e.drawingBufferWidth,e.drawingBufferHeight,0),t}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const e=this.style&&this.style.fog;return!!e&&0!==e.getOpacity(this.transform.pitch)}getBackgroundTiles(){const e=this._backgroundTiles,t=this._backgroundTiles={},i=this.transform.coveringTiles({tileSize:512});for(const r of i)t[r.key]=e[r.key]||new bt(r,512,this.transform.tileZoom,this);return t}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(e,t){return!(!e.is3D()||"clip"!==e.type&&(e.minzoom&&e.minzoom>this.transform.zoom||(this.style._clipLayerPresent||"building"!==e.sourceLayer)&&(!t||"batched-model"!==t.type)))}isTileAffectedByFog(e){if(!this.style||!this.style.fog)return!1;if("globe"===this.transform.projection.name)return!0;let t=this._cachedTileFogOpacities[e.key];return t||(this._cachedTileFogOpacities[e.key]=t=this.style.fog.getOpacityForTile(e)),t[0]>=Oe||t[1]>=Oe}setupDepthForOcclusion(e,t,i){const r=this.context,n=r.gl,o=!!i;var s;i||(i={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),r.activeTexture.set(n.TEXTURE3),e&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(n.NEAREST,n.CLAMP_TO_EDGE),i.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],i.u_depth_range_unpack=[2/((s=this.depthRangeFor3D)[1]-s[0]),-1-2*s[0]/(s[1]-s[0])],i.u_occluder_half_size=.5*this.occlusionParams.occluderSize,i.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(n.NEAREST,n.CLAMP_TO_EDGE),r.activeTexture.set(n.TEXTURE0),o||t.setTerrainUniformValues(r,i)}}function Ks(e,t){let i=!1,r=null;const n=()=>{r=null,i&&(e(),r=setTimeout(n,t),i=!1)};return()=>(i=!0,r||n(),r)}class Js{constructor(t){this._hashName=t&&encodeURIComponent(t),e.aP(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Ks(this._updateHashUnthrottled.bind(this),300)}addTo(e){return this._map=e,window.addEventListener("hashchange",this._onHashChange,!1),e.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const e=this._map;if(!e)return"";const t=Qs(e);if(this._hashName){const e=this._hashName;let i=!1;const r=location.hash.slice(1).split("&").map((r=>{const n=r.split("=")[0];return n===e?(i=!0,`${n}=${t}`):r})).filter((e=>e));return i||r.push(`${e}=${t}`),`#${r.join("&")}`}return`#${t}`}_getCurrentHash(){const e=location.hash.replace("#","");if(this._hashName){let t;return e.split("&").map((e=>e.split("="))).forEach((e=>{e[0]===this._hashName&&(t=e)})),(t&&t[1]||"").split("/")}return e.split("/")}_onHashChange(){const e=this._map;if(!e)return!1;const t=this._getCurrentHash();if(t.length>=3&&!t.some((e=>isNaN(e)))){const i=e.dragRotate.isEnabled()&&e.touchZoomRotate.isEnabled()?+(t[3]||0):e.getBearing();return e.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:i,pitch:+(t[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Qs(e,t){const i=e.getCenter(),r=Math.round(100*e.getZoom())/100,n=Math.ceil((r*Math.LN2+Math.log(512/360/.5))/Math.LN10),o=Math.pow(10,n),s=Math.round(i.lng*o)/o,a=Math.round(i.lat*o)/o,l=e.getBearing(),c=e.getPitch();let u=t?`/${s}/${a}/${r}`:`${r}/${a}/${s}`;return(l||c)&&(u+="/"+Math.round(10*l)/10),c&&(u+=`/${Math.round(c)}`),u}const ea={linearity:.3,easing:e.dy(0,0,.3,1)},ta=e.l({deceleration:2500,maxSpeed:1400},ea),ia=e.l({deceleration:20,maxSpeed:1400},ea),ra=e.l({deceleration:1e3,maxSpeed:360},ea),na=e.l({deceleration:1e3,maxSpeed:90},ea);class oa{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.q.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,i=e.q.now();for(;t.length>0&&i-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._map._prefersReducedMotion())return;if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const i={zoom:0,bearing:0,pitch:0,pan:new e.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:e}of this._inertiaBuffer)i.zoom+=e.zoomDelta||0,i.bearing+=e.bearingDelta||0,i.pitch+=e.pitchDelta||0,e.panDelta&&i.pan._add(e.panDelta),e.around&&(i.around=e.around),e.pinchAround&&(i.pinchAround=e.pinchAround);const r=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,n={};if(i.pan.mag()){const o=aa(i.pan.mag(),r,e.l({},ta,t||{}));n.offset=i.pan.mult(o.amount/i.pan.mag()),n.center=this._map.transform.center,sa(n,o)}if(i.zoom){const e=aa(i.zoom,r,ia);n.zoom=this._map.transform.zoom+e.amount,sa(n,e)}if(i.bearing){const t=aa(i.bearing,r,ra);n.bearing=this._map.transform.bearing+e.aw(t.amount,-179,179),sa(n,t)}if(i.pitch){const e=aa(i.pitch,r,na);n.pitch=this._map.transform.pitch+e.amount,sa(n,e)}if(n.zoom||n.bearing){const e=void 0===i.pinchAround?i.around:i.pinchAround;n.around=e?this._map.unproject(e):this._map.getCenter()}return this.clear(),n.noMoveStart=!0,n}}function sa(e,t){(!e.duration||e.duration<t.duration)&&(e.duration=t.duration,e.easing=t.easing)}function aa(t,i,r){const{maxSpeed:n,linearity:o,deceleration:s}=r,a=e.aw(t*o/(i/1e3),-n,n),l=Math.abs(a)/(s*o);return{easing:r.easing,duration:1e3*l,amount:a*(l/2)}}class la extends e.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,i,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const o=y(i.getCanvasContainer(),r),s=i.unproject(o);super(t,e.l({point:o,lngLat:s,originalEvent:r},n)),this._defaultPrevented=!1,this.target=i}}class ca extends e.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,i,r){const n="touchend"===t?r.changedTouches:r.touches,o=_(i.getCanvasContainer(),n),s=o.map((e=>i.unproject(e))),a=o.reduce(((e,t,i,r)=>e.add(t.div(r.length))),new e.P(0,0));super(t,{points:o,point:a,lngLats:s,lngLat:i.unproject(a),originalEvent:r}),this._defaultPrevented=!1}}class ua extends e.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,t){super("wheel",{originalEvent:t}),this._defaultPrevented=!1}}class ha{constructor(e,t){this._map=e,this._clickTolerance=t.clickTolerance}reset(){this._mousedownPos=void 0}wheel(e){return this._firePreventable(new ua(this._map,e))}mousedown(e,t){return this._mousedownPos=t,this._firePreventable(new la(e.type,this._map,e))}mouseup(e){this._map.fire(new la(e.type,this._map,e))}preclick(t){const i=e.l({},t);i.type="preclick",this._map.fire(new la(i.type,this._map,i))}click(e,t){this._mousedownPos&&this._mousedownPos.dist(t)>=this._clickTolerance||(this.preclick(e),this._map.fire(new la(e.type,this._map,e)))}dblclick(e){return this._firePreventable(new la(e.type,this._map,e))}mouseover(e){this._map.fire(new la(e.type,this._map,e))}mouseout(e){this._map.fire(new la(e.type,this._map,e))}touchstart(e){return this._firePreventable(new ca(e.type,this._map,e))}touchmove(e){this._map.fire(new ca(e.type,this._map,e))}touchend(e){this._map.fire(new ca(e.type,this._map,e))}touchcancel(e){this._map.fire(new ca(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class da{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(e){this._map.fire(new la(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new la("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._map.fire(new la(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class pa{constructor(e,t){this._map=e,this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=t.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,t){this.isEnabled()&&e.shiftKey&&0===e.button&&(p(),this._startPos=this._lastPos=t,this._active=!0)}mousemoveWindow(e,t){if(!this._active)return;const i=t,r=this._startPos,n=this._lastPos;if(!r||!n||n.equals(i)||!this._box&&i.dist(r)<this._clickTolerance)return;this._lastPos=i,this._box||(this._box=l("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",e));const o=Math.min(r.x,i.x),s=Math.max(r.x,i.x),a=Math.min(r.y,i.y),c=Math.max(r.y,i.y);this._map._requestDomTask((()=>{this._box&&(this._box.style.transform=`translate(${o}px,${a}px)`,this._box.style.width=s-o+"px",this._box.style.height=c-a+"px")}))}mouseupWindow(t,i){if(!this._active)return;const r=this._startPos,n=i;if(r&&0===t.button){if(this.reset(),g(),r.x!==n.x||r.y!==n.y)return this._map.fire(new e.z("boxzoomend",{originalEvent:t})),{cameraAnimation:e=>e.fitScreenCoordinates(r,n,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",t)}}keydown(e){this._active&&27===e.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",e))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),f(),delete this._startPos,delete this._lastPos}_fireEvent(t,i){return this._map.fire(new e.z(t,{originalEvent:i}))}}function fa(e,t){const i={};for(let r=0;r<e.length;r++)i[e[r].identifier]=t[r];return i}class ma{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(t,i,r){(this.centroid||r.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=t.timeStamp),r.length===this.numTouches&&(this.centroid=function(t){const i=new e.P(0,0);for(const e of t)i._add(e);return i.div(t.length)}(i),this.touches=fa(r,i)))}touchmove(e,t,i){if(this.aborted||!this.centroid)return;const r=fa(i,t);for(const n in this.touches){const e=r[n];(!e||e.dist(this.touches[n])>30)&&(this.aborted=!0)}}touchend(e,t,i){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),0===i.length){const e=!this.aborted&&this.centroid;if(this.reset(),e)return e}}}class ga{constructor(e){this.singleTap=new ma(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(e,t,i){this.singleTap.touchstart(e,t,i)}touchmove(e,t,i){this.singleTap.touchmove(e,t,i)}touchend(e,t,i){const r=this.singleTap.touchend(e,t,i);if(r){const t=e.timeStamp-this.lastTime<500,i=!this.lastTap||this.lastTap.dist(r)<30;if(t&&i||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=r,this.count===this.numTaps)return this.reset(),r}}}class ya{constructor(){this._zoomIn=new ga({numTouches:1,numTaps:2}),this._zoomOut=new ga({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,t,i){this._zoomIn.touchstart(e,t,i),this._zoomOut.touchstart(e,t,i)}touchmove(e,t,i){this._zoomIn.touchmove(e,t,i),this._zoomOut.touchmove(e,t,i)}touchend(e,t,i){const r=this._zoomIn.touchend(e,t,i),n=this._zoomOut.touchend(e,t,i);return r?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:t.getZoom()+1,around:t.unproject(r)},{originalEvent:e})}):n?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:t.getZoom()-1,around:t.unproject(n)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const _a={0:1,2:2};class va{constructor(e){this.reset(),this._clickTolerance=e.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(e,t){return!1}_move(e,t){return{}}mousedown(e,t){if(this._lastPoint)return;const i=v(e);this._correctButton(e,i)&&(this._lastPoint=t,this._eventButton=i)}mousemoveWindow(e,t){const i=this._lastPoint;if(i)if(e.preventDefault(),null!=this._eventButton&&function(e,t){const i=_a[t];return void 0===e.buttons||(e.buttons&i)!==i}(e,this._eventButton))this.reset();else if(this._moved||!(t.dist(i)<this._clickTolerance))return this._moved=!0,this._lastPoint=t,this._move(i,t)}mouseupWindow(e){this._lastPoint&&v(e)===this._eventButton&&(this._moved&&g(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class xa extends va{mousedown(e,t){super.mousedown(e,t),this._lastPoint&&(this._active=!0)}_correctButton(e,t){return 0===t&&!e.ctrlKey}_move(e,t){return{around:t,panDelta:t.sub(e)}}}class ba extends va{_correctButton(e,t){return 0===t&&e.ctrlKey||2===t}_move(e,t){const i=.8*(t.x-e.x);if(i)return this._active=!0,{bearingDelta:i}}contextmenu(e){e.preventDefault()}}class wa extends va{_correctButton(e,t){return 0===t&&e.ctrlKey||2===t}_move(e,t){const i=-.5*(t.y-e.y);if(i)return this._active=!0,{pitchDelta:i}}contextmenu(e){e.preventDefault()}}class Sa{constructor(t,i){this._map=t,this._el=t.getCanvasContainer(),this._minTouches=1,this._clickTolerance=i.clickTolerance||1,this.reset(),e.aP(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new e.P(0,0)}touchstart(e,t,i){return this._calculateTransform(e,t,i)}touchmove(t,i,r){if(this._active&&!(r.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===r.length&&!e.dz())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return t.cancelable&&t.preventDefault(),this._calculateTransform(t,i,r)}}touchend(e,t,i){this._calculateTransform(e,t,i),this._active&&i.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,i,r){r.length>0&&(this._active=!0);const n=fa(r,i),o=new e.P(0,0),s=new e.P(0,0);let a=0;for(const e in n){const t=n[e],i=this._touches[e];i&&(o._add(t),s._add(t.sub(i)),a++,n[e]=t)}if(this._touches=n,a<this._minTouches||!s.mag())return;const l=s.div(a);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:o.div(a),panDelta:l}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=l("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")}),500)}}class Ta{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(e){}_move(e,t,i){return{}}touchstart(e,t,i){this._firstTwoTouches||i.length<2||(this._firstTwoTouches=[i[0].identifier,i[1].identifier],this._start([t[0],t[1]]))}touchmove(e,t,i){const r=this._firstTwoTouches;if(!r)return;e.preventDefault();const[n,o]=r,s=Ma(i,t,n),a=Ma(i,t,o);if(!s||!a)return;const l=this._aroundCenter?null:s.add(a).div(2);return this._move([s,a],l,e)}touchend(e,t,i){if(!this._firstTwoTouches)return;const[r,n]=this._firstTwoTouches,o=Ma(i,t,r),s=Ma(i,t,n);o&&s||(this._active&&g(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ma(e,t,i){for(let r=0;r<e.length;r++)if(e[r].identifier===i)return t[r]}function Aa(e,t){return Math.log(e/t)/Math.LN2}class Ca extends Ta{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,t){const i=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Aa(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Aa(this._distance,i),pinchAround:t}}}function Ea(e,t){return 180*e.angleWith(t)/Math.PI}class Pa extends Ta{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,t){const i=this._vector;if(this._vector=e[0].sub(e[1]),i&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Ea(this._vector,i),pinchAround:t}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const t=25/(Math.PI*this._minDiameter)*360,i=this._startVector;if(!i)return!1;const r=Ea(e,i);return Math.abs(r)<t}}function ka(e){return Math.abs(e.y)>Math.abs(e.x)}class Ia extends Ta{constructor(e){super(),this._map=e}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(e){this._lastPoints=e,ka(e[0].sub(e[1]))&&(this._valid=!1)}_move(t,i,r){const n=this._lastPoints;if(!n)return;const o=t[0].sub(n[0]),s=t[1].sub(n[1]);return this._map._cooperativeGestures&&!e.dz()&&r.touches.length<3||(this._valid=this.gestureBeginsVertically(o,s,r.timeStamp),!this._valid)?void 0:(this._lastPoints=t,this._active=!0,{pitchDelta:(o.y+s.y)/2*-.5})}gestureBeginsVertically(e,t,i){if(void 0!==this._valid)return this._valid;const r=e.mag()>=2,n=t.mag()>=2;if(!r&&!n)return;if(!r||!n)return null==this._firstMove&&(this._firstMove=i),i-this._firstMove<100&&void 0;const o=e.y>0==t.y>0;return ka(e)&&ka(t)&&o}}const Da={panStep:100,bearingStep:15,pitchStep:10};class La{constructor(){const e=Da;this._panStep=e.panStep,this._bearingStep=e.bearingStep,this._pitchStep=e.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let t=0,i=0,r=0,n=0,o=0;switch(e.keyCode){case 61:case 107:case 171:case 187:t=1;break;case 189:case 109:case 173:t=-1;break;case 37:e.shiftKey?i=-1:(e.preventDefault(),n=-1);break;case 39:e.shiftKey?i=1:(e.preventDefault(),n=1);break;case 38:e.shiftKey?r=1:(e.preventDefault(),o=-1);break;case 40:e.shiftKey?r=-1:(e.preventDefault(),o=1);break;default:return}return this._rotationDisabled&&(i=0,r=0),{cameraAnimation:s=>{const a=s.getZoom();s.easeTo({duration:300,easeId:"keyboardHandler",easing:Ra,zoom:t?Math.round(a)+t*(e.shiftKey?2:1):a,bearing:s.getBearing()+i*this._bearingStep,pitch:s.getPitch()+r*this._pitchStep,offset:[-n*this._panStep,-o*this._panStep],center:s.getCenter()},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ra(e){return e*(2-e)}const za=4.000244140625,Oa=1/450;class Fa{constructor(t,i){this._map=t,this._el=t.getCanvasContainer(),this._handler=i,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Oa,e.aP(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(t.ctrlKey||t.metaKey||this.isZooming()||e.dz()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let i=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const r=e.q.now(),n=r-(this._lastWheelEventTime||0);this._lastWheelEventTime=r,0!==i&&i%za==0?this._type="wheel":0!==i&&Math.abs(i)<4?this._type="trackpad":n>400?(this._type=null,this._lastValue=i,this._timeout=window.setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(n*i)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,i+=this._lastValue)),t.shiftKey&&i&&(i/=4),this._type&&(this._lastWheelEvent=t,this._delta-=i,this._active||this._start(t)),t.preventDefault()}_onTimeout(e){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(e)}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const t=y(this._el,e);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:t,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const t=this._map.transform;"wheel"===this._type&&t.projection.wrap&&(t._center.lng>=180||t._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const i=()=>t._terrainEnabled()&&this._aroundCoord?t.computeZoomRelativeTo(this._aroundCoord):t.zoom;if(0!==this._delta){const e="wheel"===this._type&&Math.abs(this._delta)>za?this._wheelZoomRate:this._defaultZoomRate;let r=2/(1+Math.exp(-Math.abs(this._delta*e)));this._delta<0&&0!==r&&(r=1/r);const n=i(),o=Math.pow(2,n),s="number"==typeof this._targetZoom?t.zoomScale(this._targetZoom):o;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(s*r))),"wheel"===this._type&&(this._startZoom=n,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const r="number"==typeof this._targetZoom?this._targetZoom:i(),n=this._startZoom,o=this._easing;let s,a=!1;if("wheel"===this._type&&n&&o){const t=Math.min((e.q.now()-this._lastWheelEventTime)/200,1),i=o(t);s=e.af(n,r,i),t<1?this._frameId||(this._frameId=!0):a=!0}else s=r,a=!0;this._active=!0,a&&(this._active=!1,this._finishTimeout=window.setTimeout((()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200));let l=s-i();return l*this._lastDelta<0&&(l=0),{noInertia:!0,needsRenderFrame:!a,zoomDelta:l,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let i=e.dA;if(this._prevEase){const t=this._prevEase,r=(e.q.now()-t.start)/t.duration,n=t.easing(r+.01)-t.easing(r),o=.27/Math.sqrt(n*n+1e-4)*.01,s=Math.sqrt(.0729-o*o);i=e.dy(o,s,.25,1)}return this._prevEase={start:e.q.now(),duration:t,easing:i},i}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=l("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")}),200)}}class Ba{constructor(e,t){this._clickZoom=e,this._tapZoom=t}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Na{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(e,t){return e.preventDefault(),{cameraAnimation:i=>{i.easeTo({duration:300,zoom:i.getZoom()+(e.shiftKey?-1:1),around:i.unproject(t)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ja{constructor(){this._tap=new ga({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(e,t,i){this._swipePoint||(this._tapTime&&e.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?i.length>0&&(this._swipePoint=t[0],this._swipeTouch=i[0].identifier):this._tap.touchstart(e,t,i))}touchmove(e,t,i){if(this._tapTime){if(this._swipePoint){if(i[0].identifier!==this._swipeTouch)return;const r=t[0],n=r.y-this._swipePoint.y;return this._swipePoint=r,e.preventDefault(),this._active=!0,{zoomDelta:n/128}}}else this._tap.touchmove(e,t,i)}touchend(e,t,i){this._tapTime?this._swipePoint&&0===i.length&&this.reset():this._tap.touchend(e,t,i)&&(this._tapTime=e.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Va{constructor(e,t,i){this._el=e,this._mousePan=t,this._touchPan=i}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ua{constructor(e,t,i){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=t,this._mousePitch=i}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Ga{constructor(e,t,i,r){this._el=e,this._touchZoom=t,this._touchRotate=i,this._tapDragZoom=r,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Ha=e=>e.zoom||e.drag||e.pitch||e.rotate;class Wa extends e.z{}class $a{constructor(){this.constants=[1,1,.01],this.radius=0}setup(t,i){const r=e.ab.vec3.sub([],i,t);this.radius=e.ab.vec3.length(r[2]<0?e.ab.vec3.div([],r,this.constants):[r[0],r[1],0])}projectRay(t){e.ab.vec3.div(t,t,this.constants),e.ab.vec3.normalize(t,t),e.ab.vec3.mul(t,t,this.constants);const i=e.ab.vec3.scale([],t,this.radius);if(i[2]>0){const t=e.ab.vec3.scale([],[0,0,1],e.ab.vec3.dot(i,[0,0,1])),r=e.ab.vec3.scale([],e.ab.vec3.normalize([],[i[0],i[1],0]),this.radius),n=e.ab.vec3.add([],i,e.ab.vec3.scale([],e.ab.vec3.sub([],e.ab.vec3.add([],r,t),i),2));i[0]=n[0],i[1]=n[1]}return i}}function qa(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta}class Xa{constructor(t,i){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new oa(t),this._bearingSnap=i.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new $a,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(i),e.aP(["handleEvent","handleWindowEvent"],this);const r=this._el;this._listeners=[[r,"touchstart",{passive:!0}],[r,"touchmove",{passive:!1}],[r,"touchend",void 0],[r,"touchcancel",void 0],[r,"mousedown",void 0],[r,"mousemove",void 0],[r,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[r,"mouseover",void 0],[r,"mouseout",void 0],[r,"dblclick",void 0],[r,"click",void 0],[r,"keydown",{capture:!1}],[r,"keyup",void 0],[r,"wheel",{passive:!1}],[r,"contextmenu",void 0],[window,"blur",void 0]];for(const[e,n,o]of this._listeners){const t=e===document?this.handleWindowEvent:this.handleEvent;e.addEventListener(n,t,o)}}destroy(){for(const[e,t,i]of this._listeners){const r=e===document?this.handleWindowEvent:this.handleEvent;e.removeEventListener(t,r,i)}}_addDefaultHandlers(e){const t=this._map,i=t.getCanvasContainer();this._add("mapEvent",new ha(t,e));const r=t.boxZoom=new pa(t,e);this._add("boxZoom",r);const n=new ya,o=new Na;t.doubleClickZoom=new Ba(o,n),this._add("tapZoom",n),this._add("clickZoom",o);const s=new ja;this._add("tapDragZoom",s);const a=t.touchPitch=new Ia(t);this._add("touchPitch",a);const l=new ba(e),c=new wa(e);t.dragRotate=new Ua(e,l,c),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",c,["mouseRotate"]);const u=new xa(e),h=new Sa(t,e);t.dragPan=new Va(i,u,h),this._add("mousePan",u),this._add("touchPan",h,["touchZoom","touchRotate"]);const d=new Pa,p=new Ca;t.touchZoomRotate=new Ga(i,p,d,s),this._add("touchRotate",d,["touchPan","touchZoom"]),this._add("touchZoom",p,["touchPan","touchRotate"]),this._add("blockableMapEvent",new da(t));const f=t.scrollZoom=new Fa(t,this);this._add("scrollZoom",f,["mousePan"]);const m=t.keyboard=new La;this._add("keyboard",m);for(const g of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])e.interactive&&e[g]&&t[g].enable(e[g])}_add(e,t,i){this._handlers.push({handlerName:e,handler:t,allowed:i}),this._handlersById[e]=t}stop(e){if(!this._updatingCamera){for(const{handler:e}of this._handlers)e.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ha(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(e,t,i){for(const r in e)if(r!==i&&(!t||t.indexOf(r)<0))return!0;return!1}handleWindowEvent(e){this.handleEvent(e,`${e.type}Window`)}_getMapTouches(e){const t=[];for(const i of e)this._el.contains(i.target)&&t.push(i);return t}handleEvent(e,t){this._updatingCamera=!0;const i="renderFrame"===e.type,r=i?void 0:e,n={needsRenderFrame:!1},o={},s={},a=e.touches?this._getMapTouches(e.touches):void 0,l=a?_(this._el,a):i?void 0:y(this._el,e);for(const{handlerName:h,handler:d,allowed:p}of this._handlers){if(!d.isEnabled())continue;let i;this._blockedByActive(s,p,h)?d.reset():d[t||e.type]&&(i=d[t||e.type](e,l,a),this.mergeHandlerResult(n,o,i,h,r),i&&i.needsRenderFrame&&this._triggerRenderFrame()),(i||d.isActive())&&(s[h]=d)}const c={};for(const h in this._previousActiveHandlers)s[h]||(c[h]=r);this._previousActiveHandlers=s,(Object.keys(c).length||qa(n))&&(this._changes.push([n,o,c]),this._triggerRenderFrame()),(Object.keys(s).length||qa(n))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:u}=n;u&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],u(this._map))}mergeHandlerResult(t,i,r,n,o){if(!r)return;e.l(t,r);const s={handlerName:n,originalEvent:r.originalEvent||o};void 0!==r.zoomDelta&&(i.zoom=s),void 0!==r.panDelta&&(i.drag=s),void 0!==r.pitchDelta&&(i.pitch=s),void 0!==r.bearingDelta&&(i.rotate=s)}_applyChanges(){const t={},i={},r={};for(const[n,o,s]of this._changes)n.panDelta&&(t.panDelta=(t.panDelta||new e.P(0,0))._add(n.panDelta)),n.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+n.zoomDelta),n.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+n.bearingDelta),n.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+n.pitchDelta),void 0!==n.around&&(t.around=n.around),void 0!==n.aroundCoord&&(t.aroundCoord=n.aroundCoord),void 0!==n.pinchAround&&(t.pinchAround=n.pinchAround),n.noInertia&&(t.noInertia=n.noInertia),e.l(i,o),e.l(r,s);this._updateMapTransform(t,i,r),this._changes=[]}_updateMapTransform(t,i,r){const n=this._map,o=n.transform,s=e=>[e.x,e.y,e.z];if((()=>{const e=this._eventsInProgress.drag;return e&&!this._handlersById[e.handlerName].isActive()})()&&!qa(t)){const e=o.zoom;o.cameraElevationReference="sea",null!=this._originalZoom&&o._orthographicProjectionAtLowPitch&&"globe"!==o.projection.name&&0===o.pitch?(o.cameraElevationReference="ground",o.zoom=this._originalZoom):(o.recenterOnTerrain(),o.cameraElevationReference="ground"),e!==o.zoom&&this._map._update(!0)}if(o._isCameraConstrained&&n._stop(!0),!qa(t))return void this._fireEvents(i,r,!0);let{panDelta:a,zoomDelta:l,bearingDelta:c,pitchDelta:u,around:h,aroundCoord:d,pinchAround:p}=t;o._isCameraConstrained&&(l>0&&(l=0),o._isCameraConstrained=!1),void 0!==p&&(h=p),(l||(e=>i[e]&&!this._eventsInProgress[e])("drag"))&&h&&(this._dragOrigin=s(o.pointCoordinate3D(h)),this._originalZoom=o.zoom,this._trackingEllipsoid.setup(o._camera.position,this._dragOrigin)),o.cameraElevationReference="sea",n._stop(!0),h=h||n.transform.centerPoint,c&&(o.bearing+=c),u&&(o.pitch+=u),o._updateCameraState();const f=[0,0,0];if(a)if("mercator"===o.projection.name){const e=this._trackingEllipsoid.projectRay(o.screenPointToMercatorRay(h).dir),t=this._trackingEllipsoid.projectRay(o.screenPointToMercatorRay(h.sub(a)).dir);f[0]=t[0]-e[0],f[1]=t[1]-e[1]}else{const t=o.pointCoordinate(h);if("globe"===o.projection.name){a=a.rotate(-o.angle);const i=o._pixelsPerMercatorPixel/o.worldSize;f[0]=-a.x*e.dB(e.aS(t.y))*i,f[1]=-a.y*e.dB(o.center.lat)*i}else{const e=o.pointCoordinate(h.sub(a));t&&e&&(f[0]=e.x-t.x,f[1]=e.y-t.y)}}const m=o.zoom,g=[0,0,0];if(l){const t=s(d||o.pointCoordinate3D(h)),i={dir:e.ab.vec3.normalize([],e.ab.vec3.sub([],t,o._camera.position))};if(i.dir[2]<0){const r=o.zoomDeltaToMovement(t,l);e.ab.vec3.scale(g,i.dir,r)}}const y=e.ab.vec3.add(f,f,g);o._translateCameraConstrained(y),l&&Math.abs(o.zoom-m)>1e-4&&o.recenterOnTerrain(),o.cameraElevationReference="ground",this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(i,r,!0)}_fireEvents(t,i,r){const n=Ha(this._eventsInProgress),o=Ha(t),s={};for(const e in t){const{originalEvent:i}=t[e];this._eventsInProgress[e]||(s[`${e}start`]=i),this._eventsInProgress[e]=t[e]}!n&&o&&this._fireEvent("movestart",o.originalEvent);for(const e in s)this._fireEvent(e,s[e]);o&&this._fireEvent("move",o.originalEvent);for(const e in t){const{originalEvent:i}=t[e];this._fireEvent(e,i)}const a={};let l;for(const e in this._eventsInProgress){const{handlerName:t,originalEvent:r}=this._eventsInProgress[e];this._handlersById[t].isActive()||(delete this._eventsInProgress[e],l=i[t]||r,a[`${e}end`]=l)}for(const e in a)this._fireEvent(e,a[e]);const c=Ha(this._eventsInProgress);if(r&&(n||o)&&!c){this._updatingCamera=!0;const t=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),i=e=>0!==e&&-this._bearingSnap<e&&e<this._bearingSnap;t?(i(t.bearing||this._map.getBearing())&&(t.bearing=0),this._map.easeTo(t,{originalEvent:l})):(this._map.fire(new e.z("moveend",{originalEvent:l})),i(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,i){this._map.fire(new e.z(t,i?{originalEvent:i}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((e=>{this._frameId=void 0,this.handleEvent(new Wa("renderFrame",{timeStamp:e})),this._applyChanges()}))}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const Ya="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Za extends e.E{constructor(t,i){super(),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=i.bearingSnap,this._respectPrefersReducedMotion=!1!==i.respectPrefersReducedMotion,e.aP(["_renderFrameCallback"],this)}getCenter(){return new e.bO(this.transform.center.lng,this.transform.center.lat)}setCenter(e,t){return this.jumpTo({center:e},t)}panBy(t,i,r){return t=e.P.convert(t).mult(-1),this.panTo(this.transform.center,e.l({offset:t},i),r)}panTo(t,i,r){return this.easeTo(e.l({center:t},i),r)}getZoom(){return this.transform.zoom}setZoom(e,t){return this.jumpTo({zoom:e},t),this}zoomTo(t,i,r){return this.easeTo(e.l({zoom:t},i),r)}zoomIn(e,t){return this.zoomTo(this.getZoom()+1,e,t),this}zoomOut(e,t){return this.zoomTo(this.getZoom()-1,e,t),this}getBearing(){return this.transform.bearing}setBearing(e,t){return this.jumpTo({bearing:e},t),this}getPadding(){return this.transform.padding}setPadding(e,t){return this.jumpTo({padding:e},t),this}rotateTo(t,i,r){return this.easeTo(e.l({bearing:t},i),r)}resetNorth(t,i){return this.rotateTo(0,e.l({duration:1e3},t),i),this}resetNorthPitch(t,i){return this.easeTo(e.l({bearing:0,pitch:0,duration:1e3},t),i),this}snapToNorth(e,t){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,t):this}getPitch(){return this.transform.pitch}setPitch(e,t){return this.jumpTo({pitch:e},t),this}cameraForBounds(t,i){t=e.az.convert(t);const r=i&&i.bearing||0,n=i&&i.pitch||0,o=t.getNorthWest(),s=t.getSouthEast();return this._cameraForBounds(this.transform,o,s,r,n,i)}_extendPadding(t){const i={top:0,right:0,bottom:0,left:0};return null==t?e.l({},i,this.transform.padding):"number"==typeof t?{top:t,bottom:t,right:t,left:t}:e.l({},i,t)}_extendCameraOptions(t){return(t=e.l({offset:[0,0],maxZoom:this.transform.maxZoom},t)).padding=this._extendPadding(t.padding),t}_minimumAABBFrustumDistance(e,t){const i=t.max[0]-t.min[0],r=t.max[1]-t.min[1];return i/r>e.aspect?i/(2*Math.tan(.5*e.fovX)*e.aspect):r/(2*Math.tan(.5*e.fovY)*e.aspect)}_cameraForBoundsOnGlobe(t,i,r,n,o,s){const a=t.clone(),l=this._extendCameraOptions(s);a.bearing=n,a.pitch=o;const c=e.bO.convert(i),u=e.bO.convert(r),h=.5*(c.lat+u.lat),d=.5*(c.lng+u.lng),p=e.dC(h,d),f=e.ab.vec3.normalize([],p),m=e.ab.vec3.normalize([],e.ab.vec3.cross([],f,[0,1,0])),g=e.ab.vec3.cross([],m,f),y=[m[0],m[1],m[2],0,g[0],g[1],g[2],0,f[0],f[1],f[2],0,0,0,0,1],_=[p,e.dC(c.lat,c.lng),e.dC(u.lat,c.lng),e.dC(u.lat,u.lng),e.dC(c.lat,u.lng),e.dC(h,c.lng),e.dC(h,u.lng),e.dC(c.lat,d),e.dC(u.lat,d)];let v=e.cd.fromPoints(_.map((t=>[e.ab.vec3.dot(m,t),e.ab.vec3.dot(g,t),e.ab.vec3.dot(f,t)])));const x=e.ab.vec3.transformMat4([],v.center,y);0===e.ab.vec3.squaredLength(x)&&e.ab.vec3.set(x,0,0,1),e.ab.vec3.normalize(x,x),e.ab.vec3.scale(x,x,e.ax),a.center=e.dD(x);const b=a.getWorldToCameraMatrix(),w=e.ab.mat4.invert(new Float64Array(16),b);v=e.cd.applyTransform(v,e.ab.mat4.multiply([],b,y));const S=this._extendAABB(v,a,l,n);if(!S)return void e.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");v=S,e.ab.vec3.transformMat4(x,x,b);const T=.5*(v.max[2]-v.min[2]),M=this._minimumAABBFrustumDistance(a,v),A=e.ab.vec3.scale([],[0,0,1],T),C=e.ab.vec3.add(A,x,A),E=M+(0===a.pitch?0:e.ab.vec3.distance(x,C)),P=a.globeCenterInViewSpace,k=e.ab.vec3.sub([],x,[P[0],P[1],P[2]]);e.ab.vec3.normalize(k,k),e.ab.vec3.scale(k,k,E);const I=e.ab.vec3.add([],x,k);e.ab.vec3.transformMat4(I,I,w);const D=e.ds/e.ax,L=e.ab.vec3.length(I),R=e.bH(Math.max(L*D-e.ds,Number.EPSILON),0),z=Math.min(a.zoomFromMercatorZAdjusted(R),l.maxZoom);return z>.5*(e.c6+e.bY)?(a.setProjection({name:"mercator"}),a.zoom=z,this._cameraForBounds(a,i,r,n,o,s)):{center:a.center,zoom:z,bearing:n,pitch:o}}_extendAABB(t,i,r,n){const o=.5*((r.padding.left||0)+(r.padding.right||0)),s=.5*((r.padding.top||0)+(r.padding.bottom||0)),a=s,l=o,c=o,u=s,h=i.width-(l+c),d=i.height-(a+u),p=e.ab.vec3.sub([],t.max,t.min),f=Math.min(h/p[0],d/p[1]),m=Math.min(i.scaleZoom(i.scale*f),r.maxZoom);if(isNaN(m))return null;const g=i.scale/i.zoomScale(m),y=new e.cd([t.min[0]-l*g,t.min[1]-u*g,t.min[2]],[t.max[0]+c*g,t.max[1]+a*g,t.max[2]]),_=("number"==typeof r.offset.x&&"number"==typeof r.offset.y?new e.P(r.offset.x,r.offset.y):e.P.convert(r.offset)).rotate(-e.ai(n));return y.center[0]-=_.x*g,y.center[1]+=_.y*g,y}queryTerrainElevation(t,i){const r=this.transform.elevation;return r?(i=e.l({},{exaggerated:!0},i),r.getAtPoint(e.aa.fromLngLat(t),null,i.exaggerated)):null}_cameraForBounds(t,i,r,n,o,s){if("globe"===t.projection.name)return this._cameraForBoundsOnGlobe(t,i,r,n,o,s);const a=t.clone(),l=this._extendCameraOptions(s);a.bearing=n,a.pitch=o;const c=e.bO.convert(i),u=e.bO.convert(r),h=new e.bO(c.lng,u.lat),d=new e.bO(u.lng,c.lat),p=a.project(c),f=a.project(u),m=this.queryTerrainElevation(c),g=this.queryTerrainElevation(u),y=this.queryTerrainElevation(h),_=this.queryTerrainElevation(d),v=[[p.x,p.y,Math.min(m||0,g||0,y||0,_||0)],[f.x,f.y,Math.max(m||0,g||0,y||0,_||0)]];let x=e.cd.fromPoints(v);const b=a.getWorldToCameraMatrix(),w=e.ab.mat4.invert(new Float64Array(16),b);x=e.cd.applyTransform(x,b);const S=this._extendAABB(x,a,l,n);if(!S)return void e.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");x=S;const T=.5*e.ab.vec3.sub([],x.max,x.min)[2],M=this._minimumAABBFrustumDistance(a,x),A=[0,0,1,0];e.ab.vec4.transformMat4(A,A,b),e.ab.vec4.normalize(A,A);const C=e.ab.vec3.scale([],A,M+T),E=e.ab.vec3.add([],x.center,C);e.ab.vec3.transformMat4(x.center,x.center,w),e.ab.vec3.transformMat4(E,E,w);const P=a.unproject(new e.P(x.center[0],x.center[1])),k=e.dE(a.projection,P),I=Math.pow(2,k),D=Math.min(a._zoomFromMercatorZ(E[2]*a.pixelsPerMeter*I/a.worldSize),l.maxZoom);return a.mercatorFromTransition&&D<.5*(e.c6+e.bY)?(a.setProjection({name:"globe"}),a.zoom=D,this._cameraForBounds(a,i,r,n,o,s)):{center:P,zoom:D,bearing:n,pitch:o}}fitBounds(e,t,i){const r=this.cameraForBounds(e,t);return this._fitInternal(r,t,i)}fitScreenCoordinates(t,i,r,n,o){const s=e.P.convert(t),a=e.P.convert(i),l=new e.P(Math.min(s.x,a.x),Math.min(s.y,a.y)),c=new e.P(Math.max(s.x,a.x),Math.max(s.y,a.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(s,a))return this;const u=this.transform.pointLocation3D(l),h=this.transform.pointLocation3D(c),d=this.transform.pointLocation3D(new e.P(l.x,c.y)),p=this.transform.pointLocation3D(new e.P(c.x,l.y)),f=[Math.min(u.lng,h.lng,d.lng,p.lng),Math.min(u.lat,h.lat,d.lat,p.lat)],m=[Math.max(u.lng,h.lng,d.lng,p.lng),Math.max(u.lat,h.lat,d.lat,p.lat)],g=n&&n.pitch?n.pitch:this.getPitch(),y=this._cameraForBounds(this.transform,f,m,r,g,n);return this._fitInternal(y,n,o)}_fitInternal(t,i,r){return t?(i=e.l(t,i)).linear?this.easeTo(i,r):this.flyTo(i,r):this}jumpTo(t,i){this.stop();const r=t.preloadOnly?this.transform.clone():this.transform;let n=!1,o=!1,s=!1;"zoom"in t&&r.zoom!==+t.zoom&&(n=!0,r.zoom=+t.zoom),void 0!==t.center&&(r.center=e.bO.convert(t.center)),"bearing"in t&&r.bearing!==+t.bearing&&(o=!0,r.bearing=+t.bearing),"pitch"in t&&r.pitch!==+t.pitch&&(s=!0,r.pitch=+t.pitch);const a="number"==typeof t.padding?this._extendPadding(t.padding):t.padding;if(null!=t.padding&&!r.isPaddingEqual(a))if(!1===t.retainPadding){const e=r.clone();e.padding=a,r.setLocationAtPoint(r.center,e.centerPoint)}else r.padding=a;return t.preloadOnly?(this._preloadTiles(r),this):(this.fire(new e.z("movestart",i)).fire(new e.z("move",i)),n&&this.fire(new e.z("zoomstart",i)).fire(new e.z("zoom",i)).fire(new e.z("zoomend",i)),o&&this.fire(new e.z("rotatestart",i)).fire(new e.z("rotate",i)).fire(new e.z("rotateend",i)),s&&this.fire(new e.z("pitchstart",i)).fire(new e.z("pitch",i)).fire(new e.z("pitchend",i)),this.fire(new e.z("moveend",i)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||e.w(Ya),this.transform.getFreeCameraOptions()}setFreeCameraOptions(t,i){const r=this.transform;if(!r.projection.supportsFreeCamera)return e.w(Ya),this;this.stop();const n=r.zoom,o=r.pitch,s=r.bearing;r.setFreeCameraOptions(t);const a=n!==r.zoom,l=o!==r.pitch,c=s!==r.bearing;return this.fire(new e.z("movestart",i)).fire(new e.z("move",i)),a&&this.fire(new e.z("zoomstart",i)).fire(new e.z("zoom",i)).fire(new e.z("zoomend",i)),c&&this.fire(new e.z("rotatestart",i)).fire(new e.z("rotate",i)).fire(new e.z("rotateend",i)),l&&this.fire(new e.z("pitchstart",i)).fire(new e.z("pitch",i)).fire(new e.z("pitchend",i)),this.fire(new e.z("moveend",i)),this}easeTo(t,i){this._stop(!1,t.easeId),(!1===(t=e.l({offset:[0,0],duration:500,easing:e.dA},t)).animate||this._prefersReducedMotion(t))&&(t.duration=0);const r=this.transform,n=this.getZoom(),o=this.getBearing(),s=this.getPitch(),a=this.getPadding(),l="zoom"in t?+t.zoom:n,c="bearing"in t?this._normalizeBearing(t.bearing,o):o,u="pitch"in t?+t.pitch:s,h=this._extendPadding(t.padding),d=e.P.convert(t.offset);let p,f,m;if("globe"===r.projection.name){const i=e.aa.fromLngLat(r.center),n=d.rotate(-r.angle);i.x+=n.x/r.worldSize,i.y+=n.y/r.worldSize;const o=i.toLngLat(),s=e.bO.convert(t.center||o);this._normalizeCenter(s),p=r.centerPoint.add(n),f=new e.P(i.x,i.y).mult(r.worldSize),m=new e.P(e.at(s.lng),e.aA(s.lat)).mult(r.worldSize).sub(f)}else{p=r.centerPoint.add(d);const i=r.pointLocation(p),n=e.bO.convert(t.center||i);this._normalizeCenter(n),f=r.project(i),m=r.project(n).sub(f)}const g=r.zoomScale(l-n);let y,_;t.around&&(y=e.bO.convert(t.around),_=r.locationPoint(y));const v=this._zooming||l!==n,x=this._rotating||o!==c,b=this._pitching||u!==s,w=!r.isPaddingEqual(h),S=!1===t.retainPadding?r.clone():r,T=r=>T=>{if(v&&(r.zoom=e.af(n,l,T)),x&&(r.bearing=e.af(o,c,T)),b&&(r.pitch=e.af(s,u,T)),w&&(S.interpolatePadding(a,h,T),p=S.centerPoint.add(d)),y)r.setLocationAtPoint(y,_);else{const e=r.zoomScale(r.zoom-n),t=l>n?Math.min(2,g):Math.max(.5,g),i=Math.pow(t,1-T),o=r.unproject(f.add(m.mult(T*i)).mult(e));r.setLocationAtPoint(r.renderWorldCopies?o.wrap():o,p)}return t.preloadOnly||this._fireMoveEvents(i),r};if(t.preloadOnly){const e=this._emulate(T,t.duration,r);return this._preloadTiles(e),this}const M={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=v,this._rotating=x,this._pitching=b,this._padding=w,this._easeId=t.easeId,this._prepareEase(i,t.noMoveStart,M),this._ease(T(r),(e=>{"sea"===r.cameraElevationReference&&r.recenterOnTerrain(),this._afterEase(i,e)}),t),this}_prepareEase(t,i){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&0===this.transform.pitch&&"globe"!==this.transform.projection.name&&(this.transform.cameraElevationReference="ground"),i||r.moving||this.fire(new e.z("movestart",t)),this._zooming&&!r.zooming&&this.fire(new e.z("zoomstart",t)),this._rotating&&!r.rotating&&this.fire(new e.z("rotatestart",t)),this._pitching&&!r.pitching&&this.fire(new e.z("pitchstart",t))}_fireMoveEvents(t){this.fire(new e.z("move",t)),this._zooming&&this.fire(new e.z("zoom",t)),this._rotating&&this.fire(new e.z("rotate",t)),this._pitching&&this.fire(new e.z("pitch",t))}_afterEase(t,i){if(this._easeId&&i&&this._easeId===i)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const r=this._zooming,n=this._rotating,o=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,r&&this.fire(new e.z("zoomend",t)),n&&this.fire(new e.z("rotateend",t)),o&&this.fire(new e.z("pitchend",t)),this.fire(new e.z("moveend",t))}flyTo(t,i){if(this._prefersReducedMotion(t)){const r=e.ay(t,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(r,i)}this.stop(),t=e.l({offset:[0,0],speed:1.2,curve:1.42,easing:e.dA},t);const r=this.transform,n=this.getZoom(),o=this.getBearing(),s=this.getPitch(),a=this.getPadding(),l="zoom"in t?e.aw(+t.zoom,r.minZoom,r.maxZoom):n,c="bearing"in t?this._normalizeBearing(t.bearing,o):o,u="pitch"in t?+t.pitch:s,h=this._extendPadding(t.padding),d=r.zoomScale(l-n),p=e.P.convert(t.offset);let f=r.centerPoint.add(p);const m=r.pointLocation(f),g=e.bO.convert(t.center||m);this._normalizeCenter(g);const y=r.project(m),_=r.project(g).sub(y);let v=t.curve;const x=Math.max(r.width,r.height),b=x/d,w=_.mag();if("minZoom"in t){const i=e.aw(Math.min(t.minZoom,n,l),r.minZoom,r.maxZoom),o=x/r.zoomScale(i-n);v=Math.sqrt(o/w*2)}const S=v*v;function T(e){const t=(b*b-x*x+(e?-1:1)*S*S*w*w)/(2*(e?b:x)*S*w);return Math.log(Math.sqrt(t*t+1)-t)}function M(e){return(Math.exp(e)-Math.exp(-e))/2}function A(e){return(Math.exp(e)+Math.exp(-e))/2}const C=T(0);let E=function(e){return A(C)/A(C+v*e)},P=function(e){return x*((A(C)*(M(t=C+v*e)/A(t))-M(C))/S)/w;var t},k=(T(1)-C)/v;if(Math.abs(w)<1e-6||!isFinite(k)){if(Math.abs(x-b)<1e-6)return this.easeTo(t,i);const e=b<x?-1:1;k=Math.abs(Math.log(b/x))/v,P=function(){return 0},E=function(t){return Math.exp(e*v*t)}}t.duration="duration"in t?+t.duration:1e3*k/("screenSpeed"in t?+t.screenSpeed/v:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0);const I=o!==c,D=u!==s,L=!r.isPaddingEqual(h),R=!1===t.retainPadding?r.clone():r,z=r=>d=>{const m=d*k,v=1/E(m);r.zoom=1===d?l:n+r.scaleZoom(v),I&&(r.bearing=e.af(o,c,d)),D&&(r.pitch=e.af(s,u,d)),L&&(R.interpolatePadding(a,h,d),f=R.centerPoint.add(p));const x=1===d?g:r.unproject(y.add(_.mult(P(m))).mult(v));return r.setLocationAtPoint(r.renderWorldCopies?x.wrap():x,f),r._updateCameraOnTerrain(),t.preloadOnly||this._fireMoveEvents(i),r};if(t.preloadOnly){const e=this._emulate(z,t.duration,r);return this._preloadTiles(e),this}return this._zooming=!0,this._rotating=I,this._pitching=D,this._padding=L,this._prepareEase(i,!1),this._ease(z(r),(()=>this._afterEase(i)),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(e){}_cancelRenderFrame(e){}_stop(e,t){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const e=this._onEaseEnd;this._onEaseEnd=void 0,e.call(this,t)}if(!e){const e=this.handlers;e&&e.stop(!1)}return this}_ease(t,i,r){!1===r.animate||0===r.duration?(t(1),i()):(this._easeStart=e.q.now(),this._easeOptions=r,this._onEaseFrame=t,this._onEaseEnd=i,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const t=Math.min((e.q.now()-this._easeStart)/this._easeOptions.duration,1),i=this._onEaseFrame;i&&i(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(t,i){t=e.bF(t,-180,180);const r=Math.abs(t-i);return Math.abs(t-360-i)<r&&(t-=360),Math.abs(t+360-i)<r&&(t+=360),t}_normalizeCenter(e){const t=this.transform;if(t.maxBounds)return;if("globe"!==t.projection.name&&!t.renderWorldCopies)return;const i=e.lng-t.center.lng;e.lng+=i>180?-360:i<-180?360:0}_prefersReducedMotion(t){return this._respectPrefersReducedMotion&&e.q.prefersReducedMotion&&!(t&&t.essential)}_emulate(e,t,i){const r=Math.ceil(15*t/1e3),n=[],o=e(i.clone());for(let s=0;s<=r;s++){const e=o(s/r);n.push(e.clone())}return n}_preloadTiles(e,t){}}class Ka{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=t,e.aP(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(e){const t=this.options&&this.options.compact,i=e._getUIString("AttributionControl.ToggleAttribution");this._map=e,this._container=l("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=l("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",i);const r=l("span","mapboxgl-ctrl-icon",this._compactButton);return r.setAttribute("aria-hidden","true"),r.setAttribute("title",i),this._innerContainer=l("div","mapboxgl-ctrl-attrib-inner",this._container),t&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===t&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));const i=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.e.ACCESS_TOKEN}];if(t){const r=i.reduce(((e,t,r)=>(t.value&&(e+=`${t.key}=${t.value}${r<i.length-1?"&":""}`),e)),"?");t.href=`${e.e.FEEDBACK_URL}/${r}#${Qs(this._map,!0)}`,t.rel="noopener nofollow"}}_updateData(e){!e||"metadata"!==e.sourceDataType&&"visibility"!==e.sourceDataType&&"style"!==e.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let e=[];if(this._map.style.stylesheet){const e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}const t=this._map.style._mergedSourceCaches;for(const r in t){const i=t[r];if(i.used){const t=i.getSource();t.attribution&&e.indexOf(t.attribution)<0&&e.push(t.attribution)}}e.sort(((e,t)=>e.length-t.length)),e=e.filter(((t,i)=>{for(let r=i+1;r<e.length;r++)if(e[r].indexOf(t)>=0)return!1;return!0})),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=[...this.options.customAttribution,...e]:e.unshift(this.options.customAttribution));const i=e.join(" | ");i!==this._attribHTML&&(this._attribHTML=i,e.length?(this._innerContainer.innerHTML=i,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Ja{constructor(){e.aP(["_updateLogo","_updateCompact"],this)}onAdd(e){this._map=e,this._container=l("div","mapboxgl-ctrl");const t=l("a","mapboxgl-ctrl-logo");return t.target="_blank",t.rel="noopener nofollow",t.href="https://www.mapbox.com/",t.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),t.setAttribute("rel","noopener nofollow"),this._container.appendChild(t),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(e){e&&"metadata"!==e.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const e=this._map.style._sourceCaches;if(0===Object.entries(e).length)return!0;for(const t in e){const i=e[t].getSource();if(i.hasOwnProperty("mapbox_logo")&&!i.mapbox_logo)return!1}return!0}_updateCompact(){const e=this._container.children;if(e.length){const t=e[0];this._map.getCanvasContainer().offsetWidth<250?t.classList.add("mapboxgl-compact"):t.classList.remove("mapboxgl-compact")}}}class Qa{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const t=++this._id;return this._queue.push({callback:e,id:t,cancelled:!1}),t}remove(e){const t=this._currentlyRunning,i=t?this._queue.concat(t):this._queue;for(const r of i)if(r.id===e)return void(r.cancelled=!0)}run(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const t=this._currentlyRunning=this._queue;this._queue=[];for(const i of t)if(!i.cancelled&&(i.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class el{constructor(e){this.jumpTo(e)}getValue(t){if(t<=this._startTime)return this._start;if(t>=this._endTime)return this._end;const i=e.cB((t-this._startTime)/(this._endTime-this._startTime));return this._start*(1-i)+this._end*i}isEasing(e){return e>=this._startTime&&e<=this._endTime}jumpTo(e){this._startTime=-1/0,this._endTime=-1/0,this._start=e,this._end=e}easeTo(e,t,i){this._start=this.getValue(t),this._end=e,this._startTime=t,this._endTime=t+i}}const tl={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class il extends e.z{constructor(e,t,i,r){const{point:n,lngLat:o,originalEvent:s,target:a}=e;super(e.type,{point:n,lngLat:o,originalEvent:s,target:a}),this.preventDefault=()=>{e.preventDefault()},this.id=t,this.interaction=i,this.feature=r}}class rl{constructor(e){this.map=e,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(t,i){if(this.typeById.has(t))throw new Error(`Interaction id "${t}" already exists.`);const r=i.filter;let n=i.type;r&&this.filters.set(t,e.aZ(r)),"mouseover"===n&&(n="mouseenter"),"mouseout"===n&&(n="mouseleave");const o=this.interactionsByType.get(n)||new Map;"mouseenter"===n||"mouseleave"===n?(0===this.delegatedInteractions.size&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(t,i)):0===o.size&&this.map.on(n,this.handleType),0===o.size&&this.interactionsByType.set(n,o),o.set(t,i),this.typeById.set(t,n)}get(e){const t=this.typeById.get(e);if(!t)return;const i=this.interactionsByType.get(t);return i?i.get(e):void 0}remove(e){const t=this.typeById.get(e);if(!t)return;this.typeById.delete(e),this.filters.delete(e);const i=this.interactionsByType.get(t);i&&(i.delete(e),"mouseenter"===t||"mouseleave"===t?(this.delegatedInteractions.delete(e),0===this.delegatedInteractions.size&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):0===i.size&&this.map.off(t,this.handleType))}queryTargets(e,t){const i=[];for(const[r,n]of t)n.target&&i.push({targetId:r,target:n.target,filter:this.filters.get(r)});return this.map.style.queryRenderedTargets(e,i,this.map.transform)}handleMove(e){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const t=this.queryTargets(e.point,Array.from(this.delegatedInteractions).reverse());t.length&&(e.type="mouseenter",this.handleType(e,t));const i=new Map;for(const[r,{feature:n}]of this.prevHoveredFeatures)this.hoveredFeatures.has(r)||i.set(n.id,n);i.size&&(e.type="mouseleave",this.handleType(e,Array.from(i.values())))}handleOut(e){const t=Array.from(this.hoveredFeatures.values()).map((e=>{let{feature:t}=e;return t}));t.length&&(e.type="mouseleave",this.handleType(e,t)),this.hoveredFeatures.clear()}handleType(t,i){const r=Array.from(this.interactionsByType.get(t.type)).reverse(),n=!!i;i=i||this.queryTargets(t.point,r);const o="mouseenter"===t.type;let s=!1;const a=new Set;for(const l of i){for(const[i,c]of r){if(!c.target)continue;const r=l.variants?l.variants[i]:null;if(r){for(const u of r){if(at(u,l,a,i))continue;const r=new e.cw(l,u),h=st(u,l,i);n&&(r.state=this.map.getFeatureState(r));const d=o?this.prevHoveredFeatures.get(h):null,p=new il(t,i,c,r),f=d?d.stop:c.handler(p);if(o&&this.hoveredFeatures.set(h,{feature:l,stop:f}),!1!==f){s=!0;break}}if(s)break}}if(s)break}if(!s)for(const[e,l]of r){const{handler:i,target:r}=l;if(!r&&!1!==i(new il(t,e,l,null)))break}}}function nl(t,i){if(Array.isArray(t)&&Array.isArray(i)){const e=new Set(t),r=new Set(i);return e.size===r.size&&t.every((e=>r.has(e)))}return e.bn(t,i)}const ol={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},sl={showCompass:!0,showZoom:!0,visualizePitch:!1};class al{constructor(t,i){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._clickTolerance=10,this.element=i,this.mouseRotate=new ba({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,r&&(this.mousePitch=new wa({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),e.aP(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),i.addEventListener("mousedown",this.mousedown),i.addEventListener("touchstart",this.touchstart,{passive:!1}),i.addEventListener("touchmove",this.touchmove),i.addEventListener("touchend",this.touchend),i.addEventListener("touchcancel",this.reset)}down(e,t){this.mouseRotate.mousedown(e,t),this.mousePitch&&this.mousePitch.mousedown(e,t),p()}move(e,t){const i=this.map,r=this.mouseRotate.mousemoveWindow(e,t),n=r&&r.bearingDelta;if(n&&i.setBearing(i.getBearing()+n),this.mousePitch){const r=this.mousePitch.mousemoveWindow(e,t),n=r&&r.pitchDelta;n&&i.setPitch(i.getPitch()+n)}}off(){const e=this.element;e.removeEventListener("mousedown",this.mousedown),e.removeEventListener("touchstart",this.touchstart,{passive:!1}),e.removeEventListener("touchmove",this.touchmove),e.removeEventListener("touchend",this.touchend),e.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){f(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(t){this.down(e.l({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),y(this.element,t)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(e){this.move(e,y(this.element,e))}mouseup(e){this.mouseRotate.mouseupWindow(e),this.mousePitch&&this.mousePitch.mouseupWindow(e),this.offTemp()}touchstart(e){1!==e.targetTouches.length?this.reset():(this._startPos=this._lastPos=_(this.element,e.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>e.preventDefault()},this._startPos))}touchmove(e){1!==e.targetTouches.length?this.reset():(this._lastPos=_(this.element,e.targetTouches)[0],this.move({preventDefault:()=>e.preventDefault()},this._lastPos))}touchend(e){0===e.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function ll(t,i,r){if(t=new e.bO(t.lng,t.lat),i){const n=new e.bO(t.lng-360,t.lat),o=new e.bO(t.lng+360,t.lat),s=360*Math.ceil(Math.abs(t.lng-r.center.lng)/360),a=r.locationPoint(t).distSqr(i),l=i.x<0||i.y<0||i.x>r.width||i.y>r.height;r.locationPoint(n).distSqr(i)<a&&(l||Math.abs(n.lng-r.center.lng)<s)?t=n:r.locationPoint(o).distSqr(i)<a&&(l||Math.abs(o.lng-r.center.lng)<s)&&(t=o)}for(;Math.abs(t.lng-r.center.lng)>180;){const e=r.locationPoint(t);if(e.x>=0&&e.y>=0&&e.x<=r.width&&e.y<=r.height)break;t.lng>r.center.lng?t.lng-=360:t.lng+=360}return t}const cl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class ul extends e.E{constructor(t,i){if(super(),(t instanceof HTMLElement||i)&&(t=e.l({element:t},i)),e.aP(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=t&&t.occludedOpacity||.2,t&&t.element)this._element=t.element,this._offset=e.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=l("div");const i=41,r=27,n=c("svg",{display:"block",height:i*this._scale+"px",width:r*this._scale+"px",viewBox:`0 0 ${r} ${i}`},this._element),o=c("radialGradient",{id:"shadowGradient"},c("defs",{},n));c("stop",{offset:"10%","stop-opacity":.4},o),c("stop",{offset:"100%","stop-opacity":.05},o),c("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},n),c("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},n),c("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},n),c("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},n),this._offset=e.P.convert(t&&t.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(e=>{e.preventDefault()})),this._element.addEventListener("mousedown",(e=>{e.preventDefault()}));const r=this._element.classList;for(const e in cl)r.remove(`mapboxgl-marker-anchor-${e}`);r.add(`mapboxgl-marker-anchor-${this._anchor}`);const n=t&&t.className?t.className.trim().split(/\s+/):[];r.add(...n),this._popup=null}addTo(e){return e===this._map||(this.remove(),this._map=e,e.getCanvasContainer().appendChild(this._element),e.on("move",this._updateMoving),e.on("moveend",this._update),e.on("remove",this._clearFadeTimer),e._addMarker(this),this.setDraggable(this._draggable),this._update(),e.on("click",this._onMapClick)),this}remove(){const e=this._map;return e&&(e.off("click",this._onMapClick),e.off("move",this._updateMoving),e.off("moveend",this._update),e.off("mousedown",this._addDragHandler),e.off("touchstart",this._addDragHandler),e.off("mouseup",this._onUp),e.off("touchend",this._onUp),e.off("mousemove",this._onMove),e.off("touchmove",this._onMove),e.off("remove",this._clearFadeTimer),e._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=e.bO.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const t=38.1,i=13.5,r=Math.sqrt(Math.pow(i,2)/2);e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-t],"bottom-left":[r,-1*(t-i+r)],"bottom-right":[-r,-1*(t-i+r)],left:[i,-1*(t-i)],right:[-i,-1*(t-i)]}:this._offset}this._popup=e,e._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(e){const t=e.code,i=e.charCode||e.keyCode;"Space"!==t&&"Enter"!==t&&32!==i&&13!==i||this.togglePopup()}_onMapClick(e){const t=e.originalEvent.target,i=this._element;this._popup&&(t===i||i.contains(t))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const e=this._popup;return e?(e.isOpen()?(e.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(e.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const e=this._map,t=this._pos;if(!e||!t)return!1;const i=e.unproject(t),r=e.getFreeCameraOptions();if(!r.position)return!1;const n=r.position.toLngLat();return n.distanceTo(i)<.9*n.distanceTo(this._lngLat)}_evaluateOpacity(){const t=this._map;if(!t)return;const i=this._pos;if(!i||i.x<0||i.x>t.transform.width||i.y<0||i.y>t.transform.height)return void this._clearFadeTimer();const r=t.unproject(i);let n;t._showingGlobe()&&e.dH(t.transform,this._lngLat)?n=0:(n=1-t._queryFogOpacity(r),t.transform._terrainEnabled()&&t.getTerrain()&&this._behindTerrain()&&(n*=this._occludedOpacity)),this._element.style.opacity=`${n}`,this._element.style.pointerEvents=n>0?"auto":"none",this._popup&&this._popup._setOpacity(n),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const e=this._pos;if(!e||!this._map)return;const t=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${e.x}px,${e.y}px)\n            ${cl[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${t.x}px,${t.y}px)\n        `}_calculateXYTransform(){const t=this._pos,i=this._map,r=this.getPitchAlignment();if(!i||!t||"map"!==r)return"";if(!i._showingGlobe()){const e=i.getPitch();return e?`rotateX(${e}deg)`:""}const n=e.c4(e.dI(i.transform,this._lngLat)),o=t.sub(e.dJ(i.transform)),s=Math.abs(o.x)+Math.abs(o.y);if(0===s)return"";const a=n/s;return`rotateX(${-o.y*a}deg) rotateY(${o.x*a}deg)`}_calculateZTransform(){const t=this._pos,i=this._map;if(!i||!t)return"";let r=0;const n=this.getRotationAlignment();if("map"===n)if(i._showingGlobe()){const t=i.project(new e.bO(this._lngLat.lng,this._lngLat.lat+.001)),n=i.project(new e.bO(this._lngLat.lng,this._lngLat.lat-.001)).sub(t);r=e.c4(Math.atan2(n.y,n.x))-90}else r=-i.getBearing();else if("horizon"===n){const n=e.ac(4,6,i.getZoom()),o=e.dJ(i.transform);o.y+=n*i.transform.height;const s=t.sub(o),a=e.c4(Math.atan2(s.y,s.x));r=(a>90?a-270:a+90)*(1-n)}return r+=this._rotation,r?`rotateZ(${r}deg)`:""}_update(e){cancelAnimationFrame(this._updateFrameId);const t=this._map;t&&(t.transform.renderWorldCopies&&(this._lngLat=ll(this._lngLat,this._pos,t.transform)),this._pos=t.project(this._lngLat),!0===e?this._updateFrameId=requestAnimationFrame((()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())})):this._pos=this._pos.round(),t._requestDomTask((()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(t._showingGlobe()||t.getTerrain()||t.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))})))}getOffset(){return this._offset}setOffset(t){return this._offset=e.P.convert(t),this._update(),this}addClassName(e){return this._element.classList.add(e),this}removeClassName(e){return this._element.classList.remove(e),this}toggleClassName(e){return this._element.classList.toggle(e)}_onMove(t){const i=this._map;if(!i)return;const r=this._pointerdownPos,n=this._positionDelta;if(r&&n){if(!this._isDragging){const e=this._clickTolerance||i._clickTolerance;if(t.point.dist(r)<e)return;this._isDragging=!0}this._pos=t.point.sub(n),this._lngLat=i.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new e.z("dragstart"))),this.fire(new e.z("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const t=this._map;t&&(t.off("mousemove",this._onMove),t.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new e.z("dragend")),this._state="inactive"}_addDragHandler(e){const t=this._map,i=this._pos;t&&i&&this._element.contains(e.originalEvent.target)&&(e.preventDefault(),this._positionDelta=e.point.sub(i),this._pointerdownPos=e.point,this._state="pending",t.on("mousemove",this._onMove),t.on("touchmove",this._onMove),t.once("mouseup",this._onUp),t.once("touchend",this._onUp))}setDraggable(e){this._draggable=!!e;const t=this._map;return t&&(e?(t.on("mousedown",this._addDragHandler),t.on("touchstart",this._addDragHandler)):(t.off("mousedown",this._addDragHandler),t.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(e){return this._occludedOpacity=e||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const hl={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},dl={maxWidth:100,unit:"metric"},pl={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},fl={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},ml=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function gl(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new e.P(0,0),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bottom";if("number"==typeof t){const r=Math.round(Math.sqrt(.5*Math.pow(t,2)));switch(i){case"top":return new e.P(0,t);case"top-left":return new e.P(r,r);case"top-right":return new e.P(-r,r);case"bottom":return new e.P(0,-t);case"bottom-left":return new e.P(r,-r);case"bottom-right":return new e.P(-r,-r);case"left":return new e.P(t,0);case"right":return new e.P(-t,0)}return new e.P(0,0)}return t instanceof e.P||Array.isArray(t)?e.P.convert(t):e.P.convert(t[i]||[0,0])}const yl={version:t,supported:a.supported,setRTLTextPlugin:e.dK,getRTLTextPluginStatus:e.dL,Map:class extends Za{constructor(t){r.mark(i.create);const n=t;if(null!=(t=e.l({},ol,t)).minZoom&&null!=t.maxZoom&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=t.minPitch&&null!=t.maxPitch&&t.minPitch>t.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=t.minPitch&&t.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=t.maxPitch&&t.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(t.antialias&&e.dF(window)&&(t.antialias=!1,e.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Qi(t.minZoom,t.maxZoom,t.minPitch,t.maxPitch,t.renderWorldCopies),t),this._repaint=!!t.repaint,this._interactive=t.interactive,this._minTileCacheSize=t.minTileCacheSize,this._maxTileCacheSize=t.maxTileCacheSize,this._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=t.preserveDrawingBuffer,this._antialias=t.antialias,this._trackResize=t.trackResize,this._bearingSnap=t.bearingSnap,this._refreshExpiredTiles=t.refreshExpiredTiles,this._fadeDuration=t.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=t.crossSourceCollisions,this._collectResourceTiming=t.collectResourceTiming,this._language=this._parseLanguage(t.language),this._worldview=t.worldview,this._renderTaskQueue=new Qa,this._domRenderTaskQueue=new Qa,this._controls=[],this._markers=[],this._popups=[],this._mapId=e.aV(),this._locale=e.l({},tl,t.locale),this._clickTolerance=t.clickTolerance,this._cooperativeGestures=t.cooperativeGestures,this._performanceMetricsCollection=t.performanceMetricsCollection,this._tessellationStep=t.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=t.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new el(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=t.scaleFactor,this._requestManager=new S(t.transformRequest,t.accessToken,t.testMode),this._silenceAuthErrors=!!t.testMode,this._contextCreateOptions=t.contextCreateOptions?Object.assign({},t.contextCreateOptions):{},"string"==typeof t.container){const e=document.getElementById(t.container);if(!e)throw new Error(`Container '${t.container.toString()}' not found.`);this._container=e}else{if(!(t.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=t.container}if(this._container.childNodes.length>0&&e.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),t.maxBounds&&this.setMaxBounds(t.maxBounds),this._spriteFormat=t.spriteFormat,e.aP(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new Os),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},(()=>{this._update()})),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},(()=>{this.setScaleFactor(this._scaleFactor)})),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");if(this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new Xa(this,t),this._localFontFamily=t.localFontFamily,this._localIdeographFontFamily=t.localIdeographFontFamily,(t.style||!t.testMode)&&this.setStyle(t.style||e.e.DEFAULT_STYLE,{config:t.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),t.projection&&this.setProjection(t.projection),this.indoor=new pr(this),t.hash&&(this._hash=new Js("string"==typeof t.hash&&t.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){null==n.center&&null==n.zoom||(this.transform._unmodified=!1),this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch});const i=t.bounds;i&&(this.resize(),this.fitBounds(i,e.l({},t.fitBoundsOptions,{duration:0})))}this.resize(),t.attributionControl&&this.addControl(new Ka({customAttribution:t.customAttribution})),this._logoControl=new Ja,this.addControl(this._logoControl,t.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()})),this.on("data",(t=>{this._update("style"===t.dataType),this.fire(new e.z(`${t.dataType}data`,t))})),this.on("dataloading",(t=>{this.fire(new e.z(`${t.dataType}dataloading`,t))})),this._interactions=new rl(this)}_getMapId(){return this._mapId}addControl(t,i){if(void 0===i&&(i=t.getDefaultPosition?t.getDefaultPosition():"top-right"),!t||!t.onAdd)return this.fire(new e.y(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const r=t.onAdd(this);this._controls.push(t);const n=this._controlPositions[i];return-1!==i.indexOf("bottom")?n.insertBefore(r,n.firstChild):n.appendChild(r),this}removeControl(t){if(!t||!t.onRemove)return this.fire(new e.y(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(t);return i>-1&&this._controls.splice(i,1),t.onRemove(this),this}hasControl(e){return this._controls.indexOf(e)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(t){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const i=!this._moving;return i&&this.fire(new e.z("movestart",t)).fire(new e.z("move",t)),this.fire(new e.z("resize",t)),i&&this.fire(new e.z("moveend",t)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(t){return this.transform.setMaxBounds(e.az.convert(t)),this._update()}setMinZoom(t){if((t=t??-2)>=-2&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t?this.setZoom(t):this.fire(new e.z("zoomstart")).fire(new e.z("zoom")).fire(new e.z("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(t){if((t=t??22)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t?this.setZoom(t):this.fire(new e.z("zoomstart")).fire(new e.z("zoom")).fire(new e.z("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(t){if((t=t??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(t>=0&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this._update(),this.getPitch()<t?this.setPitch(t):this.fire(new e.z("pitchstart")).fire(new e.z("pitch")).fire(new e.z("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(t){if((t=t??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this._update(),this.getPitch()>t?this.setPitch(t):this.fire(new e.z("pitchstart")).fire(new e.z("pitch")).fire(new e.z("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(e){return this._scaleFactor=e,this.painter.scaleFactor=e,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers((e=>"symbol"===e.type)),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(e){return this.transform.renderWorldCopies=e,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(e){return"auto"===e?navigator.language:Array.isArray(e)?0===e.length?void 0:e.map((e=>"auto"===e?navigator.language:e)):e}setLanguage(e){const t=this._parseLanguage(e);if(!this.style||t===this._language)return this;this._language=t,this.style.reloadSources();for(const i of this._controls)i._setLanguage&&i._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(e){return this.style&&e!==this._worldview?(this._worldview=e,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(e){return this._lazyInitEmptyStyle(),e?"string"==typeof e&&(e={name:e}):e=null,this._useExplicitProjection=!!e,this._prioritizeAndUpdateProjection(e,this.style.projection)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const t=this.transform,i=t.projection.name;let r;"globe"===i&&t.zoom>=e.bY?(t.setMercatorFromTransition(),r=!0):"mercator"===i&&t.zoom<e.bY&&(t.setProjection({name:"globe"}),r=!0),r&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(e,t){return this._updateProjection(e||t||{name:"mercator"})}_updateProjection(t){let i;return i="globe"===t.name&&this.transform.zoom>=e.bY?this.transform.setMercatorFromTransition():this.transform.setProjection(t),this.style.applyProjectionUpdate(),i&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(t){return this.transform.locationPoint3D(e.bO.convert(t))}unproject(t){return this.transform.pointLocation3D(e.P.convert(t))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(e,t,i){const r=e=>{let i=[];if(Array.isArray(t)){const r=t.filter((e=>this.getLayer(e)));i=r.length?this.queryRenderedFeatures(e,{layers:r}):[]}else i=this.queryRenderedFeatures(e,{target:t});return i};if("mouseenter"===e||"mouseover"===e){let n=!1;const o=t=>{const o=r(t.point);o.length?n||(n=!0,i.call(this,new la(e,this,t.originalEvent,{features:o}))):n=!1};return{listener:i,targets:t,delegates:{mousemove:o,mouseout:()=>{n=!1}}}}if("mouseleave"===e||"mouseout"===e){let n=!1;const o=t=>{r(t.point).length?n=!0:n&&(n=!1,i.call(this,new la(e,this,t.originalEvent)))},s=t=>{n&&(n=!1,i.call(this,new la(e,this,t.originalEvent)))};return{listener:i,targets:t,delegates:{mousemove:o,mouseout:s}}}{const n=e=>{const t=r(e.point);t.length&&(e.features=t,i.call(this,e),delete e.features)};return{listener:i,targets:t,delegates:{[e]:n}}}}on(e,t,i){if("function"==typeof t||void 0===i)return super.on(e,t);if("string"==typeof t&&(t=[t]),!this._areTargetsValid(t))return this;const r=this._createDelegatedListener(e,t,i);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(r);for(const n in r.delegates)this.on(n,r.delegates[n]);return this}once(e,t,i){if("function"==typeof t||void 0===i)return super.once(e,t);if("string"==typeof t&&(t=[t]),!this._areTargetsValid(t))return this;const r=this._createDelegatedListener(e,t,i);for(const n in r.delegates)this.once(n,r.delegates[n]);return this}off(e,t,i){if("function"==typeof t||void 0===i)return super.off(e,t);if("string"==typeof t&&(t=[t]),!this._areTargetsValid(t))return this;const r=this._delegatedListeners?this._delegatedListeners[e]:void 0;return r&&(e=>{for(let r=0;r<e.length;r++){const n=e[r];if(n.listener===i&&nl(n.targets,t)){for(const e in n.delegates)this.off(e,n.delegates[e]);return e.splice(r,1),this}}})(r),this}queryRenderedFeatures(t,i){if(!this.style)return[];if(void 0===t||t instanceof e.P||Array.isArray(t)||void 0!==i||(i=t,t=void 0),t=t||[[0,0],[this.transform.width,this.transform.height]],!i){const e=this.style.queryRenderedFeatures(t,void 0,this.transform),i=this.style.queryRenderedFeatureset(t,void 0,this.transform);return e.concat(i)}let r=!0;if(i.target&&(r=this._isTargetValid(i.target),r&&!i.layers))return this.style.queryRenderedFeatureset(t,i,this.transform);let n=!0;if(i.layers&&Array.isArray(i.layers)){for(const e of i.layers)if(!this._isValidId(e)){n=!1;break}if(n&&!i.target)return this.style.queryRenderedFeatures(t,i,this.transform)}let o=[];return n&&(o=o.concat(this.style.queryRenderedFeatures(t,i,this.transform))),r&&(o=o.concat(this.style.queryRenderedFeatureset(t,i,this.transform))),o}querySourceFeatures(e,t){return!e||"string"==typeof e&&!this._isValidId(e)?[]:this.style.querySourceFeatures(e,t)}isPointOnSurface(t){const{name:i}=this.transform.projection;return"globe"!==i&&"mercator"!==i&&e.w(`${i} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(e.P.convert(t))}addInteraction(e,t){return this._interactions.add(e,t),this}removeInteraction(e){return this._interactions.remove(e),this}setStyle(t,i){return i=e.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},i),this.style&&t&&!1!==i.diff&&i.localFontFamily===this._localFontFamily&&i.localIdeographFontFamily===this._localIdeographFontFamily&&!i.config?(this.style._diffStyle(t,((r,n)=>{r?(e.w(`Unable to perform style diff: ${String(r.message||r.error||r)}. Rebuilding the style from scratch.`),this._updateStyle(t,i)):n&&this._update(!0)}),(()=>{this._postStyleLoadEvent()})),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._localFontFamily=i.localFontFamily,this._updateStyle(t,i))}_getUIString(e){const t=this._locale[e];if(null==t)throw new Error(`Missing UI string '${e}'`);return t}_updateStyle(t,i){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),t){const r=e.l({},i);i&&i.config&&(r.initialConfig=i.config,delete r.config),this.style=new wr(this,r).load(t),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new wr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(e.w("There is no style added to the map."),!1)}_isValidId(t){return null==t?(this.fire(new e.y(new Error("IDs can't be empty."))),!1):!e.cr(t)||(this.fire(new e.y(new Error(`IDs can't contain special symbols: "${t}".`))),!1)}_isTargetValid(e){return"featuresetId"in e?this._isValidId("importId"in e?e.importId:e.featuresetId):"layerId"in e&&this._isValidId(e.layerId)}_areTargetsValid(e){if(Array.isArray(e)){for(const t of e)if(!this._isValidId(t))return!1;return!0}return this._isTargetValid(e)}addSource(e,t){return this._isValidId(e)?(this._lazyInitEmptyStyle(),this.style.addSource(e,t),this._update(!0)):this}isSourceLoaded(e){return!!this._isValidId(e)&&!!this.style&&this.style._isSourceCacheLoaded(e)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(e,t,i){this._lazyInitEmptyStyle(),this.style.addSourceType(e,t,i)}removeSource(e){return this._isValidId(e)?(this.style.removeSource(e),this._updateTerrain(),this._update(!0)):this}getSource(e){return this._isValidId(e)?this.style.getOwnSource(e):null}addImage(t,i){let{pixelRatio:r=1,sdf:n=!1,stretchX:o,stretchY:s,content:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._lazyInitEmptyStyle(),i instanceof HTMLImageElement||ImageBitmap&&i instanceof ImageBitmap){const{width:l,height:c,data:u}=e.q.getImageData(i);this.style.addImage(t,{data:new e.r({width:l,height:c},u),pixelRatio:r,stretchX:o,stretchY:s,content:a,sdf:n,version:0,usvg:!1})}else if(void 0===i.width||void 0===i.height)this.fire(new e.y(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:l,height:c}=i,u=i;this.style.addImage(t,{data:new e.r({width:l,height:c},new Uint8Array(u.data)),pixelRatio:r,stretchX:o,stretchY:s,content:a,sdf:n,usvg:!1,version:0,userImage:u}),u.onAdd&&u.onAdd(this,t)}}updateImage(t,i){this._lazyInitEmptyStyle();const r=this.style.getImage(t);if(!r)return void this.fire(new e.y(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const n=i instanceof HTMLImageElement||ImageBitmap&&i instanceof ImageBitmap?e.q.getImageData(i):i,{width:o,height:s,data:a}=n;if(void 0===o||void 0===s)return void this.fire(new e.y(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(o!==(r.usvg?r.icon.usvg_tree.width:r.data.width)||s!==(r.usvg?r.icon.usvg_tree.height:r.data.height))return void this.fire(new e.y(new Error(`The width and height of the updated image (${o}, ${s})\n                must be that same as the previous version of the image\n                (${r.data.width}, ${r.data.height})`)));const l=!(i instanceof HTMLImageElement||ImageBitmap&&i instanceof ImageBitmap);let c=!1;r.usvg?(r.data=new e.r({width:o,height:s},new Uint8Array(a)),r.usvg=!1,r.icon=void 0,c=!0):r.data.replace(a,l),this.style.updateImage(t,r,c)}hasImage(t){return t?!!this.style&&!!this.style.getImage(t):(this.fire(new e.y(new Error("Missing required image id"))),!1)}removeImage(e){this.style.removeImage(e)}loadImage(t,i){e.o(this._requestManager.transformRequest(t,e.R.Image),((t,r)=>{i(t,r instanceof HTMLImageElement?e.q.getImageData(r):r)}))}listImages(){return this.style.listImages()}addModel(e,t){this._lazyInitEmptyStyle(),this.style.addModel(e,t)}hasModel(t){return t?this.style.hasModel(t):(this.fire(new e.y(new Error("Missing required model id"))),!1)}removeModel(e){this.style.removeModel(e)}listModels(){return this.style.listModels()}addLayer(e,t){return this._isValidId(e.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(e,t),this._update(!0)):this}getSlot(e){const t=this.getLayer(e);return t&&t.slot||null}setSlot(e,t){return this.style.setSlot(e,t),this.style.mergeLayers(),this._update(!0)}addImport(e,t){return this.style.addImport(e,t),this}updateImport(e,t){return"string"!=typeof t&&t.id!==e?(this.removeImport(e),this.addImport(t)):(this.style.updateImport(e,t),this._update(!0))}removeImport(e){return this.style.removeImport(e),this}moveImport(e,t){return this.style.moveImport(e,t),this._update(!0)}moveLayer(e,t){return this._isValidId(e)?(this.style.moveLayer(e,t),this._update(!0)):this}removeLayer(e){return this._isValidId(e)?(this.style.removeLayer(e),this._update(!0)):this}getLayer(e){if(!this._isValidId(e))return null;const t=this.style.getOwnLayer(e);return t?"custom"===t.type?t.implementation:t.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(e,t,i){return this._isValidId(e)?(this.style.setLayerZoomRange(e,t,i),this._update(!0)):this}setFilter(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._isValidId(e)?(this.style.setFilter(e,t,i),this._update(!0)):this}getFilter(e){return this._isValidId(e)?this.style.getFilter(e):null}setPaintProperty(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this._isValidId(e)?(this.style.setPaintProperty(e,t,i,r),this._update(!0)):this}getPaintProperty(e,t){return this._isValidId(e)?this.style.getPaintProperty(e,t):null}setLayoutProperty(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this._isValidId(e)?(this.style.setLayoutProperty(e,t,i,r),this._update(!0)):this}getLayoutProperty(e,t){return this._isValidId(e)?this.style.getLayoutProperty(e,t):null}getSchema(e){return this.style.getSchema(e)}setSchema(e,t){return this.style.setSchema(e,t),this._update(!0)}getConfig(e){return this.style.getConfig(e)}setConfig(e,t){return this.style.setConfig(e,t),this._update(!0)}getConfigProperty(e,t){return this.style.getConfigProperty(e,t)}setConfigProperty(e,t,i){return this.style.setConfigProperty(e,t,i),this._update(!0)}getFeaturesetDescriptors(e){return this.style.getFeaturesetDescriptors(e)}setLights(e){if(this._lazyInitEmptyStyle(),e&&1===e.length&&"flat"===e[0].type){const t=e[0];t.properties?this.style.setFlatLight(t.properties,t.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(e),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const e=this.style.getLights()||[];return 0===e.length&&e.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),e}setLight(e){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:e}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(e){return this._lazyInitEmptyStyle(),!e&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(e),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(e){return this._lazyInitEmptyStyle(),this.style.setFog(e),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(e){return this._lazyInitEmptyStyle(),this.style.setSnow(e),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(e){return this._lazyInitEmptyStyle(),this.style.setRain(e),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(e){return this._lazyInitEmptyStyle(),this.style.setColorTheme(e),this._update(!0)}setImportColorTheme(e,t){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(e,t),this._update(!0)}setCamera(e){return this.style.setCamera(e),this._triggerCameraUpdate(e)}_triggerCameraUpdate(e){return this._update(this.transform.setOrthographicProjectionAtLowPitch("orthographic"===e["camera-projection"]))}getCamera(){return this.style.camera}_queryFogOpacity(t){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(e.bO.convert(t),this.transform):0}setFeatureState(e,t){return e.source&&!this._isValidId(e.source)?this:(this.style.setFeatureState(e,t),this._update())}removeFeatureState(e,t){return e.source&&!this._isValidId(e.source)?this:(this.style.removeFeatureState(e,t),this._update())}getFeatureState(e){return e.source&&!this._isValidId(e.source)?null:this.style.getFeatureState(e)}_updateContainerDimensions(){if(!this._container)return;const e=this._container.getBoundingClientRect().width||400,t=this._container.getBoundingClientRect().height||300;let i,r,n,o=this._container;for(;o&&(!r||!n);){const e=window.getComputedStyle(o).transform;e&&"none"!==e&&(i=e.match(/matrix.*\((.+)\)/)[1].split(", "),i[0]&&"0"!==i[0]&&"1"!==i[0]&&(r=i[0]),i[3]&&"0"!==i[3]&&"1"!==i[3]&&(n=i[3])),o=o.parentElement}this._containerWidth=r?Math.abs(e/r):e,this._containerHeight=n?Math.abs(t/n):t}_detectMissingCSS(){"rgb(250, 128, 114)"!==window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&e.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const e=this._container;e.classList.add("mapboxgl-map"),(this._missingCSSCanary=l("div","mapboxgl-canary",e)).style.visibility="hidden",this._detectMissingCSS();const t=this._canvasContainer=l("div","mapboxgl-canvas-container",e);this._canvas=l("canvas","mapboxgl-canvas",t),this._interactive&&(t.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const i=this._controlContainer=l("div","mapboxgl-control-container",e),r=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach((e=>{r[e]=l("div",`mapboxgl-ctrl-${e}`,i)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(t,i){const r=e.q.devicePixelRatio||1;this._canvas.width=r*Math.ceil(t),this._canvas.height=r*Math.ceil(i),this._canvas.style.width=`${t}px`,this._canvas.style.height=`${i}px`}_addMarker(e){this._markers.push(e)}_removeMarker(e){const t=this._markers.indexOf(e);-1!==t&&this._markers.splice(t,1)}_addPopup(e){this._popups.push(e)}_removePopup(e){const t=this._popups.indexOf(e);-1!==t&&this._popups.splice(t,1)}_setupPainter(){const t=e.l({},a.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),i=this._canvas.getContext("webgl2",t);i?(V(i,!0),this.painter=new Zs(i,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp),this.on("data",(e=>{"source"===e.dataType&&this.painter.setTileLoadedFlag(!0)})),e.m.testSupport(i)):this.fire(new e.y(new Error("Failed to initialize WebGL")))}_contextLost(t){t.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.z("webglcontextlost",{originalEvent:t}))}_contextRestored(t){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style.reloadModels(),this.style.clearSources(),this._update(),this.fire(new e.z("webglcontextrestored",{originalEvent:t}))}_onMapScroll(e){if(e.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(e){return this.style?(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(e){return this._update(),this._renderTaskQueue.add(e)}_cancelRenderFrame(e){this._renderTaskQueue.remove(e)}_requestDomTask(e){!this.loaded()||this.loaded()&&!this.isMoving()?e():this._domRenderTaskQueue.add(e)}_render(t){let n;this.fire(new e.z("renderstart")),++this._frameId;const o=this.painter.context.extTimerQuery,s=e.q.now(),a=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(n=a.createQuery(),a.beginQuery(o.TIME_ELAPSED_EXT,n)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(t),this._domRenderTaskQueue.run(t),this._removed)return;this._updateProjectionTransition();const l=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const t=this.transform.zoom,i=this.transform.pitch,r=e.q.now(),n=new e.a8(t,{now:r,fadeDuration:l,pitch:i,transition:this.style.transition});this.style.update(n)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let c=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),c=this._updateAverageElevation(s),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):c=this._updateAverageElevation(s);const u=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,l,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),u&&(this._placementDirty=u.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:l,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new e.z("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,r.mark(i.load),this.fire(new e.z("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),n){const t=e.q.now()-s;a.endQuery(o.TIME_ELAPSED_EXT),setTimeout((()=>{const i=a.getQueryParameter(n,a.QUERY_RESULT)/1e6;a.deleteQuery(n),this.fire(new e.z("gpu-timing-frame",{cpuTime:t,gpuTime:i}))}),50)}if(this.listens("gpu-timing-layer")){const t=this.painter.collectGpuTimers();setTimeout((()=>{const i=this.painter.queryGpuTimers(t);this.fire(new e.z("gpu-timing-layer",{layerTimes:i}))}),50)}if(this.listens("gpu-timing-deferred-render")){const t=this.painter.collectDeferredRenderGpuQueries();setTimeout((()=>{const i=this.painter.queryGpuTimeDeferredRender(t);this.fire(new e.z("gpu-timing-deferred-render",{gpuTime:i}))}),50)}const h=this._sourcesDirty||this._styleDirty||this._placementDirty||c;if(h||this._repaint)this.triggerRepaint();else{const t=this.idle();if(t&&(c=this._updateAverageElevation(s,!0)),c)this.triggerRepaint();else if(this._triggerFrame(!1),t&&(this.fire(new e.z("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const t=this._calculateSpeedIndex();this.fire(new e.z("speedindexcompleted",{speedIndex:t})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||h||(this._fullyLoaded=!0,r.mark(i.fullLoad),this._performanceMetricsCollection&&F(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(e){for(const t of this._markers)e&&!this.getRenderWorldCopies()&&(t._lngLat=t._lngLat.wrap()),t._update();for(const t of this._popups)!e||this.getRenderWorldCopies()||t._trackPointer||(t._lngLat=t._lngLat.wrap()),t._update()}_updateAverageElevation(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=e=>(this.transform.averageElevation=e,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&i(0);const r=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(r||(t||e-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(e)){const t=this.transform.averageElevation;let n=this.transform.sampleAverageElevation();null!=this.transform.elevation&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(n)?n=0:this._averageElevationLastSampledAt=e;const o=Math.abs(t-n);if(o>1){if(this._isInitialLoad||r)return this._averageElevation.jumpTo(n),i(n);this._averageElevation.easeTo(n,e,300)}else if(o>1e-4)return this._averageElevation.jumpTo(n),i(n)}return!!this._averageElevation.isEasing(e)&&i(this._averageElevation.getValue(e))}_authenticate(){N(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(t=>{if(t&&(t.message===w||401===t.status)){const t=this.painter.context.gl;V(t,!1),this._logoControl instanceof Ja&&this._logoControl._updateLogo(),t&&t.clear(t.DEPTH_BUFFER_BIT|t.COLOR_BUFFER_BIT|t.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new e.y(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}})),L(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(()=>{}))}_postStyleLoadEvent(){this.style.globalId&&z(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const e=this._isDragging();this.painter.updateTerrain(this.style,e)}_calculateSpeedIndex(){const e=this.painter.canvasCopy(),t=this.painter.getCanvasCopiesAndTimestamps();t.timeStamps.push(performance.now());const i=this.painter.context.gl,r=i.createFramebuffer();function n(e){i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,e,0);const t=new Uint8Array(i.drawingBufferWidth*i.drawingBufferHeight*4);return i.readPixels(0,0,i.drawingBufferWidth,i.drawingBufferHeight,i.RGBA,i.UNSIGNED_BYTE,t),t}return i.bindFramebuffer(i.FRAMEBUFFER,r),this._canvasPixelComparison(n(e),t.canvasCopies.map(n),t.timeStamps)}_canvasPixelComparison(e,t,i){let r=i[1]-i[0];const n=e.length/4;for(let o=0;o<t.length;o++){const s=t[o];let a=0;for(let t=0;t<s.length;t+=4)s[t]===e[t]&&s[t+1]===e[t+1]&&s[t+2]===e[t+2]&&s[t+3]===e[t+3]&&(a+=1);r+=(i[o+2]-i[o+1])*(1-a/n)}return r}remove(){this._hash&&this._hash.remove();for(const e of this._controls)e.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t&&t.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),j.delete(this.painter.context.gl),B.remove(),D.remove(),this._removed=!0,this.fire(new e.z("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(t){this._renderNextFrame=this._renderNextFrame||t,this.style&&!this._frame&&(this._frame=e.q.frame((e=>{const t=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,t&&this._render(e)})))}_preloadTiles(t){const i=this.style?this.style.getSourceCaches():[];return e.bl(i,((e,i)=>e._preloadTiles(t,i)),(()=>{this.triggerRepaint()})),this}_onWindowOnline(){this._update()}_onWindowResize(e){this._trackResize&&this.resize({originalEvent:e})._update()}_onVisibilityChange(){"hidden"===document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(e){this._showParseStatus!==e&&(this._showParseStatus=e,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(e){this._showTerrainWireframe!==e&&(this._showTerrainWireframe=e,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(e){this._showLayers2DWireframe!==e&&(this._showLayers2DWireframe=e,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(e){this._showLayers3DWireframe!==e&&(this._showLayers3DWireframe=e,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(e){this._speedIndexTiming!==e&&(this._speedIndexTiming=e,this._update())}get showPadding(){return!!this._showPadding}set showPadding(e){this._showPadding!==e&&(this._showPadding=e,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,this._tp.refreshUI(),e?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(e){this._repaint!==e&&(this._repaint=e,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(e){this._vertices=e,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(e){this._showTileAABBs!==e&&(this._showTileAABBs=e,this._tp.refreshUI(),e&&this._update())}_setCacheLimits(t,i){e.dG(t,i)}get version(){return t}},NavigationControl:class{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=e.l({},sl,t),this._container=l("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this.options.showZoom&&(e.aP(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(e=>{this._map&&this._map.zoomIn({},{originalEvent:e})})),l("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(e=>{this._map&&this._map.zoomOut({},{originalEvent:e})})),l("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(e.aP(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(e=>{const t=this._map;t&&(this.options.visualizePitch?t.resetNorthPitch({},{originalEvent:e}):t.resetNorth({},{originalEvent:e}))})),this._compassIcon=l("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const e=this._map;if(!e)return;const t=e.getZoom(),i=t===e.getMaxZoom(),r=t===e.getMinZoom();this._zoomInButton.disabled=i,this._zoomOutButton.disabled=r,this._zoomInButton.setAttribute("aria-disabled",i.toString()),this._zoomOutButton.setAttribute("aria-disabled",r.toString())}_rotateCompassArrow(){const e=this._map;if(!e)return;const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(e.transform.pitch*(Math.PI/180)),.5)}) rotateX(${e.transform.pitch}deg) rotateZ(${e.transform.angle*(180/Math.PI)}deg)`:`rotate(${e.transform.angle*(180/Math.PI)}deg)`;e._requestDomTask((()=>{this._compassIcon&&(this._compassIcon.style.transform=t)}))}onAdd(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),e.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&e.on("pitch",this._rotateCompassArrow),e.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new al(e,this._compass,this.options.visualizePitch)),this._container}onRemove(){const e=this._map;e&&(this._container.remove(),this.options.showZoom&&e.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&e.off("pitch",this._rotateCompassArrow),e.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(e,t){const i=l("button",e,this._container);return i.type="button",i.addEventListener("click",t),i}_setButtonTitle(e,t){if(!this._map)return;const i=this._map._getUIString(`NavigationControl.${t}`);e.setAttribute("aria-label",i),e.firstElementChild&&e.firstElementChild.setAttribute("title",i)}},GeolocateControl:class extends e.E{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super();const i=navigator.geolocation;this.options=e.l({geolocation:i},hl,t),e.aP(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Ks(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(e){return this._map=e,this._container=l("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(e){var t=this;const i=function(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!!t.options.geolocation;t._supportsGeolocation=i,e(i)};void 0!==this._supportsGeolocation?e(this._supportsGeolocation):void 0!==navigator.permissions?navigator.permissions.query({name:"geolocation"}).then((e=>i("denied"!==e.state))).catch((()=>i())):i()}_isOutOfMapMaxBounds(e){const t=this._map.getMaxBounds(),i=e.coords;return!!t&&(i.longitude<t.getWest()||i.longitude>t.getEast()||i.latitude<t.getSouth()||i.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(t){if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new e.z("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(t),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(t),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new e.z("geolocate",t)),this._finish()}}_updateCamera(t){const i=new e.bO(t.coords.longitude,t.coords.latitude),r=t.coords.accuracy,n=this._map.getBearing(),o=e.l({bearing:n},this.options.fitBoundsOptions);this._map.fitBounds(i.toBounds(r),o,{geolocateSource:!0})}_updateMarker(t){if(t){const i=new e.bO(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const t=this._map.transform,i=e.bH(1,t._center.lat)*t.worldSize,r=Math.ceil(2*this._accuracy*i);this._circleElement.style.width=`${r}px`,this._circleElement.style.height=`${r}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(t){if(this._map){if(this.options.trackUserLocation)if(1===t.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",e),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",e),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===t.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new e.z("error",t)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(t){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this._geolocateButton=l("button","mapboxgl-ctrl-geolocate",this._container),l("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===t){e.w("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}else{const e=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",e),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",e)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=l("div","mapboxgl-user-location"),this._dotElement.appendChild(l("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(l("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new ul({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=l("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ul({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(t=>{t.geolocateSource||"ACTIVE_LOCK"!==this._watchState||t.originalEvent&&"resize"===t.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new e.z("trackuserlocationend")))}))}}_onDeviceOrientation(e){this._userLocationDotMarker&&(e.webkitCompassHeading?this._heading=e.webkitCompassHeading:!0===e.absolute&&(this._heading=-1*e.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return e.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.z("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.z("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.z("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let e;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(e={maximumAge:6e5,timeout:0},this._noTimeout=!0):(e=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,e),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const e=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};"undefined"!=typeof DeviceMotionEvent&&"function"==typeof DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then((t=>{"granted"===t&&e()})).catch(console.error):e()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Ka,ScaleControl:class{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=e.l({},dl,t),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch(e){return!1}}(),e.aP(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const e=this.options.maxWidth||100,t=this._map,i=t._containerHeight/2,r=t._containerWidth/2-e/2,n=t.unproject([r,i]),o=t.unproject([r+e,i]),s=n.distanceTo(o);if("imperial"===this.options.unit){const t=3.2808*s;t>5280?this._setScale(e,t/5280,"mile"):this._setScale(e,t,"foot")}else"nautical"===this.options.unit?this._setScale(e,s/1852,"nautical-mile"):s>=1e3?this._setScale(e,s/1e3,"kilometer"):this._setScale(e,s,"meter")}_setScale(e,t,i){this._map._requestDomTask((()=>{const r=function(e){const t=Math.pow(10,`${Math.floor(e)}`.length-1);let i=e/t;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:i>=1?1:function(e){const t=Math.pow(10,Math.ceil(-Math.log(e)/Math.LN10));return Math.round(e*t)/t}(i),t*i}(t),n=r/t;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==i?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:i}).format(r):`${r}&nbsp;${pl[i]}`,this._container.style.width=e*n+"px"}))}onAdd(e){return this._map=e,this._language=e.getLanguage(),this._container=l("div","mapboxgl-ctrl mapboxgl-ctrl-scale",e.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(e){this._language=e,this._update()}setUnit(e){this.options.unit=e,this._update()}},FullscreenControl:class{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._fullscreen=!1,t&&t.container&&(t.container instanceof HTMLElement?this._container=t.container:e.w("Full screen control 'container' must be a DOM element.")),e.aP(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(t){return this._map=t,this._container||(this._container=this._map.getContainer()),this._controlContainer=l("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const e=this._fullscreenButton=l("button","mapboxgl-ctrl-fullscreen",this._controlContainer);l("span","mapboxgl-ctrl-icon",e).setAttribute("aria-hidden","true"),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",e)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends e.E{constructor(t){super(),this.options=e.l(Object.create(fl),t),e.aP(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(t&&t.className?t.className.trim().split(/\s+/):[])}addTo(t){return this._map&&this.remove(),this._map=t,this.options.closeOnClick&&t.on("preclick",this._onClose),this.options.closeOnMove&&t.on("move",this._onClose),t.on("remove",this.remove),this._update(),t._addPopup(this),this._focusFirstElement(),this._trackPointer?(t.on("mousemove",this._onMouseEvent),t.on("mouseup",this._onMouseEvent),t._canvasContainer.classList.add("mapboxgl-track-pointer")):t.on("move",this._update),this.fire(new e.z("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const t=this._map;return t&&(t.off("move",this._update),t.off("move",this._onClose),t.off("preclick",this._onClose),t.off("click",this._onClose),t.off("remove",this.remove),t.off("mousemove",this._onMouseEvent),t.off("mouseup",this._onMouseEvent),t.off("drag",this._onMouseEvent),t._canvasContainer&&t._canvasContainer.classList.remove("mapboxgl-track-pointer"),t._removePopup(this),this._map=void 0),this.fire(new e.z("close")),this}getLngLat(){return this._lngLat}setLngLat(t){this._lngLat=e.bO.convert(t),this._pos=null,this._trackPointer=!1,this._update();const i=this._map;return i&&(i.on("move",this._update),i.off("mousemove",this._onMouseEvent),i._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const e=this._map;return e&&(e.off("move",this._update),e.on("mousemove",this._onMouseEvent),e.on("drag",this._onMouseEvent),e._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(e){return this.setDOMContent(document.createTextNode(e))}setHTML(e){const t=document.createDocumentFragment(),i=document.createElement("body");let r;for(i.innerHTML=e;r=i.firstChild,r;)t.appendChild(r);return this.setDOMContent(t)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(e){return this.options.maxWidth=e,this._update(),this}setDOMContent(e){let t=this._content;if(t)for(;t.hasChildNodes();)t.firstChild&&t.removeChild(t.firstChild);else t=this._content=l("div","mapboxgl-popup-content",this._container||void 0);if(t.appendChild(e),this.options.closeButton){const e=this._closeButton=l("button","mapboxgl-popup-close-button",t);e.type="button",e.setAttribute("aria-label","Close popup"),e.innerHTML='<span aria-hidden="true">&#215;</span>',e.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(e){return this._classList.add(e),this._updateClassList(),this}removeClassName(e){return this._classList.delete(e),this._updateClassList(),this}setOffset(e){return this.options.offset=e,this._update(),this}toggleClassName(e){let t;return this._classList.delete(e)?t=!1:(this._classList.add(e),t=!0),this._updateClassList(),t}_onMouseEvent(e){this._update(e.point)}_getAnchor(e){if(this.options.anchor)return this.options.anchor;const t=this._map,i=this._container,r=this._pos;if(!t||!i||!r)return"bottom";const n=i.offsetWidth,o=i.offsetHeight,s=r.x<n/2,a=r.x>t.transform.width-n/2;if(r.y+e<o)return s?"top-left":a?"top-right":"top";if(r.y>t.transform.height-o){if(s)return"bottom-left";if(a)return"bottom-right"}return s?"left":a?"right":"bottom"}_updateClassList(){const e=this._container;if(!e)return;const t=[...this._classList];t.push("mapboxgl-popup"),this._anchor&&t.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&t.push("mapboxgl-popup-track-pointer"),e.className=t.join(" ")}_update(t){const i=this._map,r=this._content;if(!i||!this._lngLat&&!this._trackPointer||!r)return;let n=this._container;if(n||(n=this._container=l("div","mapboxgl-popup",i.getContainer()),this._tip=l("div","mapboxgl-popup-tip",n),n.appendChild(r)),this.options.maxWidth&&n.style.maxWidth!==this.options.maxWidth&&(n.style.maxWidth=this.options.maxWidth),i.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ll(this._lngLat,this._pos,i.transform)),!this._trackPointer||t){const r=this._pos=this._trackPointer&&t instanceof e.P?t:i.project(this._lngLat),n=gl(this.options.offset),o=this._anchor=this._getAnchor(n.y),s=gl(this.options.offset,o),a=r.add(s).round();i._requestDomTask((()=>{this._container&&o&&(this._container.style.transform=`${cl[o]} translate(${a.x}px,${a.y}px)`)}))}if(!this._marker&&i._showingGlobe()){const t=e.dH(i.transform,this._lngLat)?0:1;this._setOpacity(t)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const e=this._container.querySelector(ml);e&&e.focus()}_onClose(){this.remove()}_setOpacity(e){this._container&&(this._container.style.opacity=`${e}`),this._content&&(this._content.style.pointerEvents=e?"auto":"none")}},Marker:ul,Style:wr,LngLat:e.bO,LngLatBounds:e.az,Point:e.P,MercatorCoordinate:e.aa,FreeCameraOptions:qi,Evented:e.E,config:e.e,prewarm:e.dM,clearPrewarmedResources:e.dN,get accessToken(){return e.e.ACCESS_TOKEN},set accessToken(t){e.e.ACCESS_TOKEN=t},get baseApiUrl(){return e.e.API_URL},set baseApiUrl(t){e.e.API_URL=t},get workerCount(){return e.dO.workerCount},set workerCount(t){e.dO.workerCount=t},get maxParallelImageRequests(){return e.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(t){e.e.MAX_PARALLEL_IMAGE_REQUESTS=t},clearStorage(t){e.dP(t)},get workerUrl(){return e.dQ.workerUrl},set workerUrl(t){e.dQ.workerUrl=t},get workerClass(){return e.dQ.workerClass},set workerClass(t){e.dQ.workerClass=t},get workerParams(){return e.dQ.workerParams},set workerParams(t){e.dQ.workerParams=t},get dracoUrl(){return e.dR()},set dracoUrl(t){e.dS(t)},get meshoptUrl(){return e.dT()},set meshoptUrl(t){e.dU(t)},setNow:e.q.setNow,restoreNow:e.q.restoreNow};return yl})),i}()},918:(e,t,i)=>{"use strict";function r(e){var t=Object.create(null);return function(i){return void 0===t[i]&&(t[i]=e(i)),t[i]}}i.d(t,{A:()=>r})},1153:(e,t,i)=>{"use strict";var r=i(5043),n=Symbol.for("react.element"),o=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,i){var r,o={},c=null,u=null;for(r in void 0!==i&&(c=""+i),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)s.call(t,r)&&!l.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===o[r]&&(o[r]=t[r]);return{$$typeof:n,type:e,key:c,ref:u,props:o,_owner:a.current}}t.Fragment=o,t.jsx=c,t.jsxs=c},1188:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});const r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MIN_SAFE_INTEGER,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.MAX_SAFE_INTEGER;return Math.max(t,Math.min(e,i))}},1497:(e,t,i)=>{"use strict";var r=i(3218);function n(){}function o(){}o.resetWarningCache=n,e.exports=function(){function e(e,t,i,n,o,s){if(s!==r){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}e.isRequired=e;var i={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:n};return i.PropTypes=i,i}},1722:(e,t,i)=>{"use strict";i.d(t,{Rk:()=>r,SF:()=>n,sk:()=>o});function r(e,t,i){var r="";return i.split(" ").forEach((function(i){void 0!==e[i]?t.push(e[i]+";"):i&&(r+=i+" ")})),r}var n=function(e,t,i){var r=e.key+"-"+t.name;!1===i&&void 0===e.registered[r]&&(e.registered[r]=t.styles)},o=function(e,t,i){n(e,t,i);var r=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var o=t;do{e.insert(t===o?"."+r:"",o,e.sheet,!0),o=o.next}while(void 0!==o)}}},2374:(e,t,i)=>{"use strict";t.A=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var i=o(t);if(i&&i.has(e))return i.get(e);var r={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=n?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=e[s]}return r.default=e,i&&i.set(e,r),r}(i(5043)),n=i(3174);function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(o=function(e){return e?i:t})(e)}t.A=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=r.useContext(n.ThemeContext);return t&&(i=t,0!==Object.keys(i).length)?t:e;var i}},2730:(e,t,i)=>{"use strict";var r=i(5043),n=i(8853);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(a[e]=t,e=0;e<t.length;e++)s.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,i,r,n,o,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=n,this.mustUseProperty=i,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function _(e){return e[1].toUpperCase()}function v(e,t,i,r){var n=g.hasOwnProperty(t)?g[t]:null;(null!==n?0!==n.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,i,r){if(null===t||"undefined"===typeof t||function(e,t,i,r){if(null!==i&&0===i.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==i?!i.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,i,r))return!0;if(r)return!1;if(null!==i)switch(i.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,i,n,r)&&(i=null),r||null===n?function(e){return!!h.call(f,e)||!h.call(p,e)&&(d.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===i?e.removeAttribute(t):e.setAttribute(t,""+i)):n.mustUseProperty?e[n.propertyName]=null===i?3!==n.type&&"":i:(t=n.attributeName,r=n.attributeNamespace,null===i?e.removeAttribute(t):(i=3===(n=n.type)||4===n&&!0===i?"":""+i,r?e.setAttributeNS(r,t,i):e.setAttribute(t,i))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,_);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,_);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,_);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var x=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b=Symbol.for("react.element"),w=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),A=Symbol.for("react.provider"),C=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),k=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),D=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var L=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function z(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=R&&e[R]||e["@@iterator"])?e:null}var O,F=Object.assign;function B(e){if(void 0===O)try{throw Error()}catch(i){var t=i.stack.trim().match(/\n( *(at )?)/);O=t&&t[1]||""}return"\n"+O+e}var N=!1;function j(e,t){if(!e||N)return"";N=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var n=c.stack.split("\n"),o=r.stack.split("\n"),s=n.length-1,a=o.length-1;1<=s&&0<=a&&n[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(n[s]!==o[a]){if(1!==s||1!==a)do{if(s--,0>--a||n[s]!==o[a]){var l="\n"+n[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=a);break}}}finally{N=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?B(e):""}function V(e){switch(e.tag){case 5:return B(e.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return e=j(e.type,!1);case 11:return e=j(e.type.render,!1);case 1:return e=j(e.type,!0);default:return""}}function U(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case w:return"Portal";case M:return"Profiler";case T:return"StrictMode";case P:return"Suspense";case k:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case C:return(e.displayName||"Context")+".Consumer";case A:return(e._context.displayName||"Context")+".Provider";case E:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case I:return null!==(t=e.displayName||null)?t:U(e.type)||"Memo";case D:t=e._payload,e=e._init;try{return U(e(t))}catch(i){}}return null}function G(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U(t);case 8:return t===T?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function $(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof i&&"function"===typeof i.get&&"function"===typeof i.set){var n=i.get,o=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function q(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),r="";return e&&(r=W(e)?e.checked?"true":"false":e.value),(e=r)!==i&&(t.setValue(e),!0)}function X(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var i=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=i?i:e._wrapperState.initialChecked})}function Z(e,t){var i=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;i=H(null!=t.value?t.value:i),e._wrapperState={initialChecked:r,initialValue:i,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function K(e,t){null!=(t=t.checked)&&v(e,"checked",t,!1)}function J(e,t){K(e,t);var i=H(t.value),r=t.type;if(null!=i)"number"===r?(0===i&&""===e.value||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,i):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Q(e,t,i){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,i||t===e.value||(e.value=t),e.defaultValue=t}""!==(i=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==i&&(e.name=i)}function ee(e,t,i){"number"===t&&X(e.ownerDocument)===e||(null==i?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}var te=Array.isArray;function ie(e,t,i,r){if(e=e.options,t){t={};for(var n=0;n<i.length;n++)t["$"+i[n]]=!0;for(i=0;i<e.length;i++)n=t.hasOwnProperty("$"+e[i].value),e[i].selected!==n&&(e[i].selected=n),n&&r&&(e[i].defaultSelected=!0)}else{for(i=""+H(i),t=null,n=0;n<e.length;n++){if(e[n].value===i)return e[n].selected=!0,void(r&&(e[n].defaultSelected=!0));null!==t||e[n].disabled||(t=e[n])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ne(e,t){var i=t.value;if(null==i){if(i=t.children,t=t.defaultValue,null!=i){if(null!=t)throw Error(o(92));if(te(i)){if(1<i.length)throw Error(o(93));i=i[0]}t=i}null==t&&(t=""),i=t}e._wrapperState={initialValue:H(i)}}function oe(e,t){var i=H(t.value),r=H(t.defaultValue);null!=i&&((i=""+i)!==e.value&&(e.value=i),null==t.defaultValue&&e.defaultValue!==i&&(e.defaultValue=i)),null!=r&&(e.defaultValue=""+r)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,i,r){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function de(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&3===i.nodeType)return void(i.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,i){return null==t||"boolean"===typeof t||""===t?"":i||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var i in e=e.style,t)if(t.hasOwnProperty(i)){var r=0===i.indexOf("--"),n=me(i,t[i],r);"float"===i&&(i="cssFloat"),r?e.setProperty(i,n):e[i]=n}}Object.keys(pe).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ye=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _e(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(o(62))}}function ve(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function be(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,Se=null,Te=null;function Me(e){if(e=vn(e)){if("function"!==typeof we)throw Error(o(280));var t=e.stateNode;t&&(t=bn(t),we(e.stateNode,e.type,t))}}function Ae(e){Se?Te?Te.push(e):Te=[e]:Se=e}function Ce(){if(Se){var e=Se,t=Te;if(Te=Se=null,Me(e),t)for(e=0;e<t.length;e++)Me(t[e])}}function Ee(e,t){return e(t)}function Pe(){}var ke=!1;function Ie(e,t,i){if(ke)return e(t,i);ke=!0;try{return Ee(e,t,i)}finally{ke=!1,(null!==Se||null!==Te)&&(Pe(),Ce())}}function De(e,t){var i=e.stateNode;if(null===i)return null;var r=bn(i);if(null===r)return null;i=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(i&&"function"!==typeof i)throw Error(o(231,t,typeof i));return i}var Le=!1;if(u)try{var Re={};Object.defineProperty(Re,"passive",{get:function(){Le=!0}}),window.addEventListener("test",Re,Re),window.removeEventListener("test",Re,Re)}catch(ue){Le=!1}function ze(e,t,i,r,n,o,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(i,c)}catch(u){this.onError(u)}}var Oe=!1,Fe=null,Be=!1,Ne=null,je={onError:function(e){Oe=!0,Fe=e}};function Ve(e,t,i,r,n,o,s,a,l){Oe=!1,Fe=null,ze.apply(je,arguments)}function Ue(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(i=t.return),e=t.return}while(e)}return 3===t.tag?i:null}function Ge(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(Ue(e)!==e)throw Error(o(188))}function We(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ue(e)))throw Error(o(188));return t!==e?null:e}for(var i=e,r=t;;){var n=i.return;if(null===n)break;var s=n.alternate;if(null===s){if(null!==(r=n.return)){i=r;continue}break}if(n.child===s.child){for(s=n.child;s;){if(s===i)return He(n),e;if(s===r)return He(n),t;s=s.sibling}throw Error(o(188))}if(i.return!==r.return)i=n,r=s;else{for(var a=!1,l=n.child;l;){if(l===i){a=!0,i=n,r=s;break}if(l===r){a=!0,r=n,i=s;break}l=l.sibling}if(!a){for(l=s.child;l;){if(l===i){a=!0,i=s,r=n;break}if(l===r){a=!0,r=s,i=n;break}l=l.sibling}if(!a)throw Error(o(189))}}if(i.alternate!==r)throw Error(o(190))}if(3!==i.tag)throw Error(o(188));return i.stateNode.current===i?e:t}(e))?$e(e):null}function $e(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=$e(e);if(null!==t)return t;e=e.sibling}return null}var qe=n.unstable_scheduleCallback,Xe=n.unstable_cancelCallback,Ye=n.unstable_shouldYield,Ze=n.unstable_requestPaint,Ke=n.unstable_now,Je=n.unstable_getCurrentPriorityLevel,Qe=n.unstable_ImmediatePriority,et=n.unstable_UserBlockingPriority,tt=n.unstable_NormalPriority,it=n.unstable_LowPriority,rt=n.unstable_IdlePriority,nt=null,ot=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/lt|0)|0},at=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var i=e.pendingLanes;if(0===i)return 0;var r=0,n=e.suspendedLanes,o=e.pingedLanes,s=268435455&i;if(0!==s){var a=s&~n;0!==a?r=ht(a):0!==(o&=s)&&(r=ht(o))}else 0!==(s=i&~n)?r=ht(s):0!==o&&(r=ht(o));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&n)&&((n=r&-r)>=(o=t&-t)||16===n&&0!==(4194240&o)))return t;if(0!==(4&r)&&(r|=16&i),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)n=1<<(i=31-st(t)),r|=e[i],t&=~n;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function yt(e,t,i){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=i}function _t(e,t){var i=e.entangledLanes|=t;for(e=e.entanglements;i;){var r=31-st(i),n=1<<r;n&t|e[r]&t&&(e[r]|=t),i&=~n}}var vt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var bt,wt,St,Tt,Mt,At=!1,Ct=[],Et=null,Pt=null,kt=null,It=new Map,Dt=new Map,Lt=[],Rt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function zt(e,t){switch(e){case"focusin":case"focusout":Et=null;break;case"dragenter":case"dragleave":Pt=null;break;case"mouseover":case"mouseout":kt=null;break;case"pointerover":case"pointerout":It.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dt.delete(t.pointerId)}}function Ot(e,t,i,r,n,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:i,eventSystemFlags:r,nativeEvent:o,targetContainers:[n]},null!==t&&(null!==(t=vn(t))&&wt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==n&&-1===t.indexOf(n)&&t.push(n),e)}function Ft(e){var t=_n(e.target);if(null!==t){var i=Ue(t);if(null!==i)if(13===(t=i.tag)){if(null!==(t=Ge(i)))return e.blockedOn=t,void Mt(e.priority,(function(){St(i)}))}else if(3===t&&i.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===i.tag?i.stateNode.containerInfo:null)}e.blockedOn=null}function Bt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var i=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==i)return null!==(t=vn(i))&&wt(t),e.blockedOn=i,!1;var r=new(i=e.nativeEvent).constructor(i.type,i);xe=r,i.target.dispatchEvent(r),xe=null,t.shift()}return!0}function Nt(e,t,i){Bt(e)&&i.delete(t)}function jt(){At=!1,null!==Et&&Bt(Et)&&(Et=null),null!==Pt&&Bt(Pt)&&(Pt=null),null!==kt&&Bt(kt)&&(kt=null),It.forEach(Nt),Dt.forEach(Nt)}function Vt(e,t){e.blockedOn===t&&(e.blockedOn=null,At||(At=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,jt)))}function Ut(e){function t(t){return Vt(t,e)}if(0<Ct.length){Vt(Ct[0],e);for(var i=1;i<Ct.length;i++){var r=Ct[i];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Et&&Vt(Et,e),null!==Pt&&Vt(Pt,e),null!==kt&&Vt(kt,e),It.forEach(t),Dt.forEach(t),i=0;i<Lt.length;i++)(r=Lt[i]).blockedOn===e&&(r.blockedOn=null);for(;0<Lt.length&&null===(i=Lt[0]).blockedOn;)Ft(i),null===i.blockedOn&&Lt.shift()}var Gt=x.ReactCurrentBatchConfig,Ht=!0;function Wt(e,t,i,r){var n=vt,o=Gt.transition;Gt.transition=null;try{vt=1,qt(e,t,i,r)}finally{vt=n,Gt.transition=o}}function $t(e,t,i,r){var n=vt,o=Gt.transition;Gt.transition=null;try{vt=4,qt(e,t,i,r)}finally{vt=n,Gt.transition=o}}function qt(e,t,i,r){if(Ht){var n=Yt(e,t,i,r);if(null===n)Gr(e,t,r,Xt,i),zt(e,r);else if(function(e,t,i,r,n){switch(t){case"focusin":return Et=Ot(Et,e,t,i,r,n),!0;case"dragenter":return Pt=Ot(Pt,e,t,i,r,n),!0;case"mouseover":return kt=Ot(kt,e,t,i,r,n),!0;case"pointerover":var o=n.pointerId;return It.set(o,Ot(It.get(o)||null,e,t,i,r,n)),!0;case"gotpointercapture":return o=n.pointerId,Dt.set(o,Ot(Dt.get(o)||null,e,t,i,r,n)),!0}return!1}(n,e,t,i,r))r.stopPropagation();else if(zt(e,r),4&t&&-1<Rt.indexOf(e)){for(;null!==n;){var o=vn(n);if(null!==o&&bt(o),null===(o=Yt(e,t,i,r))&&Gr(e,t,r,Xt,i),o===n)break;n=o}null!==n&&r.stopPropagation()}else Gr(e,t,r,null,i)}}var Xt=null;function Yt(e,t,i,r){if(Xt=null,null!==(e=_n(e=be(r))))if(null===(t=Ue(e)))e=null;else if(13===(i=t.tag)){if(null!==(e=Ge(t)))return e;e=null}else if(3===i){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xt=e,null}function Zt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Qe:return 1;case et:return 4;case tt:case it:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Kt=null,Jt=null,Qt=null;function ei(){if(Qt)return Qt;var e,t,i=Jt,r=i.length,n="value"in Kt?Kt.value:Kt.textContent,o=n.length;for(e=0;e<r&&i[e]===n[e];e++);var s=r-e;for(t=1;t<=s&&i[r-t]===n[o-t];t++);return Qt=n.slice(e,1<t?1-t:void 0)}function ti(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function ii(){return!0}function ri(){return!1}function ni(e){function t(t,i,r,n,o){for(var s in this._reactName=t,this._targetInst=r,this.type=i,this.nativeEvent=n,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(n):n[s]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?ii:ri,this.isPropagationStopped=ri,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=ii)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=ii)},persist:function(){},isPersistent:ii}),t}var oi,si,ai,li={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ci=ni(li),ui=F({},li,{view:0,detail:0}),hi=ni(ui),di=F({},ui,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ti,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ai&&(ai&&"mousemove"===e.type?(oi=e.screenX-ai.screenX,si=e.screenY-ai.screenY):si=oi=0,ai=e),oi)},movementY:function(e){return"movementY"in e?e.movementY:si}}),pi=ni(di),fi=ni(F({},di,{dataTransfer:0})),mi=ni(F({},ui,{relatedTarget:0})),gi=ni(F({},li,{animationName:0,elapsedTime:0,pseudoElement:0})),yi=F({},li,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),_i=ni(yi),vi=ni(F({},li,{data:0})),xi={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bi={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wi={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Si(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=wi[e])&&!!t[e]}function Ti(){return Si}var Mi=F({},ui,{key:function(e){if(e.key){var t=xi[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=ti(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?bi[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ti,charCode:function(e){return"keypress"===e.type?ti(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?ti(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Ai=ni(Mi),Ci=ni(F({},di,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Ei=ni(F({},ui,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ti})),Pi=ni(F({},li,{propertyName:0,elapsedTime:0,pseudoElement:0})),ki=F({},di,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ii=ni(ki),Di=[9,13,27,32],Li=u&&"CompositionEvent"in window,Ri=null;u&&"documentMode"in document&&(Ri=document.documentMode);var zi=u&&"TextEvent"in window&&!Ri,Oi=u&&(!Li||Ri&&8<Ri&&11>=Ri),Fi=String.fromCharCode(32),Bi=!1;function Ni(e,t){switch(e){case"keyup":return-1!==Di.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ji(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Vi=!1;var Ui={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Ui[e.type]:"textarea"===t}function Hi(e,t,i,r){Ae(r),0<(t=Wr(t,"onChange")).length&&(i=new ci("onChange","change",null,i,r),e.push({event:i,listeners:t}))}var Wi=null,$i=null;function qi(e){Fr(e,0)}function Xi(e){if(q(xn(e)))return e}function Yi(e,t){if("change"===e)return t}var Zi=!1;if(u){var Ki;if(u){var Ji="oninput"in document;if(!Ji){var Qi=document.createElement("div");Qi.setAttribute("oninput","return;"),Ji="function"===typeof Qi.oninput}Ki=Ji}else Ki=!1;Zi=Ki&&(!document.documentMode||9<document.documentMode)}function er(){Wi&&(Wi.detachEvent("onpropertychange",tr),$i=Wi=null)}function tr(e){if("value"===e.propertyName&&Xi($i)){var t=[];Hi(t,$i,e,be(e)),Ie(qi,t)}}function ir(e,t,i){"focusin"===e?(er(),$i=i,(Wi=t).attachEvent("onpropertychange",tr)):"focusout"===e&&er()}function rr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Xi($i)}function nr(e,t){if("click"===e)return Xi(t)}function or(e,t){if("input"===e||"change"===e)return Xi(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ar(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var i=Object.keys(e),r=Object.keys(t);if(i.length!==r.length)return!1;for(r=0;r<i.length;r++){var n=i[r];if(!h.call(t,n)||!sr(e[n],t[n]))return!1}return!0}function lr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function cr(e,t){var i,r=lr(e);for(e=0;r;){if(3===r.nodeType){if(i=e+r.textContent.length,e<=t&&i>=t)return{node:r,offset:t-e};e=i}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=lr(r)}}function ur(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ur(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=X();t instanceof e.HTMLIFrameElement;){try{var i="string"===typeof t.contentWindow.location.href}catch(r){i=!1}if(!i)break;t=X((e=t.contentWindow).document)}return t}function dr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=hr(),i=e.focusedElem,r=e.selectionRange;if(t!==i&&i&&i.ownerDocument&&ur(i.ownerDocument.documentElement,i)){if(null!==r&&dr(i))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in i)i.selectionStart=t,i.selectionEnd=Math.min(e,i.value.length);else if((e=(t=i.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var n=i.textContent.length,o=Math.min(r.start,n);r=void 0===r.end?o:Math.min(r.end,n),!e.extend&&o>r&&(n=r,r=o,o=n),n=cr(i,o);var s=cr(i,r);n&&s&&(1!==e.rangeCount||e.anchorNode!==n.node||e.anchorOffset!==n.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(n.node,n.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=i;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof i.focus&&i.focus(),i=0;i<t.length;i++)(e=t[i]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fr=u&&"documentMode"in document&&11>=document.documentMode,mr=null,gr=null,yr=null,_r=!1;function vr(e,t,i){var r=i.window===i?i.document:9===i.nodeType?i:i.ownerDocument;_r||null==mr||mr!==X(r)||("selectionStart"in(r=mr)&&dr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&ar(yr,r)||(yr=r,0<(r=Wr(gr,"onSelect")).length&&(t=new ci("onSelect","select",null,t,i),e.push({event:t,listeners:r}),t.target=mr)))}function xr(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var br={animationend:xr("Animation","AnimationEnd"),animationiteration:xr("Animation","AnimationIteration"),animationstart:xr("Animation","AnimationStart"),transitionend:xr("Transition","TransitionEnd")},wr={},Sr={};function Tr(e){if(wr[e])return wr[e];if(!br[e])return e;var t,i=br[e];for(t in i)if(i.hasOwnProperty(t)&&t in Sr)return wr[e]=i[t];return e}u&&(Sr=document.createElement("div").style,"AnimationEvent"in window||(delete br.animationend.animation,delete br.animationiteration.animation,delete br.animationstart.animation),"TransitionEvent"in window||delete br.transitionend.transition);var Mr=Tr("animationend"),Ar=Tr("animationiteration"),Cr=Tr("animationstart"),Er=Tr("transitionend"),Pr=new Map,kr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ir(e,t){Pr.set(e,t),l(t,[e])}for(var Dr=0;Dr<kr.length;Dr++){var Lr=kr[Dr];Ir(Lr.toLowerCase(),"on"+(Lr[0].toUpperCase()+Lr.slice(1)))}Ir(Mr,"onAnimationEnd"),Ir(Ar,"onAnimationIteration"),Ir(Cr,"onAnimationStart"),Ir("dblclick","onDoubleClick"),Ir("focusin","onFocus"),Ir("focusout","onBlur"),Ir(Er,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rr));function Or(e,t,i){var r=e.type||"unknown-event";e.currentTarget=i,function(e,t,i,r,n,s,a,l,c){if(Ve.apply(this,arguments),Oe){if(!Oe)throw Error(o(198));var u=Fe;Oe=!1,Fe=null,Be||(Be=!0,Ne=u)}}(r,t,void 0,e),e.currentTarget=null}function Fr(e,t){t=0!==(4&t);for(var i=0;i<e.length;i++){var r=e[i],n=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&n.isPropagationStopped())break e;Or(n,a,c),o=l}else for(s=0;s<r.length;s++){if(l=(a=r[s]).instance,c=a.currentTarget,a=a.listener,l!==o&&n.isPropagationStopped())break e;Or(n,a,c),o=l}}}if(Be)throw e=Ne,Be=!1,Ne=null,e}function Br(e,t){var i=t[mn];void 0===i&&(i=t[mn]=new Set);var r=e+"__bubble";i.has(r)||(Ur(t,e,2,!1),i.add(r))}function Nr(e,t,i){var r=0;t&&(r|=4),Ur(i,e,r,t)}var jr="_reactListening"+Math.random().toString(36).slice(2);function Vr(e){if(!e[jr]){e[jr]=!0,s.forEach((function(t){"selectionchange"!==t&&(zr.has(t)||Nr(t,!1,e),Nr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[jr]||(t[jr]=!0,Nr("selectionchange",!1,t))}}function Ur(e,t,i,r){switch(Zt(t)){case 1:var n=Wt;break;case 4:n=$t;break;default:n=qt}i=n.bind(null,t,i,e),n=void 0,!Le||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(n=!0),r?void 0!==n?e.addEventListener(t,i,{capture:!0,passive:n}):e.addEventListener(t,i,!0):void 0!==n?e.addEventListener(t,i,{passive:n}):e.addEventListener(t,i,!1)}function Gr(e,t,i,r,n){var o=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var a=r.stateNode.containerInfo;if(a===n||8===a.nodeType&&a.parentNode===n)break;if(4===s)for(s=r.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===n||8===l.nodeType&&l.parentNode===n))return;s=s.return}for(;null!==a;){if(null===(s=_n(a)))return;if(5===(l=s.tag)||6===l){r=o=s;continue e}a=a.parentNode}}r=r.return}Ie((function(){var r=o,n=be(i),s=[];e:{var a=Pr.get(e);if(void 0!==a){var l=ci,c=e;switch(e){case"keypress":if(0===ti(i))break e;case"keydown":case"keyup":l=Ai;break;case"focusin":c="focus",l=mi;break;case"focusout":c="blur",l=mi;break;case"beforeblur":case"afterblur":l=mi;break;case"click":if(2===i.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pi;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=fi;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Ei;break;case Mr:case Ar:case Cr:l=gi;break;case Er:l=Pi;break;case"scroll":l=hi;break;case"wheel":l=Ii;break;case"copy":case"cut":case"paste":l=_i;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Ci}var u=0!==(4&t),h=!u&&"scroll"===e,d=u?null!==a?a+"Capture":null:a;u=[];for(var p,f=r;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==d&&(null!=(m=De(f,d))&&u.push(Hr(f,m,p)))),h)break;f=f.return}0<u.length&&(a=new l(a,c,null,i,n),s.push({event:a,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||i===xe||!(c=i.relatedTarget||i.fromElement)||!_n(c)&&!c[fn])&&(l||a)&&(a=n.window===n?n:(a=n.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=r,null!==(c=(c=i.relatedTarget||i.toElement)?_n(c):null)&&(c!==(h=Ue(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=pi,m="onMouseLeave",d="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=Ci,m="onPointerLeave",d="onPointerEnter",f="pointer"),h=null==l?a:xn(l),p=null==c?a:xn(c),(a=new u(m,f+"leave",l,i,n)).target=h,a.relatedTarget=p,m=null,_n(n)===r&&((u=new u(d,f+"enter",c,i,n)).target=p,u.relatedTarget=h,m=u),h=m,l&&c)e:{for(d=c,f=0,p=u=l;p;p=$r(p))f++;for(p=0,m=d;m;m=$r(m))p++;for(;0<f-p;)u=$r(u),f--;for(;0<p-f;)d=$r(d),p--;for(;f--;){if(u===d||null!==d&&u===d.alternate)break e;u=$r(u),d=$r(d)}u=null}else u=null;null!==l&&qr(s,a,l,u,!1),null!==c&&null!==h&&qr(s,h,c,u,!0)}if("select"===(l=(a=r?xn(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var g=Yi;else if(Gi(a))if(Zi)g=or;else{g=rr;var y=ir}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(g=nr);switch(g&&(g=g(e,r))?Hi(s,g,i,n):(y&&y(e,a,r),"focusout"===e&&(y=a._wrapperState)&&y.controlled&&"number"===a.type&&ee(a,"number",a.value)),y=r?xn(r):window,e){case"focusin":(Gi(y)||"true"===y.contentEditable)&&(mr=y,gr=r,yr=null);break;case"focusout":yr=gr=mr=null;break;case"mousedown":_r=!0;break;case"contextmenu":case"mouseup":case"dragend":_r=!1,vr(s,i,n);break;case"selectionchange":if(fr)break;case"keydown":case"keyup":vr(s,i,n)}var _;if(Li)e:{switch(e){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else Vi?Ni(e,i)&&(v="onCompositionEnd"):"keydown"===e&&229===i.keyCode&&(v="onCompositionStart");v&&(Oi&&"ko"!==i.locale&&(Vi||"onCompositionStart"!==v?"onCompositionEnd"===v&&Vi&&(_=ei()):(Jt="value"in(Kt=n)?Kt.value:Kt.textContent,Vi=!0)),0<(y=Wr(r,v)).length&&(v=new vi(v,e,null,i,n),s.push({event:v,listeners:y}),_?v.data=_:null!==(_=ji(i))&&(v.data=_))),(_=zi?function(e,t){switch(e){case"compositionend":return ji(t);case"keypress":return 32!==t.which?null:(Bi=!0,Fi);case"textInput":return(e=t.data)===Fi&&Bi?null:e;default:return null}}(e,i):function(e,t){if(Vi)return"compositionend"===e||!Li&&Ni(e,t)?(e=ei(),Qt=Jt=Kt=null,Vi=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Oi&&"ko"!==t.locale?null:t.data}}(e,i))&&(0<(r=Wr(r,"onBeforeInput")).length&&(n=new vi("onBeforeInput","beforeinput",null,i,n),s.push({event:n,listeners:r}),n.data=_))}Fr(s,t)}))}function Hr(e,t,i){return{instance:e,listener:t,currentTarget:i}}function Wr(e,t){for(var i=t+"Capture",r=[];null!==e;){var n=e,o=n.stateNode;5===n.tag&&null!==o&&(n=o,null!=(o=De(e,i))&&r.unshift(Hr(e,o,n)),null!=(o=De(e,t))&&r.push(Hr(e,o,n))),e=e.return}return r}function $r(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function qr(e,t,i,r,n){for(var o=t._reactName,s=[];null!==i&&i!==r;){var a=i,l=a.alternate,c=a.stateNode;if(null!==l&&l===r)break;5===a.tag&&null!==c&&(a=c,n?null!=(l=De(i,o))&&s.unshift(Hr(i,l,a)):n||null!=(l=De(i,o))&&s.push(Hr(i,l,a))),i=i.return}0!==s.length&&e.push({event:t,listeners:s})}var Xr=/\r\n?/g,Yr=/\u0000|\uFFFD/g;function Zr(e){return("string"===typeof e?e:""+e).replace(Xr,"\n").replace(Yr,"")}function Kr(e,t,i){if(t=Zr(t),Zr(e)!==t&&i)throw Error(o(425))}function Jr(){}var Qr=null,en=null;function tn(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var rn="function"===typeof setTimeout?setTimeout:void 0,nn="function"===typeof clearTimeout?clearTimeout:void 0,on="function"===typeof Promise?Promise:void 0,sn="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof on?function(e){return on.resolve(null).then(e).catch(an)}:rn;function an(e){setTimeout((function(){throw e}))}function ln(e,t){var i=t,r=0;do{var n=i.nextSibling;if(e.removeChild(i),n&&8===n.nodeType)if("/$"===(i=n.data)){if(0===r)return e.removeChild(n),void Ut(t);r--}else"$"!==i&&"$?"!==i&&"$!"!==i||r++;i=n}while(i);Ut(t)}function cn(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function un(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var i=e.data;if("$"===i||"$!"===i||"$?"===i){if(0===t)return e;t--}else"/$"===i&&t++}e=e.previousSibling}return null}var hn=Math.random().toString(36).slice(2),dn="__reactFiber$"+hn,pn="__reactProps$"+hn,fn="__reactContainer$"+hn,mn="__reactEvents$"+hn,gn="__reactListeners$"+hn,yn="__reactHandles$"+hn;function _n(e){var t=e[dn];if(t)return t;for(var i=e.parentNode;i;){if(t=i[fn]||i[dn]){if(i=t.alternate,null!==t.child||null!==i&&null!==i.child)for(e=un(e);null!==e;){if(i=e[dn])return i;e=un(e)}return t}i=(e=i).parentNode}return null}function vn(e){return!(e=e[dn]||e[fn])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xn(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function bn(e){return e[pn]||null}var wn=[],Sn=-1;function Tn(e){return{current:e}}function Mn(e){0>Sn||(e.current=wn[Sn],wn[Sn]=null,Sn--)}function An(e,t){Sn++,wn[Sn]=e.current,e.current=t}var Cn={},En=Tn(Cn),Pn=Tn(!1),kn=Cn;function In(e,t){var i=e.type.contextTypes;if(!i)return Cn;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var n,o={};for(n in i)o[n]=t[n];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Dn(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ln(){Mn(Pn),Mn(En)}function Rn(e,t,i){if(En.current!==Cn)throw Error(o(168));An(En,t),An(Pn,i)}function zn(e,t,i){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return i;for(var n in r=r.getChildContext())if(!(n in t))throw Error(o(108,G(e)||"Unknown",n));return F({},i,r)}function On(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Cn,kn=En.current,An(En,e),An(Pn,Pn.current),!0}function Fn(e,t,i){var r=e.stateNode;if(!r)throw Error(o(169));i?(e=zn(e,t,kn),r.__reactInternalMemoizedMergedChildContext=e,Mn(Pn),Mn(En),An(En,e)):Mn(Pn),An(Pn,i)}var Bn=null,Nn=!1,jn=!1;function Vn(e){null===Bn?Bn=[e]:Bn.push(e)}function Un(){if(!jn&&null!==Bn){jn=!0;var e=0,t=vt;try{var i=Bn;for(vt=1;e<i.length;e++){var r=i[e];do{r=r(!0)}while(null!==r)}Bn=null,Nn=!1}catch(n){throw null!==Bn&&(Bn=Bn.slice(e+1)),qe(Qe,Un),n}finally{vt=t,jn=!1}}return null}var Gn=[],Hn=0,Wn=null,$n=0,qn=[],Xn=0,Yn=null,Zn=1,Kn="";function Jn(e,t){Gn[Hn++]=$n,Gn[Hn++]=Wn,Wn=e,$n=t}function Qn(e,t,i){qn[Xn++]=Zn,qn[Xn++]=Kn,qn[Xn++]=Yn,Yn=e;var r=Zn;e=Kn;var n=32-st(r)-1;r&=~(1<<n),i+=1;var o=32-st(t)+n;if(30<o){var s=n-n%5;o=(r&(1<<s)-1).toString(32),r>>=s,n-=s,Zn=1<<32-st(t)+n|i<<n|r,Kn=o+e}else Zn=1<<o|i<<n|r,Kn=e}function eo(e){null!==e.return&&(Jn(e,1),Qn(e,1,0))}function to(e){for(;e===Wn;)Wn=Gn[--Hn],Gn[Hn]=null,$n=Gn[--Hn],Gn[Hn]=null;for(;e===Yn;)Yn=qn[--Xn],qn[Xn]=null,Kn=qn[--Xn],qn[Xn]=null,Zn=qn[--Xn],qn[Xn]=null}var io=null,ro=null,no=!1,oo=null;function so(e,t){var i=Ic(5,null,null,0);i.elementType="DELETED",i.stateNode=t,i.return=e,null===(t=e.deletions)?(e.deletions=[i],e.flags|=16):t.push(i)}function ao(e,t){switch(e.tag){case 5:var i=e.type;return null!==(t=1!==t.nodeType||i.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,io=e,ro=cn(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,io=e,ro=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(i=null!==Yn?{id:Zn,overflow:Kn}:null,e.memoizedState={dehydrated:t,treeContext:i,retryLane:1073741824},(i=Ic(18,null,null,0)).stateNode=t,i.return=e,e.child=i,io=e,ro=null,!0);default:return!1}}function lo(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function co(e){if(no){var t=ro;if(t){var i=t;if(!ao(e,t)){if(lo(e))throw Error(o(418));t=cn(i.nextSibling);var r=io;t&&ao(e,t)?so(r,i):(e.flags=-4097&e.flags|2,no=!1,io=e)}}else{if(lo(e))throw Error(o(418));e.flags=-4097&e.flags|2,no=!1,io=e}}}function uo(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;io=e}function ho(e){if(e!==io)return!1;if(!no)return uo(e),no=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!tn(e.type,e.memoizedProps)),t&&(t=ro)){if(lo(e))throw po(),Error(o(418));for(;t;)so(e,t),t=cn(t.nextSibling)}if(uo(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var i=e.data;if("/$"===i){if(0===t){ro=cn(e.nextSibling);break e}t--}else"$"!==i&&"$!"!==i&&"$?"!==i||t++}e=e.nextSibling}ro=null}}else ro=io?cn(e.stateNode.nextSibling):null;return!0}function po(){for(var e=ro;e;)e=cn(e.nextSibling)}function fo(){ro=io=null,no=!1}function mo(e){null===oo?oo=[e]:oo.push(e)}var go=x.ReactCurrentBatchConfig;function yo(e,t,i){if(null!==(e=i.ref)&&"function"!==typeof e&&"object"!==typeof e){if(i._owner){if(i=i._owner){if(1!==i.tag)throw Error(o(309));var r=i.stateNode}if(!r)throw Error(o(147,e));var n=r,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=n.refs;null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(o(284));if(!i._owner)throw Error(o(290,e))}return e}function _o(e,t){throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function vo(e){return(0,e._init)(e._payload)}function xo(e){function t(t,i){if(e){var r=t.deletions;null===r?(t.deletions=[i],t.flags|=16):r.push(i)}}function i(i,r){if(!e)return null;for(;null!==r;)t(i,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function n(e,t){return(e=Lc(e,t)).index=0,e.sibling=null,e}function s(t,i,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<i?(t.flags|=2,i):r:(t.flags|=2,i):(t.flags|=1048576,i)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,i,r){return null===t||6!==t.tag?((t=Fc(i,e.mode,r)).return=e,t):((t=n(t,i)).return=e,t)}function c(e,t,i,r){var o=i.type;return o===S?h(e,t,i.props.children,r,i.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===D&&vo(o)===t.type)?((r=n(t,i.props)).ref=yo(e,t,i),r.return=e,r):((r=Rc(i.type,i.key,i.props,null,e.mode,r)).ref=yo(e,t,i),r.return=e,r)}function u(e,t,i,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==i.containerInfo||t.stateNode.implementation!==i.implementation?((t=Bc(i,e.mode,r)).return=e,t):((t=n(t,i.children||[])).return=e,t)}function h(e,t,i,r,o){return null===t||7!==t.tag?((t=zc(i,e.mode,r,o)).return=e,t):((t=n(t,i)).return=e,t)}function d(e,t,i){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Fc(""+t,e.mode,i)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case b:return(i=Rc(t.type,t.key,t.props,null,e.mode,i)).ref=yo(e,null,t),i.return=e,i;case w:return(t=Bc(t,e.mode,i)).return=e,t;case D:return d(e,(0,t._init)(t._payload),i)}if(te(t)||z(t))return(t=zc(t,e.mode,i,null)).return=e,t;_o(e,t)}return null}function p(e,t,i,r){var n=null!==t?t.key:null;if("string"===typeof i&&""!==i||"number"===typeof i)return null!==n?null:l(e,t,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case b:return i.key===n?c(e,t,i,r):null;case w:return i.key===n?u(e,t,i,r):null;case D:return p(e,t,(n=i._init)(i._payload),r)}if(te(i)||z(i))return null!==n?null:h(e,t,i,r,null);_o(e,i)}return null}function f(e,t,i,r,n){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(i)||null,""+r,n);if("object"===typeof r&&null!==r){switch(r.$$typeof){case b:return c(t,e=e.get(null===r.key?i:r.key)||null,r,n);case w:return u(t,e=e.get(null===r.key?i:r.key)||null,r,n);case D:return f(e,t,i,(0,r._init)(r._payload),n)}if(te(r)||z(r))return h(t,e=e.get(i)||null,r,n,null);_o(t,r)}return null}function m(n,o,a,l){for(var c=null,u=null,h=o,m=o=0,g=null;null!==h&&m<a.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var y=p(n,h,a[m],l);if(null===y){null===h&&(h=g);break}e&&h&&null===y.alternate&&t(n,h),o=s(y,o,m),null===u?c=y:u.sibling=y,u=y,h=g}if(m===a.length)return i(n,h),no&&Jn(n,m),c;if(null===h){for(;m<a.length;m++)null!==(h=d(n,a[m],l))&&(o=s(h,o,m),null===u?c=h:u.sibling=h,u=h);return no&&Jn(n,m),c}for(h=r(n,h);m<a.length;m++)null!==(g=f(h,n,m,a[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),o=s(g,o,m),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach((function(e){return t(n,e)})),no&&Jn(n,m),c}function g(n,a,l,c){var u=z(l);if("function"!==typeof u)throw Error(o(150));if(null==(l=u.call(l)))throw Error(o(151));for(var h=u=null,m=a,g=a=0,y=null,_=l.next();null!==m&&!_.done;g++,_=l.next()){m.index>g?(y=m,m=null):y=m.sibling;var v=p(n,m,_.value,c);if(null===v){null===m&&(m=y);break}e&&m&&null===v.alternate&&t(n,m),a=s(v,a,g),null===h?u=v:h.sibling=v,h=v,m=y}if(_.done)return i(n,m),no&&Jn(n,g),u;if(null===m){for(;!_.done;g++,_=l.next())null!==(_=d(n,_.value,c))&&(a=s(_,a,g),null===h?u=_:h.sibling=_,h=_);return no&&Jn(n,g),u}for(m=r(n,m);!_.done;g++,_=l.next())null!==(_=f(m,n,g,_.value,c))&&(e&&null!==_.alternate&&m.delete(null===_.key?g:_.key),a=s(_,a,g),null===h?u=_:h.sibling=_,h=_);return e&&m.forEach((function(e){return t(n,e)})),no&&Jn(n,g),u}return function e(r,o,s,l){if("object"===typeof s&&null!==s&&s.type===S&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case b:e:{for(var c=s.key,u=o;null!==u;){if(u.key===c){if((c=s.type)===S){if(7===u.tag){i(r,u.sibling),(o=n(u,s.props.children)).return=r,r=o;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===D&&vo(c)===u.type){i(r,u.sibling),(o=n(u,s.props)).ref=yo(r,u,s),o.return=r,r=o;break e}i(r,u);break}t(r,u),u=u.sibling}s.type===S?((o=zc(s.props.children,r.mode,l,s.key)).return=r,r=o):((l=Rc(s.type,s.key,s.props,null,r.mode,l)).ref=yo(r,o,s),l.return=r,r=l)}return a(r);case w:e:{for(u=s.key;null!==o;){if(o.key===u){if(4===o.tag&&o.stateNode.containerInfo===s.containerInfo&&o.stateNode.implementation===s.implementation){i(r,o.sibling),(o=n(o,s.children||[])).return=r,r=o;break e}i(r,o);break}t(r,o),o=o.sibling}(o=Bc(s,r.mode,l)).return=r,r=o}return a(r);case D:return e(r,o,(u=s._init)(s._payload),l)}if(te(s))return m(r,o,s,l);if(z(s))return g(r,o,s,l);_o(r,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==o&&6===o.tag?(i(r,o.sibling),(o=n(o,s)).return=r,r=o):(i(r,o),(o=Fc(s,r.mode,l)).return=r,r=o),a(r)):i(r,o)}}var bo=xo(!0),wo=xo(!1),So=Tn(null),To=null,Mo=null,Ao=null;function Co(){Ao=Mo=To=null}function Eo(e){var t=So.current;Mn(So),e._currentValue=t}function Po(e,t,i){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===i)break;e=e.return}}function ko(e,t){To=e,Ao=Mo=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(va=!0),e.firstContext=null)}function Io(e){var t=e._currentValue;if(Ao!==e)if(e={context:e,memoizedValue:t,next:null},null===Mo){if(null===To)throw Error(o(308));Mo=e,To.dependencies={lanes:0,firstContext:e}}else Mo=Mo.next=e;return t}var Do=null;function Lo(e){null===Do?Do=[e]:Do.push(e)}function Ro(e,t,i,r){var n=t.interleaved;return null===n?(i.next=i,Lo(t)):(i.next=n.next,n.next=i),t.interleaved=i,zo(e,r)}function zo(e,t){e.lanes|=t;var i=e.alternate;for(null!==i&&(i.lanes|=t),i=e,e=e.return;null!==e;)e.childLanes|=t,null!==(i=e.alternate)&&(i.childLanes|=t),i=e,e=e.return;return 3===i.tag?i.stateNode:null}var Oo=!1;function Fo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Bo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function No(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function jo(e,t,i){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&El)){var n=r.pending;return null===n?t.next=t:(t.next=n.next,n.next=t),r.pending=t,zo(e,i)}return null===(n=r.interleaved)?(t.next=t,Lo(r)):(t.next=n.next,n.next=t),r.interleaved=t,zo(e,i)}function Vo(e,t,i){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&i))){var r=t.lanes;i|=r&=e.pendingLanes,t.lanes=i,_t(e,i)}}function Uo(e,t){var i=e.updateQueue,r=e.alternate;if(null!==r&&i===(r=r.updateQueue)){var n=null,o=null;if(null!==(i=i.firstBaseUpdate)){do{var s={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};null===o?n=o=s:o=o.next=s,i=i.next}while(null!==i);null===o?n=o=t:o=o.next=t}else n=o=t;return i={baseState:r.baseState,firstBaseUpdate:n,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(e.updateQueue=i)}null===(e=i.lastBaseUpdate)?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}function Go(e,t,i,r){var n=e.updateQueue;Oo=!1;var o=n.firstBaseUpdate,s=n.lastBaseUpdate,a=n.shared.pending;if(null!==a){n.shared.pending=null;var l=a,c=l.next;l.next=null,null===s?o=c:s.next=c,s=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==o){var h=n.baseState;for(s=0,u=c=l=null,a=o;;){var d=a.lane,p=a.eventTime;if((r&d)===d){null!==u&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var f=e,m=a;switch(d=t,p=i,m.tag){case 1:if("function"===typeof(f=m.payload)){h=f.call(p,h,d);break e}h=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(d="function"===typeof(f=m.payload)?f.call(p,h,d):f)||void 0===d)break e;h=F({},h,d);break e;case 2:Oo=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(d=n.effects)?n.effects=[a]:d.push(a))}else p={eventTime:p,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=p,l=h):u=u.next=p,s|=d;if(null===(a=a.next)){if(null===(a=n.shared.pending))break;a=(d=a).next,d.next=null,n.lastBaseUpdate=d,n.shared.pending=null}}if(null===u&&(l=h),n.baseState=l,n.firstBaseUpdate=c,n.lastBaseUpdate=u,null!==(t=n.shared.interleaved)){n=t;do{s|=n.lane,n=n.next}while(n!==t)}else null===o&&(n.shared.lanes=0);Ol|=s,e.lanes=s,e.memoizedState=h}}function Ho(e,t,i){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],n=r.callback;if(null!==n){if(r.callback=null,r=i,"function"!==typeof n)throw Error(o(191,n));n.call(r)}}}var Wo={},$o=Tn(Wo),qo=Tn(Wo),Xo=Tn(Wo);function Yo(e){if(e===Wo)throw Error(o(174));return e}function Zo(e,t){switch(An(Xo,t),An(qo,e),An($o,Wo),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Mn($o),An($o,t)}function Ko(){Mn($o),Mn(qo),Mn(Xo)}function Jo(e){Yo(Xo.current);var t=Yo($o.current),i=le(t,e.type);t!==i&&(An(qo,e),An($o,i))}function Qo(e){qo.current===e&&(Mn($o),Mn(qo))}var es=Tn(0);function ts(e){for(var t=e;null!==t;){if(13===t.tag){var i=t.memoizedState;if(null!==i&&(null===(i=i.dehydrated)||"$?"===i.data||"$!"===i.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var is=[];function rs(){for(var e=0;e<is.length;e++)is[e]._workInProgressVersionPrimary=null;is.length=0}var ns=x.ReactCurrentDispatcher,os=x.ReactCurrentBatchConfig,ss=0,as=null,ls=null,cs=null,us=!1,hs=!1,ds=0,ps=0;function fs(){throw Error(o(321))}function ms(e,t){if(null===t)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!sr(e[i],t[i]))return!1;return!0}function gs(e,t,i,r,n,s){if(ss=s,as=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ns.current=null===e||null===e.memoizedState?Qs:ea,e=i(r,n),hs){s=0;do{if(hs=!1,ds=0,25<=s)throw Error(o(301));s+=1,cs=ls=null,t.updateQueue=null,ns.current=ta,e=i(r,n)}while(hs)}if(ns.current=Js,t=null!==ls&&null!==ls.next,ss=0,cs=ls=as=null,us=!1,t)throw Error(o(300));return e}function ys(){var e=0!==ds;return ds=0,e}function _s(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===cs?as.memoizedState=cs=e:cs=cs.next=e,cs}function vs(){if(null===ls){var e=as.alternate;e=null!==e?e.memoizedState:null}else e=ls.next;var t=null===cs?as.memoizedState:cs.next;if(null!==t)cs=t,ls=e;else{if(null===e)throw Error(o(310));e={memoizedState:(ls=e).memoizedState,baseState:ls.baseState,baseQueue:ls.baseQueue,queue:ls.queue,next:null},null===cs?as.memoizedState=cs=e:cs=cs.next=e}return cs}function xs(e,t){return"function"===typeof t?t(e):t}function bs(e){var t=vs(),i=t.queue;if(null===i)throw Error(o(311));i.lastRenderedReducer=e;var r=ls,n=r.baseQueue,s=i.pending;if(null!==s){if(null!==n){var a=n.next;n.next=s.next,s.next=a}r.baseQueue=n=s,i.pending=null}if(null!==n){s=n.next,r=r.baseState;var l=a=null,c=null,u=s;do{var h=u.lane;if((ss&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,a=r):c=c.next=d,as.lanes|=h,Ol|=h}u=u.next}while(null!==u&&u!==s);null===c?a=r:c.next=l,sr(r,t.memoizedState)||(va=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=c,i.lastRenderedState=r}if(null!==(e=i.interleaved)){n=e;do{s=n.lane,as.lanes|=s,Ol|=s,n=n.next}while(n!==e)}else null===n&&(i.lanes=0);return[t.memoizedState,i.dispatch]}function ws(e){var t=vs(),i=t.queue;if(null===i)throw Error(o(311));i.lastRenderedReducer=e;var r=i.dispatch,n=i.pending,s=t.memoizedState;if(null!==n){i.pending=null;var a=n=n.next;do{s=e(s,a.action),a=a.next}while(a!==n);sr(s,t.memoizedState)||(va=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),i.lastRenderedState=s}return[s,r]}function Ss(){}function Ts(e,t){var i=as,r=vs(),n=t(),s=!sr(r.memoizedState,n);if(s&&(r.memoizedState=n,va=!0),r=r.queue,Os(Cs.bind(null,i,r,e),[e]),r.getSnapshot!==t||s||null!==cs&&1&cs.memoizedState.tag){if(i.flags|=2048,Is(9,As.bind(null,i,r,n,t),void 0,null),null===Pl)throw Error(o(349));0!==(30&ss)||Ms(i,t,n)}return n}function Ms(e,t,i){e.flags|=16384,e={getSnapshot:t,value:i},null===(t=as.updateQueue)?(t={lastEffect:null,stores:null},as.updateQueue=t,t.stores=[e]):null===(i=t.stores)?t.stores=[e]:i.push(e)}function As(e,t,i,r){t.value=i,t.getSnapshot=r,Es(t)&&Ps(e)}function Cs(e,t,i){return i((function(){Es(t)&&Ps(e)}))}function Es(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!sr(e,i)}catch(r){return!0}}function Ps(e){var t=zo(e,1);null!==t&&ic(t,e,1,-1)}function ks(e){var t=_s();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xs,lastRenderedState:e},t.queue=e,e=e.dispatch=Xs.bind(null,as,e),[t.memoizedState,e]}function Is(e,t,i,r){return e={tag:e,create:t,destroy:i,deps:r,next:null},null===(t=as.updateQueue)?(t={lastEffect:null,stores:null},as.updateQueue=t,t.lastEffect=e.next=e):null===(i=t.lastEffect)?t.lastEffect=e.next=e:(r=i.next,i.next=e,e.next=r,t.lastEffect=e),e}function Ds(){return vs().memoizedState}function Ls(e,t,i,r){var n=_s();as.flags|=e,n.memoizedState=Is(1|t,i,void 0,void 0===r?null:r)}function Rs(e,t,i,r){var n=vs();r=void 0===r?null:r;var o=void 0;if(null!==ls){var s=ls.memoizedState;if(o=s.destroy,null!==r&&ms(r,s.deps))return void(n.memoizedState=Is(t,i,o,r))}as.flags|=e,n.memoizedState=Is(1|t,i,o,r)}function zs(e,t){return Ls(8390656,8,e,t)}function Os(e,t){return Rs(2048,8,e,t)}function Fs(e,t){return Rs(4,2,e,t)}function Bs(e,t){return Rs(4,4,e,t)}function Ns(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function js(e,t,i){return i=null!==i&&void 0!==i?i.concat([e]):null,Rs(4,4,Ns.bind(null,t,e),i)}function Vs(){}function Us(e,t){var i=vs();t=void 0===t?null:t;var r=i.memoizedState;return null!==r&&null!==t&&ms(t,r[1])?r[0]:(i.memoizedState=[e,t],e)}function Gs(e,t){var i=vs();t=void 0===t?null:t;var r=i.memoizedState;return null!==r&&null!==t&&ms(t,r[1])?r[0]:(e=e(),i.memoizedState=[e,t],e)}function Hs(e,t,i){return 0===(21&ss)?(e.baseState&&(e.baseState=!1,va=!0),e.memoizedState=i):(sr(i,t)||(i=mt(),as.lanes|=i,Ol|=i,e.baseState=!0),t)}function Ws(e,t){var i=vt;vt=0!==i&&4>i?i:4,e(!0);var r=os.transition;os.transition={};try{e(!1),t()}finally{vt=i,os.transition=r}}function $s(){return vs().memoizedState}function qs(e,t,i){var r=tc(e);if(i={lane:r,action:i,hasEagerState:!1,eagerState:null,next:null},Ys(e))Zs(t,i);else if(null!==(i=Ro(e,t,i,r))){ic(i,e,r,ec()),Ks(i,t,r)}}function Xs(e,t,i){var r=tc(e),n={lane:r,action:i,hasEagerState:!1,eagerState:null,next:null};if(Ys(e))Zs(t,n);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=o(s,i);if(n.hasEagerState=!0,n.eagerState=a,sr(a,s)){var l=t.interleaved;return null===l?(n.next=n,Lo(t)):(n.next=l.next,l.next=n),void(t.interleaved=n)}}catch(c){}null!==(i=Ro(e,t,n,r))&&(ic(i,e,r,n=ec()),Ks(i,t,r))}}function Ys(e){var t=e.alternate;return e===as||null!==t&&t===as}function Zs(e,t){hs=us=!0;var i=e.pending;null===i?t.next=t:(t.next=i.next,i.next=t),e.pending=t}function Ks(e,t,i){if(0!==(4194240&i)){var r=t.lanes;i|=r&=e.pendingLanes,t.lanes=i,_t(e,i)}}var Js={readContext:Io,useCallback:fs,useContext:fs,useEffect:fs,useImperativeHandle:fs,useInsertionEffect:fs,useLayoutEffect:fs,useMemo:fs,useReducer:fs,useRef:fs,useState:fs,useDebugValue:fs,useDeferredValue:fs,useTransition:fs,useMutableSource:fs,useSyncExternalStore:fs,useId:fs,unstable_isNewReconciler:!1},Qs={readContext:Io,useCallback:function(e,t){return _s().memoizedState=[e,void 0===t?null:t],e},useContext:Io,useEffect:zs,useImperativeHandle:function(e,t,i){return i=null!==i&&void 0!==i?i.concat([e]):null,Ls(4194308,4,Ns.bind(null,t,e),i)},useLayoutEffect:function(e,t){return Ls(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ls(4,2,e,t)},useMemo:function(e,t){var i=_s();return t=void 0===t?null:t,e=e(),i.memoizedState=[e,t],e},useReducer:function(e,t,i){var r=_s();return t=void 0!==i?i(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=qs.bind(null,as,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},_s().memoizedState=e},useState:ks,useDebugValue:Vs,useDeferredValue:function(e){return _s().memoizedState=e},useTransition:function(){var e=ks(!1),t=e[0];return e=Ws.bind(null,e[1]),_s().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,i){var r=as,n=_s();if(no){if(void 0===i)throw Error(o(407));i=i()}else{if(i=t(),null===Pl)throw Error(o(349));0!==(30&ss)||Ms(r,t,i)}n.memoizedState=i;var s={value:i,getSnapshot:t};return n.queue=s,zs(Cs.bind(null,r,s,e),[e]),r.flags|=2048,Is(9,As.bind(null,r,s,i,t),void 0,null),i},useId:function(){var e=_s(),t=Pl.identifierPrefix;if(no){var i=Kn;t=":"+t+"R"+(i=(Zn&~(1<<32-st(Zn)-1)).toString(32)+i),0<(i=ds++)&&(t+="H"+i.toString(32)),t+=":"}else t=":"+t+"r"+(i=ps++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ea={readContext:Io,useCallback:Us,useContext:Io,useEffect:Os,useImperativeHandle:js,useInsertionEffect:Fs,useLayoutEffect:Bs,useMemo:Gs,useReducer:bs,useRef:Ds,useState:function(){return bs(xs)},useDebugValue:Vs,useDeferredValue:function(e){return Hs(vs(),ls.memoizedState,e)},useTransition:function(){return[bs(xs)[0],vs().memoizedState]},useMutableSource:Ss,useSyncExternalStore:Ts,useId:$s,unstable_isNewReconciler:!1},ta={readContext:Io,useCallback:Us,useContext:Io,useEffect:Os,useImperativeHandle:js,useInsertionEffect:Fs,useLayoutEffect:Bs,useMemo:Gs,useReducer:ws,useRef:Ds,useState:function(){return ws(xs)},useDebugValue:Vs,useDeferredValue:function(e){var t=vs();return null===ls?t.memoizedState=e:Hs(t,ls.memoizedState,e)},useTransition:function(){return[ws(xs)[0],vs().memoizedState]},useMutableSource:Ss,useSyncExternalStore:Ts,useId:$s,unstable_isNewReconciler:!1};function ia(e,t){if(e&&e.defaultProps){for(var i in t=F({},t),e=e.defaultProps)void 0===t[i]&&(t[i]=e[i]);return t}return t}function ra(e,t,i,r){i=null===(i=i(r,t=e.memoizedState))||void 0===i?t:F({},t,i),e.memoizedState=i,0===e.lanes&&(e.updateQueue.baseState=i)}var na={isMounted:function(e){return!!(e=e._reactInternals)&&Ue(e)===e},enqueueSetState:function(e,t,i){e=e._reactInternals;var r=ec(),n=tc(e),o=No(r,n);o.payload=t,void 0!==i&&null!==i&&(o.callback=i),null!==(t=jo(e,o,n))&&(ic(t,e,n,r),Vo(t,e,n))},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var r=ec(),n=tc(e),o=No(r,n);o.tag=1,o.payload=t,void 0!==i&&null!==i&&(o.callback=i),null!==(t=jo(e,o,n))&&(ic(t,e,n,r),Vo(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=ec(),r=tc(e),n=No(i,r);n.tag=2,void 0!==t&&null!==t&&(n.callback=t),null!==(t=jo(e,n,r))&&(ic(t,e,r,i),Vo(t,e,r))}};function oa(e,t,i,r,n,o,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,s):!t.prototype||!t.prototype.isPureReactComponent||(!ar(i,r)||!ar(n,o))}function sa(e,t,i){var r=!1,n=Cn,o=t.contextType;return"object"===typeof o&&null!==o?o=Io(o):(n=Dn(t)?kn:En.current,o=(r=null!==(r=t.contextTypes)&&void 0!==r)?In(e,n):Cn),t=new t(i,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=na,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=o),t}function aa(e,t,i,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(i,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(i,r),t.state!==e&&na.enqueueReplaceState(t,t.state,null)}function la(e,t,i,r){var n=e.stateNode;n.props=i,n.state=e.memoizedState,n.refs={},Fo(e);var o=t.contextType;"object"===typeof o&&null!==o?n.context=Io(o):(o=Dn(t)?kn:En.current,n.context=In(e,o)),n.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(ra(e,t,o,i),n.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof n.getSnapshotBeforeUpdate||"function"!==typeof n.UNSAFE_componentWillMount&&"function"!==typeof n.componentWillMount||(t=n.state,"function"===typeof n.componentWillMount&&n.componentWillMount(),"function"===typeof n.UNSAFE_componentWillMount&&n.UNSAFE_componentWillMount(),t!==n.state&&na.enqueueReplaceState(n,n.state,null),Go(e,i,n,r),n.state=e.memoizedState),"function"===typeof n.componentDidMount&&(e.flags|=4194308)}function ca(e,t){try{var i="",r=t;do{i+=V(r),r=r.return}while(r);var n=i}catch(o){n="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:n,digest:null}}function ua(e,t,i){return{value:e,source:null,stack:null!=i?i:null,digest:null!=t?t:null}}function ha(e,t){try{console.error(t.value)}catch(i){setTimeout((function(){throw i}))}}var da="function"===typeof WeakMap?WeakMap:Map;function pa(e,t,i){(i=No(-1,i)).tag=3,i.payload={element:null};var r=t.value;return i.callback=function(){Hl||(Hl=!0,Wl=r),ha(0,t)},i}function fa(e,t,i){(i=No(-1,i)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var n=t.value;i.payload=function(){return r(n)},i.callback=function(){ha(0,t)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(i.callback=function(){ha(0,t),"function"!==typeof r&&(null===$l?$l=new Set([this]):$l.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),i}function ma(e,t,i){var r=e.pingCache;if(null===r){r=e.pingCache=new da;var n=new Set;r.set(t,n)}else void 0===(n=r.get(t))&&(n=new Set,r.set(t,n));n.has(i)||(n.add(i),e=Mc.bind(null,e,t,i),t.then(e,e))}function ga(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ya(e,t,i,r,n){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,1===i.tag&&(null===i.alternate?i.tag=17:((t=No(-1,1)).tag=2,jo(i,t,1))),i.lanes|=1),e):(e.flags|=65536,e.lanes=n,e)}var _a=x.ReactCurrentOwner,va=!1;function xa(e,t,i,r){t.child=null===e?wo(t,null,i,r):bo(t,e.child,i,r)}function ba(e,t,i,r,n){i=i.render;var o=t.ref;return ko(t,n),r=gs(e,t,i,r,o,n),i=ys(),null===e||va?(no&&i&&eo(t),t.flags|=1,xa(e,t,r,n),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,Ha(e,t,n))}function wa(e,t,i,r,n){if(null===e){var o=i.type;return"function"!==typeof o||Dc(o)||void 0!==o.defaultProps||null!==i.compare||void 0!==i.defaultProps?((e=Rc(i.type,null,r,t,t.mode,n)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Sa(e,t,o,r,n))}if(o=e.child,0===(e.lanes&n)){var s=o.memoizedProps;if((i=null!==(i=i.compare)?i:ar)(s,r)&&e.ref===t.ref)return Ha(e,t,n)}return t.flags|=1,(e=Lc(o,r)).ref=t.ref,e.return=t,t.child=e}function Sa(e,t,i,r,n){if(null!==e){var o=e.memoizedProps;if(ar(o,r)&&e.ref===t.ref){if(va=!1,t.pendingProps=r=o,0===(e.lanes&n))return t.lanes=e.lanes,Ha(e,t,n);0!==(131072&e.flags)&&(va=!0)}}return Aa(e,t,i,r,n)}function Ta(e,t,i){var r=t.pendingProps,n=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},An(Ll,Dl),Dl|=i;else{if(0===(1073741824&i))return e=null!==o?o.baseLanes|i:i,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,An(Ll,Dl),Dl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==o?o.baseLanes:i,An(Ll,Dl),Dl|=r}else null!==o?(r=o.baseLanes|i,t.memoizedState=null):r=i,An(Ll,Dl),Dl|=r;return xa(e,t,n,i),t.child}function Ma(e,t){var i=t.ref;(null===e&&null!==i||null!==e&&e.ref!==i)&&(t.flags|=512,t.flags|=2097152)}function Aa(e,t,i,r,n){var o=Dn(i)?kn:En.current;return o=In(t,o),ko(t,n),i=gs(e,t,i,r,o,n),r=ys(),null===e||va?(no&&r&&eo(t),t.flags|=1,xa(e,t,i,n),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,Ha(e,t,n))}function Ca(e,t,i,r,n){if(Dn(i)){var o=!0;On(t)}else o=!1;if(ko(t,n),null===t.stateNode)Ga(e,t),sa(t,i,r),la(t,i,r,n),r=!0;else if(null===e){var s=t.stateNode,a=t.memoizedProps;s.props=a;var l=s.context,c=i.contextType;"object"===typeof c&&null!==c?c=Io(c):c=In(t,c=Dn(i)?kn:En.current);var u=i.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof s.getSnapshotBeforeUpdate;h||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==r||l!==c)&&aa(t,s,r,c),Oo=!1;var d=t.memoizedState;s.state=d,Go(t,r,s,n),l=t.memoizedState,a!==r||d!==l||Pn.current||Oo?("function"===typeof u&&(ra(t,i,u,r),l=t.memoizedState),(a=Oo||oa(t,i,a,r,d,l,c))?(h||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),s.props=r,s.state=l,s.context=c,r=a):("function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,Bo(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:ia(t.type,a),s.props=c,h=t.pendingProps,d=s.context,"object"===typeof(l=i.contextType)&&null!==l?l=Io(l):l=In(t,l=Dn(i)?kn:En.current);var p=i.getDerivedStateFromProps;(u="function"===typeof p||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==h||d!==l)&&aa(t,s,r,l),Oo=!1,d=t.memoizedState,s.state=d,Go(t,r,s,n);var f=t.memoizedState;a!==h||d!==f||Pn.current||Oo?("function"===typeof p&&(ra(t,i,p,r),f=t.memoizedState),(c=Oo||oa(t,i,c,r,d,f,l)||!1)?(u||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,f,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),s.props=r,s.state=f,s.context=l,r=c):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return Ea(e,t,i,r,o,n)}function Ea(e,t,i,r,n,o){Ma(e,t);var s=0!==(128&t.flags);if(!r&&!s)return n&&Fn(t,i,!1),Ha(e,t,o);r=t.stateNode,_a.current=t;var a=s&&"function"!==typeof i.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=bo(t,e.child,null,o),t.child=bo(t,null,a,o)):xa(e,t,a,o),t.memoizedState=r.state,n&&Fn(t,i,!0),t.child}function Pa(e){var t=e.stateNode;t.pendingContext?Rn(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Rn(0,t.context,!1),Zo(e,t.containerInfo)}function ka(e,t,i,r,n){return fo(),mo(n),t.flags|=256,xa(e,t,i,r),t.child}var Ia,Da,La,Ra,za={dehydrated:null,treeContext:null,retryLane:0};function Oa(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fa(e,t,i){var r,n=t.pendingProps,s=es.current,a=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&s)),r?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),An(es,1&s),null===e)return co(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=n.children,e=n.fallback,a?(n=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&n)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=Oc(l,n,0,null),e=zc(e,n,i,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Oa(i),t.memoizedState=za,e):Ba(t,l));if(null!==(s=e.memoizedState)&&null!==(r=s.dehydrated))return function(e,t,i,r,n,s,a){if(i)return 256&t.flags?(t.flags&=-257,Na(e,t,a,r=ua(Error(o(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=r.fallback,n=t.mode,r=Oc({mode:"visible",children:r.children},n,0,null),(s=zc(s,n,a,null)).flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,0!==(1&t.mode)&&bo(t,e.child,null,a),t.child.memoizedState=Oa(a),t.memoizedState=za,s);if(0===(1&t.mode))return Na(e,t,a,null);if("$!"===n.data){if(r=n.nextSibling&&n.nextSibling.dataset)var l=r.dgst;return r=l,Na(e,t,a,r=ua(s=Error(o(419)),r,void 0))}if(l=0!==(a&e.childLanes),va||l){if(null!==(r=Pl)){switch(a&-a){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}0!==(n=0!==(n&(r.suspendedLanes|a))?0:n)&&n!==s.retryLane&&(s.retryLane=n,zo(e,n),ic(r,e,n,-1))}return mc(),Na(e,t,a,r=ua(Error(o(421))))}return"$?"===n.data?(t.flags|=128,t.child=e.child,t=Cc.bind(null,e),n._reactRetry=t,null):(e=s.treeContext,ro=cn(n.nextSibling),io=t,no=!0,oo=null,null!==e&&(qn[Xn++]=Zn,qn[Xn++]=Kn,qn[Xn++]=Yn,Zn=e.id,Kn=e.overflow,Yn=t),t=Ba(t,r.children),t.flags|=4096,t)}(e,t,l,n,r,s,i);if(a){a=n.fallback,l=t.mode,r=(s=e.child).sibling;var c={mode:"hidden",children:n.children};return 0===(1&l)&&t.child!==s?((n=t.child).childLanes=0,n.pendingProps=c,t.deletions=null):(n=Lc(s,c)).subtreeFlags=14680064&s.subtreeFlags,null!==r?a=Lc(r,a):(a=zc(a,l,i,null)).flags|=2,a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,l=null===(l=e.child.memoizedState)?Oa(i):{baseLanes:l.baseLanes|i,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~i,t.memoizedState=za,n}return e=(a=e.child).sibling,n=Lc(a,{mode:"visible",children:n.children}),0===(1&t.mode)&&(n.lanes=i),n.return=t,n.sibling=null,null!==e&&(null===(i=t.deletions)?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=n,t.memoizedState=null,n}function Ba(e,t){return(t=Oc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Na(e,t,i,r){return null!==r&&mo(r),bo(t,e.child,null,i),(e=Ba(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function ja(e,t,i){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Po(e.return,t,i)}function Va(e,t,i,r,n){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:i,tailMode:n}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=i,o.tailMode=n)}function Ua(e,t,i){var r=t.pendingProps,n=r.revealOrder,o=r.tail;if(xa(e,t,r.children,i),0!==(2&(r=es.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&ja(e,i,t);else if(19===e.tag)ja(e,i,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(An(es,r),0===(1&t.mode))t.memoizedState=null;else switch(n){case"forwards":for(i=t.child,n=null;null!==i;)null!==(e=i.alternate)&&null===ts(e)&&(n=i),i=i.sibling;null===(i=n)?(n=t.child,t.child=null):(n=i.sibling,i.sibling=null),Va(t,!1,n,i,o);break;case"backwards":for(i=null,n=t.child,t.child=null;null!==n;){if(null!==(e=n.alternate)&&null===ts(e)){t.child=n;break}e=n.sibling,n.sibling=i,i=n,n=e}Va(t,!0,i,null,o);break;case"together":Va(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ga(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ha(e,t,i){if(null!==e&&(t.dependencies=e.dependencies),Ol|=t.lanes,0===(i&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(i=Lc(e=t.child,e.pendingProps),t.child=i,i.return=t;null!==e.sibling;)e=e.sibling,(i=i.sibling=Lc(e,e.pendingProps)).return=t;i.sibling=null}return t.child}function Wa(e,t){if(!no)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;null!==t;)null!==t.alternate&&(i=t),t=t.sibling;null===i?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var r=null;null!==i;)null!==i.alternate&&(r=i),i=i.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function $a(e){var t=null!==e.alternate&&e.alternate.child===e.child,i=0,r=0;if(t)for(var n=e.child;null!==n;)i|=n.lanes|n.childLanes,r|=14680064&n.subtreeFlags,r|=14680064&n.flags,n.return=e,n=n.sibling;else for(n=e.child;null!==n;)i|=n.lanes|n.childLanes,r|=n.subtreeFlags,r|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=r,e.childLanes=i,t}function qa(e,t,i){var r=t.pendingProps;switch(to(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $a(t),null;case 1:case 17:return Dn(t.type)&&Ln(),$a(t),null;case 3:return r=t.stateNode,Ko(),Mn(Pn),Mn(En),rs(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ho(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==oo&&(sc(oo),oo=null))),Da(e,t),$a(t),null;case 5:Qo(t);var n=Yo(Xo.current);if(i=t.type,null!==e&&null!=t.stateNode)La(e,t,i,r,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(o(166));return $a(t),null}if(e=Yo($o.current),ho(t)){r=t.stateNode,i=t.type;var s=t.memoizedProps;switch(r[dn]=t,r[pn]=s,e=0!==(1&t.mode),i){case"dialog":Br("cancel",r),Br("close",r);break;case"iframe":case"object":case"embed":Br("load",r);break;case"video":case"audio":for(n=0;n<Rr.length;n++)Br(Rr[n],r);break;case"source":Br("error",r);break;case"img":case"image":case"link":Br("error",r),Br("load",r);break;case"details":Br("toggle",r);break;case"input":Z(r,s),Br("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Br("invalid",r);break;case"textarea":ne(r,s),Br("invalid",r)}for(var l in _e(i,s),n=null,s)if(s.hasOwnProperty(l)){var c=s[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==s.suppressHydrationWarning&&Kr(r.textContent,c,e),n=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==s.suppressHydrationWarning&&Kr(r.textContent,c,e),n=["children",""+c]):a.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Br("scroll",r)}switch(i){case"input":$(r),Q(r,s,!0);break;case"textarea":$(r),se(r);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(r.onclick=Jr)}r=n,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===n.nodeType?n:n.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(i)),"http://www.w3.org/1999/xhtml"===e?"script"===i?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(i,{is:r.is}):(e=l.createElement(i),"select"===i&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,i),e[dn]=t,e[pn]=r,Ia(e,t,!1,!1),t.stateNode=e;e:{switch(l=ve(i,r),i){case"dialog":Br("cancel",e),Br("close",e),n=r;break;case"iframe":case"object":case"embed":Br("load",e),n=r;break;case"video":case"audio":for(n=0;n<Rr.length;n++)Br(Rr[n],e);n=r;break;case"source":Br("error",e),n=r;break;case"img":case"image":case"link":Br("error",e),Br("load",e),n=r;break;case"details":Br("toggle",e),n=r;break;case"input":Z(e,r),n=Y(e,r),Br("invalid",e);break;case"option":default:n=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},n=F({},r,{value:void 0}),Br("invalid",e);break;case"textarea":ne(e,r),n=re(e,r),Br("invalid",e)}for(s in _e(i,n),c=n)if(c.hasOwnProperty(s)){var u=c[s];"style"===s?ge(e,u):"dangerouslySetInnerHTML"===s?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===s?"string"===typeof u?("textarea"!==i||""!==u)&&de(e,u):"number"===typeof u&&de(e,""+u):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(a.hasOwnProperty(s)?null!=u&&"onScroll"===s&&Br("scroll",e):null!=u&&v(e,s,u,l))}switch(i){case"input":$(e),Q(e,r,!1);break;case"textarea":$(e),se(e);break;case"option":null!=r.value&&e.setAttribute("value",""+H(r.value));break;case"select":e.multiple=!!r.multiple,null!=(s=r.value)?ie(e,!!r.multiple,s,!1):null!=r.defaultValue&&ie(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof n.onClick&&(e.onclick=Jr)}switch(i){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return $a(t),null;case 6:if(e&&null!=t.stateNode)Ra(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(o(166));if(i=Yo(Xo.current),Yo($o.current),ho(t)){if(r=t.stateNode,i=t.memoizedProps,r[dn]=t,(s=r.nodeValue!==i)&&null!==(e=io))switch(e.tag){case 3:Kr(r.nodeValue,i,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Kr(r.nodeValue,i,0!==(1&e.mode))}s&&(t.flags|=4)}else(r=(9===i.nodeType?i:i.ownerDocument).createTextNode(r))[dn]=t,t.stateNode=r}return $a(t),null;case 13:if(Mn(es),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(no&&null!==ro&&0!==(1&t.mode)&&0===(128&t.flags))po(),fo(),t.flags|=98560,s=!1;else if(s=ho(t),null!==r&&null!==r.dehydrated){if(null===e){if(!s)throw Error(o(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(o(317));s[dn]=t}else fo(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;$a(t),s=!1}else null!==oo&&(sc(oo),oo=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=i,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&es.current)?0===Rl&&(Rl=3):mc())),null!==t.updateQueue&&(t.flags|=4),$a(t),null);case 4:return Ko(),Da(e,t),null===e&&Vr(t.stateNode.containerInfo),$a(t),null;case 10:return Eo(t.type._context),$a(t),null;case 19:if(Mn(es),null===(s=t.memoizedState))return $a(t),null;if(r=0!==(128&t.flags),null===(l=s.rendering))if(r)Wa(s,!1);else{if(0!==Rl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ts(e))){for(t.flags|=128,Wa(s,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=i,i=t.child;null!==i;)e=r,(s=i).flags&=14680066,null===(l=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return An(es,1&es.current|2),t.child}e=e.sibling}null!==s.tail&&Ke()>Ul&&(t.flags|=128,r=!0,Wa(s,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ts(l))){if(t.flags|=128,r=!0,null!==(i=e.updateQueue)&&(t.updateQueue=i,t.flags|=4),Wa(s,!0),null===s.tail&&"hidden"===s.tailMode&&!l.alternate&&!no)return $a(t),null}else 2*Ke()-s.renderingStartTime>Ul&&1073741824!==i&&(t.flags|=128,r=!0,Wa(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(null!==(i=s.last)?i.sibling=l:t.child=l,s.last=l)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Ke(),t.sibling=null,i=es.current,An(es,r?1&i|2:1&i),t):($a(t),null);case 22:case 23:return hc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Dl)&&($a(t),6&t.subtreeFlags&&(t.flags|=8192)):$a(t),null;case 24:case 25:return null}throw Error(o(156,t.tag))}function Xa(e,t){switch(to(t),t.tag){case 1:return Dn(t.type)&&Ln(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ko(),Mn(Pn),Mn(En),rs(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Qo(t),null;case 13:if(Mn(es),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));fo()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Mn(es),null;case 4:return Ko(),null;case 10:return Eo(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Ia=function(e,t){for(var i=t.child;null!==i;){if(5===i.tag||6===i.tag)e.appendChild(i.stateNode);else if(4!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},Da=function(){},La=function(e,t,i,r){var n=e.memoizedProps;if(n!==r){e=t.stateNode,Yo($o.current);var o,s=null;switch(i){case"input":n=Y(e,n),r=Y(e,r),s=[];break;case"select":n=F({},n,{value:void 0}),r=F({},r,{value:void 0}),s=[];break;case"textarea":n=re(e,n),r=re(e,r),s=[];break;default:"function"!==typeof n.onClick&&"function"===typeof r.onClick&&(e.onclick=Jr)}for(u in _e(i,r),i=null,n)if(!r.hasOwnProperty(u)&&n.hasOwnProperty(u)&&null!=n[u])if("style"===u){var l=n[u];for(o in l)l.hasOwnProperty(o)&&(i||(i={}),i[o]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=n?n[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(i||(i={}),i[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(i||(i={}),i[o]=c[o])}else i||(s||(s=[]),s.push(u,i)),i=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(s=s||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(s=s||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Br("scroll",e),s||l===c||(s=[])):(s=s||[]).push(u,c))}i&&(s=s||[]).push("style",i);var u=s;(t.updateQueue=u)&&(t.flags|=4)}},Ra=function(e,t,i,r){i!==r&&(t.flags|=4)};var Ya=!1,Za=!1,Ka="function"===typeof WeakSet?WeakSet:Set,Ja=null;function Qa(e,t){var i=e.ref;if(null!==i)if("function"===typeof i)try{i(null)}catch(r){Tc(e,t,r)}else i.current=null}function el(e,t,i){try{i()}catch(r){Tc(e,t,r)}}var tl=!1;function il(e,t,i){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var n=r=r.next;do{if((n.tag&e)===e){var o=n.destroy;n.destroy=void 0,void 0!==o&&el(t,i,o)}n=n.next}while(n!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var i=t=t.next;do{if((i.tag&e)===e){var r=i.create;i.destroy=r()}i=i.next}while(i!==t)}}function nl(e){var t=e.ref;if(null!==t){var i=e.stateNode;e.tag,e=i,"function"===typeof t?t(e):t.current=e}}function ol(e){var t=e.alternate;null!==t&&(e.alternate=null,ol(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[dn],delete t[pn],delete t[mn],delete t[gn],delete t[yn])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sl(e){return 5===e.tag||3===e.tag||4===e.tag}function al(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,i){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===i.nodeType?i.parentNode.insertBefore(e,t):i.insertBefore(e,t):(8===i.nodeType?(t=i.parentNode).insertBefore(e,i):(t=i).appendChild(e),null!==(i=i._reactRootContainer)&&void 0!==i||null!==t.onclick||(t.onclick=Jr));else if(4!==r&&null!==(e=e.child))for(ll(e,t,i),e=e.sibling;null!==e;)ll(e,t,i),e=e.sibling}function cl(e,t,i){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?i.insertBefore(e,t):i.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,i),e=e.sibling;null!==e;)cl(e,t,i),e=e.sibling}var ul=null,hl=!1;function dl(e,t,i){for(i=i.child;null!==i;)pl(e,t,i),i=i.sibling}function pl(e,t,i){if(ot&&"function"===typeof ot.onCommitFiberUnmount)try{ot.onCommitFiberUnmount(nt,i)}catch(a){}switch(i.tag){case 5:Za||Qa(i,t);case 6:var r=ul,n=hl;ul=null,dl(e,t,i),hl=n,null!==(ul=r)&&(hl?(e=ul,i=i.stateNode,8===e.nodeType?e.parentNode.removeChild(i):e.removeChild(i)):ul.removeChild(i.stateNode));break;case 18:null!==ul&&(hl?(e=ul,i=i.stateNode,8===e.nodeType?ln(e.parentNode,i):1===e.nodeType&&ln(e,i),Ut(e)):ln(ul,i.stateNode));break;case 4:r=ul,n=hl,ul=i.stateNode.containerInfo,hl=!0,dl(e,t,i),ul=r,hl=n;break;case 0:case 11:case 14:case 15:if(!Za&&(null!==(r=i.updateQueue)&&null!==(r=r.lastEffect))){n=r=r.next;do{var o=n,s=o.destroy;o=o.tag,void 0!==s&&(0!==(2&o)||0!==(4&o))&&el(i,t,s),n=n.next}while(n!==r)}dl(e,t,i);break;case 1:if(!Za&&(Qa(i,t),"function"===typeof(r=i.stateNode).componentWillUnmount))try{r.props=i.memoizedProps,r.state=i.memoizedState,r.componentWillUnmount()}catch(a){Tc(i,t,a)}dl(e,t,i);break;case 21:dl(e,t,i);break;case 22:1&i.mode?(Za=(r=Za)||null!==i.memoizedState,dl(e,t,i),Za=r):dl(e,t,i);break;default:dl(e,t,i)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var i=e.stateNode;null===i&&(i=e.stateNode=new Ka),t.forEach((function(t){var r=Ec.bind(null,e,t);i.has(t)||(i.add(t),t.then(r,r))}))}}function ml(e,t){var i=t.deletions;if(null!==i)for(var r=0;r<i.length;r++){var n=i[r];try{var s=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,hl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===ul)throw Error(o(160));pl(s,a,n),ul=null,hl=!1;var c=n.alternate;null!==c&&(c.return=null),n.return=null}catch(u){Tc(n,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var i=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),yl(e),4&r){try{il(3,e,e.return),rl(3,e)}catch(g){Tc(e,e.return,g)}try{il(5,e,e.return)}catch(g){Tc(e,e.return,g)}}break;case 1:ml(t,e),yl(e),512&r&&null!==i&&Qa(i,i.return);break;case 5:if(ml(t,e),yl(e),512&r&&null!==i&&Qa(i,i.return),32&e.flags){var n=e.stateNode;try{de(n,"")}catch(g){Tc(e,e.return,g)}}if(4&r&&null!=(n=e.stateNode)){var s=e.memoizedProps,a=null!==i?i.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===s.type&&null!=s.name&&K(n,s),ve(l,a);var u=ve(l,s);for(a=0;a<c.length;a+=2){var h=c[a],d=c[a+1];"style"===h?ge(n,d):"dangerouslySetInnerHTML"===h?he(n,d):"children"===h?de(n,d):v(n,h,d,u)}switch(l){case"input":J(n,s);break;case"textarea":oe(n,s);break;case"select":var p=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!s.multiple;var f=s.value;null!=f?ie(n,!!s.multiple,f,!1):p!==!!s.multiple&&(null!=s.defaultValue?ie(n,!!s.multiple,s.defaultValue,!0):ie(n,!!s.multiple,s.multiple?[]:"",!1))}n[pn]=s}catch(g){Tc(e,e.return,g)}}break;case 6:if(ml(t,e),yl(e),4&r){if(null===e.stateNode)throw Error(o(162));n=e.stateNode,s=e.memoizedProps;try{n.nodeValue=s}catch(g){Tc(e,e.return,g)}}break;case 3:if(ml(t,e),yl(e),4&r&&null!==i&&i.memoizedState.isDehydrated)try{Ut(t.containerInfo)}catch(g){Tc(e,e.return,g)}break;case 4:default:ml(t,e),yl(e);break;case 13:ml(t,e),yl(e),8192&(n=e.child).flags&&(s=null!==n.memoizedState,n.stateNode.isHidden=s,!s||null!==n.alternate&&null!==n.alternate.memoizedState||(Vl=Ke())),4&r&&fl(e);break;case 22:if(h=null!==i&&null!==i.memoizedState,1&e.mode?(Za=(u=Za)||h,ml(t,e),Za=u):ml(t,e),yl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!==(1&e.mode))for(Ja=e,h=e.child;null!==h;){for(d=Ja=h;null!==Ja;){switch(f=(p=Ja).child,p.tag){case 0:case 11:case 14:case 15:il(4,p,p.return);break;case 1:Qa(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){r=p,i=p.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Tc(r,i,g)}}break;case 5:Qa(p,p.return);break;case 22:if(null!==p.memoizedState){bl(d);continue}}null!==f?(f.return=p,Ja=f):bl(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{n=d.stateNode,u?"function"===typeof(s=n.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=d.stateNode,a=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",a))}catch(g){Tc(e,e.return,g)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){Tc(e,e.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ml(t,e),yl(e),4&r&&fl(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var i=e.return;null!==i;){if(sl(i)){var r=i;break e}i=i.return}throw Error(o(160))}switch(r.tag){case 5:var n=r.stateNode;32&r.flags&&(de(n,""),r.flags&=-33),cl(e,al(e),n);break;case 3:case 4:var s=r.stateNode.containerInfo;ll(e,al(e),s);break;default:throw Error(o(161))}}catch(a){Tc(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function _l(e,t,i){Ja=e,vl(e,t,i)}function vl(e,t,i){for(var r=0!==(1&e.mode);null!==Ja;){var n=Ja,o=n.child;if(22===n.tag&&r){var s=null!==n.memoizedState||Ya;if(!s){var a=n.alternate,l=null!==a&&null!==a.memoizedState||Za;a=Ya;var c=Za;if(Ya=s,(Za=l)&&!c)for(Ja=n;null!==Ja;)l=(s=Ja).child,22===s.tag&&null!==s.memoizedState?wl(n):null!==l?(l.return=s,Ja=l):wl(n);for(;null!==o;)Ja=o,vl(o,t,i),o=o.sibling;Ja=n,Ya=a,Za=c}xl(e)}else 0!==(8772&n.subtreeFlags)&&null!==o?(o.return=n,Ja=o):xl(e)}}function xl(e){for(;null!==Ja;){var t=Ja;if(0!==(8772&t.flags)){var i=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Za||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Za)if(null===i)r.componentDidMount();else{var n=t.elementType===t.type?i.memoizedProps:ia(t.type,i.memoizedProps);r.componentDidUpdate(n,i.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Ho(t,s,r);break;case 3:var a=t.updateQueue;if(null!==a){if(i=null,null!==t.child)switch(t.child.tag){case 5:case 1:i=t.child.stateNode}Ho(t,a,i)}break;case 5:var l=t.stateNode;if(null===i&&4&t.flags){i=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&i.focus();break;case"img":c.src&&(i.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Ut(d)}}}break;default:throw Error(o(163))}Za||512&t.flags&&nl(t)}catch(p){Tc(t,t.return,p)}}if(t===e){Ja=null;break}if(null!==(i=t.sibling)){i.return=t.return,Ja=i;break}Ja=t.return}}function bl(e){for(;null!==Ja;){var t=Ja;if(t===e){Ja=null;break}var i=t.sibling;if(null!==i){i.return=t.return,Ja=i;break}Ja=t.return}}function wl(e){for(;null!==Ja;){var t=Ja;try{switch(t.tag){case 0:case 11:case 15:var i=t.return;try{rl(4,t)}catch(l){Tc(t,i,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var n=t.return;try{r.componentDidMount()}catch(l){Tc(t,n,l)}}var o=t.return;try{nl(t)}catch(l){Tc(t,o,l)}break;case 5:var s=t.return;try{nl(t)}catch(l){Tc(t,s,l)}}}catch(l){Tc(t,t.return,l)}if(t===e){Ja=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Ja=a;break}Ja=t.return}}var Sl,Tl=Math.ceil,Ml=x.ReactCurrentDispatcher,Al=x.ReactCurrentOwner,Cl=x.ReactCurrentBatchConfig,El=0,Pl=null,kl=null,Il=0,Dl=0,Ll=Tn(0),Rl=0,zl=null,Ol=0,Fl=0,Bl=0,Nl=null,jl=null,Vl=0,Ul=1/0,Gl=null,Hl=!1,Wl=null,$l=null,ql=!1,Xl=null,Yl=0,Zl=0,Kl=null,Jl=-1,Ql=0;function ec(){return 0!==(6&El)?Ke():-1!==Jl?Jl:Jl=Ke()}function tc(e){return 0===(1&e.mode)?1:0!==(2&El)&&0!==Il?Il&-Il:null!==go.transition?(0===Ql&&(Ql=mt()),Ql):0!==(e=vt)?e:e=void 0===(e=window.event)?16:Zt(e.type)}function ic(e,t,i,r){if(50<Zl)throw Zl=0,Kl=null,Error(o(185));yt(e,i,r),0!==(2&El)&&e===Pl||(e===Pl&&(0===(2&El)&&(Fl|=i),4===Rl&&ac(e,Il)),rc(e,r),1===i&&0===El&&0===(1&t.mode)&&(Ul=Ke()+500,Nn&&Un()))}function rc(e,t){var i=e.callbackNode;!function(e,t){for(var i=e.suspendedLanes,r=e.pingedLanes,n=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-st(o),a=1<<s,l=n[s];-1===l?0!==(a&i)&&0===(a&r)||(n[s]=pt(a,t)):l<=t&&(e.expiredLanes|=a),o&=~a}}(e,t);var r=dt(e,e===Pl?Il:0);if(0===r)null!==i&&Xe(i),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=i&&Xe(i),1===t)0===e.tag?function(e){Nn=!0,Vn(e)}(lc.bind(null,e)):Vn(lc.bind(null,e)),sn((function(){0===(6&El)&&Un()})),i=null;else{switch(xt(r)){case 1:i=Qe;break;case 4:i=et;break;case 16:default:i=tt;break;case 536870912:i=rt}i=Pc(i,nc.bind(null,e))}e.callbackPriority=t,e.callbackNode=i}}function nc(e,t){if(Jl=-1,Ql=0,0!==(6&El))throw Error(o(327));var i=e.callbackNode;if(wc()&&e.callbackNode!==i)return null;var r=dt(e,e===Pl?Il:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gc(e,r);else{t=r;var n=El;El|=2;var s=fc();for(Pl===e&&Il===t||(Gl=null,Ul=Ke()+500,dc(e,t));;)try{_c();break}catch(l){pc(e,l)}Co(),Ml.current=s,El=n,null!==kl?t=0:(Pl=null,Il=0,t=Rl)}if(0!==t){if(2===t&&(0!==(n=ft(e))&&(r=n,t=oc(e,n))),1===t)throw i=zl,dc(e,0),ac(e,r),rc(e,Ke()),i;if(6===t)ac(e,r);else{if(n=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var i=t.updateQueue;if(null!==i&&null!==(i=i.stores))for(var r=0;r<i.length;r++){var n=i[r],o=n.getSnapshot;n=n.value;try{if(!sr(o(),n))return!1}catch(a){return!1}}}if(i=t.child,16384&t.subtreeFlags&&null!==i)i.return=t,t=i;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(n)&&(2===(t=gc(e,r))&&(0!==(s=ft(e))&&(r=s,t=oc(e,s))),1===t))throw i=zl,dc(e,0),ac(e,r),rc(e,Ke()),i;switch(e.finishedWork=n,e.finishedLanes=r,t){case 0:case 1:throw Error(o(345));case 2:case 5:bc(e,jl,Gl);break;case 3:if(ac(e,r),(130023424&r)===r&&10<(t=Vl+500-Ke())){if(0!==dt(e,0))break;if(((n=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&n;break}e.timeoutHandle=rn(bc.bind(null,e,jl,Gl),t);break}bc(e,jl,Gl);break;case 4:if(ac(e,r),(4194240&r)===r)break;for(t=e.eventTimes,n=-1;0<r;){var a=31-st(r);s=1<<a,(a=t[a])>n&&(n=a),r&=~s}if(r=n,10<(r=(120>(r=Ke()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Tl(r/1960))-r)){e.timeoutHandle=rn(bc.bind(null,e,jl,Gl),r);break}bc(e,jl,Gl);break;default:throw Error(o(329))}}}return rc(e,Ke()),e.callbackNode===i?nc.bind(null,e):null}function oc(e,t){var i=Nl;return e.current.memoizedState.isDehydrated&&(dc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=jl,jl=i,null!==t&&sc(t)),e}function sc(e){null===jl?jl=e:jl.push.apply(jl,e)}function ac(e,t){for(t&=~Bl,t&=~Fl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var i=31-st(t),r=1<<i;e[i]=-1,t&=~r}}function lc(e){if(0!==(6&El))throw Error(o(327));wc();var t=dt(e,0);if(0===(1&t))return rc(e,Ke()),null;var i=gc(e,t);if(0!==e.tag&&2===i){var r=ft(e);0!==r&&(t=r,i=oc(e,r))}if(1===i)throw i=zl,dc(e,0),ac(e,t),rc(e,Ke()),i;if(6===i)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,bc(e,jl,Gl),rc(e,Ke()),null}function cc(e,t){var i=El;El|=1;try{return e(t)}finally{0===(El=i)&&(Ul=Ke()+500,Nn&&Un())}}function uc(e){null!==Xl&&0===Xl.tag&&0===(6&El)&&wc();var t=El;El|=1;var i=Cl.transition,r=vt;try{if(Cl.transition=null,vt=1,e)return e()}finally{vt=r,Cl.transition=i,0===(6&(El=t))&&Un()}}function hc(){Dl=Ll.current,Mn(Ll)}function dc(e,t){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(-1!==i&&(e.timeoutHandle=-1,nn(i)),null!==kl)for(i=kl.return;null!==i;){var r=i;switch(to(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ln();break;case 3:Ko(),Mn(Pn),Mn(En),rs();break;case 5:Qo(r);break;case 4:Ko();break;case 13:case 19:Mn(es);break;case 10:Eo(r.type._context);break;case 22:case 23:hc()}i=i.return}if(Pl=e,kl=e=Lc(e.current,null),Il=Dl=t,Rl=0,zl=null,Bl=Fl=Ol=0,jl=Nl=null,null!==Do){for(t=0;t<Do.length;t++)if(null!==(r=(i=Do[t]).interleaved)){i.interleaved=null;var n=r.next,o=i.pending;if(null!==o){var s=o.next;o.next=n,r.next=s}i.pending=r}Do=null}return e}function pc(e,t){for(;;){var i=kl;try{if(Co(),ns.current=Js,us){for(var r=as.memoizedState;null!==r;){var n=r.queue;null!==n&&(n.pending=null),r=r.next}us=!1}if(ss=0,cs=ls=as=null,hs=!1,ds=0,Al.current=null,null===i||null===i.return){Rl=1,zl=t,kl=null;break}e:{var s=e,a=i.return,l=i,c=t;if(t=Il,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=ga(a);if(null!==f){f.flags&=-257,ya(f,a,l,0,t),1&f.mode&&ma(s,u,t),c=u;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){ma(s,u,t),mc();break e}c=Error(o(426))}else if(no&&1&l.mode){var y=ga(a);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),ya(y,a,l,0,t),mo(ca(c,l));break e}}s=c=ca(c,l),4!==Rl&&(Rl=2),null===Nl?Nl=[s]:Nl.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Uo(s,pa(0,c,t));break e;case 1:l=c;var _=s.type,v=s.stateNode;if(0===(128&s.flags)&&("function"===typeof _.getDerivedStateFromError||null!==v&&"function"===typeof v.componentDidCatch&&(null===$l||!$l.has(v)))){s.flags|=65536,t&=-t,s.lanes|=t,Uo(s,fa(s,l,t));break e}}s=s.return}while(null!==s)}xc(i)}catch(x){t=x,kl===i&&null!==i&&(kl=i=i.return);continue}break}}function fc(){var e=Ml.current;return Ml.current=Js,null===e?Js:e}function mc(){0!==Rl&&3!==Rl&&2!==Rl||(Rl=4),null===Pl||0===(268435455&Ol)&&0===(268435455&Fl)||ac(Pl,Il)}function gc(e,t){var i=El;El|=2;var r=fc();for(Pl===e&&Il===t||(Gl=null,dc(e,t));;)try{yc();break}catch(n){pc(e,n)}if(Co(),El=i,Ml.current=r,null!==kl)throw Error(o(261));return Pl=null,Il=0,Rl}function yc(){for(;null!==kl;)vc(kl)}function _c(){for(;null!==kl&&!Ye();)vc(kl)}function vc(e){var t=Sl(e.alternate,e,Dl);e.memoizedProps=e.pendingProps,null===t?xc(e):kl=t,Al.current=null}function xc(e){var t=e;do{var i=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(i=qa(i,t,Dl)))return void(kl=i)}else{if(null!==(i=Xa(i,t)))return i.flags&=32767,void(kl=i);if(null===e)return Rl=6,void(kl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(kl=t);kl=t=e}while(null!==t);0===Rl&&(Rl=5)}function bc(e,t,i){var r=vt,n=Cl.transition;try{Cl.transition=null,vt=1,function(e,t,i,r){do{wc()}while(null!==Xl);if(0!==(6&El))throw Error(o(327));i=e.finishedWork;var n=e.finishedLanes;if(null===i)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var s=i.lanes|i.childLanes;if(function(e,t){var i=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<i;){var n=31-st(i),o=1<<n;t[n]=0,r[n]=-1,e[n]=-1,i&=~o}}(e,s),e===Pl&&(kl=Pl=null,Il=0),0===(2064&i.subtreeFlags)&&0===(2064&i.flags)||ql||(ql=!0,Pc(tt,(function(){return wc(),null}))),s=0!==(15990&i.flags),0!==(15990&i.subtreeFlags)||s){s=Cl.transition,Cl.transition=null;var a=vt;vt=1;var l=El;El|=4,Al.current=null,function(e,t){if(Qr=Ht,dr(e=hr())){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(i=(i=e.ownerDocument)&&i.defaultView||window).getSelection&&i.getSelection();if(r&&0!==r.rangeCount){i=r.anchorNode;var n=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{i.nodeType,s.nodeType}catch(b){i=null;break e}var a=0,l=-1,c=-1,u=0,h=0,d=e,p=null;t:for(;;){for(var f;d!==i||0!==n&&3!==d.nodeType||(l=a+n),d!==s||0!==r&&3!==d.nodeType||(c=a+r),3===d.nodeType&&(a+=d.nodeValue.length),null!==(f=d.firstChild);)p=d,d=f;for(;;){if(d===e)break t;if(p===i&&++u===n&&(l=a),p===s&&++h===r&&(c=a),null!==(f=d.nextSibling))break;p=(d=p).parentNode}d=f}i=-1===l||-1===c?null:{start:l,end:c}}else i=null}i=i||{start:0,end:0}}else i=null;for(en={focusedElem:e,selectionRange:i},Ht=!1,Ja=t;null!==Ja;)if(e=(t=Ja).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Ja=e;else for(;null!==Ja;){t=Ja;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,y=m.memoizedState,_=t.stateNode,v=_.getSnapshotBeforeUpdate(t.elementType===t.type?g:ia(t.type,g),y);_.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(o(163))}}catch(b){Tc(t,t.return,b)}if(null!==(e=t.sibling)){e.return=t.return,Ja=e;break}Ja=t.return}m=tl,tl=!1}(e,i),gl(i,e),pr(en),Ht=!!Qr,en=Qr=null,e.current=i,_l(i,e,n),Ze(),El=l,vt=a,Cl.transition=s}else e.current=i;if(ql&&(ql=!1,Xl=e,Yl=n),s=e.pendingLanes,0===s&&($l=null),function(e){if(ot&&"function"===typeof ot.onCommitFiberRoot)try{ot.onCommitFiberRoot(nt,e,void 0,128===(128&e.current.flags))}catch(t){}}(i.stateNode),rc(e,Ke()),null!==t)for(r=e.onRecoverableError,i=0;i<t.length;i++)n=t[i],r(n.value,{componentStack:n.stack,digest:n.digest});if(Hl)throw Hl=!1,e=Wl,Wl=null,e;0!==(1&Yl)&&0!==e.tag&&wc(),s=e.pendingLanes,0!==(1&s)?e===Kl?Zl++:(Zl=0,Kl=e):Zl=0,Un()}(e,t,i,r)}finally{Cl.transition=n,vt=r}return null}function wc(){if(null!==Xl){var e=xt(Yl),t=Cl.transition,i=vt;try{if(Cl.transition=null,vt=16>e?16:e,null===Xl)var r=!1;else{if(e=Xl,Xl=null,Yl=0,0!==(6&El))throw Error(o(331));var n=El;for(El|=4,Ja=e.current;null!==Ja;){var s=Ja,a=s.child;if(0!==(16&Ja.flags)){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Ja=u;null!==Ja;){var h=Ja;switch(h.tag){case 0:case 11:case 15:il(8,h,s)}var d=h.child;if(null!==d)d.return=h,Ja=d;else for(;null!==Ja;){var p=(h=Ja).sibling,f=h.return;if(ol(h),h===u){Ja=null;break}if(null!==p){p.return=f,Ja=p;break}Ja=f}}}var m=s.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}Ja=s}}if(0!==(2064&s.subtreeFlags)&&null!==a)a.return=s,Ja=a;else e:for(;null!==Ja;){if(0!==(2048&(s=Ja).flags))switch(s.tag){case 0:case 11:case 15:il(9,s,s.return)}var _=s.sibling;if(null!==_){_.return=s.return,Ja=_;break e}Ja=s.return}}var v=e.current;for(Ja=v;null!==Ja;){var x=(a=Ja).child;if(0!==(2064&a.subtreeFlags)&&null!==x)x.return=a,Ja=x;else e:for(a=v;null!==Ja;){if(0!==(2048&(l=Ja).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(w){Tc(l,l.return,w)}if(l===a){Ja=null;break e}var b=l.sibling;if(null!==b){b.return=l.return,Ja=b;break e}Ja=l.return}}if(El=n,Un(),ot&&"function"===typeof ot.onPostCommitFiberRoot)try{ot.onPostCommitFiberRoot(nt,e)}catch(w){}r=!0}return r}finally{vt=i,Cl.transition=t}}return!1}function Sc(e,t,i){e=jo(e,t=pa(0,t=ca(i,t),1),1),t=ec(),null!==e&&(yt(e,1,t),rc(e,t))}function Tc(e,t,i){if(3===e.tag)Sc(e,e,i);else for(;null!==t;){if(3===t.tag){Sc(t,e,i);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===$l||!$l.has(r))){t=jo(t,e=fa(t,e=ca(i,e),1),1),e=ec(),null!==t&&(yt(t,1,e),rc(t,e));break}}t=t.return}}function Mc(e,t,i){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&i,Pl===e&&(Il&i)===i&&(4===Rl||3===Rl&&(130023424&Il)===Il&&500>Ke()-Vl?dc(e,0):Bl|=i),rc(e,t)}function Ac(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var i=ec();null!==(e=zo(e,t))&&(yt(e,t,i),rc(e,i))}function Cc(e){var t=e.memoizedState,i=0;null!==t&&(i=t.retryLane),Ac(e,i)}function Ec(e,t){var i=0;switch(e.tag){case 13:var r=e.stateNode,n=e.memoizedState;null!==n&&(i=n.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(o(314))}null!==r&&r.delete(t),Ac(e,i)}function Pc(e,t){return qe(e,t)}function kc(e,t,i,r){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ic(e,t,i,r){return new kc(e,t,i,r)}function Dc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Lc(e,t){var i=e.alternate;return null===i?((i=Ic(e.tag,t,e.key,e.mode)).elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=14680064&e.flags,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function Rc(e,t,i,r,n,s){var a=2;if(r=e,"function"===typeof e)Dc(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case S:return zc(i.children,n,s,t);case T:a=8,n|=8;break;case M:return(e=Ic(12,i,t,2|n)).elementType=M,e.lanes=s,e;case P:return(e=Ic(13,i,t,n)).elementType=P,e.lanes=s,e;case k:return(e=Ic(19,i,t,n)).elementType=k,e.lanes=s,e;case L:return Oc(i,n,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case A:a=10;break e;case C:a=9;break e;case E:a=11;break e;case I:a=14;break e;case D:a=16,r=null;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Ic(a,i,t,n)).elementType=e,t.type=r,t.lanes=s,t}function zc(e,t,i,r){return(e=Ic(7,e,r,t)).lanes=i,e}function Oc(e,t,i,r){return(e=Ic(22,e,r,t)).elementType=L,e.lanes=i,e.stateNode={isHidden:!1},e}function Fc(e,t,i){return(e=Ic(6,e,null,t)).lanes=i,e}function Bc(e,t,i){return(t=Ic(4,null!==e.children?e.children:[],e.key,t)).lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Nc(e,t,i,r,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function jc(e,t,i,r,n,o,s,a,l){return e=new Nc(e,t,i,a,l),1===t?(t=1,!0===o&&(t|=8)):t=0,o=Ic(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fo(o),e}function Vc(e){if(!e)return Cn;e:{if(Ue(e=e._reactInternals)!==e||1!==e.tag)throw Error(o(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Dn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(o(171))}if(1===e.tag){var i=e.type;if(Dn(i))return zn(e,i,t)}return t}function Uc(e,t,i,r,n,o,s,a,l){return(e=jc(i,r,!0,e,0,o,0,a,l)).context=Vc(null),i=e.current,(o=No(r=ec(),n=tc(i))).callback=void 0!==t&&null!==t?t:null,jo(i,o,n),e.current.lanes=n,yt(e,n,r),rc(e,r),e}function Gc(e,t,i,r){var n=t.current,o=ec(),s=tc(n);return i=Vc(i),null===t.context?t.context=i:t.pendingContext=i,(t=No(o,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=jo(n,t,s))&&(ic(e,n,s,o),Vo(e,n,s)),s}function Hc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Wc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var i=e.retryLane;e.retryLane=0!==i&&i<t?i:t}}function $c(e,t){Wc(e,t),(e=e.alternate)&&Wc(e,t)}Sl=function(e,t,i){if(null!==e)if(e.memoizedProps!==t.pendingProps||Pn.current)va=!0;else{if(0===(e.lanes&i)&&0===(128&t.flags))return va=!1,function(e,t,i){switch(t.tag){case 3:Pa(t),fo();break;case 5:Jo(t);break;case 1:Dn(t.type)&&On(t);break;case 4:Zo(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,n=t.memoizedProps.value;An(So,r._currentValue),r._currentValue=n;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(An(es,1&es.current),t.flags|=128,null):0!==(i&t.child.childLanes)?Fa(e,t,i):(An(es,1&es.current),null!==(e=Ha(e,t,i))?e.sibling:null);An(es,1&es.current);break;case 19:if(r=0!==(i&t.childLanes),0!==(128&e.flags)){if(r)return Ua(e,t,i);t.flags|=128}if(null!==(n=t.memoizedState)&&(n.rendering=null,n.tail=null,n.lastEffect=null),An(es,es.current),r)break;return null;case 22:case 23:return t.lanes=0,Ta(e,t,i)}return Ha(e,t,i)}(e,t,i);va=0!==(131072&e.flags)}else va=!1,no&&0!==(1048576&t.flags)&&Qn(t,$n,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ga(e,t),e=t.pendingProps;var n=In(t,En.current);ko(t,i),n=gs(null,t,r,e,n,i);var s=ys();return t.flags|=1,"object"===typeof n&&null!==n&&"function"===typeof n.render&&void 0===n.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Dn(r)?(s=!0,On(t)):s=!1,t.memoizedState=null!==n.state&&void 0!==n.state?n.state:null,Fo(t),n.updater=na,t.stateNode=n,n._reactInternals=t,la(t,r,e,i),t=Ea(null,t,r,!0,s,i)):(t.tag=0,no&&s&&eo(t),xa(null,t,n,i),t=t.child),t;case 16:r=t.elementType;e:{switch(Ga(e,t),e=t.pendingProps,r=(n=r._init)(r._payload),t.type=r,n=t.tag=function(e){if("function"===typeof e)return Dc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===E)return 11;if(e===I)return 14}return 2}(r),e=ia(r,e),n){case 0:t=Aa(null,t,r,e,i);break e;case 1:t=Ca(null,t,r,e,i);break e;case 11:t=ba(null,t,r,e,i);break e;case 14:t=wa(null,t,r,ia(r.type,e),i);break e}throw Error(o(306,r,""))}return t;case 0:return r=t.type,n=t.pendingProps,Aa(e,t,r,n=t.elementType===r?n:ia(r,n),i);case 1:return r=t.type,n=t.pendingProps,Ca(e,t,r,n=t.elementType===r?n:ia(r,n),i);case 3:e:{if(Pa(t),null===e)throw Error(o(387));r=t.pendingProps,n=(s=t.memoizedState).element,Bo(e,t),Go(t,r,null,i);var a=t.memoizedState;if(r=a.element,s.isDehydrated){if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=ka(e,t,r,i,n=ca(Error(o(423)),t));break e}if(r!==n){t=ka(e,t,r,i,n=ca(Error(o(424)),t));break e}for(ro=cn(t.stateNode.containerInfo.firstChild),io=t,no=!0,oo=null,i=wo(t,null,r,i),t.child=i;i;)i.flags=-3&i.flags|4096,i=i.sibling}else{if(fo(),r===n){t=Ha(e,t,i);break e}xa(e,t,r,i)}t=t.child}return t;case 5:return Jo(t),null===e&&co(t),r=t.type,n=t.pendingProps,s=null!==e?e.memoizedProps:null,a=n.children,tn(r,n)?a=null:null!==s&&tn(r,s)&&(t.flags|=32),Ma(e,t),xa(e,t,a,i),t.child;case 6:return null===e&&co(t),null;case 13:return Fa(e,t,i);case 4:return Zo(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=bo(t,null,r,i):xa(e,t,r,i),t.child;case 11:return r=t.type,n=t.pendingProps,ba(e,t,r,n=t.elementType===r?n:ia(r,n),i);case 7:return xa(e,t,t.pendingProps,i),t.child;case 8:case 12:return xa(e,t,t.pendingProps.children,i),t.child;case 10:e:{if(r=t.type._context,n=t.pendingProps,s=t.memoizedProps,a=n.value,An(So,r._currentValue),r._currentValue=a,null!==s)if(sr(s.value,a)){if(s.children===n.children&&!Pn.current){t=Ha(e,t,i);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){a=s.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===s.tag){(c=No(-1,i&-i)).tag=2;var u=s.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}s.lanes|=i,null!==(c=s.alternate)&&(c.lanes|=i),Po(s.return,i,t),l.lanes|=i;break}c=c.next}}else if(10===s.tag)a=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(a=s.return))throw Error(o(341));a.lanes|=i,null!==(l=a.alternate)&&(l.lanes|=i),Po(a,i,t),a=s.sibling}else a=s.child;if(null!==a)a.return=s;else for(a=s;null!==a;){if(a===t){a=null;break}if(null!==(s=a.sibling)){s.return=a.return,a=s;break}a=a.return}s=a}xa(e,t,n.children,i),t=t.child}return t;case 9:return n=t.type,r=t.pendingProps.children,ko(t,i),r=r(n=Io(n)),t.flags|=1,xa(e,t,r,i),t.child;case 14:return n=ia(r=t.type,t.pendingProps),wa(e,t,r,n=ia(r.type,n),i);case 15:return Sa(e,t,t.type,t.pendingProps,i);case 17:return r=t.type,n=t.pendingProps,n=t.elementType===r?n:ia(r,n),Ga(e,t),t.tag=1,Dn(r)?(e=!0,On(t)):e=!1,ko(t,i),sa(t,r,n),la(t,r,n,i),Ea(null,t,r,!0,e,i);case 19:return Ua(e,t,i);case 22:return Ta(e,t,i)}throw Error(o(156,t.tag))};var qc="function"===typeof reportError?reportError:function(e){console.error(e)};function Xc(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function Zc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Kc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Jc(){}function Qc(e,t,i,r,n){var o=i._reactRootContainer;if(o){var s=o;if("function"===typeof n){var a=n;n=function(){var e=Hc(s);a.call(e)}}Gc(t,s,e,n)}else s=function(e,t,i,r,n){if(n){if("function"===typeof r){var o=r;r=function(){var e=Hc(s);o.call(e)}}var s=Uc(t,r,e,0,null,!1,0,"",Jc);return e._reactRootContainer=s,e[fn]=s.current,Vr(8===e.nodeType?e.parentNode:e),uc(),s}for(;n=e.lastChild;)e.removeChild(n);if("function"===typeof r){var a=r;r=function(){var e=Hc(l);a.call(e)}}var l=jc(e,0,!1,null,0,!1,0,"",Jc);return e._reactRootContainer=l,e[fn]=l.current,Vr(8===e.nodeType?e.parentNode:e),uc((function(){Gc(t,l,i,r)})),l}(i,t,e,n,r);return Hc(s)}Yc.prototype.render=Xc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));Gc(e,t,null,null)},Yc.prototype.unmount=Xc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc((function(){Gc(null,e,null,null)})),t[fn]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Tt();e={blockedOn:null,target:e,priority:t};for(var i=0;i<Lt.length&&0!==t&&t<Lt[i].priority;i++);Lt.splice(i,0,e),0===i&&Ft(e)}},bt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var i=ht(t.pendingLanes);0!==i&&(_t(t,1|i),rc(t,Ke()),0===(6&El)&&(Ul=Ke()+500,Un()))}break;case 13:uc((function(){var t=zo(e,1);if(null!==t){var i=ec();ic(t,e,1,i)}})),$c(e,1)}},wt=function(e){if(13===e.tag){var t=zo(e,134217728);if(null!==t)ic(t,e,134217728,ec());$c(e,134217728)}},St=function(e){if(13===e.tag){var t=tc(e),i=zo(e,t);if(null!==i)ic(i,e,t,ec());$c(e,t)}},Tt=function(){return vt},Mt=function(e,t){var i=vt;try{return vt=e,t()}finally{vt=i}},we=function(e,t,i){switch(t){case"input":if(J(e,i),t=i.name,"radio"===i.type&&null!=t){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<i.length;t++){var r=i[t];if(r!==e&&r.form===e.form){var n=bn(r);if(!n)throw Error(o(90));q(r),J(r,n)}}}break;case"textarea":oe(e,i);break;case"select":null!=(t=i.value)&&ie(e,!!i.multiple,t,!1)}},Ee=cc,Pe=uc;var eu={usingClientEntryPoint:!1,Events:[vn,xn,bn,Ae,Ce,cc]},tu={findFiberByHostInstance:_n,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},iu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{nt=ru.inject(iu),ot=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Zc(t))throw Error(o(200));return function(e,t,i){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==r?null:""+r,children:e,containerInfo:t,implementation:i}}(e,t,null,i)},t.createRoot=function(e,t){if(!Zc(e))throw Error(o(299));var i=!1,r="",n=qc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(i=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(n=t.onRecoverableError)),t=jc(e,1,!1,null,0,i,0,r,n),e[fn]=t.current,Vr(8===e.nodeType?e.parentNode:e),new Xc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,i){if(!Kc(t))throw Error(o(200));return Qc(null,e,t,!0,i)},t.hydrateRoot=function(e,t,i){if(!Zc(e))throw Error(o(405));var r=null!=i&&i.hydratedSources||null,n=!1,s="",a=qc;if(null!==i&&void 0!==i&&(!0===i.unstable_strictMode&&(n=!0),void 0!==i.identifierPrefix&&(s=i.identifierPrefix),void 0!==i.onRecoverableError&&(a=i.onRecoverableError)),t=Uc(t,null,e,1,null!=i?i:null,n,0,s,a),e[fn]=t.current,Vr(e),r)for(e=0;e<r.length;e++)n=(n=(i=r[e])._getVersion)(i._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[i,n]:t.mutableSourceEagerHydrationData.push(i,n);return new Yc(t)},t.render=function(e,t,i){if(!Kc(t))throw Error(o(200));return Qc(null,e,t,!1,i)},t.unmountComponentAtNode=function(e){if(!Kc(e))throw Error(o(40));return!!e._reactRootContainer&&(uc((function(){Qc(null,null,e,!1,(function(){e._reactRootContainer=null,e[fn]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,i,r){if(!Kc(i))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return Qc(e,t,i,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},3048:(e,t,i)=>{var r,n,o;o=function(e){"use strict";var t=e?e._modules:{};function i(t,i,r,n){t.hasOwnProperty(i)||(t[i]=n.apply(null,r),"function"==typeof CustomEvent&&e.win.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:i,module:t[i]}})))}i(t,"Extensions/Pane/PaneComposition.js",[t["Core/Utilities.js"]],(function(e){let{addEvent:t,correctFloat:i,defined:r,pick:n}=e;function o(e){let t,i=this;return e&&i.pane.forEach((r=>{s(e.chartX-i.plotLeft,e.chartY-i.plotTop,r.center)&&(t=r)})),t}function s(e,t,n,o,s){let a=!0,l=n[0],c=n[1],u=Math.sqrt(Math.pow(e-l,2)+Math.pow(t-c,2));if(r(o)&&r(s)){let r=Math.atan2(i(t-c,8),i(e-l,8));s!==o&&(a=o>s?r>=o&&r<=Math.PI||r<=s&&r>=-Math.PI:r>=o&&r<=i(s,8))}return u<=Math.ceil(n[2]/2)&&a}function a(e){this.polar&&(e.options.inverted&&([e.x,e.y]=[e.y,e.x]),e.isInsidePlot=this.pane.some((t=>s(e.x,e.y,t.center,t.axis&&t.axis.normalizedStartAngleRad,t.axis&&t.axis.normalizedEndAngleRad))))}function l(e){let t=this.chart;e.hoverPoint&&e.hoverPoint.plotX&&e.hoverPoint.plotY&&t.hoverPane&&!s(e.hoverPoint.plotX,e.hoverPoint.plotY,t.hoverPane.center)&&(e.hoverPoint=void 0)}function c(e){let t=this.chart;t.polar?(t.hoverPane=t.getHoverPane(e),e.filter=function(i){return i.visible&&!(!e.shared&&i.directTouch)&&n(i.options.enableMouseTracking,!0)&&(!t.hoverPane||i.xAxis.pane===t.hoverPane)}):t.hoverPane=void 0}return{compose:function(e,i){let r=e.prototype;r.getHoverPane||(r.collectionsWithUpdate.push("pane"),r.getHoverPane=o,t(e,"afterIsInsidePlot",a),t(i,"afterGetHoverData",l),t(i,"beforeGetHoverData",c))}}})),i(t,"Extensions/Pane/PaneDefaults.js",[],(function(){return{pane:{center:["50%","50%"],size:"85%",innerSize:"0%",startAngle:0},background:{shape:"circle",borderRadius:0,borderWidth:1,borderColor:"#cccccc",backgroundColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#ffffff"],[1,"#e6e6e6"]]},from:-Number.MAX_VALUE,innerRadius:0,to:Number.MAX_VALUE,outerRadius:"105%"}}})),i(t,"Extensions/Pane/Pane.js",[t["Series/CenteredUtilities.js"],t["Extensions/Pane/PaneComposition.js"],t["Extensions/Pane/PaneDefaults.js"],t["Core/Utilities.js"]],(function(e,t,i,r){let{extend:n,merge:o,splat:s}=r;class a{constructor(e,t){this.coll="pane",this.init(e,t)}init(e,t){this.chart=t,this.background=[],t.pane.push(this),this.setOptions(e)}setOptions(e){this.options=e=o(i.pane,this.chart.angular?{background:{}}:void 0,e)}render(){let e=this.options,t=this.chart.renderer;this.group||(this.group=t.g("pane-group").attr({zIndex:e.zIndex||0}).add()),this.updateCenter();let r=this.options.background;if(r){let e=Math.max((r=s(r)).length,this.background.length||0);for(let t=0;t<e;t++)r[t]&&this.axis?this.renderBackground(o(i.background,r[t]),t):this.background[t]&&(this.background[t]=this.background[t].destroy(),this.background.splice(t,1))}}renderBackground(e,t){let i={class:"highcharts-pane "+(e.className||"")},r="animate";this.chart.styledMode||n(i,{fill:e.backgroundColor,stroke:e.borderColor,"stroke-width":e.borderWidth}),this.background[t]||(this.background[t]=this.chart.renderer.path().add(this.group),r="attr"),this.background[t][r]({d:this.axis.getPlotBandPath(e.from,e.to,e)}).attr(i)}updateCenter(t){this.center=(t||this.axis||{}).center=e.getCenter.call(this)}update(e,t){o(!0,this.options,e),this.setOptions(this.options),this.render(),this.chart.axes.forEach((function(e){e.pane===this&&(e.pane=null,e.update({},t))}),this)}}return a.compose=t.compose,a})),i(t,"Series/AreaRange/AreaRangePoint.js",[t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],(function(e,t){let{area:{prototype:{pointClass:i,pointClass:{prototype:r}}}}=e.seriesTypes,{defined:n,isNumber:o}=t;return class extends i{setState(){let e=this.state,t=this.series,i=t.chart.polar;n(this.plotHigh)||(this.plotHigh=t.yAxis.toPixels(this.high,!0)),n(this.plotLow)||(this.plotLow=this.plotY=t.yAxis.toPixels(this.low,!0)),t.lowerStateMarkerGraphic=t.stateMarkerGraphic,t.stateMarkerGraphic=t.upperStateMarkerGraphic,this.graphic=this.graphics&&this.graphics[1],this.plotY=this.plotHigh,i&&o(this.plotHighX)&&(this.plotX=this.plotHighX),r.setState.apply(this,arguments),this.state=e,this.plotY=this.plotLow,this.graphic=this.graphics&&this.graphics[0],i&&o(this.plotLowX)&&(this.plotX=this.plotLowX),t.upperStateMarkerGraphic=t.stateMarkerGraphic,t.stateMarkerGraphic=t.lowerStateMarkerGraphic,t.lowerStateMarkerGraphic=void 0;let s=t.modifyMarkerSettings();r.setState.apply(this,arguments),t.restoreMarkerSettings(s)}haloPath(){let e=this.series.chart.polar,t=[];return this.plotY=this.plotLow,e&&o(this.plotLowX)&&(this.plotX=this.plotLowX),this.isInside&&(t=r.haloPath.apply(this,arguments)),this.plotY=this.plotHigh,e&&o(this.plotHighX)&&(this.plotX=this.plotHighX),this.isTopInside&&(t=t.concat(r.haloPath.apply(this,arguments))),t}isValid(){return o(this.low)&&o(this.high)}}})),i(t,"Series/AreaRange/AreaRangeSeries.js",[t["Series/AreaRange/AreaRangePoint.js"],t["Core/Globals.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],(function(e,t,i,r){let{noop:n}=t,{area:o,area:{prototype:s},column:{prototype:a}}=i.seriesTypes,{addEvent:l,defined:c,extend:u,isArray:h,isNumber:d,pick:p,merge:f}=r;class m extends o{toYData(e){return[e.low,e.high]}highToXY(e){let t=this.chart,i=this.xAxis.postTranslate(e.rectPlotX||0,this.yAxis.len-(e.plotHigh||0));e.plotHighX=i.x-t.plotLeft,e.plotHigh=i.y-t.plotTop,e.plotLowX=e.plotX}getGraphPath(e){let t,i,r,n=[],o=[],a=s.getGraphPath,l=this.options,c=this.chart.polar,u=c&&!1!==l.connectEnds,h=l.connectNulls,d=l.step;for(t=(e=e||this.points).length;t--;){i=e[t];let s=c?{plotX:i.rectPlotX,plotY:i.yBottom,doCurve:!1}:{plotX:i.plotX,plotY:i.plotY,doCurve:!1};i.isNull||u||h||e[t+1]&&!e[t+1].isNull||o.push(s),r={polarPlotY:i.polarPlotY,rectPlotX:i.rectPlotX,yBottom:i.yBottom,plotX:p(i.plotHighX,i.plotX),plotY:i.plotHigh,isNull:i.isNull},o.push(r),n.push(r),i.isNull||u||h||e[t-1]&&!e[t-1].isNull||o.push(s)}let f=a.call(this,e);d&&(!0===d&&(d="left"),l.step={left:"right",center:"center",right:"left"}[d]);let m=a.call(this,n),g=a.call(this,o);l.step=d;let y=[].concat(f,m);return!this.chart.polar&&g[0]&&"M"===g[0][0]&&(g[0]=["L",g[0][1],g[0][2]]),this.graphPath=y,this.areaPath=f.concat(g),y.isArea=!0,y.xMap=f.xMap,this.areaPath.xMap=f.xMap,y}drawDataLabels(){let e,t,i,r,n,o=this.points,a=o.length,l=[],c=this.options.dataLabels,d=this.chart.inverted;if(c){if(h(c)?(r=c[0]||{enabled:!1},n=c[1]||{enabled:!1}):((r=u({},c)).x=c.xHigh,r.y=c.yHigh,(n=u({},c)).x=c.xLow,n.y=c.yLow),r.enabled||this.hasDataLabels?.()){for(e=a;e--;)if(t=o[e]){let{plotHigh:n=0,plotLow:o=0}=t;i=r.inside?n<o:n>o,t.y=t.high,t._plotY=t.plotY,t.plotY=n,l[e]=t.dataLabel,t.dataLabel=t.dataLabelUpper,t.below=i,d?r.align||(r.align=i?"right":"left"):r.verticalAlign||(r.verticalAlign=i?"top":"bottom")}for(this.options.dataLabels=r,s.drawDataLabels&&s.drawDataLabels.apply(this,arguments),e=a;e--;)(t=o[e])&&(t.dataLabelUpper=t.dataLabel,t.dataLabel=l[e],delete t.dataLabels,t.y=t.low,t.plotY=t._plotY)}if(n.enabled||this.hasDataLabels?.()){for(e=a;e--;)if(t=o[e]){let{plotHigh:e=0,plotLow:r=0}=t;i=n.inside?e<r:e>r,t.below=!i,d?n.align||(n.align=i?"left":"right"):n.verticalAlign||(n.verticalAlign=i?"bottom":"top")}this.options.dataLabels=n,s.drawDataLabels&&s.drawDataLabels.apply(this,arguments)}if(r.enabled)for(e=a;e--;)(t=o[e])&&(t.dataLabels=[t.dataLabelUpper,t.dataLabel].filter((function(e){return!!e})));this.options.dataLabels=c}}alignDataLabel(){a.alignDataLabel.apply(this,arguments)}modifyMarkerSettings(){let e={marker:this.options.marker,symbol:this.symbol};if(this.options.lowMarker){let{options:{marker:e,lowMarker:t}}=this;this.options.marker=f(e,t),t.symbol&&(this.symbol=t.symbol)}return e}restoreMarkerSettings(e){this.options.marker=e.marker,this.symbol=e.symbol}drawPoints(){let e,t,i=this.points.length,r=this.modifyMarkerSettings();for(s.drawPoints.apply(this,arguments),this.restoreMarkerSettings(r),e=0;e<i;)(t=this.points[e]).graphics=t.graphics||[],t.origProps={plotY:t.plotY,plotX:t.plotX,isInside:t.isInside,negative:t.negative,zone:t.zone,y:t.y},(t.graphic||t.graphics[0])&&(t.graphics[0]=t.graphic),t.graphic=t.graphics[1],t.plotY=t.plotHigh,c(t.plotHighX)&&(t.plotX=t.plotHighX),t.y=p(t.high,t.origProps.y),t.negative=t.y<(this.options.threshold||0),this.zones.length&&(t.zone=t.getZone()),this.chart.polar||(t.isInside=t.isTopInside=void 0!==t.plotY&&t.plotY>=0&&t.plotY<=this.yAxis.len&&t.plotX>=0&&t.plotX<=this.xAxis.len),e++;for(s.drawPoints.apply(this,arguments),e=0;e<i;)(t=this.points[e]).graphics=t.graphics||[],(t.graphic||t.graphics[1])&&(t.graphics[1]=t.graphic),t.graphic=t.graphics[0],t.origProps&&(u(t,t.origProps),delete t.origProps),e++}hasMarkerChanged(e,t){let i=e.lowMarker,r=t.lowMarker||{};return i&&(!1===i.enabled||r.symbol!==i.symbol||r.height!==i.height||r.width!==i.width)||super.hasMarkerChanged(e,t)}}return m.defaultOptions=f(o.defaultOptions,{lineWidth:1,threshold:null,tooltip:{pointFormat:'<span style="color:{series.color}">\u25cf</span> {series.name}: <b>{point.low}</b> - <b>{point.high}</b><br/>'},trackByArea:!0,dataLabels:{align:void 0,verticalAlign:void 0,xLow:0,xHigh:0,yLow:0,yHigh:0}}),l(m,"afterTranslate",(function(){"low,high"===this.pointArrayMap.join(",")&&this.points.forEach((e=>{let t=e.high,i=e.plotY;e.isNull?e.plotY=void 0:(e.plotLow=i,e.plotHigh=d(t)?this.yAxis.translate(this.dataModify?this.dataModify.modifyValue(t):t,!1,!0,void 0,!0):void 0,this.dataModify&&(e.yBottom=e.plotHigh))}))}),{order:0}),l(m,"afterTranslate",(function(){this.points.forEach((e=>{if(this.chart.polar)this.highToXY(e),e.plotLow=e.plotY,e.tooltipPos=[((e.plotHighX||0)+(e.plotLowX||0))/2,((e.plotHigh||0)+(e.plotLow||0))/2];else{let t=e.pos(!1,e.plotLow),i=e.pos(!1,e.plotHigh);t&&i&&(t[0]=(t[0]+i[0])/2,t[1]=(t[1]+i[1])/2),e.tooltipPos=t}}))}),{order:3}),u(m.prototype,{deferTranslatePolar:!0,pointArrayMap:["low","high"],pointClass:e,pointValKey:"low",setStackedPoints:n}),i.registerSeriesType("arearange",m),m})),i(t,"Series/AreaSplineRange/AreaSplineRangeSeries.js",[t["Series/AreaRange/AreaRangeSeries.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],(function(e,t,i){let{spline:{prototype:r}}=t.seriesTypes,{merge:n,extend:o}=i;class s extends e{}return s.defaultOptions=n(e.defaultOptions),o(s.prototype,{getPointSpline:r.getPointSpline}),t.registerSeriesType("areasplinerange",s),s})),i(t,"Series/BoxPlot/BoxPlotSeriesDefaults.js",[],(function(){return{threshold:null,tooltip:{pointFormat:'<span style="color:{point.color}">\u25cf</span> <b>{series.name}</b><br/>Maximum: {point.high}<br/>Upper quartile: {point.q3}<br/>Median: {point.median}<br/>Lower quartile: {point.q1}<br/>Minimum: {point.low}<br/>'},whiskerLength:"50%",fillColor:"#ffffff",lineWidth:1,medianWidth:2,whiskerWidth:2}})),i(t,"Series/BoxPlot/BoxPlotSeries.js",[t["Series/BoxPlot/BoxPlotSeriesDefaults.js"],t["Series/Column/ColumnSeries.js"],t["Core/Globals.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],(function(e,t,i,r,n){let{noop:o}=i,{crisp:s,extend:a,merge:l,pick:c}=n;class u extends t{pointAttribs(){return{}}translate(){let e=this.yAxis,t=this.pointArrayMap;super.translate.apply(this),this.points.forEach((function(i){t.forEach((function(t){null!==i[t]&&(i[t+"Plot"]=e.translate(i[t],0,1,0,1))})),i.plotHigh=i.highPlot}))}drawPoints(){let e,t,i,r,n,o,a,l,u,h,d,p=this.points,f=this.options,m=this.chart,g=m.renderer,y=!1!==this.doQuartiles,_=this.options.whiskerLength;for(let v of p){let p=(o=v.graphic)?"animate":"attr",x=v.shapeArgs,b={},w={},S={},T={},M=v.color||this.color;if(void 0!==v.plotY){let A;a=x.width,u=(l=x.x)+a,h=a/2,e=y?v.q1Plot:v.lowPlot,t=y?v.q3Plot:v.lowPlot,i=v.highPlot,r=v.lowPlot,o||(v.graphic=o=g.g("point").add(this.group),v.stem=g.path().addClass("highcharts-boxplot-stem").add(o),_&&(v.whiskers=g.path().addClass("highcharts-boxplot-whisker").add(o)),y&&(v.box=g.path(void 0).addClass("highcharts-boxplot-box").add(o)),v.medianShape=g.path(void 0).addClass("highcharts-boxplot-median").add(o)),m.styledMode||(w.stroke=v.stemColor||f.stemColor||M,w["stroke-width"]=c(v.stemWidth,f.stemWidth,f.lineWidth),w.dashstyle=v.stemDashStyle||f.stemDashStyle||f.dashStyle,v.stem.attr(w),_&&(S.stroke=v.whiskerColor||f.whiskerColor||M,S["stroke-width"]=c(v.whiskerWidth,f.whiskerWidth,f.lineWidth),S.dashstyle=v.whiskerDashStyle||f.whiskerDashStyle||f.dashStyle,v.whiskers.attr(S)),y&&(b.fill=v.fillColor||f.fillColor||M,b.stroke=f.lineColor||M,b["stroke-width"]=f.lineWidth||0,b.dashstyle=v.boxDashStyle||f.boxDashStyle||f.dashStyle,v.box.attr(b)),T.stroke=v.medianColor||f.medianColor||M,T["stroke-width"]=c(v.medianWidth,f.medianWidth,f.lineWidth),T.dashstyle=v.medianDashStyle||f.medianDashStyle||f.dashStyle,v.medianShape.attr(T));let C=s((v.plotX||0)+(this.pointXOffset||0)+(this.barW||0)/2,v.stem.strokeWidth());if(A=[["M",C,t],["L",C,i],["M",C,e],["L",C,r]],v.stem[p]({d:A}),y){let i=v.box.strokeWidth();e=s(e,i),t=s(t,i),A=[["M",l=s(l,i),t],["L",l,e],["L",u=s(u,i),e],["L",u,t],["L",l,t],["Z"]],v.box[p]({d:A})}if(_){let e=v.whiskers.strokeWidth();i=s(v.highPlot,e),r=s(v.lowPlot,e),A=[["M",s(C-(d="string"==typeof _&&/%$/.test(_)?h*parseFloat(_)/100:Number(_)/2)),i],["L",s(C+d),i],["M",s(C-d),r],["L",s(C+d),r]],v.whiskers[p]({d:A})}A=[["M",l,n=s(v.medianPlot,v.medianShape.strokeWidth())],["L",u,n]],v.medianShape[p]({d:A})}}}toYData(e){return[e.low,e.q1,e.median,e.q3,e.high]}}return u.defaultOptions=l(t.defaultOptions,e),a(u.prototype,{pointArrayMap:["low","q1","median","q3","high"],pointValKey:"high",drawDataLabels:o,setStackedPoints:o}),r.registerSeriesType("boxplot",u),u})),i(t,"Series/Bubble/BubbleLegendDefaults.js",[],(function(){return{borderColor:void 0,borderWidth:2,className:void 0,color:void 0,connectorClassName:void 0,connectorColor:void 0,connectorDistance:60,connectorWidth:1,enabled:!1,labels:{className:void 0,allowOverlap:!1,format:"",formatter:void 0,align:"right",style:{fontSize:"0.9em",color:"#000000"},x:0,y:0},maxSize:60,minSize:10,legendIndex:0,ranges:{value:void 0,borderColor:void 0,color:void 0,connectorColor:void 0},sizeBy:"area",sizeByAbsoluteValue:!1,zIndex:1,zThreshold:0}})),i(t,"Series/Bubble/BubbleLegendItem.js",[t["Core/Color/Color.js"],t["Core/Templating.js"],t["Core/Globals.js"],t["Core/Utilities.js"]],(function(e,t,i,r){let{parse:n}=e,{noop:o}=i,{arrayMax:s,arrayMin:a,isNumber:l,merge:c,pick:u,stableSort:h}=r;return class{constructor(e,t){this.setState=o,this.init(e,t)}init(e,t){this.options=e,this.visible=!0,this.chart=t.chart,this.legend=t}addToLegend(e){e.splice(this.options.legendIndex,0,this)}drawLegendSymbol(e){let t,i=u(e.options.itemDistance,20),r=this.legendItem||{},n=this.options,o=n.ranges,s=n.connectorDistance;if(!o||!o.length||!l(o[0].value))return void(e.options.bubbleLegend.autoRanges=!0);h(o,(function(e,t){return t.value-e.value})),this.ranges=o,this.setOptions(),this.render();let a=this.getMaxLabelSize(),c=this.ranges[0].radius,d=2*c;t=(t=s-c+a.width)>0?t:0,this.maxLabel=a,this.movementX="left"===n.labels.align?t:0,r.labelWidth=d+t+i,r.labelHeight=d+a.height/2}setOptions(){let e=this.ranges,t=this.options,i=this.chart.series[t.seriesIndex],r=this.legend.baseline,o={zIndex:t.zIndex,"stroke-width":t.borderWidth},s={zIndex:t.zIndex,"stroke-width":t.connectorWidth},a={align:this.legend.options.rtl||"left"===t.labels.align?"right":"left",zIndex:t.zIndex},l=i.options.marker.fillOpacity,h=this.chart.styledMode;e.forEach((function(d,p){h||(o.stroke=u(d.borderColor,t.borderColor,i.color),o.fill=u(d.color,t.color,1!==l?n(i.color).setOpacity(l).get("rgba"):i.color),s.stroke=u(d.connectorColor,t.connectorColor,i.color)),e[p].radius=this.getRangeRadius(d.value),e[p]=c(e[p],{center:e[0].radius-e[p].radius+r}),h||c(!0,e[p],{bubbleAttribs:c(o),connectorAttribs:c(s),labelAttribs:a})}),this)}getRangeRadius(e){let t=this.options,i=this.options.seriesIndex,r=this.chart.series[i],n=t.ranges[0].value,o=t.ranges[t.ranges.length-1].value,s=t.minSize,a=t.maxSize;return r.getRadius.call(this,o,n,s,a,e)}render(){let e=this.legendItem||{},t=this.chart.renderer,i=this.options.zThreshold;for(let r of(this.symbols||(this.symbols={connectors:[],bubbleItems:[],labels:[]}),e.symbol=t.g("bubble-legend"),e.label=t.g("bubble-legend-item").css(this.legend.itemStyle||{}),e.symbol.translateX=0,e.symbol.translateY=0,e.symbol.add(e.label),e.label.add(e.group),this.ranges))r.value>=i&&this.renderRange(r);this.hideOverlappingLabels()}renderRange(e){let t=this.ranges[0],i=this.legend,r=this.options,n=r.labels,o=this.chart,s=o.series[r.seriesIndex],a=o.renderer,l=this.symbols,c=l.labels,u=e.center,h=Math.abs(e.radius),d=r.connectorDistance||0,p=n.align,f=i.options.rtl,m=r.borderWidth,g=r.connectorWidth,y=t.radius||0,_=u-h-m/2+g/2,v=(_%1?1:.5)-(g%2?0:.5),x=a.styledMode,b=f||"left"===p?-d:d;"center"===p&&(b=0,r.connectorDistance=0,e.labelAttribs.align="center"),l.bubbleItems.push(a.circle(y,u+v,h).attr(x?{}:e.bubbleAttribs).addClass((x?"highcharts-color-"+s.colorIndex+" ":"")+"highcharts-bubble-legend-symbol "+(r.className||"")).add(this.legendItem.symbol)),l.connectors.push(a.path(a.crispLine([["M",y,_],["L",y+b,_]],r.connectorWidth)).attr(x?{}:e.connectorAttribs).addClass((x?"highcharts-color-"+this.options.seriesIndex+" ":"")+"highcharts-bubble-legend-connectors "+(r.connectorClassName||"")).add(this.legendItem.symbol));let w=a.text(this.formatLabel(e)).attr(x?{}:e.labelAttribs).css(x?{}:n.style).addClass("highcharts-bubble-legend-labels "+(r.labels.className||"")).add(this.legendItem.symbol),S={x:y+b+r.labels.x,y:_+r.labels.y+.4*w.getBBox().height};w.attr(S),c.push(w),w.placed=!0,w.alignAttr=S}getMaxLabelSize(){let e,t;return this.symbols.labels.forEach((function(i){t=i.getBBox(!0),e=e?t.width>e.width?t:e:t})),e||{}}formatLabel(e){let i=this.options,r=i.labels.formatter,n=i.labels.format,{numberFormatter:o}=this.chart;return n?t.format(n,e):r?r.call(e):o(e.value,1)}hideOverlappingLabels(){let e=this.chart,t=this.options.labels.allowOverlap,i=this.symbols;!t&&i&&(e.hideOverlappingLabels(i.labels),i.labels.forEach((function(e,t){e.newOpacity?e.newOpacity!==e.oldOpacity&&i.connectors[t].show():i.connectors[t].hide()})))}getRanges(){let e,t,i=this.legend.bubbleLegend,r=i.chart.series,n=i.options.ranges,o=Number.MAX_VALUE,h=-Number.MAX_VALUE;return r.forEach((function(e){e.isBubble&&!e.ignoreSeries&&(t=e.zData.filter(l)).length&&(o=u(e.options.zMin,Math.min(o,Math.max(a(t),!1===e.options.displayNegative?e.options.zThreshold:-Number.MAX_VALUE))),h=u(e.options.zMax,Math.max(h,s(t))))})),e=o===h?[{value:h}]:[{value:o},{value:(o+h)/2},{value:h,autoRanges:!0}],n.length&&n[0].radius&&e.reverse(),e.forEach((function(t,i){n&&n[i]&&(e[i]=c(n[i],t))})),e}predictBubbleSizes(){let e,t=this.chart,i=t.legend.options,r=i.floating,n="horizontal"===i.layout,o=n?t.legend.lastLineHeight:0,s=t.plotSizeX,a=t.plotSizeY,l=t.series[this.options.seriesIndex],c=l.getPxExtremes(),u=Math.ceil(c.minPxSize),h=Math.ceil(c.maxPxSize),d=Math.min(a,s),p=l.options.maxSize;return r||!/%$/.test(p)?e=h:(e=(d+o)*(p=parseFloat(p))/100/(p/100+1),(n&&a-e>=s||!n&&s-e>=a)&&(e=h)),[u,Math.ceil(e)]}updateRanges(e,t){let i=this.legend.options.bubbleLegend;i.minSize=e,i.maxSize=t,i.ranges=this.getRanges()}correctSizes(){let e=this.legend,t=this.chart.series[this.options.seriesIndex].getPxExtremes();Math.abs(Math.ceil(t.maxPxSize)-this.options.maxSize)>1&&(this.updateRanges(this.options.minSize,t.maxPxSize),e.render())}}})),i(t,"Series/Bubble/BubbleLegendComposition.js",[t["Series/Bubble/BubbleLegendDefaults.js"],t["Series/Bubble/BubbleLegendItem.js"],t["Core/Defaults.js"],t["Core/Globals.js"],t["Core/Utilities.js"]],(function(e,t,i,r,n){let{setOptions:o}=i,{composed:s}=r,{addEvent:a,objectEach:l,pushUnique:c,wrap:u}=n;function h(e,t,i){let r,n,o,s=this.legend,a=d(this)>=0;s&&s.options.enabled&&s.bubbleLegend&&s.options.bubbleLegend.autoRanges&&a?(r=s.bubbleLegend.options,n=s.bubbleLegend.predictBubbleSizes(),s.bubbleLegend.updateRanges(n[0],n[1]),r.placed||(s.group.placed=!1,s.allItems.forEach((e=>{(o=e.legendItem||{}).group&&(o.group.translateY=void 0)}))),s.render(),r.placed||(this.getMargins(),this.axes.forEach((function(e){e.visible&&e.render(),r.placed||(e.setScale(),e.updateNames(),l(e.ticks,(function(e){e.isNew=!0,e.isNewLabel=!0})))})),this.getMargins()),r.placed=!0,e.call(this,t,i),s.bubbleLegend.correctSizes(),g(s,p(s))):(e.call(this,t,i),s&&s.options.enabled&&s.bubbleLegend&&(s.render(),g(s,p(s))))}function d(e){let t=e.series,i=0;for(;i<t.length;){if(t[i]&&t[i].isBubble&&t[i].visible&&t[i].zData.length)return i;i++}return-1}function p(e){let t,i,r,n=e.allItems,o=[],s=n.length,a=0,l=0;for(a=0;a<s;a++)if(i=n[a].legendItem||{},r=(n[a+1]||{}).legendItem||{},i.labelHeight&&(n[a].itemHeight=i.labelHeight),n[a]===n[s-1]||i.y!==r.y){for(o.push({height:0}),t=o[o.length-1];l<=a;l++)n[l].itemHeight>t.height&&(t.height=n[l].itemHeight);t.step=a}return o}function f(e){let i=this.bubbleLegend,r=this.options,n=r.bubbleLegend,o=d(this.chart);i&&i.ranges&&i.ranges.length&&(n.ranges.length&&(n.autoRanges=!!n.ranges[0].autoRanges),this.destroyItem(i)),o>=0&&r.enabled&&n.enabled&&(n.seriesIndex=o,this.bubbleLegend=new t(n,this),this.bubbleLegend.addToLegend(e.allItems))}function m(e){let t;if(e.defaultPrevented)return!1;let i=e.legendItem,r=this.chart,n=i.visible;this&&this.bubbleLegend&&(i.visible=!n,i.ignoreSeries=n,t=d(r)>=0,this.bubbleLegend.visible!==t&&(this.update({bubbleLegend:{enabled:t}}),this.bubbleLegend.visible=t),i.visible=n)}function g(e,t){let i,r,n,o,s=e.allItems,a=e.options.rtl,l=0;s.forEach(((e,s)=>{(o=e.legendItem||{}).group&&(i=o.group.translateX||0,r=o.y||0,((n=e.movementX)||a&&e.ranges)&&(n=a?i-e.options.maxSize/2:i+n,o.group.attr({translateX:n})),s>t[l].step&&l++,o.group.attr({translateY:Math.round(r+t[l].height/2)}),o.y=r+t[l].height/2)}))}return{compose:function(t,i){c(s,"Series.BubbleLegend")&&(o({legend:{bubbleLegend:e}}),u(t.prototype,"drawChartBox",h),a(i,"afterGetAllItems",f),a(i,"itemClick",m))}}})),i(t,"Series/Bubble/BubblePoint.js",[t["Core/Series/Point.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],(function(e,t,i){let{seriesTypes:{scatter:{prototype:{pointClass:r}}}}=t,{extend:n}=i;class o extends r{haloPath(t){let i=(t&&this.marker&&this.marker.radius||0)+t;if(this.series.chart.inverted){let e=this.pos()||[0,0],{xAxis:t,yAxis:r,chart:n}=this.series;return n.renderer.symbols.circle(t.len-e[1]-i,r.len-e[0]-i,2*i,2*i)}return e.prototype.haloPath.call(this,i)}}return n(o.prototype,{ttBelow:!1}),o})),i(t,"Series/Bubble/BubbleSeries.js",[t["Series/Bubble/BubbleLegendComposition.js"],t["Series/Bubble/BubblePoint.js"],t["Core/Color/Color.js"],t["Core/Globals.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],(function(e,t,i,r,n,o){let{parse:s}=i,{composed:a,noop:l}=r,{series:c,seriesTypes:{column:{prototype:u},scatter:h}}=n,{addEvent:d,arrayMax:p,arrayMin:f,clamp:m,extend:g,isNumber:y,merge:_,pick:v,pushUnique:x}=o;function b(){let e,t=this.len,{coll:i,isXAxis:r,min:n}=this,o=r?"xData":"yData",s=(this.max||0)-(n||0),a=0,l=t,c=t/s;("xAxis"===i||"yAxis"===i)&&(this.series.forEach((t=>{if(t.bubblePadding&&t.reserveSpace()){this.allowZoomOutside=!0,e=!0;let i=t[o];if(r&&((t.onPoint||t).getRadii(0,0,t),t.onPoint&&(t.radii=t.onPoint.radii)),s>0){let e=i.length;for(;e--;)if(y(i[e])&&this.dataMin<=i[e]&&i[e]<=this.max){let r=t.radii&&t.radii[e]||0;a=Math.min((i[e]-n)*c-r,a),l=Math.max((i[e]-n)*c+r,l)}}}})),e&&s>0&&!this.logarithmic&&(l-=t,c*=(t+Math.max(0,a)-Math.min(l,t))/t,[["min","userMin",a],["max","userMax",l]].forEach((e=>{void 0===v(this.options[e[0]],this[e[1]])&&(this[e[0]]+=e[2]/c)}))))}class w extends h{static compose(t,i,r){e.compose(i,r),x(a,"Series.Bubble")&&d(t,"foundExtremes",b)}animate(e){!e&&this.points.length<this.options.animationLimit&&this.points.forEach((function(e){let{graphic:t,plotX:i=0,plotY:r=0}=e;t&&t.width&&(this.hasRendered||t.attr({x:i,y:r,width:1,height:1}),t.animate(this.markerAttribs(e),this.options.animation))}),this)}getRadii(){let e,t,i,r=this.zData,n=this.yData,o=[],s=this.chart.bubbleZExtremes,{minPxSize:a,maxPxSize:l}=this.getPxExtremes();if(!s){let e,t=Number.MAX_VALUE,i=-Number.MAX_VALUE;this.chart.series.forEach((r=>{if(r.bubblePadding&&r.reserveSpace()){let n=(r.onPoint||r).getZExtremes();n&&(t=Math.min(v(t,n.zMin),n.zMin),i=Math.max(v(i,n.zMax),n.zMax),e=!0)}})),e?(s={zMin:t,zMax:i},this.chart.bubbleZExtremes=s):s={zMin:0,zMax:0}}for(t=0,e=r.length;t<e;t++)i=r[t],o.push(this.getRadius(s.zMin,s.zMax,a,l,i,n&&n[t]));this.radii=o}getRadius(e,t,i,r,n,o){let s=this.options,a="width"!==s.sizeBy,l=s.zThreshold,c=t-e,u=.5;if(null===o||null===n)return null;if(y(n)){if(s.sizeByAbsoluteValue&&(n=Math.abs(n-l),t=c=Math.max(t-l,Math.abs(e-l)),e=0),n<e)return i/2-1;c>0&&(u=(n-e)/c)}return a&&u>=0&&(u=Math.sqrt(u)),Math.ceil(i+u*(r-i))/2}hasData(){return!!this.processedXData.length}markerAttribs(e,t){let i=super.markerAttribs(e,t),{height:r=0,width:n=0}=i;return this.chart.inverted?g(i,{x:(e.plotX||0)-n/2,y:(e.plotY||0)-r/2}):i}pointAttribs(e,t){let i=this.options.marker.fillOpacity,r=c.prototype.pointAttribs.call(this,e,t);return 1!==i&&(r.fill=s(r.fill).setOpacity(i).get("rgba")),r}translate(){super.translate.call(this),this.getRadii(),this.translateBubble()}translateBubble(){let{data:e,options:t,radii:i}=this,{minPxSize:r}=this.getPxExtremes(),n=e.length;for(;n--;){let o=e[n],s=i?i[n]:0;"z"===this.zoneAxis&&(o.negative=(o.z||0)<(t.zThreshold||0)),y(s)&&s>=r/2?(o.marker=g(o.marker,{radius:s,width:2*s,height:2*s}),o.dlBox={x:o.plotX-s,y:o.plotY-s,width:2*s,height:2*s}):(o.shapeArgs=o.plotY=o.dlBox=void 0,o.isInside=!1)}}getPxExtremes(){let e=Math.min(this.chart.plotWidth,this.chart.plotHeight),t=t=>{let i;return"string"==typeof t&&(i=/%$/.test(t),t=parseInt(t,10)),i?e*t/100:t},i=t(v(this.options.minSize,8));return{minPxSize:i,maxPxSize:Math.max(t(v(this.options.maxSize,"20%")),i)}}getZExtremes(){let e=this.options,t=(this.zData||[]).filter(y);if(t.length){let i=v(e.zMin,m(f(t),!1===e.displayNegative?e.zThreshold||0:-Number.MAX_VALUE,Number.MAX_VALUE)),r=v(e.zMax,p(t));if(y(i)&&y(r))return{zMin:i,zMax:r}}}}return w.defaultOptions=_(h.defaultOptions,{dataLabels:{formatter:function(){let{numberFormatter:e}=this.series.chart,{z:t}=this.point;return y(t)?e(t,-1):""},inside:!0,verticalAlign:"middle"},animationLimit:250,marker:{lineColor:null,lineWidth:1,fillOpacity:.5,radius:null,states:{hover:{radiusPlus:0}},symbol:"circle"},minSize:8,maxSize:"20%",softThreshold:!1,states:{hover:{halo:{size:5}}},tooltip:{pointFormat:"({point.x}, {point.y}), Size: {point.z}"},turboThreshold:0,zThreshold:0,zoneAxis:"z"}),g(w.prototype,{alignDataLabel:u.alignDataLabel,applyZones:l,bubblePadding:!0,isBubble:!0,pointArrayMap:["y","z"],pointClass:t,parallelArrays:["x","y","z"],trackerGroups:["group","dataLabelsGroup"],specialGroup:"group",zoneAxis:"z"}),d(w,"updatedData",(e=>{delete e.target.chart.bubbleZExtremes})),d(w,"remove",(e=>{delete e.target.chart.bubbleZExtremes})),n.registerSeriesType("bubble",w),w})),i(t,"Series/ColumnRange/ColumnRangePoint.js",[t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],(function(e,t){let{seriesTypes:{column:{prototype:{pointClass:{prototype:i}}},arearange:{prototype:{pointClass:r}}}}=e,{extend:n,isNumber:o}=t;class s extends r{isValid(){return o(this.low)}}return n(s.prototype,{setState:i.setState}),s})),i(t,"Series/ColumnRange/ColumnRangeSeries.js",[t["Series/ColumnRange/ColumnRangePoint.js"],t["Core/Globals.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],(function(e,t,i,r){let{noop:n}=t,{seriesTypes:{arearange:o,column:s,column:{prototype:a}}}=i,{addEvent:l,clamp:c,extend:u,isNumber:h,merge:d,pick:p}=r;class f extends o{setOptions(){return d(!0,arguments[0],{stacking:void 0}),o.prototype.setOptions.apply(this,arguments)}translate(){return a.translate.apply(this)}pointAttribs(){return a.pointAttribs.apply(this,arguments)}translate3dPoints(){return a.translate3dPoints.apply(this,arguments)}translate3dShapes(){return a.translate3dShapes.apply(this,arguments)}afterColumnTranslate(){let e,t,i,r,n=this.yAxis,o=this.xAxis,s=o.startAngleRad,a=this.chart,l=this.xAxis.isRadial,u=Math.max(a.chartWidth,a.chartHeight)+999;this.points.forEach((f=>{let m=f.shapeArgs||{},g=this.options.minPointLength,y=f.plotY,_=n.translate(f.high,0,1,0,1);if(h(_)&&h(y))if(f.plotHigh=c(_,-u,u),f.plotLow=c(y,-u,u),r=f.plotHigh,Math.abs(e=p(f.rectPlotY,f.plotY)-f.plotHigh)<g?(t=g-e,e+=t,r-=t/2):e<0&&(e*=-1,r-=e),l&&this.polar)i=f.barX+s,f.shapeType="arc",f.shapeArgs=this.polar.arc(r+e,r,i,i+f.pointWidth);else{m.height=e,m.y=r;let{x:t=0,width:i=0}=m;f.shapeArgs=d(f.shapeArgs,this.crispCol(t,r,i,e)),f.tooltipPos=a.inverted?[n.len+n.pos-a.plotLeft-r-e/2,o.len+o.pos-a.plotTop-t-i/2,e]:[o.left-a.plotLeft+t+i/2,n.pos-a.plotTop+r+e/2,e]}}))}}return f.defaultOptions=d(s.defaultOptions,o.defaultOptions,{borderRadius:{where:"all"},pointRange:null,legendSymbol:"rectangle",marker:null,states:{hover:{halo:!1}}}),l(f,"afterColumnTranslate",(function(){f.prototype.afterColumnTranslate.apply(this)}),{order:5}),u(f.prototype,{directTouch:!0,pointClass:e,trackerGroups:["group","dataLabelsGroup"],adjustForMissingColumns:a.adjustForMissingColumns,animate:a.animate,crispCol:a.crispCol,drawGraph:n,drawPoints:a.drawPoints,getSymbol:n,drawTracker:a.drawTracker,getColumnMetrics:a.getColumnMetrics}),i.registerSeriesType("columnrange",f),f})),i(t,"Series/ColumnPyramid/ColumnPyramidSeriesDefaults.js",[],(function(){return{}})),i(t,"Series/ColumnPyramid/ColumnPyramidSeries.js",[t["Series/ColumnPyramid/ColumnPyramidSeriesDefaults.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],(function(e,t,i){let{column:r}=t.seriesTypes,{clamp:n,merge:o,pick:s}=i;class a extends r{translate(){let e=this.chart,t=this.options,i=this.dense=this.closestPointRange*this.xAxis.transA<2,r=this.borderWidth=s(t.borderWidth,i?0:1),o=this.yAxis,a=t.threshold,l=s(t.minPointLength,5),c=this.getColumnMetrics(),u=c.width,h=this.pointXOffset=c.offset,d=this.translatedThreshold=o.getThreshold(a),p=this.barW=Math.max(u,1+2*r);for(let f of(e.inverted&&(d-=.5),t.pointPadding&&(p=Math.ceil(p)),super.translate(),this.points)){let i,r,m,g,y,_,v,x,b,w,S,T=s(f.yBottom,d),M=999+Math.abs(T),A=n(f.plotY,-M,o.len+M),C=p/2,E=Math.min(A,T),P=Math.max(A,T)-E,k=f.plotX+h;t.centerInCategory&&(k=this.adjustForMissingColumns(k,u,f,c)),f.barX=k,f.pointWidth=u,f.tooltipPos=e.inverted?[o.len+o.pos-e.plotLeft-A,this.xAxis.len-k-C,P]:[k+C,A+o.pos-e.plotTop,P],i=a+(f.total||f.y),"percent"===t.stacking&&(i=a+(f.y<0)?-100:100);let I=o.toPixels(i,!0);m=(r=e.plotHeight-I-(e.plotHeight-d))?C*(E-I)/r:0,g=r?C*(E+P-I)/r:0,_=k-m+C,v=k+m+C,x=k+g+C,b=k-g+C,w=E-l,S=E+P,f.y<0&&(w=E,S=E+P+l),e.inverted&&(y=o.width-E,r=I-(o.width-d),m=C*(I-y)/r,g=C*(I-(y-P))/r,v=(_=k+C+m)-2*m,x=k-g+C,b=k+g+C,w=E,S=E+P-l,f.y<0&&(S=E+P+l)),f.shapeType="path",f.shapeArgs={x:_,y:w,width:v-_,height:P,d:[["M",_,w],["L",v,w],["L",x,S],["L",b,S],["Z"]]}}}}return a.defaultOptions=o(r.defaultOptions,e),t.registerSeriesType("columnpyramid",a),a})),i(t,"Series/ErrorBar/ErrorBarSeriesDefaults.js",[],(function(){return{color:"#000000",grouping:!1,linkedTo:":previous",tooltip:{pointFormat:'<span style="color:{point.color}">\u25cf</span> {series.name}: <b>{point.low}</b> - <b>{point.high}</b><br/>'},whiskerWidth:null}})),i(t,"Series/ErrorBar/ErrorBarSeries.js",[t["Series/BoxPlot/BoxPlotSeries.js"],t["Series/Column/ColumnSeries.js"],t["Series/ErrorBar/ErrorBarSeriesDefaults.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],(function(e,t,i,r,n){let{arearange:o}=r.seriesTypes,{addEvent:s,merge:a,extend:l}=n;class c extends e{getColumnMetrics(){return this.linkedParent&&this.linkedParent.columnMetrics||t.prototype.getColumnMetrics.call(this)}drawDataLabels(){let e=this.pointValKey;if(o)for(let t of(o.prototype.drawDataLabels.call(this),this.points))t.y=t[e]}toYData(e){return[e.low,e.high]}}return c.defaultOptions=a(e.defaultOptions,i),s(c,"afterTranslate",(function(){for(let e of this.points)e.plotLow=e.plotY}),{order:0}),l(c.prototype,{pointArrayMap:["low","high"],pointValKey:"high",doQuartiles:!1}),r.registerSeriesType("errorbar",c),c})),i(t,"Series/Gauge/GaugePoint.js",[t["Core/Series/SeriesRegistry.js"]],(function(e){let{series:{prototype:{pointClass:t}}}=e;return class extends t{setState(e){this.state=e}}})),i(t,"Series/Gauge/GaugeSeries.js",[t["Series/Gauge/GaugePoint.js"],t["Core/Globals.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],(function(e,t,i,r){let{noop:n}=t,{series:o,seriesTypes:{column:s}}=i,{clamp:a,isNumber:l,extend:c,merge:u,pick:h,pInt:d,defined:p}=r;class f extends o{translate(){let e=this.yAxis,t=this.options,i=e.center;this.generatePoints(),this.points.forEach((r=>{let n=u(t.dial,r.dial),o=d(n.radius)*i[2]/200,s=d(n.baseLength)*o/100,c=d(n.rearLength)*o/100,h=n.baseWidth,f=n.topWidth,m=t.overshoot,g=e.startAngleRad+e.translate(r.y,void 0,void 0,void 0,!0);(l(m)||!1===t.wrap)&&(m=l(m)?m/180*Math.PI:0,g=a(g,e.startAngleRad-m,e.endAngleRad+m)),g=180*g/Math.PI,r.shapeType="path";let y=n.path||[["M",-c,-h/2],["L",s,-h/2],["L",o,-f/2],["L",o,f/2],["L",s,h/2],["L",-c,h/2],["Z"]];r.shapeArgs={d:y,translateX:i[0],translateY:i[1],rotation:g},r.plotX=i[0],r.plotY=i[1],p(r.y)&&e.max-e.min&&(r.percentage=(r.y-e.min)/(e.max-e.min)*100)}))}drawPoints(){let e=this,t=e.chart,i=e.yAxis.center,r=e.pivot,n=e.options,o=n.pivot,s=t.renderer;e.points.forEach((i=>{let r=i.graphic,o=i.shapeArgs,a=o.d,l=u(n.dial,i.dial);r?(r.animate(o),o.d=a):i.graphic=s[i.shapeType](o).addClass("highcharts-dial").add(e.group),t.styledMode||i.graphic[r?"animate":"attr"]({stroke:l.borderColor,"stroke-width":l.borderWidth,fill:l.backgroundColor})})),r?r.animate({translateX:i[0],translateY:i[1]}):o&&(e.pivot=s.circle(0,0,o.radius).attr({zIndex:2}).addClass("highcharts-pivot").translate(i[0],i[1]).add(e.group),t.styledMode||e.pivot.attr({fill:o.backgroundColor,stroke:o.borderColor,"stroke-width":o.borderWidth}))}animate(e){let t=this;e||t.points.forEach((e=>{let i=e.graphic;i&&(i.attr({rotation:180*t.yAxis.startAngleRad/Math.PI}),i.animate({rotation:e.shapeArgs.rotation},t.options.animation))}))}render(){this.group=this.plotGroup("group","series",this.visible?"inherit":"hidden",this.options.zIndex,this.chart.seriesGroup),o.prototype.render.call(this),this.group.clip(this.chart.clipRect)}setData(e,t){o.prototype.setData.call(this,e,!1),this.processData(),this.generatePoints(),h(t,!0)&&this.chart.redraw()}hasData(){return!!this.points.length}}return f.defaultOptions=u(o.defaultOptions,{dataLabels:{borderColor:"#cccccc",borderRadius:3,borderWidth:1,crop:!1,defer:!1,enabled:!0,verticalAlign:"top",y:15,zIndex:2},dial:{backgroundColor:"#000000",baseLength:"70%",baseWidth:3,borderColor:"#cccccc",borderWidth:0,radius:"80%",rearLength:"10%",topWidth:1},pivot:{radius:5,borderWidth:0,borderColor:"#cccccc",backgroundColor:"#000000"},tooltip:{headerFormat:""},showInLegend:!1}),c(f.prototype,{angular:!0,directTouch:!0,drawGraph:n,drawTracker:s.prototype.drawTracker,fixedBox:!0,forceDL:!0,noSharedTooltip:!0,pointClass:e,trackerGroups:["group","dataLabelsGroup"]}),i.registerSeriesType("gauge",f),f})),i(t,"Series/DragNodesComposition.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],(function(e,t){let{composed:i}=e,{addEvent:r,pushUnique:n}=t;function o(){let e,t,i,n=this;n.container&&(e=r(n.container,"mousedown",(e=>{let o=n.hoverPoint;o&&o.series&&o.series.hasDraggableNodes&&o.series.options.draggable&&(o.series.onMouseDown(o,e),t=r(n.container,"mousemove",(e=>o&&o.series&&o.series.onMouseMove(o,e))),i=r(n.container.ownerDocument,"mouseup",(e=>(t(),i(),o&&o.series&&o.series.onMouseUp(o,e)))))}))),r(n,"destroy",(function(){e()}))}return{compose:function(e){n(i,"DragNodes")&&r(e,"load",o)},onMouseDown:function(e,t){let i=this.chart.pointer?.normalize(t)||t;e.fixedPosition={chartX:i.chartX,chartY:i.chartY,plotX:e.plotX,plotY:e.plotY},e.inDragMode=!0},onMouseMove:function(e,t){if(e.fixedPosition&&e.inDragMode){let i,r,n=this.chart,o=n.pointer?.normalize(t)||t,s=e.fixedPosition.chartX-o.chartX,a=e.fixedPosition.chartY-o.chartY,l=n.graphLayoutsLookup;(Math.abs(s)>5||Math.abs(a)>5)&&(i=e.fixedPosition.plotX-s,r=e.fixedPosition.plotY-a,n.isInsidePlot(i,r)&&(e.plotX=i,e.plotY=r,e.hasDragged=!0,this.redrawHalo(e),l.forEach((e=>{e.restartSimulation()}))))}},onMouseUp:function(e){e.fixedPosition&&(e.hasDragged&&(this.layout.enableSimulation?this.layout.start():this.chart.redraw()),e.inDragMode=e.hasDragged=!1,this.options.fixedDraggable||delete e.fixedPosition)},redrawHalo:function(e){e&&this.halo&&this.halo.attr({d:e.haloPath(this.options.states.hover.halo.size)})}}})),i(t,"Series/GraphLayoutComposition.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Globals.js"],t["Core/Utilities.js"]],(function(e,t,i){let{setAnimation:r}=e,{composed:n}=t,{addEvent:o,pushUnique:s}=i;function a(){this.graphLayoutsLookup&&(this.graphLayoutsLookup.forEach((e=>{e.updateSimulation()})),this.redraw())}function l(){this.graphLayoutsLookup&&(this.graphLayoutsLookup.forEach((e=>{e.updateSimulation(!1)})),this.redraw())}function c(){this.graphLayoutsLookup&&this.graphLayoutsLookup.forEach((e=>{e.stop()}))}function u(){let e,t=!1,i=i=>{i.maxIterations--&&isFinite(i.temperature)&&!i.isStable()&&!i.enableSimulation&&(i.beforeStep&&i.beforeStep(),i.step(),e=!1,t=!0)};if(this.graphLayoutsLookup){for(r(!1,this),this.graphLayoutsLookup.forEach((e=>e.start()));!e;)e=!0,this.graphLayoutsLookup.forEach(i);t&&this.series.forEach((e=>{e&&e.layout&&e.render()}))}}return{compose:function(e){s(n,"GraphLayout")&&(o(e,"afterPrint",a),o(e,"beforePrint",l),o(e,"predraw",c),o(e,"render",u))},integrations:{},layouts:{}}})),i(t,"Series/PackedBubble/PackedBubblePoint.js",[t["Core/Chart/Chart.js"],t["Core/Series/Point.js"],t["Core/Series/SeriesRegistry.js"]],(function(e,t,i){let{seriesTypes:{bubble:{prototype:{pointClass:r}}}}=i;return class extends r{destroy(){return this.series?.layout&&this.series.layout.removeElementFromCollection(this,this.series.layout.nodes),t.prototype.destroy.apply(this,arguments)}firePointEvent(){let e=this.series.options;if(this.isParentNode&&e.parentNode){let i=e.allowPointSelect;e.allowPointSelect=e.parentNode.allowPointSelect,t.prototype.firePointEvent.apply(this,arguments),e.allowPointSelect=i}else t.prototype.firePointEvent.apply(this,arguments)}select(){let i=this.series.chart;this.isParentNode?(i.getSelectedPoints=i.getSelectedParentNodes,t.prototype.select.apply(this,arguments),i.getSelectedPoints=e.prototype.getSelectedPoints):t.prototype.select.apply(this,arguments)}}})),i(t,"Series/PackedBubble/PackedBubbleSeriesDefaults.js",[t["Core/Utilities.js"]],(function(e){let{isNumber:t}=e;return{minSize:"10%",maxSize:"50%",sizeBy:"area",zoneAxis:"y",crisp:!1,tooltip:{pointFormat:"Value: {point.value}"},draggable:!0,useSimulation:!0,parentNode:{allowPointSelect:!1},dataLabels:{formatter:function(){let{numberFormatter:e}=this.series.chart,{value:i}=this.point;return t(i)?e(i,-1):""},parentNodeFormatter:function(){return this.name},parentNodeTextPath:{enabled:!0},padding:0,style:{transition:"opacity 2000ms"}},layoutAlgorithm:{initialPositions:"circle",initialPositionRadius:20,bubblePadding:5,parentNodeLimit:!1,seriesInteraction:!0,dragBetweenSeries:!1,parentNodeOptions:{maxIterations:400,gravitationalConstant:.03,maxSpeed:50,initialPositionRadius:100,seriesInteraction:!0,marker:{fillColor:null,fillOpacity:1,lineWidth:null,lineColor:null,symbol:"circle"}},enableSimulation:!0,type:"packedbubble",integration:"packedbubble",maxIterations:1e3,splitSeries:!1,maxSpeed:5,gravitationalConstant:.01,friction:-.981}}})),i(t,"Series/Networkgraph/VerletIntegration.js",[],(function(){return{attractive:function(e,t,i){let r=e.getMass(),n=-i.x*t*this.diffTemperature,o=-i.y*t*this.diffTemperature;e.fromNode.fixedPosition||(e.fromNode.plotX-=n*r.fromNode/e.fromNode.degree,e.fromNode.plotY-=o*r.fromNode/e.fromNode.degree),e.toNode.fixedPosition||(e.toNode.plotX+=n*r.toNode/e.toNode.degree,e.toNode.plotY+=o*r.toNode/e.toNode.degree)},attractiveForceFunction:function(e,t){return(t-e)/e},barycenter:function(){let e=this.options.gravitationalConstant||0,t=(this.barycenter.xFactor-(this.box.left+this.box.width)/2)*e,i=(this.barycenter.yFactor-(this.box.top+this.box.height)/2)*e;this.nodes.forEach((function(e){e.fixedPosition||(e.plotX-=t/e.mass/e.degree,e.plotY-=i/e.mass/e.degree)}))},getK:function(e){return Math.pow(e.box.width*e.box.height/e.nodes.length,.5)},integrate:function(e,t){let i=-e.options.friction,r=e.options.maxSpeed,n=t.prevX,o=t.prevY,s=(t.plotX+t.dispX-n)*i,a=(t.plotY+t.dispY-o)*i,l=Math.abs,c=l(s)/(s||1),u=l(a)/(a||1),h=c*Math.min(r,Math.abs(s)),d=u*Math.min(r,Math.abs(a));t.prevX=t.plotX+t.dispX,t.prevY=t.plotY+t.dispY,t.plotX+=h,t.plotY+=d,t.temperature=e.vectorLength({x:h,y:d})},repulsive:function(e,t,i){let r=t*this.diffTemperature/e.mass/e.degree;e.fixedPosition||(e.plotX+=i.x*r,e.plotY+=i.y*r)},repulsiveForceFunction:function(e,t){return(t-e)/e*(t>e?1:0)}}})),i(t,"Series/PackedBubble/PackedBubbleIntegration.js",[t["Core/Globals.js"],t["Series/Networkgraph/VerletIntegration.js"]],(function(e,t){let{noop:i}=e;return{barycenter:function(){let e,t,i=this.options.gravitationalConstant,r=this.box,n=this.nodes;for(let o of n)this.options.splitSeries&&!o.isParentNode?(e=o.series.parentNode.plotX,t=o.series.parentNode.plotY):(e=r.width/2,t=r.height/2),o.fixedPosition||(o.plotX-=(o.plotX-e)*i/(o.mass*Math.sqrt(n.length)),o.plotY-=(o.plotY-t)*i/(o.mass*Math.sqrt(n.length)))},getK:i,integrate:t.integrate,repulsive:function(e,t,i,r){let n=t*this.diffTemperature/e.mass/e.degree,o=i.x*n,s=i.y*n;e.fixedPosition||(e.plotX+=o,e.plotY+=s),r.fixedPosition||(r.plotX-=o,r.plotY-=s)},repulsiveForceFunction:function(e,t,i,r){return Math.min(e,(i.marker.radius+r.marker.radius)/2)}}})),i(t,"Series/Networkgraph/EulerIntegration.js",[],(function(){return{attractive:function(e,t,i,r){let n=e.getMass(),o=i.x/r*t,s=i.y/r*t;e.fromNode.fixedPosition||(e.fromNode.dispX-=o*n.fromNode/e.fromNode.degree,e.fromNode.dispY-=s*n.fromNode/e.fromNode.degree),e.toNode.fixedPosition||(e.toNode.dispX+=o*n.toNode/e.toNode.degree,e.toNode.dispY+=s*n.toNode/e.toNode.degree)},attractiveForceFunction:function(e,t){return e*e/t},barycenter:function(){let e=this.options.gravitationalConstant,t=this.barycenter.xFactor,i=this.barycenter.yFactor;this.nodes.forEach((function(r){if(!r.fixedPosition){let n=r.getDegree(),o=n*(1+n/2);r.dispX+=(t-r.plotX)*e*o/r.degree,r.dispY+=(i-r.plotY)*e*o/r.degree}}))},getK:function(e){return Math.pow(e.box.width*e.box.height/e.nodes.length,.3)},integrate:function(e,t){t.dispX+=t.dispX*e.options.friction,t.dispY+=t.dispY*e.options.friction;let i=t.temperature=e.vectorLength({x:t.dispX,y:t.dispY});0!==i&&(t.plotX+=t.dispX/i*Math.min(Math.abs(t.dispX),e.temperature),t.plotY+=t.dispY/i*Math.min(Math.abs(t.dispY),e.temperature))},repulsive:function(e,t,i,r){e.dispX+=i.x/r*t/e.degree,e.dispY+=i.y/r*t/e.degree},repulsiveForceFunction:function(e,t){return t*t/e}}})),i(t,"Series/Networkgraph/QuadTreeNode.js",[],(function(){class e{constructor(e){this.body=!1,this.isEmpty=!1,this.isInternal=!1,this.nodes=[],this.box=e,this.boxSize=Math.min(e.width,e.height)}divideBox(){let t=this.box.width/2,i=this.box.height/2;this.nodes[0]=new e({left:this.box.left,top:this.box.top,width:t,height:i}),this.nodes[1]=new e({left:this.box.left+t,top:this.box.top,width:t,height:i}),this.nodes[2]=new e({left:this.box.left+t,top:this.box.top+i,width:t,height:i}),this.nodes[3]=new e({left:this.box.left,top:this.box.top+i,width:t,height:i})}getBoxPosition(e){let t=e.plotX<this.box.left+this.box.width/2,i=e.plotY<this.box.top+this.box.height/2;return t?i?0:3:i?1:2}insert(t,i){let r;this.isInternal?this.nodes[this.getBoxPosition(t)].insert(t,i-1):(this.isEmpty=!1,this.body?i?(this.isInternal=!0,this.divideBox(),!0!==this.body&&(this.nodes[this.getBoxPosition(this.body)].insert(this.body,i-1),this.body=!0),this.nodes[this.getBoxPosition(t)].insert(t,i-1)):((r=new e({top:t.plotX||NaN,left:t.plotY||NaN,width:.1,height:.1})).body=t,r.isInternal=!1,this.nodes.push(r)):(this.isInternal=!1,this.body=t))}updateMassAndCenter(){let e=0,t=0,i=0;if(this.isInternal){for(let r of this.nodes)r.isEmpty||(e+=r.mass,t+=r.plotX*r.mass,i+=r.plotY*r.mass);t/=e,i/=e}else this.body&&(e=this.body.mass,t=this.body.plotX,i=this.body.plotY);this.mass=e,this.plotX=t,this.plotY=i}}return e})),i(t,"Series/Networkgraph/QuadTree.js",[t["Series/Networkgraph/QuadTreeNode.js"]],(function(e){return class{constructor(t,i,r,n){this.box={left:t,top:i,width:r,height:n},this.maxDepth=25,this.root=new e(this.box),this.root.isInternal=!0,this.root.isRoot=!0,this.root.divideBox()}calculateMassAndCenter(){this.visitNodeRecursive(null,null,(function(e){e.updateMassAndCenter()}))}insertNodes(e){for(let t of e)this.root.insert(t,this.maxDepth)}visitNodeRecursive(e,t,i){let r;if(e||(e=this.root),e===this.root&&t&&(r=t(e)),!1!==r){for(let n of e.nodes){if(n.isInternal){if(t&&(r=t(n)),!1===r)continue;this.visitNodeRecursive(n,t,i)}else n.body&&t&&t(n.body);i&&i(n)}e===this.root&&i&&i(e)}}}})),i(t,"Series/Networkgraph/ReingoldFruchtermanLayout.js",[t["Series/Networkgraph/EulerIntegration.js"],t["Core/Globals.js"],t["Series/GraphLayoutComposition.js"],t["Series/Networkgraph/QuadTree.js"],t["Core/Utilities.js"],t["Series/Networkgraph/VerletIntegration.js"]],(function(e,t,i,r,n,o){let{win:s}=t,{clamp:a,defined:l,isFunction:c,fireEvent:u,pick:h}=n;class d{constructor(){this.box={},this.currentStep=0,this.initialRendering=!0,this.links=[],this.nodes=[],this.series=[],this.simulation=!1}static compose(t){i.compose(t),i.integrations.euler=e,i.integrations.verlet=o,i.layouts["reingold-fruchterman"]=d}init(e){this.options=e,this.nodes=[],this.links=[],this.series=[],this.box={x:0,y:0,width:0,height:0},this.setInitialRendering(!0),this.integration=i.integrations[e.integration],this.enableSimulation=e.enableSimulation,this.attractiveForce=h(e.attractiveForce,this.integration.attractiveForceFunction),this.repulsiveForce=h(e.repulsiveForce,this.integration.repulsiveForceFunction),this.approximation=e.approximation}updateSimulation(e){this.enableSimulation=h(e,this.options.enableSimulation)}start(){let e=this.series,t=this.options;this.currentStep=0,this.forces=e[0]&&e[0].forces||[],this.chart=e[0]&&e[0].chart,this.initialRendering&&(this.initPositions(),e.forEach((function(e){e.finishedAnimating=!0,e.render()}))),this.setK(),this.resetSimulation(t),this.enableSimulation&&this.step()}step(){let e=this.series;for(let t of(this.currentStep++,"barnes-hut"===this.approximation&&(this.createQuadTree(),this.quadTree.calculateMassAndCenter()),this.forces||[]))this[t+"Forces"](this.temperature);if(this.applyLimits(),this.temperature=this.coolDown(this.startTemperature,this.diffTemperature,this.currentStep),this.prevSystemTemperature=this.systemTemperature,this.systemTemperature=this.getSystemTemperature(),this.enableSimulation){for(let t of e)t.chart&&t.render();this.maxIterations--&&isFinite(this.temperature)&&!this.isStable()?(this.simulation&&s.cancelAnimationFrame(this.simulation),this.simulation=s.requestAnimationFrame((()=>this.step()))):(this.simulation=!1,this.series.forEach((e=>{u(e,"afterSimulation")})))}}stop(){this.simulation&&s.cancelAnimationFrame(this.simulation)}setArea(e,t,i,r){this.box={left:e,top:t,width:i,height:r}}setK(){this.k=this.options.linkLength||this.integration.getK(this)}addElementsToCollection(e,t){for(let i of e)-1===t.indexOf(i)&&t.push(i)}removeElementFromCollection(e,t){let i=t.indexOf(e);-1!==i&&t.splice(i,1)}clear(){this.nodes.length=0,this.links.length=0,this.series.length=0,this.resetSimulation()}resetSimulation(){this.forcedStop=!1,this.systemTemperature=0,this.setMaxIterations(),this.setTemperature(),this.setDiffTemperature()}restartSimulation(){this.simulation?this.resetSimulation():(this.setInitialRendering(!1),this.enableSimulation?this.start():this.setMaxIterations(1),this.chart&&this.chart.redraw(),this.setInitialRendering(!0))}setMaxIterations(e){this.maxIterations=h(e,this.options.maxIterations)}setTemperature(){this.temperature=this.startTemperature=Math.sqrt(this.nodes.length)}setDiffTemperature(){this.diffTemperature=this.startTemperature/(this.options.maxIterations+1)}setInitialRendering(e){this.initialRendering=e}createQuadTree(){this.quadTree=new r(this.box.left,this.box.top,this.box.width,this.box.height),this.quadTree.insertNodes(this.nodes)}initPositions(){let e=this.options.initialPositions;if(c(e))for(let t of(e.call(this),this.nodes))l(t.prevX)||(t.prevX=t.plotX),l(t.prevY)||(t.prevY=t.plotY),t.dispX=0,t.dispY=0;else"circle"===e?this.setCircularPositions():this.setRandomPositions()}setCircularPositions(){let e,t=this.box,i=this.nodes,r=2*Math.PI/(i.length+1),n=i.filter((function(e){return 0===e.linksTo.length})),o={},s=this.options.initialPositionRadius,a=e=>{for(let t of e.linksFrom||[])o[t.toNode.id]||(o[t.toNode.id]=!0,l.push(t.toNode),a(t.toNode))},l=[];for(let c of n)l.push(c),a(c);if(l.length)for(let c of i)-1===l.indexOf(c)&&l.push(c);else l=i;for(let c=0,u=l.length;c<u;++c)(e=l[c]).plotX=e.prevX=h(e.plotX,t.width/2+s*Math.cos(c*r)),e.plotY=e.prevY=h(e.plotY,t.height/2+s*Math.sin(c*r)),e.dispX=0,e.dispY=0}setRandomPositions(){let e,t=this.box,i=this.nodes,r=i.length+1,n=e=>{let t=e*e/Math.PI;return t-Math.floor(t)};for(let o=0,s=i.length;o<s;++o)(e=i[o]).plotX=e.prevX=h(e.plotX,t.width*n(o)),e.plotY=e.prevY=h(e.plotY,t.height*n(r+o)),e.dispX=0,e.dispY=0}force(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];this.integration[e].apply(this,i)}barycenterForces(){this.getBarycenter(),this.force("barycenter")}getBarycenter(){let e=0,t=0,i=0;for(let r of this.nodes)t+=r.plotX*r.mass,i+=r.plotY*r.mass,e+=r.mass;return this.barycenter={x:t,y:i,xFactor:t/e,yFactor:i/e},this.barycenter}barnesHutApproximation(e,t){let i,r,n=this.getDistXY(e,t),o=this.vectorLength(n);return e!==t&&0!==o&&(t.isInternal?t.boxSize/o<this.options.theta&&0!==o?(r=this.repulsiveForce(o,this.k),this.force("repulsive",e,r*t.mass,n,o),i=!1):i=!0:(r=this.repulsiveForce(o,this.k),this.force("repulsive",e,r*t.mass,n,o))),i}repulsiveForces(){if("barnes-hut"===this.approximation)for(let e of this.nodes)this.quadTree.visitNodeRecursive(null,(t=>this.barnesHutApproximation(e,t)));else{let e,t,i;for(let r of this.nodes)for(let n of this.nodes)r===n||r.fixedPosition||(i=this.getDistXY(r,n),0!==(t=this.vectorLength(i))&&(e=this.repulsiveForce(t,this.k),this.force("repulsive",r,e*n.mass,i,t)))}}attractiveForces(){let e,t,i;for(let r of this.links)r.fromNode&&r.toNode&&(e=this.getDistXY(r.fromNode,r.toNode),0!==(t=this.vectorLength(e))&&(i=this.attractiveForce(t,this.k),this.force("attractive",r,i,e,t)))}applyLimits(){for(let e of this.nodes)e.fixedPosition||(this.integration.integrate(this,e),this.applyLimitBox(e,this.box),e.dispX=0,e.dispY=0)}applyLimitBox(e,t){let i=e.radius;e.plotX=a(e.plotX,t.left+i,t.width-i),e.plotY=a(e.plotY,t.top+i,t.height-i)}coolDown(e,t,i){return e-t*i}isStable(){return 1e-5>Math.abs(this.systemTemperature-this.prevSystemTemperature)||this.temperature<=0}getSystemTemperature(){let e=0;for(let t of this.nodes)e+=t.temperature;return e}vectorLength(e){return Math.sqrt(e.x*e.x+e.y*e.y)}getDistR(e,t){let i=this.getDistXY(e,t);return this.vectorLength(i)}getDistXY(e,t){let i=e.plotX-t.plotX,r=e.plotY-t.plotY;return{x:i,y:r,absX:Math.abs(i),absY:Math.abs(r)}}}return d})),i(t,"Series/PackedBubble/PackedBubbleLayout.js",[t["Series/GraphLayoutComposition.js"],t["Series/PackedBubble/PackedBubbleIntegration.js"],t["Series/Networkgraph/ReingoldFruchtermanLayout.js"],t["Core/Utilities.js"]],(function(e,t,i,r){let{addEvent:n,pick:o}=r;function s(){let e=this.series,t=[];return e.forEach((e=>{e.parentNode&&e.parentNode.selected&&t.push(e.parentNode)})),t}function a(){this.allDataPoints&&delete this.allDataPoints}class l extends i{constructor(){super(...arguments),this.index=NaN,this.nodes=[],this.series=[]}static compose(r){i.compose(r),e.integrations.packedbubble=t,e.layouts.packedbubble=l;let o=r.prototype;o.getSelectedParentNodes||(n(r,"beforeRedraw",a),o.getSelectedParentNodes=s)}beforeStep(){this.options.marker&&this.series.forEach((e=>{e&&e.calculateParentRadius()}))}isStable(){let e=Math.abs(this.prevSystemTemperature-this.systemTemperature);return 1>Math.abs(10*this.systemTemperature/Math.sqrt(this.nodes.length))&&e<1e-5||this.temperature<=0}setCircularPositions(){let e,t,i=this.box,r=this.nodes,n=2*Math.PI/(r.length+1),s=this.options.initialPositionRadius,a=0;for(let l of r)this.options.splitSeries&&!l.isParentNode?(e=l.series.parentNode.plotX,t=l.series.parentNode.plotY):(e=i.width/2,t=i.height/2),l.plotX=l.prevX=o(l.plotX,e+s*Math.cos(l.index||a*n)),l.plotY=l.prevY=o(l.plotY,t+s*Math.sin(l.index||a*n)),l.dispX=0,l.dispY=0,a++}repulsiveForces(){let e,t,i,r=this,n=r.options.bubblePadding,o=r.nodes;o.forEach((s=>{s.degree=s.mass,s.neighbours=0,o.forEach((o=>{e=0,s!==o&&!s.fixedPosition&&(r.options.seriesInteraction||s.series===o.series)&&(i=r.getDistXY(s,o),(t=r.vectorLength(i)-(s.marker.radius+o.marker.radius+n))<0&&(s.degree+=.01,s.neighbours++,e=r.repulsiveForce(-t/Math.sqrt(s.neighbours),r.k,s,o)),r.force("repulsive",s,e*o.mass,i,o,t))}))}))}applyLimitBox(e,t){let i,r;this.options.splitSeries&&!e.isParentNode&&this.options.parentNodeLimit&&(i=this.getDistXY(e,e.series.parentNode),(r=e.series.parentNodeRadius-e.marker.radius-this.vectorLength(i))<0&&r>-2*e.marker.radius&&(e.plotX-=.01*i.x,e.plotY-=.01*i.y)),super.applyLimitBox(e,t)}}return e.layouts.packedbubble=l,l})),i(t,"Series/SimulationSeriesUtilities.js",[t["Core/Utilities.js"],t["Core/Animation/AnimationUtilities.js"]],(function(e,t){let{merge:i,syncTimeout:r}=e,{animObject:n}=t;return{initDataLabels:function(){let e=this.options.dataLabels;if(!this.dataLabelsGroup){let t=this.initDataLabelsGroup();return!this.chart.styledMode&&e?.style&&t.css(e.style),t.attr({opacity:0}),this.visible&&t.show(),t}return this.dataLabelsGroup.attr(i({opacity:1},this.getPlotBox("data-labels"))),this.dataLabelsGroup},initDataLabelsDefer:function(){let e=this.options.dataLabels;e?.defer&&this.options.layoutAlgorithm?.enableSimulation?r((()=>{this.deferDataLabels=!1}),e?n(e.animation).defer:0):this.deferDataLabels=!1}}})),i(t,"Extensions/TextPath.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],(function(e,t){let{deg2rad:i}=e,{addEvent:r,merge:n,uniqueKey:o,defined:s,extend:a}=t;function l(e,t){t=n(!0,{enabled:!0,attributes:{dy:-5,startOffset:"50%",textAnchor:"middle"}},t);let i=this.renderer.url,l=this.text||this,c=l.textPath,{attributes:u,enabled:h}=t;if(e=e||c&&c.path,c&&c.undo(),e&&h){let t=r(l,"afterModifyTree",(t=>{if(e&&h){let r=e.attr("id");r||e.attr("id",r=o());let n={x:0,y:0};s(u.dx)&&(n.dx=u.dx,delete u.dx),s(u.dy)&&(n.dy=u.dy,delete u.dy),l.attr(n),this.attr({transform:""}),this.box&&(this.box=this.box.destroy());let c=t.nodes.slice(0);t.nodes.length=0,t.nodes[0]={tagName:"textPath",attributes:a(u,{"text-anchor":u.textAnchor,href:`${i}#${r}`}),children:c}}}));l.textPath={path:e,undo:t}}else l.attr({dx:0,dy:0}),delete l.textPath;return this.added&&(l.textCache="",this.renderer.buildText(l)),this}function c(e){let t=e.bBox,r=this.element?.querySelector("textPath");if(r){let n=[],{b:o,h:s}=this.renderer.fontMetrics(this.element),a=s-o,l=RegExp('(<tspan>|<tspan(?!\\sclass="highcharts-br")[^>]*>|<\\/tspan>)',"g"),c=r.innerHTML.replace(l,"").split(/<tspan class="highcharts-br"[^>]*>/),u=c.length,h=(e,t)=>{let{x:n,y:s}=t,l=(r.getRotationOfChar(e)-90)*i,c=Math.cos(l),u=Math.sin(l);return[[n-a*c,s-a*u],[n+o*c,s+o*u]]};for(let t=0,i=0;i<u;i++){let o=c[i].length;for(let s=0;s<o;s+=5)try{let e=t+s+i,[o,a]=h(e,r.getStartPositionOfChar(e));0===s?(n.push(a),n.push(o)):(0===i&&n.unshift(a),i===u-1&&n.push(o))}catch(e){break}t+=o-1;try{let e=t+i,o=r.getEndPositionOfChar(e),[s,a]=h(e,o);n.unshift(a),n.unshift(s)}catch(e){break}}n.length&&n.push(n[0].slice()),t.polygon=n}return t}function u(e){let t=e.labelOptions,i=e.point,r=t[i.formatPrefix+"TextPath"]||t.textPath;r&&!t.useHTML&&(this.setTextPath(i.getDataLabelPath?.(this)||i.graphic,r),i.dataLabelPath&&!r.enabled&&(i.dataLabelPath=i.dataLabelPath.destroy()))}return{compose:function(e){r(e,"afterGetBBox",c),r(e,"beforeAddingDataLabel",u);let t=e.prototype;t.setTextPath||(t.setTextPath=l)}}})),i(t,"Series/PackedBubble/PackedBubbleSeries.js",[t["Core/Color/Color.js"],t["Series/DragNodesComposition.js"],t["Series/GraphLayoutComposition.js"],t["Core/Globals.js"],t["Series/PackedBubble/PackedBubblePoint.js"],t["Series/PackedBubble/PackedBubbleSeriesDefaults.js"],t["Series/PackedBubble/PackedBubbleLayout.js"],t["Core/Series/SeriesRegistry.js"],t["Series/SimulationSeriesUtilities.js"],t["Core/Utilities.js"],t["Core/Renderer/SVG/SVGElement.js"],t["Extensions/TextPath.js"]],(function(e,t,i,r,n,o,s,a,l,c,u,h){let{parse:d}=e,{noop:p}=r,{series:{prototype:f},seriesTypes:{bubble:m}}=a,{initDataLabels:g,initDataLabelsDefer:y}=l,{addEvent:_,clamp:v,defined:x,extend:b,fireEvent:w,isArray:S,isNumber:T,merge:M,pick:A}=c;h.compose(u);class C extends m{constructor(){super(...arguments),this.parentNodeMass=0,this.deferDataLabels=!0}static compose(e,i,r){m.compose(e,i,r),t.compose(i),s.compose(i)}accumulateAllPoints(){let e,t=this.chart,i=[];for(let r of t.series)if(r.is("packedbubble")&&r.reserveSpace()){e=r.yData||[];for(let t=0;t<e.length;t++)i.push([null,null,e[t],r.index,t,{id:t,marker:{radius:0}}])}return i}addLayout(){let e,t=this.options.layoutAlgorithm=this.options.layoutAlgorithm||{},r=t.type||"packedbubble",n=this.chart.options.chart,o=this.chart.graphLayoutsStorage,s=this.chart.graphLayoutsLookup;o||(this.chart.graphLayoutsStorage=o={},this.chart.graphLayoutsLookup=s=[]),(e=o[r])||(t.enableSimulation=x(n.forExport)?!n.forExport:t.enableSimulation,o[r]=e=new i.layouts[r],e.init(t),s.splice(e.index,0,e)),this.layout=e,this.points.forEach((e=>{e.mass=2,e.degree=1,e.collisionNmb=1})),e.setArea(0,0,this.chart.plotWidth,this.chart.plotHeight),e.addElementsToCollection([this],e.series),e.addElementsToCollection(this.points,e.nodes)}addSeriesLayout(){let e=this.options.layoutAlgorithm=this.options.layoutAlgorithm||{},t=e.type||"packedbubble",r=this.chart.graphLayoutsStorage,n=this.chart.graphLayoutsLookup,o=M(e,e.parentNodeOptions,{enableSimulation:this.layout.options.enableSimulation}),s=r[t+"-series"];s||(r[t+"-series"]=s=new i.layouts[t],s.init(o),n.splice(s.index,0,s)),this.parentNodeLayout=s,this.createParentNodes()}calculateParentRadius(){let e=this.seriesBox();this.parentNodeRadius=v(Math.sqrt(2*this.parentNodeMass/Math.PI)+20,20,e?Math.max(Math.sqrt(Math.pow(e.width,2)+Math.pow(e.height,2))/2+20,20):Math.sqrt(2*this.parentNodeMass/Math.PI)+20),this.parentNode&&(this.parentNode.marker.radius=this.parentNode.radius=this.parentNodeRadius)}calculateZExtremes(){let e=this.chart.series,t=this.options.zMin,i=this.options.zMax,r=1/0,n=-1/0;return t&&i?[t,i]:(e.forEach((e=>{e.yData.forEach((e=>{x(e)&&(e>n&&(n=e),e<r&&(r=e))}))})),[t=A(t,r),i=A(i,n)])}checkOverlap(e,t){let i=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(i*i+r*r)-Math.abs(e[2]+t[2])<-.001}createParentNodes(){let e,t=this.pointClass,i=this.chart,r=this.parentNodeLayout,n=this.layout.options,o=this.parentNode,s={radius:this.parentNodeRadius,lineColor:this.color,fillColor:d(this.color).brighten(.4).get()};n.parentNodeOptions&&(s=M(n.parentNodeOptions.marker||{},s)),this.parentNodeMass=0,this.points.forEach((e=>{this.parentNodeMass+=Math.PI*Math.pow(e.marker.radius,2)})),this.calculateParentRadius(),r.nodes.forEach((t=>{t.seriesIndex===this.index&&(e=!0)})),r.setArea(0,0,i.plotWidth,i.plotHeight),e||(o||(o=new t(this,{mass:this.parentNodeRadius/2,marker:s,dataLabels:{inside:!1},states:{normal:{marker:s},hover:{marker:s}},dataLabelOnNull:!0,degree:this.parentNodeRadius,isParentNode:!0,seriesIndex:this.index})),this.parentNode&&(o.plotX=this.parentNode.plotX,o.plotY=this.parentNode.plotY),this.parentNode=o,r.addElementsToCollection([this],r.series),r.addElementsToCollection([o],r.nodes))}deferLayout(){let e=this.options.layoutAlgorithm;this.visible&&(this.addLayout(),e.splitSeries&&this.addSeriesLayout())}destroy(){this.chart.graphLayoutsLookup&&this.chart.graphLayoutsLookup.forEach((e=>{e.removeElementFromCollection(this,e.series)}),this),this.parentNode&&this.parentNodeLayout&&(this.parentNodeLayout.removeElementFromCollection(this.parentNode,this.parentNodeLayout.nodes),this.parentNode.dataLabel&&(this.parentNode.dataLabel=this.parentNode.dataLabel.destroy())),f.destroy.apply(this,arguments)}drawDataLabels(){!this.deferDataLabels&&(f.drawDataLabels.call(this,this.points),this.parentNode&&(this.parentNode.formatPrefix="parentNode",f.drawDataLabels.call(this,[this.parentNode])))}drawGraph(){if(!this.layout||!this.layout.options.splitSeries)return;let e=this.chart,t=this.layout.options.parentNodeOptions.marker,i={fill:t.fillColor||d(this.color).brighten(.4).get(),opacity:t.fillOpacity,stroke:t.lineColor||this.color,"stroke-width":A(t.lineWidth,this.options.lineWidth)},r={};this.parentNodesGroup=this.plotGroup("parentNodesGroup","parentNode",this.visible?"inherit":"hidden",.1,e.seriesGroup),this.group?.attr({zIndex:2}),this.calculateParentRadius(),this.parentNode&&x(this.parentNode.plotX)&&x(this.parentNode.plotY)&&x(this.parentNodeRadius)&&(r=M({x:this.parentNode.plotX-this.parentNodeRadius,y:this.parentNode.plotY-this.parentNodeRadius,width:2*this.parentNodeRadius,height:2*this.parentNodeRadius},i),this.parentNode.graphic||(this.graph=this.parentNode.graphic=e.renderer.symbol(i.symbol).add(this.parentNodesGroup)),this.parentNode.graphic.attr(r))}drawTracker(){let e,t=this.parentNode;super.drawTracker(),t&&(e=S(t.dataLabels)?t.dataLabels:t.dataLabel?[t.dataLabel]:[],t.graphic&&(t.graphic.element.point=t),e.forEach((e=>{(e.div||e.element).point=t})))}getPointRadius(){let e,t,i,r,n=this.chart,o=n.plotWidth,s=n.plotHeight,a=this.options,l=a.useSimulation,c=Math.min(o,s),u={},h=[],d=n.allDataPoints||[],p=d.length;["minSize","maxSize"].forEach((e=>{let t=parseInt(a[e],10),i=/%$/.test(a[e]);u[e]=i?c*t/100:t*Math.sqrt(p)})),n.minRadius=e=u.minSize/Math.sqrt(p),n.maxRadius=t=u.maxSize/Math.sqrt(p);let f=l?this.calculateZExtremes():[e,t];d.forEach(((n,o)=>{i=l?v(n[2],f[0],f[1]):n[2],0===(r=this.getRadius(f[0],f[1],e,t,i))&&(r=null),d[o][2]=r,h.push(r)})),this.radii=h}init(){return f.init.apply(this,arguments),y.call(this),this.eventsToUnbind.push(_(this,"updatedData",(function(){this.chart.series.forEach((e=>{e.type===this.type&&(e.isDirty=!0)}),this)}))),this}onMouseUp(e){if(e.fixedPosition&&!e.removed){let i,r=this.layout,n=this.parentNodeLayout;n&&r.options.dragBetweenSeries&&n.nodes.forEach((t=>{e&&e.marker&&t!==e.series.parentNode&&(i=r.getDistXY(e,t),r.vectorLength(i)-t.marker.radius-e.marker.radius<0&&(t.series.addPoint(M(e.options,{plotX:e.plotX,plotY:e.plotY}),!1),r.removeElementFromCollection(e,r.nodes),e.remove()))})),t.onMouseUp.apply(this,arguments)}}placeBubbles(e){let t,i,r=this.checkOverlap,n=this.positionBubble,o=[],s=1,a=0,l=0,c=[],u=e.sort(((e,t)=>t[2]-e[2]));if(u.length){if(o.push([[0,0,u[0][2],u[0][3],u[0][4]]]),u.length>1)for(o.push([[0,0-u[1][2]-u[0][2],u[1][2],u[1][3],u[1][4]]]),i=2;i<u.length;i++)u[i][2]=u[i][2]||1,r(t=n(o[s][a],o[s-1][l],u[i]),o[s][0])?(o.push([]),l=0,o[s+1].push(n(o[s][a],o[s][0],u[i])),s++,a=0):s>1&&o[s-1][l+1]&&r(t,o[s-1][l+1])?(l++,o[s].push(n(o[s][a],o[s-1][l],u[i])),a++):(a++,o[s].push(t));this.chart.stages=o,this.chart.rawPositions=[].concat.apply([],o),this.resizeRadius(),c=this.chart.rawPositions}return c}pointAttribs(e,t){let i=this.options,r=e&&e.isParentNode,n=i.marker;r&&i.layoutAlgorithm&&i.layoutAlgorithm.parentNodeOptions&&(n=i.layoutAlgorithm.parentNodeOptions.marker);let o=n.fillOpacity,s=f.pointAttribs.call(this,e,t);return 1!==o&&(s["fill-opacity"]=o),s}positionBubble(e,t,i){let r=Math.asin,n=Math.acos,o=Math.pow,s=Math.abs,a=(0,Math.sqrt)(o(e[0]-t[0],2)+o(e[1]-t[1],2)),l=n((o(a,2)+o(i[2]+t[2],2)-o(i[2]+e[2],2))/(2*(i[2]+t[2])*a)),c=r(s(e[0]-t[0])/a),u=(e[1]-t[1]<0?0:Math.PI)+l+c*((e[0]-t[0])*(e[1]-t[1])<0?1:-1),h=Math.cos(u),d=Math.sin(u);return[t[0]+(t[2]+i[2])*d,t[1]-(t[2]+i[2])*h,i[2],i[3],i[4]]}render(){let e=[];f.render.apply(this,arguments),!this.options.dataLabels.allowOverlap&&(this.data.forEach((t=>{S(t.dataLabels)&&t.dataLabels.forEach((t=>{e.push(t)}))})),this.options.useSimulation&&this.chart.hideOverlappingLabels(e))}resizeRadius(){let e,t,i,r,n,o=this.chart,s=o.rawPositions,a=Math.min,l=Math.max,c=o.plotLeft,u=o.plotTop,h=o.plotHeight,d=o.plotWidth;for(let g of(e=i=Number.POSITIVE_INFINITY,t=r=Number.NEGATIVE_INFINITY,s))n=g[2],e=a(e,g[0]-n),t=l(t,g[0]+n),i=a(i,g[1]-n),r=l(r,g[1]+n);let p=[t-e,r-i],f=[(d-c)/p[0],(h-u)/p[1]],m=a.apply([],f);if(Math.abs(m-1)>1e-10){for(let e of s)e[2]*=m;this.placeBubbles(s)}else o.diffY=h/2+u-i-(r-i)/2,o.diffX=d/2+c-e-(t-e)/2}seriesBox(){let e,t=this.chart,i=this.data,r=Math.max,n=Math.min,o=[t.plotLeft,t.plotLeft+t.plotWidth,t.plotTop,t.plotTop+t.plotHeight];return i.forEach((t=>{x(t.plotX)&&x(t.plotY)&&t.marker.radius&&(e=t.marker.radius,o[0]=n(o[0],t.plotX-e),o[1]=r(o[1],t.plotX+e),o[2]=n(o[2],t.plotY-e),o[3]=r(o[3],t.plotY+e))})),T(o.width/o.height)?o:null}setVisible(){let e=this;f.setVisible.apply(e,arguments),e.parentNodeLayout&&e.graph?e.visible?(e.graph.show(),e.parentNode.dataLabel&&e.parentNode.dataLabel.show()):(e.graph.hide(),e.parentNodeLayout.removeElementFromCollection(e.parentNode,e.parentNodeLayout.nodes),e.parentNode.dataLabel&&e.parentNode.dataLabel.hide()):e.layout&&(e.visible?e.layout.addElementsToCollection(e.points,e.layout.nodes):e.points.forEach((t=>{e.layout.removeElementFromCollection(t,e.layout.nodes)})))}translate(){let e,t,i,r=this.chart,n=this.data,o=this.index,s=this.options.useSimulation;for(let a of(this.processedXData=this.xData,this.generatePoints(),x(r.allDataPoints)||(r.allDataPoints=this.accumulateAllPoints(),this.getPointRadius()),s?i=r.allDataPoints:(i=this.placeBubbles(r.allDataPoints),this.options.draggable=!1),i))a[3]===o&&(e=n[a[4]],t=A(a[2],void 0),s||(e.plotX=a[0]-r.plotLeft+r.diffX,e.plotY=a[1]-r.plotTop+r.diffY),T(t)&&(e.marker=b(e.marker,{radius:t,width:2*t,height:2*t}),e.radius=t));s&&this.deferLayout(),w(this,"afterTranslate")}}return C.defaultOptions=M(m.defaultOptions,o),b(C.prototype,{pointClass:n,axisTypes:[],directTouch:!0,forces:["barycenter","repulsive"],hasDraggableNodes:!0,invertible:!1,isCartesian:!1,noSharedTooltip:!0,pointArrayMap:["value"],pointValKey:"value",requireSorting:!1,trackerGroups:["group","dataLabelsGroup","parentNodesGroup"],initDataLabels:g,alignDataLabel:f.alignDataLabel,indexateNodes:p,onMouseDown:t.onMouseDown,onMouseMove:t.onMouseMove,redrawHalo:t.redrawHalo,searchPoint:p}),a.registerSeriesType("packedbubble",C),C})),i(t,"Series/Polygon/PolygonSeriesDefaults.js",[],(function(){return{marker:{enabled:!1,states:{hover:{enabled:!1}}},stickyTracking:!1,tooltip:{followPointer:!0,pointFormat:""},trackByArea:!0,legendSymbol:"rectangle"}})),i(t,"Series/Polygon/PolygonSeries.js",[t["Core/Globals.js"],t["Series/Polygon/PolygonSeriesDefaults.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],(function(e,t,i,r){let{noop:n}=e,{area:o,line:s,scatter:a}=i.seriesTypes,{extend:l,merge:c}=r;class u extends a{getGraphPath(){let e=s.prototype.getGraphPath.call(this),t=e.length+1;for(;t--;)(t===e.length||"M"===e[t][0])&&t>0&&e.splice(t,0,["Z"]);return this.areaPath=e,e}drawGraph(){this.options.fillColor=this.color,o.prototype.drawGraph.call(this)}}return u.defaultOptions=c(a.defaultOptions,t),l(u.prototype,{type:"polygon",drawTracker:s.prototype.drawTracker,setStackedPoints:n}),i.registerSeriesType("polygon",u),u})),i(t,"Core/Axis/RadialAxisDefaults.js",[],(function(){return{circular:{gridLineWidth:1,labels:{align:void 0,x:0,y:void 0,style:{textOverflow:"none"}},maxPadding:0,minPadding:0,showLastLabel:!1,tickLength:0},radial:{gridLineInterpolation:"circle",gridLineWidth:1,labels:{align:"right",padding:5,x:-3,y:-2},showLastLabel:!1,title:{x:4,text:null,rotation:90}},radialGauge:{endOnTick:!1,gridLineWidth:0,labels:{align:"center",distance:-25,x:0,y:void 0},lineWidth:1,minorGridLineWidth:0,minorTickInterval:"auto",minorTickLength:10,minorTickPosition:"inside",minorTickWidth:1,startOnTick:!1,tickLength:10,tickPixelInterval:100,tickPosition:"inside",tickWidth:2,title:{rotation:0,text:""},zIndex:2}}})),i(t,"Core/Axis/RadialAxis.js",[t["Core/Axis/RadialAxisDefaults.js"],t["Core/Defaults.js"],t["Core/Globals.js"],t["Core/Utilities.js"]],(function(e,t,i,r){var n;let{defaultOptions:o}=t,{composed:s,noop:a}=i,{addEvent:l,correctFloat:c,defined:u,extend:h,fireEvent:d,isObject:p,merge:f,pick:m,pushUnique:g,relativeLength:y,wrap:_}=r;return function(t){function r(){this.autoConnect=this.isCircular&&void 0===m(this.userMax,this.options.max)&&c(this.endAngleRad-this.startAngleRad)===c(2*Math.PI),!this.isCircular&&this.chart.inverted&&this.max++,this.autoConnect&&(this.max+=(this.categories?1:this.pointRange)||this.closestPointRange||0)}function n(){return()=>{if(this.isRadial&&this.tickPositions&&this.options.labels&&!0!==this.options.labels.allowOverlap)return this.tickPositions.map((e=>this.ticks[e]&&this.ticks[e].label)).filter((e=>!!e))}}function v(){return a}function x(e,t,i){let r,n,o,s=this.pane.center,a=e.value;return this.isCircular?(u(a)?e.point&&(e.point.shapeArgs||{}).start&&(a=this.chart.inverted?this.translate(e.point.rectPlotY,!0):e.point.x):(n=e.chartX||0,o=e.chartY||0,a=this.translate(Math.atan2(o-i,n-t)-this.startAngleRad,!0)),n=(r=this.getPosition(a)).x,o=r.y):(u(a)||(n=e.chartX,o=e.chartY),u(n)&&u(o)&&(i=s[1]+this.chart.plotTop,a=this.translate(Math.min(Math.sqrt(Math.pow(n-t,2)+Math.pow(o-i,2)),s[2]/2)-s[3]/2,!0))),[a,n||0,o||0]}function b(e,t,i){let r,n,o=this.pane.center,s=this.chart,a=this.left||0,l=this.top||0,c=m(t,o[2]/2-this.offset);return void 0===i&&(i=this.horiz?0:this.center&&-this.center[3]/2),i&&(c+=i),this.isCircular||void 0!==t?((n=this.chart.renderer.symbols.arc(a+o[0],l+o[1],c,c,{start:this.startAngleRad,end:this.endAngleRad,open:!0,innerR:0})).xBounds=[a+o[0]],n.yBounds=[l+o[1]-c]):(r=this.postTranslate(this.angleRad,c),n=[["M",this.center[0]+s.plotLeft,this.center[1]+s.plotTop],["L",r.x,r.y]]),n}function w(){this.constructor.prototype.getOffset.call(this),this.chart.axisOffset[this.side]=0}function S(e,t,i){let r,n,o,s,a,l,c=this.chart,u=e=>{if("string"==typeof e){let t=parseInt(e,10);return _.test(e)&&(t=t*p/100),t}return e},h=this.center,d=this.startAngleRad,p=h[2]/2,f=Math.min(this.offset,0),g=this.left||0,y=this.top||0,_=/%$/,v=this.isCircular,x=m(u(i.outerRadius),p),b=u(i.innerRadius),w=m(u(i.thickness),10);if("polygon"===this.options.gridLineInterpolation)l=this.getPlotLinePath({value:e}).concat(this.getPlotLinePath({value:t,reverse:!0}));else{e=Math.max(e,this.min),t=Math.min(t,this.max);let u=this.translate(e),p=this.translate(t);v||(x=u||0,b=p||0),"circle"!==i.shape&&v?(r=d+(u||0),n=d+(p||0)):(r=-Math.PI/2,n=1.5*Math.PI,a=!0),x-=f,w-=f,l=c.renderer.symbols.arc(g+h[0],y+h[1],x,x,{start:Math.min(r,n),end:Math.max(r,n),innerR:m(b,x-w),open:a,borderRadius:i.borderRadius}),v&&(o=(n+r)/2,s=g+h[0]+h[2]/2*Math.cos(o),l.xBounds=o>-Math.PI/2&&o<Math.PI/2?[s,c.plotWidth]:[0,s],l.yBounds=[y+h[1]+h[2]/2*Math.sin(o)],l.yBounds[0]+=o>-Math.PI&&o<0||o>Math.PI?-10:10)}return l}function T(e){let t,i,r,n,o,s,a,l,c,u=this.pane.center,h=this.chart,d=h.inverted,p=e.reverse,f=this.pane.options.background?this.pane.options.background[0]||this.pane.options.background:{},m=f.innerRadius||"0%",g=f.outerRadius||"100%",_=u[0]+h.plotLeft,v=u[1]+h.plotTop,x=this.height,b=e.isCrosshair,w=u[3]/2,S=e.value,T=this.getPosition(S),M=T.x,A=T.y;if(b&&(S=(l=this.getCrosshairPosition(e,_,v))[0],M=l[1],A=l[2]),this.isCircular)i=Math.sqrt(Math.pow(M-_,2)+Math.pow(A-v,2)),r="string"==typeof m?y(m,1):m/i,n="string"==typeof g?y(g,1):g/i,u&&w&&(r<(t=w/i)&&(r=t),n<t&&(n=t)),c=[["M",_+r*(M-_),v-r*(v-A)],["L",M-(1-n)*(M-_),A+(1-n)*(v-A)]];else if((S=this.translate(S))&&(S<0||S>x)&&(S=0),"circle"===this.options.gridLineInterpolation)c=this.getLinePath(0,S,w);else if(c=[],h[d?"yAxis":"xAxis"].forEach((e=>{e.pane===this.pane&&(o=e)})),o){a=o.tickPositions,o.autoConnect&&(a=a.concat([a[0]])),p&&(a=a.slice().reverse()),S&&(S+=w);for(let e=0;e<a.length;e++)s=o.getPosition(a[e],S),c.push(e?["L",s.x,s.y]:["M",s.x,s.y])}return c}function M(e,t){let i=this.translate(e);return this.postTranslate(this.isCircular?i:this.angleRad,m(this.isCircular?t:i<0?0:i,this.center[2]/2)-this.offset)}function A(){let e=this.center,t=this.chart,i=this.options.title;return{x:t.plotLeft+e[0]+(i.x||0),y:t.plotTop+e[1]-{high:.5,middle:.25,low:0}[i.align]*e[2]+(i.y||0)}}function C(e){e.beforeSetTickPositions=r,e.createLabelCollector=n,e.getCrosshairPosition=x,e.getLinePath=b,e.getOffset=w,e.getPlotBandPath=S,e.getPlotLinePath=T,e.getPosition=M,e.getTitlePosition=A,e.postTranslate=O,e.setAxisSize=B,e.setAxisTranslation=N,e.setOptions=j}function E(){let e=this.chart,t=this.options,i=e.angular&&this.isXAxis,r=this.pane,n=r&&r.options;if(!i&&r&&(e.angular||e.polar)){let e=2*Math.PI,i=(m(n.startAngle,0)-90)*Math.PI/180,r=(m(n.endAngle,m(n.startAngle,0)+360)-90)*Math.PI/180;this.angleRad=(t.angle||0)*Math.PI/180,this.startAngleRad=i,this.endAngleRad=r,this.offset=t.offset||0;let o=(i%e+e)%e,s=(r%e+e)%e;o>Math.PI&&(o-=e),s>Math.PI&&(s-=e),this.normalizedStartAngleRad=o,this.normalizedEndAngleRad=s}}function P(e){this.isRadial&&(e.align=void 0,e.preventDefault())}function k(){if(this.chart&&this.chart.labelCollectors){let e=this.labelCollector?this.chart.labelCollectors.indexOf(this.labelCollector):-1;e>=0&&this.chart.labelCollectors.splice(e,1)}}function I(e){let t,i=this.chart,r=i.angular,n=i.polar,o=this.isXAxis,s=this.coll,l=e.userOptions.pane||0,c=this.pane=i.pane&&i.pane[l];"colorAxis"!==s?(r?(r&&o?(this.isHidden=!0,this.createLabelCollector=v,this.getOffset=a,this.redraw=F,this.render=F,this.setScale=a,this.setCategories=a,this.setTitle=a):C(this),t=!o):n&&(C(this),t=this.horiz),r||n?(this.isRadial=!0,this.labelCollector||(this.labelCollector=this.createLabelCollector()),this.labelCollector&&i.labelCollectors.push(this.labelCollector)):this.isRadial=!1,c&&t&&(c.axis=this),this.isCircular=t):this.isRadial=!1}function D(){this.isRadial&&this.beforeSetTickPositions()}function L(e){let t=this.label;if(!t)return;let i,r=this.axis,n=t.getBBox(),o=r.options.labels,s=(r.translate(this.pos)+r.startAngleRad+Math.PI/2)/Math.PI*180%360,a=Math.round(s),l=u(o.y)?0:-.3*n.height,c=o.y,h=20,d=o.align,p="end",f=a<0?a+360:a,g=f,_=0,v=0;r.isRadial&&(i=r.getPosition(this.pos,r.center[2]/2+y(m(o.distance,-25),r.center[2]/2,-r.center[2]/2)),"auto"===o.rotation?t.attr({rotation:s}):u(c)||(c=r.chart.renderer.fontMetrics(t).b-n.height/2),u(d)||(r.isCircular?(n.width>r.len*r.tickInterval/(r.max-r.min)&&(h=0),d=s>h&&s<180-h?"left":s>180+h&&s<360-h?"right":"center"):d="center",t.attr({align:d})),"auto"===d&&2===r.tickPositions.length&&r.isCircular&&(f>90&&f<180?f=180-f:f>270&&f<=360&&(f=540-f),g>180&&g<=360&&(g=360-g),(r.pane.options.startAngle===a||r.pane.options.startAngle===a+360||r.pane.options.startAngle===a-360)&&(p="start"),d=a>=-90&&a<=90||a>=-360&&a<=-270||a>=270&&a<=360?"start"===p?"right":"left":"start"===p?"left":"right",g>70&&g<110&&(d="center"),f<15||f>=180&&f<195?_=.3*n.height:f>=15&&f<=35?_="start"===p?0:.75*n.height:f>=195&&f<=215?_="start"===p?.75*n.height:0:f>35&&f<=90?_="start"===p?-.25*n.height:n.height:f>215&&f<=270&&(_="start"===p?n.height:-.25*n.height),g<15?v="start"===p?-.15*n.height:.15*n.height:g>165&&g<=180&&(v="start"===p?.15*n.height:-.15*n.height),t.attr({align:d}),t.translate(v,_+l)),e.pos.x=i.x+(o.x||0),e.pos.y=i.y+(c||0))}function R(e){this.axis.getPosition&&h(e.pos,this.axis.getPosition(this.pos))}function z(e){let{options:i}=e;i.xAxis&&f(!0,t.radialDefaultOptions.circular,i.xAxis),i.yAxis&&f(!0,t.radialDefaultOptions.radialGauge,i.yAxis)}function O(e,t){let i=this.chart,r=this.center;return e=this.startAngleRad+e,{x:i.plotLeft+r[0]+Math.cos(e)*t,y:i.plotTop+r[1]+Math.sin(e)*t}}function F(){this.isDirty=!1}function B(){let e,t;this.constructor.prototype.setAxisSize.call(this),this.isRadial&&(this.pane.updateCenter(this),e=this.center=this.pane.center.slice(),this.isCircular?this.sector=this.endAngleRad-this.startAngleRad:(t=this.postTranslate(this.angleRad,e[3]/2),e[0]=t.x-this.chart.plotLeft,e[1]=t.y-this.chart.plotTop),this.len=this.width=this.height=(e[2]-e[3])*m(this.sector,1)/2)}function N(){this.constructor.prototype.setAxisTranslation.call(this),this.center&&(this.isCircular?this.transA=(this.endAngleRad-this.startAngleRad)/(this.max-this.min||1):this.transA=(this.center[2]-this.center[3])/2/(this.max-this.min||1),this.isXAxis?this.minPixelPadding=this.transA*this.minPointOffset:this.minPixelPadding=0)}function j(e){let{coll:i}=this,{angular:r,inverted:n,polar:s}=this.chart,a={};r?this.isXAxis||(a=f(o.yAxis,t.radialDefaultOptions.radialGauge)):s&&(a=this.horiz?f(o.xAxis,t.radialDefaultOptions.circular):f("xAxis"===i?o.xAxis:o.yAxis,t.radialDefaultOptions.radial)),n&&"yAxis"===i&&(a.stackLabels=p(o.yAxis,!0)?o.yAxis.stackLabels:{},a.reversedStacks=!0);let l=this.options=f(a,e);l.plotBands||(l.plotBands=[]),d(this,"afterSetOptions")}function V(e,t,i,r,n,o,s){let a,l=this.axis;return l.isRadial?["M",t,i,"L",(a=l.getPosition(this.pos,l.center[2]/2+r)).x,a.y]:e.call(this,t,i,r,n,o,s)}t.radialDefaultOptions=f(e),t.compose=function(e,t){return g(s,"Axis.Radial")&&(l(e,"afterInit",E),l(e,"autoLabelAlign",P),l(e,"destroy",k),l(e,"init",I),l(e,"initialAxisTranslation",D),l(t,"afterGetLabelPosition",L),l(t,"afterGetPosition",R),l(i,"setOptions",z),_(t.prototype,"getMarkPath",V)),e}}(n||(n={})),n})),i(t,"Series/PolarComposition.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Globals.js"],t["Core/Series/Series.js"],t["Extensions/Pane/Pane.js"],t["Core/Axis/RadialAxis.js"],t["Core/Utilities.js"]],(function(e,t,i,r,n,o){let{animObject:s}=e,{composed:a}=t,{addEvent:l,defined:c,find:u,isNumber:h,merge:d,pick:p,pushUnique:f,relativeLength:m,splat:g,uniqueKey:y,wrap:_}=o;function v(){(this.pane||[]).forEach((e=>{e.render()}))}function x(e){let t=e.args[0].xAxis,i=e.args[0].yAxis,r=e.args[0].chart;t&&i&&("polygon"===i.gridLineInterpolation?(t.startOnTick=!0,t.endOnTick=!0):"polygon"===t.gridLineInterpolation&&r.inverted&&(i.startOnTick=!0,i.endOnTick=!0))}function b(){this.pane||(this.pane=[]),this.options.pane=g(this.options.pane),this.options.pane.forEach((e=>{new r(e,this)}),this)}function w(e){let t=e.args.marker,i=this.chart.xAxis[0],r=this.chart.yAxis[0],n=this.chart.inverted,o=n?r:i,s=n?i:r;if(this.chart.polar){e.preventDefault();let i=(t.attr?t.attr("start"):t.start)-o.startAngleRad,r=t.attr?t.attr("r"):t.r,n=(t.attr?t.attr("end"):t.end)-o.startAngleRad,a=t.attr?t.attr("innerR"):t.innerR;e.result.x=i+o.pos,e.result.width=n-i,e.result.y=s.len+s.pos-r,e.result.height=r-a}}function S(e){let t=this.chart;if(t.polar&&t.hoverPane&&t.hoverPane.axis){e.preventDefault();let i=t.hoverPane.center,r=t.mouseDownX||0,n=t.mouseDownY||0,o=e.args.chartY,s=e.args.chartX,a=2*Math.PI,l=t.hoverPane.axis.startAngleRad,c=t.hoverPane.axis.endAngleRad,u=t.inverted?t.xAxis[0]:t.yAxis[0],h={},d="arc";if(h.x=i[0]+t.plotLeft,h.y=i[1]+t.plotTop,this.zoomHor){let e=l>0?c-l:Math.abs(l)+Math.abs(c),p=Math.atan2(n-t.plotTop-i[1],r-t.plotLeft-i[0])-l,f=Math.atan2(o-t.plotTop-i[1],s-t.plotLeft-i[0])-l;h.r=i[2]/2,h.innerR=i[3]/2,p<=0&&(p+=a),f<=0&&(f+=a),f<p&&(f=[p,p=f][0]),e<a&&l+f>c+(a-e)/2&&(f=p,p=l<=0?l:0);let m=h.start=Math.max(p+l,l),g=h.end=Math.min(f+l,c);if("polygon"===u.options.gridLineInterpolation){let e=t.hoverPane.axis,r=m-e.startAngleRad+e.pos,n=u.getPlotLinePath({value:u.max}),o=e.toValue(r),s=e.toValue(r+(g-m));if(o<e.getExtremes().min){let{min:t,max:i}=e.getExtremes();o=i-(t-o)}if(s<e.getExtremes().min){let{min:t,max:i}=e.getExtremes();s=i-(t-s)}s<o&&(s=[o,o=s][0]),(n=C(n,o,s,e)).push(["L",i[0]+t.plotLeft,t.plotTop+i[1]]),h.d=n,d="path"}}if(this.zoomVert){let e=t.inverted?t.xAxis[0]:t.yAxis[0],a=Math.sqrt(Math.pow(r-t.plotLeft-i[0],2)+Math.pow(n-t.plotTop-i[1],2)),u=Math.sqrt(Math.pow(s-t.plotLeft-i[0],2)+Math.pow(o-t.plotTop-i[1],2));if(u<a&&(a=[u,u=a][0]),u>i[2]/2&&(u=i[2]/2),a<i[3]/2&&(a=i[3]/2),this.zoomHor||(h.start=l,h.end=c),h.r=u,h.innerR=a,"polygon"===e.options.gridLineInterpolation){let t=e.toValue(e.len+e.pos-a),i=e.toValue(e.len+e.pos-u),r=e.getPlotLinePath({value:i}).concat(e.getPlotLinePath({value:t,reverse:!0}));h.d=r,d="path"}}if(this.zoomHor&&this.zoomVert&&"polygon"===u.options.gridLineInterpolation){let e=t.hoverPane.axis,i=h.start||0,r=h.end||0,n=i-e.startAngleRad+e.pos,o=e.toValue(n),s=e.toValue(n+(r-i));if(h.d instanceof Array){let e=h.d.slice(0,h.d.length/2),i=h.d.slice(h.d.length/2,h.d.length);i=[...i].reverse();let r=t.hoverPane.axis;e=C(e,o,s,r),(i=C(i,o,s,r))&&(i[0][0]="L"),i=[...i].reverse(),h.d=e.concat(i),d="path"}}e.attrs=h,e.shapeType=d}}function T(){let e=this.chart;e.polar&&(this.polar=new F(this),e.inverted&&(this.isRadialSeries=!0,this.is("column")&&(this.isRadialBar=!0)))}function M(){if(this.chart.polar&&this.xAxis){let{xAxis:e,yAxis:i}=this,r=this.chart;this.kdByAngle=r.tooltip&&r.tooltip.shared,this.kdByAngle||r.inverted?this.searchPoint=A:this.options.findNearestPointBy="xy";let n=this.points,o=n.length;for(;o--;)this.is("column")||this.is("columnrange")||this.polar.toXY(n[o]),r.hasParallelCoordinates||this.yAxis.reversed||(p(n[o].y,Number.MIN_VALUE)<i.min||n[o].x<e.min||n[o].x>e.max?(n[o].isNull=!0,n[o].plotY=NaN):n[o].isNull=n[o].isValid&&!n[o].isValid());this.hasClipCircleSetter||(this.hasClipCircleSetter=!!this.eventsToUnbind.push(l(this,"afterRender",(function(){let e;r.polar&&!1!==this.options.clip&&(e=this.yAxis.pane.center,this.clipCircle?this.clipCircle.animate({x:e[0],y:e[1],r:e[2]/2,innerR:e[3]/2}):this.clipCircle=function(e,t,i,r,n){let o=y(),s=e.createElement("clipPath").attr({id:o}).add(e.defs),a=n?e.arc(t,i,r,n,0,2*Math.PI).add(s):e.circle(t,i,r).add(s);return a.id=o,a.clipPath=s,a}(r.renderer,e[0],e[1],e[2]/2,e[3]/2),this.group.clip(this.clipCircle),this.setClip=t.noop)}))))}}function A(e){let t=this.chart,i=this.xAxis,r=this.yAxis,n=i.pane&&i.pane.center,o=e.chartX-(n&&n[0]||0)-t.plotLeft,s=e.chartY-(n&&n[1]||0)-t.plotTop,a=t.inverted?{clientX:e.chartX-r.pos,plotY:e.chartY-i.pos}:{clientX:180+-180/Math.PI*Math.atan2(o,s)};return this.searchKDTree(a)}function C(e,t,i,r){let n=r.tickInterval,o=r.tickPositions,s=u(o,(e=>e>=i)),a=u([...o].reverse(),(e=>e<=t));return c(s)||(s=o[o.length-1]),c(a)||(a=o[0],s+=n,e[0][0]="L",e.unshift(e[e.length-3])),(e=e.slice(o.indexOf(a),o.indexOf(s)+1))[0][0]="M",e}function E(e,t){return u(this.pane||[],(e=>e.options.id===t))||e.call(this,t)}function P(e,t,r,n,o,s){let a,l,c,u=this.chart,h=p(n.inside,!!this.options.stacking);if(u.polar){if(a=t.rectPlotX/Math.PI*180,u.inverted)this.forceDL=u.isInsidePlot(t.plotX,t.plotY),h&&t.shapeArgs?(l=t.shapeArgs,o=d(o,{x:(c=this.yAxis.postTranslate(((l.start||0)+(l.end||0))/2-this.xAxis.startAngleRad,t.barX+t.pointWidth/2)).x-u.plotLeft,y:c.y-u.plotTop})):t.tooltipPos&&(o=d(o,{x:t.tooltipPos[0],y:t.tooltipPos[1]})),n.align=p(n.align,"center"),n.verticalAlign=p(n.verticalAlign,"middle");else{var f;let e,t;null===(f=n).align&&(e=a>20&&a<160?"left":a>200&&a<340?"right":"center",f.align=e),null===f.verticalAlign&&(t=a<45||a>315?"bottom":a>135&&a<225?"top":"middle",f.verticalAlign=t),n=f}i.prototype.alignDataLabel.call(this,t,r,n,o,s),this.isRadialBar&&t.shapeArgs&&t.shapeArgs.start===t.shapeArgs.end?r.hide():r.show()}else e.call(this,t,r,n,o,s)}function k(){let e,t,i,r,n,s,a,l,u,d,p,f,g,y=this.options,_=y.stacking,v=this.chart,x=this.xAxis,b=this.yAxis,w=b.reversed,S=b.center,T=x.startAngleRad,M=x.endAngleRad-T,A=y.threshold,C=0,E=0,P=0;if(x.isRadial)for(i=(e=this.points).length,r=b.translate(b.min),n=b.translate(b.max),A=y.threshold||0,v.inverted&&h(A)&&c(C=b.translate(A))&&(C<0?C=0:C>M&&(C=M),this.translatedThreshold=C+T);i--;){if(p=(t=e[i]).barX,a=t.x,l=t.y,t.shapeType="arc",v.inverted){t.plotY=b.translate(l),_&&b.stacking?(d=b.stacking.stacks[(l<0?"-":"")+this.stackKey],this.visible&&d&&d[a]&&!t.isNull&&(u=d[a].points[this.getStackIndicator(void 0,a,this.index).key],E=b.translate(u[0]),P=b.translate(u[1]),c(E)&&(E=o.clamp(E,0,M)))):(E=C,P=t.plotY),E>P&&(P=[E,E=P][0]),w?P>r?P=r:E<n?E=n:(E>r||P<n)&&(E=P=M):E<r?E=r:P>n?P=n:(P<r||E>n)&&(E=P=0),b.min>b.max&&(E=P=w?M:0),E+=T,P+=T,S&&(t.barX=p+=S[3]/2),f=Math.max(p,0),g=Math.max(p+t.pointWidth,0);let e=y.borderRadius,i=m(("object"==typeof e?e.radius:e)||0,g-f);t.shapeArgs={x:S[0],y:S[1],r:g,innerR:f,start:E,end:P,borderRadius:i},t.opacity=E===P?0:void 0,t.plotY=(c(this.translatedThreshold)&&(E<this.translatedThreshold?E:P))-T}else E=p+T,t.shapeArgs=this.polar.arc(t.yBottom,t.plotY,E,E+t.pointWidth),t.shapeArgs.borderRadius=0;this.polar.toXY(t),v.inverted?(s=b.postTranslate(t.rectPlotY,p+t.pointWidth/2),t.tooltipPos=[s.x-v.plotLeft,s.y-v.plotTop]):t.tooltipPos=[t.plotX,t.plotY],S&&(t.ttBelow=t.plotY>S[1])}}function I(e,t){let i,r,n=this;if(this.chart.polar){t=t||this.points;for(let e=0;e<t.length;e++)if(!t[e].isNull){i=e;break}!1!==this.options.connectEnds&&void 0!==i&&(this.connectEnds=!0,t.splice(t.length,0,t[i]),r=!0),t.forEach((e=>{void 0===e.polarPlotY&&n.polar.toXY(e)}))}let o=e.apply(this,[].slice.call(arguments,1));return r&&t.pop(),o}function D(e,t){let i=this.chart,r={xAxis:[],yAxis:[]};return i.polar?i.axes.forEach((e=>{if("colorAxis"===e.coll)return;let n=e.isXAxis,o=e.center,s=t.chartX-o[0]-i.plotLeft,a=t.chartY-o[1]-i.plotTop;r[n?"xAxis":"yAxis"].push({axis:e,value:e.translate(n?Math.PI-Math.atan2(s,a):Math.sqrt(Math.pow(s,2)+Math.pow(a,2)),!0)})})):r=e.call(this,t),r}function L(e,t){this.chart.polar||e.call(this,t)}function R(e,i){let r,n,o,a,l,c,u=this,h=this.chart,d=this.group,f=this.markerGroup,m=this.xAxis&&this.xAxis.center,g=h.plotLeft,y=h.plotTop,_=this.options.animation;h.polar?u.isRadialBar?i||(u.startAngleRad=p(u.translatedThreshold,u.xAxis.startAngleRad),t.seriesTypes.pie.prototype.animate.call(u,i)):(_=s(_),u.is("column")?i||(n=m[3]/2,u.points.forEach((e=>{o=e.graphic,l=(a=e.shapeArgs)&&a.r,c=a&&a.innerR,o&&a&&(o.attr({r:n,innerR:n}),o.animate({r:l,innerR:c},u.options.animation))}))):i?(r={translateX:m[0]+g,translateY:m[1]+y,scaleX:.001,scaleY:.001},d.attr(r),f&&f.attr(r)):(r={translateX:g,translateY:y,scaleX:1,scaleY:1},d.animate(r,_),f&&f.animate(r,_))):e.call(this,i)}function z(e,t,i,r){let n,o;if(this.chart.polar)if(r){let e=(o=function e(t,i,r,n){let o,s,a,l,c,u,h=n?1:0,d=(o=i>=0&&i<=t.length-1?i:i<0?t.length-1+i:0)-1<0?t.length-(1+h):o-1,p=o+1>t.length-1?h:o+1,f=t[d],m=t[p],g=f.plotX,y=f.plotY,_=m.plotX,v=m.plotY,x=t[o].plotX,b=t[o].plotY;s=(1.5*x+g)/2.5,a=(1.5*b+y)/2.5,l=(1.5*x+_)/2.5,c=(1.5*b+v)/2.5;let w=Math.sqrt(Math.pow(s-x,2)+Math.pow(a-b,2)),S=Math.sqrt(Math.pow(l-x,2)+Math.pow(c-b,2)),T=Math.atan2(a-b,s-x);u=Math.PI/2+(T+Math.atan2(c-b,l-x))/2,Math.abs(T-u)>Math.PI/2&&(u-=Math.PI),s=x+Math.cos(u)*w,a=b+Math.sin(u)*w;let M={rightContX:l=x+Math.cos(Math.PI+u)*S,rightContY:c=b+Math.sin(Math.PI+u)*S,leftContX:s,leftContY:a,plotX:x,plotY:b};return r&&(M.prevPointCont=e(t,d,!1,n)),M}(t,r,!0,this.connectEnds)).prevPointCont&&o.prevPointCont.rightContX,i=o.prevPointCont&&o.prevPointCont.rightContY;n=["C",h(e)?e:o.plotX,h(i)?i:o.plotY,h(o.leftContX)?o.leftContX:o.plotX,h(o.leftContY)?o.leftContY:o.plotY,o.plotX,o.plotY]}else n=["M",i.plotX,i.plotY];else n=e.call(this,t,i,r);return n}function O(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.plotY;if(!this.destroyed){let{plotX:r,series:n}=this,{chart:o}=n;return o.polar&&h(r)&&h(i)?[r+(t?o.plotLeft:0),i+(t?o.plotTop:0)]:e.call(this,t,i)}}class F{static compose(e,t,i,o,s,c,u,h,d,p){if(r.compose(t,i),n.compose(e,s),f(a,"Polar")){let e=t.prototype,r=c.prototype,n=i.prototype,s=o.prototype;if(l(t,"afterDrawChartBox",v),l(t,"getAxes",b),l(t,"init",x),_(e,"get",E),_(n,"getCoordinates",D),_(n,"pinch",L),l(i,"getSelectionMarkerAttrs",S),l(i,"getSelectionBox",w),l(o,"afterInit",T),l(o,"afterTranslate",M,{order:2}),l(o,"afterColumnTranslate",k,{order:4}),_(s,"animate",R),_(r,"pos",O),h){let e=h.prototype;_(e,"alignDataLabel",P),_(e,"animate",R)}if(d&&_(d.prototype,"getGraphPath",I),p){let e=p.prototype;_(e,"getPointSpline",z),u&&(u.prototype.getPointSpline=e.getPointSpline)}}}constructor(e){this.series=e}arc(e,t,i,r){let n=this.series,o=n.xAxis.center,s=n.yAxis.len,a=o[3]/2,l=s-t+a,c=s-p(e,s)+a;return n.yAxis.reversed&&(l<0&&(l=a),c<0&&(c=a)),{x:o[0],y:o[1],r:l,innerR:c,start:i,end:r}}toXY(e){let t,i=this.series,r=i.chart,n=i.xAxis,o=i.yAxis,s=e.plotX,a=r.inverted,l=e.y,c=e.plotY,u=a?s:o.len-c;if(a&&i&&!i.isRadialBar&&(e.plotY=c=h(l)?o.translate(l):0),e.rectPlotX=s,e.rectPlotY=c,o.center&&(u+=o.center[3]/2),h(c)){let t=a?o.postTranslate(c,u):n.postTranslate(s,u);e.plotX=e.polarPlotX=t.x-r.plotLeft,e.plotY=e.polarPlotY=t.y-r.plotTop}i.kdByAngle?((t=(s/Math.PI*180+n.pane.options.startAngle)%360)<0&&(t+=360),e.clientX=t):e.clientX=e.plotX}}return F})),i(t,"Core/Axis/WaterfallAxis.js",[t["Core/Globals.js"],t["Core/Axis/Stacking/StackItem.js"],t["Core/Utilities.js"]],(function(e,t,i){var r;let{composed:n}=e,{addEvent:o,objectEach:s,pushUnique:a}=i;return function(e){function i(){let e=this.waterfall.stacks;e&&(e.changed=!1,delete e.alreadyChanged)}function r(){let e=this.options.stackLabels;e&&e.enabled&&this.waterfall.stacks&&this.waterfall.renderStackTotals()}function l(){this.waterfall||(this.waterfall=new u(this))}function c(){let e=this.axes;for(let t of this.series)if(t.options.stacking){for(let t of e)t.isXAxis||(t.waterfall.stacks.changed=!0);break}}e.compose=function(e,t){a(n,"Axis.Waterfall")&&(o(e,"init",l),o(e,"afterBuildStacks",i),o(e,"afterRender",r),o(t,"beforeRedraw",c))};class u{constructor(e){this.axis=e,this.stacks={changed:!1}}renderStackTotals(){let e=this.axis,i=e.waterfall.stacks,r=e.stacking&&e.stacking.stackTotalGroup,n=new t(e,e.options.stackLabels||{},!1,0,void 0);this.dummyStackItem=n,r&&s(i,(e=>{s(e,((e,i)=>{n.total=e.stackTotal,n.x=+i,e.label&&(n.label=e.label),t.prototype.render.call(n,r),e.label=n.label,delete n.label}))})),n.total=null}}e.Composition=u}(r||(r={})),r})),i(t,"Series/Waterfall/WaterfallPoint.js",[t["Series/Column/ColumnSeries.js"],t["Core/Series/Point.js"],t["Core/Utilities.js"]],(function(e,t,i){let{isNumber:r}=i;class n extends e.prototype.pointClass{getClassName(){let e=t.prototype.getClassName.call(this);return this.isSum?e+=" highcharts-sum":this.isIntermediateSum&&(e+=" highcharts-intermediate-sum"),e}isValid(){return r(this.y)||this.isSum||!!this.isIntermediateSum}}return n})),i(t,"Series/Waterfall/WaterfallSeriesDefaults.js",[],(function(){return{dataLabels:{inside:!0},lineWidth:1,lineColor:"#333333",dashStyle:"Dot",borderColor:"#333333",states:{hover:{lineWidthPlus:0}}}})),i(t,"Series/Waterfall/WaterfallSeries.js",[t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"],t["Core/Axis/WaterfallAxis.js"],t["Series/Waterfall/WaterfallPoint.js"],t["Series/Waterfall/WaterfallSeriesDefaults.js"]],(function(e,t,i,r,n){let{column:o,line:s}=e.seriesTypes,{addEvent:a,arrayMax:l,arrayMin:c,correctFloat:u,crisp:h,extend:d,isNumber:p,merge:f,objectEach:m,pick:g}=t;function y(e,t){return Object.hasOwnProperty.call(e,t)}class _ extends o{generatePoints(){o.prototype.generatePoints.apply(this);for(let e=0,t=this.points.length;e<t;e++){let t=this.points[e],i=this.processedYData[e];p(i)&&(t.isIntermediateSum||t.isSum)&&(t.y=u(i))}}processData(e){let t,i,r,n,o,s,a=this.options,l=this.yData,c=a.data,h=l.length,d=a.threshold||0;r=i=n=o=0;for(let p=0;p<h;p++)s=l[p],t=c&&c[p]?c[p]:{},"sum"===s||t.isSum?l[p]=u(r):"intermediateSum"===s||t.isIntermediateSum?(l[p]=u(i),i=0):(r+=s,i+=s),n=Math.min(r,n),o=Math.max(r,o);super.processData.call(this,e),a.stacking||(this.dataMin=n+d,this.dataMax=o)}toYData(e){return e.isSum?"sum":e.isIntermediateSum?"intermediateSum":e.y}updateParallelArrays(e,t){super.updateParallelArrays.call(this,e,t),("sum"===this.yData[0]||"intermediateSum"===this.yData[0])&&(this.yData[0]=null)}pointAttribs(e,t){let i=this.options.upColor;i&&!e.options.color&&p(e.y)&&(e.color=e.y>0?i:void 0);let r=o.prototype.pointAttribs.call(this,e,t);return delete r.dashstyle,r}getGraphPath(){return[["M",0,0]]}getCrispPath(){let e=this.data.filter((e=>p(e.y))),t=this.yAxis,i=e.length,r=this.graph?.strokeWidth()||0,n=this.xAxis.reversed,o=this.yAxis.reversed,s=this.options.stacking,a=[];for(let l=1;l<i;l++){if(!this.options.connectNulls&&!p(this.data[e[l].index-1].y))continue;let i=e[l].box,c=e[l-1],u=c.y||0,d=e[l-1].box;if(!i||!d)continue;let f=t.waterfall.stacks[this.stackKey],m=u>0?-d.height:0;if(f&&d&&i){let e,u=f[l-1];if(s){let i=u.connectorThreshold;e=h(t.translate(i,!1,!0,!1,!0)+(o?m:0),r)}else e=h(d.y+(c.minPointLengthOffset||0),r);a.push(["M",(d.x||0)+(n?0:d.width||0),e],["L",(i.x||0)+(n&&i.width||0),e])}if(d&&a.length&&(!s&&u<0&&!o||u>0&&o)){let e=a[a.length-2];e&&"number"==typeof e[2]&&(e[2]+=d.height||0);let t=a[a.length-1];t&&"number"==typeof t[2]&&(t[2]+=d.height||0)}}return a}drawGraph(){s.prototype.drawGraph.call(this),this.graph&&this.graph.attr({d:this.getCrispPath()})}setStackedPoints(e){let t,i,r,n,o,s,a,l,c,u=this.options,h=e.waterfall?.stacks,d=u.threshold||0,p=this.stackKey,f=this.xData,m=f.length,g=d,y=g,_=0,v=0,x=0,b=(e,r,n,o)=>{if(t){if(i)for(;n<i;n++)t.stackState[n]+=o;else t.stackState[0]=e,i=t.stackState.length;t.stackState.push(t.stackState[i-1]+r)}};if(e.stacking&&h&&this.reserveSpace()){c=h.changed,(l=h.alreadyChanged)&&0>l.indexOf(p)&&(c=!0),h[p]||(h[p]={});let e=h[p];if(e)for(let l=0;l<m;l++)(!e[a=f[l]]||c)&&(e[a]={negTotal:0,posTotal:0,stackTotal:0,threshold:0,stateIndex:0,stackState:[],label:c&&e[a]?e[a].label:void 0}),t=e[a],(s=this.yData[l])>=0?t.posTotal+=s:t.negTotal+=s,o=u.data[l],r=t.absolutePos=t.posTotal,n=t.absoluteNeg=t.negTotal,t.stackTotal=r+n,i=t.stackState.length,o&&o.isIntermediateSum?(b(x,v,0,x),x=v,v=d,g^=y,y^=g,g^=y):o&&o.isSum?(b(d,_,i,0),g=d):(b(g,s,0,_),o&&(_+=s,v+=s)),t.stateIndex++,t.threshold=g,g+=t.stackTotal;h.changed=!1,h.alreadyChanged||(h.alreadyChanged=[]),h.alreadyChanged.push(p)}}getExtremes(){let e,t,i,r=this.options.stacking;return r?(e=this.yAxis.waterfall.stacks,t=this.stackedYNeg=[],i=this.stackedYPos=[],m(e[this.stackKey],"overlap"===r?function(e){t.push(c(e.stackState)),i.push(l(e.stackState))}:function(e){t.push(e.negTotal+e.threshold),i.push(e.posTotal+e.threshold)}),{dataMin:c(t),dataMax:l(i)}):{dataMin:this.dataMin,dataMax:this.dataMax}}}return _.defaultOptions=f(o.defaultOptions,n),_.compose=i.compose,d(_.prototype,{pointValKey:"y",showLine:!0,pointClass:r}),a(_,"afterColumnTranslate",(function(){let e,t,i,r,{options:n,points:o,yAxis:s}=this,a=g(n.minPointLength,5),l=a/2,c=n.threshold||0,u=n.stacking,m=s.waterfall.stacks[this.stackKey],_=c,v=c;for(let g=0;g<o.length;g++){let n=o[g],x=this.processedYData[g],b=d({x:0,y:0,width:0,height:0},n.shapeArgs||{});n.box=b;let w=[0,x],S=n.y||0;if(u){if(m){let o=m[g];"overlap"===u?(t=o.stackState[o.stateIndex--],e=S>=0?t:t-S,y(o,"absolutePos")&&delete o.absolutePos,y(o,"absoluteNeg")&&delete o.absoluteNeg):(S>=0?(t=o.threshold+o.posTotal,o.posTotal-=S,e=t):(t=o.threshold+o.negTotal,o.negTotal-=S,e=t-S),!o.posTotal&&p(o.absolutePos)&&y(o,"absolutePos")&&(o.posTotal=o.absolutePos,delete o.absolutePos),!o.negTotal&&p(o.absoluteNeg)&&y(o,"absoluteNeg")&&(o.negTotal=o.absoluteNeg,delete o.absoluteNeg)),n.isSum||(o.connectorThreshold=o.threshold+o.stackTotal),s.reversed?(i=S>=0?e-S:e+S,r=e):(i=e,r=e-S),n.below=i<=c,b.y=s.translate(i,!1,!0,!1,!0),b.height=Math.abs(b.y-s.translate(r,!1,!0,!1,!0));let a=s.waterfall.dummyStackItem;a&&(a.x=g,a.label=m[g].label,a.setOffset(this.pointXOffset||0,this.barW||0,this.stackedYNeg[g],this.stackedYPos[g],void 0,this.xAxis))}}else e=Math.max(v,v+S)+w[0],b.y=s.translate(e,!1,!0,!1,!0),n.isSum?(b.y=s.translate(w[1],!1,!0,!1,!0),b.height=Math.min(s.translate(w[0],!1,!0,!1,!0),s.len)-b.y,n.below=w[1]<=c):n.isIntermediateSum?(S>=0?(i=w[1]+_,r=_):(i=_,r=w[1]+_),s.reversed&&(i^=r,r^=i,i^=r),b.y=s.translate(i,!1,!0,!1,!0),b.height=Math.abs(b.y-Math.min(s.translate(r,!1,!0,!1,!0),s.len)),_+=w[1],n.below=i<=c):(b.height=x>0?s.translate(v,!1,!0,!1,!0)-b.y:s.translate(v,!1,!0,!1,!0)-s.translate(v-x,!1,!0,!1,!0),v+=x,n.below=v<c),b.height<0&&(b.y+=b.height,b.height*=-1);n.plotY=b.y,n.yBottom=b.y+b.height,b.height<=a&&!n.isNull?(b.height=a,b.y-=l,n.yBottom=b.y+b.height,n.plotY=b.y,n.minPointLengthOffset=S<0?-l:l):(n.isNull&&(b.width=0),n.minPointLengthOffset=0);let T=n.plotY+(n.negative?b.height:0);n.below&&(n.plotY+=b.height),n.tooltipPos&&(this.chart.inverted?n.tooltipPos[0]=s.len-T:n.tooltipPos[1]=T),n.isInside=this.isPointInside(n);let M=h(n.yBottom,this.borderWidth);b.y=h(b.y,this.borderWidth),b.height=M-b.y,f(!0,n.shapeArgs,b)}}),{order:2}),e.registerSeriesType("waterfall",_),_})),i(t,"masters/highcharts-more.src.js",[t["Core/Globals.js"],t["Core/Series/SeriesRegistry.js"],t["Extensions/Pane/Pane.js"],t["Series/Bubble/BubbleSeries.js"],t["Series/PackedBubble/PackedBubbleSeries.js"],t["Series/PolarComposition.js"],t["Core/Axis/RadialAxis.js"],t["Series/Waterfall/WaterfallSeries.js"]],(function(e,t,i,r,n,o,s,a){return e.RadialAxis=s,r.compose(e.Axis,e.Chart,e.Legend),n.compose(e.Axis,e.Chart,e.Legend),i.compose(e.Chart,e.Pointer),o.compose(e.Axis,e.Chart,e.Pointer,e.Series,e.Tick,e.Point,t.seriesTypes.areasplinerange,t.seriesTypes.column,t.seriesTypes.line,t.seriesTypes.spline),a.compose(e.Axis,e.Chart),e}))},e.exports?(o.default=o,e.exports=o):(r=[i(3488)],void 0===(n=function(e){return o(e),o.Highcharts=e,o}.apply(t,r))||(e.exports=n))},3174:(e,t,i)=>{"use strict";i.r(t),i.d(t,{GlobalStyles:()=>w.A,StyledEngineProvider:()=>b,ThemeContext:()=>n.T,css:()=>y.AH,default:()=>S,internal_processStyles:()=>T,keyframes:()=>y.i7});var r=i(8168),n=i(9369),o=i(6598),s=i(9436),a=i(1722),l=i(5043),c=i(918),u=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,h=(0,c.A)((function(e){return u.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91})),d=function(e){return"theme"!==e},p=function(e){return"string"===typeof e&&e.charCodeAt(0)>96?h:d},f=function(e,t,i){var r;if(t){var n=t.shouldForwardProp;r=e.__emotion_forwardProp&&n?function(t){return e.__emotion_forwardProp(t)&&n(t)}:n}return"function"!==typeof r&&i&&(r=e.__emotion_forwardProp),r},m=function(e){var t=e.cache,i=e.serialized,r=e.isStringTag;return(0,a.SF)(t,i,r),(0,s.s)((function(){return(0,a.sk)(t,i,r)})),null},g=function e(t,i){var s,c,u=t.__emotion_real===t,h=u&&t.__emotion_base||t;void 0!==i&&(s=i.label,c=i.target);var d=f(t,i,u),g=d||p(h),y=!g("as");return function(){var _=arguments,v=u&&void 0!==t.__emotion_styles?t.__emotion_styles.slice(0):[];if(void 0!==s&&v.push("label:"+s+";"),null==_[0]||void 0===_[0].raw)v.push.apply(v,_);else{var x=_[0];v.push(x[0]);for(var b=_.length,w=1;w<b;w++)v.push(_[w],x[w])}var S=(0,n.w)((function(e,t,i){var r=y&&e.as||h,s="",u=[],f=e;if(null==e.theme){for(var _ in f={},e)f[_]=e[_];f.theme=l.useContext(n.T)}"string"===typeof e.className?s=(0,a.Rk)(t.registered,u,e.className):null!=e.className&&(s=e.className+" ");var x=(0,o.J)(v.concat(u),t.registered,f);s+=t.key+"-"+x.name,void 0!==c&&(s+=" "+c);var b=y&&void 0===d?p(r):g,w={};for(var S in e)y&&"as"===S||b(S)&&(w[S]=e[S]);return w.className=s,i&&(w.ref=i),l.createElement(l.Fragment,null,l.createElement(m,{cache:t,serialized:x,isStringTag:"string"===typeof r}),l.createElement(r,w))}));return S.displayName=void 0!==s?s:"Styled("+("string"===typeof h?h:h.displayName||h.name||"Component")+")",S.defaultProps=t.defaultProps,S.__emotion_real=S,S.__emotion_base=h,S.__emotion_styles=v,S.__emotion_forwardProp=d,Object.defineProperty(S,"toString",{value:function(){return"."+c}}),S.withComponent=function(t,n){return e(t,(0,r.A)({},i,n,{shouldForwardProp:f(S,n,!0)})).apply(void 0,v)},S}}.bind(null);["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){g[e]=g(e)}));var y=i(3290),_=i(3803),v=i(579);let x;function b(e){const{injectFirst:t,children:i}=e;return t&&x?(0,v.jsx)(n.C,{value:x,children:i}):i}"object"===typeof document&&(x=(0,_.A)({key:"css",prepend:!0}));var w=i(869);function S(e,t){return g(e,t)}const T=(e,t)=>{Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))}},3218:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},3234:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r.A,extendSxProp:()=>n.A,unstable_createStyleFunctionSx:()=>r.k,unstable_defaultSxConfig:()=>o.A});var r=i(8812),n=i(8698),o=i(7758)},3290:(e,t,i)=>{"use strict";i.d(t,{AH:()=>u,i7:()=>h,mL:()=>c});var r=i(9369),n=i(5043),o=i(1722),s=i(9436),a=i(6598),l=(i(3803),i(219),function(e,t){var i=arguments;if(null==t||!r.h.call(t,"css"))return n.createElement.apply(void 0,i);var o=i.length,s=new Array(o);s[0]=r.E,s[1]=(0,r.c)(e,t);for(var a=2;a<o;a++)s[a]=i[a];return n.createElement.apply(null,s)});!function(e){var t;t||(t=e.JSX||(e.JSX={}))}(l||(l={}));var c=(0,r.w)((function(e,t){var i=e.styles,l=(0,a.J)([i],void 0,n.useContext(r.T)),c=n.useRef();return(0,s.i)((function(){var e=t.key+"-global",i=new t.sheet.constructor({key:e,nonce:t.sheet.nonce,container:t.sheet.container,speedy:t.sheet.isSpeedy}),r=!1,n=document.querySelector('style[data-emotion="'+e+" "+l.name+'"]');return t.sheet.tags.length&&(i.before=t.sheet.tags[0]),null!==n&&(r=!0,n.setAttribute("data-emotion",e),i.hydrate([n])),c.current=[i,r],function(){i.flush()}}),[t]),(0,s.i)((function(){var e=c.current,i=e[0];if(e[1])e[1]=!1;else{if(void 0!==l.next&&(0,o.sk)(t,l.next,!0),i.tags.length){var r=i.tags[i.tags.length-1].nextElementSibling;i.before=r,i.flush()}t.insert("",l,i,!1)}}),[t,l.name]),null}));function u(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return(0,a.J)(t)}function h(){var e=u.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}},3382:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>l,getFunctionName:()=>o});var r=i(528);const n=/^\s*function(?:\s|\s*\/\*.*\*\/\s*)+([^(\s/]*)\s*/;function o(e){const t=`${e}`.match(n);return t&&t[1]||""}function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.displayName||e.name||o(e)||t}function a(e,t,i){const r=s(t);return e.displayName||(""!==r?`${i}(${r})`:i)}function l(e){if(null!=e){if("string"===typeof e)return e;if("function"===typeof e)return s(e,"Component");if("object"===typeof e)switch(e.$$typeof){case r.vM:return a(e,e.render,"ForwardRef");case r.lD:return a(e,e.type,"memo");default:return}}}},3488:function(e,t,i){var r,n,o;n="undefined"!=typeof window?window:this,o=function(e){"use strict";var t={};function i(t,i,r,n){!t.hasOwnProperty(i)&&(t[i]=n.apply(null,r),e&&"function"==typeof CustomEvent&&e.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:i,module:t[i]}})))}return i(t,"Core/Globals.js",[],(function(){var t,i;return(i=t||(t={})).SVG_NS="http://www.w3.org/2000/svg",i.product="Highcharts",i.version="11.4.8",i.win=void 0!==e?e:{},i.doc=i.win.document,i.svg=i.doc&&i.doc.createElementNS&&!!i.doc.createElementNS(i.SVG_NS,"svg").createSVGRect,i.userAgent=i.win.navigator&&i.win.navigator.userAgent||"",i.isChrome=i.win.chrome,i.isFirefox=-1!==i.userAgent.indexOf("Firefox"),i.isMS=/(edge|msie|trident)/i.test(i.userAgent)&&!i.win.opera,i.isSafari=!i.isChrome&&-1!==i.userAgent.indexOf("Safari"),i.isTouchDevice=/(Mobile|Android|Windows Phone)/.test(i.userAgent),i.isWebKit=-1!==i.userAgent.indexOf("AppleWebKit"),i.deg2rad=2*Math.PI/360,i.hasBidiBug=i.isFirefox&&4>parseInt(i.userAgent.split("Firefox/")[1],10),i.marginNames=["plotTop","marginRight","marginBottom","plotLeft"],i.noop=function(){},i.supportsPassiveEvents=function(){let e=!1;if(!i.isMS){let t=Object.defineProperty({},"passive",{get:function(){e=!0}});i.win.addEventListener&&i.win.removeEventListener&&(i.win.addEventListener("testPassive",i.noop,t),i.win.removeEventListener("testPassive",i.noop,t))}return e}(),i.charts=[],i.composed=[],i.dateFormats={},i.seriesTypes={},i.symbolSizes={},i.chartCount=0,t})),i(t,"Core/Utilities.js",[t["Core/Globals.js"]],(function(e){let t,{charts:i,doc:r,win:n}=e;function o(t,i,r,s){let a=i?"Highcharts error":"Highcharts warning";32===t&&(t=`${a}: Deprecated member`);let l=d(t),c=l?`${a} #${t}: www.highcharts.com/errors/${t}/`:t.toString();if(void 0!==s){let e="";l&&(c+="?"),w(s,(function(t,i){e+=`\n - ${i}: ${t}`,l&&(c+=encodeURI(i)+"="+encodeURI(t))})),c+=e}T(e,"displayError",{chart:r,code:t,message:c,params:s},(function(){if(i)throw Error(c);n.console&&-1===o.messages.indexOf(c)&&console.warn(c)})),o.messages.push(c)}function s(e,t){return parseInt(e,t||10)}function a(e){return"string"==typeof e}function l(e){let t=Object.prototype.toString.call(e);return"[object Array]"===t||"[object Array Iterator]"===t}function c(e,t){return!!e&&"object"==typeof e&&(!t||!l(e))}function u(e){return c(e)&&"number"==typeof e.nodeType}function h(e){let t=e&&e.constructor;return!(!c(e,!0)||u(e)||!t||!t.name||"Object"===t.name)}function d(e){return"number"==typeof e&&!isNaN(e)&&e<1/0&&e>-1/0}function p(e){return null!=e}function f(e,t,i){let r,n=a(t)&&!p(i),o=(t,i)=>{p(t)?e.setAttribute(i,t):n?(r=e.getAttribute(i))||"class"!==i||(r=e.getAttribute(i+"Name")):e.removeAttribute(i)};return a(t)?o(i,t):w(t,o),r}function m(e){return l(e)?e:[e]}function g(e,t){let i;for(i in e||(e={}),t)e[i]=t[i];return e}function y(){let e=arguments,t=e.length;for(let i=0;i<t;i++){let t=e[i];if(null!=t)return t}}function _(e,t){g(e.style,t)}function v(e){return Math.pow(10,Math.floor(Math.log(e)/Math.LN10))}function x(e,t){return e>1e14?e:parseFloat(e.toPrecision(t||14))}(o||(o={})).messages=[],Math.easeInOutSine=function(e){return-.5*(Math.cos(Math.PI*e)-1)};let b=Array.prototype.find?function(e,t){return e.find(t)}:function(e,t){let i,r=e.length;for(i=0;i<r;i++)if(t(e[i],i))return e[i]};function w(e,t,i){for(let r in e)Object.hasOwnProperty.call(e,r)&&t.call(i||e[r],e[r],r,e)}function S(e,t,i){function r(t,i){let r=e.removeEventListener;r&&r.call(e,t,i,!1)}function n(i){let n,o;e.nodeName&&(t?(n={})[t]=!0:n=i,w(n,(function(e,t){if(i[t])for(o=i[t].length;o--;)r(t,i[t][o].fn)})))}let o="function"==typeof e&&e.prototype||e;if(Object.hasOwnProperty.call(o,"hcEvents")){let e=o.hcEvents;if(t){let o=e[t]||[];i?(e[t]=o.filter((function(e){return i!==e.fn})),r(t,i)):(n(e),e[t]=[])}else n(e),delete o.hcEvents}}function T(t,i,n,o){if(n=n||{},r.createEvent&&(t.dispatchEvent||t.fireEvent&&t!==e)){let e=r.createEvent("Events");e.initEvent(i,!0,!0),n=g(e,n),t.dispatchEvent?t.dispatchEvent(n):t.fireEvent(i,n)}else if(t.hcEvents){n.target||g(n,{preventDefault:function(){n.defaultPrevented=!0},target:t,type:i});let e=[],r=t,o=!1;for(;r.hcEvents;)Object.hasOwnProperty.call(r,"hcEvents")&&r.hcEvents[i]&&(e.length&&(o=!0),e.unshift.apply(e,r.hcEvents[i])),r=Object.getPrototypeOf(r);o&&e.sort(((e,t)=>e.order-t.order)),e.forEach((e=>{!1===e.fn.call(t,n)&&n.preventDefault()}))}o&&!n.defaultPrevented&&o.call(t,n)}w({map:"map",each:"forEach",grep:"filter",reduce:"reduce",some:"some"},(function(t,i){e[i]=function(e){return o(32,!1,void 0,{[`Highcharts.${i}`]:`use Array.${t}`}),Array.prototype[t].apply(e,[].slice.call(arguments,1))}}));let M=function(){let e=Math.random().toString(36).substring(2,9)+"-",i=0;return function(){return"highcharts-"+(t?"":e)+i++}}();return n.jQuery&&(n.jQuery.fn.highcharts=function(){let t=[].slice.call(arguments);if(this[0])return t[0]?(new(e[a(t[0])?t.shift():"Chart"])(this[0],t[0],t[1]),this):i[f(this[0],"data-highcharts-chart")]}),{addEvent:function(t,i,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o="function"==typeof t&&t.prototype||t;Object.hasOwnProperty.call(o,"hcEvents")||(o.hcEvents={});let s=o.hcEvents;e.Point&&t instanceof e.Point&&t.series&&t.series.chart&&(t.series.chart.runTrackerClick=!0);let a=t.addEventListener;a&&a.call(t,i,r,!!e.supportsPassiveEvents&&{passive:void 0===n.passive?-1!==i.indexOf("touch"):n.passive,capture:!1}),s[i]||(s[i]=[]);let l={fn:r,order:"number"==typeof n.order?n.order:1/0};return s[i].push(l),s[i].sort(((e,t)=>e.order-t.order)),function(){S(t,i,r)}},arrayMax:function(e){let t=e.length,i=e[0];for(;t--;)e[t]>i&&(i=e[t]);return i},arrayMin:function(e){let t=e.length,i=e[0];for(;t--;)e[t]<i&&(i=e[t]);return i},attr:f,clamp:function(e,t,i){return e>t?e<i?e:i:t},clearTimeout:function(e){p(e)&&clearTimeout(e)},correctFloat:x,createElement:function(e,t,i,n,o){let s=r.createElement(e);return t&&g(s,t),o&&_(s,{padding:"0",border:"none",margin:"0"}),i&&_(s,i),n&&n.appendChild(s),s},crisp:function(e){let t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)%2/2,i=(arguments.length>2?arguments[2]:void 0)?-1:1;return(Math.round(e*i-t)+t)*i},css:_,defined:p,destroyObjectProperties:function(e,t,i){w(e,(function(r,n){r!==t&&r?.destroy&&r.destroy(),(r?.destroy||!i)&&delete e[n]}))},diffObjects:function(e,t,i,r){let n={};return function e(t,n,o,s){let a=i?n:t;w(t,(function(i,u){if(!s&&r&&r.indexOf(u)>-1&&n[u]){i=m(i),o[u]=[];for(let t=0;t<Math.max(i.length,n[u].length);t++)n[u][t]&&(void 0===i[t]?o[u][t]=n[u][t]:(o[u][t]={},e(i[t],n[u][t],o[u][t],s+1)))}else c(i,!0)&&!i.nodeType?(o[u]=l(i)?[]:{},e(i,n[u]||{},o[u],s+1),0!==Object.keys(o[u]).length||"colorAxis"===u&&0===s||delete o[u]):(t[u]!==n[u]||u in t&&!(u in n))&&"__proto__"!==u&&"constructor"!==u&&(o[u]=a[u])}))}(e,t,n,0),n},discardElement:function(e){e&&e.parentElement&&e.parentElement.removeChild(e)},erase:function(e,t){let i=e.length;for(;i--;)if(e[i]===t){e.splice(i,1);break}},error:o,extend:g,extendClass:function(e,t){let i=function(){};return g(i.prototype=new e,t),i},find:b,fireEvent:T,getClosestDistance:function(e,t){let i,r,n,o,s=!t;return e.forEach((e=>{if(e.length>1)for(o=r=e.length-1;o>0;o--)(n=e[o]-e[o-1])<0&&!s?(t?.(),t=void 0):n&&(void 0===i||n<i)&&(i=n)})),i},getMagnitude:v,getNestedProperty:function(e,t){let i=e.split(".");for(;i.length&&p(t);){let e=i.shift();if(void 0===e||"__proto__"===e)return;if("this"===e){let e;return c(t)&&(e=t["@this"]),e??t}let r=t[e];if(!p(r)||"function"==typeof r||"number"==typeof r.nodeType||r===n)return;t=r}return t},getStyle:function e(t,i,r){let o;if("width"===i){let i=Math.min(t.offsetWidth,t.scrollWidth),r=t.getBoundingClientRect&&t.getBoundingClientRect().width;return r<i&&r>=i-1&&(i=Math.floor(r)),Math.max(0,i-(e(t,"padding-left",!0)||0)-(e(t,"padding-right",!0)||0))}if("height"===i)return Math.max(0,Math.min(t.offsetHeight,t.scrollHeight)-(e(t,"padding-top",!0)||0)-(e(t,"padding-bottom",!0)||0));let a=n.getComputedStyle(t,void 0);return a&&(o=a.getPropertyValue(i),y(r,"opacity"!==i)&&(o=s(o))),o},inArray:function(e,t,i){return o(32,!1,void 0,{"Highcharts.inArray":"use Array.indexOf"}),t.indexOf(e,i)},insertItem:function(e,t){let i,r=e.options.index,n=t.length;for(i=e.options.isInternal?n:0;i<n+1;i++)if(!t[i]||d(r)&&r<y(t[i].options.index,t[i]._i)||t[i].options.isInternal){t.splice(i,0,e);break}return i},isArray:l,isClass:h,isDOMElement:u,isFunction:function(e){return"function"==typeof e},isNumber:d,isObject:c,isString:a,keys:function(e){return o(32,!1,void 0,{"Highcharts.keys":"use Object.keys"}),Object.keys(e)},merge:function(){let e,t=arguments,i={},r=function(e,t){return"object"!=typeof e&&(e={}),w(t,(function(i,n){"__proto__"!==n&&"constructor"!==n&&(!c(i,!0)||h(i)||u(i)?e[n]=t[n]:e[n]=r(e[n]||{},i))})),e};!0===t[0]&&(i=t[1],t=Array.prototype.slice.call(t,2));let n=t.length;for(e=0;e<n;e++)i=r(i,t[e]);return i},normalizeTickInterval:function(e,t,i,r,n){let o,s=e,a=e/(i=y(i,v(e)));for(!t&&(t=n?[1,1.2,1.5,2,2.5,3,4,5,6,8,10]:[1,2,2.5,5,10],!1===r&&(1===i?t=t.filter((function(e){return e%1==0})):i<=.1&&(t=[1/i]))),o=0;o<t.length&&(s=t[o],(!n||!(s*i>=e))&&(n||!(a<=(t[o]+(t[o+1]||t[o]))/2)));o++);return x(s*i,-Math.round(Math.log(.001)/Math.LN10))},objectEach:w,offset:function(e){let t=r.documentElement,i=e.parentElement||e.parentNode?e.getBoundingClientRect():{top:0,left:0,width:0,height:0};return{top:i.top+(n.pageYOffset||t.scrollTop)-(t.clientTop||0),left:i.left+(n.pageXOffset||t.scrollLeft)-(t.clientLeft||0),width:i.width,height:i.height}},pad:function(e,t,i){return Array((t||2)+1-String(e).replace("-","").length).join(i||"0")+e},pick:y,pInt:s,pushUnique:function(e,t){return 0>e.indexOf(t)&&!!e.push(t)},relativeLength:function(e,t,i){return/%$/.test(e)?t*parseFloat(e)/100+(i||0):parseFloat(e)},removeEvent:S,replaceNested:function(e){let t,i;for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];do{for(i of(t=e,n))e=e.replace(i[0],i[1])}while(e!==t);return e},splat:m,stableSort:function(e,t){let i,r,n=e.length;for(r=0;r<n;r++)e[r].safeI=r;for(e.sort((function(e,r){return 0===(i=t(e,r))?e.safeI-r.safeI:i})),r=0;r<n;r++)delete e[r].safeI},syncTimeout:function(e,t,i){return t>0?setTimeout(e,t,i):(e.call(0,i),-1)},timeUnits:{millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:24192e5,year:314496e5},uniqueKey:M,useSerialIds:function(e){return t=y(e,t)},wrap:function(e,t,i){let r=e[t];e[t]=function(){let e=arguments,t=this;return i.apply(this,[function(){return r.apply(t,arguments.length?arguments:e)}].concat([].slice.call(arguments)))}}}})),i(t,"Core/Chart/ChartDefaults.js",[],(function(){return{alignThresholds:!1,panning:{enabled:!1,type:"x"},styledMode:!1,borderRadius:0,colorCount:10,allowMutatingData:!0,ignoreHiddenSeries:!0,spacing:[10,10,15,10],resetZoomButton:{theme:{},position:{}},reflow:!0,type:"line",zooming:{singleTouch:!1,resetButton:{theme:{zIndex:6},position:{align:"right",x:-10,y:10}}},width:null,height:null,borderColor:"#334eff",backgroundColor:"#ffffff",plotBorderColor:"#cccccc"}})),i(t,"Core/Color/Palettes.js",[],(function(){return{colors:["#2caffe","#544fc5","#00e272","#fe6a35","#6b8abc","#d568fb","#2ee0ca","#fa4b42","#feb56a","#91e8e1"]}})),i(t,"Core/Time.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],(function(e,t){let{win:i}=e,{defined:r,error:n,extend:o,isNumber:s,isObject:a,merge:l,objectEach:c,pad:u,pick:h,splat:d,timeUnits:p}=t,f=e.isSafari&&i.Intl&&i.Intl.DateTimeFormat.prototype.formatRange,m=e.isSafari&&i.Intl&&!i.Intl.DateTimeFormat.prototype.formatRange;class g{constructor(e){this.options={},this.useUTC=!1,this.variableTimezone=!1,this.Date=i.Date,this.getTimezoneOffset=this.timezoneOffsetFunction(),this.update(e)}get(e,t){if(this.variableTimezone||this.timezoneOffset){let i=t.getTime(),r=i-this.getTimezoneOffset(t);t.setTime(r);let n=t["getUTC"+e]();return t.setTime(i),n}return this.useUTC?t["getUTC"+e]():t["get"+e]()}set(e,t,i){if(this.variableTimezone||this.timezoneOffset){if("Milliseconds"===e||"Seconds"===e||"Minutes"===e&&this.getTimezoneOffset(t)%36e5==0)return t["setUTC"+e](i);let r=this.getTimezoneOffset(t),n=t.getTime()-r;t.setTime(n),t["setUTC"+e](i);let o=this.getTimezoneOffset(t);return n=t.getTime()+o,t.setTime(n)}return this.useUTC||f&&"FullYear"===e?t["setUTC"+e](i):t["set"+e](i)}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=h(e.useUTC,!0);this.options=e=l(!0,this.options,e),this.Date=e.Date||i.Date||Date,this.useUTC=t,this.timezoneOffset=t&&e.timezoneOffset||void 0,this.getTimezoneOffset=this.timezoneOffsetFunction(),this.variableTimezone=t&&!(!e.getTimezoneOffset&&!e.timezone)}makeTime(e,t,i,r,n,o){let s,a,l;return this.useUTC?(s=this.Date.UTC.apply(0,arguments),a=this.getTimezoneOffset(s),s+=a,a!==(l=this.getTimezoneOffset(s))?s+=l-a:a-36e5!==this.getTimezoneOffset(s-36e5)||m||(s-=36e5)):s=new this.Date(e,t,h(i,1),h(r,0),h(n,0),h(o,0)).getTime(),s}timezoneOffsetFunction(){let e=this,t=this.options,i=t.getTimezoneOffset;return this.useUTC?t.timezone?e=>{try{let i=`shortOffset,${t.timezone||""}`,[r,n,o,a,l=0]=(g.formatCache[i]=g.formatCache[i]||Intl.DateTimeFormat("en",{timeZone:t.timezone,timeZoneName:"shortOffset"})).format(e).split(/(GMT|:)/).map(Number),c=-36e5*(o+l/60);if(s(c))return c}catch(e){n(34)}return 0}:this.useUTC&&i?e=>6e4*i(e.valueOf()):()=>6e4*(e.timezoneOffset||0):e=>6e4*new Date(e.toString()).getTimezoneOffset()}dateFormat(t,i,n){if(!r(i)||isNaN(i))return e.defaultOptions.lang&&e.defaultOptions.lang.invalidDate||"";t=h(t,"%Y-%m-%d %H:%M:%S");let s=this,a=new this.Date(i),l=this.get("Hours",a),d=this.get("Day",a),p=this.get("Date",a),f=this.get("Month",a),m=this.get("FullYear",a),g=e.defaultOptions.lang,y=g&&g.weekdays,_=g&&g.shortWeekdays;return c(o({a:_?_[d]:y[d].substr(0,3),A:y[d],d:u(p),e:u(p,2," "),w:d,b:g.shortMonths[f],B:g.months[f],m:u(f+1),o:f+1,y:m.toString().substr(2,2),Y:m,H:u(l),k:l,I:u(l%12||12),l:l%12||12,M:u(this.get("Minutes",a)),p:l<12?"AM":"PM",P:l<12?"am":"pm",S:u(this.get("Seconds",a)),L:u(Math.floor(i%1e3),3)},e.dateFormats),(function(e,r){for(;-1!==t.indexOf("%"+r);)t=t.replace("%"+r,"function"==typeof e?e.call(s,i):e)})),n?t.substr(0,1).toUpperCase()+t.substr(1):t}resolveDTLFormat(e){return a(e,!0)?e:{main:(e=d(e))[0],from:e[1],to:e[2]}}getTimeTicks(e,t,i,n){let s,a,l,c,u=this,d=u.Date,f=[],m={},g=new d(t),y=e.unitRange,_=e.count||1;if(n=h(n,1),r(t)){u.set("Milliseconds",g,y>=p.second?0:_*Math.floor(u.get("Milliseconds",g)/_)),y>=p.second&&u.set("Seconds",g,y>=p.minute?0:_*Math.floor(u.get("Seconds",g)/_)),y>=p.minute&&u.set("Minutes",g,y>=p.hour?0:_*Math.floor(u.get("Minutes",g)/_)),y>=p.hour&&u.set("Hours",g,y>=p.day?0:_*Math.floor(u.get("Hours",g)/_)),y>=p.day&&u.set("Date",g,y>=p.month?1:Math.max(1,_*Math.floor(u.get("Date",g)/_))),y>=p.month&&(u.set("Month",g,y>=p.year?0:_*Math.floor(u.get("Month",g)/_)),a=u.get("FullYear",g)),y>=p.year&&(a-=a%_,u.set("FullYear",g,a)),y===p.week&&(c=u.get("Day",g),u.set("Date",g,u.get("Date",g)-c+n+(c<n?-7:0))),a=u.get("FullYear",g);let e=u.get("Month",g),o=u.get("Date",g),h=u.get("Hours",g);t=g.getTime(),(u.variableTimezone||!u.useUTC)&&r(i)&&(l=i-t>4*p.month||u.getTimezoneOffset(t)!==u.getTimezoneOffset(i));let d=g.getTime();for(s=1;d<i;)f.push(d),y===p.year?d=u.makeTime(a+s*_,0):y===p.month?d=u.makeTime(a,e+s*_):!l||y!==p.day&&y!==p.week?l&&y===p.hour&&_>1?d=u.makeTime(a,e,o,h+s*_):d+=y*_:d=u.makeTime(a,e,o+s*_*(y===p.day?1:7)),s++;f.push(d),y<=p.hour&&f.length<1e4&&f.forEach((function(e){e%18e5==0&&"000000000"===u.dateFormat("%H%M%S%L",e)&&(m[e]="day")}))}return f.info=o(e,{higherRanks:m,totalRange:y*_}),f}getDateFormat(e,t,i,r){let n=this.dateFormat("%m-%d %H:%M:%S.%L",t),o="01-01 00:00:00.000",s={millisecond:15,second:12,minute:9,hour:6,day:3},a="millisecond",l=a;for(a in p){if(e===p.week&&+this.dateFormat("%w",t)===i&&n.substr(6)===o.substr(6)){a="week";break}if(p[a]>e){a=l;break}if(s[a]&&n.substr(s[a])!==o.substr(s[a]))break;"week"!==a&&(l=a)}return this.resolveDTLFormat(r[a]).main}}return g.formatCache={},g})),i(t,"Core/Defaults.js",[t["Core/Chart/ChartDefaults.js"],t["Core/Globals.js"],t["Core/Color/Palettes.js"],t["Core/Time.js"],t["Core/Utilities.js"]],(function(e,t,i,r,n){let{isTouchDevice:o}=t,{fireEvent:s,merge:a}=n,l={colors:i.colors,symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],decimalPoint:".",numericSymbols:["k","M","G","T","P","E"],resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:" "},global:{buttonTheme:{fill:"#f7f7f7",padding:8,r:2,stroke:"#cccccc","stroke-width":1,style:{color:"#333333",cursor:"pointer",fontSize:"0.8em",fontWeight:"normal"},states:{hover:{fill:"#e6e6e6"},select:{fill:"#e6e9ff",style:{color:"#000000",fontWeight:"bold"}},disabled:{style:{color:"#cccccc"}}}}},time:{Date:void 0,getTimezoneOffset:void 0,timezone:void 0,timezoneOffset:0,useUTC:!0},chart:e,title:{style:{color:"#333333",fontWeight:"bold"},text:"Chart title",align:"center",margin:15,widthAdjust:-44},subtitle:{style:{color:"#666666",fontSize:"0.8em"},text:"",align:"center",widthAdjust:-44},caption:{margin:15,style:{color:"#666666",fontSize:"0.8em"},text:"",align:"left",verticalAlign:"bottom"},plotOptions:{},legend:{enabled:!0,align:"center",alignColumns:!0,className:"highcharts-no-tooltip",events:{},layout:"horizontal",itemMarginBottom:2,itemMarginTop:2,labelFormatter:function(){return this.name},borderColor:"#999999",borderRadius:0,navigation:{style:{fontSize:"0.8em"},activeColor:"#0022ff",inactiveColor:"#cccccc"},itemStyle:{color:"#333333",cursor:"pointer",fontSize:"0.8em",textDecoration:"none",textOverflow:"ellipsis"},itemHoverStyle:{color:"#000000"},itemHiddenStyle:{color:"#666666",textDecoration:"line-through"},shadow:!1,itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},squareSymbol:!0,symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontSize:"0.8em",fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"45%"},style:{position:"absolute",backgroundColor:"#ffffff",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,animation:{duration:300,easing:e=>Math.sqrt(1-Math.pow(e-1,2))},borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %e %b, %H:%M:%S.%L",second:"%A, %e %b, %H:%M:%S",minute:"%A, %e %b, %H:%M",hour:"%A, %e %b, %H:%M",day:"%A, %e %b %Y",week:"Week from %A, %e %b %Y",month:"%B %Y",year:"%Y"},footerFormat:"",headerShape:"callout",hideDelay:500,padding:8,shape:"callout",shared:!1,snap:o?25:10,headerFormat:'<span style="font-size: 0.8em">{point.key}</span><br/>',pointFormat:'<span style="color:{point.color}">\u25cf</span> {series.name}: <b>{point.y}</b><br/>',backgroundColor:"#ffffff",borderWidth:void 0,shadow:!0,stickOnContact:!1,style:{color:"#333333",cursor:"default",fontSize:"0.8em"},useHTML:!1},credits:{enabled:!0,href:"https://www.highcharts.com?credits",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#999999",fontSize:"0.6em"},text:"Highcharts.com"}};l.chart.styledMode=!1;let c=new r(l.time);return{defaultOptions:l,defaultTime:c,getOptions:function(){return l},setOptions:function(e){return s(t,"setOptions",{options:e}),a(!0,l,e),(e.time||e.global)&&(t.time?t.time.update(a(l.global,l.time,e.global,e.time)):t.time=c),l}}})),i(t,"Core/Color/Color.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],(function(e,t){let{isNumber:i,merge:r,pInt:n}=t;class o{static parse(e){return e?new o(e):o.None}constructor(t){let i,r,n,s;this.rgba=[NaN,NaN,NaN,NaN],this.input=t;let a=e.Color;if(a&&a!==o)return new a(t);if("object"==typeof t&&void 0!==t.stops)this.stops=t.stops.map((e=>new o(e[1])));else if("string"==typeof t){if(this.input=t=o.names[t.toLowerCase()]||t,"#"===t.charAt(0)){let e=t.length,i=parseInt(t.substr(1),16);7===e?r=[(16711680&i)>>16,(65280&i)>>8,255&i,1]:4===e&&(r=[(3840&i)>>4|(3840&i)>>8,(240&i)>>4|240&i,(15&i)<<4|15&i,1])}if(!r)for(n=o.parsers.length;n--&&!r;)(i=(s=o.parsers[n]).regex.exec(t))&&(r=s.parse(i))}r&&(this.rgba=r)}get(e){let t=this.input,n=this.rgba;if("object"==typeof t&&void 0!==this.stops){let i=r(t);return i.stops=[].slice.call(i.stops),this.stops.forEach(((t,r)=>{i.stops[r]=[i.stops[r][0],t.get(e)]})),i}return n&&i(n[0])?"rgb"===e||!e&&1===n[3]?"rgb("+n[0]+","+n[1]+","+n[2]+")":"a"===e?`${n[3]}`:"rgba("+n.join(",")+")":t}brighten(e){let t=this.rgba;if(this.stops)this.stops.forEach((function(t){t.brighten(e)}));else if(i(e)&&0!==e)for(let i=0;i<3;i++)t[i]+=n(255*e),t[i]<0&&(t[i]=0),t[i]>255&&(t[i]=255);return this}setOpacity(e){return this.rgba[3]=e,this}tweenTo(e,t){let r=this.rgba,n=e.rgba;if(!i(r[0])||!i(n[0]))return e.input||"none";let o=1!==n[3]||1!==r[3];return(o?"rgba(":"rgb(")+Math.round(n[0]+(r[0]-n[0])*(1-t))+","+Math.round(n[1]+(r[1]-n[1])*(1-t))+","+Math.round(n[2]+(r[2]-n[2])*(1-t))+(o?","+(n[3]+(r[3]-n[3])*(1-t)):"")+")"}}return o.names={white:"#ffffff",black:"#000000"},o.parsers=[{regex:/rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?(?:\.\d+)?)\s*\)/,parse:function(e){return[n(e[1]),n(e[2]),n(e[3]),parseFloat(e[4],10)]}},{regex:/rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/,parse:function(e){return[n(e[1]),n(e[2]),n(e[3]),1]}}],o.None=new o(""),o})),i(t,"Core/Animation/Fx.js",[t["Core/Color/Color.js"],t["Core/Globals.js"],t["Core/Utilities.js"]],(function(e,t,i){let{parse:r}=e,{win:n}=t,{isNumber:o,objectEach:s}=i;class a{constructor(e,t,i){this.pos=NaN,this.options=t,this.elem=e,this.prop=i}dSetter(){let e=this.paths,t=e&&e[0],i=e&&e[1],r=this.now||0,n=[];if(1!==r&&t&&i)if(t.length===i.length&&r<1)for(let s=0;s<i.length;s++){let e=t[s],a=i[s],l=[];for(let t=0;t<a.length;t++){let i=e[t],n=a[t];o(i)&&o(n)&&("A"!==a[0]||4!==t&&5!==t)?l[t]=i+r*(n-i):l[t]=n}n.push(l)}else n=i;else n=this.toD||[];this.elem.attr("d",n,void 0,!0)}update(){let e=this.elem,t=this.prop,i=this.now,r=this.options.step;this[t+"Setter"]?this[t+"Setter"]():e.attr?e.element&&e.attr(t,i,null,!0):e.style[t]=i+this.unit,r&&r.call(e,i,this)}run(e,t,i){let r=this,o=r.options,s=function(e){return!s.stopped&&r.step(e)},l=n.requestAnimationFrame||function(e){setTimeout(e,13)},c=function(){for(let e=0;e<a.timers.length;e++)a.timers[e]()||a.timers.splice(e--,1);a.timers.length&&l(c)};e!==t||this.elem["forceAnimate:"+this.prop]?(this.startTime=+new Date,this.start=e,this.end=t,this.unit=i,this.now=this.start,this.pos=0,s.elem=this.elem,s.prop=this.prop,s()&&1===a.timers.push(s)&&l(c)):(delete o.curAnim[this.prop],o.complete&&0===Object.keys(o.curAnim).length&&o.complete.call(this.elem))}step(e){let t,i,r=+new Date,n=this.options,o=this.elem,a=n.complete,l=n.duration,c=n.curAnim;return o.attr&&!o.element?t=!1:e||r>=l+this.startTime?(this.now=this.end,this.pos=1,this.update(),c[this.prop]=!0,i=!0,s(c,(function(e){!0!==e&&(i=!1)})),i&&a&&a.call(o),t=!1):(this.pos=n.easing((r-this.startTime)/l),this.now=this.start+(this.end-this.start)*this.pos,this.update(),t=!0),t}initPath(e,t,i){let r,n,s,a,l=e.startX,c=e.endX,u=i.slice(),h=e.isArea,d=h?2:1,p=t&&i.length>t.length&&i.hasStackedCliffs,f=t&&t.slice();if(!f||p)return[u,u];function m(e,t){for(;e.length<n;){let i=e[0],r=t[n-e.length];if(r&&"M"===i[0]&&("C"===r[0]?e[0]=["C",i[1],i[2],i[1],i[2],i[1],i[2]]:e[0]=["L",i[1],i[2]]),e.unshift(i),h){let t=e.pop();e.push(e[e.length-1],t)}}}function g(e){for(;e.length<n;){let t=e[Math.floor(e.length/d)-1].slice();if("C"===t[0]&&(t[1]=t[5],t[2]=t[6]),h){let i=e[Math.floor(e.length/d)].slice();e.splice(e.length/2,0,t,i)}else e.push(t)}}if(l&&c&&c.length){for(s=0;s<l.length;s++){if(l[s]===c[0]){r=s;break}if(l[0]===c[c.length-l.length+s]){r=s,a=!0;break}if(l[l.length-1]===c[c.length-l.length+s]){r=l.length-s;break}}void 0===r&&(f=[])}return f.length&&o(r)&&(n=u.length+r*d,a?(m(f,u),g(u)):(m(u,f),g(f))),[f,u]}fillSetter(){a.prototype.strokeSetter.apply(this,arguments)}strokeSetter(){this.elem.attr(this.prop,r(this.start).tweenTo(r(this.end),this.pos),void 0,!0)}}return a.timers=[],a})),i(t,"Core/Animation/AnimationUtilities.js",[t["Core/Animation/Fx.js"],t["Core/Utilities.js"]],(function(e,t){let{defined:i,getStyle:r,isArray:n,isNumber:o,isObject:s,merge:a,objectEach:l,pick:c}=t;function u(e){return s(e)?a({duration:500,defer:0},e):{duration:e?500:0,defer:0}}function h(t,i){let r=e.timers.length;for(;r--;)e.timers[r].elem!==t||i&&i!==e.timers[r].prop||(e.timers[r].stopped=!0)}return{animate:function(t,i,c){let u,d,p,f,m="";s(c)||(f=arguments,c={duration:f[2],easing:f[3],complete:f[4]}),o(c.duration)||(c.duration=400),c.easing="function"==typeof c.easing?c.easing:Math[c.easing]||Math.easeInOutSine,c.curAnim=a(i),l(i,(function(o,s){h(t,s),p=new e(t,c,s),d=void 0,"d"===s&&n(i.d)?(p.paths=p.initPath(t,t.pathArray,i.d),p.toD=i.d,u=0,d=1):t.attr?u=t.attr(s):(u=parseFloat(r(t,s))||0,"opacity"!==s&&(m="px")),d||(d=o),"string"==typeof d&&d.match("px")&&(d=d.replace(/px/g,"")),p.run(u,d,m)}))},animObject:u,getDeferredAnimation:function(e,t,r){let n=u(t),o=r?[r]:e.series,a=0,l=0;return o.forEach((e=>{let r=u(e.options.animation);a=s(t)&&i(t.defer)?n.defer:Math.max(a,r.duration+r.defer),l=Math.min(n.duration,r.duration)})),e.renderer.forExport&&(a=0),{defer:Math.max(0,a-l),duration:Math.min(a,l)}},setAnimation:function(e,t){t.renderer.globalAnimation=c(e,t.options.chart.animation,!0)},stop:h}})),i(t,"Core/Renderer/HTML/AST.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],(function(e,t){let{SVG_NS:i,win:r}=e,{attr:n,createElement:o,css:s,error:a,isFunction:l,isString:c,objectEach:u,splat:h}=t,{trustedTypes:d}=r,p=d&&l(d.createPolicy)&&d.createPolicy("highcharts",{createHTML:e=>e}),f=p?p.createHTML(""):"",m=function(){try{return!!(new DOMParser).parseFromString(f,"text/html")}catch(e){return!1}}();class g{static filterUserAttributes(e){return u(e,((t,i)=>{let r=!0;-1===g.allowedAttributes.indexOf(i)&&(r=!1),-1!==["background","dynsrc","href","lowsrc","src"].indexOf(i)&&(r=c(t)&&g.allowedReferences.some((e=>0===t.indexOf(e)))),r||(a(33,!1,void 0,{"Invalid attribute in config":`${i}`}),delete e[i]),c(t)&&e[i]&&(e[i]=t.replace(/</g,"&lt;"))})),e}static parseStyle(e){return e.split(";").reduce(((e,t)=>{let i=t.split(":").map((e=>e.trim())),r=i.shift();return r&&i.length&&(e[r.replace(/-([a-z])/g,(e=>e[1].toUpperCase()))]=i.join(":")),e}),{})}static setElementHTML(e,t){e.innerHTML=g.emptyHTML,t&&new g(t).addToDOM(e)}constructor(e){this.nodes="string"==typeof e?this.parseMarkup(e):e}addToDOM(t){return function t(r,o){let l;return h(r).forEach((function(r){let c,h=r.tagName,d=r.textContent?e.doc.createTextNode(r.textContent):void 0,p=g.bypassHTMLFiltering;if(h)if("#text"===h)c=d;else if(-1!==g.allowedTags.indexOf(h)||p){let a="svg"===h?i:o.namespaceURI||i,l=e.doc.createElementNS(a,h),f=r.attributes||{};u(r,(function(e,t){"tagName"!==t&&"attributes"!==t&&"children"!==t&&"style"!==t&&"textContent"!==t&&(f[t]=e)})),n(l,p?f:g.filterUserAttributes(f)),r.style&&s(l,r.style),d&&l.appendChild(d),t(r.children||[],l),c=l}else a(33,!1,void 0,{"Invalid tagName in config":h});c&&o.appendChild(c),l=c})),l}(this.nodes,t)}parseMarkup(e){let t,i=[];if(e=e.trim().replace(/ style=(["'])/g," data-style=$1"),m)t=(new DOMParser).parseFromString(p?p.createHTML(e):e,"text/html");else{let i=o("div");i.innerHTML=e,t={body:i}}let r=(e,t)=>{let i=e.nodeName.toLowerCase(),n={tagName:i};"#text"===i&&(n.textContent=e.textContent||"");let o=e.attributes;if(o){let e={};[].forEach.call(o,(t=>{"data-style"===t.name?n.style=g.parseStyle(t.value):e[t.name]=t.value})),n.attributes=e}if(e.childNodes.length){let t=[];[].forEach.call(e.childNodes,(e=>{r(e,t)})),t.length&&(n.children=t)}t.push(n)};return[].forEach.call(t.body.childNodes,(e=>r(e,i))),i}}return g.allowedAttributes=["alt","aria-controls","aria-describedby","aria-expanded","aria-haspopup","aria-hidden","aria-label","aria-labelledby","aria-live","aria-pressed","aria-readonly","aria-roledescription","aria-selected","class","clip-path","color","colspan","cx","cy","d","dx","dy","disabled","fill","filterUnits","flood-color","flood-opacity","height","href","id","in","in2","markerHeight","markerWidth","offset","opacity","operator","orient","padding","paddingLeft","paddingRight","patternUnits","r","radius","refX","refY","role","scope","slope","src","startOffset","stdDeviation","stroke","stroke-linecap","stroke-width","style","tableValues","result","rowspan","summary","target","tabindex","text-align","text-anchor","textAnchor","textLength","title","type","valign","width","x","x1","x2","xlink:href","y","y1","y2","zIndex"],g.allowedReferences=["https://","http://","mailto:","/","../","./","#"],g.allowedTags=["a","abbr","b","br","button","caption","circle","clipPath","code","dd","defs","div","dl","dt","em","feComponentTransfer","feComposite","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMorphology","feOffset","feMerge","feMergeNode","filter","h1","h2","h3","h4","h5","h6","hr","i","img","li","linearGradient","marker","ol","p","path","pattern","pre","rect","small","span","stop","strong","style","sub","sup","svg","table","text","textPath","thead","title","tbody","tspan","td","th","tr","u","ul","#text"],g.emptyHTML=f,g.bypassHTMLFiltering=!1,g})),i(t,"Core/Templating.js",[t["Core/Defaults.js"],t["Core/Utilities.js"]],(function(e,t){let{defaultOptions:i,defaultTime:r}=e,{extend:n,getNestedProperty:o,isArray:s,isNumber:a,isObject:l,pick:c,pInt:u}=t,h={add:(e,t)=>e+t,divide:(e,t)=>0!==t?e/t:"",eq:(e,t)=>e==t,each:function(e){let t=arguments[arguments.length-1];return!!s(e)&&e.map(((i,r)=>d(t.body,n(l(i)?i:{"@this":i},{"@index":r,"@first":0===r,"@last":r===e.length-1})))).join("")},ge:(e,t)=>e>=t,gt:(e,t)=>e>t,if:e=>!!e,le:(e,t)=>e<=t,lt:(e,t)=>e<t,multiply:(e,t)=>e*t,ne:(e,t)=>e!=t,subtract:(e,t)=>e-t,unless:e=>!e};function d(){let e,t,n,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1?arguments[1]:void 0,l=arguments.length>2?arguments[2]:void 0,u=/\{([\w\:\.\,;\-\/<>%@"'\u2019= #\(\)]+)\}/g,f=/\(([\w\:\.\,;\-\/<>%@"'= ]+)\)/g,m=[],g=/f$/,y=/\.(\d)/,_=i.lang,v=l&&l.time||r,x=l&&l.numberFormatter||p,b=function(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"true"===t||"false"!==t&&((e=Number(t)).toString()===t?e:o(t,a))},w=0;for(;null!==(e=u.exec(s));){let i=f.exec(e[1]);i&&(e=i,n=!0),t&&t.isBlock||(t={ctx:a,expression:e[1],find:e[0],isBlock:"#"===e[1].charAt(0),start:e.index,startInner:e.index+e[0].length,length:e[0].length});let r=e[1].split(" ")[0].replace("#","");h[r]&&(t.isBlock&&r===t.fn&&w++,t.fn||(t.fn=r));let o="else"===e[1];if(t.isBlock&&t.fn&&(e[1]===`/${t.fn}`||o))if(w)!o&&w--;else{let i=t.startInner,r=s.substr(i,e.index-i);void 0===t.body?(t.body=r,t.startInner=e.index+e[0].length):t.elseBody=r,t.find+=r+e[0],o||(m.push(t),t=void 0)}else t.isBlock||m.push(t);if(i&&!t?.isBlock)break}return m.forEach((e=>{let t,i,{body:r,elseBody:n,expression:o,fn:u}=e;if(u){let s=[e],c=o.split(" ");for(i=h[u].length;i--;)s.unshift(b(c[i+1]));t=h[u].apply(a,s),e.isBlock&&"boolean"==typeof t&&(t=d(t?r:n,a,l))}else{let e=o.split(":");if(t=b(e.shift()||""),e.length&&"number"==typeof t){let i=e.join(":");if(g.test(i)){let e=parseInt((i.match(y)||["","-1"])[1],10);null!==t&&(t=x(t,e,_.decimalPoint,i.indexOf(",")>-1?_.thousandsSep:""))}else t=v.dateFormat(i,t)}}s=s.replace(e.find,c(t,""))})),n?d(s,a,l):s}function p(e,t,r,n){let o,s;e=+e||0,t=+t;let l=i.lang,h=(e.toString().split(".")[1]||"").split("e")[0].length,d=e.toString().split("e"),p=t;-1===t?t=Math.min(h,20):a(t)?t&&d[1]&&d[1]<0&&((s=t+ +d[1])>=0?(d[0]=(+d[0]).toExponential(s).split("e")[0],t=s):(d[0]=d[0].split(".")[0]||0,e=t<20?(d[0]*Math.pow(10,d[1])).toFixed(t):0,d[1]=0)):t=2;let f=(Math.abs(d[1]?d[0]:e)+Math.pow(10,-Math.max(t,h)-1)).toFixed(t),m=String(u(f)),g=m.length>3?m.length%3:0;return r=c(r,l.decimalPoint),n=c(n,l.thousandsSep),o=(e<0?"-":"")+(g?m.substr(0,g)+n:""),0>+d[1]&&!p?o="0":o+=m.substr(g).replace(/(\d{3})(?=\d)/g,"$1"+n),t?o+=r+f.slice(-t):0==+o&&(o="0"),d[1]&&0!=+o&&(o+="e"+d[1]),o}return{dateFormat:function(e,t,i){return r.dateFormat(e,t,i)},format:d,helpers:h,numberFormat:p}})),i(t,"Core/Renderer/RendererRegistry.js",[t["Core/Globals.js"]],(function(e){var t,i;let r;return(i=t||(t={})).rendererTypes={},i.getRendererType=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r;return i.rendererTypes[e]||i.rendererTypes[r]},i.registerRendererType=function(t,n,o){i.rendererTypes[t]=n,(!r||o)&&(r=t,e.Renderer=n)},t})),i(t,"Core/Renderer/RendererUtilities.js",[t["Core/Utilities.js"]],(function(e){var t;let{clamp:i,pick:r,pushUnique:n,stableSort:o}=e;return(t||(t={})).distribute=function e(t,s,a){let l,c,u,h,d,p,f=t,m=f.reducedLen||s,g=(e,t)=>e.target-t.target,y=[],_=t.length,v=[],x=y.push,b=!0,w=0;for(l=_;l--;)w+=t[l].size;if(w>m){for(o(t,((e,t)=>(t.rank||0)-(e.rank||0))),u=(p=t[0].rank===t[t.length-1].rank)?_/2:-1,c=p?u:_-1;u&&w>m;)h=t[l=Math.floor(c)],n(v,l)&&(w-=h.size),c+=u,p&&c>=t.length&&(u/=2,c=u);v.sort(((e,t)=>t-e)).forEach((e=>x.apply(y,t.splice(e,1))))}for(o(t,g),t=t.map((e=>({size:e.size,targets:[e.target],align:r(e.align,.5)})));b;){for(l=t.length;l--;)h=t[l],d=(Math.min.apply(0,h.targets)+Math.max.apply(0,h.targets))/2,h.pos=i(d-h.size*h.align,0,s-h.size);for(l=t.length,b=!1;l--;)l>0&&t[l-1].pos+t[l-1].size>t[l].pos&&(t[l-1].size+=t[l].size,t[l-1].targets=t[l-1].targets.concat(t[l].targets),t[l-1].align=.5,t[l-1].pos+t[l-1].size>s&&(t[l-1].pos=s-t[l-1].size),t.splice(l,1),b=!0)}return x.apply(f,y),l=0,t.some((t=>{let i=0;return(t.targets||[]).some((()=>(f[l].pos=t.pos+i,void 0!==a&&Math.abs(f[l].pos-f[l].target)>a?(f.slice(0,l+1).forEach((e=>delete e.pos)),f.reducedLen=(f.reducedLen||s)-.1*s,f.reducedLen>.1*s&&e(f,s,a),!0):(i+=f[l].size,l++,!1))))})),o(f,g),f},t})),i(t,"Core/Renderer/SVG/SVGElement.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Color/Color.js"],t["Core/Globals.js"],t["Core/Utilities.js"]],(function(e,t,i,r){let{animate:n,animObject:o,stop:s}=e,{deg2rad:a,doc:l,svg:c,SVG_NS:u,win:h}=i,{addEvent:d,attr:p,createElement:f,crisp:m,css:g,defined:y,erase:_,extend:v,fireEvent:x,isArray:b,isFunction:w,isObject:S,isString:T,merge:M,objectEach:A,pick:C,pInt:E,pushUnique:P,replaceNested:k,syncTimeout:I,uniqueKey:D}=r;class L{_defaultGetter(e){let t=C(this[e+"Value"],this[e],this.element?this.element.getAttribute(e):null,0);return/^-?[\d\.]+$/.test(t)&&(t=parseFloat(t)),t}_defaultSetter(e,t,i){i.setAttribute(t,e)}add(e){let t,i=this.renderer,r=this.element;return e&&(this.parentGroup=e),void 0!==this.textStr&&"text"===this.element.nodeName&&i.buildText(this),this.added=!0,(!e||e.handleZ||this.zIndex)&&(t=this.zIndexSetter()),t||(e?e.element:i.box).appendChild(r),this.onAdd&&this.onAdd(),this}addClass(e,t){let i=t?"":this.attr("class")||"";return(e=(e||"").split(/ /g).reduce((function(e,t){return-1===i.indexOf(t)&&e.push(t),e}),i?[i]:[]).join(" "))!==i&&this.attr("class",e),this}afterSetters(){this.doTransform&&(this.updateTransform(),this.doTransform=!1)}align(e,t,i){let r,n,o,s,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],l={},c=this.renderer,u=c.alignedObjects,h=!!e;e?(this.alignOptions=e,this.alignByTranslate=t,this.alignTo=i):(e=this.alignOptions||{},t=this.alignByTranslate,i=this.alignTo);let d=!i||T(i)?i||"renderer":void 0;d&&(h&&P(u,this),i=void 0);let p=C(i,c[d],c),f=e.align,m=e.verticalAlign;return r=(p.x||0)+(e.x||0),n=(p.y||0)+(e.y||0),"right"===f?o=1:"center"===f&&(o=2),o&&(r+=((p.width||0)-(e.width||0))/o),l[t?"translateX":"x"]=Math.round(r),"bottom"===m?s=1:"middle"===m&&(s=2),s&&(n+=((p.height||0)-(e.height||0))/s),l[t?"translateY":"y"]=Math.round(n),a&&(this[this.placed?"animate":"attr"](l),this.placed=!0),this.alignAttr=l,this}alignSetter(e){let t={left:"start",center:"middle",right:"end"};t[e]&&(this.alignValue=e,this.element.setAttribute("text-anchor",t[e]))}animate(e,t,i){let r=o(C(t,this.renderer.globalAnimation,!0)),s=r.defer;return l.hidden&&(r.duration=0),0!==r.duration?(i&&(r.complete=i),I((()=>{this.element&&n(this,e,r)}),s)):(this.attr(e,void 0,i||r.complete),A(e,(function(e,t){r.step&&r.step.call(this,e,{prop:t,pos:1,elem:this})}),this)),this}applyTextOutline(e){let t=this.element;-1!==e.indexOf("contrast")&&(e=e.replace(/contrast/g,this.renderer.getContrast(t.style.fill)));let r=e.split(" "),n=r[r.length-1],o=r[0];if(o&&"none"!==o&&i.svg){this.fakeTS=!0,o=o.replace(/(^[\d\.]+)(.*?)$/g,(function(e,t,i){return 2*Number(t)+i})),this.removeTextOutline();let e=l.createElementNS(u,"tspan");p(e,{class:"highcharts-text-outline",fill:n,stroke:n,"stroke-width":o,"stroke-linejoin":"round"});let i=t.querySelector("textPath")||t;[].forEach.call(i.childNodes,(t=>{let i=t.cloneNode(!0);i.removeAttribute&&["fill","stroke","stroke-width","stroke"].forEach((e=>i.removeAttribute(e))),e.appendChild(i)}));let r=0;[].forEach.call(i.querySelectorAll("text tspan"),(e=>{r+=Number(e.getAttribute("dy"))}));let s=l.createElementNS(u,"tspan");s.textContent="\u200b",p(s,{x:Number(t.getAttribute("x")),dy:-r}),e.appendChild(s),i.insertBefore(e,i.firstChild)}}attr(e,t,i,r){let n,o,a,{element:l}=this,c=L.symbolCustomAttribs,u=this;return"string"==typeof e&&void 0!==t&&(n=e,(e={})[n]=t),"string"==typeof e?u=(this[e+"Getter"]||this._defaultGetter).call(this,e,l):(A(e,(function(t,i){a=!1,r||s(this,i),this.symbolName&&-1!==c.indexOf(i)&&(o||(this.symbolAttr(e),o=!0),a=!0),this.rotation&&("x"===i||"y"===i)&&(this.doTransform=!0),a||(this[i+"Setter"]||this._defaultSetter).call(this,t,i,l)}),this),this.afterSetters()),i&&i.call(this),u}clip(e){if(e&&!e.clipPath){let t=D()+"-",i=this.renderer.createElement("clipPath").attr({id:t}).add(this.renderer.defs);v(e,{clipPath:i,id:t,count:0}),e.add(i)}return this.attr("clip-path",e?`url(${this.renderer.url}#${e.id})`:"none")}crisp(e,t){t=Math.round(t||e.strokeWidth||0);let i=e.x||this.x||0,r=e.y||this.y||0,n=(e.width||this.width||0)+i,o=(e.height||this.height||0)+r,s=m(i,t),a=m(r,t);return v(e,{x:s,y:a,width:m(n,t)-s,height:m(o,t)-a}),y(e.strokeWidth)&&(e.strokeWidth=t),e}complexColor(e,i,r){let n,o,s,a,l,c,u,h,d,p,f,m=this.renderer,g=[];x(this.renderer,"complexColor",{args:arguments},(function(){if(e.radialGradient?o="radialGradient":e.linearGradient&&(o="linearGradient"),o){if(s=e[o],l=m.gradients,c=e.stops,d=r.radialReference,b(s)&&(e[o]=s={x1:s[0],y1:s[1],x2:s[2],y2:s[3],gradientUnits:"userSpaceOnUse"}),"radialGradient"===o&&d&&!y(s.gradientUnits)&&(a=s,s=M(s,m.getRadialAttr(d,a),{gradientUnits:"userSpaceOnUse"})),A(s,(function(e,t){"id"!==t&&g.push(t,e)})),A(c,(function(e){g.push(e)})),l[g=g.join(",")])p=l[g].attr("id");else{s.id=p=D();let e=l[g]=m.createElement(o).attr(s).add(m.defs);e.radAttr=a,e.stops=[],c.forEach((function(i){0===i[1].indexOf("rgba")?(u=(n=t.parse(i[1])).get("rgb"),h=n.get("a")):(u=i[1],h=1);let r=m.createElement("stop").attr({offset:i[0],"stop-color":u,"stop-opacity":h}).add(e);e.stops.push(r)}))}f="url("+m.url+"#"+p+")",r.setAttribute(i,f),r.gradient=g,e.toString=function(){return f}}}))}css(e){let t,i=this.styles,r={},n=this.element,o=!i;if(i&&A(e,(function(e,t){i&&i[t]!==e&&(r[t]=e,o=!0)})),o){i&&(e=v(i,r)),null===e.width||"auto"===e.width?delete this.textWidth:"text"===n.nodeName.toLowerCase()&&e.width&&(t=this.textWidth=E(e.width)),v(this.styles,e),t&&!c&&this.renderer.forExport&&delete e.width;let o=M(e);n.namespaceURI===this.SVG_NS&&(["textOutline","textOverflow","width"].forEach((e=>o&&delete o[e])),o.color&&(o.fill=o.color)),g(n,o)}return this.added&&("text"===this.element.nodeName&&this.renderer.buildText(this),e.textOutline&&this.applyTextOutline(e.textOutline)),this}dashstyleSetter(e){let t,i=this["stroke-width"];if("inherit"===i&&(i=1),e=e&&e.toLowerCase()){let r=e.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(",");for(t=r.length;t--;)r[t]=""+E(r[t])*C(i,NaN);e=r.join(",").replace(/NaN/g,"none"),this.element.setAttribute("stroke-dasharray",e)}}destroy(){let e,t,i=this,r=i.element||{},n=i.renderer,o=r.ownerSVGElement,a="SPAN"===r.nodeName&&i.parentGroup||void 0;if(r.onclick=r.onmouseout=r.onmouseover=r.onmousemove=r.point=null,s(i),i.clipPath&&o){let e=i.clipPath;[].forEach.call(o.querySelectorAll("[clip-path],[CLIP-PATH]"),(function(t){t.getAttribute("clip-path").indexOf(e.element.id)>-1&&t.removeAttribute("clip-path")})),i.clipPath=e.destroy()}if(i.connector=i.connector?.destroy(),i.stops){for(t=0;t<i.stops.length;t++)i.stops[t].destroy();i.stops.length=0,i.stops=void 0}for(i.safeRemoveChild(r);a&&a.div&&0===a.div.childNodes.length;)e=a.parentGroup,i.safeRemoveChild(a.div),delete a.div,a=e;i.alignOptions&&_(n.alignedObjects,i),A(i,(function(e,t){i[t]&&i[t].parentGroup===i&&i[t].destroy&&i[t].destroy(),delete i[t]}))}dSetter(e,t,i){b(e)&&("string"==typeof e[0]&&(e=this.renderer.pathToSegments(e)),this.pathArray=e,e=e.reduce(((e,t,i)=>t&&t.join?(i?e+" ":"")+t.join(" "):(t||"").toString()),"")),/(NaN| {2}|^$)/.test(e)&&(e="M 0 0"),this[t]!==e&&(i.setAttribute(t,e),this[t]=e)}fillSetter(e,t,i){"string"==typeof e?i.setAttribute(t,e):e&&this.complexColor(e,t,i)}hrefSetter(e,t,i){i.setAttributeNS("http://www.w3.org/1999/xlink",t,e)}getBBox(e,t){let i,r,n,o,{alignValue:s,element:a,renderer:l,styles:c,textStr:u}=this,{cache:h,cacheKeys:d}=l,p=a.namespaceURI===this.SVG_NS,f=C(t,this.rotation,0),m=l.styledMode?a&&L.prototype.getStyle.call(a,"font-size"):c.fontSize;if(y(u)&&(-1===(o=u.toString()).indexOf("<")&&(o=o.replace(/\d/g,"0")),o+=["",l.rootFontSize,m,f,this.textWidth,s,c.textOverflow,c.fontWeight].join(",")),o&&!e&&(i=h[o]),!i||i.polygon){if(p||l.forExport){try{n=this.fakeTS&&function(e){let t=a.querySelector(".highcharts-text-outline");t&&g(t,{display:e})},w(n)&&n("none"),i=a.getBBox?v({},a.getBBox()):{width:a.offsetWidth,height:a.offsetHeight,x:0,y:0},w(n)&&n("")}catch(e){}(!i||i.width<0)&&(i={x:0,y:0,width:0,height:0})}else i=this.htmlGetBBox();r=i.height,p&&(i.height=r={"11px,17":14,"13px,20":16}[`${m||""},${Math.round(r)}`]||r),f&&(i=this.getRotatedBox(i,f));let t={bBox:i};x(this,"afterGetBBox",t),i=t.bBox}if(o&&(""===u||i.height>0)){for(;d.length>250;)delete h[d.shift()];h[o]||d.push(o),h[o]=i}return i}getRotatedBox(e,t){let{x:i,y:r,width:n,height:o}=e,{alignValue:s,translateY:l,rotationOriginX:c=0,rotationOriginY:u=0}=this,h={right:1,center:.5}[s||0]||0,d=Number(this.element.getAttribute("y")||0)-(l?0:r),p=t*a,f=(t-90)*a,m=Math.cos(p),g=Math.sin(p),y=n*m,_=n*g,v=Math.cos(f),x=Math.sin(f),[[b,w],[S,T]]=[c,u].map((e=>[e-e*m,e*g])),M=i+h*(n-y)+b+T+d*v,A=M+y,C=A-o*v,E=C-y,P=r+d-h*_-w+S+d*x,k=P+_,I=k-o*x,D=I-_,L=Math.min(M,A,C,E),R=Math.min(P,k,I,D);return{x:L,y:R,width:Math.max(M,A,C,E)-L,height:Math.max(P,k,I,D)-R,polygon:[[M,P],[A,k],[C,I],[E,D]]}}getStyle(e){return h.getComputedStyle(this.element||this,"").getPropertyValue(e)}hasClass(e){return-1!==(""+this.attr("class")).split(" ").indexOf(e)}hide(){return this.attr({visibility:"hidden"})}htmlGetBBox(){return{height:0,width:0,x:0,y:0}}constructor(e,t){this.onEvents={},this.opacity=1,this.SVG_NS=u,this.element="span"===t||"body"===t?f(t):l.createElementNS(this.SVG_NS,t),this.renderer=e,this.styles={},x(this,"afterInit")}on(e,t){let{onEvents:i}=this;return i[e]&&i[e](),i[e]=d(this.element,e,t),this}opacitySetter(e,t,i){let r=Number(Number(e).toFixed(3));this.opacity=r,i.setAttribute(t,r)}reAlign(){this.alignOptions?.width&&"left"!==this.alignOptions.align&&(this.alignOptions.width=this.getBBox().width,this.placed=!1,this.align())}removeClass(e){return this.attr("class",(""+this.attr("class")).replace(T(e)?RegExp(`(^| )${e}( |$)`):e," ").replace(/ +/g," ").trim())}removeTextOutline(){let e=this.element.querySelector("tspan.highcharts-text-outline");e&&this.safeRemoveChild(e)}safeRemoveChild(e){let t=e.parentNode;t&&t.removeChild(e)}setRadialReference(e){let t=this.element.gradient&&this.renderer.gradients[this.element.gradient];return this.element.radialReference=e,t&&t.radAttr&&t.animate(this.renderer.getRadialAttr(e,t.radAttr)),this}shadow(e){let{renderer:t}=this,i=M(90===this.parentGroup?.rotation?{offsetX:-1,offsetY:-1}:{},S(e)?e:{}),r=t.shadowDefinition(i);return this.attr({filter:e?`url(${t.url}#${r})`:"none"})}show(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.attr({visibility:e?"inherit":"visible"})}"stroke-widthSetter"(e,t,i){this[t]=e,i.setAttribute(t,e)}strokeWidth(){if(!this.renderer.styledMode)return this["stroke-width"]||0;let e,t=this.getStyle("stroke-width"),i=0;return/px$/.test(t)?i=E(t):""!==t&&(p(e=l.createElementNS(u,"rect"),{width:t,"stroke-width":0}),this.element.parentNode.appendChild(e),i=e.getBBox().width,e.parentNode.removeChild(e)),i}symbolAttr(e){let t=this;L.symbolCustomAttribs.forEach((function(i){t[i]=C(e[i],t[i])})),t.attr({d:t.renderer.symbols[t.symbolName](t.x,t.y,t.width,t.height,t)})}textSetter(e){e!==this.textStr&&(delete this.textPxLength,this.textStr=e,this.added&&this.renderer.buildText(this),this.reAlign())}titleSetter(e){let t=this.element,i=t.getElementsByTagName("title")[0]||l.createElementNS(this.SVG_NS,"title");t.insertBefore?t.insertBefore(i,t.firstChild):t.appendChild(i),i.textContent=k(C(e,""),[/<[^>]*>/g,""]).replace(/&lt;/g,"<").replace(/&gt;/g,">")}toFront(){let e=this.element;return e.parentNode.appendChild(e),this}translate(e,t){return this.attr({translateX:e,translateY:t})}updateTransform(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"transform",{element:t,matrix:i,rotation:r=0,rotationOriginX:n,rotationOriginY:o,scaleX:s,scaleY:a,translateX:l=0,translateY:c=0}=this,u=["translate("+l+","+c+")"];y(i)&&u.push("matrix("+i.join(",")+")"),r&&(u.push("rotate("+r+" "+C(n,t.getAttribute("x"),0)+" "+C(o,t.getAttribute("y")||0)+")"),"SPAN"===this.text?.element.tagName&&this.text.attr({rotation:r,rotationOriginX:(n||0)-this.padding,rotationOriginY:(o||0)-this.padding})),(y(s)||y(a))&&u.push("scale("+C(s,1)+" "+C(a,1)+")"),u.length&&!(this.text||this).textPath&&t.setAttribute(e,u.join(" "))}visibilitySetter(e,t,i){"inherit"===e?i.removeAttribute(t):this[t]!==e&&i.setAttribute(t,e),this[t]=e}xGetter(e){return"circle"===this.element.nodeName&&("x"===e?e="cx":"y"===e&&(e="cy")),this._defaultGetter(e)}zIndexSetter(e,t){let i,r,n,o,s,a=this.renderer,l=this.parentGroup,c=(l||a).element||a.box,u=this.element,h=c===a.box,d=!1,p=this.added;if(y(e)?(u.setAttribute("data-z-index",e),e=+e,this[t]===e&&(p=!1)):y(this[t])&&u.removeAttribute("data-z-index"),this[t]=e,p){for((e=this.zIndex)&&l&&(l.handleZ=!0),s=(i=c.childNodes).length-1;s>=0&&!d;s--)o=!y(n=(r=i[s]).getAttribute("data-z-index")),r!==u&&(e<0&&o&&!h&&!s?(c.insertBefore(u,i[s]),d=!0):(E(n)<=e||o&&(!y(e)||e>=0))&&(c.insertBefore(u,i[s+1]),d=!0));d||(c.insertBefore(u,i[h?3:0]),d=!0)}return d}}return L.symbolCustomAttribs=["anchorX","anchorY","clockwise","end","height","innerR","r","start","width","x","y"],L.prototype.strokeSetter=L.prototype.fillSetter,L.prototype.yGetter=L.prototype.xGetter,L.prototype.matrixSetter=L.prototype.rotationOriginXSetter=L.prototype.rotationOriginYSetter=L.prototype.rotationSetter=L.prototype.scaleXSetter=L.prototype.scaleYSetter=L.prototype.translateXSetter=L.prototype.translateYSetter=L.prototype.verticalAlignSetter=function(e,t){this[t]=e,this.doTransform=!0},L})),i(t,"Core/Renderer/SVG/SVGLabel.js",[t["Core/Renderer/SVG/SVGElement.js"],t["Core/Utilities.js"]],(function(e,t){let{defined:i,extend:r,isNumber:n,merge:o,pick:s,removeEvent:a}=t;class l extends e{constructor(e,t,i,r,n,o,s,a,c,u){let h;super(e,"g"),this.paddingLeftSetter=this.paddingSetter,this.paddingRightSetter=this.paddingSetter,this.doUpdate=!1,this.textStr=t,this.x=i,this.y=r,this.anchorX=o,this.anchorY=s,this.baseline=c,this.className=u,this.addClass("button"===u?"highcharts-no-tooltip":"highcharts-label"),u&&this.addClass("highcharts-"+u),this.text=e.text(void 0,0,0,a).attr({zIndex:1}),"string"==typeof n&&((h=/^url\((.*?)\)$/.test(n))||this.renderer.symbols[n])&&(this.symbolKey=n),this.bBox=l.emptyBBox,this.padding=3,this.baselineOffset=0,this.needsBox=e.styledMode||h,this.deferredAttr={},this.alignFactor=0}alignSetter(e){let t={left:0,center:.5,right:1}[e];t!==this.alignFactor&&(this.alignFactor=t,this.bBox&&n(this.xSetting)&&this.attr({x:this.xSetting}))}anchorXSetter(e,t){this.anchorX=e,this.boxAttr(t,Math.round(e)-this.getCrispAdjust()-this.xSetting)}anchorYSetter(e,t){this.anchorY=e,this.boxAttr(t,e-this.ySetting)}boxAttr(e,t){this.box?this.box.attr(e,t):this.deferredAttr[e]=t}css(t){if(t){let e={};t=o(t),l.textProps.forEach((i=>{void 0!==t[i]&&(e[i]=t[i],delete t[i])})),this.text.css(e),"fontSize"in e||"fontWeight"in e?this.updateTextPadding():("width"in e||"textOverflow"in e)&&this.updateBoxSize()}return e.prototype.css.call(this,t)}destroy(){a(this.element,"mouseenter"),a(this.element,"mouseleave"),this.text&&this.text.destroy(),this.box&&(this.box=this.box.destroy()),e.prototype.destroy.call(this)}fillSetter(e,t){e&&(this.needsBox=!0),this.fill=e,this.boxAttr(t,e)}getBBox(e,t){this.textStr&&0===this.bBox.width&&0===this.bBox.height&&this.updateBoxSize();let{padding:i,height:r=0,translateX:n=0,translateY:o=0,width:a=0}=this,l=s(this.paddingLeft,i),c=t??(this.rotation||0),u={width:a,height:r,x:n+this.bBox.x-l,y:o+this.bBox.y-i+this.baselineOffset};return c&&(u=this.getRotatedBox(u,c)),u}getCrispAdjust(){return(this.renderer.styledMode&&this.box?this.box.strokeWidth():this["stroke-width"]?parseInt(this["stroke-width"],10):0)%2/2}heightSetter(e){this.heightSetting=e,this.doUpdate=!0}afterSetters(){super.afterSetters(),this.doUpdate&&(this.updateBoxSize(),this.doUpdate=!1)}onAdd(){this.text.add(this),this.attr({text:s(this.textStr,""),x:this.x||0,y:this.y||0}),this.box&&i(this.anchorX)&&this.attr({anchorX:this.anchorX,anchorY:this.anchorY})}paddingSetter(e,t){n(e)?e!==this[t]&&(this[t]=e,this.updateTextPadding()):this[t]=void 0}rSetter(e,t){this.boxAttr(t,e)}strokeSetter(e,t){this.stroke=e,this.boxAttr(t,e)}"stroke-widthSetter"(e,t){e&&(this.needsBox=!0),this["stroke-width"]=e,this.boxAttr(t,e)}"text-alignSetter"(e){this.textAlign=e}textSetter(e){void 0!==e&&this.text.attr({text:e}),this.updateTextPadding(),this.reAlign()}updateBoxSize(){let e,t=this.text,o={},s=this.padding,a=this.bBox=n(this.widthSetting)&&n(this.heightSetting)&&!this.textAlign||!i(t.textStr)?l.emptyBBox:t.getBBox(void 0,0);this.width=this.getPaddedWidth(),this.height=(this.heightSetting||a.height||0)+2*s;let c=this.renderer.fontMetrics(t);if(this.baselineOffset=s+Math.min((this.text.firstLineMetrics||c).b,a.height||1/0),this.heightSetting&&(this.baselineOffset+=(this.heightSetting-c.h)/2),this.needsBox&&!t.textPath){if(!this.box){let e=this.box=this.symbolKey?this.renderer.symbol(this.symbolKey):this.renderer.rect();e.addClass(("button"===this.className?"":"highcharts-label-box")+(this.className?" highcharts-"+this.className+"-box":"")),e.add(this)}e=this.getCrispAdjust(),o.x=e,o.y=(this.baseline?-this.baselineOffset:0)+e,o.width=Math.round(this.width),o.height=Math.round(this.height),this.box.attr(r(o,this.deferredAttr)),this.deferredAttr={}}}updateTextPadding(){let e=this.text;if(!e.textPath){this.updateBoxSize();let t=this.baseline?0:this.baselineOffset,r=s(this.paddingLeft,this.padding);i(this.widthSetting)&&this.bBox&&("center"===this.textAlign||"right"===this.textAlign)&&(r+={center:.5,right:1}[this.textAlign]*(this.widthSetting-this.bBox.width)),(r!==e.x||t!==e.y)&&(e.attr("x",r),e.hasBoxWidthChanged&&(this.bBox=e.getBBox(!0)),void 0!==t&&e.attr("y",t)),e.x=r,e.y=t}}widthSetter(e){this.widthSetting=n(e)?e:void 0,this.doUpdate=!0}getPaddedWidth(){let e=this.padding,t=s(this.paddingLeft,e),i=s(this.paddingRight,e);return(this.widthSetting||this.bBox.width||0)+t+i}xSetter(e){this.x=e,this.alignFactor&&(e-=this.alignFactor*this.getPaddedWidth(),this["forceAnimate:x"]=!0),this.xSetting=Math.round(e),this.attr("translateX",this.xSetting)}ySetter(e){this.ySetting=this.y=Math.round(e),this.attr("translateY",this.ySetting)}}return l.emptyBBox={width:0,height:0,x:0,y:0},l.textProps=["color","direction","fontFamily","fontSize","fontStyle","fontWeight","lineHeight","textAlign","textDecoration","textOutline","textOverflow","whiteSpace","width"],l})),i(t,"Core/Renderer/SVG/Symbols.js",[t["Core/Utilities.js"]],(function(e){let{defined:t,isNumber:i,pick:r}=e;function n(e,i,n,o,s){let a=[];if(s){let l=s.start||0,c=r(s.r,n),u=r(s.r,o||n),h=2e-4/(s.borderRadius?1:Math.max(c,1)),d=Math.abs((s.end||0)-l-2*Math.PI)<h,p=(s.end||0)-(d?h:0),f=s.innerR,m=r(s.open,d),g=Math.cos(l),y=Math.sin(l),_=Math.cos(p),v=Math.sin(p),x=r(s.longArc,p-l-Math.PI<h?0:1),b=["A",c,u,0,x,r(s.clockwise,1),e+c*_,i+u*v];b.params={start:l,end:p,cx:e,cy:i},a.push(["M",e+c*g,i+u*y],b),t(f)&&((b=["A",f,f,0,x,t(s.clockwise)?1-s.clockwise:0,e+f*g,i+f*y]).params={start:p,end:l,cx:e,cy:i},a.push(m?["M",e+f*_,i+f*v]:["L",e+f*_,i+f*v],b)),m||a.push(["Z"])}return a}function o(e,t,i,r,n){return n&&n.r?s(e,t,i,r,n):[["M",e,t],["L",e+i,t],["L",e+i,t+r],["L",e,t+r],["Z"]]}function s(e,t,i,r,n){let o=n?.r||0;return[["M",e+o,t],["L",e+i-o,t],["A",o,o,0,0,1,e+i,t+o],["L",e+i,t+r-o],["A",o,o,0,0,1,e+i-o,t+r],["L",e+o,t+r],["A",o,o,0,0,1,e,t+r-o],["L",e,t+o],["A",o,o,0,0,1,e+o,t],["Z"]]}return{arc:n,callout:function(e,t,r,n,o){let a=Math.min(o&&o.r||0,r,n),l=a+6,c=o&&o.anchorX,u=o&&o.anchorY||0,h=s(e,t,r,n,{r:a});if(!i(c)||c<r&&c>0&&u<n&&u>0)return h;if(e+c>r-l)if(u>t+l&&u<t+n-l)h.splice(3,1,["L",e+r,u-6],["L",e+r+6,u],["L",e+r,u+6],["L",e+r,t+n-a]);else if(c<r){let i=u<t+l,o=i?t:t+n;h.splice(i?2:5,0,["L",c,u],["L",e+r-a,o])}else h.splice(3,1,["L",e+r,n/2],["L",c,u],["L",e+r,n/2],["L",e+r,t+n-a]);else if(e+c<l)if(u>t+l&&u<t+n-l)h.splice(7,1,["L",e,u+6],["L",e-6,u],["L",e,u-6],["L",e,t+a]);else if(c>0){let i=u<t+l,r=i?t:t+n;h.splice(i?1:6,0,["L",c,u],["L",e+a,r])}else h.splice(7,1,["L",e,n/2],["L",c,u],["L",e,n/2],["L",e,t+a]);else u>n&&c<r-l?h.splice(5,1,["L",c+6,t+n],["L",c,t+n+6],["L",c-6,t+n],["L",e+a,t+n]):u<0&&c>l&&h.splice(1,1,["L",c-6,t],["L",c,t-6],["L",c+6,t],["L",r-a,t]);return h},circle:function(e,t,i,r){return n(e+i/2,t+r/2,i/2,r/2,{start:.5*Math.PI,end:2.5*Math.PI,open:!1})},diamond:function(e,t,i,r){return[["M",e+i/2,t],["L",e+i,t+r/2],["L",e+i/2,t+r],["L",e,t+r/2],["Z"]]},rect:o,roundedRect:s,square:o,triangle:function(e,t,i,r){return[["M",e+i/2,t],["L",e+i,t+r],["L",e,t+r],["Z"]]},"triangle-down":function(e,t,i,r){return[["M",e,t],["L",e+i,t],["L",e+i/2,t+r],["Z"]]}}})),i(t,"Core/Renderer/SVG/TextBuilder.js",[t["Core/Renderer/HTML/AST.js"],t["Core/Globals.js"],t["Core/Utilities.js"]],(function(e,t,i){let{doc:r,SVG_NS:n,win:o}=t,{attr:s,extend:a,fireEvent:l,isString:c,objectEach:u,pick:h}=i;return class{constructor(e){let t=e.styles;this.renderer=e.renderer,this.svgElement=e,this.width=e.textWidth,this.textLineHeight=t&&t.lineHeight,this.textOutline=t&&t.textOutline,this.ellipsis=!(!t||"ellipsis"!==t.textOverflow),this.noWrap=!(!t||"nowrap"!==t.whiteSpace)}buildSVG(){let t=this.svgElement,i=t.element,n=t.renderer,o=h(t.textStr,"").toString(),s=-1!==o.indexOf("<"),a=i.childNodes,l=!t.added&&n.box,u=[o,this.ellipsis,this.noWrap,this.textLineHeight,this.textOutline,t.getStyle("font-size"),this.width].join(",");if(u!==t.textCache){t.textCache=u,delete t.actualWidth;for(let e=a.length;e--;)i.removeChild(a[e]);if(s||this.ellipsis||this.width||t.textPath||-1!==o.indexOf(" ")&&(!this.noWrap||/<br.*?>/g.test(o))){if(""!==o){l&&l.appendChild(i);let r=new e(o);this.modifyTree(r.nodes),r.addToDOM(i),this.modifyDOM(),this.ellipsis&&-1!==(i.textContent||"").indexOf("\u2026")&&t.attr("title",this.unescapeEntities(t.textStr||"",["&lt;","&gt;"])),l&&l.removeChild(i)}}else i.appendChild(r.createTextNode(this.unescapeEntities(o)));c(this.textOutline)&&t.applyTextOutline&&t.applyTextOutline(this.textOutline)}}modifyDOM(){let e,t=this.svgElement,i=s(t.element,"x");for(t.firstLineMetrics=void 0;(e=t.element.firstChild)&&/^[\s\u200B]*$/.test(e.textContent||" ");)t.element.removeChild(e);[].forEach.call(t.element.querySelectorAll("tspan.highcharts-br"),((e,r)=>{e.nextSibling&&e.previousSibling&&(0===r&&1===e.previousSibling.nodeType&&(t.firstLineMetrics=t.renderer.fontMetrics(e.previousSibling)),s(e,{dy:this.getLineHeight(e.nextSibling),x:i}))}));let a=this.width||0;if(!a)return;let l=(e,o)=>{let l=e.textContent||"",c=l.replace(/([^\^])-/g,"$1- ").split(" "),u=!this.noWrap&&(c.length>1||t.element.childNodes.length>1),h=this.getLineHeight(o),d=0,p=t.actualWidth;if(this.ellipsis)l&&this.truncate(e,l,void 0,0,Math.max(0,a-.8*h),((e,t)=>e.substring(0,t)+"\u2026"));else if(u){let l=[],u=[];for(;o.firstChild&&o.firstChild!==e;)u.push(o.firstChild),o.removeChild(o.firstChild);for(;c.length;)c.length&&!this.noWrap&&d>0&&(l.push(e.textContent||""),e.textContent=c.join(" ").replace(/- /g,"-")),this.truncate(e,void 0,c,0===d&&p||0,a,((e,t)=>c.slice(0,t).join(" ").replace(/- /g,"-"))),p=t.actualWidth,d++;u.forEach((t=>{o.insertBefore(t,e)})),l.forEach((t=>{o.insertBefore(r.createTextNode(t),e);let a=r.createElementNS(n,"tspan");a.textContent="\u200b",s(a,{dy:h,x:i}),o.insertBefore(a,e)}))}},c=e=>{[].slice.call(e.childNodes).forEach((i=>{i.nodeType===o.Node.TEXT_NODE?l(i,e):(-1!==i.className.baseVal.indexOf("highcharts-br")&&(t.actualWidth=0),c(i))}))};c(t.element)}getLineHeight(e){let t=e.nodeType===o.Node.TEXT_NODE?e.parentElement:e;return this.textLineHeight?parseInt(this.textLineHeight.toString(),10):this.renderer.fontMetrics(t||this.svgElement.element).h}modifyTree(e){let t=(i,r)=>{let{attributes:n={},children:o,style:s={},tagName:l}=i,c=this.renderer.styledMode;if("b"===l||"strong"===l?c?n.class="highcharts-strong":s.fontWeight="bold":("i"===l||"em"===l)&&(c?n.class="highcharts-emphasized":s.fontStyle="italic"),s&&s.color&&(s.fill=s.color),"br"===l){n.class="highcharts-br",i.textContent="\u200b";let t=e[r+1];t&&t.textContent&&(t.textContent=t.textContent.replace(/^ +/gm,""))}else"a"===l&&o&&o.some((e=>"#text"===e.tagName))&&(i.children=[{children:o,tagName:"tspan"}]);"#text"!==l&&"a"!==l&&(i.tagName="tspan"),a(i,{attributes:n,style:s}),o&&o.filter((e=>"#text"!==e.tagName)).forEach(t)};e.forEach(t),l(this.svgElement,"afterModifyTree",{nodes:e})}truncate(e,t,i,r,n,o){let s,a,l=this.svgElement,{rotation:c}=l,u=[],h=i?1:0,d=(t||i||"").length,p=d,f=function(t,n){let o=n||t,s=e.parentNode;if(s&&void 0===u[o]&&s.getSubStringLength)try{u[o]=r+s.getSubStringLength(0,i?o+1:o)}catch(e){}return u[o]};if(l.rotation=0,r+(a=f(e.textContent.length))>n){for(;h<=d;)p=Math.ceil((h+d)/2),i&&(s=o(i,p)),a=f(p,s&&s.length-1),h===d?h=d+1:a>n?d=p-1:h=p;0===d?e.textContent="":t&&d===t.length-1||(e.textContent=s||o(t||i,p))}i&&i.splice(0,p),l.actualWidth=a,l.rotation=c}unescapeEntities(e,t){return u(this.renderer.escapes,(function(i,r){t&&-1!==t.indexOf(i)||(e=e.toString().replace(RegExp(i,"g"),r))})),e}}})),i(t,"Core/Renderer/SVG/SVGRenderer.js",[t["Core/Renderer/HTML/AST.js"],t["Core/Defaults.js"],t["Core/Color/Color.js"],t["Core/Globals.js"],t["Core/Renderer/RendererRegistry.js"],t["Core/Renderer/SVG/SVGElement.js"],t["Core/Renderer/SVG/SVGLabel.js"],t["Core/Renderer/SVG/Symbols.js"],t["Core/Renderer/SVG/TextBuilder.js"],t["Core/Utilities.js"]],(function(e,t,i,r,n,o,s,a,l,c){let u,{defaultOptions:h}=t,{charts:d,deg2rad:p,doc:f,isFirefox:m,isMS:g,isWebKit:y,noop:_,SVG_NS:v,symbolSizes:x,win:b}=r,{addEvent:w,attr:S,createElement:T,crisp:M,css:A,defined:C,destroyObjectProperties:E,extend:P,isArray:k,isNumber:I,isObject:D,isString:L,merge:R,pick:z,pInt:O,replaceNested:F,uniqueKey:B}=c;class N{constructor(e,t,i,r,n,o,s){let a,l,c=this.createElement("svg").attr({version:"1.1",class:"highcharts-root"}),u=c.element;s||c.css(this.getStyle(r||{})),e.appendChild(u),S(e,"dir","ltr"),-1===e.innerHTML.indexOf("xmlns")&&S(u,"xmlns",this.SVG_NS),this.box=u,this.boxWrapper=c,this.alignedObjects=[],this.url=this.getReferenceURL(),this.createElement("desc").add().element.appendChild(f.createTextNode("Created with Highcharts 11.4.8")),this.defs=this.createElement("defs").add(),this.allowHTML=o,this.forExport=n,this.styledMode=s,this.gradients={},this.cache={},this.cacheKeys=[],this.imgCount=0,this.rootFontSize=c.getStyle("font-size"),this.setSize(t,i,!1),m&&e.getBoundingClientRect&&((a=function(){A(e,{left:0,top:0}),l=e.getBoundingClientRect(),A(e,{left:Math.ceil(l.left)-l.left+"px",top:Math.ceil(l.top)-l.top+"px"})})(),this.unSubPixelFix=w(b,"resize",a))}definition(t){return new e([t]).addToDOM(this.defs.element)}getReferenceURL(){if((m||y)&&f.getElementsByTagName("base").length){if(!C(u)){let t=B(),i=new e([{tagName:"svg",attributes:{width:8,height:8},children:[{tagName:"defs",children:[{tagName:"clipPath",attributes:{id:t},children:[{tagName:"rect",attributes:{width:4,height:4}}]}]},{tagName:"rect",attributes:{id:"hitme",width:8,height:8,"clip-path":`url(#${t})`,fill:"rgba(0,0,0,0.001)"}}]}]).addToDOM(f.body);A(i,{position:"fixed",top:0,left:0,zIndex:9e5});let r=f.elementFromPoint(6,6);u="hitme"===(r&&r.id),f.body.removeChild(i)}if(u)return F(b.location.href.split("#")[0],[/<[^>]*>/g,""],[/([\('\)])/g,"\\$1"],[/ /g,"%20"])}return""}getStyle(e){return this.style=P({fontFamily:"Helvetica, Arial, sans-serif",fontSize:"1rem"},e),this.style}setStyle(e){this.boxWrapper.css(this.getStyle(e))}isHidden(){return!this.boxWrapper.getBBox().width}destroy(){let e=this.defs;return this.box=null,this.boxWrapper=this.boxWrapper.destroy(),E(this.gradients||{}),this.gradients=null,this.defs=e.destroy(),this.unSubPixelFix&&this.unSubPixelFix(),this.alignedObjects=null,null}createElement(e){return new this.Element(this,e)}getRadialAttr(e,t){return{cx:e[0]-e[2]/2+(t.cx||0)*e[2],cy:e[1]-e[2]/2+(t.cy||0)*e[2],r:(t.r||0)*e[2]}}shadowDefinition(e){let t=[`highcharts-drop-shadow-${this.chartIndex}`,...Object.keys(e).map((t=>`${t}-${e[t]}`))].join("-").toLowerCase().replace(/[^a-z\d\-]/g,""),i=R({color:"#000000",offsetX:1,offsetY:1,opacity:.15,width:5},e);return this.defs.element.querySelector(`#${t}`)||this.definition({tagName:"filter",attributes:{id:t,filterUnits:i.filterUnits},children:this.getShadowFilterContent(i)}),t}getShadowFilterContent(e){return[{tagName:"feDropShadow",attributes:{dx:e.offsetX,dy:e.offsetY,"flood-color":e.color,"flood-opacity":Math.min(5*e.opacity,1),stdDeviation:e.width/2}}]}buildText(e){new l(e).buildSVG()}getContrast(e){let t=i.parse(e).rgba.map((e=>{let t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)})),r=.2126*t[0]+.7152*t[1]+.0722*t[2];return 1.05/(r+.05)>(r+.05)/.05?"#FFFFFF":"#000000"}button(t,i,r,n){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},s=arguments.length>8?arguments[8]:void 0,a=arguments.length>9?arguments[9]:void 0,l=this.label(t,i,r,s,void 0,void 0,a,void 0,"button"),c=this.styledMode,u=arguments,d=0;o=R(h.global.buttonTheme,o),c&&(delete o.fill,delete o.stroke,delete o["stroke-width"]);let p=o.states||{},f=o.style||{};delete o.states,delete o.style;let m=[e.filterUserAttributes(o)],y=[f];return c||["hover","select","disabled"].forEach(((t,i)=>{m.push(R(m[0],e.filterUserAttributes(u[i+5]||p[t]||{}))),y.push(m[i+1].style),delete m[i+1].style})),w(l.element,g?"mouseover":"mouseenter",(function(){3!==d&&l.setState(1)})),w(l.element,g?"mouseout":"mouseleave",(function(){3!==d&&l.setState(d)})),l.setState=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(1!==e&&(l.state=d=e),l.removeClass(/highcharts-button-(normal|hover|pressed|disabled)/).addClass("highcharts-button-"+["normal","hover","pressed","disabled"][e]),!c){l.attr(m[e]);let t=y[e];D(t)&&l.css(t)}},l.attr(m[0]),!c&&(l.css(P({cursor:"default"},f)),a&&l.text.css({pointerEvents:"none"})),l.on("touchstart",(e=>e.stopPropagation())).on("click",(function(e){3!==d&&n.call(l,e)}))}crispLine(e,t){let[i,r]=e;return C(i[1])&&i[1]===r[1]&&(i[1]=r[1]=M(i[1],t)),C(i[2])&&i[2]===r[2]&&(i[2]=r[2]=M(i[2],t)),e}path(e){let t=this.styledMode?{}:{fill:"none"};return k(e)?t.d=e:D(e)&&P(t,e),this.createElement("path").attr(t)}circle(e,t,i){let r=D(e)?e:void 0===e?{}:{x:e,y:t,r:i},n=this.createElement("circle");return n.xSetter=n.ySetter=function(e,t,i){i.setAttribute("c"+t,e)},n.attr(r)}arc(e,t,i,r,n,o){let s;D(e)?(t=(s=e).y,i=s.r,r=s.innerR,n=s.start,o=s.end,e=s.x):s={innerR:r,start:n,end:o};let a=this.symbol("arc",e,t,i,i,s);return a.r=i,a}rect(e,t,i,r,n,o){let s=D(e)?e:void 0===e?{}:{x:e,y:t,r:n,width:Math.max(i||0,0),height:Math.max(r||0,0)},a=this.createElement("rect");return this.styledMode||(void 0!==o&&(s["stroke-width"]=o,P(s,a.crisp(s))),s.fill="none"),a.rSetter=function(e,t,i){a.r=e,S(i,{rx:e,ry:e})},a.rGetter=function(){return a.r||0},a.attr(s)}roundedRect(e){return this.symbol("roundedRect").attr(e)}setSize(e,t,i){this.width=e,this.height=t,this.boxWrapper.animate({width:e,height:t},{step:function(){this.attr({viewBox:"0 0 "+this.attr("width")+" "+this.attr("height")})},duration:z(i,!0)?void 0:0}),this.alignElements()}g(e){let t=this.createElement("g");return e?t.attr({class:"highcharts-"+e}):t}image(e,t,i,r,n,o){let s={preserveAspectRatio:"none"};I(t)&&(s.x=t),I(i)&&(s.y=i),I(r)&&(s.width=r),I(n)&&(s.height=n);let a=this.createElement("image").attr(s),l=function(t){a.attr({href:e}),o.call(a,t)};if(o){a.attr({href:"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="});let t=new b.Image;w(t,"load",l),t.src=e,t.complete&&l({})}else a.attr({href:e});return a}symbol(e,t,i,r,n,o){let s,a,l,c,u=this,h=/^url\((.*?)\)$/,p=h.test(e),m=!p&&(this.symbols[e]?e:"circle"),g=m&&this.symbols[m];if(g)"number"==typeof t&&(a=g.call(this.symbols,t||0,i||0,r||0,n||0,o)),s=this.path(a),u.styledMode||s.attr("fill","none"),P(s,{symbolName:m||void 0,x:t,y:i,width:r,height:n}),o&&P(s,o);else if(p){l=e.match(h)[1];let r=s=this.image(l);r.imgwidth=z(o&&o.width,x[l]&&x[l].width),r.imgheight=z(o&&o.height,x[l]&&x[l].height),c=e=>e.attr({width:e.width,height:e.height}),["width","height"].forEach((e=>{r[`${e}Setter`]=function(e,t){this[t]=e;let{alignByTranslate:i,element:r,width:n,height:s,imgwidth:a,imgheight:l}=this,c="width"===t?a:l,u=1;o&&"within"===o.backgroundSize&&n&&s&&a&&l?(u=Math.min(n/a,s/l),S(r,{width:Math.round(a*u),height:Math.round(l*u)})):r&&c&&r.setAttribute(t,c),!i&&a&&l&&this.translate(((n||0)-a*u)/2,((s||0)-l*u)/2)}})),C(t)&&r.attr({x:t,y:i}),r.isImg=!0,r.symbolUrl=e,C(r.imgwidth)&&C(r.imgheight)?c(r):(r.attr({width:0,height:0}),T("img",{onload:function(){let e=d[u.chartIndex];0===this.width&&(A(this,{position:"absolute",top:"-999em"}),f.body.appendChild(this)),x[l]={width:this.width,height:this.height},r.imgwidth=this.width,r.imgheight=this.height,r.element&&c(r),this.parentNode&&this.parentNode.removeChild(this),u.imgCount--,u.imgCount||!e||e.hasLoaded||e.onload()},src:l}),this.imgCount++)}return s}clipRect(e,t,i,r){return this.rect(e,t,i,r,0)}text(e,t,i,r){let n={};if(r&&(this.allowHTML||!this.forExport))return this.html(e,t,i);n.x=Math.round(t||0),i&&(n.y=Math.round(i)),C(e)&&(n.text=e);let o=this.createElement("text").attr(n);return r&&(!this.forExport||this.allowHTML)||(o.xSetter=function(e,t,i){let r=i.getElementsByTagName("tspan"),n=i.getAttribute(t);for(let o,s=0;s<r.length;s++)(o=r[s]).getAttribute(t)===n&&o.setAttribute(t,e);i.setAttribute(t,e)}),o}fontMetrics(e){let t=O(o.prototype.getStyle.call(e,"font-size")||0),i=t<24?t+3:Math.round(1.2*t);return{h:i,b:Math.round(.8*i),f:t}}rotCorr(e,t,i){let r=e;return t&&i&&(r=Math.max(r*Math.cos(t*p),4)),{x:-e/3*Math.sin(t*p),y:r}}pathToSegments(e){let t=[],i=[],r={A:8,C:7,H:2,L:3,M:3,Q:5,S:5,T:3,V:2};for(let n=0;n<e.length;n++)L(i[0])&&I(e[n])&&i.length===r[i[0].toUpperCase()]&&e.splice(n,0,i[0].replace("M","L").replace("m","l")),"string"==typeof e[n]&&(i.length&&t.push(i.slice(0)),i.length=0),i.push(e[n]);return t.push(i.slice(0)),t}label(e,t,i,r,n,o,a,l,c){return new s(this,e,t,i,r,n,o,a,l,c)}alignElements(){this.alignedObjects.forEach((e=>e.align()))}}return P(N.prototype,{Element:o,SVG_NS:v,escapes:{"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},symbols:a,draw:_}),n.registerRendererType("svg",N,!0),N})),i(t,"Core/Renderer/HTML/HTMLElement.js",[t["Core/Renderer/HTML/AST.js"],t["Core/Globals.js"],t["Core/Renderer/SVG/SVGElement.js"],t["Core/Utilities.js"]],(function(e,t,i,r){let{composed:n}=t,{attr:o,css:s,createElement:a,defined:l,extend:c,pInt:u,pushUnique:h}=r;function d(e,t,r){let n=this.div?.style||r.style;i.prototype[`${t}Setter`].call(this,e,t,r),n&&(n[t]=e)}let p=(e,t)=>{if(!e.div){let r=o(e.element,"class"),n=e.css,s=a("div",r?{className:r}:void 0,{position:"absolute",left:`${e.translateX||0}px`,top:`${e.translateY||0}px`,...e.styles,display:e.display,opacity:e.opacity,visibility:e.visibility},e.parentGroup?.div||t);e.classSetter=(e,t,i)=>{i.setAttribute("class",e),s.className=e},e.translateXSetter=e.translateYSetter=(t,i)=>{e[i]=t,s.style["translateX"===i?"left":"top"]=`${t}px`,e.doTransform=!0},e.opacitySetter=e.visibilitySetter=d,e.css=t=>(n.call(e,t),t.cursor&&(s.style.cursor=t.cursor),t.pointerEvents&&(s.style.pointerEvents=t.pointerEvents),e),e.on=function(){return i.prototype.on.apply({element:s,onEvents:e.onEvents},arguments),e},e.div=s}return e.div};class f extends i{static compose(e){h(n,this.compose)&&(e.prototype.html=function(e,t,i){return new f(this,"span").attr({text:e,x:Math.round(t),y:Math.round(i)})})}constructor(e,t){super(e,t),this.css({position:"absolute",...e.styledMode?{}:{fontFamily:e.style.fontFamily,fontSize:e.style.fontSize}}),this.element.style.whiteSpace="nowrap"}getSpanCorrection(e,t,i){this.xCorr=-e*i,this.yCorr=-t}css(e){let t,{element:i}=this,r="SPAN"===i.tagName&&e&&"width"in e,n=r&&e.width;return r&&(delete e.width,this.textWidth=u(n)||void 0,t=!0),"ellipsis"===e?.textOverflow&&(e.whiteSpace="nowrap",e.overflow="hidden"),c(this.styles,e),s(i,e),t&&this.updateTransform(),this}htmlGetBBox(){let{element:e}=this;return{x:e.offsetLeft,y:e.offsetTop,width:e.offsetWidth,height:e.offsetHeight}}updateTransform(){if(!this.added)return void(this.alignOnAdd=!0);let{element:e,renderer:t,rotation:i,rotationOriginX:r,rotationOriginY:n,styles:o,textAlign:a="left",textWidth:c,translateX:u=0,translateY:h=0,x:d=0,y:p=0}=this,f={left:0,center:.5,right:1}[a],m=o.whiteSpace;if(s(e,{marginLeft:`${u}px`,marginTop:`${h}px`}),"SPAN"===e.tagName){let o,u=[i,a,e.innerHTML,c,this.textAlign].join(","),h=-1*this.parentGroup?.padding||0,g=!1;if(c!==this.oldTextWidth){let t=this.textPxLength?this.textPxLength:(s(e,{width:"",whiteSpace:m||"nowrap"}),e.offsetWidth),r=c||0;(r>this.oldTextWidth||t>r)&&(/[ \-]/.test(e.textContent||e.innerText)||"ellipsis"===e.style.textOverflow)&&(s(e,{width:t>r||i?c+"px":"auto",display:"block",whiteSpace:m||"normal"}),this.oldTextWidth=c,g=!0)}this.hasBoxWidthChanged=g,u!==this.cTT&&(o=t.fontMetrics(e).b,l(i)&&(i!==(this.oldRotation||0)||a!==this.oldAlign)&&this.setSpanRotation(i,h,h),this.getSpanCorrection(!l(i)&&this.textPxLength||e.offsetWidth,o,f));let{xCorr:y=0,yCorr:_=0}=this;s(e,{left:`${d+y}px`,top:`${p+_}px`,transformOrigin:`${(r??d)-y-d-h}px ${(n??p)-_-p-h}px`}),this.cTT=u,this.oldRotation=i,this.oldAlign=a}}setSpanRotation(e,t,i){s(this.element,{transform:`rotate(${e}deg)`,transformOrigin:`${t}% ${i}px`})}add(e){let t,i=this.renderer.box.parentNode,r=[];if(this.parentGroup=e,e&&!(t=e.div)){let n=e;for(;n;)r.push(n),n=n.parentGroup;for(let e of r.reverse())t=p(e,i)}return(t||i).appendChild(this.element),this.added=!0,this.alignOnAdd&&this.updateTransform(),this}textSetter(t){t!==this.textStr&&(delete this.bBox,delete this.oldTextWidth,e.setElementHTML(this.element,t??""),this.textStr=t,this.doTransform=!0)}alignSetter(e){this.alignValue=this.textAlign=e,this.doTransform=!0}xSetter(e,t){this[t]=e,this.doTransform=!0}}let m=f.prototype;return m.visibilitySetter=m.opacitySetter=d,m.ySetter=m.rotationSetter=m.rotationOriginXSetter=m.rotationOriginYSetter=m.xSetter,f})),i(t,"Core/Axis/AxisDefaults.js",[],(function(){var e,t;return(t=e||(e={})).xAxis={alignTicks:!0,allowDecimals:void 0,panningEnabled:!0,zIndex:2,zoomEnabled:!0,dateTimeLabelFormats:{millisecond:{main:"%H:%M:%S.%L",range:!1},second:{main:"%H:%M:%S",range:!1},minute:{main:"%H:%M",range:!1},hour:{main:"%H:%M",range:!1},day:{main:"%e %b"},week:{main:"%e %b"},month:{main:"%b '%y"},year:{main:"%Y"}},endOnTick:!1,gridLineDashStyle:"Solid",gridZIndex:1,labels:{autoRotationLimit:80,distance:15,enabled:!0,indentation:10,overflow:"justify",reserveSpace:void 0,rotation:void 0,staggerLines:0,step:0,useHTML:!1,zIndex:7,style:{color:"#333333",cursor:"default",fontSize:"0.8em"}},maxPadding:.01,minorGridLineDashStyle:"Solid",minorTickLength:2,minorTickPosition:"outside",minorTicksPerMajor:5,minPadding:.01,offset:void 0,reversed:void 0,reversedStacks:!1,showEmpty:!0,showFirstLabel:!0,showLastLabel:!0,startOfWeek:1,startOnTick:!1,tickLength:10,tickPixelInterval:100,tickmarkPlacement:"between",tickPosition:"outside",title:{align:"middle",useHTML:!1,x:0,y:0,style:{color:"#666666",fontSize:"0.8em"}},visible:!0,minorGridLineColor:"#f2f2f2",minorGridLineWidth:1,minorTickColor:"#999999",lineColor:"#333333",lineWidth:1,gridLineColor:"#e6e6e6",gridLineWidth:void 0,tickColor:"#333333"},t.yAxis={reversedStacks:!0,endOnTick:!0,maxPadding:.05,minPadding:.05,tickPixelInterval:72,showLastLabel:!0,labels:{x:void 0},startOnTick:!0,title:{text:"Values"},stackLabels:{animation:{},allowOverlap:!1,enabled:!1,crop:!0,overflow:"justify",formatter:function(){let{numberFormatter:e}=this.axis.chart;return e(this.total||0,-1)},style:{color:"#000000",fontSize:"0.7em",fontWeight:"bold",textOutline:"1px contrast"}},gridLineWidth:1,lineWidth:0},e})),i(t,"Core/Foundation.js",[t["Core/Utilities.js"]],(function(e){var t;let{addEvent:i,isFunction:r,objectEach:n,removeEvent:o}=e;return(t||(t={})).registerEventOptions=function(e,t){e.eventOptions=e.eventOptions||{},n(t.events,(function(t,n){e.eventOptions[n]!==t&&(e.eventOptions[n]&&(o(e,n,e.eventOptions[n]),delete e.eventOptions[n]),r(t)&&(e.eventOptions[n]=t,i(e,n,t,{order:0})))}))},t})),i(t,"Core/Axis/Tick.js",[t["Core/Templating.js"],t["Core/Globals.js"],t["Core/Utilities.js"]],(function(e,t,i){let{deg2rad:r}=t,{clamp:n,correctFloat:o,defined:s,destroyObjectProperties:a,extend:l,fireEvent:c,isNumber:u,merge:h,objectEach:d,pick:p}=i;return class{constructor(e,t,i,r,n){this.isNew=!0,this.isNewLabel=!0,this.axis=e,this.pos=t,this.type=i||"",this.parameters=n||{},this.tickmarkOffset=this.parameters.tickmarkOffset,this.options=this.parameters.options,c(this,"init"),i||r||this.addLabel()}addLabel(){let t,i,r,n=this,a=n.axis,h=a.options,d=a.chart,f=a.categories,m=a.logarithmic,g=a.names,y=n.pos,_=p(n.options&&n.options.labels,h.labels),v=a.tickPositions,x=y===v[0],b=y===v[v.length-1],w=(!_.step||1===_.step)&&1===a.tickInterval,S=v.info,T=n.label,M=this.parameters.category||(f?p(f[y],g[y],y):y);m&&u(M)&&(M=o(m.lin2log(M))),a.dateTime&&(S?t=(i=d.time.resolveDTLFormat(h.dateTimeLabelFormats[!h.grid&&S.higherRanks[y]||S.unitName])).main:u(M)&&(t=a.dateTime.getXDateFormat(M,h.dateTimeLabelFormats||{}))),n.isFirst=x,n.isLast=b;let A={axis:a,chart:d,dateTimeLabelFormat:t,isFirst:x,isLast:b,pos:y,tick:n,tickPositionInfo:S,value:M};c(this,"labelFormat",A);let C=t=>_.formatter?_.formatter.call(t,t):_.format?(t.text=a.defaultLabelFormatter.call(t),e.format(_.format,t,d)):a.defaultLabelFormatter.call(t),E=C.call(A,A),P=i&&i.list;n.shortenLabel=P?function(){for(r=0;r<P.length;r++)if(l(A,{dateTimeLabelFormat:P[r]}),T.attr({text:C.call(A,A)}),T.getBBox().width<a.getSlotWidth(n)-2*(_.padding||0))return;T.attr({text:""})}:void 0,w&&a._addedPlotLB&&n.moveLabel(E,_),s(T)||n.movedLabel?T&&T.textStr!==E&&!w&&(!T.textWidth||_.style.width||T.styles.width||T.css({width:null}),T.attr({text:E}),T.textPxLength=T.getBBox().width):(n.label=T=n.createLabel(E,_),n.rotation=0)}createLabel(e,t,i){let r=this.axis,n=r.chart,o=s(e)&&t.enabled?n.renderer.text(e,i?.x,i?.y,t.useHTML).add(r.labelGroup):void 0;return o&&(n.styledMode||o.css(h(t.style)),o.textPxLength=o.getBBox().width),o}destroy(){a(this,this.axis)}getPosition(e,t,i,r){let s=this.axis,a=s.chart,l=r&&a.oldChartHeight||a.chartHeight,u={x:e?o(s.translate(t+i,void 0,void 0,r)+s.transB):s.left+s.offset+(s.opposite?(r&&a.oldChartWidth||a.chartWidth)-s.right-s.left:0),y:e?l-s.bottom+s.offset-(s.opposite?s.height:0):o(l-s.translate(t+i,void 0,void 0,r)-s.transB)};return u.y=n(u.y,-1e9,1e9),c(this,"afterGetPosition",{pos:u}),u}getLabelPosition(e,t,i,n,o,a,l,u){let h,d,f=this.axis,m=f.transA,g=f.isLinked&&f.linkedParent?f.linkedParent.reversed:f.reversed,y=f.staggerLines,_=f.tickRotCorr||{x:0,y:0},v=n||f.reserveSpaceDefault?0:-f.labelOffset*("center"===f.labelAlign?.5:1),x=o.distance,b={};return h=0===f.side?i.rotation?-x:-i.getBBox().height:2===f.side?_.y+x:Math.cos(i.rotation*r)*(_.y-i.getBBox(!1,0).height/2),s(o.y)&&(h=0===f.side&&f.horiz?o.y+h:o.y),e=e+p(o.x,[0,1,0,-1][f.side]*x)+v+_.x-(a&&n?a*m*(g?-1:1):0),t=t+h-(a&&!n?a*m*(g?1:-1):0),y&&(d=l/(u||1)%y,f.opposite&&(d=y-d-1),t+=d*(f.labelOffset/y)),b.x=e,b.y=Math.round(t),c(this,"afterGetLabelPosition",{pos:b,tickmarkOffset:a,index:l}),b}getLabelSize(){return this.label?this.label.getBBox()[this.axis.horiz?"height":"width"]:0}getMarkPath(e,t,i,r){let n=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return(arguments.length>5?arguments[5]:void 0).crispLine([["M",e,t],["L",e+(n?0:-i),t+(n?i:0)]],r)}handleOverflow(e){let t,i,n,o=this.axis,s=o.options.labels,a=e.x,l=o.chart.chartWidth,c=o.chart.spacing,u=p(o.labelLeft,Math.min(o.pos,c[3])),h=p(o.labelRight,Math.max(o.isRadial?0:o.pos+o.len,l-c[1])),d=this.label,f=this.rotation,m={left:0,center:.5,right:1}[o.labelAlign||d.attr("align")],g=d.getBBox().width,y=o.getSlotWidth(this),_={},v=y,x=1;f||"justify"!==s.overflow?f<0&&a-m*g<u?n=Math.round(a/Math.cos(f*r)-u):f>0&&a+m*g>h&&(n=Math.round((l-a)/Math.cos(f*r))):(t=a-m*g,i=a+(1-m)*g,t<u?v=e.x+v*(1-m)-u:i>h&&(v=h-e.x+v*m,x=-1),(v=Math.min(y,v))<y&&"center"===o.labelAlign&&(e.x+=x*(y-v-m*(y-Math.min(g,v)))),(g>v||o.autoRotation&&(d.styles||{}).width)&&(n=v)),n&&(this.shortenLabel?this.shortenLabel():(_.width=Math.floor(n)+"px",(s.style||{}).textOverflow||(_.textOverflow="ellipsis"),d.css(_)))}moveLabel(e,t){let i,r=this,n=r.label,o=r.axis,s=!1;n&&n.textStr===e?(r.movedLabel=n,s=!0,delete r.label):d(o.ticks,(function(t){s||t.isNew||t===r||!t.label||t.label.textStr!==e||(r.movedLabel=t.label,s=!0,t.labelPos=r.movedLabel.xy,delete t.label)})),!s&&(r.labelPos||n)&&(i=r.labelPos||n.xy,r.movedLabel=r.createLabel(e,t,i),r.movedLabel&&r.movedLabel.attr({opacity:0}))}render(e,t,i){let r=this.axis,n=r.horiz,s=this.pos,a=p(this.tickmarkOffset,r.tickmarkOffset),l=this.getPosition(n,s,a,t),u=l.x,h=l.y,d=r.pos,f=d+r.len,m=n?u:h;!r.chart.polar&&this.isNew&&(o(m)<d||m>f)&&(i=0);let g=p(i,this.label&&this.label.newOpacity,1);i=p(i,1),this.isActive=!0,this.renderGridLine(t,i),this.renderMark(l,i),this.renderLabel(l,t,g,e),this.isNew=!1,c(this,"afterRender")}renderGridLine(e,t){let i,r=this.axis,n=r.options,o={},s=this.pos,a=this.type,l=p(this.tickmarkOffset,r.tickmarkOffset),c=r.chart.renderer,u=this.gridLine,h=n.gridLineWidth,d=n.gridLineColor,f=n.gridLineDashStyle;"minor"===this.type&&(h=n.minorGridLineWidth,d=n.minorGridLineColor,f=n.minorGridLineDashStyle),u||(r.chart.styledMode||(o.stroke=d,o["stroke-width"]=h||0,o.dashstyle=f),a||(o.zIndex=1),e&&(t=0),this.gridLine=u=c.path().attr(o).addClass("highcharts-"+(a?a+"-":"")+"grid-line").add(r.gridGroup)),u&&(i=r.getPlotLinePath({value:s+l,lineWidth:u.strokeWidth(),force:"pass",old:e,acrossPanes:!1}))&&u[e||this.isNew?"attr":"animate"]({d:i,opacity:t})}renderMark(e,t){let i=this.axis,r=i.options,n=i.chart.renderer,o=this.type,s=i.tickSize(o?o+"Tick":"tick"),a=e.x,l=e.y,c=p(r["minor"!==o?"tickWidth":"minorTickWidth"],!o&&i.isXAxis?1:0),u=r["minor"!==o?"tickColor":"minorTickColor"],h=this.mark,d=!h;s&&(i.opposite&&(s[0]=-s[0]),h||(this.mark=h=n.path().addClass("highcharts-"+(o?o+"-":"")+"tick").add(i.axisGroup),i.chart.styledMode||h.attr({stroke:u,"stroke-width":c})),h[d?"attr":"animate"]({d:this.getMarkPath(a,l,s[0],h.strokeWidth(),i.horiz,n),opacity:t}))}renderLabel(e,t,i,r){let n=this.axis,o=n.horiz,s=n.options,a=this.label,l=s.labels,c=l.step,h=p(this.tickmarkOffset,n.tickmarkOffset),d=e.x,f=e.y,m=!0;a&&u(d)&&(a.xy=e=this.getLabelPosition(d,f,a,o,l,h,r,c),this.isFirst&&!this.isLast&&!s.showFirstLabel||this.isLast&&!this.isFirst&&!s.showLastLabel?m=!1:!o||l.step||l.rotation||t||0===i||this.handleOverflow(e),c&&r%c&&(m=!1),m&&u(e.y)?(e.opacity=i,a[this.isNewLabel?"attr":"animate"](e).show(!0),this.isNewLabel=!1):(a.hide(),this.isNewLabel=!0))}replaceMovedLabel(){let e=this.label,t=this.axis;e&&!this.isNew&&(e.animate({opacity:0},void 0,e.destroy),delete this.label),t.isDirty=!0,this.label=this.movedLabel,delete this.movedLabel}}})),i(t,"Core/Axis/Axis.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Axis/AxisDefaults.js"],t["Core/Color/Color.js"],t["Core/Defaults.js"],t["Core/Foundation.js"],t["Core/Globals.js"],t["Core/Axis/Tick.js"],t["Core/Utilities.js"]],(function(e,t,i,r,n,o,s,a){let{animObject:l}=e,{xAxis:c,yAxis:u}=t,{defaultOptions:h}=r,{registerEventOptions:d}=n,{deg2rad:p}=o,{arrayMax:f,arrayMin:m,clamp:g,correctFloat:y,defined:_,destroyObjectProperties:v,erase:x,error:b,extend:w,fireEvent:S,getClosestDistance:T,insertItem:M,isArray:A,isNumber:C,isString:E,merge:P,normalizeTickInterval:k,objectEach:I,pick:D,relativeLength:L,removeEvent:R,splat:z,syncTimeout:O}=a,F=(e,t)=>k(t,void 0,void 0,D(e.options.allowDecimals,t<.5||void 0!==e.tickAmount),!!e.tickAmount);w(h,{xAxis:c,yAxis:P(c,u)});class B{constructor(e,t,i){this.init(e,t,i)}init(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.coll,r="xAxis"===i,n=this.isZAxis||(e.inverted?!r:r);this.chart=e,this.horiz=n,this.isXAxis=r,this.coll=i,S(this,"init",{userOptions:t}),this.opposite=D(t.opposite,this.opposite),this.side=D(t.side,this.side,n?this.opposite?0:2:this.opposite?1:3),this.setOptions(t);let o=this.options,s=o.labels;this.type??(this.type=o.type||"linear"),this.uniqueNames??(this.uniqueNames=o.uniqueNames??!0),S(this,"afterSetType"),this.userOptions=t,this.minPixelPadding=0,this.reversed=D(o.reversed,this.reversed),this.visible=o.visible,this.zoomEnabled=o.zoomEnabled,this.hasNames="category"===this.type||!0===o.categories,this.categories=A(o.categories)&&o.categories||(this.hasNames?[]:void 0),this.names||(this.names=[],this.names.keys={}),this.plotLinesAndBandsGroups={},this.positiveValuesOnly=!!this.logarithmic,this.isLinked=_(o.linkedTo),this.ticks={},this.labelEdge=[],this.minorTicks={},this.plotLinesAndBands=[],this.alternateBands={},this.len??(this.len=0),this.minRange=this.userMinRange=o.minRange||o.maxZoom,this.range=o.range,this.offset=o.offset||0,this.max=void 0,this.min=void 0;let a=D(o.crosshair,z(e.options.tooltip.crosshairs)[r?0:1]);this.crosshair=!0===a?{}:a,-1===e.axes.indexOf(this)&&(r?e.axes.splice(e.xAxis.length,0,this):e.axes.push(this),M(this,e[this.coll])),e.orderItems(this.coll),this.series=this.series||[],e.inverted&&!this.isZAxis&&r&&!_(this.reversed)&&(this.reversed=!0),this.labelRotation=C(s.rotation)?s.rotation:void 0,d(this,o),S(this,"afterInit")}setOptions(e){let t=this.horiz?{labels:{autoRotation:[-45],padding:4},margin:15}:{labels:{padding:1},title:{rotation:90*this.side}};this.options=P(t,h[this.coll],e),S(this,"afterSetOptions",{userOptions:e})}defaultLabelFormatter(){let e,t,i=this.axis,{numberFormatter:r}=this.chart,n=C(this.value)?this.value:NaN,o=i.chart.time,s=i.categories,a=this.dateTimeLabelFormat,l=h.lang,c=l.numericSymbols,u=l.numericSymbolMagnitude||1e3,d=i.logarithmic?Math.abs(n):i.tickInterval,p=c&&c.length;if(s)t=`${this.value}`;else if(a)t=o.dateFormat(a,n);else if(p&&c&&d>=1e3)for(;p--&&void 0===t;)d>=(e=Math.pow(u,p+1))&&10*n%e==0&&null!==c[p]&&0!==n&&(t=r(n/e,-1)+c[p]);return void 0===t&&(t=Math.abs(n)>=1e4?r(n,-1):r(n,-1,void 0,"")),t}getSeriesExtremes(){let e,t=this;S(this,"getSeriesExtremes",null,(function(){t.hasVisibleSeries=!1,t.dataMin=t.dataMax=t.threshold=void 0,t.softThreshold=!t.isXAxis,t.series.forEach((i=>{if(i.reserveSpace()){let r,n,o,s=i.options,a=s.threshold;if(t.hasVisibleSeries=!0,t.positiveValuesOnly&&0>=(a||0)&&(a=void 0),t.isXAxis)(r=i.xData)&&r.length&&(r=t.logarithmic?r.filter((e=>e>0)):r,n=(e=i.getXExtremes(r)).min,o=e.max,C(n)||n instanceof Date||(r=r.filter(C),n=(e=i.getXExtremes(r)).min,o=e.max),r.length&&(t.dataMin=Math.min(D(t.dataMin,n),n),t.dataMax=Math.max(D(t.dataMax,o),o)));else{let e=i.applyExtremes();C(e.dataMin)&&(n=e.dataMin,t.dataMin=Math.min(D(t.dataMin,n),n)),C(e.dataMax)&&(o=e.dataMax,t.dataMax=Math.max(D(t.dataMax,o),o)),_(a)&&(t.threshold=a),(!s.softThreshold||t.positiveValuesOnly)&&(t.softThreshold=!1)}}}))})),S(this,"afterGetSeriesExtremes")}translate(e,t,i,r,n,o){let s=this.linkedParent||this,a=r&&s.old?s.old.min:s.min;if(!C(a))return NaN;let l=s.minPixelPadding,c=(s.isOrdinal||s.brokenAxis?.hasBreaks||s.logarithmic&&n)&&s.lin2val,u=1,h=0,d=r&&s.old?s.old.transA:s.transA,p=0;return d||(d=s.transA),i&&(u*=-1,h=s.len),s.reversed&&(u*=-1,h-=u*(s.sector||s.len)),t?(p=(e=e*u+h-l)/d+a,c&&(p=s.lin2val(p))):(c&&(e=s.val2lin(e)),p=u*(e-a)*d+h+u*l+(C(o)?d*o:0),s.isRadial||(p=y(p))),p}toPixels(e,t){return this.translate(e,!1,!this.horiz,void 0,!0)+(t?0:this.pos)}toValue(e,t){return this.translate(e-(t?0:this.pos),!0,!this.horiz,void 0,!0)}getPlotLinePath(e){let t,i,r,n,o,s=this,a=s.chart,l=s.left,c=s.top,u=e.old,h=e.value,d=e.lineWidth,p=u&&a.oldChartHeight||a.chartHeight,f=u&&a.oldChartWidth||a.chartWidth,m=s.transB,y=e.translatedValue,_=e.force;function v(e,t,i){return"pass"!==_&&(e<t||e>i)&&(_?e=g(e,t,i):o=!0),e}let x={value:h,lineWidth:d,old:u,force:_,acrossPanes:e.acrossPanes,translatedValue:y};return S(this,"getPlotLinePath",x,(function(e){t=r=(y=g(y=D(y,s.translate(h,void 0,void 0,u)),-1e9,1e9))+m,i=n=p-y-m,C(y)?s.horiz?(i=c,n=p-s.bottom+(s.options.isInternal?0:a.scrollablePixelsY||0),t=r=v(t,l,l+s.width)):(t=l,r=f-s.right+(a.scrollablePixelsX||0),i=n=v(i,c,c+s.height)):(o=!0,_=!1),e.path=o&&!_?void 0:a.renderer.crispLine([["M",t,i],["L",r,n]],d||1)})),x.path}getLinearTickPositions(e,t,i){let r,n,o,s=y(Math.floor(t/e)*e),a=y(Math.ceil(i/e)*e),l=[];if(y(s+e)===s&&(o=20),this.single)return[t];for(r=s;r<=a&&(l.push(r),(r=y(r+e,o))!==n);)n=r;return l}getMinorTickInterval(){let{minorTicks:e,minorTickInterval:t}=this.options;return!0===e?D(t,"auto"):!1!==e?t:void 0}getMinorTickPositions(){let e,t=this.options,i=this.tickPositions,r=this.minorTickInterval,n=this.pointRangePadding||0,o=(this.min||0)-n,s=(this.max||0)+n,a=s-o,l=[];if(a&&a/r<this.len/3){let n=this.logarithmic;if(n)this.paddedTicks.forEach((function(e,t,i){t&&l.push.apply(l,n.getLogTickPositions(r,i[t-1],i[t],!0))}));else if(this.dateTime&&"auto"===this.getMinorTickInterval())l=l.concat(this.getTimeTicks(this.dateTime.normalizeTimeTickInterval(r),o,s,t.startOfWeek));else for(e=o+(i[0]-o)%r;e<=s&&e!==l[0];e+=r)l.push(e)}return 0!==l.length&&this.trimTicks(l),l}adjustForMinRange(){let e,t,i,r,n=this.options,o=this.logarithmic,{max:s,min:a,minRange:l}=this;this.isXAxis&&void 0===l&&!o&&(l=_(n.min)||_(n.max)||_(n.floor)||_(n.ceiling)?null:Math.min(5*(T(this.series.map((e=>(e.xIncrement?e.xData?.slice(0,2):e.xData)||[])))||0),this.dataMax-this.dataMin)),C(s)&&C(a)&&C(l)&&s-a<l&&(t=this.dataMax-this.dataMin>=l,e=(l-s+a)/2,i=[a-e,D(n.min,a-e)],t&&(i[2]=o?o.log2lin(this.dataMin):this.dataMin),r=[(a=f(i))+l,D(n.max,a+l)],t&&(r[2]=o?o.log2lin(this.dataMax):this.dataMax),(s=m(r))-a<l&&(i[0]=s-l,i[1]=D(n.min,s-l),a=f(i))),this.minRange=l,this.min=a,this.max=s}getClosest(){let e,t;if(this.categories)t=1;else{let i=[];this.series.forEach((function(e){let r=e.closestPointRange;1===e.xData?.length?i.push(e.xData[0]):!e.noSharedTooltip&&_(r)&&e.reserveSpace()&&(t=_(t)?Math.min(t,r):r)})),i.length&&(i.sort(((e,t)=>e-t)),e=T([i]))}return e&&t?Math.min(e,t):e||t}nameToX(e){let t,i=A(this.options.categories),r=i?this.categories:this.names,n=e.options.x;return e.series.requireSorting=!1,_(n)||(n=this.uniqueNames&&r?i?r.indexOf(e.name):D(r.keys[e.name],-1):e.series.autoIncrement()),-1===n?!i&&r&&(t=r.length):t=n,void 0!==t?(this.names[t]=e.name,this.names.keys[e.name]=t):e.x&&(t=e.x),t}updateNames(){let e=this,t=this.names;t.length>0&&(Object.keys(t.keys).forEach((function(e){delete t.keys[e]})),t.length=0,this.minRange=this.userMinRange,(this.series||[]).forEach((t=>{t.xIncrement=null,(!t.points||t.isDirtyData)&&(e.max=Math.max(e.max,t.xData.length-1),t.processData(),t.generatePoints()),t.data.forEach((function(i,r){let n;i?.options&&void 0!==i.name&&void 0!==(n=e.nameToX(i))&&n!==i.x&&(i.x=n,t.xData[r]=n)}))})))}setAxisTranslation(){let e,t,i=this,r=i.max-i.min,n=i.linkedParent,o=!!i.categories,s=i.isXAxis,a=i.axisPointRange||0,l=0,c=0,u=i.transA;(s||o||a)&&(e=i.getClosest(),n?(l=n.minPointOffset,c=n.pointRangePadding):i.series.forEach((function(t){let r=o?1:s?D(t.options.pointRange,e,0):i.axisPointRange||0,n=t.options.pointPlacement;if(a=Math.max(a,r),!i.single||o){let e=t.is("xrange")?!s:s;l=Math.max(l,e&&E(n)?0:r/2),c=Math.max(c,e&&"on"===n?0:r)}})),t=i.ordinal&&i.ordinal.slope&&e?i.ordinal.slope/e:1,i.minPointOffset=l*=t,i.pointRangePadding=c*=t,i.pointRange=Math.min(a,i.single&&o?1:r),s&&e&&(i.closestPointRange=e)),i.translationSlope=i.transA=u=i.staticScale||i.len/(r+c||1),i.transB=i.horiz?i.left:i.bottom,i.minPixelPadding=u*l,S(this,"afterSetAxisTranslation")}minFromRange(){let{max:e,min:t}=this;return C(e)&&C(t)&&e-t||void 0}setTickInterval(e){let t,i,r,n,o,{categories:s,chart:a,dataMax:l,dataMin:c,dateTime:u,isXAxis:h,logarithmic:d,options:p,softThreshold:f}=this,m=C(this.threshold)?this.threshold:void 0,g=this.minRange||0,{ceiling:v,floor:x,linkedTo:w,softMax:T,softMin:M}=p,A=C(w)&&a[this.coll]?.[w],E=p.tickPixelInterval,P=p.maxPadding,k=p.minPadding,I=0,L=C(p.tickInterval)&&p.tickInterval>=0?p.tickInterval:void 0;if(u||s||A||this.getTickAmount(),n=D(this.userMin,p.min),o=D(this.userMax,p.max),A?(this.linkedParent=A,t=A.getExtremes(),this.min=D(t.min,t.dataMin),this.max=D(t.max,t.dataMax),this.type!==A.type&&b(11,!0,a)):(f&&_(m)&&C(l)&&C(c)&&(c>=m?(i=m,k=0):l<=m&&(r=m,P=0)),this.min=D(n,i,c),this.max=D(o,r,l)),C(this.max)&&C(this.min)&&(d&&(this.positiveValuesOnly&&!e&&0>=Math.min(this.min,D(c,this.min))&&b(10,!0,a),this.min=y(d.log2lin(this.min),16),this.max=y(d.log2lin(this.max),16)),this.range&&C(c)&&(this.userMin=this.min=n=Math.max(c,this.minFromRange()||0),this.userMax=o=this.max,this.range=void 0)),S(this,"foundExtremes"),this.adjustForMinRange(),C(this.min)&&C(this.max)){if(!C(this.userMin)&&C(M)&&M<this.min&&(this.min=n=M),!C(this.userMax)&&C(T)&&T>this.max&&(this.max=o=T),s||this.axisPointRange||this.stacking?.usePercentage||A||!(I=this.max-this.min)||(!_(n)&&k&&(this.min-=I*k),_(o)||!P||(this.max+=I*P)),!C(this.userMin)&&C(x)&&(this.min=Math.max(this.min,x)),!C(this.userMax)&&C(v)&&(this.max=Math.min(this.max,v)),f&&C(c)&&C(l)){let e=m||0;!_(n)&&this.min<e&&c>=e?this.min=p.minRange?Math.min(e,this.max-g):e:!_(o)&&this.max>e&&l<=e&&(this.max=p.minRange?Math.max(e,this.min+g):e)}!a.polar&&this.min>this.max&&(_(p.min)?this.max=this.min:_(p.max)&&(this.min=this.max)),I=this.max-this.min}if(this.min!==this.max&&C(this.min)&&C(this.max)?A&&!L&&E===A.options.tickPixelInterval?this.tickInterval=L=A.tickInterval:this.tickInterval=D(L,this.tickAmount?I/Math.max(this.tickAmount-1,1):void 0,s?1:I*E/Math.max(this.len,E)):this.tickInterval=1,h&&!e){let e=this.min!==this.old?.min||this.max!==this.old?.max;this.series.forEach((function(t){t.forceCrop=t.forceCropping?.(),t.processData(e)})),S(this,"postProcessData",{hasExtremesChanged:e})}this.setAxisTranslation(),S(this,"initialAxisTranslation"),this.pointRange&&!L&&(this.tickInterval=Math.max(this.pointRange,this.tickInterval));let R=D(p.minTickInterval,u&&!this.series.some((e=>e.noSharedTooltip))?this.closestPointRange:0);!L&&this.tickInterval<R&&(this.tickInterval=R),u||d||L||(this.tickInterval=F(this,this.tickInterval)),this.tickAmount||(this.tickInterval=this.unsquish()),this.setTickPositions()}setTickPositions(){let e,t=this.options,i=t.tickPositions,r=t.tickPositioner,n=this.getMinorTickInterval(),o=!this.isPanning,s=o&&t.startOnTick,a=o&&t.endOnTick,l=[];if(this.tickmarkOffset=this.categories&&"between"===t.tickmarkPlacement&&1===this.tickInterval?.5:0,this.single=this.min===this.max&&_(this.min)&&!this.tickAmount&&(this.min%1==0||!1!==t.allowDecimals),i)l=i.slice();else if(C(this.min)&&C(this.max)){if(!this.ordinal?.positions&&(this.max-this.min)/this.tickInterval>Math.max(2*this.len,200))l=[this.min,this.max],b(19,!1,this.chart);else if(this.dateTime)l=this.getTimeTicks(this.dateTime.normalizeTimeTickInterval(this.tickInterval,t.units),this.min,this.max,t.startOfWeek,this.ordinal?.positions,this.closestPointRange,!0);else if(this.logarithmic)l=this.logarithmic.getLogTickPositions(this.tickInterval,this.min,this.max);else{let e=this.tickInterval,t=e;for(;t<=2*e&&(l=this.getLinearTickPositions(this.tickInterval,this.min,this.max),this.tickAmount&&l.length>this.tickAmount);)this.tickInterval=F(this,t*=1.1)}l.length>this.len&&(l=[l[0],l[l.length-1]])[0]===l[1]&&(l.length=1),r&&(this.tickPositions=l,(e=r.apply(this,[this.min,this.max]))&&(l=e))}this.tickPositions=l,this.minorTickInterval="auto"===n&&this.tickInterval?this.tickInterval/t.minorTicksPerMajor:n,this.paddedTicks=l.slice(0),this.trimTicks(l,s,a),!this.isLinked&&C(this.min)&&C(this.max)&&(this.single&&l.length<2&&!this.categories&&!this.series.some((e=>e.is("heatmap")&&"between"===e.options.pointPlacement))&&(this.min-=.5,this.max+=.5),i||e||this.adjustTickAmount()),S(this,"afterSetTickPositions")}trimTicks(e,t,i){let r=e[0],n=e[e.length-1],o=!this.isOrdinal&&this.minPointOffset||0;if(S(this,"trimTicks"),!this.isLinked){if(t&&r!==-1/0)this.min=r;else for(;this.min-o>e[0];)e.shift();if(i)this.max=n;else for(;this.max+o<e[e.length-1];)e.pop();0===e.length&&_(r)&&!this.options.tickPositions&&e.push((n+r)/2)}}alignToOthers(){let e,t=this,i=t.chart,r=[this],n=t.options,o=i.options.chart,s="yAxis"===this.coll&&o.alignThresholds,a=[];if(t.thresholdAlignment=void 0,(!1!==o.alignTicks&&n.alignTicks||s)&&!1!==n.startOnTick&&!1!==n.endOnTick&&!t.logarithmic){let n=e=>{let{horiz:t,options:i}=e;return[t?i.left:i.top,i.width,i.height,i.pane].join(",")},o=n(this);i[this.coll].forEach((function(i){let{series:s}=i;s.length&&s.some((e=>e.visible))&&i!==t&&n(i)===o&&(e=!0,r.push(i))}))}if(e&&s){r.forEach((e=>{let i=e.getThresholdAlignment(t);C(i)&&a.push(i)}));let e=a.length>1?a.reduce(((e,t)=>e+t),0)/a.length:void 0;r.forEach((t=>{t.thresholdAlignment=e}))}return e}getThresholdAlignment(e){if((!C(this.dataMin)||this!==e&&this.series.some((e=>e.isDirty||e.isDirtyData)))&&this.getSeriesExtremes(),C(this.threshold)){let e=g((this.threshold-(this.dataMin||0))/((this.dataMax||0)-(this.dataMin||0)),0,1);return this.options.reversed&&(e=1-e),e}}getTickAmount(){let e=this.options,t=e.tickPixelInterval,i=e.tickAmount;_(e.tickInterval)||i||!(this.len<t)||this.isRadial||this.logarithmic||!e.startOnTick||!e.endOnTick||(i=2),!i&&this.alignToOthers()&&(i=Math.ceil(this.len/t)+1),i<4&&(this.finalTickAmt=i,i=5),this.tickAmount=i}adjustTickAmount(){let e,t,i,r=this,{finalTickAmt:n,max:o,min:s,options:a,tickPositions:l,tickAmount:c,thresholdAlignment:u}=r,h=l?.length,d=D(r.threshold,r.softThreshold?0:null),p=r.tickInterval,f=()=>l.push(y(l[l.length-1]+p)),m=()=>l.unshift(y(l[0]-p));if(C(u)&&(i=u<.5?Math.ceil(u*(c-1)):Math.floor(u*(c-1)),a.reversed&&(i=c-1-i)),r.hasData()&&C(s)&&C(o)){let u=()=>{r.transA*=(h-1)/(c-1),r.min=a.startOnTick?l[0]:Math.min(s,l[0]),r.max=a.endOnTick?l[l.length-1]:Math.max(o,l[l.length-1])};if(C(i)&&C(r.threshold)){for(;l[i]!==d||l.length!==c||l[0]>s||l[l.length-1]<o;){for(l.length=0,l.push(r.threshold);l.length<c;)void 0===l[i]||l[i]>r.threshold?m():f();if(p>8*r.tickInterval)break;p*=2}u()}else if(h<c){for(;l.length<c;)l.length%2||s===d?f():m();u()}if(_(n)){for(t=e=l.length;t--;)(3===n&&t%2==1||n<=2&&t>0&&t<e-1)&&l.splice(t,1);r.finalTickAmt=void 0}}}setScale(){let{coll:e,stacking:t}=this,i=!1,r=!1;this.series.forEach((e=>{i=i||e.isDirtyData||e.isDirty,r=r||e.xAxis&&e.xAxis.isDirty||!1})),this.setAxisSize();let n=this.len!==(this.old&&this.old.len);n||i||r||this.isLinked||this.forceRedraw||this.userMin!==(this.old&&this.old.userMin)||this.userMax!==(this.old&&this.old.userMax)||this.alignToOthers()?(t&&"yAxis"===e&&t.buildStacks(),this.forceRedraw=!1,this.userMinRange||(this.minRange=void 0),this.getSeriesExtremes(),this.setTickInterval(),t&&"xAxis"===e&&t.buildStacks(),this.isDirty||(this.isDirty=n||this.min!==this.old?.min||this.max!==this.old?.max)):t&&t.cleanStacks(),i&&delete this.allExtremes,S(this,"afterSetScale")}setExtremes(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0;this.series.forEach((e=>{delete e.kdTree})),S(this,"setExtremes",n=w(n,{min:e,max:t}),(e=>{this.userMin=e.min,this.userMax=e.max,this.eventArgs=e,i&&this.chart.redraw(r)}))}setAxisSize(){let e=this.chart,t=this.options,i=t.offsets||[0,0,0,0],r=this.horiz,n=this.width=Math.round(L(D(t.width,e.plotWidth-i[3]+i[1]),e.plotWidth)),o=this.height=Math.round(L(D(t.height,e.plotHeight-i[0]+i[2]),e.plotHeight)),s=this.top=Math.round(L(D(t.top,e.plotTop+i[0]),e.plotHeight,e.plotTop)),a=this.left=Math.round(L(D(t.left,e.plotLeft+i[3]),e.plotWidth,e.plotLeft));this.bottom=e.chartHeight-o-s,this.right=e.chartWidth-n-a,this.len=Math.max(r?n:o,0),this.pos=r?a:s}getExtremes(){let e=this.logarithmic;return{min:e?y(e.lin2log(this.min)):this.min,max:e?y(e.lin2log(this.max)):this.max,dataMin:this.dataMin,dataMax:this.dataMax,userMin:this.userMin,userMax:this.userMax}}getThreshold(e){let t=this.logarithmic,i=t?t.lin2log(this.min):this.min,r=t?t.lin2log(this.max):this.max;return null===e||e===-1/0?e=i:e===1/0?e=r:i>e?e=i:r<e&&(e=r),this.translate(e,0,1,0,1)}autoLabelAlign(e){let t=(D(e,0)-90*this.side+720)%360,i={align:"center"};return S(this,"autoLabelAlign",i,(function(e){t>15&&t<165?e.align="right":t>195&&t<345&&(e.align="left")})),i.align}tickSize(e){let t,i=this.options,r=D(i["tick"===e?"tickWidth":"minorTickWidth"],"tick"===e&&this.isXAxis&&!this.categories?1:0),n=i["tick"===e?"tickLength":"minorTickLength"];r&&n&&("inside"===i[e+"Position"]&&(n=-n),t=[n,r]);let o={tickSize:t};return S(this,"afterTickSize",o),o.tickSize}labelMetrics(){let e=this.chart.renderer,t=this.ticks,i=t[Object.keys(t)[0]]||{};return this.chart.renderer.fontMetrics(i.label||i.movedLabel||e.box)}unsquish(){let e,t,i=this.options.labels,r=i.padding||0,n=this.horiz,o=this.tickInterval,s=this.len/(((this.categories?1:0)+this.max-this.min)/o),a=i.rotation,l=y(.8*this.labelMetrics().h),c=Math.max(this.max-this.min,0),u=function(e){let t=(e+2*r)/(s||1);return(t=t>1?Math.ceil(t):1)*o>c&&e!==1/0&&s!==1/0&&c&&(t=Math.ceil(c/o)),y(t*o)},h=o,d=Number.MAX_VALUE;if(n){if(!i.staggerLines&&(C(a)?t=[a]:s<i.autoRotationLimit&&(t=i.autoRotation)),t){let i,r;for(let n of t)(n===a||n&&n>=-90&&n<=90)&&(r=(i=u(Math.abs(l/Math.sin(p*n))))+Math.abs(n/360))<d&&(d=r,e=n,h=i)}}else h=u(.75*l);return this.autoRotation=t,this.labelRotation=D(e,C(a)?a:0),i.step?o:h}getSlotWidth(e){let t=this.chart,i=this.horiz,r=this.options.labels,n=Math.max(this.tickPositions.length-(this.categories?0:1),1),o=t.margin[3];if(e&&C(e.slotWidth))return e.slotWidth;if(i&&r.step<2)return r.rotation?0:(this.staggerLines||1)*this.len/n;if(!i){let e=r.style.width;if(void 0!==e)return parseInt(String(e),10);if(o)return o-t.spacing[3]}return.33*t.chartWidth}renderUnsquish(){let e,t,i,r,n=this.chart,o=n.renderer,s=this.tickPositions,a=this.ticks,l=this.options.labels,c=l.style,u=this.horiz,h=this.getSlotWidth(),d=Math.max(1,Math.round(h-(u?2*(l.padding||0):l.distance||0))),p={},f=this.labelMetrics(),m=c.textOverflow,g=0;if(E(l.rotation)||(p.rotation=l.rotation||0),s.forEach((function(e){let t=a[e];t.movedLabel&&t.replaceMovedLabel(),t&&t.label&&t.label.textPxLength>g&&(g=t.label.textPxLength)})),this.maxLabelLength=g,this.autoRotation)g>d&&g>f.h?p.rotation=this.labelRotation:this.labelRotation=0;else if(h&&(e=d,!m))for(t="clip",r=s.length;!u&&r--;)(i=a[s[r]].label)&&("ellipsis"===i.styles.textOverflow?i.css({textOverflow:"clip"}):i.textPxLength>h&&i.css({width:h+"px"}),i.getBBox().height>this.len/s.length-(f.h-f.f)&&(i.specificTextOverflow="ellipsis"));p.rotation&&(e=g>.5*n.chartHeight?.33*n.chartHeight:g,m||(t="ellipsis")),this.labelAlign=l.align||this.autoLabelAlign(this.labelRotation),this.labelAlign&&(p.align=this.labelAlign),s.forEach((function(i){let r=a[i],n=r&&r.label,o=c.width,s={};n&&(n.attr(p),r.shortenLabel?r.shortenLabel():e&&!o&&"nowrap"!==c.whiteSpace&&(e<n.textPxLength||"SPAN"===n.element.tagName)?(s.width=e+"px",m||(s.textOverflow=n.specificTextOverflow||t),n.css(s)):!n.styles.width||s.width||o||n.css({width:null}),delete n.specificTextOverflow,r.rotation=p.rotation)}),this),this.tickRotCorr=o.rotCorr(f.b,this.labelRotation||0,0!==this.side)}hasData(){return this.series.some((function(e){return e.hasData()}))||this.options.showEmpty&&_(this.min)&&_(this.max)}addTitle(e){let t,i=this.chart.renderer,r=this.horiz,n=this.opposite,o=this.options.title,s=this.chart.styledMode;this.axisTitle||((t=o.textAlign)||(t=(r?{low:"left",middle:"center",high:"right"}:{low:n?"right":"left",middle:"center",high:n?"left":"right"})[o.align]),this.axisTitle=i.text(o.text||"",0,0,o.useHTML).attr({zIndex:7,rotation:o.rotation||0,align:t}).addClass("highcharts-axis-title"),s||this.axisTitle.css(P(o.style)),this.axisTitle.add(this.axisGroup),this.axisTitle.isNew=!0),s||o.style.width||this.isRadial||this.axisTitle.css({width:this.len+"px"}),this.axisTitle[e?"show":"hide"](e)}generateTick(e){let t=this.ticks;t[e]?t[e].addLabel():t[e]=new s(this,e)}createGroups(){let{axisParent:e,chart:t,coll:i,options:r}=this,n=t.renderer,o=(t,o,s)=>n.g(t).attr({zIndex:s}).addClass(`highcharts-${i.toLowerCase()}${o} `+(this.isRadial?`highcharts-radial-axis${o} `:"")+(r.className||"")).add(e);this.axisGroup||(this.gridGroup=o("grid","-grid",r.gridZIndex),this.axisGroup=o("axis","",r.zIndex),this.labelGroup=o("axis-labels","-labels",r.labels.zIndex))}getOffset(){let e,t,i,r,n=this,{chart:o,horiz:s,options:a,side:l,ticks:c,tickPositions:u,coll:h}=n,d=o.inverted&&!n.isZAxis?[1,0,3,2][l]:l,p=n.hasData(),f=a.title,m=a.labels,g=C(a.crossing),y=o.axisOffset,v=o.clipOffset,x=[-1,1,1,-1][l],b=0,w=0,T=0;if(n.showAxis=e=p||a.showEmpty,n.staggerLines=n.horiz&&m.staggerLines||void 0,n.createGroups(),p||n.isLinked?(u.forEach((function(e){n.generateTick(e)})),n.renderUnsquish(),n.reserveSpaceDefault=0===l||2===l||{1:"left",3:"right"}[l]===n.labelAlign,D(m.reserveSpace,!g&&null,"center"===n.labelAlign||null,n.reserveSpaceDefault)&&u.forEach((function(e){T=Math.max(c[e].getLabelSize(),T)})),n.staggerLines&&(T*=n.staggerLines),n.labelOffset=T*(n.opposite?-1:1)):I(c,(function(e,t){e.destroy(),delete c[t]})),f?.text&&!1!==f.enabled&&(n.addTitle(e),e&&!g&&!1!==f.reserveSpace&&(n.titleOffset=b=n.axisTitle.getBBox()[s?"height":"width"],w=_(t=f.offset)?0:D(f.margin,s?5:10))),n.renderLine(),n.offset=x*D(a.offset,y[l]?y[l]+(a.margin||0):0),n.tickRotCorr=n.tickRotCorr||{x:0,y:0},r=0===l?-n.labelMetrics().h:2===l?n.tickRotCorr.y:0,i=Math.abs(T)+w,T&&(i-=r,i+=x*(s?D(m.y,n.tickRotCorr.y+x*m.distance):D(m.x,x*m.distance))),n.axisTitleMargin=D(t,i),n.getMaxLabelDimensions&&(n.maxLabelDimensions=n.getMaxLabelDimensions(c,u)),"colorAxis"!==h&&v){let e=this.tickSize("tick");y[l]=Math.max(y[l],(n.axisTitleMargin||0)+b+x*n.offset,i,u&&u.length&&e?e[0]+x*n.offset:0);let t=!n.axisLine||a.offset?0:n.axisLine.strokeWidth()/2;v[d]=Math.max(v[d],t)}S(this,"afterGetOffset")}getLinePath(e){let t=this.chart,i=this.opposite,r=this.offset,n=this.horiz,o=this.left+(i?this.width:0)+r,s=t.chartHeight-this.bottom-(i?this.height:0)+r;return i&&(e*=-1),t.renderer.crispLine([["M",n?this.left:o,n?s:this.top],["L",n?t.chartWidth-this.right:o,n?s:t.chartHeight-this.bottom]],e)}renderLine(){this.axisLine||(this.axisLine=this.chart.renderer.path().addClass("highcharts-axis-line").add(this.axisGroup),this.chart.styledMode||this.axisLine.attr({stroke:this.options.lineColor,"stroke-width":this.options.lineWidth,zIndex:7}))}getTitlePosition(e){let t=this.horiz,i=this.left,r=this.top,n=this.len,o=this.options.title,s=t?i:r,a=this.opposite,l=this.offset,c=o.x,u=o.y,h=this.chart.renderer.fontMetrics(e),d=e?Math.max(e.getBBox(!1,0).height-h.h-1,0):0,p={low:s+(t?0:n),middle:s+n/2,high:s+(t?n:0)}[o.align],f=(t?r+this.height:i)+(t?1:-1)*(a?-1:1)*(this.axisTitleMargin||0)+[-d,d,h.f,-d][this.side],m={x:t?p+c:f+(a?this.width:0)+l+c,y:t?f+u-(a?this.height:0)+l:p+u};return S(this,"afterGetTitlePosition",{titlePosition:m}),m}renderMinorTick(e,t){let i=this.minorTicks;i[e]||(i[e]=new s(this,e,"minor")),t&&i[e].isNew&&i[e].render(null,!0),i[e].render(null,!1,1)}renderTick(e,t,i){let r=this.isLinked,n=this.ticks;(!r||e>=this.min&&e<=this.max||this.grid&&this.grid.isColumn)&&(n[e]||(n[e]=new s(this,e)),i&&n[e].isNew&&n[e].render(t,!0,-1),n[e].render(t))}render(){let e,t,i=this,r=i.chart,n=i.logarithmic,a=r.renderer,c=i.options,u=i.isLinked,h=i.tickPositions,d=i.axisTitle,p=i.ticks,f=i.minorTicks,m=i.alternateBands,g=c.stackLabels,y=c.alternateGridColor,_=c.crossing,v=i.tickmarkOffset,x=i.axisLine,b=i.showAxis,w=l(a.globalAnimation);if(i.labelEdge.length=0,i.overlap=!1,[p,f,m].forEach((function(e){I(e,(function(e){e.isActive=!1}))})),C(_)){let e=this.isXAxis?r.yAxis[0]:r.xAxis[0],t=[1,-1,-1,1][this.side];if(e){let r=e.toPixels(_,!0);i.horiz&&(r=e.len-r),i.offset=t*r}}if(i.hasData()||u){let a=i.chart.hasRendered&&i.old&&C(i.old.min);i.minorTickInterval&&!i.categories&&i.getMinorTickPositions().forEach((function(e){i.renderMinorTick(e,a)})),h.length&&(h.forEach((function(e,t){i.renderTick(e,t,a)})),v&&(0===i.min||i.single)&&(p[-1]||(p[-1]=new s(i,-1,null,!0)),p[-1].render(-1))),y&&h.forEach((function(s,a){t=void 0!==h[a+1]?h[a+1]+v:i.max-v,a%2==0&&s<i.max&&t<=i.max+(r.polar?-v:v)&&(m[s]||(m[s]=new o.PlotLineOrBand(i,{})),e=s+v,m[s].options={from:n?n.lin2log(e):e,to:n?n.lin2log(t):t,color:y,className:"highcharts-alternate-grid"},m[s].render(),m[s].isActive=!0)})),i._addedPlotLB||(i._addedPlotLB=!0,(c.plotLines||[]).concat(c.plotBands||[]).forEach((function(e){i.addPlotBandOrLine(e)})))}[p,f,m].forEach((function(e){let t=[],i=w.duration;I(e,(function(e,i){e.isActive||(e.render(i,!1,0),e.isActive=!1,t.push(i))})),O((function(){let i=t.length;for(;i--;)e[t[i]]&&!e[t[i]].isActive&&(e[t[i]].destroy(),delete e[t[i]])}),e!==m&&r.hasRendered&&i?i:0)})),x&&(x[x.isPlaced?"animate":"attr"]({d:this.getLinePath(x.strokeWidth())}),x.isPlaced=!0,x[b?"show":"hide"](b)),d&&b&&(d[d.isNew?"attr":"animate"](i.getTitlePosition(d)),d.isNew=!1),g&&g.enabled&&i.stacking&&i.stacking.renderStackTotals(),i.old={len:i.len,max:i.max,min:i.min,transA:i.transA,userMax:i.userMax,userMin:i.userMin},i.isDirty=!1,S(this,"afterRender")}redraw(){this.visible&&(this.render(),this.plotLinesAndBands.forEach((function(e){e.render()}))),this.series.forEach((function(e){e.isDirty=!0}))}getKeepProps(){return this.keepProps||B.keepProps}destroy(e){let t=this,i=t.plotLinesAndBands,r=this.eventOptions;if(S(this,"destroy",{keepEvents:e}),e||R(t),[t.ticks,t.minorTicks,t.alternateBands].forEach((function(e){v(e)})),i){let e=i.length;for(;e--;)i[e].destroy()}for(let n in["axisLine","axisTitle","axisGroup","gridGroup","labelGroup","cross","scrollbar"].forEach((function(e){t[e]&&(t[e]=t[e].destroy())})),t.plotLinesAndBandsGroups)t.plotLinesAndBandsGroups[n]=t.plotLinesAndBandsGroups[n].destroy();I(t,(function(e,i){-1===t.getKeepProps().indexOf(i)&&delete t[i]})),this.eventOptions=r}drawCrosshair(e,t){let r,n,o,s,a=this.crosshair,l=D(a&&a.snap,!0),c=this.chart,u=this.cross;if(S(this,"drawCrosshair",{e:e,point:t}),e||(e=this.cross&&this.cross.e),a&&!1!==(_(t)||!l)){if(l?_(t)&&(n=D("colorAxis"!==this.coll?t.crosshairPos:null,this.isXAxis?t.plotX:this.len-t.plotY)):n=e&&(this.horiz?e.chartX-this.pos:this.len-e.chartY+this.pos),_(n)&&(s={value:t&&(this.isXAxis?t.x:D(t.stackY,t.y)),translatedValue:n},c.polar&&w(s,{isCrosshair:!0,chartX:e&&e.chartX,chartY:e&&e.chartY,point:t}),r=this.getPlotLinePath(s)||null),!_(r))return void this.hideCrosshair();o=this.categories&&!this.isRadial,u||(this.cross=u=c.renderer.path().addClass("highcharts-crosshair highcharts-crosshair-"+(o?"category ":"thin ")+(a.className||"")).attr({zIndex:D(a.zIndex,2)}).add(),!c.styledMode&&(u.attr({stroke:a.color||(o?i.parse("#ccd3ff").setOpacity(.25).get():"#cccccc"),"stroke-width":D(a.width,1)}).css({"pointer-events":"none"}),a.dashStyle&&u.attr({dashstyle:a.dashStyle}))),u.show().attr({d:r}),o&&!a.width&&u.attr({"stroke-width":this.transA}),this.cross.e=e}else this.hideCrosshair();S(this,"afterDrawCrosshair",{e:e,point:t})}hideCrosshair(){this.cross&&this.cross.hide(),S(this,"afterHideCrosshair")}update(e,t){let i=this.chart;e=P(this.userOptions,e),this.destroy(!0),this.init(i,e),i.isDirtyBox=!0,D(t,!0)&&i.redraw()}remove(e){let t=this.chart,i=this.coll,r=this.series,n=r.length;for(;n--;)r[n]&&r[n].remove(!1);x(t.axes,this),x(t[i]||[],this),t.orderItems(i),this.destroy(),t.isDirtyBox=!0,D(e,!0)&&t.redraw()}setTitle(e,t){this.update({title:e},t)}setCategories(e,t){this.update({categories:e},t)}}return B.keepProps=["coll","extKey","hcEvents","len","names","series","userMax","userMin"],B})),i(t,"Core/Axis/DateTimeAxis.js",[t["Core/Utilities.js"]],(function(e){var t;let{addEvent:i,getMagnitude:r,normalizeTickInterval:n,timeUnits:o}=e;return function(e){function t(){return this.chart.time.getTimeTicks.apply(this.chart.time,arguments)}function s(){"datetime"===this.type?this.dateTime||(this.dateTime=new a(this)):this.dateTime=void 0}e.compose=function(e){return e.keepProps.includes("dateTime")||(e.keepProps.push("dateTime"),e.prototype.getTimeTicks=t,i(e,"afterSetType",s)),e};class a{constructor(e){this.axis=e}normalizeTimeTickInterval(e,t){let i,s=t||[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2]],["week",[1,2]],["month",[1,2,3,4,6]],["year",null]],a=s[s.length-1],l=o[a[0]],c=a[1];for(i=0;i<s.length&&(l=o[(a=s[i])[0]],c=a[1],!s[i+1]||!(e<=(l*c[c.length-1]+o[s[i+1][0]])/2));i++);return l===o.year&&e<5*l&&(c=[1,2,5]),{unitRange:l,count:n(e/l,c,"year"===a[0]?Math.max(r(e/l),1):1),unitName:a[0]}}getXDateFormat(e,t){let{axis:i}=this,r=i.chart.time;return i.closestPointRange?r.getDateFormat(i.closestPointRange,e,i.options.startOfWeek,t)||r.resolveDTLFormat(t.year).main:r.resolveDTLFormat(t.day).main}}e.Additions=a}(t||(t={})),t})),i(t,"Core/Axis/LogarithmicAxis.js",[t["Core/Utilities.js"]],(function(e){var t;let{addEvent:i,normalizeTickInterval:r,pick:n}=e;return function(e){function t(){"logarithmic"!==this.type?this.logarithmic=void 0:this.logarithmic??(this.logarithmic=new s(this))}function o(){let e=this.logarithmic;e&&(this.lin2val=function(t){return e.lin2log(t)},this.val2lin=function(t){return e.log2lin(t)})}e.compose=function(e){return e.keepProps.includes("logarithmic")||(e.keepProps.push("logarithmic"),i(e,"afterSetType",t),i(e,"afterInit",o)),e};class s{constructor(e){this.axis=e}getLogTickPositions(e,t,i,o){let s=this.axis,a=s.len,l=s.options,c=[];if(o||(this.minorAutoInterval=void 0),e>=.5)e=Math.round(e),c=s.getLinearTickPositions(e,t,i);else if(e>=.08){let r,n,s,a,l,u,h;for(r=e>.3?[1,2,4]:e>.15?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9],n=Math.floor(t);n<i+1&&!h;n++)for(s=0,a=r.length;s<a&&!h;s++)(l=this.log2lin(this.lin2log(n)*r[s]))>t&&(!o||u<=i)&&void 0!==u&&c.push(u),u>i&&(h=!0),u=l}else{let u=this.lin2log(t),h=this.lin2log(i),d=o?s.getMinorTickInterval():l.tickInterval,p=l.tickPixelInterval/(o?5:1),f=o?a/s.tickPositions.length:a;e=r(e=n("auto"===d?null:d,this.minorAutoInterval,(h-u)*p/(f||1))),c=s.getLinearTickPositions(e,u,h).map(this.log2lin),o||(this.minorAutoInterval=e/5)}return o||(s.tickInterval=e),c}lin2log(e){return Math.pow(10,e)}log2lin(e){return Math.log(e)/Math.LN10}}e.Additions=s}(t||(t={})),t})),i(t,"Core/Axis/PlotLineOrBand/PlotLineOrBandAxis.js",[t["Core/Utilities.js"]],(function(e){var t;let{erase:i,extend:r,isNumber:n}=e;return function(e){let t;function o(e){return this.addPlotBandOrLine(e,"plotBands")}function s(e,i){let r=this.userOptions,n=new t(this,e);if(this.visible&&(n=n.render()),n){if(this._addedPlotLB||(this._addedPlotLB=!0,(r.plotLines||[]).concat(r.plotBands||[]).forEach((e=>{this.addPlotBandOrLine(e)}))),i){let t=r[i]||[];t.push(e),r[i]=t}this.plotLinesAndBands.push(n)}return n}function a(e){return this.addPlotBandOrLine(e,"plotLines")}function l(e,t,i){i=i||this.options;let r,o,s=this.getPlotLinePath({value:t,force:!0,acrossPanes:i.acrossPanes}),a=[],l=this.horiz,c=!n(this.min)||!n(this.max)||e<this.min&&t<this.min||e>this.max&&t>this.max,u=this.getPlotLinePath({value:e,force:!0,acrossPanes:i.acrossPanes}),h=1;if(u&&s)for(c&&(o=u.toString()===s.toString(),h=0),r=0;r<u.length;r+=2){let e=u[r],t=u[r+1],i=s[r],n=s[r+1];("M"===e[0]||"L"===e[0])&&("M"===t[0]||"L"===t[0])&&("M"===i[0]||"L"===i[0])&&("M"===n[0]||"L"===n[0])&&(l&&i[1]===e[1]?(i[1]+=h,n[1]+=h):l||i[2]!==e[2]||(i[2]+=h,n[2]+=h),a.push(["M",e[1],e[2]],["L",t[1],t[2]],["L",n[1],n[2]],["L",i[1],i[2]],["Z"])),a.isFlat=o}return a}function c(e){this.removePlotBandOrLine(e)}function u(e){let t=this.plotLinesAndBands,r=this.options,n=this.userOptions;if(t){let o=t.length;for(;o--;)t[o].id===e&&t[o].destroy();[r.plotLines||[],n.plotLines||[],r.plotBands||[],n.plotBands||[]].forEach((function(t){for(o=t.length;o--;)(t[o]||{}).id===e&&i(t,t[o])}))}}function h(e){this.removePlotBandOrLine(e)}e.compose=function(e,i){let n=i.prototype;return n.addPlotBand||(t=e,r(n,{addPlotBand:o,addPlotLine:a,addPlotBandOrLine:s,getPlotBandPath:l,removePlotBand:c,removePlotLine:h,removePlotBandOrLine:u})),i}}(t||(t={})),t})),i(t,"Core/Axis/PlotLineOrBand/PlotLineOrBand.js",[t["Core/Axis/PlotLineOrBand/PlotLineOrBandAxis.js"],t["Core/Utilities.js"]],(function(e,t){let{addEvent:i,arrayMax:r,arrayMin:n,defined:o,destroyObjectProperties:s,erase:a,fireEvent:l,merge:c,objectEach:u,pick:h}=t;class d{static compose(t,r){return i(t,"afterInit",(function(){this.labelCollectors.push((()=>{let e=[];for(let t of this.axes)for(let{label:i,options:r}of t.plotLinesAndBands)i&&!r?.label?.allowOverlap&&e.push(i);return e}))})),e.compose(d,r)}constructor(e,t){this.axis=e,this.options=t,this.id=t.id}render(){l(this,"render");let e,{axis:t,options:i}=this,{horiz:r,logarithmic:n}=t,{color:s,events:a,zIndex:d=0}=i,p={},f=t.chart.renderer,m=i.to,g=i.from,y=i.value,_=i.borderWidth,v=i.label,{label:x,svgElem:b}=this,w=[],S=o(g)&&o(m),T=o(y),M=!b,A={class:"highcharts-plot-"+(S?"band ":"line ")+(i.className||"")},C=S?"bands":"lines";if(!t.chart.styledMode&&(T?(A.stroke=s||"#999999",A["stroke-width"]=h(i.width,1),i.dashStyle&&(A.dashstyle=i.dashStyle)):S&&(A.fill=s||"#e6e9ff",_&&(A.stroke=i.borderColor,A["stroke-width"]=_))),p.zIndex=d,C+="-"+d,(e=t.plotLinesAndBandsGroups[C])||(t.plotLinesAndBandsGroups[C]=e=f.g("plot-"+C).attr(p).add()),b||(this.svgElem=b=f.path().attr(A).add(e)),o(y))w=t.getPlotLinePath({value:n?.log2lin(y)??y,lineWidth:b.strokeWidth(),acrossPanes:i.acrossPanes});else{if(!o(g)||!o(m))return;w=t.getPlotBandPath(n?.log2lin(g)??g,n?.log2lin(m)??m,i)}return!this.eventsAdded&&a&&(u(a,((e,t)=>{b?.on(t,(e=>{a[t].apply(this,[e])}))})),this.eventsAdded=!0),!M&&b.d||!w?.length?b&&(w?(b.show(),b.animate({d:w})):b.d&&(b.hide(),x&&(this.label=x=x.destroy()))):b.attr({d:w}),v&&(o(v.text)||o(v.formatter))&&w?.length&&t.width>0&&t.height>0&&!w.isFlat?(v=c({align:r&&S?"center":void 0,x:r?!S&&4:10,verticalAlign:!r&&S?"middle":void 0,y:r?S?16:10:S?6:-4,rotation:r&&!S?90:0,...S?{inside:!0}:{}},v),this.renderLabel(v,w,S,d)):x&&x.hide(),this}renderLabel(e,t,i,s){let a=this.axis,l=a.chart.renderer,u=e.inside,h=this.label;h||(this.label=h=l.text(this.getLabelText(e),0,0,e.useHTML).attr({align:e.textAlign||e.align,rotation:e.rotation,class:"highcharts-plot-"+(i?"band":"line")+"-label "+(e.className||""),zIndex:s}),a.chart.styledMode||h.css(c({fontSize:"0.8em",textOverflow:i&&!u?"":"ellipsis"},e.style)),h.add());let d=t.xBounds||[t[0][1],t[1][1],i?t[2][1]:t[0][1]],p=t.yBounds||[t[0][2],t[1][2],i?t[2][2]:t[0][2]],f=n(d),m=n(p),g=r(d)-f;h.align(e,!1,{x:f,y:m,width:g,height:r(p)-m}),(!h.alignValue||"left"===h.alignValue||o(u))&&h.css({width:(e.style?.width||(i&&u?g:90===h.rotation?a.height-(h.alignAttr.y-a.top):(e.clip?a.width:a.chart.chartWidth)-(h.alignAttr.x-a.left)))+"px"}),h.show(!0)}getLabelText(e){return o(e.formatter)?e.formatter.call(this):e.text}destroy(){a(this.axis.plotLinesAndBands,this),delete this.axis,s(this)}}return d})),i(t,"Core/Tooltip.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Templating.js"],t["Core/Globals.js"],t["Core/Renderer/RendererUtilities.js"],t["Core/Renderer/RendererRegistry.js"],t["Core/Utilities.js"]],(function(e,t,i,r,n,o){var s;let{animObject:a}=e,{format:l}=t,{composed:c,doc:u,isSafari:h}=i,{distribute:d}=r,{addEvent:p,clamp:f,css:m,discardElement:g,extend:y,fireEvent:_,isArray:v,isNumber:x,isString:b,merge:w,pick:S,pushUnique:T,splat:M,syncTimeout:A}=o;class C{constructor(e,t,i){this.allowShared=!0,this.crosshairs=[],this.distance=0,this.isHidden=!0,this.isSticky=!1,this.options={},this.outside=!1,this.chart=e,this.init(e,t),this.pointer=i}bodyFormatter(e){return e.map((function(e){let t=e.series.tooltipOptions;return(t[(e.point.formatPrefix||"point")+"Formatter"]||e.point.tooltipFormatter).call(e.point,t[(e.point.formatPrefix||"point")+"Format"]||"")}))}cleanSplit(e){this.chart.series.forEach((function(t){let i=t&&t.tt;i&&(!i.isActive||e?t.tt=i.destroy():i.isActive=!1)}))}defaultFormatter(e){let t,i=this.points||M(this);return(t=(t=[e.tooltipFooterHeaderFormatter(i[0])]).concat(e.bodyFormatter(i))).push(e.tooltipFooterHeaderFormatter(i[0],!0)),t}destroy(){this.label&&(this.label=this.label.destroy()),this.split&&(this.cleanSplit(!0),this.tt&&(this.tt=this.tt.destroy())),this.renderer&&(this.renderer=this.renderer.destroy(),g(this.container)),o.clearTimeout(this.hideTimer)}getAnchor(e,t){let i,{chart:r,pointer:n}=this,o=r.inverted,s=r.plotTop,a=r.plotLeft;if((e=M(e))[0].series&&e[0].series.yAxis&&!e[0].series.yAxis.options.reversedStacks&&(e=e.slice().reverse()),this.followPointer&&t)void 0===t.chartX&&(t=n.normalize(t)),i=[t.chartX-a,t.chartY-s];else if(e[0].tooltipPos)i=e[0].tooltipPos;else{let r=0,n=0;e.forEach((function(e){let t=e.pos(!0);t&&(r+=t[0],n+=t[1])})),r/=e.length,n/=e.length,this.shared&&e.length>1&&t&&(o?r=t.chartX:n=t.chartY),i=[r-a,n-s]}return i.map(Math.round)}getClassName(e,t,i){let r=this.options,n=e.series,o=n.options;return[r.className,"highcharts-label",i&&"highcharts-tooltip-header",t?"highcharts-tooltip-box":"highcharts-tooltip",!i&&"highcharts-color-"+S(e.colorIndex,n.colorIndex),o&&o.className].filter(b).join(" ")}getLabel(){let{anchorX:e,anchorY:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{anchorX:0,anchorY:0},r=this,o=this.chart.styledMode,s=this.options,a=this.split&&this.allowShared,l=this.container,c=this.chart.renderer;if(this.label){let e=!this.label.hasClass("highcharts-label");(!a&&e||a&&!e)&&this.destroy()}if(!this.label){if(this.outside){let e=this.chart.options.chart.style,t=n.getRendererType();this.container=l=i.doc.createElement("div"),l.className="highcharts-tooltip-container",m(l,{position:"absolute",top:"1px",pointerEvents:"none",zIndex:Math.max(this.options.style.zIndex||0,(e&&e.zIndex||0)+3)}),this.renderer=c=new t(l,0,0,e,void 0,void 0,c.styledMode)}if(a?this.label=c.g("tooltip"):(this.label=c.label("",e,t,s.shape,void 0,void 0,s.useHTML,void 0,"tooltip").attr({padding:s.padding,r:s.borderRadius}),o||this.label.attr({fill:s.backgroundColor,"stroke-width":s.borderWidth||0}).css(s.style).css({pointerEvents:s.style.pointerEvents||(this.shouldStickOnContact()?"auto":"none")})),r.outside){let e=this.label;[e.xSetter,e.ySetter].forEach(((t,i)=>{e[i?"ySetter":"xSetter"]=n=>{t.call(e,r.distance),e[i?"y":"x"]=n,l&&(l.style[i?"top":"left"]=`${n}px`)}}))}this.label.attr({zIndex:8}).shadow(s.shadow).add()}return l&&!l.parentElement&&i.doc.body.appendChild(l),this.label}getPlayingField(){let{body:e,documentElement:t}=u,{chart:i,distance:r,outside:n}=this;return{width:n?Math.max(e.scrollWidth,t.scrollWidth,e.offsetWidth,t.offsetWidth,t.clientWidth)-2*r:i.chartWidth,height:n?Math.max(e.scrollHeight,t.scrollHeight,e.offsetHeight,t.offsetHeight,t.clientHeight):i.chartHeight}}getPosition(e,t,i){let r,{distance:n,chart:o,outside:s,pointer:a}=this,{inverted:l,plotLeft:c,plotTop:u,polar:h}=o,{plotX:d=0,plotY:p=0}=i,f={},m=l&&i.h||0,{height:g,width:y}=this.getPlayingField(),_=a.getChartPosition(),v=e=>e*_.scaleX,x=e=>e*_.scaleY,b=i=>{let r="x"===i;return[i,r?y:g,r?e:t].concat(s?[r?v(e):x(t),r?_.left-n+v(d+c):_.top-n+x(p+u),0,r?y:g]:[r?e:t,r?d+c:p+u,r?c:u,r?c+o.plotWidth:u+o.plotHeight])},w=b("y"),T=b("x"),M=!!i.negative;!h&&o.hoverSeries?.yAxis?.reversed&&(M=!M);let A=!this.followPointer&&S(i.ttBelow,!h&&!l===M),C=function(e,t,i,r,o,a,l){let c=s?"y"===e?x(n):v(n):n,u=(i-r)/2,h=r<o-n,d=o+n+r<t,p=o-c-i+u,g=o+c-u;if(A&&d)f[e]=g;else if(!A&&h)f[e]=p;else if(h)f[e]=Math.min(l-r,p-m<0?p:p-m);else{if(!d)return!1;f[e]=Math.max(a,g+m+i>t?g:g+m)}},E=function(e,t,i,r,o){if(o<n||o>t-n)return!1;f[e]=o<i/2?1:o>t-r/2?t-r-2:o-i/2},P=function(e){[w,T]=[T,w],r=e},k=()=>{!1!==C.apply(0,w)?!1!==E.apply(0,T)||r||(P(!0),k()):r?f.x=f.y=0:(P(!0),k())};return(l&&!h||this.len>1)&&P(),k(),f}hide(e){let t=this;o.clearTimeout(this.hideTimer),e=S(e,this.options.hideDelay),this.isHidden||(this.hideTimer=A((function(){let i=t.getLabel();t.getLabel().animate({opacity:0},{duration:e?150:e,complete:()=>{i.hide(),t.container&&t.container.remove()}}),t.isHidden=!0}),e))}init(e,t){this.chart=e,this.options=t,this.crosshairs=[],this.isHidden=!0,this.split=t.split&&!e.inverted&&!e.polar,this.shared=t.shared||this.split,this.outside=S(t.outside,!(!e.scrollablePixelsX&&!e.scrollablePixelsY))}shouldStickOnContact(e){return!(this.followPointer||!this.options.stickOnContact||e&&!this.pointer.inClass(e.target,"highcharts-tooltip"))}move(e,t,i,r){let n=this,o=a(!n.isHidden&&n.options.animation),s={x:e,y:t};n.followPointer||(n.len||0)>1||(s.anchorX=i,s.anchorY=r),o.step=()=>n.drawTracker(),n.getLabel().animate(s,o)}refresh(e,t){let{chart:i,options:r,pointer:n,shared:s}=this,a=M(e),c=a[0],u=[],h=r.format,d=r.formatter||this.defaultFormatter,p=i.styledMode,m={},g=this.allowShared;if(!r.enabled||!c.series)return;o.clearTimeout(this.hideTimer),this.allowShared=!(!v(e)&&e.series&&e.series.noSharedTooltip),g=g&&!this.allowShared,this.followPointer=!this.split&&c.series.tooltipOptions.followPointer;let y=this.getAnchor(e,t),x=y[0],w=y[1];s&&this.allowShared?(n.applyInactiveState(a),a.forEach((function(e){e.setState("hover"),u.push(e.getLabelConfig())})),(m=c.getLabelConfig()).points=u):m=c.getLabelConfig(),this.len=u.length;let T=b(h)?l(h,m,i):d.call(m,this),A=c.series;if(this.distance=S(A.tooltipOptions.distance,16),!1===T)this.hide();else{if(this.split&&this.allowShared)this.renderSplit(T,a);else{let e=x,o=w;if(t&&n.isDirectTouch&&(e=t.chartX-i.plotLeft,o=t.chartY-i.plotTop),!i.polar&&!1!==A.options.clip&&!a.some((t=>n.isDirectTouch||t.series.shouldShowTooltip(e,o))))return void this.hide();{let e=this.getLabel(g&&this.tt||{});(!r.style.width||p)&&e.css({width:(this.outside?this.getPlayingField():i.spacingBox).width+"px"}),e.attr({class:this.getClassName(c),text:T&&T.join?T.join(""):T}),this.outside&&e.attr({x:f(e.x||0,0,this.getPlayingField().width-(e.width||0))}),p||e.attr({stroke:r.borderColor||c.color||A.color||"#666666"}),this.updatePosition({plotX:x,plotY:w,negative:c.negative,ttBelow:c.ttBelow,h:y[2]||0})}}this.isHidden&&this.label&&this.label.attr({opacity:1}).show(),this.isHidden=!1}_(this,"refresh")}renderSplit(e,t){let i=this,{chart:r,chart:{chartWidth:n,chartHeight:o,plotHeight:s,plotLeft:a,plotTop:l,scrollablePixelsY:c=0,scrollablePixelsX:p,styledMode:m},distance:g,options:_,options:{positioner:v},pointer:x}=i,{scrollLeft:w=0,scrollTop:T=0}=r.scrollablePlotArea?.scrollingContainer||{},M=i.outside&&"number"!=typeof p?u.documentElement.getBoundingClientRect():{left:w,right:w+n,top:T,bottom:T+o},A=i.getLabel(),C=this.renderer||r.renderer,E=!(!r.xAxis[0]||!r.xAxis[0].opposite),{left:P,top:k}=x.getChartPosition(),I=l+T,D=0,L=s-c;function R(e,t,r,n){let o,s,a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];return r?(o=E?0:L,s=f(e-n/2,M.left,M.right-n-(i.outside?P:0))):(o=t-I,s=f(s=a?e-n-g:e+g,a?s:M.left,M.right)),{x:s,y:o}}b(e)&&(e=[!1,e]);let z=e.slice(0,t.length+1).reduce((function(e,r,n){if(!1!==r&&""!==r){let o=t[n-1]||{isHeader:!0,plotX:t[0].plotX,plotY:s,series:{}},c=o.isHeader,u=c?i:o.series,h=u.tt=function(e,t,r){let n=e,{isHeader:o,series:s}=t;if(!n){let e={padding:_.padding,r:_.borderRadius};m||(e.fill=_.backgroundColor,e["stroke-width"]=_.borderWidth??1),n=C.label("",0,0,_[o?"headerShape":"shape"],void 0,void 0,_.useHTML).addClass(i.getClassName(t,!0,o)).attr(e).add(A)}return n.isActive=!0,n.attr({text:r}),m||n.css(_.style).attr({stroke:_.borderColor||t.color||s.color||"#333333"}),n}(u.tt,o,r.toString()),d=h.getBBox(),p=d.width+h.strokeWidth();c&&(D=d.height,L+=D,E&&(I-=D));let{anchorX:y,anchorY:x}=function(e){let t,i,{isHeader:r,plotX:n=0,plotY:o=0,series:c}=e;if(r)t=Math.max(a+n,a),i=l+s/2;else{let{xAxis:e,yAxis:r}=c;t=e.pos+f(n,-g,e.len+g),c.shouldShowTooltip(0,r.pos-l+o,{ignoreX:!0})&&(i=r.pos+o)}return{anchorX:t=f(t,M.left-g,M.right+g),anchorY:i}}(o);if("number"==typeof x){let t=d.height+1,r=v?v.call(i,p,t,o):R(y,x,c,p);e.push({align:v?0:void 0,anchorX:y,anchorY:x,boxWidth:p,point:o,rank:S(r.rank,c?1:0),size:t,target:r.y,tt:h,x:r.x})}else h.isActive=!1}return e}),[]);!v&&z.some((e=>{let{outside:t}=i,r=(t?P:0)+e.anchorX;return r<M.left&&r+e.boxWidth<M.right||r<P-M.left+e.boxWidth&&M.right-r>r}))&&(z=z.map((e=>{let{x:t,y:i}=R(e.anchorX,e.anchorY,e.point.isHeader,e.boxWidth,!1);return y(e,{target:i,x:t})}))),i.cleanSplit(),d(z,L);let O={left:P,right:P};z.forEach((function(e){let{x:t,boxWidth:r,isHeader:n}=e;!n&&(i.outside&&P+t<O.left&&(O.left=P+t),!n&&i.outside&&O.left+r>O.right&&(O.right=P+t))})),z.forEach((function(e){let{x:t,anchorX:r,anchorY:n,pos:o,point:{isHeader:s}}=e,a={visibility:void 0===o?"hidden":"inherit",x:t,y:(o||0)+I,anchorX:r,anchorY:n};if(i.outside&&t<r){let e=P-O.left;e>0&&(s||(a.x=t+e,a.anchorX=r+e),s&&(a.x=(O.right-O.left)/2,a.anchorX=r+e))}e.tt.attr(a)}));let{container:F,outside:B,renderer:N}=i;if(B&&F&&N){let{width:e,height:t,x:i,y:r}=A.getBBox();N.setSize(e+i,t+r,!1),F.style.left=O.left+"px",F.style.top=k+"px"}h&&A.attr({opacity:1===A.opacity?.999:1})}drawTracker(){if(!this.shouldStickOnContact())return void(this.tracker&&(this.tracker=this.tracker.destroy()));let e=this.chart,t=this.label,i=this.shared?e.hoverPoints:e.hoverPoint;if(!t||!i)return;let r={x:0,y:0,width:0,height:0},n=this.getAnchor(i),o=t.getBBox();n[0]+=e.plotLeft-(t.translateX||0),n[1]+=e.plotTop-(t.translateY||0),r.x=Math.min(0,n[0]),r.y=Math.min(0,n[1]),r.width=n[0]<0?Math.max(Math.abs(n[0]),o.width-n[0]):Math.max(Math.abs(n[0]),o.width),r.height=n[1]<0?Math.max(Math.abs(n[1]),o.height-Math.abs(n[1])):Math.max(Math.abs(n[1]),o.height),this.tracker?this.tracker.attr(r):(this.tracker=t.renderer.rect(r).addClass("highcharts-tracker").add(t),e.styledMode||this.tracker.attr({fill:"rgba(0,0,0,0)"}))}styledModeFormat(e){return e.replace('style="font-size: 0.8em"','class="highcharts-header"').replace(/style="color:{(point|series)\.color}"/g,'class="highcharts-color-{$1.colorIndex} {series.options.className} {point.options.className}"')}tooltipFooterHeaderFormatter(e,t){let i=e.series,r=i.tooltipOptions,n=i.xAxis,o=n&&n.dateTime,s={isFooter:t,labelConfig:e},a=r.xDateFormat,c=r[t?"footerFormat":"headerFormat"];return _(this,"headerFormatter",s,(function(t){o&&!a&&x(e.key)&&(a=o.getXDateFormat(e.key,r.dateTimeLabelFormats)),o&&a&&(e.point&&e.point.tooltipDateKeys||["key"]).forEach((function(e){c=c.replace("{point."+e+"}","{point."+e+":"+a+"}")})),i.chart.styledMode&&(c=this.styledModeFormat(c)),t.text=l(c,{point:e,series:i},this.chart)})),s.text}update(e){this.destroy(),this.init(this.chart,w(!0,this.options,e))}updatePosition(e){let t,{chart:i,container:r,distance:n,options:o,pointer:s,renderer:a}=this,{height:l=0,width:c=0}=this.getLabel(),{left:u,top:h,scaleX:d,scaleY:p}=s.getChartPosition(),f=(o.positioner||this.getPosition).call(this,c,l,e),g=(e.plotX||0)+i.plotLeft,y=(e.plotY||0)+i.plotTop;a&&r&&(o.positioner&&(f.x+=u-n,f.y+=h-n),t=(o.borderWidth||0)+2*n+2,a.setSize(c+t,l+t,!1),(1!==d||1!==p)&&(m(r,{transform:`scale(${d}, ${p})`}),g*=d,y*=p),g+=u-f.x,y+=h-f.y),this.move(Math.round(f.x),Math.round(f.y||0),g,y)}}return(s=C||(C={})).compose=function(e){T(c,"Core.Tooltip")&&p(e,"afterInit",(function(){let e=this.chart;e.options.tooltip&&(e.tooltip=new s(e,e.options.tooltip,this))}))},C})),i(t,"Core/Series/Point.js",[t["Core/Renderer/HTML/AST.js"],t["Core/Animation/AnimationUtilities.js"],t["Core/Defaults.js"],t["Core/Templating.js"],t["Core/Utilities.js"]],(function(e,t,i,r,n){let{animObject:o}=t,{defaultOptions:s}=i,{format:a}=r,{addEvent:l,crisp:c,erase:u,extend:h,fireEvent:d,getNestedProperty:p,isArray:f,isFunction:m,isNumber:g,isObject:y,merge:_,pick:v,syncTimeout:x,removeEvent:b,uniqueKey:w}=n;class S{animateBeforeDestroy(){let e=this,t={x:e.startXPos,opacity:0},i=e.getGraphicalProps();i.singular.forEach((function(i){e[i]=e[i].animate("dataLabel"===i?{x:e[i].startXPos,y:e[i].startYPos,opacity:0}:t)})),i.plural.forEach((function(t){e[t].forEach((function(t){t.element&&t.animate(h({x:e.startXPos},t.startYPos?{x:t.startXPos,y:t.startYPos}:{}))}))}))}applyOptions(e,t){let i=this.series,r=i.options.pointValKey||i.pointValKey;return h(this,e=S.prototype.optionsToObject.call(this,e)),this.options=this.options?h(this.options,e):e,e.group&&delete this.group,e.dataLabels&&delete this.dataLabels,r&&(this.y=S.prototype.getNestedProperty.call(this,r)),this.selected&&(this.state="select"),"name"in this&&void 0===t&&i.xAxis&&i.xAxis.hasNames&&(this.x=i.xAxis.nameToX(this)),void 0===this.x&&i?this.x=t??i.autoIncrement():g(e.x)&&i.options.relativeXValue&&(this.x=i.autoIncrement(e.x)),this.isNull=this.isValid&&!this.isValid(),this.formatPrefix=this.isNull?"null":"point",this}destroy(){if(!this.destroyed){let e=this,t=e.series,i=t.chart,r=t.options.dataSorting,n=i.hoverPoints,s=o(e.series.chart.renderer.globalAnimation),a=()=>{for(let t in(e.graphic||e.graphics||e.dataLabel||e.dataLabels)&&(b(e),e.destroyElements()),e)delete e[t]};e.legendItem&&i.legend.destroyItem(e),n&&(e.setState(),u(n,e),n.length||(i.hoverPoints=null)),e===i.hoverPoint&&e.onMouseOut(),r&&r.enabled?(this.animateBeforeDestroy(),x(a,s.duration)):a(),i.pointCount--}this.destroyed=!0}destroyElements(e){let t=this,i=t.getGraphicalProps(e);i.singular.forEach((function(e){t[e]=t[e].destroy()})),i.plural.forEach((function(e){t[e].forEach((function(e){e&&e.element&&e.destroy()})),delete t[e]}))}firePointEvent(e,t,i){let r=this,n=this.series.options;r.manageEvent(e),"click"===e&&n.allowPointSelect&&(i=function(e){!r.destroyed&&r.select&&r.select(null,e.ctrlKey||e.metaKey||e.shiftKey)}),d(r,e,t,i)}getClassName(){return"highcharts-point"+(this.selected?" highcharts-point-select":"")+(this.negative?" highcharts-negative":"")+(this.isNull?" highcharts-null-point":"")+(void 0!==this.colorIndex?" highcharts-color-"+this.colorIndex:"")+(this.options.className?" "+this.options.className:"")+(this.zone&&this.zone.className?" "+this.zone.className.replace("highcharts-negative",""):"")}getGraphicalProps(e){let t,i,r=this,n=[],o={singular:[],plural:[]};for((e=e||{graphic:1,dataLabel:1}).graphic&&n.push("graphic","connector"),e.dataLabel&&n.push("dataLabel","dataLabelPath","dataLabelUpper"),i=n.length;i--;)r[t=n[i]]&&o.singular.push(t);return["graphic","dataLabel"].forEach((function(t){let i=t+"s";e[t]&&r[i]&&o.plural.push(i)})),o}getLabelConfig(){return{x:this.category,y:this.y,color:this.color,colorIndex:this.colorIndex,key:this.name||this.category,series:this.series,point:this,percentage:this.percentage,total:this.total||this.stackTotal}}getNestedProperty(e){return e?0===e.indexOf("custom.")?p(e,this.options):this[e]:void 0}getZone(){let e,t=this.series,i=t.zones,r=t.zoneAxis||"y",n=0;for(e=i[0];this[r]>=e.value;)e=i[++n];return this.nonZonedColor||(this.nonZonedColor=this.color),e&&e.color&&!this.options.color?this.color=e.color:this.color=this.nonZonedColor,e}hasNewShapeType(){return(this.graphic&&(this.graphic.symbolName||this.graphic.element.nodeName))!==this.shapeType}constructor(e,t,i){this.formatPrefix="point",this.visible=!0,this.series=e,this.applyOptions(t,i),this.id??(this.id=w()),this.resolveColor(),e.chart.pointCount++,d(this,"afterInit")}isValid(){return(g(this.x)||this.x instanceof Date)&&g(this.y)}optionsToObject(e){let t,i=this.series,r=i.options.keys,n=r||i.pointArrayMap||["y"],o=n.length,s={},a=0,l=0;if(g(e)||null===e)s[n[0]]=e;else if(f(e))for(!r&&e.length>o&&("string"==(t=typeof e[0])?s.name=e[0]:"number"===t&&(s.x=e[0]),a++);l<o;)r&&void 0===e[a]||(n[l].indexOf(".")>0?S.prototype.setNestedProperty(s,e[a],n[l]):s[n[l]]=e[a]),a++,l++;else"object"==typeof e&&(s=e,e.dataLabels&&(i.hasDataLabels=()=>!0),e.marker&&(i._hasPointMarkers=!0));return s}pos(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.plotY;if(!this.destroyed){let{plotX:i,series:r}=this,{chart:n,xAxis:o,yAxis:s}=r,a=0,l=0;if(g(i)&&g(t))return e&&(a=o?o.pos:n.plotLeft,l=s?s.pos:n.plotTop),n.inverted&&o&&s?[s.len-t+l,o.len-i+a]:[i+a,t+l]}}resolveColor(){let e,t,i,r=this.series,n=r.chart.options.chart,o=r.chart.styledMode,s=n.colorCount;delete this.nonZonedColor,r.options.colorByPoint?(o||(e=(t=r.options.colors||r.chart.options.colors)[r.colorCounter],s=t.length),i=r.colorCounter,r.colorCounter++,r.colorCounter===s&&(r.colorCounter=0)):(o||(e=r.color),i=r.colorIndex),this.colorIndex=v(this.options.colorIndex,i),this.color=v(this.options.color,e)}setNestedProperty(e,t,i){return i.split(".").reduce((function(e,i,r,n){let o=n.length-1===r;return e[i]=o?t:y(e[i],!0)?e[i]:{},e[i]}),e),e}shouldDraw(){return!this.isNull}tooltipFormatter(e){let t=this.series,i=t.tooltipOptions,r=v(i.valueDecimals,""),n=i.valuePrefix||"",o=i.valueSuffix||"";return t.chart.styledMode&&(e=t.chart.tooltip.styledModeFormat(e)),(t.pointArrayMap||["y"]).forEach((function(t){t="{point."+t,(n||o)&&(e=e.replace(RegExp(t+"}","g"),n+t+"}"+o)),e=e.replace(RegExp(t+"}","g"),t+":,."+r+"f}")})),a(e,{point:this,series:this.series},t.chart)}update(e,t,i,r){let n,o=this,s=o.series,a=o.graphic,l=s.chart,c=s.options;function u(){o.applyOptions(e);let r=a&&o.hasMockGraphic,u=null===o.y?!r:r;a&&u&&(o.graphic=a.destroy(),delete o.hasMockGraphic),y(e,!0)&&(a&&a.element&&e&&e.marker&&void 0!==e.marker.symbol&&(o.graphic=a.destroy()),e?.dataLabels&&o.dataLabel&&(o.dataLabel=o.dataLabel.destroy())),n=o.index,s.updateParallelArrays(o,n),c.data[n]=y(c.data[n],!0)||y(e,!0)?o.options:v(e,c.data[n]),s.isDirty=s.isDirtyData=!0,!s.fixedBox&&s.hasCartesianSeries&&(l.isDirtyBox=!0),"point"===c.legendType&&(l.isDirtyLegend=!0),t&&l.redraw(i)}t=v(t,!0),!1===r?u():o.firePointEvent("update",{options:e},u)}remove(e,t){this.series.removePoint(this.series.data.indexOf(this),e,t)}select(e,t){let i=this,r=i.series,n=r.chart;e=v(e,!i.selected),this.selectedStaging=e,i.firePointEvent(e?"select":"unselect",{accumulate:t},(function(){i.selected=i.options.selected=e,r.options.data[r.data.indexOf(i)]=i.options,i.setState(e&&"select"),t||n.getSelectedPoints().forEach((function(e){let t=e.series;e.selected&&e!==i&&(e.selected=e.options.selected=!1,t.options.data[t.data.indexOf(e)]=e.options,e.setState(n.hoverPoints&&t.options.inactiveOtherPoints?"inactive":""),e.firePointEvent("unselect"))}))})),delete this.selectedStaging}onMouseOver(e){let{inverted:t,pointer:i}=this.series.chart;i&&(e=e?i.normalize(e):i.getChartCoordinatesFromPoint(this,t),i.runPointActions(e,this))}onMouseOut(){let e=this.series.chart;this.firePointEvent("mouseOut"),this.series.options.inactiveOtherPoints||(e.hoverPoints||[]).forEach((function(e){e.setState()})),e.hoverPoints=e.hoverPoint=null}manageEvent(e){let t=_(this.series.options.point,this.options),i=t.events?.[e];!m(i)||this.hcEvents?.[e]&&-1!==this.hcEvents?.[e]?.map((e=>e.fn)).indexOf(i)?this.importedUserEvent&&!i&&this.hcEvents?.[e]&&(b(this,e),delete this.hcEvents[e],Object.keys(this.hcEvents)||delete this.importedUserEvent):(this.importedUserEvent?.(),this.importedUserEvent=l(this,e,i))}setState(t,i){let r,n,o,a,l=this.series,c=this.state,u=l.options.states[t||"normal"]||{},p=s.plotOptions[l.type].marker&&l.options.marker,f=p&&!1===p.enabled,m=p&&p.states&&p.states[t||"normal"]||{},y=!1===m.enabled,_=this.marker||{},x=l.chart,b=p&&l.markerAttribs,w=l.halo,S=l.stateMarkerGraphic;if((t=t||"")===this.state&&!i||this.selected&&"select"!==t||!1===u.enabled||t&&(y||f&&!1===m.enabled)||t&&_.states&&_.states[t]&&!1===_.states[t].enabled)return;if(this.state=t,b&&(r=l.markerAttribs(this,t)),this.graphic&&!this.hasMockGraphic){if(c&&this.graphic.removeClass("highcharts-point-"+c),t&&this.graphic.addClass("highcharts-point-"+t),!x.styledMode){n=l.pointAttribs(this,t),o=v(x.options.chart.animation,u.animation);let e=n.opacity;l.options.inactiveOtherPoints&&g(e)&&(this.dataLabels||[]).forEach((function(t){t&&!t.hasClass("highcharts-data-label-hidden")&&(t.animate({opacity:e},o),t.connector&&t.connector.animate({opacity:e},o))})),this.graphic.animate(n,o)}r&&this.graphic.animate(r,v(x.options.chart.animation,m.animation,p.animation)),S&&S.hide()}else t&&m&&(a=_.symbol||l.symbol,S&&S.currentSymbol!==a&&(S=S.destroy()),r&&(S?S[i?"animate":"attr"]({x:r.x,y:r.y}):a&&(l.stateMarkerGraphic=S=x.renderer.symbol(a,r.x,r.y,r.width,r.height).add(l.markerGroup),S.currentSymbol=a)),!x.styledMode&&S&&"inactive"!==this.state&&S.attr(l.pointAttribs(this,t))),S&&(S[t&&this.isInside?"show":"hide"](),S.element.point=this,S.addClass(this.getClassName(),!0));let T=u.halo,M=this.graphic||S,A=M&&M.visibility||"inherit";T&&T.size&&M&&"hidden"!==A&&!this.isCluster?(w||(l.halo=w=x.renderer.path().add(M.parentGroup)),w.show()[i?"animate":"attr"]({d:this.haloPath(T.size)}),w.attr({class:"highcharts-halo highcharts-color-"+v(this.colorIndex,l.colorIndex)+(this.className?" "+this.className:""),visibility:A,zIndex:-1}),w.point=this,x.styledMode||w.attr(h({fill:this.color||l.color,"fill-opacity":T.opacity},e.filterUserAttributes(T.attributes||{})))):w?.point?.haloPath&&!w.point.destroyed&&w.animate({d:w.point.haloPath(0)},null,w.hide),d(this,"afterSetState",{state:t})}haloPath(e){let t=this.pos();return t?this.series.chart.renderer.symbols.circle(c(t[0],1)-e,t[1]-e,2*e,2*e):[]}}return S})),i(t,"Core/Pointer.js",[t["Core/Color/Color.js"],t["Core/Globals.js"],t["Core/Utilities.js"]],(function(e,t,i){var r;let{parse:n}=e,{charts:o,composed:s,isTouchDevice:a}=t,{addEvent:l,attr:c,css:u,extend:h,find:d,fireEvent:p,isNumber:f,isObject:m,objectEach:g,offset:y,pick:_,pushUnique:v,splat:x}=i;class b{applyInactiveState(e){let t,i=[];(e||[]).forEach((function(e){t=e.series,i.push(t),t.linkedParent&&i.push(t.linkedParent),t.linkedSeries&&(i=i.concat(t.linkedSeries)),t.navigatorSeries&&i.push(t.navigatorSeries)})),this.chart.series.forEach((function(e){-1===i.indexOf(e)?e.setState("inactive",!0):e.options.inactiveOtherPoints&&e.setAllPointsToState("inactive")}))}destroy(){let e=this;this.eventsToUnbind.forEach((e=>e())),this.eventsToUnbind=[],!t.chartCount&&(b.unbindDocumentMouseUp&&b.unbindDocumentMouseUp.forEach((e=>e())),b.unbindDocumentTouchEnd&&(b.unbindDocumentTouchEnd=b.unbindDocumentTouchEnd())),clearInterval(e.tooltipTimeout),g(e,(function(t,i){e[i]=void 0}))}getSelectionMarkerAttrs(e,t){let i={args:{chartX:e,chartY:t},attrs:{},shapeType:"rect"};return p(this,"getSelectionMarkerAttrs",i,(i=>{let r,{chart:n,zoomHor:o,zoomVert:s}=this,{mouseDownX:a=0,mouseDownY:l=0}=n,c=i.attrs;c.x=n.plotLeft,c.y=n.plotTop,c.width=o?1:n.plotWidth,c.height=s?1:n.plotHeight,o&&(r=e-a,c.width=Math.max(1,Math.abs(r)),c.x=(r>0?0:r)+a),s&&(r=t-l,c.height=Math.max(1,Math.abs(r)),c.y=(r>0?0:r)+l)})),i}drag(e){let t,{chart:i}=this,{mouseDownX:r=0,mouseDownY:o=0}=i,{panning:s,panKey:a,selectionMarkerFill:l}=i.options.chart,c=i.plotLeft,u=i.plotTop,h=i.plotWidth,d=i.plotHeight,p=m(s)?s.enabled:s,f=a&&e[`${a}Key`],g=e.chartX,y=e.chartY,_=this.selectionMarker;if((!_||!_.touch)&&(g<c?g=c:g>c+h&&(g=c+h),y<u?y=u:y>u+d&&(y=u+d),this.hasDragged=Math.sqrt(Math.pow(r-g,2)+Math.pow(o-y,2)),this.hasDragged>10)){t=i.isInsidePlot(r-c,o-u,{visiblePlotOnly:!0});let{shapeType:a,attrs:h}=this.getSelectionMarkerAttrs(g,y);(i.hasCartesianSeries||i.mapView)&&this.hasZoom&&t&&!f&&!_&&(this.selectionMarker=_=i.renderer[a](),_.attr({class:"highcharts-selection-marker",zIndex:7}).add(),i.styledMode||_.attr({fill:l||n("#334eff").setOpacity(.25).get()})),_&&_.attr(h),t&&!_&&p&&i.pan(e,s)}}dragStart(e){let t=this.chart;t.mouseIsDown=e.type,t.cancelClick=!1,t.mouseDownX=e.chartX,t.mouseDownY=e.chartY}getSelectionBox(e){let t={args:{marker:e},result:e.getBBox()};return p(this,"getSelectionBox",t),t.result}drop(e){let t,{chart:i,selectionMarker:r}=this;for(let n of i.axes)n.isPanning&&(n.isPanning=!1,(n.options.startOnTick||n.options.endOnTick||n.series.some((e=>e.boosted)))&&(n.forceRedraw=!0,n.setExtremes(n.userMin,n.userMax,!1),t=!0));if(t&&i.redraw(),r&&e){if(this.hasDragged){let t=this.getSelectionBox(r);i.transform({axes:i.axes.filter((e=>e.zoomEnabled&&("xAxis"===e.coll&&this.zoomX||"yAxis"===e.coll&&this.zoomY))),selection:{originalEvent:e,xAxis:[],yAxis:[],...t},from:t})}f(i.index)&&(this.selectionMarker=r.destroy())}i&&f(i.index)&&(u(i.container,{cursor:i._cursor}),i.cancelClick=this.hasDragged>10,i.mouseIsDown=!1,this.hasDragged=0,this.pinchDown=[])}findNearestKDPoint(e,t,i){let r;return e.forEach((function(e){let n=!(e.noSharedTooltip&&t)&&0>e.options.findNearestPointBy.indexOf("y"),o=e.searchPoint(i,n);m(o,!0)&&o.series&&(!m(r,!0)||function(e,i){let r=e.distX-i.distX,n=e.dist-i.dist,o=i.series.group?.zIndex-e.series.group?.zIndex;return 0!==r&&t?r:0!==n?n:0!==o?o:e.series.index>i.series.index?-1:1}(r,o)>0)&&(r=o)})),r}getChartCoordinatesFromPoint(e,t){let{xAxis:i,yAxis:r}=e.series,n=e.shapeArgs;if(i&&r){let o=e.clientX??e.plotX??0,s=e.plotY||0;return e.isNode&&n&&f(n.x)&&f(n.y)&&(o=n.x,s=n.y),t?{chartX:r.len+r.pos-s,chartY:i.len+i.pos-o}:{chartX:o+i.pos,chartY:s+r.pos}}if(n&&n.x&&n.y)return{chartX:n.x,chartY:n.y}}getChartPosition(){if(this.chartPosition)return this.chartPosition;let{container:e}=this.chart,t=y(e);this.chartPosition={left:t.left,top:t.top,scaleX:1,scaleY:1};let{offsetHeight:i,offsetWidth:r}=e;return r>2&&i>2&&(this.chartPosition.scaleX=t.width/r,this.chartPosition.scaleY=t.height/i),this.chartPosition}getCoordinates(e){let t={xAxis:[],yAxis:[]};for(let i of this.chart.axes)t[i.isXAxis?"xAxis":"yAxis"].push({axis:i,value:i.toValue(e[i.horiz?"chartX":"chartY"])});return t}getHoverData(e,t,i,r,n,o){let s,a=[],l=function(e){return e.visible&&!(!n&&e.directTouch)&&_(e.options.enableMouseTracking,!0)},c=t,u={chartX:o?o.chartX:void 0,chartY:o?o.chartY:void 0,shared:n};p(this,"beforeGetHoverData",u),s=c&&!c.stickyTracking?[c]:i.filter((e=>e.stickyTracking&&(u.filter||l)(e)));let h=r&&e||!o?e:this.findNearestKDPoint(s,n,o);return c=h&&h.series,h&&(n&&!c.noSharedTooltip?(s=i.filter((function(e){return u.filter?u.filter(e):l(e)&&!e.noSharedTooltip}))).forEach((function(e){let t=d(e.points,(function(e){return e.x===h.x&&!e.isNull}));m(t)&&(e.boosted&&e.boost&&(t=e.boost.getPoint(t)),a.push(t))})):a.push(h)),p(this,"afterGetHoverData",u={hoverPoint:h}),{hoverPoint:u.hoverPoint,hoverSeries:c,hoverPoints:a}}getPointFromEvent(e){let t,i=e.target;for(;i&&!t;)t=i.point,i=i.parentNode;return t}onTrackerMouseOut(e){let t=this.chart,i=e.relatedTarget,r=t.hoverSeries;this.isDirectTouch=!1,!r||!i||r.stickyTracking||this.inClass(i,"highcharts-tooltip")||this.inClass(i,"highcharts-series-"+r.index)&&this.inClass(i,"highcharts-tracker")||r.onMouseOut()}inClass(e,t){let i,r=e;for(;r;){if(i=c(r,"class")){if(-1!==i.indexOf(t))return!0;if(-1!==i.indexOf("highcharts-container"))return!1}r=r.parentElement}}constructor(e,t){this.hasDragged=0,this.pointerCaptureEventsToUnbind=[],this.eventsToUnbind=[],this.options=t,this.chart=e,this.runChartClick=!!t.chart.events?.click,this.pinchDown=[],this.setDOMEvents(),p(this,"afterInit")}normalize(e,t){let i=e.touches,r=i?i.length?i.item(0):_(i.changedTouches,e.changedTouches)[0]:e;t||(t=this.getChartPosition());let n=r.pageX-t.left,o=r.pageY-t.top;return h(e,{chartX:Math.round(n/=t.scaleX),chartY:Math.round(o/=t.scaleY)})}onContainerClick(e){let t=this.chart,i=t.hoverPoint,r=this.normalize(e),n=t.plotLeft,o=t.plotTop;!t.cancelClick&&(i&&this.inClass(r.target,"highcharts-tracker")?(p(i.series,"click",h(r,{point:i})),t.hoverPoint&&i.firePointEvent("click",r)):(h(r,this.getCoordinates(r)),t.isInsidePlot(r.chartX-n,r.chartY-o,{visiblePlotOnly:!0})&&p(t,"click",r)))}onContainerMouseDown(e){let i=1==(1&(e.buttons||e.button));e=this.normalize(e),t.isFirefox&&0!==e.button&&this.onContainerMouseMove(e),(void 0===e.button||i)&&(this.zoomOption(e),i&&e.preventDefault?.(),this.dragStart(e))}onContainerMouseLeave(e){let{pointer:t}=o[_(b.hoverChartIndex,-1)]||{};e=this.normalize(e),this.onContainerMouseMove(e),t&&!this.inClass(e.relatedTarget,"highcharts-tooltip")&&(t.reset(),t.chartPosition=void 0)}onContainerMouseEnter(){delete this.chartPosition}onContainerMouseMove(e){let t=this.chart,i=t.tooltip,r=this.normalize(e);this.setHoverChartIndex(e),("mousedown"===t.mouseIsDown||this.touchSelect(r))&&this.drag(r),!t.openMenu&&(this.inClass(r.target,"highcharts-tracker")||t.isInsidePlot(r.chartX-t.plotLeft,r.chartY-t.plotTop,{visiblePlotOnly:!0}))&&(!i||!i.shouldStickOnContact(r))&&(this.inClass(r.target,"highcharts-no-tooltip")?this.reset(!1,0):this.runPointActions(r))}onDocumentTouchEnd(e){this.onDocumentMouseUp(e)}onContainerTouchMove(e){this.touchSelect(e)?this.onContainerMouseMove(e):this.touch(e)}onContainerTouchStart(e){this.touchSelect(e)?this.onContainerMouseDown(e):(this.zoomOption(e),this.touch(e,!0))}onDocumentMouseMove(e){let t=this.chart,i=t.tooltip,r=this.chartPosition,n=this.normalize(e,r);!r||t.isInsidePlot(n.chartX-t.plotLeft,n.chartY-t.plotTop,{visiblePlotOnly:!0})||i&&i.shouldStickOnContact(n)||n.target!==t.container.ownerDocument&&this.inClass(n.target,"highcharts-tracker")||this.reset()}onDocumentMouseUp(e){o[_(b.hoverChartIndex,-1)]?.pointer?.drop(e)}pinch(e){let t=this,{chart:i,hasZoom:r,lastTouches:n}=t,o=[].map.call(e.touches||[],(e=>t.normalize(e))),s=o.length,a=1===s&&(t.inClass(e.target,"highcharts-tracker")&&i.runTrackerClick||t.runChartClick),l=i.tooltip,c=1===s&&_(l?.options.followTouchMove,!0);s>1?t.initiated=!0:c&&(t.initiated=!1),r&&t.initiated&&!a&&!1!==e.cancelable&&e.preventDefault(),"touchstart"===e.type?(t.pinchDown=o,t.res=!0,i.mouseDownX=e.chartX):c?this.runPointActions(t.normalize(e)):n&&(p(i,"touchpan",{originalEvent:e,touches:o},(()=>{let t=e=>{let t=e[0],i=e[1]||t;return{x:t.chartX,y:t.chartY,width:i.chartX-t.chartX,height:i.chartY-t.chartY}};i.transform({axes:i.axes.filter((e=>e.zoomEnabled&&(this.zoomHor&&e.horiz||this.zoomVert&&!e.horiz))),to:t(o),from:t(n),trigger:e.type})})),t.res&&(t.res=!1,this.reset(!1,0))),t.lastTouches=o}reset(e,t){let i=this.chart,r=i.hoverSeries,n=i.hoverPoint,o=i.hoverPoints,s=i.tooltip,a=s&&s.shared?o:n;e&&a&&x(a).forEach((function(t){t.series.isCartesian&&void 0===t.plotX&&(e=!1)})),e?s&&a&&x(a).length&&(s.refresh(a),s.shared&&o?o.forEach((function(e){e.setState(e.state,!0),e.series.isCartesian&&(e.series.xAxis.crosshair&&e.series.xAxis.drawCrosshair(null,e),e.series.yAxis.crosshair&&e.series.yAxis.drawCrosshair(null,e))})):n&&(n.setState(n.state,!0),i.axes.forEach((function(e){e.crosshair&&n.series[e.coll]===e&&e.drawCrosshair(null,n)})))):(n&&n.onMouseOut(),o&&o.forEach((function(e){e.setState()})),r&&r.onMouseOut(),s&&s.hide(t),this.unDocMouseMove&&(this.unDocMouseMove=this.unDocMouseMove()),i.axes.forEach((function(e){e.hideCrosshair()})),i.hoverPoints=i.hoverPoint=void 0)}runPointActions(e,t,i){let r=this.chart,n=r.series,s=r.tooltip&&r.tooltip.options.enabled?r.tooltip:void 0,a=!!s&&s.shared,c=t||r.hoverPoint,u=c&&c.series||r.hoverSeries,h=(!e||"touchmove"!==e.type)&&(!!t||u&&u.directTouch&&this.isDirectTouch),p=this.getHoverData(c,u,n,h,a,e);c=p.hoverPoint,u=p.hoverSeries;let f=p.hoverPoints,m=u&&u.tooltipOptions.followPointer&&!u.tooltipOptions.split,g=a&&u&&!u.noSharedTooltip;if(c&&(i||c!==r.hoverPoint||s&&s.isHidden)){if((r.hoverPoints||[]).forEach((function(e){-1===f.indexOf(e)&&e.setState()})),r.hoverSeries!==u&&u.onMouseOver(),this.applyInactiveState(f),(f||[]).forEach((function(e){e.setState("hover")})),r.hoverPoint&&r.hoverPoint.firePointEvent("mouseOut"),!c.series)return;r.hoverPoints=f,r.hoverPoint=c,c.firePointEvent("mouseOver",void 0,(()=>{s&&c&&s.refresh(g?f:c,e)}))}else if(m&&s&&!s.isHidden){let t=s.getAnchor([{}],e);r.isInsidePlot(t[0],t[1],{visiblePlotOnly:!0})&&s.updatePosition({plotX:t[0],plotY:t[1]})}this.unDocMouseMove||(this.unDocMouseMove=l(r.container.ownerDocument,"mousemove",(e=>o[b.hoverChartIndex??-1]?.pointer?.onDocumentMouseMove(e))),this.eventsToUnbind.push(this.unDocMouseMove)),r.axes.forEach((function(t){let i,n=_((t.crosshair||{}).snap,!0);!n||(i=r.hoverPoint)&&i.series[t.coll]===t||(i=d(f,(e=>e.series&&e.series[t.coll]===t))),i||!n?t.drawCrosshair(e,i):t.hideCrosshair()}))}setDOMEvents(){let e=this.chart.container,t=e.ownerDocument;e.onmousedown=this.onContainerMouseDown.bind(this),e.onmousemove=this.onContainerMouseMove.bind(this),e.onclick=this.onContainerClick.bind(this),this.eventsToUnbind.push(l(e,"mouseenter",this.onContainerMouseEnter.bind(this)),l(e,"mouseleave",this.onContainerMouseLeave.bind(this))),b.unbindDocumentMouseUp||(b.unbindDocumentMouseUp=[]),b.unbindDocumentMouseUp.push(l(t,"mouseup",this.onDocumentMouseUp.bind(this)));let i=this.chart.renderTo.parentElement;for(;i&&"BODY"!==i.tagName;)this.eventsToUnbind.push(l(i,"scroll",(()=>{delete this.chartPosition}))),i=i.parentElement;this.eventsToUnbind.push(l(e,"touchstart",this.onContainerTouchStart.bind(this),{passive:!1}),l(e,"touchmove",this.onContainerTouchMove.bind(this),{passive:!1})),b.unbindDocumentTouchEnd||(b.unbindDocumentTouchEnd=l(t,"touchend",this.onDocumentTouchEnd.bind(this),{passive:!1})),this.setPointerCapture(),l(this.chart,"redraw",this.setPointerCapture.bind(this))}setPointerCapture(){if(!a)return;let e=this.pointerCaptureEventsToUnbind,t=this.chart,i=t.container,r=_(t.options.tooltip?.followTouchMove,!0)&&t.series.some((e=>e.options.findNearestPointBy.indexOf("y")>-1));!this.hasPointerCapture&&r?(e.push(l(i,"pointerdown",(e=>{e.target?.hasPointerCapture(e.pointerId)&&e.target?.releasePointerCapture(e.pointerId)})),l(i,"pointermove",(e=>{t.pointer?.getPointFromEvent(e)?.onMouseOver(e)}))),t.styledMode||u(i,{"touch-action":"none"}),i.className+=" highcharts-no-touch-action",this.hasPointerCapture=!0):this.hasPointerCapture&&!r&&(e.forEach((e=>e())),e.length=0,t.styledMode||u(i,{"touch-action":_(t.options.chart.style?.["touch-action"],"manipulation")}),i.className=i.className.replace(" highcharts-no-touch-action",""),this.hasPointerCapture=!1)}setHoverChartIndex(e){let i=this.chart,r=t.charts[_(b.hoverChartIndex,-1)];if(r&&r!==i){let t={relatedTarget:i.container};e&&!e?.relatedTarget&&(e={...t,...e}),r.pointer?.onContainerMouseLeave(e||t)}r&&r.mouseIsDown||(b.hoverChartIndex=i.index)}touch(e,t){let i,{chart:r,pinchDown:n=[]}=this;this.setHoverChartIndex(),1===(e=this.normalize(e)).touches.length?r.isInsidePlot(e.chartX-r.plotLeft,e.chartY-r.plotTop,{visiblePlotOnly:!0})&&!r.openMenu?(t&&this.runPointActions(e),"touchmove"===e.type&&(i=!!n[0]&&Math.pow(n[0].chartX-e.chartX,2)+Math.pow(n[0].chartY-e.chartY,2)>=16),_(i,!0)&&this.pinch(e)):t&&this.reset():2===e.touches.length&&this.pinch(e)}touchSelect(e){return!(!this.chart.zooming.singleTouch||!e.touches||1!==e.touches.length)}zoomOption(e){let t,i,r=this.chart,n=r.inverted,o=r.zooming.type||"";/touch/.test(e.type)&&(o=_(r.zooming.pinchType,o)),this.zoomX=t=/x/.test(o),this.zoomY=i=/y/.test(o),this.zoomHor=t&&!n||i&&n,this.zoomVert=i&&!n||t&&n,this.hasZoom=t||i}}return(r=b||(b={})).compose=function(e){v(s,"Core.Pointer")&&l(e,"beforeRender",(function(){this.pointer=new r(this,this.options)}))},b})),i(t,"Core/Legend/LegendSymbol.js",[t["Core/Utilities.js"]],(function(e){var t;let{extend:i,merge:r,pick:n}=e;return function(e){function t(e,t,o){let s,a=this.legendItem=this.legendItem||{},{chart:l,options:c}=this,{baseline:u=0,symbolWidth:h,symbolHeight:d}=e,p=this.symbol||"circle",f=d/2,m=l.renderer,g=a.group,y=u-Math.round((e.fontMetrics?.b||d)*(o?.4:.3)),_={},v=c.marker,x=0;if(l.styledMode||(_["stroke-width"]=Math.min(c.lineWidth||0,24),c.dashStyle?_.dashstyle=c.dashStyle:"square"===c.linecap||(_["stroke-linecap"]="round")),a.line=m.path().addClass("highcharts-graph").attr(_).add(g),o&&(a.area=m.path().addClass("highcharts-area").add(g)),_["stroke-linecap"]&&(x=Math.min(a.line.strokeWidth(),h)/2),h){let e=[["M",x,y],["L",h-x,y]];a.line.attr({d:e}),a.area?.attr({d:[...e,["L",h-x,u],["L",x,u]]})}if(v&&!1!==v.enabled&&h){let e=Math.min(n(v.radius,f),f);0===p.indexOf("url")&&(v=r(v,{width:d,height:d}),e=0),a.symbol=s=m.symbol(p,h/2-e,y-e,2*e,2*e,i({context:"legend"},v)).addClass("highcharts-point").add(g),s.isMarker=!0}}e.areaMarker=function(e,i){t.call(this,e,i,!0)},e.lineMarker=t,e.rectangle=function(e,t){let i=t.legendItem||{},r=e.options,o=e.symbolHeight,s=r.squareSymbol,a=s?o:e.symbolWidth;i.symbol=this.chart.renderer.rect(s?(e.symbolWidth-o)/2:0,e.baseline-o+1,a,o,n(e.options.symbolRadius,o/2)).addClass("highcharts-point").attr({zIndex:3}).add(i.group)}}(t||(t={})),t})),i(t,"Core/Series/SeriesDefaults.js",[],(function(){return{lineWidth:2,allowPointSelect:!1,crisp:!0,showCheckbox:!1,animation:{duration:1e3},enableMouseTracking:!0,events:{},marker:{enabledThreshold:2,lineColor:"#ffffff",lineWidth:0,radius:4,states:{normal:{animation:!0},hover:{animation:{duration:150},enabled:!0,radiusPlus:2,lineWidthPlus:1},select:{fillColor:"#cccccc",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{animation:{},align:"center",borderWidth:0,defer:!0,formatter:function(){let{numberFormatter:e}=this.series.chart;return"number"!=typeof this.y?"":e(this.y,-1)},padding:5,style:{fontSize:"0.7em",fontWeight:"bold",color:"contrast",textOutline:"1px contrast"},verticalAlign:"bottom",x:0,y:0},cropThreshold:300,opacity:1,pointRange:0,softThreshold:!0,states:{normal:{animation:!0},hover:{animation:{duration:150},lineWidthPlus:1,marker:{},halo:{size:10,opacity:.25}},select:{animation:{duration:0}},inactive:{animation:{duration:150},opacity:.2}},stickyTracking:!0,turboThreshold:1e3,findNearestPointBy:"x"}})),i(t,"Core/Series/SeriesRegistry.js",[t["Core/Globals.js"],t["Core/Defaults.js"],t["Core/Series/Point.js"],t["Core/Utilities.js"]],(function(e,t,i,r){var n;let{defaultOptions:o}=t,{extend:s,extendClass:a,merge:l}=r;return function(t){function r(e,r){let n=o.plotOptions||{},s=r.defaultOptions,a=r.prototype;return a.type=e,a.pointClass||(a.pointClass=i),!t.seriesTypes[e]&&(s&&(n[e]=s),t.seriesTypes[e]=r,!0)}t.seriesTypes=e.seriesTypes,t.registerSeriesType=r,t.seriesType=function(e,n,c,u,h){let d=o.plotOptions||{};if(n=n||"",d[e]=l(d[n],c),delete t.seriesTypes[e],r(e,a(t.seriesTypes[n]||function(){},u)),t.seriesTypes[e].prototype.type=e,h){class r extends i{}s(r.prototype,h),t.seriesTypes[e].prototype.pointClass=r}return t.seriesTypes[e]}}(n||(n={})),n})),i(t,"Core/Series/Series.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Defaults.js"],t["Core/Foundation.js"],t["Core/Globals.js"],t["Core/Legend/LegendSymbol.js"],t["Core/Series/Point.js"],t["Core/Series/SeriesDefaults.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Renderer/SVG/SVGElement.js"],t["Core/Utilities.js"]],(function(e,t,i,r,n,o,s,a,l,c){let{animObject:u,setAnimation:h}=e,{defaultOptions:d}=t,{registerEventOptions:p}=i,{svg:f,win:m}=r,{seriesTypes:g}=a,{arrayMax:y,arrayMin:_,clamp:v,correctFloat:x,crisp:b,defined:w,destroyObjectProperties:S,diffObjects:T,erase:M,error:A,extend:C,find:E,fireEvent:P,getClosestDistance:k,getNestedProperty:I,insertItem:D,isArray:L,isNumber:R,isString:z,merge:O,objectEach:F,pick:B,removeEvent:N,splat:j,syncTimeout:V}=c;class U{constructor(){this.zoneAxis="y"}init(e,t){let i;P(this,"init",{options:t});let r=this,n=e.series;this.eventsToUnbind=[],r.chart=e,r.options=r.setOptions(t);let o=r.options,s=!1!==o.visible;r.linkedSeries=[],r.bindAxes(),C(r,{name:o.name,state:"",visible:s,selected:!0===o.selected}),p(this,o);let a=o.events;(a&&a.click||o.point&&o.point.events&&o.point.events.click||o.allowPointSelect)&&(e.runTrackerClick=!0),r.getColor(),r.getSymbol(),r.parallelArrays.forEach((function(e){r[e+"Data"]||(r[e+"Data"]=[])})),r.isCartesian&&(e.hasCartesianSeries=!0),n.length&&(i=n[n.length-1]),r._i=B(i&&i._i,-1)+1,r.opacity=r.options.opacity,e.orderItems("series",D(this,n)),o.dataSorting&&o.dataSorting.enabled?r.setDataSortingOptions():r.points||r.data||r.setData(o.data,!1),P(this,"afterInit")}is(e){return g[e]&&this instanceof g[e]}bindAxes(){let e,t=this,i=t.options,r=t.chart;P(this,"bindAxes",null,(function(){(t.axisTypes||[]).forEach((function(n){(r[n]||[]).forEach((function(r){e=r.options,(B(i[n],0)===r.index||void 0!==i[n]&&i[n]===e.id)&&(D(t,r.series),t[n]=r,r.isDirty=!0)})),t[n]||t.optionalAxis===n||A(18,!0,r)}))})),P(this,"afterBindAxes")}updateParallelArrays(e,t,i){let r=e.series,n=R(t)?function(i){let n="y"===i&&r.toYData?r.toYData(e):e[i];r[i+"Data"][t]=n}:function(e){Array.prototype[t].apply(r[e+"Data"],i)};r.parallelArrays.forEach(n)}hasData(){return this.visible&&void 0!==this.dataMax&&void 0!==this.dataMin||this.visible&&this.yData&&this.yData.length>0}hasMarkerChanged(e,t){let i=e.marker,r=t.marker||{};return i&&(r.enabled&&!i.enabled||r.symbol!==i.symbol||r.height!==i.height||r.width!==i.width)}autoIncrement(e){let t,i,r=this.options,n=r.pointIntervalUnit,o=r.relativeXValue,s=this.chart.time,a=this.xIncrement;return a=B(a,r.pointStart,0),this.pointInterval=i=B(this.pointInterval,r.pointInterval,1),o&&R(e)&&(i*=e),n&&(t=new s.Date(a),"day"===n?s.set("Date",t,s.get("Date",t)+i):"month"===n?s.set("Month",t,s.get("Month",t)+i):"year"===n&&s.set("FullYear",t,s.get("FullYear",t)+i),i=t.getTime()-a),o&&R(e)?a+i:(this.xIncrement=a+i,a)}setDataSortingOptions(){let e=this.options;C(this,{requireSorting:!1,sorted:!1,enabledDataSorting:!0,allowDG:!1}),w(e.pointRange)||(e.pointRange=1)}setOptions(e){let t,i=this.chart,r=i.options.plotOptions,n=i.userOptions||{},o=O(e),s=i.styledMode,a={plotOptions:r,userOptions:o};P(this,"setOptions",a);let l=a.plotOptions[this.type],c=n.plotOptions||{},u=c.series||{},h=d.plotOptions[this.type]||{},p=c[this.type]||{};this.userOptions=a.userOptions;let f=O(l,r.series,p,o);this.tooltipOptions=O(d.tooltip,d.plotOptions.series?.tooltip,h?.tooltip,i.userOptions.tooltip,c.series?.tooltip,p.tooltip,o.tooltip),this.stickyTracking=B(o.stickyTracking,p.stickyTracking,u.stickyTracking,!!this.tooltipOptions.shared&&!this.noSharedTooltip||f.stickyTracking),null===l.marker&&delete f.marker,this.zoneAxis=f.zoneAxis||"y";let m=this.zones=(f.zones||[]).map((e=>({...e})));return(f.negativeColor||f.negativeFillColor)&&!f.zones&&(t={value:f[this.zoneAxis+"Threshold"]||f.threshold||0,className:"highcharts-negative"},s||(t.color=f.negativeColor,t.fillColor=f.negativeFillColor),m.push(t)),m.length&&w(m[m.length-1].value)&&m.push(s?{}:{color:this.color,fillColor:this.fillColor}),P(this,"afterSetOptions",{options:f}),f}getName(){return B(this.options.name,"Series "+(this.index+1))}getCyclic(e,t,i){let r,n,o=this.chart,s=`${e}Index`,a=`${e}Counter`,l=i?.length||o.options.chart.colorCount;!t&&(w(n=B("color"===e?this.options.colorIndex:void 0,this[s]))?r=n:(o.series.length||(o[a]=0),r=o[a]%l,o[a]+=1),i&&(t=i[r])),void 0!==r&&(this[s]=r),this[e]=t}getColor(){this.chart.styledMode?this.getCyclic("color"):this.options.colorByPoint?this.color="#cccccc":this.getCyclic("color",this.options.color||d.plotOptions[this.type].color,this.chart.options.colors)}getPointsCollection(){return(this.hasGroupedData?this.points:this.data)||[]}getSymbol(){let e=this.options.marker;this.getCyclic("symbol",e.symbol,this.chart.options.symbols)}findPointIndex(e,t){let i,r,n,s=e.id,a=e.x,l=this.points,c=this.options.dataSorting;if(s){let e=this.chart.get(s);e instanceof o&&(i=e)}else if(this.linkedParent||this.enabledDataSorting||this.options.relativeXValue){let t=t=>!t.touched&&t.index===e.index;if(c&&c.matchByName?t=t=>!t.touched&&t.name===e.name:this.options.relativeXValue&&(t=t=>!t.touched&&t.options.x===e.x),!(i=E(l,t)))return}return i&&void 0!==(n=i&&i.index)&&(r=!0),void 0===n&&R(a)&&(n=this.xData.indexOf(a,t)),-1!==n&&void 0!==n&&this.cropped&&(n=n>=this.cropStart?n-this.cropStart:n),!r&&R(n)&&l[n]&&l[n].touched&&(n=void 0),n}updateData(e,t){let i,r,n,o,s=this.options,a=s.dataSorting,l=this.points,c=[],u=this.requireSorting,h=e.length===l.length,d=!0;if(this.xIncrement=null,e.forEach((function(e,t){let r,n=w(e)&&this.pointClass.prototype.optionsToObject.call({series:this},e)||{},d=n.x;n.id||R(d)?(-1===(r=this.findPointIndex(n,o))||void 0===r?c.push(e):l[r]&&e!==s.data[r]?(l[r].update(e,!1,null,!1),l[r].touched=!0,u&&(o=r+1)):l[r]&&(l[r].touched=!0),(!h||t!==r||a&&a.enabled||this.hasDerivedData)&&(i=!0)):c.push(e)}),this),i)for(r=l.length;r--;)(n=l[r])&&!n.touched&&n.remove&&n.remove(!1,t);else!h||a&&a.enabled?d=!1:(e.forEach((function(e,t){e===l[t].y||l[t].destroyed||l[t].update(e,!1,null,!1)})),c.length=0);return l.forEach((function(e){e&&(e.touched=!1)})),!!d&&(c.forEach((function(e){this.addPoint(e,!1,null,null,!1)}),this),null===this.xIncrement&&this.xData&&this.xData.length&&(this.xIncrement=y(this.xData),this.autoIncrement()),!0)}setData(e){let t,i,r,n,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,l=this,c=l.points,u=c&&c.length||0,h=l.options,d=l.chart,p=h.dataSorting,f=l.xAxis,m=h.turboThreshold,g=this.xData,y=this.yData,_=l.pointArrayMap,v=_&&_.length,x=h.keys,b=0,w=1;d.options.chart.allowMutatingData||(h.data&&delete l.options.data,l.userOptions.data&&delete l.userOptions.data,n=O(!0,e));let S=(e=n||e||[]).length;if(p&&p.enabled&&(e=this.sortData(e)),d.options.chart.allowMutatingData&&!1!==a&&S&&u&&!l.cropped&&!l.hasGroupedData&&l.visible&&!l.boosted&&(r=this.updateData(e,s)),!r){l.xIncrement=null,l.colorCounter=0,this.parallelArrays.forEach((function(e){l[e+"Data"].length=0}));let r=m&&S>m;if(r){let n=l.getFirstValidPoint(e),o=l.getFirstValidPoint(e,S-1,-1),s=e=>!(!L(e)||!x&&!R(e[0]));if(R(n)&&R(o))for(t=0;t<S;t++)g[t]=this.autoIncrement(),y[t]=e[t];else if(s(n)&&s(o))if(v)if(n.length===v)for(t=0;t<S;t++)g[t]=this.autoIncrement(),y[t]=e[t];else for(t=0;t<S;t++)i=e[t],g[t]=i[0],y[t]=i.slice(1,v+1);else if(x&&(b=x.indexOf("x"),w=x.indexOf("y"),b=b>=0?b:0,w=w>=0?w:1),1===n.length&&(w=0),b===w)for(t=0;t<S;t++)g[t]=this.autoIncrement(),y[t]=e[t][w];else for(t=0;t<S;t++)i=e[t],g[t]=i[b],y[t]=i[w];else r=!1}if(!r)for(t=0;t<S;t++)i={series:l},l.pointClass.prototype.applyOptions.apply(i,[e[t]]),l.updateParallelArrays(i,t);for(y&&z(y[0])&&A(14,!0,d),l.data=[],l.options.data=l.userOptions.data=e,t=u;t--;)c[t]?.destroy();f&&(f.minRange=f.userMinRange),l.isDirty=d.isDirtyBox=!0,l.isDirtyData=!!c,s=!1}"point"===h.legendType&&(this.processData(),this.generatePoints()),o&&d.redraw(s)}sortData(e){let t=this,i=t.options.dataSorting.sortKey||"y",r=function(e,t){return w(t)&&e.pointClass.prototype.optionsToObject.call({series:e},t)||{}};return e.forEach((function(i,n){e[n]=r(t,i),e[n].index=n}),this),e.concat().sort(((e,t)=>{let r=I(i,e),n=I(i,t);return n<r?-1:n>r?1:0})).forEach((function(e,t){e.x=t}),this),t.linkedSeries&&t.linkedSeries.forEach((function(t){let i=t.options,n=i.data;i.dataSorting&&i.dataSorting.enabled||!n||(n.forEach((function(i,o){n[o]=r(t,i),e[o]&&(n[o].x=e[o].x,n[o].index=o)})),t.setData(n,!1))})),e}getProcessedData(e){let t,i,r,n,o,s=this,a=s.xAxis,l=s.options.cropThreshold,c=a?.logarithmic,u=s.isCartesian,h=0,d=s.xData,p=s.yData,f=!1,m=d.length;a&&(n=(r=a.getExtremes()).min,o=r.max,f=!(!a.categories||a.names.length)),u&&s.sorted&&!e&&(!l||m>l||s.forceCrop)&&(d[m-1]<n||d[0]>o?(d=[],p=[]):s.yData&&(d[0]<n||d[m-1]>o)&&(d=(t=this.cropData(s.xData,s.yData,n,o)).xData,p=t.yData,h=t.start,i=!0));let g=k([c?d.map(c.log2lin):d],(()=>s.requireSorting&&!f&&A(15,!1,s.chart)));return{xData:d,yData:p,cropped:i,cropStart:h,closestPointRange:g}}processData(e){let t=this.xAxis;if(this.isCartesian&&!this.isDirty&&!t.isDirty&&!this.yAxis.isDirty&&!e)return!1;let i=this.getProcessedData();this.cropped=i.cropped,this.cropStart=i.cropStart,this.processedXData=i.xData,this.processedYData=i.yData,this.closestPointRange=this.basePointRange=i.closestPointRange,P(this,"afterProcessData")}cropData(e,t,i,r){let n,o,s=e.length,a=0,l=s;for(n=0;n<s;n++)if(e[n]>=i){a=Math.max(0,n-1);break}for(o=n;o<s;o++)if(e[o]>r){l=o+1;break}return{xData:e.slice(a,l),yData:t.slice(a,l),start:a,end:l}}generatePoints(){let e,t,i,r,n=this.options,o=this.processedData||n.data,s=this.processedXData,a=this.processedYData,l=this.pointClass,c=s.length,u=this.cropStart||0,h=this.hasGroupedData,d=n.keys,p=[],f=n.dataGrouping&&n.dataGrouping.groupAll?u:0,m=this.data;if(!m&&!h){let e=[];e.length=o.length,m=this.data=e}for(d&&h&&(this.options.keys=!1),r=0;r<c;r++)t=u+r,h?((i=new l(this,[s[r]].concat(j(a[r])))).dataGroup=this.groupMap[f+r],i.dataGroup.options&&(i.options=i.dataGroup.options,C(i,i.dataGroup.options),delete i.dataLabels)):(i=m[t])||void 0===o[t]||(m[t]=i=new l(this,o[t],s[r])),i&&(i.index=h?f+r:t,p[r]=i);if(this.options.keys=d,m&&(c!==(e=m.length)||h))for(r=0;r<e;r++)r!==u||h||(r+=c),m[r]&&(m[r].destroyElements(),m[r].plotX=void 0);this.data=m,this.points=p,P(this,"afterGeneratePoints")}getXExtremes(e){return{min:_(e),max:y(e)}}getExtremes(e,t){let i,r,n,o,s,a,l,c=this.xAxis,u=this.yAxis,h=[],d=this.requireSorting&&!this.is("column")?1:0,p=!!u&&u.positiveValuesOnly,f=t||this.getExtremesFromAll||this.options.getExtremesFromAll,{processedXData:m,processedYData:g}=this,v=0,x=0,b=0;if(this.cropped&&f){let e=this.getProcessedData(!0);m=e.xData,g=e.yData}let w=(e=e||this.stackedYData||g||[]).length,S=m||this.xData;for(c&&(v=(i=c.getExtremes()).min,x=i.max),a=0;a<w;a++)if(o=S[a],r=(R(s=e[a])||L(s))&&((R(s)?s>0:s.length)||!p),n=t||this.getExtremesFromAll||this.options.getExtremesFromAll||this.cropped||!c||(S[a+d]||o)>=v&&(S[a-d]||o)<=x,r&&n)if(l=s.length)for(;l--;)R(s[l])&&(h[b++]=s[l]);else h[b++]=s;let T={activeYData:h,dataMin:_(h),dataMax:y(h)};return P(this,"afterGetExtremes",{dataExtremes:T}),T}applyExtremes(){let e=this.getExtremes();return this.dataMin=e.dataMin,this.dataMax=e.dataMax,e}getFirstValidPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=e.length,n=t;for(;n>=0&&n<r;){if(w(e[n]))return e[n];n+=i}}translate(){this.processedXData||this.processData(),this.generatePoints();let e,t,i,r,n=this.options,o=n.stacking,s=this.xAxis,a=s.categories,l=this.enabledDataSorting,c=this.yAxis,u=this.points,h=u.length,d=this.pointPlacementToXValue(),p=!!d,f=n.threshold,m=n.startFromThreshold?f:0,g=Number.MAX_VALUE;function y(e){return v(e,-1e9,1e9)}for(e=0;e<h;e++){let n,h,_,v=u[e],b=v.x,S=v.y,T=v.low,M=o&&c.stacking?.stacks[(this.negStacks&&S<(m?0:f)?"-":"")+this.stackKey];t=s.translate(b,!1,!1,!1,!0,d),v.plotX=R(t)?x(y(t)):void 0,o&&this.visible&&M&&M[b]&&(r=this.getStackIndicator(r,b,this.index),!v.isNull&&r.key&&(_=(h=M[b]).points[r.key]),h&&L(_)&&(T=_[0],S=_[1],T===m&&r.key===M[b].base&&(T=B(R(f)?f:c.min)),c.positiveValuesOnly&&w(T)&&T<=0&&(T=void 0),v.total=v.stackTotal=B(h.total),v.percentage=w(v.y)&&h.total?v.y/h.total*100:void 0,v.stackY=S,this.irregularWidths||h.setOffset(this.pointXOffset||0,this.barW||0,void 0,void 0,void 0,this.xAxis))),v.yBottom=w(T)?y(c.translate(T,!1,!0,!1,!0)):void 0,this.dataModify&&(S=this.dataModify.modifyValue(S,e)),R(S)&&void 0!==v.plotX&&(n=R(n=c.translate(S,!1,!0,!1,!0))?y(n):void 0),v.plotY=n,v.isInside=this.isPointInside(v),v.clientX=p?x(s.translate(b,!1,!1,!1,!0,d)):t,v.negative=(v.y||0)<(f||0),v.category=B(a&&a[v.x],v.x),v.isNull||!1===v.visible||(void 0!==i&&(g=Math.min(g,Math.abs(t-i))),i=t),v.zone=this.zones.length?v.getZone():void 0,!v.graphic&&this.group&&l&&(v.isNew=!0)}this.closestPointRangePx=g,P(this,"afterTranslate")}getValidPoints(e,t,i){let r=this.chart;return(e||this.points||[]).filter((function(e){let{plotX:n,plotY:o}=e;return!(!(i||!e.isNull&&R(o))||t&&!r.isInsidePlot(n,o,{inverted:r.inverted}))&&!1!==e.visible}))}getClipBox(){let{chart:e,xAxis:t,yAxis:i}=this,{x:r,y:n,width:o,height:s}=O(e.clipBox);return t&&t.len!==e.plotSizeX&&(o=t.len),i&&i.len!==e.plotSizeY&&(s=i.len),e.inverted&&!this.invertible&&([o,s]=[s,o]),{x:r,y:n,width:o,height:s}}getSharedClipKey(){return this.sharedClipKey=(this.options.xAxis||0)+","+(this.options.yAxis||0),this.sharedClipKey}setClip(){let{chart:e,group:t,markerGroup:i}=this,r=e.sharedClips,n=e.renderer,o=this.getClipBox(),s=this.getSharedClipKey(),a=r[s];a?a.animate(o):r[s]=a=n.clipRect(o),t&&t.clip(!1===this.options.clip?void 0:a),i&&i.clip()}animate(e){let{chart:t,group:i,markerGroup:r}=this,n=t.inverted,o=u(this.options.animation),s=[this.getSharedClipKey(),o.duration,o.easing,o.defer].join(","),a=t.sharedClips[s],l=t.sharedClips[s+"m"];if(e&&i){let e=this.getClipBox();if(a)a.attr("height",e.height);else{e.width=0,n&&(e.x=t.plotHeight),a=t.renderer.clipRect(e),t.sharedClips[s]=a;let i={x:-99,y:-99,width:n?t.plotWidth+199:99,height:n?99:t.plotHeight+199};l=t.renderer.clipRect(i),t.sharedClips[s+"m"]=l}i.clip(a),r?.clip(l)}else if(a&&!a.hasClass("highcharts-animating")){let e=this.getClipBox(),i=o.step;(r?.element.childNodes.length||t.series.length>1)&&(o.step=function(e,t){i&&i.apply(t,arguments),"width"===t.prop&&l?.element&&l.attr(n?"height":"width",e+99)}),a.addClass("highcharts-animating").animate(e,o)}}afterAnimate(){this.setClip(),F(this.chart.sharedClips,((e,t,i)=>{e&&!this.chart.container.querySelector(`[clip-path="url(#${e.id})"]`)&&(e.destroy(),delete i[t])})),this.finishedAnimating=!0,P(this,"afterAnimate")}drawPoints(){let e,t,i,r,n,o,s,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.points,l=this.chart,c=l.styledMode,{colorAxis:u,options:h}=this,d=h.marker,p=this[this.specialGroup||"markerGroup"],f=this.xAxis,m=B(d.enabled,!f||!!f.isRadial||null,this.closestPointRangePx>=d.enabledThreshold*d.radius);if(!1!==d.enabled||this._hasPointMarkers)for(e=0;e<a.length;e++)if(r=(i=(t=a[e]).graphic)?"animate":"attr",n=t.marker||{},o=!!t.marker,(m&&void 0===n.enabled||n.enabled)&&!t.isNull&&!1!==t.visible){let e=B(n.symbol,this.symbol,"rect");s=this.markerAttribs(t,t.selected&&"select"),this.enabledDataSorting&&(t.startXPos=f.reversed?-(s.width||0):f.width);let a=!1!==t.isInside;if(!i&&a&&((s.width||0)>0||t.hasImage)&&(t.graphic=i=l.renderer.symbol(e,s.x,s.y,s.width,s.height,o?n:d).add(p),this.enabledDataSorting&&l.hasRendered&&(i.attr({x:t.startXPos}),r="animate")),i&&"animate"===r&&i[a?"show":"hide"](a).animate(s),i){let e=this.pointAttribs(t,c||!t.selected?void 0:"select");c?u&&i.css({fill:e.fill}):i[r](e)}i&&i.addClass(t.getClassName(),!0)}else i&&(t.graphic=i.destroy())}markerAttribs(e,t){let i,r,n=this.options,o=n.marker,s=e.marker||{},a=s.symbol||o.symbol,l={},c=B(s.radius,o&&o.radius);t&&(i=o.states[t],c=B((r=s.states&&s.states[t])&&r.radius,i&&i.radius,c&&c+(i&&i.radiusPlus||0))),e.hasImage=a&&0===a.indexOf("url"),e.hasImage&&(c=0);let u=e.pos();return R(c)&&u&&(n.crisp&&(u[0]=b(u[0],e.hasImage?0:"rect"===a?o?.lineWidth||0:1)),l.x=u[0]-c,l.y=u[1]-c),c&&(l.width=l.height=2*c),l}pointAttribs(e,t){let i,r,n,o,s=this.options.marker,a=e&&e.options,l=a&&a.marker||{},c=a&&a.color,u=e&&e.color,h=e&&e.zone&&e.zone.color,d=this.color,p=B(l.lineWidth,s.lineWidth),f=1;return d=c||h||u||d,n=l.fillColor||s.fillColor||d,o=l.lineColor||s.lineColor||d,t=t||"normal",i=s.states[t]||{},p=B((r=l.states&&l.states[t]||{}).lineWidth,i.lineWidth,p+B(r.lineWidthPlus,i.lineWidthPlus,0)),n=r.fillColor||i.fillColor||n,{stroke:o=r.lineColor||i.lineColor||o,"stroke-width":p,fill:n,opacity:f=B(r.opacity,i.opacity,f)}}destroy(e){let t,i,r,n=this,o=n.chart,s=/AppleWebKit\/533/.test(m.navigator.userAgent),a=n.data||[];for(P(n,"destroy",{keepEventsForUpdate:e}),this.removeEvents(e),(n.axisTypes||[]).forEach((function(e){(r=n[e])&&r.series&&(M(r.series,n),r.isDirty=r.forceRedraw=!0)})),n.legendItem&&n.chart.legend.destroyItem(n),t=a.length;t--;)(i=a[t])&&i.destroy&&i.destroy();for(let l of n.zones)S(l,void 0,!0);c.clearTimeout(n.animationTimeout),F(n,(function(e,t){e instanceof l&&!e.survive&&e[s&&"group"===t?"hide":"destroy"]()})),o.hoverSeries===n&&(o.hoverSeries=void 0),M(o.series,n),o.orderItems("series"),F(n,(function(t,i){e&&"hcEvents"===i||delete n[i]}))}applyZones(){let{area:e,chart:t,graph:i,zones:r,points:n,xAxis:o,yAxis:s,zoneAxis:a}=this,{inverted:l,renderer:c}=t,u=this[`${a}Axis`],{isXAxis:h,len:d=0}=u||{},p=(i?.strokeWidth()||0)/2+1,f=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;l&&(i=d-i);let{translated:r=0,lineClip:n}=e,o=i-r;n?.push(["L",t,Math.abs(o)<p?i-p*(o<=0?-1:1):r])};if(r.length&&(i||e)&&u&&R(u.min)){let t=u.getExtremes().max,p=e=>{e.forEach(((t,i)=>{("M"===t[0]||"L"===t[0])&&(e[i]=[t[0],h?d-t[1]:t[1],h?t[2]:d-t[2]])}))};if(r.forEach((e=>{e.lineClip=[],e.translated=v(u.toPixels(B(e.value,t),!0)||0,0,d)})),i&&!this.showLine&&i.hide(),e&&e.hide(),"y"===a&&n.length<o.len)for(let e of n){let{plotX:t,plotY:i,zone:n}=e,o=n&&r[r.indexOf(n)-1];n&&f(n,t,i),o&&f(o,t,i)}let m=[],g=u.toPixels(u.getExtremes().min,!0);r.forEach((t=>{let r=t.lineClip||[],n=Math.round(t.translated||0);o.reversed&&r.reverse();let{clip:a,simpleClip:u}=t,d=0,f=0,y=o.len,_=s.len;h?(d=n,y=g):(f=n,_=g);let v=[["M",d,f],["L",y,f],["L",y,_],["L",d,_],["Z"]],x=[v[0],...r,v[1],v[2],...m,v[3],v[4]];m=r.reverse(),g=n,l&&(p(x),e&&p(v)),a?(a.animate({d:x}),u?.animate({d:v})):(a=t.clip=c.path(x),e&&(u=t.simpleClip=c.path(v))),i&&t.graph?.clip(a),e&&t.area?.clip(u)}))}else this.visible&&(i&&i.show(),e&&e.show())}plotGroup(e,t,i,r,n){let o=this[e],s=!o,a={visibility:i,zIndex:r||.1};return w(this.opacity)&&!this.chart.styledMode&&"inactive"!==this.state&&(a.opacity=this.opacity),o||(this[e]=o=this.chart.renderer.g().add(n)),o.addClass("highcharts-"+t+" highcharts-series-"+this.index+" highcharts-"+this.type+"-series "+(w(this.colorIndex)?"highcharts-color-"+this.colorIndex+" ":"")+(this.options.className||"")+(o.hasClass("highcharts-tracker")?" highcharts-tracker":""),!0),o.attr(a)[s?"attr":"animate"](this.getPlotBox(t)),o}getPlotBox(e){let t=this.xAxis,i=this.yAxis,r=this.chart,n=r.inverted&&!r.polar&&t&&this.invertible&&"series"===e;return r.inverted&&(t=i,i=this.xAxis),{translateX:t?t.left:r.plotLeft,translateY:i?i.top:r.plotTop,rotation:n?90:0,rotationOriginX:n?(t.len-i.len)/2:0,rotationOriginY:n?(t.len+i.len)/2:0,scaleX:n?-1:1,scaleY:1}}removeEvents(e){let{eventsToUnbind:t}=this;e||N(this),t.length&&(t.forEach((e=>{e()})),t.length=0)}render(){let e=this,{chart:t,options:i,hasRendered:r}=e,n=u(i.animation),o=e.visible?"inherit":"hidden",s=i.zIndex,a=t.seriesGroup,l=e.finishedAnimating?0:n.duration;P(this,"render"),e.plotGroup("group","series",o,s,a),e.markerGroup=e.plotGroup("markerGroup","markers",o,s,a),!1!==i.clip&&e.setClip(),l&&e.animate?.(!0),e.drawGraph&&(e.drawGraph(),e.applyZones()),e.visible&&e.drawPoints(),e.drawDataLabels?.(),e.redrawPoints?.(),i.enableMouseTracking&&e.drawTracker?.(),l&&e.animate?.(),r||(l&&n.defer&&(l+=n.defer),e.animationTimeout=V((()=>{e.afterAnimate()}),l||0)),e.isDirty=!1,e.hasRendered=!0,P(e,"afterRender")}redraw(){let e=this.isDirty||this.isDirtyData;this.translate(),this.render(),e&&delete this.kdTree}reserveSpace(){return this.visible||!this.chart.options.chart.ignoreHiddenSeries}searchPoint(e,t){let{xAxis:i,yAxis:r}=this,n=this.chart.inverted;return this.searchKDTree({clientX:n?i.len-e.chartY+i.pos:e.chartX-i.pos,plotY:n?r.len-e.chartX+r.pos:e.chartY-r.pos},t,e)}buildKDTree(e){this.buildingKdTree=!0;let t=this,i=t.options.findNearestPointBy.indexOf("y")>-1?2:1;delete t.kdTree,V((function(){t.kdTree=function e(i,r,n){let o,s,a=i?.length;if(a)return o=t.kdAxisArray[r%n],i.sort(((e,t)=>(e[o]||0)-(t[o]||0))),{point:i[s=Math.floor(a/2)],left:e(i.slice(0,s),r+1,n),right:e(i.slice(s+1),r+1,n)}}(t.getValidPoints(void 0,!t.directTouch),i,i),t.buildingKdTree=!1}),t.options.kdNow||"touchstart"===e?.type?0:1)}searchKDTree(e,t,i){let r=this,[n,o]=this.kdAxisArray,s=t?"distX":"dist",a=(r.options.findNearestPointBy||"").indexOf("y")>-1?2:1,l=!!r.isBubble;if(this.kdTree||this.buildingKdTree||this.buildKDTree(i),this.kdTree)return function e(t,i,a,c){let u,h,d=i.point,p=r.kdAxisArray[a%c],f=d;!function(e,t){let i=e[n],r=t[n],s=w(i)&&w(r)?i-r:null,a=e[o],c=t[o],u=w(a)&&w(c)?a-c:0,h=l&&t.marker?.radius||0;t.dist=Math.sqrt((s&&s*s||0)+u*u)-h,t.distX=w(s)?Math.abs(s)-h:Number.MAX_VALUE}(t,d);let m=(t[p]||0)-(d[p]||0)+(l&&d.marker?.radius||0),g=m<0?"left":"right",y=m<0?"right":"left";return i[g]&&(f=(u=e(t,i[g],a+1,c))[s]<f[s]?u:d),i[y]&&Math.sqrt(m*m)<f[s]&&(f=(h=e(t,i[y],a+1,c))[s]<f[s]?h:f),f}(e,this.kdTree,a,a)}pointPlacementToXValue(){let{options:e,xAxis:t}=this,i=e.pointPlacement;return"between"===i&&(i=t.reversed?-.5:.5),R(i)?i*(e.pointRange||t.pointRange):0}isPointInside(e){let{chart:t,xAxis:i,yAxis:r}=this,{plotX:n=-1,plotY:o=-1}=e;return o>=0&&o<=(r?r.len:t.plotHeight)&&n>=0&&n<=(i?i.len:t.plotWidth)}drawTracker(){let e=this,t=e.options,i=t.trackByArea,r=[].concat((i?e.areaPath:e.graphPath)||[]),n=e.chart,o=n.pointer,s=n.renderer,a=n.options.tooltip?.snap||0,l=()=>{t.enableMouseTracking&&n.hoverSeries!==e&&e.onMouseOver()},c="rgba(192,192,192,"+(f?1e-4:.002)+")",u=e.tracker;u?u.attr({d:r}):e.graph&&(e.tracker=u=s.path(r).attr({visibility:e.visible?"inherit":"hidden",zIndex:2}).addClass(i?"highcharts-tracker-area":"highcharts-tracker-line").add(e.group),n.styledMode||u.attr({"stroke-linecap":"round","stroke-linejoin":"round",stroke:c,fill:i?c:"none","stroke-width":e.graph.strokeWidth()+(i?0:2*a)}),[e.tracker,e.markerGroup,e.dataLabelsGroup].forEach((e=>{e&&(e.addClass("highcharts-tracker").on("mouseover",l).on("mouseout",(e=>{o?.onTrackerMouseOut(e)})),t.cursor&&!n.styledMode&&e.css({cursor:t.cursor}),e.on("touchstart",l))}))),P(this,"afterDrawTracker")}addPoint(e,t,i,r,n){let o,s,a=this.options,l=this.data,c=this.chart,u=this.xAxis,h=u&&u.hasNames&&u.names,d=a.data,p=this.xData;t=B(t,!0);let f={series:this};this.pointClass.prototype.applyOptions.apply(f,[e]);let m=f.x;if(s=p.length,this.requireSorting&&m<p[s-1])for(o=!0;s&&p[s-1]>m;)s--;this.updateParallelArrays(f,"splice",[s,0,0]),this.updateParallelArrays(f,s),h&&f.name&&(h[m]=f.name),d.splice(s,0,e),(o||this.processedData)&&(this.data.splice(s,0,null),this.processData()),"point"===a.legendType&&this.generatePoints(),i&&(l[0]&&l[0].remove?l[0].remove(!1):(l.shift(),this.updateParallelArrays(f,"shift"),d.shift())),!1!==n&&P(this,"addPoint",{point:f}),this.isDirty=!0,this.isDirtyData=!0,t&&c.redraw(r)}removePoint(e,t,i){let r=this,n=r.data,o=n[e],s=r.points,a=r.chart,l=function(){s&&s.length===n.length&&s.splice(e,1),n.splice(e,1),r.options.data.splice(e,1),r.updateParallelArrays(o||{series:r},"splice",[e,1]),o&&o.destroy(),r.isDirty=!0,r.isDirtyData=!0,t&&a.redraw()};h(i,a),t=B(t,!0),o?o.firePointEvent("remove",null,l):l()}remove(e,t,i,r){let n=this,o=n.chart;function s(){n.destroy(r),o.isDirtyLegend=o.isDirtyBox=!0,o.linkSeries(r),B(e,!0)&&o.redraw(t)}!1!==i?P(n,"remove",null,s):s()}update(e,t){P(this,"update",{options:e=T(e,this.userOptions)});let i,r,n=this,o=n.chart,s=n.userOptions,a=n.initialType||n.type,l=o.options.plotOptions,c=g[a].prototype,u=n.finishedAnimating&&{animation:!1},h={},d=["colorIndex","eventOptions","navigatorSeries","symbolIndex","baseSeries"],p=e.type||s.type||o.options.chart.type,f=!(this.hasDerivedData||p&&p!==this.type||void 0!==e.pointStart||void 0!==e.pointInterval||void 0!==e.relativeXValue||e.joinBy||e.mapData||["dataGrouping","pointStart","pointInterval","pointIntervalUnit","keys"].some((e=>n.hasOptionChanged(e))));p=p||a,f&&(d.push("data","isDirtyData","isDirtyCanvas","points","processedData","processedXData","processedYData","xIncrement","cropped","_hasPointMarkers","hasDataLabels","nodes","layout","level","mapMap","mapData","minY","maxY","minX","maxX","transformGroups"),!1!==e.visible&&d.push("area","graph"),n.parallelArrays.forEach((function(e){d.push(e+"Data")})),e.data&&(e.dataSorting&&C(n.options.dataSorting,e.dataSorting),this.setData(e.data,!1))),e=O(s,{index:void 0===s.index?n.index:s.index,pointStart:l?.series?.pointStart??s.pointStart??n.xData?.[0]},!f&&{data:n.options.data},e,u),f&&e.data&&(e.data=n.options.data),(d=["group","markerGroup","dataLabelsGroup","transformGroup"].concat(d)).forEach((function(e){d[e]=n[e],delete n[e]}));let m=!1;if(g[p]){if(m=p!==n.type,n.remove(!1,!1,!1,!0),m)if(o.propFromSeries(),Object.setPrototypeOf)Object.setPrototypeOf(n,g[p].prototype);else{let e=Object.hasOwnProperty.call(n,"hcEvents")&&n.hcEvents;for(r in c)n[r]=void 0;C(n,g[p].prototype),e?n.hcEvents=e:delete n.hcEvents}}else A(17,!0,o,{missingModuleFor:p});if(d.forEach((function(e){n[e]=d[e]})),n.init(o,e),f&&this.points)for(let g of(!1===(i=n.options).visible?(h.graphic=1,h.dataLabel=1):(this.hasMarkerChanged(i,s)&&(h.graphic=1),n.hasDataLabels?.()||(h.dataLabel=1)),this.points))g&&g.series&&(g.resolveColor(),Object.keys(h).length&&g.destroyElements(h),!1===i.showInLegend&&g.legendItem&&o.legend.destroyItem(g));n.initialType=a,o.linkSeries(),o.setSortedData(),m&&n.linkedSeries.length&&(n.isDirtyData=!0),P(this,"afterUpdate"),B(t,!0)&&o.redraw(!!f&&void 0)}setName(e){this.name=this.options.name=this.userOptions.name=e,this.chart.isDirtyLegend=!0}hasOptionChanged(e){let t=this.chart,i=this.options[e],r=t.options.plotOptions,n=this.userOptions[e],o=B(r?.[this.type]?.[e],r?.series?.[e]);return n&&!w(o)?i!==n:i!==B(o,i)}onMouseOver(){let e=this.chart,t=e.hoverSeries,i=e.pointer;i?.setHoverChartIndex(),t&&t!==this&&t.onMouseOut(),this.options.events.mouseOver&&P(this,"mouseOver"),this.setState("hover"),e.hoverSeries=this}onMouseOut(){let e=this.options,t=this.chart,i=t.tooltip,r=t.hoverPoint;t.hoverSeries=null,r&&r.onMouseOut(),this&&e.events.mouseOut&&P(this,"mouseOut"),i&&!this.stickyTracking&&(!i.shared||this.noSharedTooltip)&&i.hide(),t.series.forEach((function(e){e.setState("",!0)}))}setState(e,t){let i=this,r=i.options,n=i.graph,o=r.inactiveOtherPoints,s=r.states,a=B(s[e||"normal"]&&s[e||"normal"].animation,i.chart.options.chart.animation),l=r.lineWidth,c=r.opacity;if(e=e||"",i.state!==e&&([i.group,i.markerGroup,i.dataLabelsGroup].forEach((function(t){t&&(i.state&&t.removeClass("highcharts-series-"+i.state),e&&t.addClass("highcharts-series-"+e))})),i.state=e,!i.chart.styledMode)){if(s[e]&&!1===s[e].enabled)return;if(e&&(l=s[e].lineWidth||l+(s[e].lineWidthPlus||0),c=B(s[e].opacity,c)),n&&!n.dashstyle&&R(l))for(let e of[n,...this.zones.map((e=>e.graph))])e?.animate({"stroke-width":l},a);o||[i.group,i.markerGroup,i.dataLabelsGroup,i.labelBySeries].forEach((function(e){e&&e.animate({opacity:c},a)}))}t&&o&&i.points&&i.setAllPointsToState(e||void 0)}setAllPointsToState(e){this.points.forEach((function(t){t.setState&&t.setState(e)}))}setVisible(e,t){let i=this,r=i.chart,n=r.options.chart.ignoreHiddenSeries,o=i.visible;i.visible=e=i.options.visible=i.userOptions.visible=void 0===e?!o:e;let s=e?"show":"hide";["group","dataLabelsGroup","markerGroup","tracker","tt"].forEach((e=>{i[e]?.[s]()})),(r.hoverSeries===i||r.hoverPoint?.series===i)&&i.onMouseOut(),i.legendItem&&r.legend.colorizeItem(i,e),i.isDirty=!0,i.options.stacking&&r.series.forEach((e=>{e.options.stacking&&e.visible&&(e.isDirty=!0)})),i.linkedSeries.forEach((t=>{t.setVisible(e,!1)})),n&&(r.isDirtyBox=!0),P(i,s),!1!==t&&r.redraw()}show(){this.setVisible(!0)}hide(){this.setVisible(!1)}select(e){this.selected=e=this.options.selected=void 0===e?!this.selected:e,this.checkbox&&(this.checkbox.checked=e),P(this,e?"select":"unselect")}shouldShowTooltip(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i.series=this,i.visiblePlotOnly=!0,this.chart.isInsidePlot(e,t,i)}drawLegendSymbol(e,t){n[this.options.legendSymbol||"rectangle"]?.call(this,e,t)}}return U.defaultOptions=s,U.types=a.seriesTypes,U.registerType=a.registerSeriesType,C(U.prototype,{axisTypes:["xAxis","yAxis"],coll:"series",colorCounter:0,directTouch:!1,invertible:!0,isCartesian:!0,kdAxisArray:["clientX","plotY"],parallelArrays:["x","y"],pointClass:o,requireSorting:!0,sorted:!0}),a.series=U,U})),i(t,"Core/Legend/Legend.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Foundation.js"],t["Core/Globals.js"],t["Core/Series/Series.js"],t["Core/Series/Point.js"],t["Core/Renderer/RendererUtilities.js"],t["Core/Templating.js"],t["Core/Utilities.js"]],(function(e,t,i,r,n,o,s,a){var l;let{animObject:c,setAnimation:u}=e,{registerEventOptions:h}=t,{composed:d,marginNames:p}=i,{distribute:f}=o,{format:m}=s,{addEvent:g,createElement:y,css:_,defined:v,discardElement:x,find:b,fireEvent:w,isNumber:S,merge:T,pick:M,pushUnique:A,relativeLength:C,stableSort:E,syncTimeout:P}=a;class k{constructor(e,t){this.allItems=[],this.initialItemY=0,this.itemHeight=0,this.itemMarginBottom=0,this.itemMarginTop=0,this.itemX=0,this.itemY=0,this.lastItemY=0,this.lastLineHeight=0,this.legendHeight=0,this.legendWidth=0,this.maxItemWidth=0,this.maxLegendWidth=0,this.offsetWidth=0,this.padding=0,this.pages=[],this.symbolHeight=0,this.symbolWidth=0,this.titleHeight=0,this.totalItemWidth=0,this.widthOption=0,this.chart=e,this.setOptions(t),t.enabled&&(this.render(),h(this,t),g(this.chart,"endResize",(function(){this.legend.positionCheckboxes()}))),g(this.chart,"render",(()=>{this.options.enabled&&this.proximate&&(this.proximatePositions(),this.positionItems())}))}setOptions(e){let t=M(e.padding,8);this.options=e,this.chart.styledMode||(this.itemStyle=e.itemStyle,this.itemHiddenStyle=T(this.itemStyle,e.itemHiddenStyle)),this.itemMarginTop=e.itemMarginTop,this.itemMarginBottom=e.itemMarginBottom,this.padding=t,this.initialItemY=t-5,this.symbolWidth=M(e.symbolWidth,16),this.pages=[],this.proximate="proximate"===e.layout&&!this.chart.inverted,this.baseline=void 0}update(e,t){let i=this.chart;this.setOptions(T(!0,this.options,e)),"events"in this.options&&h(this,this.options),this.destroy(),i.isDirtyLegend=i.isDirtyBox=!0,M(t,!0)&&i.redraw(),w(this,"afterUpdate",{redraw:t})}colorizeItem(e,t){let{area:i,group:r,label:n,line:o,symbol:s}=e.legendItem||{};if(r?.[t?"removeClass":"addClass"]("highcharts-legend-item-hidden"),!this.chart.styledMode){let{itemHiddenStyle:r={}}=this,a=r.color,{fillColor:l,fillOpacity:c,lineColor:u,marker:h}=e.options,d=e=>(!t&&(e.fill&&(e.fill=a),e.stroke&&(e.stroke=a)),e);n?.css(T(t?this.itemStyle:r)),o?.attr(d({stroke:u||e.color})),s&&s.attr(d(h&&s.isMarker?e.pointAttribs():{fill:e.color})),i?.attr(d({fill:l||e.color,"fill-opacity":l?1:c??.75}))}w(this,"afterColorizeItem",{item:e,visible:t})}positionItems(){this.allItems.forEach(this.positionItem,this),this.chart.isResizing||this.positionCheckboxes()}positionItem(e){let{group:t,x:i=0,y:r=0}=e.legendItem||{},n=this.options,o=n.symbolPadding,s=!n.rtl,a=e.checkbox;if(t&&t.element){let n={translateX:s?i:this.legendWidth-i-2*o-4,translateY:r};t[v(t.translateY)?"animate":"attr"](n,void 0,(()=>{w(this,"afterPositionItem",{item:e})}))}a&&(a.x=i,a.y=r)}destroyItem(e){let t=e.checkbox,i=e.legendItem||{};for(let r of["group","label","line","symbol"])i[r]&&(i[r]=i[r].destroy());t&&x(t),e.legendItem=void 0}destroy(){for(let e of this.getAllItems())this.destroyItem(e);for(let e of["clipRect","up","down","pager","nav","box","title","group"])this[e]&&(this[e]=this[e].destroy());this.display=null}positionCheckboxes(){let e,t=this.group&&this.group.alignAttr,i=this.clipHeight||this.legendHeight,r=this.titleHeight;t&&(e=t.translateY,this.allItems.forEach((function(n){let o,s=n.checkbox;s&&(o=e+r+s.y+(this.scrollOffset||0)+3,_(s,{left:t.translateX+n.checkboxOffset+s.x-20+"px",top:o+"px",display:this.proximate||o>e-6&&o<e+i-6?"":"none"}))}),this))}renderTitle(){let e,t=this.options,i=this.padding,r=t.title,n=0;r.text&&(this.title||(this.title=this.chart.renderer.label(r.text,i-3,i-4,void 0,void 0,void 0,t.useHTML,void 0,"legend-title").attr({zIndex:1}),this.chart.styledMode||this.title.css(r.style),this.title.add(this.group)),r.width||this.title.css({width:this.maxLegendWidth+"px"}),n=(e=this.title.getBBox()).height,this.offsetWidth=e.width,this.contentGroup.attr({translateY:n})),this.titleHeight=n}setText(e){let t=this.options;e.legendItem.label.attr({text:t.labelFormat?m(t.labelFormat,e,this.chart):t.labelFormatter.call(e)})}renderItem(e){let t=e.legendItem=e.legendItem||{},i=this.chart,r=i.renderer,n=this.options,o="horizontal"===n.layout,s=this.symbolWidth,a=n.symbolPadding||0,l=this.itemStyle,c=this.itemHiddenStyle,u=o?M(n.itemDistance,20):0,h=!n.rtl,d=!e.series,p=!d&&e.series.drawLegendSymbol?e.series:e,f=p.options,m=!!this.createCheckboxForItem&&f&&f.showCheckbox,g=n.useHTML,y=e.options.className,_=t.label,v=s+a+u+(m?20:0);!_&&(t.group=r.g("legend-item").addClass("highcharts-"+p.type+"-series highcharts-color-"+e.colorIndex+(y?" "+y:"")+(d?" highcharts-series-"+e.index:"")).attr({zIndex:1}).add(this.scrollGroup),t.label=_=r.text("",h?s+a:-a,this.baseline||0,g),i.styledMode||_.css(T(e.visible?l:c)),_.attr({align:h?"left":"right",zIndex:2}).add(t.group),!this.baseline&&(this.fontMetrics=r.fontMetrics(_),this.baseline=this.fontMetrics.f+3+this.itemMarginTop,_.attr("y",this.baseline),this.symbolHeight=M(n.symbolHeight,this.fontMetrics.f),n.squareSymbol&&(this.symbolWidth=M(n.symbolWidth,Math.max(this.symbolHeight,16)),v=this.symbolWidth+a+u+(m?20:0),h&&_.attr("x",this.symbolWidth+a))),p.drawLegendSymbol(this,e),this.setItemEvents&&this.setItemEvents(e,_,g)),m&&!e.checkbox&&this.createCheckboxForItem&&this.createCheckboxForItem(e),this.colorizeItem(e,e.visible),(i.styledMode||!l.width)&&_.css({width:(n.itemWidth||this.widthOption||i.spacingBox.width)-v+"px"}),this.setText(e);let x=_.getBBox(),b=this.fontMetrics&&this.fontMetrics.h||0;e.itemWidth=e.checkboxOffset=n.itemWidth||t.labelWidth||x.width+v,this.maxItemWidth=Math.max(this.maxItemWidth,e.itemWidth),this.totalItemWidth+=e.itemWidth,this.itemHeight=e.itemHeight=Math.round(t.labelHeight||(x.height>1.5*b?x.height:b))}layoutItem(e){let t=this.options,i=this.padding,r="horizontal"===t.layout,n=e.itemHeight,o=this.itemMarginBottom,s=this.itemMarginTop,a=r?M(t.itemDistance,20):0,l=this.maxLegendWidth,c=t.alignColumns&&this.totalItemWidth>l?this.maxItemWidth:e.itemWidth,u=e.legendItem||{};r&&this.itemX-i+c>l&&(this.itemX=i,this.lastLineHeight&&(this.itemY+=s+this.lastLineHeight+o),this.lastLineHeight=0),this.lastItemY=s+this.itemY+o,this.lastLineHeight=Math.max(n,this.lastLineHeight),u.x=this.itemX,u.y=this.itemY,r?this.itemX+=c:(this.itemY+=s+n+o,this.lastLineHeight=n),this.offsetWidth=this.widthOption||Math.max((r?this.itemX-i-(e.checkbox?0:a):c)+i,this.offsetWidth)}getAllItems(){let e=[];return this.chart.series.forEach((function(t){let i=t&&t.options;t&&M(i.showInLegend,!v(i.linkedTo)&&void 0,!0)&&(e=e.concat((t.legendItem||{}).labels||("point"===i.legendType?t.data:t)))})),w(this,"afterGetAllItems",{allItems:e}),e}getAlignment(){let e=this.options;return this.proximate?e.align.charAt(0)+"tv":e.floating?"":e.align.charAt(0)+e.verticalAlign.charAt(0)+e.layout.charAt(0)}adjustMargins(e,t){let i=this.chart,r=this.options,n=this.getAlignment();n&&[/(lth|ct|rth)/,/(rtv|rm|rbv)/,/(rbh|cb|lbh)/,/(lbv|lm|ltv)/].forEach((function(o,s){o.test(n)&&!v(e[s])&&(i[p[s]]=Math.max(i[p[s]],i.legend[(s+1)%2?"legendHeight":"legendWidth"]+[1,-1,-1,1][s]*r[s%2?"x":"y"]+M(r.margin,12)+t[s]+(i.titleOffset[s]||0)))}))}proximatePositions(){let e,t=this.chart,i=[],r="left"===this.options.align;for(let n of(this.allItems.forEach((function(e){let n,o,s,a,l=r;e.yAxis&&(e.xAxis.options.reversed&&(l=!l),e.points&&(n=b(l?e.points:e.points.slice(0).reverse(),(function(e){return S(e.plotY)}))),o=this.itemMarginTop+e.legendItem.label.getBBox().height+this.itemMarginBottom,a=e.yAxis.top-t.plotTop,s=e.visible?(n?n.plotY:e.yAxis.height)+(a-.3*o):a+e.yAxis.height,i.push({target:s,size:o,item:e}))}),this),f(i,t.plotHeight)))e=n.item.legendItem||{},S(n.pos)&&(e.y=t.plotTop-t.spacing[0]+n.pos)}render(){let e,t,i,r,n=this.chart,o=n.renderer,s=this.options,a=this.padding,l=this.getAllItems(),c=this.group,u=this.box;this.itemX=a,this.itemY=this.initialItemY,this.offsetWidth=0,this.lastItemY=0,this.widthOption=C(s.width,n.spacingBox.width-a),r=n.spacingBox.width-2*a-s.x,["rm","lm"].indexOf(this.getAlignment().substring(0,2))>-1&&(r/=2),this.maxLegendWidth=this.widthOption||r,c||(this.group=c=o.g("legend").addClass(s.className||"").attr({zIndex:7}).add(),this.contentGroup=o.g().attr({zIndex:1}).add(c),this.scrollGroup=o.g().add(this.contentGroup)),this.renderTitle(),E(l,((e,t)=>(e.options&&e.options.legendIndex||0)-(t.options&&t.options.legendIndex||0))),s.reversed&&l.reverse(),this.allItems=l,this.display=e=!!l.length,this.lastLineHeight=0,this.maxItemWidth=0,this.totalItemWidth=0,this.itemHeight=0,l.forEach(this.renderItem,this),l.forEach(this.layoutItem,this),t=(this.widthOption||this.offsetWidth)+a,i=this.lastItemY+this.lastLineHeight+this.titleHeight,i=this.handleOverflow(i)+a,u||(this.box=u=o.rect().addClass("highcharts-legend-box").attr({r:s.borderRadius}).add(c)),n.styledMode||u.attr({stroke:s.borderColor,"stroke-width":s.borderWidth||0,fill:s.backgroundColor||"none"}).shadow(s.shadow),t>0&&i>0&&u[u.placed?"animate":"attr"](u.crisp.call({},{x:0,y:0,width:t,height:i},u.strokeWidth())),c[e?"show":"hide"](),n.styledMode&&"none"===c.getStyle("display")&&(t=i=0),this.legendWidth=t,this.legendHeight=i,e&&this.align(),this.proximate||this.positionItems(),w(this,"afterRender")}align(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chart.spacingBox,t=this.chart,i=this.options,r=e.y;/(lth|ct|rth)/.test(this.getAlignment())&&t.titleOffset[0]>0?r+=t.titleOffset[0]:/(lbh|cb|rbh)/.test(this.getAlignment())&&t.titleOffset[2]>0&&(r-=t.titleOffset[2]),r!==e.y&&(e=T(e,{y:r})),t.hasRendered||(this.group.placed=!1),this.group.align(T(i,{width:this.legendWidth,height:this.legendHeight,verticalAlign:this.proximate?"top":i.verticalAlign}),!0,e)}handleOverflow(e){let t,i,r,n=this,o=this.chart,s=o.renderer,a=this.options,l=a.y,c="top"===a.verticalAlign,u=this.padding,h=a.maxHeight,d=a.navigation,p=M(d.animation,!0),f=d.arrowSize||12,m=this.pages,g=this.allItems,y=function(e){"number"==typeof e?b.attr({height:e}):b&&(n.clipRect=b.destroy(),n.contentGroup.clip()),n.contentGroup.div&&(n.contentGroup.div.style.clip=e?"rect("+u+"px,9999px,"+(u+e)+"px,0)":"auto")},_=function(e){return n[e]=s.circle(0,0,1.3*f).translate(f/2,f/2).add(x),o.styledMode||n[e].attr("fill","rgba(0,0,0,0.0001)"),n[e]},v=o.spacingBox.height+(c?-l:l)-u,x=this.nav,b=this.clipRect;return"horizontal"!==a.layout||"middle"===a.verticalAlign||a.floating||(v/=2),h&&(v=Math.min(v,h)),m.length=0,e&&v>0&&e>v&&!1!==d.enabled?(this.clipHeight=t=Math.max(v-20-this.titleHeight-u,0),this.currentPage=M(this.currentPage,1),this.fullHeight=e,g.forEach(((e,n)=>{let o=(r=e.legendItem||{}).y||0,s=Math.round(r.label.getBBox().height),a=m.length;(!a||o-m[a-1]>t&&(i||o)!==m[a-1])&&(m.push(i||o),a++),r.pageIx=a-1,i&&((g[n-1].legendItem||{}).pageIx=a-1),n===g.length-1&&o+s-m[a-1]>t&&o>m[a-1]&&(m.push(o),r.pageIx=a),o!==i&&(i=o)})),b||(b=n.clipRect=s.clipRect(0,u-2,9999,0),n.contentGroup.clip(b)),y(t),x||(this.nav=x=s.g().attr({zIndex:1}).add(this.group),this.up=s.symbol("triangle",0,0,f,f).add(x),_("upTracker").on("click",(function(){n.scroll(-1,p)})),this.pager=s.text("",15,10).addClass("highcharts-legend-navigation"),!o.styledMode&&d.style&&this.pager.css(d.style),this.pager.add(x),this.down=s.symbol("triangle-down",0,0,f,f).add(x),_("downTracker").on("click",(function(){n.scroll(1,p)}))),n.scroll(0),e=v):x&&(y(),this.nav=x.destroy(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0),e}scroll(e,t){let i=this.chart,r=this.pages,n=r.length,o=this.clipHeight,s=this.options.navigation,a=this.pager,l=this.padding,h=this.currentPage+e;h>n&&(h=n),h>0&&(void 0!==t&&u(t,i),this.nav.attr({translateX:l,translateY:o+this.padding+7+this.titleHeight,visibility:"inherit"}),[this.up,this.upTracker].forEach((function(e){e.attr({class:1===h?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"})})),a.attr({text:h+"/"+n}),[this.down,this.downTracker].forEach((function(e){e.attr({x:18+this.pager.getBBox().width,class:h===n?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"})}),this),i.styledMode||(this.up.attr({fill:1===h?s.inactiveColor:s.activeColor}),this.upTracker.css({cursor:1===h?"default":"pointer"}),this.down.attr({fill:h===n?s.inactiveColor:s.activeColor}),this.downTracker.css({cursor:h===n?"default":"pointer"})),this.scrollOffset=-r[h-1]+this.initialItemY,this.scrollGroup.animate({translateY:this.scrollOffset}),this.currentPage=h,this.positionCheckboxes(),P((()=>{w(this,"afterScroll",{currentPage:h})}),c(M(t,i.renderer.globalAnimation,!0)).duration))}setItemEvents(e,t,i){let o=this,s=e.legendItem||{},a=o.chart.renderer.boxWrapper,l=e instanceof n,c=e instanceof r,u="highcharts-legend-"+(l?"point":"series")+"-active",h=o.chart.styledMode,d=i?[t,s.symbol]:[s.group],p=t=>{o.allItems.forEach((i=>{e!==i&&[i].concat(i.linkedSeries||[]).forEach((e=>{e.setState(t,!l)}))}))};for(let r of d)r&&r.on("mouseover",(function(){e.visible&&p("inactive"),e.setState("hover"),e.visible&&a.addClass(u),h||t.css(o.options.itemHoverStyle)})).on("mouseout",(function(){o.chart.styledMode||t.css(T(e.visible?o.itemStyle:o.itemHiddenStyle)),p(""),a.removeClass(u),e.setState()})).on("click",(function(t){a.removeClass(u),w(o,"itemClick",{browserEvent:t,legendItem:e},(function(){e.setVisible&&e.setVisible(),p(e.visible?"inactive":"")})),l?e.firePointEvent("legendItemClick",{browserEvent:t}):c&&w(e,"legendItemClick",{browserEvent:t})}))}createCheckboxForItem(e){e.checkbox=y("input",{type:"checkbox",className:"highcharts-legend-checkbox",checked:e.selected,defaultChecked:e.selected},this.options.itemCheckboxStyle,this.chart.container),g(e.checkbox,"click",(function(t){let i=t.target;w(e.series||e,"checkboxClick",{checked:i.checked,item:e},(function(){e.select()}))}))}}return(l=k||(k={})).compose=function(e){A(d,"Core.Legend")&&g(e,"beforeMargins",(function(){this.legend=new l(this,this.options.legend)}))},k})),i(t,"Core/Chart/Chart.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Axis/Axis.js"],t["Core/Defaults.js"],t["Core/Templating.js"],t["Core/Foundation.js"],t["Core/Globals.js"],t["Core/Renderer/RendererRegistry.js"],t["Core/Series/Series.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Renderer/SVG/SVGRenderer.js"],t["Core/Time.js"],t["Core/Utilities.js"],t["Core/Renderer/HTML/AST.js"],t["Core/Axis/Tick.js"]],(function(e,t,i,r,n,o,s,a,l,c,u,h,d,p){let{animate:f,animObject:m,setAnimation:g}=e,{defaultOptions:y,defaultTime:_}=i,{numberFormat:v}=r,{registerEventOptions:x}=n,{charts:b,doc:w,marginNames:S,svg:T,win:M}=o,{seriesTypes:A}=l,{addEvent:C,attr:E,createElement:P,css:k,defined:I,diffObjects:D,discardElement:L,erase:R,error:z,extend:O,find:F,fireEvent:B,getStyle:N,isArray:j,isNumber:V,isObject:U,isString:G,merge:H,objectEach:W,pick:$,pInt:q,relativeLength:X,removeEvent:Y,splat:Z,syncTimeout:K,uniqueKey:J}=h;class Q{static chart(e,t,i){return new Q(e,t,i)}constructor(e,t,i){this.sharedClips={};let r=[...arguments];(G(e)||e.nodeName)&&(this.renderTo=r.shift()),this.init(r[0],r[1])}setZoomOptions(){let e=this.options.chart,t=e.zooming;this.zooming={...t,type:$(e.zoomType,t.type),key:$(e.zoomKey,t.key),pinchType:$(e.pinchType,t.pinchType),singleTouch:$(e.zoomBySingleTouch,t.singleTouch,!1),resetButton:H(t.resetButton,e.resetZoomButton)}}init(e,t){B(this,"init",{args:arguments},(function(){let i=H(y,e),r=i.chart;this.userOptions=O({},e),this.margin=[],this.spacing=[],this.labelCollectors=[],this.callback=t,this.isResizing=0,this.options=i,this.axes=[],this.series=[],this.time=e.time&&Object.keys(e.time).length?new u(e.time):o.time,this.numberFormatter=r.numberFormatter||v,this.styledMode=r.styledMode,this.hasCartesianSeries=r.showAxes,this.index=b.length,b.push(this),o.chartCount++,x(this,r),this.xAxis=[],this.yAxis=[],this.pointCount=this.colorCounter=this.symbolCounter=0,this.setZoomOptions(),B(this,"afterInit"),this.firstRender()}))}initSeries(e){let t=this.options.chart,i=e.type||t.type,r=A[i];r||z(17,!0,this,{missingModuleFor:i});let n=new r;return"function"==typeof n.init&&n.init(this,e),n}setSortedData(){this.getSeriesOrderByLinks().forEach((function(e){e.points||e.data||!e.enabledDataSorting||e.setData(e.options.data,!1)}))}getSeriesOrderByLinks(){return this.series.concat().sort((function(e,t){return e.linkedSeries.length||t.linkedSeries.length?t.linkedSeries.length-e.linkedSeries.length:0}))}orderItems(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this[e],r=this.options[e]=Z(this.options[e]).slice(),n=this.userOptions[e]=this.userOptions[e]?Z(this.userOptions[e]).slice():[];if(this.hasRendered&&(r.splice(t),n.splice(t)),i)for(let o=t,s=i.length;o<s;++o){let e=i[o];e&&(e.index=o,e instanceof a&&(e.name=e.getName()),e.options.isInternal||(r[o]=e.options,n[o]=e.userOptions))}}isInsidePlot(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{inverted:r,plotBox:n,plotLeft:o,plotTop:s,scrollablePlotBox:a}=this,{scrollLeft:l=0,scrollTop:c=0}=i.visiblePlotOnly&&this.scrollablePlotArea?.scrollingContainer||{},u=i.series,h=i.visiblePlotOnly&&a||n,d=i.inverted?t:e,p=i.inverted?e:t,f={x:d,y:p,isInsidePlot:!0,options:i};if(!i.ignoreX){let e=u&&(r&&!this.polar?u.yAxis:u.xAxis)||{pos:o,len:1/0},t=i.paneCoordinates?e.pos+d:o+d;t>=Math.max(l+o,e.pos)&&t<=Math.min(l+o+h.width,e.pos+e.len)||(f.isInsidePlot=!1)}if(!i.ignoreY&&f.isInsidePlot){let e=!r&&i.axis&&!i.axis.isXAxis&&i.axis||u&&(r?u.xAxis:u.yAxis)||{pos:s,len:1/0},t=i.paneCoordinates?e.pos+p:s+p;t>=Math.max(c+s,e.pos)&&t<=Math.min(c+s+h.height,e.pos+e.len)||(f.isInsidePlot=!1)}return B(this,"afterIsInsidePlot",f),f.isInsidePlot}redraw(e){B(this,"beforeRedraw");let t,i,r,n,o=this.hasCartesianSeries?this.axes:this.colorAxis||[],s=this.series,a=this.pointer,l=this.legend,c=this.userOptions.legend,u=this.renderer,h=u.isHidden(),d=[],p=this.isDirtyBox,f=this.isDirtyLegend;for(u.rootFontSize=u.boxWrapper.getStyle("font-size"),this.setResponsive&&this.setResponsive(!1),g(!!this.hasRendered&&e,this),h&&this.temporaryDisplay(),this.layOutTitles(!1),r=s.length;r--;)if(((n=s[r]).options.stacking||n.options.centerInCategory)&&(i=!0,n.isDirty)){t=!0;break}if(t)for(r=s.length;r--;)(n=s[r]).options.stacking&&(n.isDirty=!0);s.forEach((function(e){e.isDirty&&("point"===e.options.legendType?("function"==typeof e.updateTotals&&e.updateTotals(),f=!0):c&&(c.labelFormatter||c.labelFormat)&&(f=!0)),e.isDirtyData&&B(e,"updatedData")})),f&&l&&l.options.enabled&&(l.render(),this.isDirtyLegend=!1),i&&this.getStacks(),o.forEach((function(e){e.updateNames(),e.setScale()})),this.getMargins(),o.forEach((function(e){e.isDirty&&(p=!0)})),o.forEach((function(e){let t=e.min+","+e.max;e.extKey!==t&&(e.extKey=t,d.push((function(){B(e,"afterSetExtremes",O(e.eventArgs,e.getExtremes())),delete e.eventArgs}))),(p||i)&&e.redraw()})),p&&this.drawChartBox(),B(this,"predraw"),s.forEach((function(e){(p||e.isDirty)&&e.visible&&e.redraw(),e.isDirtyData=!1})),a&&a.reset(!0),u.draw(),B(this,"redraw"),B(this,"render"),h&&this.temporaryDisplay(!0),d.forEach((function(e){e.call()}))}get(e){let t=this.series;function i(t){return t.id===e||t.options&&t.options.id===e}let r=F(this.axes,i)||F(this.series,i);for(let n=0;!r&&n<t.length;n++)r=F(t[n].points||[],i);return r}getAxes(){let e=this.userOptions;for(let i of(B(this,"getAxes"),["xAxis","yAxis"]))for(let r of e[i]=Z(e[i]||{}))new t(this,r,i);B(this,"afterGetAxes")}getSelectedPoints(){return this.series.reduce(((e,t)=>(t.getPointsCollection().forEach((t=>{$(t.selectedStaging,t.selected)&&e.push(t)})),e)),[])}getSelectedSeries(){return this.series.filter((function(e){return e.selected}))}setTitle(e,t,i){this.applyDescription("title",e),this.applyDescription("subtitle",t),this.applyDescription("caption",void 0),this.layOutTitles(i)}applyDescription(e,t){let i=this,r=this.options[e]=H(this.options[e],t),n=this[e];n&&t&&(this[e]=n=n.destroy()),r&&!n&&((n=this.renderer.text(r.text,0,0,r.useHTML).attr({align:r.align,class:"highcharts-"+e,zIndex:r.zIndex||4}).add()).update=function(t,r){i.applyDescription(e,t),i.layOutTitles(r)},this.styledMode||n.css(O("title"===e?{fontSize:this.options.isStock?"1em":"1.2em"}:{},r.style)),this[e]=n)}layOutTitles(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=[0,0,0],i=this.renderer,r=this.spacingBox;["title","subtitle","caption"].forEach((function(e){let n=this[e],o=this.options[e],s=o.verticalAlign||"top",a="title"===e?"top"===s?-3:0:"top"===s?t[0]+2:0;if(n){n.css({width:(o.width||r.width+(o.widthAdjust||0))+"px"});let e=i.fontMetrics(n).b,l=Math.round(n.getBBox(o.useHTML).height);n.align(O({y:"bottom"===s?e:a+e,height:l},o),!1,"spacingBox"),o.floating||("top"===s?t[0]=Math.ceil(t[0]+l):"bottom"===s&&(t[2]=Math.ceil(t[2]+l)))}}),this),t[0]&&"top"===(this.options.title.verticalAlign||"top")&&(t[0]+=this.options.title.margin),t[2]&&"bottom"===this.options.caption.verticalAlign&&(t[2]+=this.options.caption.margin);let n=!this.titleOffset||this.titleOffset.join(",")!==t.join(",");this.titleOffset=t,B(this,"afterLayOutTitles"),!this.isDirtyBox&&n&&(this.isDirtyBox=this.isDirtyLegend=n,this.hasRendered&&e&&this.isDirtyBox&&this.redraw())}getContainerBox(){let e=[].map.call(this.renderTo.children,(e=>{if(e!==this.container){let t=e.style.display;return e.style.display="none",[e,t]}})),t={width:N(this.renderTo,"width",!0)||0,height:N(this.renderTo,"height",!0)||0};return e.filter(Boolean).forEach((e=>{let[t,i]=e;t.style.display=i})),t}getChartSize(){let e=this.options.chart,t=e.width,i=e.height,r=this.getContainerBox(),n=r.height>1&&!(!this.renderTo.parentElement?.style.height&&"100%"===this.renderTo.style.height);this.chartWidth=Math.max(0,t||r.width||600),this.chartHeight=Math.max(0,X(i,this.chartWidth)||(n?r.height:400)),this.containerBox=r}temporaryDisplay(e){let t,i=this.renderTo;if(e)for(;i&&i.style;)i.hcOrigStyle&&(k(i,i.hcOrigStyle),delete i.hcOrigStyle),i.hcOrigDetached&&(w.body.removeChild(i),i.hcOrigDetached=!1),i=i.parentNode;else for(;i&&i.style&&(w.body.contains(i)||i.parentNode||(i.hcOrigDetached=!0,w.body.appendChild(i)),("none"===N(i,"display",!1)||i.hcOricDetached)&&(i.hcOrigStyle={display:i.style.display,height:i.style.height,overflow:i.style.overflow},t={display:"block",overflow:"hidden"},i!==this.renderTo&&(t.height=0),k(i,t),i.offsetWidth||i.style.setProperty("display","block","important")),(i=i.parentNode)!==w.body););}setClassName(e){this.container.className="highcharts-container "+(e||"")}getContainer(){let e,t=this.options,i=t.chart,r="data-highcharts-chart",n=J(),o=this.renderTo;o||(this.renderTo=o=i.renderTo),G(o)&&(this.renderTo=o=w.getElementById(o)),o||z(13,!0,this);let a=q(E(o,r));V(a)&&b[a]&&b[a].hasRendered&&b[a].destroy(),E(o,r,this.index),o.innerHTML=d.emptyHTML,i.skipClone||o.offsetWidth||this.temporaryDisplay(),this.getChartSize();let l=this.chartHeight,u=this.chartWidth;k(o,{overflow:"hidden"}),this.styledMode||(e=O({position:"relative",overflow:"hidden",width:u+"px",height:l+"px",textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)",userSelect:"none","touch-action":"manipulation",outline:"none",padding:"0px"},i.style||{}));let h=P("div",{id:n},e,o);this.container=h,this.getChartSize(),u===this.chartWidth||(u=this.chartWidth,this.styledMode||k(h,{width:$(i.style?.width,u+"px")})),this.containerBox=this.getContainerBox(),this._cursor=h.style.cursor;let p=i.renderer||!T?s.getRendererType(i.renderer):c;if(this.renderer=new p(h,u,l,void 0,i.forExport,t.exporting&&t.exporting.allowHTML,this.styledMode),g(void 0,this),this.setClassName(i.className),this.styledMode)for(let s in t.defs)this.renderer.definition(t.defs[s]);else this.renderer.setStyle(i.style);this.renderer.chartIndex=this.index,B(this,"afterGetContainer")}getMargins(e){let{spacing:t,margin:i,titleOffset:r}=this;this.resetMargins(),r[0]&&!I(i[0])&&(this.plotTop=Math.max(this.plotTop,r[0]+t[0])),r[2]&&!I(i[2])&&(this.marginBottom=Math.max(this.marginBottom,r[2]+t[2])),this.legend&&this.legend.display&&this.legend.adjustMargins(i,t),B(this,"getMargins"),e||this.getAxisMargins()}getAxisMargins(){let e=this,t=e.axisOffset=[0,0,0,0],i=e.colorAxis,r=e.margin,n=function(e){e.forEach((function(e){e.visible&&e.getOffset()}))};e.hasCartesianSeries?n(e.axes):i&&i.length&&n(i),S.forEach((function(i,n){I(r[n])||(e[i]+=t[n])})),e.setChartSize()}getOptions(){return D(this.userOptions,y)}reflow(e){let t=this,i=t.containerBox,r=t.getContainerBox();delete t.pointer?.chartPosition,!t.isPrinting&&!t.isResizing&&i&&r.width&&((r.width!==i.width||r.height!==i.height)&&(h.clearTimeout(t.reflowTimeout),t.reflowTimeout=K((function(){t.container&&t.setSize(void 0,void 0,!1)}),e?100:0)),t.containerBox=r)}setReflow(){let e=this,t=t=>{e.options?.chart.reflow&&e.hasLoaded&&e.reflow(t)};if("function"==typeof ResizeObserver)new ResizeObserver(t).observe(e.renderTo);else{let e=C(M,"resize",t);C(this,"destroy",e)}}setSize(e,t,i){let r=this,n=r.renderer;r.isResizing+=1,g(i,r);let o=n.globalAnimation;r.oldChartHeight=r.chartHeight,r.oldChartWidth=r.chartWidth,void 0!==e&&(r.options.chart.width=e),void 0!==t&&(r.options.chart.height=t),r.getChartSize();let{chartWidth:s,chartHeight:a,scrollablePixelsX:l=0,scrollablePixelsY:c=0}=r;(r.isDirtyBox||s!==r.oldChartWidth||a!==r.oldChartHeight)&&(r.styledMode||(o?f:k)(r.container,{width:`${s+l}px`,height:`${a+c}px`},o),r.setChartSize(!0),n.setSize(s,a,o),r.axes.forEach((function(e){e.isDirty=!0,e.setScale()})),r.isDirtyLegend=!0,r.isDirtyBox=!0,r.layOutTitles(),r.getMargins(),r.redraw(o),r.oldChartHeight=void 0,B(r,"resize"),setTimeout((()=>{r&&B(r,"endResize")}),m(o).duration)),r.isResizing-=1}setChartSize(e){let t,i,r,n,{chartHeight:o,chartWidth:s,inverted:a,spacing:l,renderer:c}=this,u=this.clipOffset,h=Math[a?"floor":"round"];this.plotLeft=t=Math.round(this.plotLeft),this.plotTop=i=Math.round(this.plotTop),this.plotWidth=r=Math.max(0,Math.round(s-t-this.marginRight)),this.plotHeight=n=Math.max(0,Math.round(o-i-this.marginBottom)),this.plotSizeX=a?n:r,this.plotSizeY=a?r:n,this.spacingBox=c.spacingBox={x:l[3],y:l[0],width:s-l[3]-l[1],height:o-l[0]-l[2]},this.plotBox=c.plotBox={x:t,y:i,width:r,height:n},u&&(this.clipBox={x:h(u[3]),y:h(u[0]),width:h(this.plotSizeX-u[1]-u[3]),height:h(this.plotSizeY-u[0]-u[2])}),e||(this.axes.forEach((function(e){e.setAxisSize(),e.setAxisTranslation()})),c.alignElements()),B(this,"afterSetChartSize",{skipAxes:e})}resetMargins(){B(this,"resetMargins");let e=this,t=e.options.chart,i=t.plotBorderWidth||0,r=i/2;["margin","spacing"].forEach((function(i){let r=t[i],n=U(r)?r:[r,r,r,r];["Top","Right","Bottom","Left"].forEach((function(r,o){e[i][o]=$(t[i+r],n[o])}))})),S.forEach((function(t,i){e[t]=$(e.margin[i],e.spacing[i])})),e.axisOffset=[0,0,0,0],e.clipOffset=[r,r,r,r],e.plotBorderWidth=i}drawChartBox(){let e,t,i,r=this.options.chart,n=this.renderer,o=this.chartWidth,s=this.chartHeight,a=this.styledMode,l=this.plotBGImage,c=r.backgroundColor,u=r.plotBackgroundColor,h=r.plotBackgroundImage,d=this.plotLeft,p=this.plotTop,f=this.plotWidth,m=this.plotHeight,g=this.plotBox,y=this.clipRect,_=this.clipBox,v=this.chartBackground,x=this.plotBackground,b=this.plotBorder,w="animate";v||(this.chartBackground=v=n.rect().addClass("highcharts-background").add(),w="attr"),a?e=t=v.strokeWidth():(t=(e=r.borderWidth||0)+(r.shadow?8:0),i={fill:c||"none"},(e||v["stroke-width"])&&(i.stroke=r.borderColor,i["stroke-width"]=e),v.attr(i).shadow(r.shadow)),v[w]({x:t/2,y:t/2,width:o-t-e%2,height:s-t-e%2,r:r.borderRadius}),w="animate",x||(w="attr",this.plotBackground=x=n.rect().addClass("highcharts-plot-background").add()),x[w](g),!a&&(x.attr({fill:u||"none"}).shadow(r.plotShadow),h&&(l?(h!==l.attr("href")&&l.attr("href",h),l.animate(g)):this.plotBGImage=n.image(h,d,p,f,m).add())),y?y.animate({width:_.width,height:_.height}):this.clipRect=n.clipRect(_),w="animate",b||(w="attr",this.plotBorder=b=n.rect().addClass("highcharts-plot-border").attr({zIndex:1}).add()),a||b.attr({stroke:r.plotBorderColor,"stroke-width":r.plotBorderWidth||0,fill:"none"}),b[w](b.crisp({x:d,y:p,width:f,height:m},-b.strokeWidth())),this.isDirtyBox=!1,B(this,"afterDrawChartBox")}propFromSeries(){let e,t,i,r=this,n=r.options.chart,o=r.options.series;["inverted","angular","polar"].forEach((function(s){for(t=A[n.type],i=n[s]||t&&t.prototype[s],e=o&&o.length;!i&&e--;)(t=A[o[e].type])&&t.prototype[s]&&(i=!0);r[s]=i}))}linkSeries(e){let t=this,i=t.series;i.forEach((function(e){e.linkedSeries.length=0})),i.forEach((function(e){let{linkedTo:i}=e.options;if(G(i)){let r;(r=":previous"===i?t.series[e.index-1]:t.get(i))&&r.linkedParent!==e&&(r.linkedSeries.push(e),e.linkedParent=r,r.enabledDataSorting&&e.setDataSortingOptions(),e.visible=$(e.options.visible,r.options.visible,e.visible))}})),B(this,"afterLinkSeries",{isUpdating:e})}renderSeries(){this.series.forEach((function(e){e.translate(),e.render()}))}render(){let e,t=this.axes,i=this.colorAxis,r=this.renderer,n=this.options.chart.axisLayoutRuns||2,o=e=>{e.forEach((e=>{e.visible&&e.render()}))},s=0,a=!0,l=0;for(let c of(this.setTitle(),B(this,"beforeMargins"),this.getStacks?.(),this.getMargins(!0),this.setChartSize(),t)){let{options:e}=c,{labels:t}=e;if(this.hasCartesianSeries&&c.horiz&&c.visible&&t.enabled&&c.series.length&&"colorAxis"!==c.coll&&!this.polar){s=e.tickLength,c.createGroups();let i=new p(c,0,"",!0),r=i.createLabel("x",t);if(i.destroy(),r&&$(t.reserveSpace,!V(e.crossing))&&(s=r.getBBox().height+t.distance+Math.max(e.offset||0,0)),s){r?.destroy();break}}}for(this.plotHeight=Math.max(this.plotHeight-s,0);(a||e||n>1)&&l<n;){let i=this.plotWidth,r=this.plotHeight;for(let n of t)0===l?n.setScale():(n.horiz&&a||!n.horiz&&e)&&n.setTickInterval(!0);0===l?this.getAxisMargins():this.getMargins(),a=i/this.plotWidth>(l?1:1.1),e=r/this.plotHeight>(l?1:1.05),l++}this.drawChartBox(),this.hasCartesianSeries?o(t):i&&i.length&&o(i),this.seriesGroup||(this.seriesGroup=r.g("series-group").attr({zIndex:3}).shadow(this.options.chart.seriesGroupShadow).add()),this.renderSeries(),this.addCredits(),this.setResponsive&&this.setResponsive(),this.hasRendered=!0}addCredits(e){let t=this,i=H(!0,this.options.credits,e);i.enabled&&!this.credits&&(this.credits=this.renderer.text(i.text+(this.mapCredits||""),0,0).addClass("highcharts-credits").on("click",(function(){i.href&&(M.location.href=i.href)})).attr({align:i.position.align,zIndex:8}),t.styledMode||this.credits.css(i.style),this.credits.add().align(i.position),this.credits.update=function(e){t.credits=t.credits.destroy(),t.addCredits(e)})}destroy(){let e,t=this,i=t.axes,r=t.series,n=t.container,s=n&&n.parentNode;for(B(t,"destroy"),t.renderer.forExport?R(b,t):b[t.index]=void 0,o.chartCount--,t.renderTo.removeAttribute("data-highcharts-chart"),Y(t),e=i.length;e--;)i[e]=i[e].destroy();for(this.scroller&&this.scroller.destroy&&this.scroller.destroy(),e=r.length;e--;)r[e]=r[e].destroy();["title","subtitle","chartBackground","plotBackground","plotBGImage","plotBorder","seriesGroup","clipRect","credits","pointer","rangeSelector","legend","resetZoomButton","tooltip","renderer"].forEach((function(e){let i=t[e];i&&i.destroy&&(t[e]=i.destroy())})),n&&(n.innerHTML=d.emptyHTML,Y(n),s&&L(n)),W(t,(function(e,i){delete t[i]}))}firstRender(){let e=this,t=e.options;e.getContainer(),e.resetMargins(),e.setChartSize(),e.propFromSeries(),e.getAxes();let i=j(t.series)?t.series:[];t.series=[],i.forEach((function(t){e.initSeries(t)})),e.linkSeries(),e.setSortedData(),B(e,"beforeRender"),e.render(),e.pointer?.getChartPosition(),e.renderer.imgCount||e.hasLoaded||e.onload(),e.temporaryDisplay(!0)}onload(){this.callbacks.concat([this.callback]).forEach((function(e){e&&void 0!==this.index&&e.apply(this,[this])}),this),B(this,"load"),B(this,"render"),I(this.index)&&this.setReflow(),this.warnIfA11yModuleNotLoaded(),this.hasLoaded=!0}warnIfA11yModuleNotLoaded(){let{options:e,title:t}=this;!e||this.accessibility||(this.renderer.boxWrapper.attr({role:"img","aria-label":(t&&t.element.textContent||"").replace(/</g,"&lt;")}),e.accessibility&&!1===e.accessibility.enabled||z('Highcharts warning: Consider including the "accessibility.js" module to make your chart more usable for people with disabilities. Set the "accessibility.enabled" option to false to remove this warning. See https://www.highcharts.com/docs/accessibility/accessibility-module.',!1,this))}addSeries(e,t,i){let r,n=this;return e&&(t=$(t,!0),B(n,"addSeries",{options:e},(function(){r=n.initSeries(e),n.isDirtyLegend=!0,n.linkSeries(),r.enabledDataSorting&&r.setData(e.data,!1),B(n,"afterAddSeries",{series:r}),t&&n.redraw(i)}))),r}addAxis(e,t,i,r){return this.createAxis(t?"xAxis":"yAxis",{axis:e,redraw:i,animation:r})}addColorAxis(e,t,i){return this.createAxis("colorAxis",{axis:e,redraw:t,animation:i})}createAxis(e,i){let r=new t(this,i.axis,e);return $(i.redraw,!0)&&this.redraw(i.animation),r}showLoading(e){let t=this,i=t.options,r=i.loading,n=function(){o&&k(o,{left:t.plotLeft+"px",top:t.plotTop+"px",width:t.plotWidth+"px",height:t.plotHeight+"px"})},o=t.loadingDiv,s=t.loadingSpan;o||(t.loadingDiv=o=P("div",{className:"highcharts-loading highcharts-loading-hidden"},null,t.container)),s||(t.loadingSpan=s=P("span",{className:"highcharts-loading-inner"},null,o),C(t,"redraw",n)),o.className="highcharts-loading",d.setElementHTML(s,$(e,i.lang.loading,"")),t.styledMode||(k(o,O(r.style,{zIndex:10})),k(s,r.labelStyle),t.loadingShown||(k(o,{opacity:0,display:""}),f(o,{opacity:r.style.opacity||.5},{duration:r.showDuration||0}))),t.loadingShown=!0,n()}hideLoading(){let e=this.options,t=this.loadingDiv;t&&(t.className="highcharts-loading highcharts-loading-hidden",this.styledMode||f(t,{opacity:0},{duration:e.loading.hideDuration||100,complete:function(){k(t,{display:"none"})}})),this.loadingShown=!1}update(e,t,i,r){let n,o,s,a=this,l={credits:"addCredits",title:"setTitle",subtitle:"setSubtitle",caption:"setCaption"},c=e.isResponsiveOptions,h=[];B(a,"update",{options:e}),c||a.setResponsive(!1,!0),e=D(e,a.options),a.userOptions=H(a.userOptions,e);let d=e.chart;d&&(H(!0,a.options.chart,d),this.setZoomOptions(),"className"in d&&a.setClassName(d.className),("inverted"in d||"polar"in d||"type"in d)&&(a.propFromSeries(),n=!0),"alignTicks"in d&&(n=!0),"events"in d&&x(this,d),W(d,(function(e,t){-1!==a.propsRequireUpdateSeries.indexOf("chart."+t)&&(o=!0),-1!==a.propsRequireDirtyBox.indexOf(t)&&(a.isDirtyBox=!0),-1===a.propsRequireReflow.indexOf(t)||(a.isDirtyBox=!0,c||(s=!0))})),!a.styledMode&&d.style&&a.renderer.setStyle(a.options.chart.style||{})),!a.styledMode&&e.colors&&(this.options.colors=e.colors),e.time&&(this.time===_&&(this.time=new u(e.time)),H(!0,a.options.time,e.time)),W(e,(function(t,i){a[i]&&"function"==typeof a[i].update?a[i].update(t,!1):"function"==typeof a[l[i]]?a[l[i]](t):"colors"!==i&&-1===a.collectionsWithUpdate.indexOf(i)&&H(!0,a.options[i],e[i]),"chart"!==i&&-1!==a.propsRequireUpdateSeries.indexOf(i)&&(o=!0)})),this.collectionsWithUpdate.forEach((function(t){e[t]&&(Z(e[t]).forEach((function(e,r){let n,o=I(e.id);o&&(n=a.get(e.id)),!n&&a[t]&&(n=a[t][$(e.index,r)])&&(o&&I(n.options.id)||n.options.isInternal)&&(n=void 0),n&&n.coll===t&&(n.update(e,!1),i&&(n.touched=!0)),!n&&i&&a.collectionsWithInit[t]&&(a.collectionsWithInit[t][0].apply(a,[e].concat(a.collectionsWithInit[t][1]||[]).concat([!1])).touched=!0)})),i&&a[t].forEach((function(e){e.touched||e.options.isInternal?delete e.touched:h.push(e)})))})),h.forEach((function(e){e.chart&&e.remove&&e.remove(!1)})),n&&a.axes.forEach((function(e){e.update({},!1)})),o&&a.getSeriesOrderByLinks().forEach((function(e){e.chart&&e.update({},!1)}),this);let p=d&&d.width,f=d&&(G(d.height)?X(d.height,p||a.chartWidth):d.height);s||V(p)&&p!==a.chartWidth||V(f)&&f!==a.chartHeight?a.setSize(p,f,r):$(t,!0)&&a.redraw(r),B(a,"afterUpdate",{options:e,redraw:t,animation:r})}setSubtitle(e,t){this.applyDescription("subtitle",e),this.layOutTitles(t)}setCaption(e,t){this.applyDescription("caption",e),this.layOutTitles(t)}showResetZoom(){let e=this,t=y.lang,i=e.zooming.resetButton,r=i.theme,n="chart"===i.relativeTo||"spacingBox"===i.relativeTo?null:"plotBox";function o(){e.zoomOut()}B(this,"beforeShowResetZoom",null,(function(){e.resetZoomButton=e.renderer.button(t.resetZoom,null,null,o,r).attr({align:i.position.align,title:t.resetZoomTitle}).addClass("highcharts-reset-zoom").add().align(i.position,!1,n)})),B(this,"afterShowResetZoom")}zoomOut(){B(this,"selection",{resetSelection:!0},(()=>this.transform({reset:!0,trigger:"zoom"})))}pan(e,t){let i=this,r="object"==typeof t?t:{enabled:t,type:"x"},n=r.type,o=n&&i[{x:"xAxis",xy:"axes",y:"yAxis"}[n]].filter((e=>e.options.panningEnabled&&!e.options.isInternal)),s=i.options.chart;s?.panning&&(s.panning=r),B(this,"pan",{originalEvent:e},(()=>{i.transform({axes:o,event:e,to:{x:e.chartX-(i.mouseDownX||0),y:e.chartY-(i.mouseDownY||0)},trigger:"pan"}),k(i.container,{cursor:"move"})}))}transform(e){let t,i,{axes:r=this.axes,event:n,from:o={},reset:s,selection:a,to:l={},trigger:c}=e,{inverted:u}=this,h=!1;for(let d of(this.hoverPoints?.forEach((e=>e.setState())),r)){let{horiz:e,len:r,minPointOffset:p=0,options:f,reversed:m}=d,g=e?"width":"height",y=e?"x":"y",_=$(l[g],d.len),v=$(o[g],d.len),x=10>Math.abs(_)?1:_/v,b=(o[y]||0)+v/2-d.pos,w=b-((l[y]??d.pos)+_/2-d.pos)/x,S=m&&!u||!m&&u?-1:1;if(!s&&(b<0||b>d.len))continue;let T=d.toValue(w,!0)+(a||d.isOrdinal?0:p*S),M=d.toValue(w+r/x,!0)-(a||d.isOrdinal?0:p*S||0),A=d.allExtremes;if(T>M&&([T,M]=[M,T]),1===x&&!s&&"yAxis"===d.coll&&!A){for(let e of d.series){let t=e.getExtremes(e.getProcessedData(!0).yData,!0);A??(A={dataMin:Number.MAX_VALUE,dataMax:-Number.MAX_VALUE}),V(t.dataMin)&&V(t.dataMax)&&(A.dataMin=Math.min(t.dataMin,A.dataMin),A.dataMax=Math.max(t.dataMax,A.dataMax))}d.allExtremes=A}let{dataMin:C,dataMax:E,min:P,max:k}=O(d.getExtremes(),A||{}),D=C??f.min,L=E??f.max,R=M-T,z=d.categories?0:Math.min(R,L-D),F=D-z*(I(f.min)?0:f.minPadding),B=L+z*(I(f.max)?0:f.maxPadding),N=d.allowZoomOutside||1===x||"zoom"!==c&&x>1,j=Math.min(f.min??F,F,N?P:F),U=Math.max(f.max??B,B,N?k:B);(!d.isOrdinal||d.options.overscroll||1!==x||s)&&(T<j&&(T=j,x>=1&&(M=T+R)),M>U&&(M=U,x>=1&&(T=M-R)),(s||d.series.length&&(T!==P||M!==k)&&T>=j&&M<=U)&&(a?a[d.coll].push({axis:d,min:T,max:M}):(d.isPanning="zoom"!==c,d.isPanning&&(i=!0),d.setExtremes(s?void 0:T,s?void 0:M,!1,!1,{move:w,trigger:c,scale:x}),!s&&(T>j||M<U)&&"mousewheel"!==c&&(t=!0)),h=!0),n&&(this[e?"mouseDownX":"mouseDownY"]=n[e?"chartX":"chartY"]))}return h&&(a?B(this,"selection",a,(()=>{delete e.selection,e.trigger="zoom",this.transform(e)})):(!t||i||this.resetZoomButton?!t&&this.resetZoomButton&&(this.resetZoomButton=this.resetZoomButton.destroy()):this.showResetZoom(),this.redraw("zoom"===c&&(this.options.chart.animation??this.pointCount<100)))),h}}return O(Q.prototype,{callbacks:[],collectionsWithInit:{xAxis:[Q.prototype.addAxis,[!0]],yAxis:[Q.prototype.addAxis,[!1]],series:[Q.prototype.addSeries]},collectionsWithUpdate:["xAxis","yAxis","series"],propsRequireDirtyBox:["backgroundColor","borderColor","borderWidth","borderRadius","plotBackgroundColor","plotBackgroundImage","plotBorderColor","plotBorderWidth","plotShadow","shadow"],propsRequireReflow:["margin","marginTop","marginRight","marginBottom","marginLeft","spacing","spacingTop","spacingRight","spacingBottom","spacingLeft"],propsRequireUpdateSeries:["chart.inverted","chart.polar","chart.ignoreHiddenSeries","chart.type","colors","plotOptions","time","tooltip"]}),Q})),i(t,"Extensions/ScrollablePlotArea.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Globals.js"],t["Core/Renderer/RendererRegistry.js"],t["Core/Utilities.js"]],(function(e,t,i,r){let{stop:n}=e,{composed:o}=t,{addEvent:s,createElement:a,css:l,defined:c,merge:u,pushUnique:h}=r;function d(){let e=this.scrollablePlotArea;(this.scrollablePixelsX||this.scrollablePixelsY)&&!e&&(this.scrollablePlotArea=e=new f(this)),e?.applyFixed()}function p(){this.chart.scrollablePlotArea&&(this.chart.scrollablePlotArea.isDirty=!0)}class f{static compose(e,t,i){h(o,this.compose)&&(s(e,"afterInit",p),s(t,"afterSetChartSize",(e=>this.afterSetSize(e.target,e))),s(t,"render",d),s(i,"show",p))}static afterSetSize(e,t){let i,r,n,{minWidth:o,minHeight:s}=e.options.chart.scrollablePlotArea||{},{clipBox:a,plotBox:l,inverted:h,renderer:d}=e;if(!d.forExport&&(o?(e.scrollablePixelsX=i=Math.max(0,o-e.chartWidth),i&&(e.scrollablePlotBox=u(e.plotBox),l.width=e.plotWidth+=i,a[h?"height":"width"]+=i,n=!0)):s&&(e.scrollablePixelsY=r=Math.max(0,s-e.chartHeight),c(r)&&(e.scrollablePlotBox=u(e.plotBox),l.height=e.plotHeight+=r,a[h?"width":"height"]+=r,n=!1)),c(n)&&!t.skipAxes))for(let c of e.axes)c.horiz===n&&(c.setAxisSize(),c.setAxisTranslation())}constructor(e){let t,r=e.options.chart,n=i.getRendererType(),o=r.scrollablePlotArea||{},c=this.moveFixedElements.bind(this),u={WebkitOverflowScrolling:"touch",overflowX:"hidden",overflowY:"hidden"};e.scrollablePixelsX&&(u.overflowX="auto"),e.scrollablePixelsY&&(u.overflowY="auto"),this.chart=e;let h=this.parentDiv=a("div",{className:"highcharts-scrolling-parent"},{position:"relative"},e.renderTo),d=this.scrollingContainer=a("div",{className:"highcharts-scrolling"},u,h),p=this.innerContainer=a("div",{className:"highcharts-inner-container"},void 0,d),f=this.fixedDiv=a("div",{className:"highcharts-fixed"},{position:"absolute",overflow:"hidden",pointerEvents:"none",zIndex:(r.style?.zIndex||0)+2,top:0},void 0,!0),m=this.fixedRenderer=new n(f,e.chartWidth,e.chartHeight,r.style);this.mask=m.path().attr({fill:r.backgroundColor||"#fff","fill-opacity":o.opacity??.85,zIndex:-1}).addClass("highcharts-scrollable-mask").add(),d.parentNode.insertBefore(f,d),l(e.renderTo,{overflow:"visible"}),s(e,"afterShowResetZoom",c),s(e,"afterApplyDrilldown",c),s(e,"afterLayOutTitles",c),s(d,"scroll",(()=>{let{pointer:i,hoverPoint:r}=e;i&&(delete i.chartPosition,r&&(t=r),i.runPointActions(void 0,t,!0))})),p.appendChild(e.container)}applyFixed(){let{chart:e,fixedRenderer:t,isDirty:i,scrollingContainer:r}=this,{axisOffset:o,chartWidth:s,chartHeight:a,container:u,plotHeight:h,plotLeft:d,plotTop:p,plotWidth:f,scrollablePixelsX:m=0,scrollablePixelsY:g=0}=e,{scrollPositionX:y=0,scrollPositionY:_=0}=e.options.chart.scrollablePlotArea||{},v=s+m,x=a+g;t.setSize(s,a),(i??!0)&&(this.isDirty=!1,this.moveFixedElements()),n(e.container),l(u,{width:`${v}px`,height:`${x}px`}),e.renderer.boxWrapper.attr({width:v,height:x,viewBox:[0,0,v,x].join(" ")}),e.chartBackground?.attr({width:v,height:x}),l(r,{width:`${s}px`,height:`${a}px`}),c(i)||(r.scrollLeft=m*y,r.scrollTop=g*_);let b=p-o[0]-1,w=d-o[3]-1,S=p+h+o[2]+1,T=d+f+o[1]+1,M=d+f-m,A=p+h-g,C=[["M",0,0]];m?C=[["M",0,b],["L",d-1,b],["L",d-1,S],["L",0,S],["Z"],["M",M,b],["L",s,b],["L",s,S],["L",M,S],["Z"]]:g&&(C=[["M",w,0],["L",w,p-1],["L",T,p-1],["L",T,0],["Z"],["M",w,A],["L",w,a],["L",T,a],["L",T,A],["Z"]]),"adjustHeight"!==e.redrawTrigger&&this.mask.attr({d:C})}moveFixedElements(){let e,{container:t,inverted:i,scrollablePixelsX:r,scrollablePixelsY:n}=this.chart,o=this.fixedRenderer,s=f.fixedSelectors;for(let a of(r&&!i?e=".highcharts-yaxis":r&&i||n&&!i?e=".highcharts-xaxis":n&&i&&(e=".highcharts-yaxis"),e&&s.push(`${e}:not(.highcharts-radial-axis)`,`${e}-labels:not(.highcharts-radial-axis-labels)`),s))[].forEach.call(t.querySelectorAll(a),(e=>{(e.namespaceURI===o.SVG_NS?o.box:o.box.parentNode).appendChild(e),e.style.pointerEvents="auto"}))}}return f.fixedSelectors=[".highcharts-breadcrumbs-group",".highcharts-contextbutton",".highcharts-caption",".highcharts-credits",".highcharts-drillup-button",".highcharts-legend",".highcharts-legend-checkbox",".highcharts-navigator-series",".highcharts-navigator-xaxis",".highcharts-navigator-yaxis",".highcharts-navigator",".highcharts-range-selector-group",".highcharts-reset-zoom",".highcharts-scrollbar",".highcharts-subtitle",".highcharts-title"],f})),i(t,"Core/Axis/Stacking/StackItem.js",[t["Core/Templating.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],(function(e,t,i){let{format:r}=e,{series:n}=t,{destroyObjectProperties:o,fireEvent:s,isNumber:a,pick:l}=i;return class{constructor(e,t,i,r,n){let o=e.chart.inverted,s=e.reversed;this.axis=e;let a=this.isNegative=!!i!=!!s;this.options=t=t||{},this.x=r,this.total=null,this.cumulative=null,this.points={},this.hasValidPoints=!1,this.stack=n,this.leftCliff=0,this.rightCliff=0,this.alignOptions={align:t.align||(o?a?"left":"right":"center"),verticalAlign:t.verticalAlign||(o?"middle":a?"bottom":"top"),y:t.y,x:t.x},this.textAlign=t.textAlign||(o?a?"right":"left":"center")}destroy(){o(this,this.axis)}render(e){let t=this.axis.chart,i=this.options,n=i.format,o=n?r(n,this,t):i.formatter.call(this);if(this.label)this.label.attr({text:o,visibility:"hidden"});else{this.label=t.renderer.label(o,null,void 0,i.shape,void 0,void 0,i.useHTML,!1,"stack-labels");let r={r:i.borderRadius||0,text:o,padding:l(i.padding,5),visibility:"hidden"};t.styledMode||(r.fill=i.backgroundColor,r.stroke=i.borderColor,r["stroke-width"]=i.borderWidth,this.label.css(i.style||{})),this.label.attr(r),this.label.added||this.label.add(e)}this.label.labelrank=t.plotSizeY,s(this,"afterRender")}setOffset(e,t,i,r,o,c){let{alignOptions:u,axis:h,label:d,options:p,textAlign:f}=this,m=h.chart,g=this.getStackBox({xOffset:e,width:t,boxBottom:i,boxTop:r,defaultX:o,xAxis:c}),{verticalAlign:y}=u;if(d&&g){let e,t=d.getBBox(void 0,0),i=d.padding,r="justify"===l(p.overflow,"justify");u.x=p.x||0,u.y=p.y||0;let{x:o,y:s}=this.adjustStackPosition({labelBox:t,verticalAlign:y,textAlign:f});g.x-=o,g.y-=s,d.align(u,!1,g),(e=m.isInsidePlot(d.alignAttr.x+u.x+o,d.alignAttr.y+u.y+s))||(r=!1),r&&n.prototype.justifyDataLabel.call(h,d,u,d.alignAttr,t,g),d.attr({x:d.alignAttr.x,y:d.alignAttr.y,rotation:p.rotation,rotationOriginX:t.width*{left:0,center:.5,right:1}[p.textAlign||"center"],rotationOriginY:t.height/2}),l(!r&&p.crop,!0)&&(e=a(d.x)&&a(d.y)&&m.isInsidePlot(d.x-i+(d.width||0),d.y)&&m.isInsidePlot(d.x+i,d.y)),d[e?"show":"hide"]()}s(this,"afterSetOffset",{xOffset:e,width:t})}adjustStackPosition(e){let{labelBox:t,verticalAlign:i,textAlign:r}=e,n={bottom:0,middle:1,top:2,right:1,center:0,left:-1},o=n[i],s=n[r];return{x:t.width/2+t.width/2*s,y:t.height/2*o}}getStackBox(e){let t=this.axis,i=t.chart,{boxTop:r,defaultX:n,xOffset:o,width:s,boxBottom:c}=e,u=t.stacking.usePercentage?100:l(r,this.total,0),h=t.toPixels(u),d=e.xAxis||i.xAxis[0],p=l(n,d.translate(this.x))+o,f=Math.abs(h-t.toPixels(c||a(t.min)&&t.logarithmic&&t.logarithmic.lin2log(t.min)||0)),m=i.inverted,g=this.isNegative;return m?{x:(g?h:h-f)-i.plotLeft,y:d.height-p-s+d.top-i.plotTop,width:f,height:s}:{x:p+d.transB-i.plotLeft,y:(g?h-f:h)-i.plotTop,width:s,height:f}}}})),i(t,"Core/Axis/Stacking/StackingAxis.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Axis/Axis.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Axis/Stacking/StackItem.js"],t["Core/Utilities.js"]],(function(e,t,i,r,n){var o;let{getDeferredAnimation:s}=e,{series:{prototype:a}}=i,{addEvent:l,correctFloat:c,defined:u,destroyObjectProperties:h,fireEvent:d,isArray:p,isNumber:f,objectEach:m,pick:g}=n;function y(){let e=this.inverted;this.axes.forEach((e=>{e.stacking&&e.stacking.stacks&&e.hasVisibleSeries&&(e.stacking.oldStacks=e.stacking.stacks)})),this.series.forEach((t=>{let i=t.xAxis&&t.xAxis.options||{};t.options.stacking&&t.reserveSpace()&&(t.stackKey=[t.type,g(t.options.stack,""),e?i.top:i.left,e?i.height:i.width].join(","))}))}function _(){let e=this.stacking;if(e){let t=e.stacks;m(t,((e,i)=>{h(e),delete t[i]})),e.stackTotalGroup?.destroy()}}function v(){this.stacking||(this.stacking=new M(this))}function x(e,t,i,r){return!u(e)||e.x!==t||r&&e.stackKey!==r?e={x:t,index:0,key:r,stackKey:r}:e.index++,e.key=[i,t,e.index].join(","),e}function b(){let e,t=this,i=t.yAxis,r=t.stackKey||"",n=i.stacking.stacks,o=t.processedXData,s=t.options.stacking,a=t[s+"Stacker"];a&&[r,"-"+r].forEach((i=>{let r,s,l,c=o.length;for(;c--;)r=o[c],e=t.getStackIndicator(e,r,t.index,i),s=n[i]?.[r],(l=s?.points[e.key||""])&&a.call(t,l,s,c)}))}function w(e,t,i){let r=t.total?100/t.total:0;e[0]=c(e[0]*r),e[1]=c(e[1]*r),this.stackedYData[i]=e[1]}function S(e){(this.is("column")||this.is("columnrange"))&&(this.options.centerInCategory&&!this.options.stacking&&this.chart.series.length>1?a.setStackedPoints.call(this,e,"group"):e.stacking.resetStacks())}function T(e,t){let i,n,o,s,a,l,h,d,f,m=t||this.options.stacking;if(!m||!this.reserveSpace()||({group:"xAxis"}[m]||"yAxis")!==e.coll)return;let y=this.processedXData,_=this.processedYData,v=[],x=_.length,b=this.options,w=b.threshold||0,S=b.startFromThreshold?w:0,T=b.stack,M=t?`${this.type},${m}`:this.stackKey||"",A="-"+M,C=this.negStacks,E=e.stacking,P=E.stacks,k=E.oldStacks;for(E.stacksTouched+=1,h=0;h<x;h++){d=y[h],f=_[h],l=(i=this.getStackIndicator(i,d,this.index)).key||"",P[a=(n=C&&f<(S?0:w))?A:M]||(P[a]={}),P[a][d]||(k[a]?.[d]?(P[a][d]=k[a][d],P[a][d].total=null):P[a][d]=new r(e,e.options.stackLabels,!!n,d,T)),o=P[a][d],null!==f?(o.points[l]=o.points[this.index]=[g(o.cumulative,S)],u(o.cumulative)||(o.base=l),o.touched=E.stacksTouched,i.index>0&&!1===this.singleStacks&&(o.points[l][0]=o.points[this.index+","+d+",0"][0])):(delete o.points[l],delete o.points[this.index]);let t=o.total||0;"percent"===m?(s=n?M:A,t=C&&P[s]?.[d]?(s=P[s][d]).total=Math.max(s.total||0,t)+Math.abs(f)||0:c(t+(Math.abs(f)||0))):"group"===m?(p(f)&&(f=f[0]),null!==f&&t++):t=c(t+(f||0)),o.cumulative="group"===m?(t||1)-1:c(g(o.cumulative,S)+(f||0)),o.total=t,null!==f&&(o.points[l].push(o.cumulative),v[h]=o.cumulative,o.hasValidPoints=!0)}"percent"===m&&(E.usePercentage=!0),"group"!==m&&(this.stackedYData=v),E.oldStacks={}}class M{constructor(e){this.oldStacks={},this.stacks={},this.stacksTouched=0,this.axis=e}buildStacks(){let e,t,i=this.axis,r=i.series,n="xAxis"===i.coll,o=i.options.reversedStacks,s=r.length;for(this.resetStacks(),this.usePercentage=!1,t=s;t--;)e=r[o?t:s-t-1],n&&e.setGroupedPoints(i),e.setStackedPoints(i);if(!n)for(t=0;t<s;t++)r[t].modifyStacks();d(i,"afterBuildStacks")}cleanStacks(){this.oldStacks&&(this.stacks=this.oldStacks,m(this.stacks,(e=>{m(e,(e=>{e.cumulative=e.total}))})))}resetStacks(){m(this.stacks,(e=>{m(e,((t,i)=>{f(t.touched)&&t.touched<this.stacksTouched?(t.destroy(),delete e[i]):(t.total=null,t.cumulative=null)}))}))}renderStackTotals(){let e=this.axis,t=e.chart,i=t.renderer,r=this.stacks,n=s(t,e.options.stackLabels?.animation||!1),o=this.stackTotalGroup=this.stackTotalGroup||i.g("stack-labels").attr({zIndex:6,opacity:0}).add();o.translate(t.plotLeft,t.plotTop),m(r,(e=>{m(e,(e=>{e.render(o)}))})),o.animate({opacity:1},n)}}return(o||(o={})).compose=function(e,t,i){let r=t.prototype,n=i.prototype;r.getStacks||(l(e,"init",v),l(e,"destroy",_),r.getStacks=y,n.getStackIndicator=x,n.modifyStacks=b,n.percentStacker=w,n.setGroupedPoints=S,n.setStackedPoints=T)},o})),i(t,"Series/Line/LineSeries.js",[t["Core/Series/Series.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],(function(e,t,i){let{defined:r,merge:n,isObject:o}=i;class s extends e{drawGraph(){let e=this.options,t=(this.gappedPath||this.getGraphPath).call(this),i=this.chart.styledMode;[this,...this.zones].forEach(((r,s)=>{let a,l=r.graph,c=l?"animate":"attr",u=r.dashStyle||e.dashStyle;l?(l.endX=this.preventGraphAnimation?null:t.xMap,l.animate({d:t})):t.length&&(r.graph=l=this.chart.renderer.path(t).addClass("highcharts-graph"+(s?` highcharts-zone-graph-${s-1} `:" ")+(s&&r.className||"")).attr({zIndex:1}).add(this.group)),l&&!i&&(a={stroke:!s&&e.lineColor||r.color||this.color||"#cccccc","stroke-width":e.lineWidth||0,fill:this.fillGraph&&this.color||"none"},u?a.dashstyle=u:"square"!==e.linecap&&(a["stroke-linecap"]=a["stroke-linejoin"]="round"),l[c](a).shadow(s<2&&e.shadow&&n({filterUnits:"userSpaceOnUse"},o(e.shadow)?e.shadow:{}))),l&&(l.startX=t.xMap,l.isArea=t.isArea)}))}getGraphPath(e,t,i){let n,o=this,s=o.options,a=[],l=[],c=s.step,u=(e=e||o.points).reversed;return u&&e.reverse(),(c={right:1,center:2}[c]||c&&3)&&u&&(c=4-c),(e=this.getValidPoints(e,!1,!(s.connectNulls&&!t&&!i))).forEach((function(u,h){let d,p=u.plotX,f=u.plotY,m=e[h-1],g=u.isNull||"number"!=typeof f;(u.leftCliff||m&&m.rightCliff)&&!i&&(n=!0),g&&!r(t)&&h>0?n=!s.connectNulls:g&&!t?n=!0:(0===h||n?d=[["M",u.plotX,u.plotY]]:o.getPointSpline?d=[o.getPointSpline(e,u,h)]:c?(d=1===c?[["L",m.plotX,f]]:2===c?[["L",(m.plotX+p)/2,m.plotY],["L",(m.plotX+p)/2,f]]:[["L",p,m.plotY]]).push(["L",p,f]):d=[["L",p,f]],l.push(u.x),c&&(l.push(u.x),2===c&&l.push(u.x)),a.push.apply(a,d),n=!1)})),a.xMap=l,o.graphPath=a,a}}return s.defaultOptions=n(e.defaultOptions,{legendSymbol:"lineMarker"}),t.registerSeriesType("line",s),s})),i(t,"Series/Area/AreaSeriesDefaults.js",[],(function(){return{threshold:0,legendSymbol:"areaMarker"}})),i(t,"Series/Area/AreaSeries.js",[t["Series/Area/AreaSeriesDefaults.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],(function(e,t,i){let{seriesTypes:{line:r}}=t,{extend:n,merge:o,objectEach:s,pick:a}=i;class l extends r{drawGraph(){this.areaPath=[],super.drawGraph.apply(this);let{areaPath:e,options:t}=this;[this,...this.zones].forEach(((i,r)=>{let n={},o=i.fillColor||t.fillColor,s=i.area,a=s?"animate":"attr";s?(s.endX=this.preventGraphAnimation?null:e.xMap,s.animate({d:e})):(n.zIndex=0,(s=i.area=this.chart.renderer.path(e).addClass("highcharts-area"+(r?` highcharts-zone-area-${r-1} `:" ")+(r&&i.className||"")).add(this.group)).isArea=!0),this.chart.styledMode||(n.fill=o||i.color||this.color,n["fill-opacity"]=o?1:t.fillOpacity??.75,s.css({pointerEvents:this.stickyTracking?"none":"auto"})),s[a](n),s.startX=e.xMap,s.shiftUnit=t.step?2:1}))}getGraphPath(e){let t,i,n,o=r.prototype.getGraphPath,s=this.options,l=s.stacking,c=this.yAxis,u=[],h=[],d=this.index,p=c.stacking.stacks[this.stackKey],f=s.threshold,m=Math.round(c.getThreshold(s.threshold)),g=a(s.connectNulls,"percent"===l),y=function(i,r,n){let o,s,a=e[i],g=l&&p[a.x].points[d],y=a[n+"Null"]||0,_=a[n+"Cliff"]||0,v=!0;_||y?(o=(y?g[0]:g[1])+_,s=g[0]+_,v=!!y):!l&&e[r]&&e[r].isNull&&(o=s=f),void 0!==o&&(h.push({plotX:t,plotY:null===o?m:c.getThreshold(o),isNull:v,isCliff:!0}),u.push({plotX:t,plotY:null===s?m:c.getThreshold(s),doCurve:!1}))};e=e||this.points,l&&(e=this.getStackPoints(e));for(let r=0,S=e.length;r<S;++r)l||(e[r].leftCliff=e[r].rightCliff=e[r].leftNull=e[r].rightNull=void 0),i=e[r].isNull,t=a(e[r].rectPlotX,e[r].plotX),n=l?a(e[r].yBottom,m):m,i&&!g||(g||y(r,r-1,"left"),i&&!l&&g||(h.push(e[r]),u.push({x:r,plotX:t,plotY:n})),g||y(r,r+1,"right"));let _=o.call(this,h,!0,!0);u.reversed=!0;let v=o.call(this,u,!0,!0),x=v[0];x&&"M"===x[0]&&(v[0]=["L",x[1],x[2]]);let b=_.concat(v);b.length&&b.push(["Z"]);let w=o.call(this,h,!1,g);return this.chart.series.length>1&&l&&h.some((e=>e.isCliff))&&(b.hasStackedCliffs=w.hasStackedCliffs=!0),b.xMap=_.xMap,this.areaPath=b,w}getStackPoints(e){let t=this,i=[],r=[],n=this.xAxis,o=this.yAxis,l=o.stacking.stacks[this.stackKey],c={},u=o.series,h=u.length,d=o.options.reversedStacks?1:-1,p=u.indexOf(t);if(e=e||this.points,this.options.stacking){for(let t=0;t<e.length;t++)e[t].leftNull=e[t].rightNull=void 0,c[e[t].x]=e[t];s(l,(function(e,t){null!==e.total&&r.push(t)})),r.sort((function(e,t){return e-t}));let f=u.map((e=>e.visible));r.forEach((function(e,s){let m,g,y=0;if(c[e]&&!c[e].isNull)i.push(c[e]),[-1,1].forEach((function(i){let n=1===i?"rightNull":"leftNull",o=l[r[s+i]],a=0;if(o){let i=p;for(;i>=0&&i<h;){let r=u[i].index;!(m=o.points[r])&&(r===t.index?c[e][n]=!0:f[i]&&(g=l[e].points[r])&&(a-=g[1]-g[0])),i+=d}}c[e][1===i?"rightCliff":"leftCliff"]=a}));else{let t=p;for(;t>=0&&t<h;){let i=u[t].index;if(m=l[e].points[i]){y=m[1];break}t+=d}y=a(y,0),y=o.translate(y,0,1,0,1),i.push({isNull:!0,plotX:n.translate(e,0,0,0,1),x:e,plotY:y,yBottom:y})}}))}return i}}return l.defaultOptions=o(r.defaultOptions,e),n(l.prototype,{singleStacks:!1}),t.registerSeriesType("area",l),l})),i(t,"Series/Spline/SplineSeries.js",[t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],(function(e,t){let{line:i}=e.seriesTypes,{merge:r,pick:n}=t;class o extends i{getPointSpline(e,t,i){let r,o,s,a,l=t.plotX||0,c=t.plotY||0,u=e[i-1],h=e[i+1];function d(e){return e&&!e.isNull&&!1!==e.doCurve&&!t.isCliff}if(d(u)&&d(h)){let e=u.plotX||0,i=u.plotY||0,n=h.plotX||0,d=h.plotY||0,p=0;r=(1.5*l+e)/2.5,o=(1.5*c+i)/2.5,s=(1.5*l+n)/2.5,a=(1.5*c+d)/2.5,s!==r&&(p=(a-o)*(s-l)/(s-r)+c-a),o+=p,a+=p,o>i&&o>c?(o=Math.max(i,c),a=2*c-o):o<i&&o<c&&(o=Math.min(i,c),a=2*c-o),a>d&&a>c?(a=Math.max(d,c),o=2*c-a):a<d&&a<c&&(a=Math.min(d,c),o=2*c-a),t.rightContX=s,t.rightContY=a,t.controlPoints={low:[r,o],high:[s,a]}}let p=["C",n(u.rightContX,u.plotX,0),n(u.rightContY,u.plotY,0),n(r,l,0),n(o,c,0),l,c];return u.rightContX=u.rightContY=void 0,p}}return o.defaultOptions=r(i.defaultOptions),e.registerSeriesType("spline",o),o})),i(t,"Series/AreaSpline/AreaSplineSeries.js",[t["Series/Spline/SplineSeries.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],(function(e,t,i){let{area:r,area:{prototype:n}}=t.seriesTypes,{extend:o,merge:s}=i;class a extends e{}return a.defaultOptions=s(e.defaultOptions,r.defaultOptions),o(a.prototype,{getGraphPath:n.getGraphPath,getStackPoints:n.getStackPoints,drawGraph:n.drawGraph}),t.registerSeriesType("areaspline",a),a})),i(t,"Series/Column/ColumnSeriesDefaults.js",[],(function(){return{borderRadius:3,centerInCategory:!1,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{halo:!1,brightness:.1},select:{color:"#cccccc",borderColor:"#000000"}},dataLabels:{align:void 0,verticalAlign:void 0,y:void 0},startFromThreshold:!0,stickyTracking:!1,tooltip:{distance:6},threshold:0,borderColor:"#ffffff"}})),i(t,"Series/Column/ColumnSeries.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Color/Color.js"],t["Series/Column/ColumnSeriesDefaults.js"],t["Core/Globals.js"],t["Core/Series/Series.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],(function(e,t,i,r,n,o,s){let{animObject:a}=e,{parse:l}=t,{noop:c}=r,{clamp:u,crisp:h,defined:d,extend:p,fireEvent:f,isArray:m,isNumber:g,merge:y,pick:_,objectEach:v}=s;class x extends n{animate(e){let t,i,r=this,n=this.yAxis,o=n.pos,s=n.reversed,l=r.options,{clipOffset:c,inverted:h}=this.chart,d={},f=h?"translateX":"translateY";e&&c?(d.scaleY=.001,i=u(n.toPixels(l.threshold),o,o+n.len),h?(i+=s?-Math.floor(c[0]):Math.ceil(c[2]),d.translateX=i-n.len):(i+=s?Math.ceil(c[0]):-Math.floor(c[2]),d.translateY=i),r.clipBox&&r.setClip(),r.group.attr(d)):(t=Number(r.group.attr(f)),r.group.animate({scaleY:1},p(a(r.options.animation),{step:function(e,i){r.group&&(d[f]=t+i.pos*(o-t),r.group.attr(d))}})))}init(e,t){super.init.apply(this,arguments);let i=this;(e=i.chart).hasRendered&&e.series.forEach((function(e){e.type===i.type&&(e.isDirty=!0)}))}getColumnMetrics(){let e,t=this,i=t.options,r=t.xAxis,n=t.yAxis,o=r.options.reversedStacks,s=r.reversed&&!o||!r.reversed&&o,a={},l=0;!1===i.grouping?l=1:t.chart.series.forEach((function(i){let r,o=i.yAxis,s=i.options;i.type===t.type&&i.reserveSpace()&&n.len===o.len&&n.pos===o.pos&&(s.stacking&&"group"!==s.stacking?(void 0===a[e=i.stackKey]&&(a[e]=l++),r=a[e]):!1!==s.grouping&&(r=l++),i.columnIndex=r)}));let c=Math.min(Math.abs(r.transA)*(!r.brokenAxis?.hasBreaks&&r.ordinal?.slope||i.pointRange||r.closestPointRange||r.tickInterval||1),r.len),u=c*i.groupPadding,h=(c-2*u)/(l||1),d=Math.min(i.maxPointWidth||r.len,_(i.pointWidth,h*(1-2*i.pointPadding))),p=(t.columnIndex||0)+(s?1:0);return t.columnMetrics={width:d,offset:(h-d)/2+(u+p*h-c/2)*(s?-1:1),paddedWidth:h,columnCount:l},t.columnMetrics}crispCol(e,t,i,r){let n=this.borderWidth,o=this.chart.inverted;return r=h(t+r,n,o)-(t=h(t,n,o)),this.options.crisp&&(i=h(e+i,n)-(e=h(e,n))),{x:e,y:t,width:i,height:r}}adjustForMissingColumns(e,t,i,r){if(!i.isNull&&r.columnCount>1){let n=this.xAxis.series.filter((e=>e.visible)).map((e=>e.index)),o=0,s=0;v(this.xAxis.stacking?.stacks,(e=>{if("number"==typeof i.x){let t=e[i.x.toString()];if(t&&m(t.points[this.index])){let e=Object.keys(t.points).filter((e=>!e.match(",")&&t.points[e]&&t.points[e].length>1)).map(parseFloat).filter((e=>-1!==n.indexOf(e))).sort(((e,t)=>t-e));o=e.indexOf(this.index),s=e.length}}})),o=this.xAxis.reversed?s-1-o:o;let a=(s-1)*r.paddedWidth+t;e=(i.plotX||0)+a/2-t-o*r.paddedWidth}return e}translate(){let e=this,t=e.chart,i=e.options,r=e.dense=e.closestPointRange*e.xAxis.transA<2,o=e.borderWidth=_(i.borderWidth,r?0:1),s=e.xAxis,a=e.yAxis,l=i.threshold,c=_(i.minPointLength,5),h=e.getColumnMetrics(),p=h.width,m=e.pointXOffset=h.offset,y=e.dataMin,v=e.dataMax,x=e.translatedThreshold=a.getThreshold(l),b=e.barW=Math.max(p,1+2*o);i.pointPadding&&(b=Math.ceil(b)),n.prototype.translate.apply(e),e.points.forEach((function(r){let n,o=_(r.yBottom,x),f=999+Math.abs(o),w=r.plotX||0,S=u(r.plotY,-f,a.len+f),T=Math.min(S,o),M=Math.max(S,o)-T,A=p,C=w+m,E=b;c&&Math.abs(M)<c&&(M=c,n=!a.reversed&&!r.negative||a.reversed&&r.negative,g(l)&&g(v)&&r.y===l&&v<=l&&(a.min||0)<l&&(y!==v||(a.max||0)<=l)&&(n=!n,r.negative=!r.negative),T=Math.abs(T-x)>c?o-c:x-(n?c:0)),d(r.options.pointWidth)&&(C-=Math.round(((A=E=Math.ceil(r.options.pointWidth))-p)/2)),i.centerInCategory&&!i.stacking&&(C=e.adjustForMissingColumns(C,A,r,h)),r.barX=C,r.pointWidth=A,r.tooltipPos=t.inverted?[u(a.len+a.pos-t.plotLeft-S,a.pos-t.plotLeft,a.len+a.pos-t.plotLeft),s.len+s.pos-t.plotTop-C-E/2,M]:[s.left-t.plotLeft+C+E/2,u(S+a.pos-t.plotTop,a.pos-t.plotTop,a.len+a.pos-t.plotTop),M],r.shapeType=e.pointClass.prototype.shapeType||"roundedRect",r.shapeArgs=e.crispCol(C,r.isNull?x:T,E,r.isNull?0:M)})),f(this,"afterColumnTranslate")}drawGraph(){this.group[this.dense?"addClass":"removeClass"]("highcharts-dense-data")}pointAttribs(e,t){let i,r,n,o=this.options,s=this.pointAttrToOptions||{},a=s.stroke||"borderColor",c=s["stroke-width"]||"borderWidth",u=e&&e.color||this.color,h=e&&e[a]||o[a]||u,d=e&&e.options.dashStyle||o.dashStyle,p=e&&e[c]||o[c]||this[c]||0,f=_(e&&e.opacity,o.opacity,1);e&&this.zones.length&&(r=e.getZone(),u=e.options.color||r&&(r.color||e.nonZonedColor)||this.color,r&&(h=r.borderColor||h,d=r.dashStyle||d,p=r.borderWidth||p)),t&&e&&(n=(i=y(o.states[t],e.options.states&&e.options.states[t]||{})).brightness,u=i.color||void 0!==n&&l(u).brighten(i.brightness).get()||u,h=i[a]||h,p=i[c]||p,d=i.dashStyle||d,f=_(i.opacity,f));let m={fill:u,stroke:h,"stroke-width":p,opacity:f};return d&&(m.dashstyle=d),m}drawPoints(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.points,i=this,r=this.chart,n=i.options,o=r.renderer,s=n.animationLimit||250;t.forEach((function(t){let a=t.plotY,l=t.graphic,c=!!l,u=l&&r.pointCount<s?"animate":"attr";g(a)&&null!==t.y?(e=t.shapeArgs,l&&t.hasNewShapeType()&&(l=l.destroy()),i.enabledDataSorting&&(t.startXPos=i.xAxis.reversed?-(e&&e.width||0):i.xAxis.width),!l&&(t.graphic=l=o[t.shapeType](e).add(t.group||i.group),l&&i.enabledDataSorting&&r.hasRendered&&r.pointCount<s&&(l.attr({x:t.startXPos}),c=!0,u="animate")),l&&c&&l[u](y(e)),r.styledMode||l[u](i.pointAttribs(t,t.selected&&"select")).shadow(!1!==t.allowShadow&&n.shadow),l&&(l.addClass(t.getClassName(),!0),l.attr({visibility:t.visible?"inherit":"hidden"}))):l&&(t.graphic=l.destroy())}))}drawTracker(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.points,i=this,r=i.chart,n=r.pointer,o=function(e){let t=n?.getPointFromEvent(e);n&&t&&i.options.enableMouseTracking&&(n.isDirectTouch=!0,t.onMouseOver(e))};t.forEach((function(t){e=m(t.dataLabels)?t.dataLabels:t.dataLabel?[t.dataLabel]:[],t.graphic&&(t.graphic.element.point=t),e.forEach((function(e){(e.div||e.element).point=t}))})),i._hasTracking||(i.trackerGroups.forEach((function(e){i[e]&&(i[e].addClass("highcharts-tracker").on("mouseover",o).on("mouseout",(function(e){n?.onTrackerMouseOut(e)})).on("touchstart",o),!r.styledMode&&i.options.cursor&&i[e].css({cursor:i.options.cursor}))})),i._hasTracking=!0),f(this,"afterDrawTracker")}remove(){let e=this,t=e.chart;t.hasRendered&&t.series.forEach((function(t){t.type===e.type&&(t.isDirty=!0)})),n.prototype.remove.apply(e,arguments)}}return x.defaultOptions=y(n.defaultOptions,i),p(x.prototype,{directTouch:!0,getSymbol:c,negStacks:!0,trackerGroups:["group","dataLabelsGroup"]}),o.registerSeriesType("column",x),x})),i(t,"Core/Series/DataLabel.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Templating.js"],t["Core/Utilities.js"]],(function(e,t,i){var r;let{getDeferredAnimation:n}=e,{format:o}=t,{defined:s,extend:a,fireEvent:l,isArray:c,isString:u,merge:h,objectEach:d,pick:p,pInt:f,splat:m}=i;return function(e){function t(){return x(this).some((e=>e?.enabled))}function i(e,t,i,r,n){let{chart:o,enabledDataSorting:l}=this,c=this.isCartesian&&o.inverted,u=e.plotX,d=e.plotY,f=i.rotation||0,m=s(u)&&s(d)&&o.isInsidePlot(u,Math.round(d),{inverted:c,paneCoordinates:!0,series:this}),g=0===f&&"justify"===p(i.overflow,l?"none":"justify"),y=this.visible&&!1!==e.visible&&s(u)&&(e.series.forceDL||l&&!g||m||p(i.inside,!!this.options.stacking)&&r&&o.isInsidePlot(u,c?r.x+1:r.y+r.height-1,{inverted:c,paneCoordinates:!0,series:this})),_=e.pos();if(y&&_){var v;let s=t.getBBox(),u=t.getBBox(void 0,0),d={right:1,center:.5}[i.align||0]||0,x={bottom:1,middle:.5}[i.verticalAlign||0]||0;if(r=a({x:_[0],y:Math.round(_[1]),width:0,height:0},r||{}),"plotEdges"===i.alignTo&&this.isCartesian&&(r[c?"x":"y"]=0,r[c?"width":"height"]=this.yAxis?.len||0),a(i,{width:s.width,height:s.height}),v=r,l&&this.xAxis&&!g&&this.setDataLabelStartPos(e,t,n,m,v),t.align(h(i,{width:u.width,height:u.height}),!1,r,!1),t.alignAttr.x+=d*(u.width-s.width),t.alignAttr.y+=x*(u.height-s.height),t[t.placed?"animate":"attr"]({x:t.alignAttr.x+(s.width-u.width)/2,y:t.alignAttr.y+(s.height-u.height)/2,rotationOriginX:(t.width||0)/2,rotationOriginY:(t.height||0)/2}),g&&r.height>=0)this.justifyDataLabel(t,i,t.alignAttr,s,r,n);else if(p(i.crop,!0)){let{x:e,y:i}=t.alignAttr;y=o.isInsidePlot(e,i,{paneCoordinates:!0,series:this})&&o.isInsidePlot(e+s.width-1,i+s.height-1,{paneCoordinates:!0,series:this})}i.shape&&!f&&t[n?"attr":"animate"]({anchorX:_[0],anchorY:_[1]})}n&&l&&(t.placed=!1),y||l&&!g?(t.show(),t.placed=!0):(t.hide(),t.placed=!1)}function r(){return this.plotGroup("dataLabelsGroup","data-labels",this.hasRendered?"inherit":"hidden",this.options.dataLabels.zIndex||6)}function g(e){let t=this.hasRendered||0,i=this.initDataLabelsGroup().attr({opacity:+t});return!t&&i&&(this.visible&&i.show(),this.options.animation?i.animate({opacity:1},e):i.attr({opacity:1})),i}function y(e){let t;e=e||this.points;let i=this,r=i.chart,a=i.options,c=r.renderer,{backgroundColor:h,plotBackgroundColor:g}=r.options.chart,y=c.getContrast(u(g)&&g||u(h)&&h||"#000000"),_=x(i),{animation:b,defer:w}=_[0],S=w?n(r,b,i):{defer:0,duration:0};l(this,"drawDataLabels"),i.hasDataLabels?.()&&(t=this.initDataLabels(S),e.forEach((e=>{let n=e.dataLabels||[];m(v(_,e.dlOptions||e.options?.dataLabels)).forEach(((h,m)=>{let g,_,v,x,b,w=h.enabled&&(e.visible||e.dataLabelOnHidden)&&(!e.isNull||e.dataLabelOnNull)&&function(e,t){let i=t.filter;if(i){let t=i.operator,r=e[i.property],n=i.value;return">"===t&&r>n||"<"===t&&r<n||">="===t&&r>=n||"<="===t&&r<=n||"=="===t&&r==n||"==="===t&&r===n||"!="===t&&r!=n||"!=="===t&&r!==n}return!0}(e,h),{backgroundColor:S,borderColor:T,distance:M,style:A={}}=h,C={},E=n[m],P=!E;w&&(_=p(h[e.formatPrefix+"Format"],h.format),g=e.getLabelConfig(),v=s(_)?o(_,g,r):(h[e.formatPrefix+"Formatter"]||h.formatter).call(g,h),x=h.rotation,!r.styledMode&&(A.color=p(h.color,A.color,u(i.color)?i.color:void 0,"#000000"),"contrast"===A.color?("none"!==S&&(b=S),e.contrastColor=c.getContrast("auto"!==b&&b||e.color||i.color),A.color=b||!s(M)&&h.inside||0>f(M||0)||a.stacking?e.contrastColor:y):delete e.contrastColor,a.cursor&&(A.cursor=a.cursor)),C={r:h.borderRadius||0,rotation:x,padding:h.padding,zIndex:1},r.styledMode||(C.fill="auto"===S?e.color:S,C.stroke="auto"===T?e.color:T,C["stroke-width"]=h.borderWidth),d(C,((e,t)=>{void 0===e&&delete C[t]}))),!E||w&&s(v)&&!!E.div==!!h.useHTML&&(E.rotation&&h.rotation||E.rotation===h.rotation)||(E=void 0,P=!0),w&&s(v)&&(E?C.text=v:(E=c.label(v,0,0,h.shape,void 0,void 0,h.useHTML,void 0,"data-label")).addClass(" highcharts-data-label-color-"+e.colorIndex+" "+(h.className||"")+(h.useHTML?" highcharts-tracker":"")),E&&(E.options=h,E.attr(C),r.styledMode?A.width&&E.css({width:A.width,textOverflow:A.textOverflow}):E.css(A).shadow(h.shadow),l(E,"beforeAddingDataLabel",{labelOptions:h,point:e}),E.added||E.add(t),i.alignDataLabel(e,E,h,void 0,P),E.isActive=!0,n[m]&&n[m]!==E&&n[m].destroy(),n[m]=E))}));let h=n.length;for(;h--;)n[h]&&n[h].isActive?n[h].isActive=!1:(n[h]?.destroy(),n.splice(h,1));e.dataLabel=n[0],e.dataLabels=n}))),l(this,"afterDrawDataLabels")}function _(e,t,i,r,n,o){let s,a,l=this.chart,c=t.align,u=t.verticalAlign,h=e.box?0:e.padding||0,d=l.inverted?this.yAxis:this.xAxis,p=d?d.left-l.plotLeft:0,f=l.inverted?this.xAxis:this.yAxis,m=f?f.top-l.plotTop:0,{x:g=0,y:y=0}=t;return(s=(i.x||0)+h+p)<0&&("right"===c&&g>=0?(t.align="left",t.inside=!0):g-=s,a=!0),(s=(i.x||0)+r.width-h+p)>l.plotWidth&&("left"===c&&g<=0?(t.align="right",t.inside=!0):g+=l.plotWidth-s,a=!0),(s=i.y+h+m)<0&&("bottom"===u&&y>=0?(t.verticalAlign="top",t.inside=!0):y-=s,a=!0),(s=(i.y||0)+r.height-h+m)>l.plotHeight&&("top"===u&&y<=0?(t.verticalAlign="bottom",t.inside=!0):y+=l.plotHeight-s,a=!0),a&&(t.x=g,t.y=y,e.placed=!o,e.align(t,void 0,n)),a}function v(e,t){let i,r=[];if(c(e)&&!c(t))r=e.map((function(e){return h(e,t)}));else if(c(t)&&!c(e))r=t.map((function(t){return h(e,t)}));else if(c(e)||c(t)){if(c(e)&&c(t))for(i=Math.max(e.length,t.length);i--;)r[i]=h(e[i],t[i])}else r=h(e,t);return r}function x(e){let t=e.chart.options.plotOptions;return m(v(v(t?.series?.dataLabels,t?.[e.type]?.dataLabels),e.options.dataLabels))}function b(e,t,i,r,n){let o=this.chart,s=o.inverted,a=this.xAxis,l=a.reversed,c=((s?t.height:t.width)||0)/2,u=e.pointWidth,h=u?u/2:0;t.startXPos=s?n.x:l?-c-h:a.width-c+h,t.startYPos=s?l?this.yAxis.height-c+h:-c-h:n.y,r?"hidden"===t.visibility&&(t.show(),t.attr({opacity:0}).animate({opacity:1})):t.attr({opacity:1}).animate({opacity:0},void 0,t.hide),o.hasRendered&&(i&&t.attr({x:t.startXPos,y:t.startYPos}),t.placed=!0)}e.compose=function(e){let n=e.prototype;n.initDataLabels||(n.initDataLabels=g,n.initDataLabelsGroup=r,n.alignDataLabel=i,n.drawDataLabels=y,n.justifyDataLabel=_,n.setDataLabelStartPos=b,n.hasDataLabels=t)}}(r||(r={})),r})),i(t,"Series/Column/ColumnDataLabel.js",[t["Core/Series/DataLabel.js"],t["Core/Globals.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],(function(e,t,i,r){var n;let{composed:o}=t,{series:s}=i,{merge:a,pick:l,pushUnique:c}=r;return function(t){function i(e,t,i,r,n){let o=this.chart.inverted,c=e.series,u=(c.xAxis?c.xAxis.len:this.chart.plotSizeX)||0,h=(c.yAxis?c.yAxis.len:this.chart.plotSizeY)||0,d=e.dlBox||e.shapeArgs,p=l(e.below,e.plotY>l(this.translatedThreshold,h)),f=l(i.inside,!!this.options.stacking);if(d){if(r=a(d),"allow"!==i.overflow||!1!==i.crop){r.y<0&&(r.height+=r.y,r.y=0);let e=r.y+r.height-h;e>0&&e<r.height-1&&(r.height-=e)}o&&(r={x:h-r.y-r.height,y:u-r.x-r.width,width:r.height,height:r.width}),f||(o?(r.x+=p?0:r.width,r.width=0):(r.y+=p?r.height:0,r.height=0))}i.align=l(i.align,!o||f?"center":p?"right":"left"),i.verticalAlign=l(i.verticalAlign,o||f?"middle":p?"top":"bottom"),s.prototype.alignDataLabel.call(this,e,t,i,r,n),i.inside&&e.contrastColor&&t.css({color:e.contrastColor})}t.compose=function(t){e.compose(s),c(o,"ColumnDataLabel")&&(t.prototype.alignDataLabel=i)}}(n||(n={})),n})),i(t,"Series/Bar/BarSeries.js",[t["Series/Column/ColumnSeries.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],(function(e,t,i){let{extend:r,merge:n}=i;class o extends e{}return o.defaultOptions=n(e.defaultOptions,{}),r(o.prototype,{inverted:!0}),t.registerSeriesType("bar",o),o})),i(t,"Series/Scatter/ScatterSeriesDefaults.js",[],(function(){return{lineWidth:0,findNearestPointBy:"xy",jitter:{x:0,y:0},marker:{enabled:!0},tooltip:{headerFormat:'<span style="color:{point.color}">\u25cf</span> <span style="font-size: 0.8em"> {series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"}}})),i(t,"Series/Scatter/ScatterSeries.js",[t["Series/Scatter/ScatterSeriesDefaults.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],(function(e,t,i){let{column:r,line:n}=t.seriesTypes,{addEvent:o,extend:s,merge:a}=i;class l extends n{applyJitter(){let e=this,t=this.options.jitter,i=this.points.length;t&&this.points.forEach((function(r,n){["x","y"].forEach((function(o,s){if(t[o]&&!r.isNull){let a=`plot${o.toUpperCase()}`,l=e[`${o}Axis`],c=t[o]*l.transA;if(l&&!l.logarithmic){let e=Math.max(0,(r[a]||0)-c),t=Math.min(l.len,(r[a]||0)+c);r[a]=e+(t-e)*function(e){let t=1e4*Math.sin(e);return t-Math.floor(t)}(n+s*i),"x"===o&&(r.clientX=r.plotX)}}}))}))}drawGraph(){this.options.lineWidth?super.drawGraph():this.graph&&(this.graph=this.graph.destroy())}}return l.defaultOptions=a(n.defaultOptions,e),s(l.prototype,{drawTracker:r.prototype.drawTracker,sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","markerGroup","dataLabelsGroup"]}),o(l,"afterTranslate",(function(){this.applyJitter()})),t.registerSeriesType("scatter",l),l})),i(t,"Series/CenteredUtilities.js",[t["Core/Globals.js"],t["Core/Series/Series.js"],t["Core/Utilities.js"]],(function(e,t,i){var r,n;let{deg2rad:o}=e,{fireEvent:s,isNumber:a,pick:l,relativeLength:c}=i;return(n=r||(r={})).getCenter=function(){let e,i,r,n=this.options,o=this.chart,u=2*(n.slicedOffset||0),h=o.plotWidth-2*u,d=o.plotHeight-2*u,p=n.center,f=Math.min(h,d),m=n.thickness,g=n.size,y=n.innerSize||0;"string"==typeof g&&(g=parseFloat(g)),"string"==typeof y&&(y=parseFloat(y));let _=[l(p[0],"50%"),l(p[1],"50%"),l(g&&g<0?void 0:n.size,"100%"),l(y&&y<0?void 0:n.innerSize||0,"0%")];for(!o.angular||this instanceof t||(_[3]=0),i=0;i<4;++i)r=_[i],e=i<2||2===i&&/%$/.test(r),_[i]=c(r,[h,d,f,_[2]][i])+(e?u:0);return _[3]>_[2]&&(_[3]=_[2]),a(m)&&2*m<_[2]&&m>0&&(_[3]=_[2]-2*m),s(this,"afterGetCenter",{positions:_}),_},n.getStartAndEndRadians=function(e,t){let i=a(e)?e:0,r=a(t)&&t>i&&t-i<360?t:i+360;return{start:o*(i+-90),end:o*(r+-90)}},r})),i(t,"Series/Pie/PiePoint.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Series/Point.js"],t["Core/Utilities.js"]],(function(e,t,i){let{setAnimation:r}=e,{addEvent:n,defined:o,extend:s,isNumber:a,pick:l,relativeLength:c}=i;class u extends t{getConnectorPath(e){let t=e.dataLabelPosition,i=e.options||{},r=i.connectorShape,n=this.connectorShapes[r]||r;return t&&n.call(this,{...t.computed,alignment:t.alignment},t.connectorPosition,i)||[]}getTranslate(){return this.sliced&&this.slicedTranslation||{translateX:0,translateY:0}}haloPath(e){let t=this.shapeArgs;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(t.x,t.y,t.r+e,t.r+e,{innerR:t.r-1,start:t.start,end:t.end,borderRadius:t.borderRadius})}constructor(e,t,i){super(e,t,i),this.half=0,this.name??(this.name="Slice");let r=e=>{this.slice("select"===e.type)};n(this,"select",r),n(this,"unselect",r)}isValid(){return a(this.y)&&this.y>=0}setVisible(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e!==this.visible&&this.update({visible:e??!this.visible},t,void 0,!1)}slice(e,t,i){let n=this.series;r(i,n.chart),t=l(t,!0),this.sliced=this.options.sliced=e=o(e)?e:!this.sliced,n.options.data[n.data.indexOf(this)]=this.options,this.graphic&&this.graphic.animate(this.getTranslate())}}return s(u.prototype,{connectorShapes:{fixedOffset:function(e,t,i){let r=t.breakAt,n=t.touchingSliceAt,o=i.softConnector?["C",e.x+("left"===e.alignment?-5:5),e.y,2*r.x-n.x,2*r.y-n.y,r.x,r.y]:["L",r.x,r.y];return[["M",e.x,e.y],o,["L",n.x,n.y]]},straight:function(e,t){let i=t.touchingSliceAt;return[["M",e.x,e.y],["L",i.x,i.y]]},crookedLine:function(e,t,i){let{breakAt:r,touchingSliceAt:n}=t,{series:o}=this,[s,a,l]=o.center,u=l/2,{plotLeft:h,plotWidth:d}=o.chart,p="left"===e.alignment,{x:f,y:m}=e,g=r.x;if(i.crookDistance){let e=c(i.crookDistance,1);g=p?s+u+(d+h-s-u)*(1-e):h+(s-u)*e}else g=s+(a-m)*Math.tan((this.angle||0)-Math.PI/2);let y=[["M",f,m]];return(p?g<=f&&g>=r.x:g>=f&&g<=r.x)&&y.push(["L",g,m]),y.push(["L",r.x,r.y],["L",n.x,n.y]),y}}}),u})),i(t,"Series/Pie/PieSeriesDefaults.js",[],(function(){return{borderRadius:3,center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{connectorPadding:5,connectorShape:"crookedLine",crookDistance:void 0,distance:30,enabled:!0,formatter:function(){return this.point.isNull?void 0:this.point.name},softConnector:!0,x:0},fillColor:void 0,ignoreHiddenPoint:!0,inactiveOtherPoints:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,stickyTracking:!1,tooltip:{followPointer:!0},borderColor:"#ffffff",borderWidth:1,lineWidth:void 0,states:{hover:{brightness:.1}}}})),i(t,"Series/Pie/PieSeries.js",[t["Series/CenteredUtilities.js"],t["Series/Column/ColumnSeries.js"],t["Core/Globals.js"],t["Series/Pie/PiePoint.js"],t["Series/Pie/PieSeriesDefaults.js"],t["Core/Series/Series.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Renderer/SVG/Symbols.js"],t["Core/Utilities.js"]],(function(e,t,i,r,n,o,s,a,l){let{getStartAndEndRadians:c}=e,{noop:u}=i,{clamp:h,extend:d,fireEvent:p,merge:f,pick:m}=l;class g extends o{animate(e){let t=this,i=t.points,r=t.startAngleRad;e||i.forEach((function(e){let i=e.graphic,n=e.shapeArgs;i&&n&&(i.attr({r:m(e.startR,t.center&&t.center[3]/2),start:r,end:r}),i.animate({r:n.r,start:n.start,end:n.end},t.options.animation))}))}drawEmpty(){let e,t,i=this.startAngleRad,r=this.endAngleRad,n=this.options;0===this.total&&this.center?(e=this.center[0],t=this.center[1],this.graph||(this.graph=this.chart.renderer.arc(e,t,this.center[1]/2,0,i,r).addClass("highcharts-empty-series").add(this.group)),this.graph.attr({d:a.arc(e,t,this.center[2]/2,0,{start:i,end:r,innerR:this.center[3]/2})}),this.chart.styledMode||this.graph.attr({"stroke-width":n.borderWidth,fill:n.fillColor||"none",stroke:n.color||"#cccccc"})):this.graph&&(this.graph=this.graph.destroy())}drawPoints(){let e=this.chart.renderer;this.points.forEach((function(t){t.graphic&&t.hasNewShapeType()&&(t.graphic=t.graphic.destroy()),t.graphic||(t.graphic=e[t.shapeType](t.shapeArgs).add(t.series.group),t.delayedRendering=!0)}))}generatePoints(){super.generatePoints(),this.updateTotals()}getX(e,t,i,r){let n=this.center,o=this.radii?this.radii[i.index]||0:n[2]/2,s=r.dataLabelPosition,a=s?.distance||0,l=Math.asin(h((e-n[1])/(o+a),-1,1));return n[0]+Math.cos(l)*(o+a)*(t?-1:1)+(a>0?(t?-1:1)*(r.padding||0):0)}hasData(){return!!this.processedXData.length}redrawPoints(){let e,t,i,r,n=this,o=n.chart;this.drawEmpty(),n.group&&!o.styledMode&&n.group.shadow(n.options.shadow),n.points.forEach((function(s){let a={};t=s.graphic,!s.isNull&&t?(r=s.shapeArgs,e=s.getTranslate(),o.styledMode||(i=n.pointAttribs(s,s.selected&&"select")),s.delayedRendering?(t.setRadialReference(n.center).attr(r).attr(e),o.styledMode||t.attr(i).attr({"stroke-linejoin":"round"}),s.delayedRendering=!1):(t.setRadialReference(n.center),o.styledMode||f(!0,a,i),f(!0,a,r,e),t.animate(a)),t.attr({visibility:s.visible?"inherit":"hidden"}),t.addClass(s.getClassName(),!0)):t&&(s.graphic=t.destroy())}))}sortByAngle(e,t){e.sort((function(e,i){return void 0!==e.angle&&(i.angle-e.angle)*t}))}translate(e){p(this,"translate"),this.generatePoints();let t,i,r,n,o,s,a,l=this.options,u=l.slicedOffset,h=c(l.startAngle,l.endAngle),d=this.startAngleRad=h.start,f=(this.endAngleRad=h.end)-d,m=this.points,g=l.ignoreHiddenPoint,y=m.length,_=0;for(e||(this.center=e=this.getCenter()),s=0;s<y;s++){a=m[s],t=d+_*f,a.isValid()&&(!g||a.visible)&&(_+=a.percentage/100),i=d+_*f;let l={x:e[0],y:e[1],r:e[2]/2,innerR:e[3]/2,start:Math.round(1e3*t)/1e3,end:Math.round(1e3*i)/1e3};a.shapeType="arc",a.shapeArgs=l,(r=(i+t)/2)>1.5*Math.PI?r-=2*Math.PI:r<-Math.PI/2&&(r+=2*Math.PI),a.slicedTranslation={translateX:Math.round(Math.cos(r)*u),translateY:Math.round(Math.sin(r)*u)},n=Math.cos(r)*e[2]/2,o=Math.sin(r)*e[2]/2,a.tooltipPos=[e[0]+.7*n,e[1]+.7*o],a.half=r<-Math.PI/2||r>Math.PI/2?1:0,a.angle=r}p(this,"afterTranslate")}updateTotals(){let e,t,i=this.points,r=i.length,n=this.options.ignoreHiddenPoint,o=0;for(e=0;e<r;e++)(t=i[e]).isValid()&&(!n||t.visible)&&(o+=t.y);for(e=0,this.total=o;e<r;e++)(t=i[e]).percentage=o>0&&(t.visible||!n)?t.y/o*100:0,t.total=o}}return g.defaultOptions=f(o.defaultOptions,n),d(g.prototype,{axisTypes:[],directTouch:!0,drawGraph:void 0,drawTracker:t.prototype.drawTracker,getCenter:e.getCenter,getSymbol:u,invertible:!1,isCartesian:!1,noSharedTooltip:!0,pointAttribs:t.prototype.pointAttribs,pointClass:r,requireSorting:!1,searchPoint:u,trackerGroups:["group","dataLabelsGroup"]}),s.registerSeriesType("pie",g),g})),i(t,"Series/Pie/PieDataLabel.js",[t["Core/Series/DataLabel.js"],t["Core/Globals.js"],t["Core/Renderer/RendererUtilities.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],(function(e,t,i,r,n){var o;let{composed:s,noop:a}=t,{distribute:l}=i,{series:c}=r,{arrayMax:u,clamp:h,defined:d,pick:p,pushUnique:f,relativeLength:m}=n;return function(t){let i={radialDistributionY:function(e,t){return(t.dataLabelPosition?.top||0)+e.distributeBox.pos},radialDistributionX:function(e,t,i,r,n){let o=n.dataLabelPosition;return e.getX(i<(o?.top||0)+2||i>(o?.bottom||0)-2?r:i,t.half,t,n)},justify:function(e,t,i,r){return r[0]+(e.half?-1:1)*(i+(t.dataLabelPosition?.distance||0))},alignToPlotEdges:function(e,t,i,r){let n=e.getBBox().width;return t?n+r:i-n-r},alignToConnectors:function(e,t,i,r){let n,o=0;return e.forEach((function(e){(n=e.dataLabel.getBBox().width)>o&&(o=n)})),t?o+r:i-o-r}};function r(e,t){let{center:i,options:r}=this,n=i[2]/2,o=e.angle||0,s=Math.cos(o),a=Math.sin(o),l=i[0]+s*n,c=i[1]+a*n,u=Math.min((r.slicedOffset||0)+(r.borderWidth||0),t/5);return{natural:{x:l+s*t,y:c+a*t},computed:{},alignment:t<0?"center":e.half?"right":"left",connectorPosition:{breakAt:{x:l+s*u,y:c+a*u},touchingSliceAt:{x:l,y:c}},distance:t}}function n(){let e,t,i,r=this,n=r.points,o=r.chart,s=o.plotWidth,a=o.plotHeight,h=o.plotLeft,f=Math.round(o.chartWidth/3),g=r.center,y=g[2]/2,_=g[1],v=[[],[]],x=[0,0,0,0],b=r.dataLabelPositioners,w=0;r.visible&&r.hasDataLabels?.()&&(n.forEach((e=>{(e.dataLabels||[]).forEach((e=>{e.shortened&&(e.attr({width:"auto"}).css({width:"auto",textOverflow:"clip"}),e.shortened=!1)}))})),c.prototype.drawDataLabels.apply(r),n.forEach((e=>{(e.dataLabels||[]).forEach(((t,i)=>{let r=g[2]/2,n=t.options,o=m(n?.distance||0,r);0===i&&v[e.half].push(e),!d(n?.style?.width)&&t.getBBox().width>f&&(t.css({width:Math.round(.7*f)+"px"}),t.shortened=!0),t.dataLabelPosition=this.getDataLabelPosition(e,o),w=Math.max(w,o)}))})),v.forEach(((e,n)=>{let c,u,f,m=e.length,v=[],S=0;m&&(r.sortByAngle(e,n-.5),w>0&&(c=Math.max(0,_-y-w),u=Math.min(_+y+w,o.plotHeight),e.forEach((e=>{(e.dataLabels||[]).forEach((t=>{let i=t.dataLabelPosition;i&&i.distance>0&&(i.top=Math.max(0,_-y-i.distance),i.bottom=Math.min(_+y+i.distance,o.plotHeight),S=t.getBBox().height||21,t.lineHeight=o.renderer.fontMetrics(t.text||t).h+2*t.padding,e.distributeBox={target:(t.dataLabelPosition?.natural.y||0)-i.top+t.lineHeight/2,size:S,rank:e.y},v.push(e.distributeBox))}))})),l(v,f=u+S-c,f/5)),e.forEach((o=>{(o.dataLabels||[]).forEach((l=>{let c=l.options||{},u=o.distributeBox,f=l.dataLabelPosition,m=f?.natural.y||0,_=c.connectorPadding||0,w=l.lineHeight||21,S=(w-l.getBBox().height)/2,T=0,M=m,A="inherit";if(f){if(v&&d(u)&&f.distance>0&&(void 0===u.pos?A="hidden":(i=u.size,M=b.radialDistributionY(o,l))),c.justify)T=b.justify(o,l,y,g);else switch(c.alignTo){case"connectors":T=b.alignToConnectors(e,n,s,h);break;case"plotEdges":T=b.alignToPlotEdges(l,n,s,h);break;default:T=b.radialDistributionX(r,o,M-S,m,l)}if(f.attribs={visibility:A,align:f.alignment},f.posAttribs={x:T+(c.x||0)+({left:_,right:-_}[f.alignment]||0),y:M+(c.y||0)-w/2},f.computed.x=T,f.computed.y=M-S,p(c.crop,!0)){let e;T-(t=l.getBBox().width)<_&&1===n?(e=Math.round(t-T+_),x[3]=Math.max(e,x[3])):T+t>s-_&&0===n&&(e=Math.round(T+t-s+_),x[1]=Math.max(e,x[1])),M-i/2<0?x[0]=Math.max(Math.round(i/2-M),x[0]):M+i/2>a&&(x[2]=Math.max(Math.round(M+i/2-a),x[2])),f.sideOverflow=e}}}))})))})),(0===u(x)||this.verifyDataLabelOverflow(x))&&(this.placeDataLabels(),this.points.forEach((t=>{(t.dataLabels||[]).forEach((i=>{let{connectorColor:n,connectorWidth:s=1}=i.options||{},a=i.dataLabelPosition;if(s){let l;e=i.connector,a&&a.distance>0?(l=!e,e||(i.connector=e=o.renderer.path().addClass("highcharts-data-label-connector  highcharts-color-"+t.colorIndex+(t.className?" "+t.className:"")).add(r.dataLabelsGroup)),o.styledMode||e.attr({"stroke-width":s,stroke:n||t.color||"#666666"}),e[l?"attr":"animate"]({d:t.getConnectorPath(i)}),e.attr({visibility:a.attribs?.visibility})):e&&(i.connector=e.destroy())}}))}))))}function o(){this.points.forEach((e=>{(e.dataLabels||[]).forEach((e=>{let t=e.dataLabelPosition;t?(t.sideOverflow&&(e.css({width:Math.max(e.getBBox().width-t.sideOverflow,0)+"px",textOverflow:(e.options?.style||{}).textOverflow||"ellipsis"}),e.shortened=!0),e.attr(t.attribs),e[e.moved?"animate":"attr"](t.posAttribs),e.moved=!0):e&&e.attr({y:-9999})})),delete e.distributeBox}),this)}function g(e){let t=this.center,i=this.options,r=i.center,n=i.minSize||80,o=n,s=null!==i.size;return!s&&(null!==r[0]?o=Math.max(t[2]-Math.max(e[1],e[3]),n):(o=Math.max(t[2]-e[1]-e[3],n),t[0]+=(e[3]-e[1])/2),null!==r[1]?o=h(o,n,t[2]-Math.max(e[0],e[2])):(o=h(o,n,t[2]-e[0]-e[2]),t[1]+=(e[0]-e[2])/2),o<t[2]?(t[2]=o,t[3]=Math.min(i.thickness?Math.max(0,o-2*i.thickness):Math.max(0,m(i.innerSize||0,o)),o),this.translate(t),this.drawDataLabels&&this.drawDataLabels()):s=!0),s}t.compose=function(t){if(e.compose(c),f(s,"PieDataLabel")){let e=t.prototype;e.dataLabelPositioners=i,e.alignDataLabel=a,e.drawDataLabels=n,e.getDataLabelPosition=r,e.placeDataLabels=o,e.verifyDataLabelOverflow=g}}}(o||(o={})),o})),i(t,"Core/Geometry/GeometryUtilities.js",[],(function(){var e,t;return(t=e||(e={})).getCenterOfPoints=function(e){let t=e.reduce(((e,t)=>(e.x+=t.x,e.y+=t.y,e)),{x:0,y:0});return{x:t.x/e.length,y:t.y/e.length}},t.getDistanceBetweenPoints=function(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},t.getAngleBetweenPoints=function(e,t){return Math.atan2(t.x-e.x,t.y-e.y)},t.pointInPolygon=function(e,t){let i,r,{x:n,y:o}=e,s=t.length,a=!1;for(i=0,r=s-1;i<s;r=i++){let[e,s]=t[i],[l,c]=t[r];s>o!=c>o&&n<(l-e)*(o-s)/(c-s)+e&&(a=!a)}return a},e})),i(t,"Extensions/OverlappingDataLabels.js",[t["Core/Geometry/GeometryUtilities.js"],t["Core/Utilities.js"]],(function(e,t){let{pointInPolygon:i}=e,{addEvent:r,fireEvent:n,objectEach:o,pick:s}=t;function a(e){let t,r,o,s,a,c=e.length,u=(e,t)=>!(t.x>=e.x+e.width||t.x+t.width<=e.x||t.y>=e.y+e.height||t.y+t.height<=e.y),h=(e,t)=>{for(let r of e)if(i({x:r[0],y:r[1]},t))return!0;return!1},d=!1;for(let i=0;i<c;i++)(t=e[i])&&(t.oldOpacity=t.opacity,t.newOpacity=1,t.absoluteBox=function(e){if(e&&(!e.alignAttr||e.placed)){let t=e.box?0:e.padding||0,i=e.alignAttr||{x:e.attr("x"),y:e.attr("y")},r=e.getBBox();return e.width=r.width,e.height=r.height,{x:i.x+(e.parentGroup?.translateX||0)+t,y:i.y+(e.parentGroup?.translateY||0)+t,width:(e.width||0)-2*t,height:(e.height||0)-2*t,polygon:r?.polygon}}}(t));e.sort(((e,t)=>(t.labelrank||0)-(e.labelrank||0)));for(let i=0;i<c;++i){s=(r=e[i])&&r.absoluteBox;let t=s?.polygon;for(let n=i+1;n<c;++n){a=(o=e[n])&&o.absoluteBox;let i=!1;if(s&&a&&r!==o&&0!==r.newOpacity&&0!==o.newOpacity&&"hidden"!==r.visibility&&"hidden"!==o.visibility){let e=a.polygon;if(t&&e&&t!==e?h(t,e)&&(i=!0):u(s,a)&&(i=!0),i){let e=r.labelrank<o.labelrank?r:o,t=e.text;e.newOpacity=0,t?.element.querySelector("textPath")&&t.hide()}}}}for(let i of e)l(i,this)&&(d=!0);d&&n(this,"afterHideAllOverlappingLabels")}function l(e,t){let i,r,o=!1;return e&&(r=e.newOpacity,e.oldOpacity!==r&&(e.hasClass("highcharts-data-label")?(e[r?"removeClass":"addClass"]("highcharts-data-label-hidden"),i=function(){t.styledMode||e.css({pointerEvents:r?"auto":"none"})},o=!0,e[e.isOld?"animate":"attr"]({opacity:r},void 0,i),n(t,"afterHideOverlappingLabel")):e.attr({opacity:r})),e.isOld=!0),o}function c(){let e=this,t=[];for(let i of e.labelCollectors||[])t=t.concat(i());for(let i of e.yAxis||[])i.stacking&&i.options.stackLabels&&!i.options.stackLabels.allowOverlap&&o(i.stacking.stacks,(e=>{o(e,(e=>{e.label&&t.push(e.label)}))}));for(let i of e.series||[])if(i.visible&&i.hasDataLabels?.()){let r=i=>{for(let r of i)r.visible&&(r.dataLabels||[]).forEach((i=>{let n=i.options||{};i.labelrank=s(n.labelrank,r.labelrank,r.shapeArgs?.height),n.allowOverlap??Number(n.distance)>0?(i.oldOpacity=i.opacity,i.newOpacity=1,l(i,e)):t.push(i)}))};r(i.nodes||[]),r(i.points)}this.hideOverlappingLabels(t)}return{compose:function(e){let t=e.prototype;t.hideOverlappingLabels||(t.hideOverlappingLabels=a,r(e,"render",c))}}})),i(t,"Extensions/BorderRadius.js",[t["Core/Defaults.js"],t["Core/Globals.js"],t["Core/Utilities.js"]],(function(e,t,i){let{defaultOptions:r}=e,{noop:n}=t,{addEvent:o,extend:s,isObject:a,merge:l,relativeLength:c}=i,u={radius:0,scope:"stack",where:void 0},h=n,d=n;function p(e,t,i,r){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=h(e,t,i,r,n),{innerR:s=0,r:a=i,start:l=0,end:u=0}=n;if(n.open||!n.borderRadius)return o;let d=u-l,p=Math.sin(d/2),f=Math.max(Math.min(c(n.borderRadius||0,a-s),(a-s)/2,a*p/(1+p)),0),m=Math.min(f,d/Math.PI*2*s),g=o.length-1;for(;g--;)!function(e,t,i){let r,n,o,s=e[t],a=e[t+1];if("Z"===a[0]&&(a=e[0]),"M"!==s[0]&&"L"!==s[0]||"A"!==a[0]?"A"===s[0]&&("M"===a[0]||"L"===a[0])&&(r=a,n=s):(r=s,n=a,o=!0),r&&n&&n.params){let s=n[1],a=n[5],l=n.params,{start:c,end:u,cx:h,cy:d}=l,p=a?s-i:s+i,f=p?Math.asin(i/p):0,m=a?f:-f,g=Math.cos(f)*p;o?(l.start=c+m,r[1]=h+g*Math.cos(c),r[2]=d+g*Math.sin(c),e.splice(t+1,0,["A",i,i,0,0,1,h+s*Math.cos(l.start),d+s*Math.sin(l.start)])):(l.end=u-m,n[6]=h+s*Math.cos(l.end),n[7]=d+s*Math.sin(l.end),e.splice(t+1,0,["A",i,i,0,0,1,h+g*Math.cos(u),d+g*Math.sin(u)])),n[4]=Math.abs(l.end-l.start)<Math.PI?0:1}}(o,g,g>1?m:f);return o}function f(){if(this.options.borderRadius&&(!this.chart.is3d||!this.chart.is3d())){let{options:e,yAxis:t}=this,i="percent"===e.stacking,n=r.plotOptions?.[this.type]?.borderRadius,o=m(e.borderRadius,a(n)?n:{}),l=t.options.reversed;for(let r of this.points){let{shapeArgs:n}=r;if("roundedRect"===r.shapeType&&n){let{width:a=0,height:u=0,y:h=0}=n,d=h,p=u;if("stack"===o.scope&&r.stackTotal){let n=t.translate(i?100:r.stackTotal,!1,!0,!1,!0),o=t.translate(e.threshold||0,!1,!0,!1,!0),s=this.crispCol(0,Math.min(n,o),0,Math.abs(n-o));d=s.y,p=s.height}let f=(r.negative?-1:1)*(l?-1:1)==-1,m=o.where;!m&&this.is("waterfall")&&Math.abs((r.yBottom||0)-(this.translatedThreshold||0))>this.borderWidth&&(m="all"),m||(m="end");let g=Math.min(c(o.radius,a),a/2,"all"===m?u/2:1/0)||0;"end"===m&&(f&&(d-=g),p+=g),s(n,{brBoxHeight:p,brBoxY:d,r:g})}}}}function m(e,t){return a(e)||(e={radius:e||0}),l(u,t,e)}function g(){let e=m(this.options.borderRadius);for(let t of this.points){let i=t.shapeArgs;i&&(i.borderRadius=c(e.radius,(i.r||0)-(i.innerR||0)))}}function y(e,t,i,r){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=d(e,t,i,r,n),{r:s=0,brBoxHeight:a=r,brBoxY:l=t}=n,c=t-l,u=l+a-(t+r),h=c-s>-.1?0:s,p=u-s>-.1?0:s,f=Math.max(h&&c,0),m=Math.max(p&&u,0),g=[e+h,t],y=[e+i-h,t],_=[e+i,t+h],v=[e+i,t+r-p],x=[e+i-p,t+r],b=[e+p,t+r],w=[e,t+r-p],S=[e,t+h],T=(e,t)=>Math.sqrt(Math.pow(e,2)-Math.pow(t,2));if(f){let e=T(h,h-f);g[0]-=e,y[0]+=e,_[1]=S[1]=t+h-f}if(r<h-f){let n=T(h,h-f-r);_[0]=v[0]=e+i-h+n,x[0]=Math.min(_[0],x[0]),b[0]=Math.max(v[0],b[0]),w[0]=S[0]=e+h-n,_[1]=S[1]=t+r}if(m){let e=T(p,p-m);x[0]+=e,b[0]-=e,v[1]=w[1]=t+r-p+m}if(r<p-m){let n=T(p,p-m-r);_[0]=v[0]=e+i-p+n,y[0]=Math.min(_[0],y[0]),g[0]=Math.max(v[0],g[0]),w[0]=S[0]=e+p-n,v[1]=w[1]=t}return o.length=0,o.push(["M",...g],["L",...y],["A",h,h,0,0,1,..._],["L",...v],["A",p,p,0,0,1,...x],["L",...b],["A",p,p,0,0,1,...w],["L",...S],["A",h,h,0,0,1,...g],["Z"]),o}return{compose:function(e,t,i){let r=e.types.pie;if(!t.symbolCustomAttribs.includes("borderRadius")){let n=i.prototype.symbols;o(e,"afterColumnTranslate",f,{order:9}),o(r,"afterTranslate",g),t.symbolCustomAttribs.push("borderRadius","brBoxHeight","brBoxY"),h=n.arc,d=n.roundedRect,n.arc=p,n.roundedRect=y}},optionsToObject:m}})),i(t,"Core/Responsive.js",[t["Core/Utilities.js"]],(function(e){var t;let{diffObjects:i,extend:r,find:n,merge:o,pick:s,uniqueKey:a}=e;return function(e){function t(e,t){let i=e.condition;(i.callback||function(){return this.chartWidth<=s(i.maxWidth,Number.MAX_VALUE)&&this.chartHeight<=s(i.maxHeight,Number.MAX_VALUE)&&this.chartWidth>=s(i.minWidth,0)&&this.chartHeight>=s(i.minHeight,0)}).call(this)&&t.push(e._id)}function l(e,t){let r,s=this.options.responsive,l=this.currentResponsive,c=[];!t&&s&&s.rules&&s.rules.forEach((e=>{void 0===e._id&&(e._id=a()),this.matchResponsiveRule(e,c)}),this);let u=o(...c.map((e=>n((s||{}).rules||[],(t=>t._id===e)))).map((e=>e&&e.chartOptions)));u.isResponsiveOptions=!0,c=c.toString()||void 0;let h=l&&l.ruleIds;c===h||(l&&(this.currentResponsive=void 0,this.updatingResponsive=!0,this.update(l.undoOptions,e,!0),this.updatingResponsive=!1),c?((r=i(u,this.options,!0,this.collectionsWithUpdate)).isResponsiveOptions=!0,this.currentResponsive={ruleIds:c,mergedOptions:u,undoOptions:r},this.updatingResponsive||this.update(u,e,!0)):this.currentResponsive=void 0)}e.compose=function(e){let i=e.prototype;return i.matchResponsiveRule||r(i,{matchResponsiveRule:t,setResponsive:l}),e}}(t||(t={})),t})),i(t,"masters/highcharts.src.js",[t["Core/Globals.js"],t["Core/Utilities.js"],t["Core/Defaults.js"],t["Core/Animation/Fx.js"],t["Core/Animation/AnimationUtilities.js"],t["Core/Renderer/HTML/AST.js"],t["Core/Templating.js"],t["Core/Renderer/RendererRegistry.js"],t["Core/Renderer/RendererUtilities.js"],t["Core/Renderer/SVG/SVGElement.js"],t["Core/Renderer/SVG/SVGRenderer.js"],t["Core/Renderer/HTML/HTMLElement.js"],t["Core/Axis/Axis.js"],t["Core/Axis/DateTimeAxis.js"],t["Core/Axis/LogarithmicAxis.js"],t["Core/Axis/PlotLineOrBand/PlotLineOrBand.js"],t["Core/Axis/Tick.js"],t["Core/Tooltip.js"],t["Core/Series/Point.js"],t["Core/Pointer.js"],t["Core/Legend/Legend.js"],t["Core/Legend/LegendSymbol.js"],t["Core/Chart/Chart.js"],t["Extensions/ScrollablePlotArea.js"],t["Core/Axis/Stacking/StackingAxis.js"],t["Core/Axis/Stacking/StackItem.js"],t["Core/Series/Series.js"],t["Core/Series/SeriesRegistry.js"],t["Series/Column/ColumnDataLabel.js"],t["Series/Pie/PieDataLabel.js"],t["Core/Series/DataLabel.js"],t["Extensions/OverlappingDataLabels.js"],t["Extensions/BorderRadius.js"],t["Core/Responsive.js"],t["Core/Color/Color.js"],t["Core/Time.js"]],(function(e,t,i,r,n,o,s,a,l,c,u,h,d,p,f,m,g,y,_,v,x,b,w,S,T,M,A,C,E,P,k,I,D,L,R,z){return e.AST=o,e.Axis=d,e.Chart=w,e.Color=R,e.DataLabel=k,e.Fx=r,e.HTMLElement=h,e.Legend=x,e.LegendSymbol=b,e.OverlappingDataLabels=e.OverlappingDataLabels||I,e.PlotLineOrBand=m,e.Point=_,e.Pointer=v,e.RendererRegistry=a,e.Series=A,e.SeriesRegistry=C,e.StackItem=M,e.SVGElement=c,e.SVGRenderer=u,e.Templating=s,e.Tick=g,e.Time=z,e.Tooltip=y,e.animate=n.animate,e.animObject=n.animObject,e.chart=w.chart,e.color=R.parse,e.dateFormat=s.dateFormat,e.defaultOptions=i.defaultOptions,e.distribute=l.distribute,e.format=s.format,e.getDeferredAnimation=n.getDeferredAnimation,e.getOptions=i.getOptions,e.numberFormat=s.numberFormat,e.seriesType=C.seriesType,e.setAnimation=n.setAnimation,e.setOptions=i.setOptions,e.stop=n.stop,e.time=i.defaultTime,e.timers=r.timers,D.compose(e.Series,e.SVGElement,e.SVGRenderer),E.compose(e.Series.types.column),k.compose(e.Series),p.compose(e.Axis),h.compose(e.SVGRenderer),x.compose(e.Chart),f.compose(e.Axis),I.compose(e.Chart),P.compose(e.Series.types.pie),m.compose(e.Chart,e.Axis),v.compose(e.Chart),L.compose(e.Chart),S.compose(e.Axis,e.Chart,e.Series),T.compose(e.Axis,e.Chart,e.Series),y.compose(e.Pointer),t.extend(e,t),e})),t["masters/highcharts.src.js"]._modules=t,t["masters/highcharts.src.js"]},e.exports?(o.default=o,e.exports=n&&n.document?o(n):o):void 0===(r=function(){return o(n)}.call(t,i,t,e))||(e.exports=r)},3763:(e,t,i)=>{"use strict";e.exports=i(4983)},3803:(e,t,i)=>{"use strict";i.d(t,{A:()=>ne});var r=function(){function e(e){var t=this;this._insertTag=function(e){var i;i=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,i),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var i=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{i.insertRule(e,i.cssRules.length)}catch(r){}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)})),this.tags=[],this.ctr=0},e}(),n=Math.abs,o=String.fromCharCode,s=Object.assign;function a(e){return e.trim()}function l(e,t,i){return e.replace(t,i)}function c(e,t){return e.indexOf(t)}function u(e,t){return 0|e.charCodeAt(t)}function h(e,t,i){return e.slice(t,i)}function d(e){return e.length}function p(e){return e.length}function f(e,t){return t.push(e),e}var m=1,g=1,y=0,_=0,v=0,x="";function b(e,t,i,r,n,o,s){return{value:e,root:t,parent:i,type:r,props:n,children:o,line:m,column:g,length:s,return:""}}function w(e,t){return s(b("",null,null,"",null,null,0),e,{length:-e.length},t)}function S(){return v=_>0?u(x,--_):0,g--,10===v&&(g=1,m--),v}function T(){return v=_<y?u(x,_++):0,g++,10===v&&(g=1,m++),v}function M(){return u(x,_)}function A(){return _}function C(e,t){return h(x,e,t)}function E(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function P(e){return m=g=1,y=d(x=e),_=0,[]}function k(e){return x="",e}function I(e){return a(C(_-1,R(91===e?e+2:40===e?e+1:e)))}function D(e){for(;(v=M())&&v<33;)T();return E(e)>2||E(v)>3?"":" "}function L(e,t){for(;--t&&T()&&!(v<48||v>102||v>57&&v<65||v>70&&v<97););return C(e,A()+(t<6&&32==M()&&32==T()))}function R(e){for(;T();)switch(v){case e:return _;case 34:case 39:34!==e&&39!==e&&R(v);break;case 40:41===e&&R(e);break;case 92:T()}return _}function z(e,t){for(;T()&&e+v!==57&&(e+v!==84||47!==M()););return"/*"+C(t,_-1)+"*"+o(47===e?e:T())}function O(e){for(;!E(M());)T();return C(e,_)}var F="-ms-",B="-moz-",N="-webkit-",j="comm",V="rule",U="decl",G="@keyframes";function H(e,t){for(var i="",r=p(e),n=0;n<r;n++)i+=t(e[n],n,e,t)||"";return i}function W(e,t,i,r){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case U:return e.return=e.return||e.value;case j:return"";case G:return e.return=e.value+"{"+H(e.children,r)+"}";case V:e.value=e.props.join(",")}return d(i=H(e.children,r))?e.return=e.value+"{"+i+"}":""}function $(e){return k(q("",null,null,null,[""],e=P(e),0,[0],e))}function q(e,t,i,r,n,s,a,h,p){for(var m=0,g=0,y=a,_=0,v=0,x=0,b=1,w=1,C=1,E=0,P="",k=n,R=s,F=r,B=P;w;)switch(x=E,E=T()){case 40:if(108!=x&&58==u(B,y-1)){-1!=c(B+=l(I(E),"&","&\f"),"&\f")&&(C=-1);break}case 34:case 39:case 91:B+=I(E);break;case 9:case 10:case 13:case 32:B+=D(x);break;case 92:B+=L(A()-1,7);continue;case 47:switch(M()){case 42:case 47:f(Y(z(T(),A()),t,i),p);break;default:B+="/"}break;case 123*b:h[m++]=d(B)*C;case 125*b:case 59:case 0:switch(E){case 0:case 125:w=0;case 59+g:-1==C&&(B=l(B,/\f/g,"")),v>0&&d(B)-y&&f(v>32?Z(B+";",r,i,y-1):Z(l(B," ","")+";",r,i,y-2),p);break;case 59:B+=";";default:if(f(F=X(B,t,i,m,g,n,h,P,k=[],R=[],y),s),123===E)if(0===g)q(B,t,F,F,k,s,y,h,R);else switch(99===_&&110===u(B,3)?100:_){case 100:case 108:case 109:case 115:q(e,F,F,r&&f(X(e,F,F,0,0,n,h,P,n,k=[],y),R),n,R,y,h,r?k:R);break;default:q(B,F,F,F,[""],R,0,h,R)}}m=g=v=0,b=C=1,P=B="",y=a;break;case 58:y=1+d(B),v=x;default:if(b<1)if(123==E)--b;else if(125==E&&0==b++&&125==S())continue;switch(B+=o(E),E*b){case 38:C=g>0?1:(B+="\f",-1);break;case 44:h[m++]=(d(B)-1)*C,C=1;break;case 64:45===M()&&(B+=I(T())),_=M(),g=y=d(P=B+=O(A())),E++;break;case 45:45===x&&2==d(B)&&(b=0)}}return s}function X(e,t,i,r,o,s,c,u,d,f,m){for(var g=o-1,y=0===o?s:[""],_=p(y),v=0,x=0,w=0;v<r;++v)for(var S=0,T=h(e,g+1,g=n(x=c[v])),M=e;S<_;++S)(M=a(x>0?y[S]+" "+T:l(T,/&\f/g,y[S])))&&(d[w++]=M);return b(e,t,i,0===o?V:u,d,f,m)}function Y(e,t,i){return b(e,t,i,j,o(v),h(e,2,-2),0)}function Z(e,t,i,r){return b(e,t,i,U,h(e,0,r),h(e,r+1,-1),r)}var K=function(e,t,i){for(var r=0,n=0;r=n,n=M(),38===r&&12===n&&(t[i]=1),!E(n);)T();return C(e,_)},J=function(e,t){return k(function(e,t){var i=-1,r=44;do{switch(E(r)){case 0:38===r&&12===M()&&(t[i]=1),e[i]+=K(_-1,t,i);break;case 2:e[i]+=I(r);break;case 4:if(44===r){e[++i]=58===M()?"&\f":"",t[i]=e[i].length;break}default:e[i]+=o(r)}}while(r=T());return e}(P(e),t))},Q=new WeakMap,ee=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,i=e.parent,r=e.column===i.column&&e.line===i.line;"rule"!==i.type;)if(!(i=i.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||Q.get(i))&&!r){Q.set(e,!0);for(var n=[],o=J(t,n),s=i.props,a=0,l=0;a<o.length;a++)for(var c=0;c<s.length;c++,l++)e.props[l]=n[a]?o[a].replace(/&\f/g,s[c]):s[c]+" "+o[a]}}},te=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}};function ie(e,t){switch(function(e,t){return 45^u(e,0)?(((t<<2^u(e,0))<<2^u(e,1))<<2^u(e,2))<<2^u(e,3):0}(e,t)){case 5103:return N+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return N+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return N+e+B+e+F+e+e;case 6828:case 4268:return N+e+F+e+e;case 6165:return N+e+F+"flex-"+e+e;case 5187:return N+e+l(e,/(\w+).+(:[^]+)/,N+"box-$1$2"+F+"flex-$1$2")+e;case 5443:return N+e+F+"flex-item-"+l(e,/flex-|-self/,"")+e;case 4675:return N+e+F+"flex-line-pack"+l(e,/align-content|flex-|-self/,"")+e;case 5548:return N+e+F+l(e,"shrink","negative")+e;case 5292:return N+e+F+l(e,"basis","preferred-size")+e;case 6060:return N+"box-"+l(e,"-grow","")+N+e+F+l(e,"grow","positive")+e;case 4554:return N+l(e,/([^-])(transform)/g,"$1"+N+"$2")+e;case 6187:return l(l(l(e,/(zoom-|grab)/,N+"$1"),/(image-set)/,N+"$1"),e,"")+e;case 5495:case 3959:return l(e,/(image-set\([^]*)/,N+"$1$`$1");case 4968:return l(l(e,/(.+:)(flex-)?(.*)/,N+"box-pack:$3"+F+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+N+e+e;case 4095:case 3583:case 4068:case 2532:return l(e,/(.+)-inline(.+)/,N+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(d(e)-1-t>6)switch(u(e,t+1)){case 109:if(45!==u(e,t+4))break;case 102:return l(e,/(.+:)(.+)-([^]+)/,"$1"+N+"$2-$3$1"+B+(108==u(e,t+3)?"$3":"$2-$3"))+e;case 115:return~c(e,"stretch")?ie(l(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==u(e,t+1))break;case 6444:switch(u(e,d(e)-3-(~c(e,"!important")&&10))){case 107:return l(e,":",":"+N)+e;case 101:return l(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+N+(45===u(e,14)?"inline-":"")+"box$3$1"+N+"$2$3$1"+F+"$2box$3")+e}break;case 5936:switch(u(e,t+11)){case 114:return N+e+F+l(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return N+e+F+l(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return N+e+F+l(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return N+e+F+e+e}return e}var re=[function(e,t,i,r){if(e.length>-1&&!e.return)switch(e.type){case U:e.return=ie(e.value,e.length);break;case G:return H([w(e,{value:l(e.value,"@","@"+N)})],r);case V:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,(function(t){switch(function(e,t){return(e=t.exec(e))?e[0]:e}(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return H([w(e,{props:[l(t,/:(read-\w+)/,":-moz-$1")]})],r);case"::placeholder":return H([w(e,{props:[l(t,/:(plac\w+)/,":"+N+"input-$1")]}),w(e,{props:[l(t,/:(plac\w+)/,":-moz-$1")]}),w(e,{props:[l(t,/:(plac\w+)/,F+"input-$1")]})],r)}return""}))}}],ne=function(e){var t=e.key;if("css"===t){var i=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(i,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var n,o,s=e.stylisPlugins||re,a={},l=[];n=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),i=1;i<t.length;i++)a[t[i]]=!0;l.push(e)}));var c,u,h=[W,(u=function(e){c.insert(e)},function(e){e.root||(e=e.return)&&u(e)})],d=function(e){var t=p(e);return function(i,r,n,o){for(var s="",a=0;a<t;a++)s+=e[a](i,r,n,o)||"";return s}}([ee,te].concat(s,h));o=function(e,t,i,r){c=i,H($(e?e+"{"+t.styles+"}":t.styles),d),r&&(f.inserted[t.name]=!0)};var f={key:t,sheet:new r({key:t,container:n,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:a,registered:{},insert:o};return f.sheet.hydrate(l),f}},3815:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(9172);const n=function(e,t){return t?(0,r.A)(e,t,{clone:!1}):e}},4202:(e,t)=>{"use strict";var i=Symbol.for("react.element"),r=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function y(e,t,i){this.props=e,this.context=t,this.refs=g,this.updater=i||f}function _(){}function v(e,t,i){this.props=e,this.context=t,this.refs=g,this.updater=i||f}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},_.prototype=y.prototype;var x=v.prototype=new _;x.constructor=v,m(x,y.prototype),x.isPureReactComponent=!0;var b=Array.isArray,w=Object.prototype.hasOwnProperty,S={current:null},T={key:!0,ref:!0,__self:!0,__source:!0};function M(e,t,r){var n,o={},s=null,a=null;if(null!=t)for(n in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(s=""+t.key),t)w.call(t,n)&&!T.hasOwnProperty(n)&&(o[n]=t[n]);var l=arguments.length-2;if(1===l)o.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];o.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps)void 0===o[n]&&(o[n]=l[n]);return{$$typeof:i,type:e,key:s,ref:a,props:o,_owner:S.current}}function A(e){return"object"===typeof e&&null!==e&&e.$$typeof===i}var C=/\/+/g;function E(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function P(e,t,n,o,s){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case i:case r:l=!0}}if(l)return s=s(l=e),e=""===o?"."+E(l,0):o,b(s)?(n="",null!=e&&(n=e.replace(C,"$&/")+"/"),P(s,t,n,"",(function(e){return e}))):null!=s&&(A(s)&&(s=function(e,t){return{$$typeof:i,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,n+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(C,"$&/")+"/")+e)),t.push(s)),1;if(l=0,o=""===o?".":o+":",b(e))for(var c=0;c<e.length;c++){var u=o+E(a=e[c],c);l+=P(a,t,n,u,s)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(a=e.next()).done;)l+=P(a=a.value,t,n,u=o+E(a,c++),s);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function k(e,t,i){if(null==e)return e;var r=[],n=0;return P(e,r,"","",(function(e){return t.call(i,e,n++)})),r}function I(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D={current:null},L={transition:null},R={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:L,ReactCurrentOwner:S};function z(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:k,forEach:function(e,t,i){k(e,(function(){t.apply(this,arguments)}),i)},count:function(e){var t=0;return k(e,(function(){t++})),t},toArray:function(e){return k(e,(function(e){return e}))||[]},only:function(e){if(!A(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=n,t.Profiler=s,t.PureComponent=v,t.StrictMode=o,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,t.act=z,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=m({},e.props),o=e.key,s=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,a=S.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)w.call(t,c)&&!T.hasOwnProperty(c)&&(n[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:i,type:e.type,key:o,ref:s,props:n,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=M,t.createFactory=function(e){var t=M.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=A,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:I}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=L.transition;L.transition={};try{e()}finally{L.transition=t}},t.unstable_act=z,t.useCallback=function(e,t){return D.current.useCallback(e,t)},t.useContext=function(e){return D.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return D.current.useDeferredValue(e)},t.useEffect=function(e,t){return D.current.useEffect(e,t)},t.useId=function(){return D.current.useId()},t.useImperativeHandle=function(e,t,i){return D.current.useImperativeHandle(e,t,i)},t.useInsertionEffect=function(e,t){return D.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return D.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return D.current.useMemo(e,t)},t.useReducer=function(e,t,i){return D.current.useReducer(e,t,i)},t.useRef=function(e){return D.current.useRef(e)},t.useState=function(e){return D.current.useState(e)},t.useSyncExternalStore=function(e,t,i){return D.current.useSyncExternalStore(e,t,i)},t.useTransition=function(){return D.current.useTransition()},t.version="18.3.1"},4391:(e,t,i)=>{"use strict";var r=i(7950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},4634:e=>{function t(){return e.exports=t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)({}).hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},e.exports.__esModule=!0,e.exports.default=e.exports,t.apply(null,arguments)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},4853:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(8587),n=i(8168);const o=["values","unit","step"],s=e=>{const t=Object.keys(e).map((t=>({key:t,val:e[t]})))||[];return t.sort(((e,t)=>e.val-t.val)),t.reduce(((e,t)=>(0,n.A)({},e,{[t.key]:t.val})),{})};function a(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:i="px",step:a=5}=e,l=(0,r.A)(e,o),c=s(t),u=Object.keys(c);function h(e){return`@media (min-width:${"number"===typeof t[e]?t[e]:e}${i})`}function d(e){return`@media (max-width:${("number"===typeof t[e]?t[e]:e)-a/100}${i})`}function p(e,r){const n=u.indexOf(r);return`@media (min-width:${"number"===typeof t[e]?t[e]:e}${i}) and (max-width:${(-1!==n&&"number"===typeof t[u[n]]?t[u[n]]:r)-a/100}${i})`}return(0,n.A)({keys:u,values:c,up:h,down:d,between:p,only:function(e){return u.indexOf(e)+1<u.length?p(e,u[u.indexOf(e)+1]):h(e)},not:function(e){const t=u.indexOf(e);return 0===t?h(u[1]):t===u.length-1?d(u[t]):p(e,u[u.indexOf(e)+1]).replace("@media","@media not all and")},unit:i},l)}},4893:e=>{e.exports=function(e,t){if(null==e)return{};var i={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;i[r]=e[r]}return i},e.exports.__esModule=!0,e.exports.default=e.exports},4983:(e,t)=>{"use strict";var i="function"===typeof Symbol&&Symbol.for,r=i?Symbol.for("react.element"):60103,n=i?Symbol.for("react.portal"):60106,o=i?Symbol.for("react.fragment"):60107,s=i?Symbol.for("react.strict_mode"):60108,a=i?Symbol.for("react.profiler"):60114,l=i?Symbol.for("react.provider"):60109,c=i?Symbol.for("react.context"):60110,u=i?Symbol.for("react.async_mode"):60111,h=i?Symbol.for("react.concurrent_mode"):60111,d=i?Symbol.for("react.forward_ref"):60112,p=i?Symbol.for("react.suspense"):60113,f=i?Symbol.for("react.suspense_list"):60120,m=i?Symbol.for("react.memo"):60115,g=i?Symbol.for("react.lazy"):60116,y=i?Symbol.for("react.block"):60121,_=i?Symbol.for("react.fundamental"):60117,v=i?Symbol.for("react.responder"):60118,x=i?Symbol.for("react.scope"):60119;function b(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case u:case h:case o:case a:case s:case p:return e;default:switch(e=e&&e.$$typeof){case c:case d:case g:case m:case l:return e;default:return t}}case n:return t}}}function w(e){return b(e)===h}t.AsyncMode=u,t.ConcurrentMode=h,t.ContextConsumer=c,t.ContextProvider=l,t.Element=r,t.ForwardRef=d,t.Fragment=o,t.Lazy=g,t.Memo=m,t.Portal=n,t.Profiler=a,t.StrictMode=s,t.Suspense=p,t.isAsyncMode=function(e){return w(e)||b(e)===u},t.isConcurrentMode=w,t.isContextConsumer=function(e){return b(e)===c},t.isContextProvider=function(e){return b(e)===l},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return b(e)===d},t.isFragment=function(e){return b(e)===o},t.isLazy=function(e){return b(e)===g},t.isMemo=function(e){return b(e)===m},t.isPortal=function(e){return b(e)===n},t.isProfiler=function(e){return b(e)===a},t.isStrictMode=function(e){return b(e)===s},t.isSuspense=function(e){return b(e)===p},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===o||e===h||e===a||e===s||e===p||e===f||"object"===typeof e&&null!==e&&(e.$$typeof===g||e.$$typeof===m||e.$$typeof===l||e.$$typeof===c||e.$$typeof===d||e.$$typeof===_||e.$$typeof===v||e.$$typeof===x||e.$$typeof===y)},t.typeOf=b},4989:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r.A,private_createBreakpoints:()=>n.A,unstable_applyStyles:()=>o.A});var r=i(8280),n=i(4853),o=i(9703)},4994:e=>{e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},4999:function(e,t,i){var r;"undefined"!=typeof self&&self,e.exports=(r=i(5043),function(e){function t(r){if(i[r])return i[r].exports;var n=i[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var i={};return t.m=e,t.c=i,t.d=function(e,i,r){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,i){"use strict";function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},r.apply(this,arguments)}function n(e){return l(e)||a(e)||s(e)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(e,t){if(e){if("string"==typeof e)return c(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?c(e,t):void 0}}function a(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function l(e){if(Array.isArray(e))return c(e)}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),i.d(t,"HighchartsReact",(function(){return f}));var h=i(1),d=i.n(h),p="undefined"!=typeof window?h.useLayoutEffect:h.useEffect,f=Object(h.memo)(Object(h.forwardRef)((function(e,t){var i=Object(h.useRef)(),o=Object(h.useRef)(),s=Object(h.useRef)(e.constructorType),a=Object(h.useRef)(e.highcharts);return p((function(){function t(){var t=e.highcharts||"object"===("undefined"==typeof window?"undefined":u(window))&&window.Highcharts,r=e.constructorType||"chart";t?t[r]?e.options?o.current=t[r](i.current,e.options,e.callback):console.warn('The "options" property was not passed.'):console.warn('The "constructorType" property is incorrect or some required module is not imported.'):console.warn('The "highcharts" property was not passed.')}if(o.current){if(!1!==e.allowChartUpdate)if(e.constructorType!==s.current||e.highcharts!==a.current)s.current=e.constructorType,a.current=e.highcharts,t();else if(!e.immutable&&o.current){var r;(r=o.current).update.apply(r,[e.options].concat(n(e.updateArgs||[!0,!0])))}else t()}else t()}),[e.options,e.allowChartUpdate,e.updateArgs,e.containerProps,e.highcharts,e.constructorType]),p((function(){return function(){o.current&&(o.current.destroy(),o.current=null)}}),[]),Object(h.useImperativeHandle)(t,(function(){return{get chart(){return o.current},container:i}}),[]),d.a.createElement("div",r({},e.containerProps,{ref:i}))})));t.default=f},function(e,t){e.exports=r}]))},5043:(e,t,i)=>{"use strict";e.exports=i(4202)},5173:(e,t,i)=>{e.exports=i(1497)()},6531:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r.A});var r=i(1188)},6598:(e,t,i)=>{"use strict";i.d(t,{J:()=>g});var r={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},n=i(918),o=!1,s=/[A-Z]|^ms/g,a=/_EMO_([^_]+?)_([^]*?)_EMO_/g,l=function(e){return 45===e.charCodeAt(1)},c=function(e){return null!=e&&"boolean"!==typeof e},u=(0,n.A)((function(e){return l(e)?e:e.replace(s,"-$&").toLowerCase()})),h=function(e,t){switch(e){case"animation":case"animationName":if("string"===typeof t)return t.replace(a,(function(e,t,i){return f={name:t,styles:i,next:f},t}))}return 1===r[e]||l(e)||"number"!==typeof t||0===t?t:t+"px"},d="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function p(e,t,i){if(null==i)return"";var r=i;if(void 0!==r.__emotion_styles)return r;switch(typeof i){case"boolean":return"";case"object":var n=i;if(1===n.anim)return f={name:n.name,styles:n.styles,next:f},n.name;var s=i;if(void 0!==s.styles){var a=s.next;if(void 0!==a)for(;void 0!==a;)f={name:a.name,styles:a.styles,next:f},a=a.next;return s.styles+";"}return function(e,t,i){var r="";if(Array.isArray(i))for(var n=0;n<i.length;n++)r+=p(e,t,i[n])+";";else for(var s in i){var a=i[s];if("object"!==typeof a){var l=a;null!=t&&void 0!==t[l]?r+=s+"{"+t[l]+"}":c(l)&&(r+=u(s)+":"+h(s,l)+";")}else{if("NO_COMPONENT_SELECTOR"===s&&o)throw new Error(d);if(!Array.isArray(a)||"string"!==typeof a[0]||null!=t&&void 0!==t[a[0]]){var f=p(e,t,a);switch(s){case"animation":case"animationName":r+=u(s)+":"+f+";";break;default:r+=s+"{"+f+"}"}}else for(var m=0;m<a.length;m++)c(a[m])&&(r+=u(s)+":"+h(s,a[m])+";")}}return r}(e,t,i);case"function":if(void 0!==e){var l=f,m=i(e);return f=l,p(e,t,m)}}var g=i;if(null==t)return g;var y=t[g];return void 0!==y?y:g}var f,m=/label:\s*([^\s;{]+)\s*(;|$)/g;function g(e,t,i){if(1===e.length&&"object"===typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var r=!0,n="";f=void 0;var o=e[0];null==o||void 0===o.raw?(r=!1,n+=p(i,t,o)):n+=o[0];for(var s=1;s<e.length;s++){if(n+=p(i,t,e[s]),r)n+=o[s]}m.lastIndex=0;for(var a,l="";null!==(a=m.exec(n));)l+="-"+a[1];var c=function(e){for(var t,i=0,r=0,n=e.length;n>=4;++r,n-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),i=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&i)+(59797*(i>>>16)<<16);switch(n){case 3:i^=(255&e.charCodeAt(r+2))<<16;case 2:i^=(255&e.charCodeAt(r+1))<<8;case 1:i=1540483477*(65535&(i^=255&e.charCodeAt(r)))+(59797*(i>>>16)<<16)}return(((i=1540483477*(65535&(i^=i>>>13))+(59797*(i>>>16)<<16))^i>>>15)>>>0).toString(36)}(n)+l;return{name:c,styles:n,next:f}}},6723:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},r=function(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},n={p:r,P:function(e,t){var n,o=e.match(/(P+)(p+)?/)||[],s=o[1],a=o[2];if(!a)return i(e,t);switch(s){case"P":n=t.dateTime({width:"short"});break;case"PP":n=t.dateTime({width:"medium"});break;case"PPP":n=t.dateTime({width:"long"});break;default:n=t.dateTime({width:"full"})}return n.replace("{{date}}",i(s,t)).replace("{{time}}",r(a,t))}};t.default=n,e.exports=t.default},7162:(e,t,i)=>{"use strict";i.d(t,{Ay:()=>a,BO:()=>s,Yn:()=>o});var r=i(7598),n=i(9751);function o(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!t||"string"!==typeof t)return null;if(e&&e.vars&&i){const i=`vars.${t}`.split(".").reduce(((e,t)=>e&&e[t]?e[t]:null),e);if(null!=i)return i}return t.split(".").reduce(((e,t)=>e&&null!=e[t]?e[t]:null),e)}function s(e,t,i){let r,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i;return r="function"===typeof e?e(i):Array.isArray(e)?e[i]||n:o(e,i)||n,t&&(r=t(r,n,e)),r}const a=function(e){const{prop:t,cssProperty:i=e.prop,themeKey:a,transform:l}=e,c=e=>{if(null==e[t])return null;const c=e[t],u=o(e.theme,a)||{};return(0,n.NI)(e,c,(e=>{let n=s(u,l,e);return e===n&&"string"===typeof e&&(n=s(u,l,`${t}${"default"===e?"":(0,r.A)(e)}`,e)),!1===i?n:{[i]:n}}))};return c.propTypes={},c.filterProps=[t],c}},7234:(e,t)=>{"use strict";function i(e,t){var i=e.length;e.push(t);e:for(;0<i;){var r=i-1>>>1,n=e[r];if(!(0<o(n,t)))break e;e[r]=t,e[i]=n,i=r}}function r(e){return 0===e.length?null:e[0]}function n(e){if(0===e.length)return null;var t=e[0],i=e.pop();if(i!==t){e[0]=i;e:for(var r=0,n=e.length,s=n>>>1;r<s;){var a=2*(r+1)-1,l=e[a],c=a+1,u=e[c];if(0>o(l,i))c<n&&0>o(u,l)?(e[r]=u,e[c]=i,r=c):(e[r]=l,e[a]=i,r=a);else{if(!(c<n&&0>o(u,i)))break e;e[r]=u,e[c]=i,r=c}}}return t}function o(e,t){var i=e.sortIndex-t.sortIndex;return 0!==i?i:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],h=1,d=null,p=3,f=!1,m=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,_="function"===typeof clearTimeout?clearTimeout:null,v="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=r(u);null!==t;){if(null===t.callback)n(u);else{if(!(t.startTime<=e))break;n(u),t.sortIndex=t.expirationTime,i(c,t)}t=r(u)}}function b(e){if(g=!1,x(e),!m)if(null!==r(c))m=!0,L(w);else{var t=r(u);null!==t&&R(b,t.startTime-e)}}function w(e,i){m=!1,g&&(g=!1,_(A),A=-1),f=!0;var o=p;try{for(x(i),d=r(c);null!==d&&(!(d.expirationTime>i)||e&&!P());){var s=d.callback;if("function"===typeof s){d.callback=null,p=d.priorityLevel;var a=s(d.expirationTime<=i);i=t.unstable_now(),"function"===typeof a?d.callback=a:d===r(c)&&n(c),x(i)}else n(c);d=r(c)}if(null!==d)var l=!0;else{var h=r(u);null!==h&&R(b,h.startTime-i),l=!1}return l}finally{d=null,p=o,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,T=!1,M=null,A=-1,C=5,E=-1;function P(){return!(t.unstable_now()-E<C)}function k(){if(null!==M){var e=t.unstable_now();E=e;var i=!0;try{i=M(!0,e)}finally{i?S():(T=!1,M=null)}}else T=!1}if("function"===typeof v)S=function(){v(k)};else if("undefined"!==typeof MessageChannel){var I=new MessageChannel,D=I.port2;I.port1.onmessage=k,S=function(){D.postMessage(null)}}else S=function(){y(k,0)};function L(e){M=e,T||(T=!0,S())}function R(e,i){A=y((function(){e(t.unstable_now())}),i)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,L(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var i=p;p=t;try{return e()}finally{p=i}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var i=p;p=e;try{return t()}finally{p=i}},t.unstable_scheduleCallback=function(e,n,o){var s=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?s+o:s:o=s,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:h++,callback:n,priorityLevel:e,startTime:o,expirationTime:a=o+a,sortIndex:-1},o>s?(e.sortIndex=o,i(u,e),null===r(c)&&e===r(u)&&(g?(_(A),A=-1):g=!0,R(b,o-s))):(e.sortIndex=a,i(c,e),m||f||(m=!0,L(w))),e},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(e){var t=p;return function(){var i=p;p=t;try{return e.apply(this,arguments)}finally{p=i}}}},7266:(e,t,i)=>{"use strict";var r=i(4994);t.X4=p,t.e$=f,t.eM=function(e,t){const i=d(e),r=d(t);return(Math.max(i,r)+.05)/(Math.min(i,r)+.05)},t.a=m;var n=r(i(457)),o=r(i(6531));function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(0,o.default)(e,t,i)}function a(e){e=e.slice(1);const t=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let i=e.match(t);return i&&1===i[0].length&&(i=i.map((e=>e+e))),i?`rgb${4===i.length?"a":""}(${i.map(((e,t)=>t<3?parseInt(e,16):Math.round(parseInt(e,16)/255*1e3)/1e3)).join(", ")})`:""}function l(e){if(e.type)return e;if("#"===e.charAt(0))return l(a(e));const t=e.indexOf("("),i=e.substring(0,t);if(-1===["rgb","rgba","hsl","hsla","color"].indexOf(i))throw new Error((0,n.default)(9,e));let r,o=e.substring(t+1,e.length-1);if("color"===i){if(o=o.split(" "),r=o.shift(),4===o.length&&"/"===o[3].charAt(0)&&(o[3]=o[3].slice(1)),-1===["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(r))throw new Error((0,n.default)(10,r))}else o=o.split(",");return o=o.map((e=>parseFloat(e))),{type:i,values:o,colorSpace:r}}const c=e=>{const t=l(e);return t.values.slice(0,3).map(((e,i)=>-1!==t.type.indexOf("hsl")&&0!==i?`${e}%`:e)).join(" ")};function u(e){const{type:t,colorSpace:i}=e;let{values:r}=e;return-1!==t.indexOf("rgb")?r=r.map(((e,t)=>t<3?parseInt(e,10):e)):-1!==t.indexOf("hsl")&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),r=-1!==t.indexOf("color")?`${i} ${r.join(" ")}`:`${r.join(", ")}`,`${t}(${r})`}function h(e){e=l(e);const{values:t}=e,i=t[0],r=t[1]/100,n=t[2]/100,o=r*Math.min(n,1-n),s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e+i/30)%12;return n-o*Math.max(Math.min(t-3,9-t,1),-1)};let a="rgb";const c=[Math.round(255*s(0)),Math.round(255*s(8)),Math.round(255*s(4))];return"hsla"===e.type&&(a+="a",c.push(t[3])),u({type:a,values:c})}function d(e){let t="hsl"===(e=l(e)).type||"hsla"===e.type?l(h(e)).values:e.values;return t=t.map((t=>("color"!==e.type&&(t/=255),t<=.03928?t/12.92:((t+.055)/1.055)**2.4))),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function p(e,t){return e=l(e),t=s(t),"rgb"!==e.type&&"hsl"!==e.type||(e.type+="a"),"color"===e.type?e.values[3]=`/${t}`:e.values[3]=t,u(e)}function f(e,t){if(e=l(e),t=s(t),-1!==e.type.indexOf("hsl"))e.values[2]*=1-t;else if(-1!==e.type.indexOf("rgb")||-1!==e.type.indexOf("color"))for(let i=0;i<3;i+=1)e.values[i]*=1-t;return u(e)}function m(e,t){if(e=l(e),t=s(t),-1!==e.type.indexOf("hsl"))e.values[2]+=(100-e.values[2])*t;else if(-1!==e.type.indexOf("rgb"))for(let i=0;i<3;i+=1)e.values[i]+=(255-e.values[i])*t;else if(-1!==e.type.indexOf("color"))for(let i=0;i<3;i+=1)e.values[i]+=(1-e.values[i])*t;return u(e)}function g(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.15;return d(e)>.5?f(e,t):m(e,t)}},7459:(e,t,i)=>{var r,n,o;o=function(e){"use strict";var t=e?e._modules:{};function i(t,i,r,n){t.hasOwnProperty(i)||(t[i]=n.apply(null,r),"function"==typeof CustomEvent&&e.win.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:i,module:t[i]}})))}i(t,"Accessibility/Utils/HTMLUtilities.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],(function(e,t){let{doc:i,win:r}=e,{css:n}=t,o=r.EventTarget&&new r.EventTarget||"none";function s(e){if("function"==typeof r.MouseEvent)return new r.MouseEvent(e.type,e);if(i.createEvent){let t=i.createEvent("MouseEvent");if(t.initMouseEvent)return t.initMouseEvent(e.type,e.bubbles,e.cancelable,e.view||r,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),t}return a(e.type)}function a(e,t,n){let s=t||{x:0,y:0};if("function"==typeof r.MouseEvent)return new r.MouseEvent(e,{bubbles:!0,cancelable:!0,composed:!0,button:0,buttons:1,relatedTarget:n||o,view:r,detail:"click"===e?1:0,screenX:s.x,screenY:s.y,clientX:s.x,clientY:s.y});if(i.createEvent){let t=i.createEvent("MouseEvent");if(t.initMouseEvent)return t.initMouseEvent(e,!0,!0,r,"click"===e?1:0,s.x,s.y,s.x,s.y,!1,!1,!1,!1,0,null),t}return{type:e}}return{addClass:function(e,t){e.classList?e.classList.add(t):0>e.className.indexOf(t)&&(e.className+=" "+t)},cloneMouseEvent:s,cloneTouchEvent:function(e){let t=e=>{let t=[];for(let i=0;i<e.length;++i){let r=e.item(i);r&&t.push(r)}return t};if("function"==typeof r.TouchEvent){let i=new r.TouchEvent(e.type,{touches:t(e.touches),targetTouches:t(e.targetTouches),changedTouches:t(e.changedTouches),ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,altKey:e.altKey,metaKey:e.metaKey,bubbles:e.bubbles,cancelable:e.cancelable,composed:e.composed,detail:e.detail,view:e.view});return e.defaultPrevented&&i.preventDefault(),i}let i=s(e);return i.touches=e.touches,i.changedTouches=e.changedTouches,i.targetTouches=e.targetTouches,i},escapeStringForHTML:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},getElement:function(e){return i.getElementById(e)},getFakeMouseEvent:a,getHeadingTagNameForElement:function(e){let t=e=>"h"+Math.min(6,parseInt(e.slice(1),10)+1),i=e=>/^H[1-6]$/i.test(e),r=e=>{let n=(e=>{let t=e;for(;t=t.previousSibling;){let e=t.tagName||"";if(i(e))return e}return""})(e);if(n)return t(n);let o=e.parentElement;if(!o)return"p";let s=o.tagName;return i(s)?t(s):r(o)};return r(e)},removeChildNodes:function(e){for(;e.lastChild;)e.removeChild(e.lastChild)},removeClass:function(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(RegExp(t,"g"),"")},removeElement:function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},reverseChildNodes:function(e){let t=e.childNodes.length;for(;t--;)e.appendChild(e.childNodes[t])},simulatedEventTarget:o,stripHTMLTagsFromString:function(e){return"string"==typeof e?arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e.replace(/<\/?[^>]+(>|$)/g,""):e.replace(/<\/?(?!\s)[^>]+(>|$)/g,""):e},visuallyHideElement:function(e){n(e,{position:"absolute",width:"1px",height:"1px",overflow:"hidden",whiteSpace:"nowrap",clip:"rect(1px, 1px, 1px, 1px)",marginTop:"-3px","-ms-filter":"progid:DXImageTransform.Microsoft.Alpha(Opacity=1)",filter:"alpha(opacity=1)",opacity:.01})}}})),i(t,"Accessibility/A11yI18n.js",[t["Core/Templating.js"],t["Core/Utilities.js"]],(function(e,t){var i;let{format:r}=e,{getNestedProperty:n,pick:o}=t;return function(e){function t(e,t,i){let s,a,l=(e,t)=>{let i=e.slice(t||0),r=i.indexOf("{"),n=i.indexOf("}");if(r>-1&&n>r)return{statement:i.substring(r+1,n),begin:t+r+1,end:t+n}},c=[],u=0;do{s=l(e,u),(a=e.substring(u,s&&s.begin-1)).length&&c.push({value:a,type:"constant"}),s&&c.push({value:s.statement,type:"statement"}),u=s?s.end+1:u+1}while(s);return c.forEach((e=>{"statement"===e.type&&(e.value=function(e,t){let i,r,s=e.indexOf("#each("),a=e.indexOf("#plural("),l=e.indexOf("["),c=e.indexOf("]");if(s>-1){let o,a=e.slice(s).indexOf(")")+s,l=e.substring(0,s),c=e.substring(a+1),u=e.substring(s+6,a).split(","),h=Number(u[1]);if(r="",i=n(u[0],t)){o=(h=isNaN(h)?i.length:h)<0?i.length+h:Math.min(h,i.length);for(let e=0;e<o;++e)r+=l+i[e]+c}return r.length?r:""}if(a>-1){var u;let i=e.slice(a).indexOf(")")+a,s=e.substring(a+8,i).split(",");switch(Number(n(s[0],t))){case 0:r=o(s[4],s[1]);break;case 1:r=o(s[2],s[1]);break;case 2:r=o(s[3],s[1]);break;default:r=s[1]}return r?(u=r).trim&&u.trim()||u.replace(/^\s+|\s+$/g,""):""}if(l>-1){let r,o=e.substring(0,l),s=Number(e.substring(l+1,c));return i=n(o,t),!isNaN(s)&&i&&(s<0?void 0===(r=i[i.length+s])&&(r=i[0]):void 0===(r=i[s])&&(r=i[i.length-1])),void 0!==r?r:""}return"{"+e+"}"}(e.value,t))})),r(c.reduce(((e,t)=>e+t.value),""),t,i)}function i(e,i){let r=e.split("."),n=this.options.lang,o=0;for(;o<r.length;++o)n=n&&n[r[o]];return"string"==typeof n?t(n,i,this):""}e.compose=function(e){let t=e.prototype;t.langFormat||(t.langFormat=i)},e.i18nFormat=t}(i||(i={})),i})),i(t,"Accessibility/Utils/ChartUtilities.js",[t["Core/Globals.js"],t["Accessibility/Utils/HTMLUtilities.js"],t["Core/Utilities.js"]],(function(e,t,i){let{doc:r}=e,{stripHTMLTagsFromString:n}=t,{defined:o,find:s,fireEvent:a}=i;function l(e){if(e.points&&e.points.length){let t=s(e.points,(e=>!!e.graphic));return t&&t.graphic&&t.graphic.element}}function c(e){let t=l(e);return t&&t.parentNode||e.graph&&e.graph.element||e.group&&e.group.element}return{fireEventOnWrappedOrUnwrappedElement:function e(t,i){let n=i.type,o=t.hcEvents;r.createEvent&&(t.dispatchEvent||t.fireEvent)?t.dispatchEvent?t.dispatchEvent(i):t.fireEvent(n,i):o&&o[n]?a(t,n,i):t.element&&e(t.element,i)},getChartTitle:function(e){return n(e.options.title.text||e.langFormat("accessibility.defaultChartTitle",{chart:e}),e.renderer.forExport)},getAxisDescription:function(e){return e&&(e.options.accessibility?.description||e.axisTitle?.textStr||e.options.id||e.categories&&"categories"||e.dateTime&&"Time"||"values")},getAxisRangeDescription:function(e){let t=e.options||{};return t.accessibility&&void 0!==t.accessibility.rangeDescription?t.accessibility.rangeDescription:e.categories?function(e){let t=e.chart;return e.dataMax&&e.dataMin?t.langFormat("accessibility.axis.rangeCategories",{chart:t,axis:e,numCategories:e.dataMax-e.dataMin+1}):""}(e):!e.dateTime||0!==e.min&&0!==e.dataMin?function(e){let t=e.chart,i=t.options,r=i&&i.accessibility&&i.accessibility.screenReaderSection.axisRangeDateFormat||"",n={min:e.dataMin||e.min||0,max:e.dataMax||e.max||0},o=function(i){return e.dateTime?t.time.dateFormat(r,n[i]):n[i].toString()};return t.langFormat("accessibility.axis.rangeFromTo",{chart:t,axis:e,rangeFrom:o("min"),rangeTo:o("max")})}(e):function(e){let t=e.chart,i={},r=e.dataMin||e.min||0,n=e.dataMax||e.max||0,o="Seconds";i.Seconds=(n-r)/1e3,i.Minutes=i.Seconds/60,i.Hours=i.Minutes/60,i.Days=i.Hours/24,["Minutes","Hours","Days"].forEach((function(e){i[e]>2&&(o=e)}));let s=i[o].toFixed("Seconds"!==o&&"Minutes"!==o?1:0);return t.langFormat("accessibility.axis.timeRange"+o,{chart:t,axis:e,range:s.replace(".0","")})}(e)},getPointFromXY:function(e,t,i){let r,n=e.length;for(;n--;)if(r=s(e[n].points||[],(function(e){return e.x===t&&e.y===i})))return r},getSeriesFirstPointElement:l,getSeriesFromName:function(e,t){return t?(e.series||[]).filter((function(e){return e.name===t})):e.series},getSeriesA11yElement:c,unhideChartElementFromAT:function e(t,i){i.setAttribute("aria-hidden",!1),i!==t.renderTo&&i.parentNode&&i.parentNode!==r.body&&(Array.prototype.forEach.call(i.parentNode.childNodes,(function(e){e.hasAttribute("aria-hidden")||e.setAttribute("aria-hidden",!0)})),e(t,i.parentNode))},hideSeriesFromAT:function(e){let t=c(e);t&&t.setAttribute("aria-hidden",!0)},scrollAxisToPoint:function(e){let t=e.series.xAxis,i=e.series.yAxis,r=t&&t.scrollbar?t:i,n=r&&r.scrollbar;if(n&&o(n.to)&&o(n.from)){let t=n.to-n.from,i=function(e,t){if(!o(e.dataMin)||!o(e.dataMax))return 0;let i=e.toPixels(e.dataMin),r=e.toPixels(e.dataMax),n="xAxis"===e.coll?"x":"y";return(e.toPixels(t[n]||0)-i)/(r-i)}(r,e);n.updatePosition(i-t/2,i+t/2),a(n,"changed",{from:n.from,to:n.to,trigger:"scrollbar",DOMEvent:null})}}}})),i(t,"Accessibility/Utils/DOMElementProvider.js",[t["Core/Globals.js"],t["Accessibility/Utils/HTMLUtilities.js"]],(function(e,t){let{doc:i}=e,{removeElement:r}=t;return class{constructor(){this.elements=[]}createElement(){let e=i.createElement.apply(i,arguments);return this.elements.push(e),e}removeElement(e){r(e),this.elements.splice(this.elements.indexOf(e),1)}destroyCreatedElements(){this.elements.forEach((function(e){r(e)})),this.elements=[]}}})),i(t,"Accessibility/Utils/EventProvider.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],(function(e,t){let{addEvent:i}=t;return class{constructor(){this.eventRemovers=[]}addEvent(){let t=i.apply(e,arguments);return this.eventRemovers.push({element:arguments[0],remover:t}),t}removeEvent(e){let t=this.eventRemovers.map((e=>e.remover)).indexOf(e);this.eventRemovers[t].remover(),this.eventRemovers.splice(t,1)}removeAddedEvents(){this.eventRemovers.map((e=>e.remover)).forEach((e=>e())),this.eventRemovers=[]}}})),i(t,"Accessibility/AccessibilityComponent.js",[t["Accessibility/Utils/ChartUtilities.js"],t["Accessibility/Utils/DOMElementProvider.js"],t["Accessibility/Utils/EventProvider.js"],t["Accessibility/Utils/HTMLUtilities.js"]],(function(e,t,i,r){let{fireEventOnWrappedOrUnwrappedElement:n}=e,{getFakeMouseEvent:o}=r;return class{destroy(){}getKeyboardNavigation(){return[]}init(){}onChartRender(){}onChartUpdate(){}initBase(e,r){this.chart=e,this.eventProvider=new i,this.domElementProvider=new t,this.proxyProvider=r,this.keyCodes={left:37,right:39,up:38,down:40,enter:13,space:32,esc:27,tab:9,pageUp:33,pageDown:34,end:35,home:36}}addEvent(e,t,i,r){return this.eventProvider.addEvent(e,t,i,r)}createElement(e,t){return this.domElementProvider.createElement(e,t)}fakeClickEvent(e){n(e,o("click"))}destroyBase(){this.domElementProvider.destroyCreatedElements(),this.eventProvider.removeAddedEvents()}}})),i(t,"Accessibility/KeyboardNavigationHandler.js",[t["Core/Utilities.js"]],(function(e){let{find:t}=e;return class{constructor(e,t){this.chart=e,this.keyCodeMap=t.keyCodeMap||[],this.validate=t.validate,this.init=t.init,this.terminate=t.terminate,this.response={success:1,prev:2,next:3,noHandler:4,fail:5}}run(e){let i=e.which||e.keyCode,r=this.response.noHandler,n=t(this.keyCodeMap,(function(e){return e[0].indexOf(i)>-1}));return n?r=n[1].call(this,i,e):9===i&&(r=this.response[e.shiftKey?"prev":"next"]),r}}})),i(t,"Accessibility/Components/ContainerComponent.js",[t["Accessibility/AccessibilityComponent.js"],t["Accessibility/KeyboardNavigationHandler.js"],t["Accessibility/Utils/ChartUtilities.js"],t["Core/Globals.js"],t["Accessibility/Utils/HTMLUtilities.js"]],(function(e,t,i,r,n){let{unhideChartElementFromAT:o,getChartTitle:s}=i,{doc:a}=r,{stripHTMLTagsFromString:l}=n;return class extends e{onChartUpdate(){this.handleSVGTitleElement(),this.setSVGContainerLabel(),this.setGraphicContainerAttrs(),this.setRenderToAttrs(),this.makeCreditsAccessible()}handleSVGTitleElement(){let e=this.chart,t="highcharts-title-"+e.index,i=l(e.langFormat("accessibility.svgContainerTitle",{chartTitle:s(e)}));if(i.length){let r=this.svgTitleElement=this.svgTitleElement||a.createElementNS("http://www.w3.org/2000/svg","title");r.textContent=i,r.id=t,e.renderTo.insertBefore(r,e.renderTo.firstChild)}}setSVGContainerLabel(){let e=this.chart,t=e.langFormat("accessibility.svgContainerLabel",{chartTitle:s(e)});e.renderer.box&&t.length&&e.renderer.box.setAttribute("aria-label",t)}setGraphicContainerAttrs(){let e=this.chart,t=e.langFormat("accessibility.graphicContainerLabel",{chartTitle:s(e)});t.length&&e.container.setAttribute("aria-label",t)}setRenderToAttrs(){let e=this.chart,t="disabled"!==e.options.accessibility.landmarkVerbosity,i=e.langFormat("accessibility.chartContainerLabel",{title:s(e),chart:e});i&&(e.renderTo.setAttribute("role",t?"region":"group"),e.renderTo.setAttribute("aria-label",i))}makeCreditsAccessible(){let e=this.chart,t=e.credits;t&&(t.textStr&&t.element.setAttribute("aria-label",e.langFormat("accessibility.credits",{creditsStr:l(t.textStr,e.renderer.forExport)})),o(e,t.element))}getKeyboardNavigation(){let e=this.chart;return new t(e,{keyCodeMap:[],validate:function(){return!0},init:function(){let t=e.accessibility;t&&t.keyboardNavigation.tabindexContainer.focus()}})}destroy(){this.chart.renderTo.setAttribute("aria-hidden",!0)}}})),i(t,"Accessibility/FocusBorder.js",[t["Core/Utilities.js"]],(function(e){var t;let{addEvent:i,pick:r}=e;return function(e){let t=["x","y","transform","width","height","r","d","stroke-width"];function n(){let e=this.focusElement,t=this.options.accessibility.keyboardNavigation.focusBorder;e&&(e.removeFocusBorder(),t.enabled&&e.addFocusBorder(t.margin,{stroke:t.style.color,strokeWidth:t.style.lineWidth,r:t.style.borderRadius}))}function o(e,t){let r=this.options.accessibility.keyboardNavigation.focusBorder,n=t||e.element;n&&n.focus&&(n.hcEvents&&n.hcEvents.focusin||i(n,"focusin",(function(){})),n.focus(),r.hideBrowserFocusOutline&&(n.style.outline="none")),this.focusElement&&this.focusElement.removeFocusBorder(),this.focusElement=e,this.renderFocusBorder()}function s(e,i){this.focusBorder&&this.removeFocusBorder();let n=this.getBBox(),o=r(e,3),s=this.parentGroup,a=this.scaleX||s&&s.scaleX,l=this.scaleY||s&&s.scaleY,c=(a?!l:l)?Math.abs(a||l||1):(Math.abs(a||1)+Math.abs(l||1))/2;n.x+=this.translateX?this.translateX:0,n.y+=this.translateY?this.translateY:0;let u=n.x-o,h=n.y-o,d=n.width+2*o,p=n.height+2*o,f=!!this.text;if("text"===this.element.nodeName||f){let e,t,i=!!this.rotation,r=f?{x:i?1:0,y:0}:(e=0,t=0,"middle"===this.attr("text-anchor")?e=t=.5:this.rotation?e=.25:t=.75,{x:e,y:t}),s=+this.attr("x"),a=+this.attr("y");if(isNaN(s)||(u=s-n.width*r.x-o),isNaN(a)||(h=a-n.height*r.y-o),f&&i){let e=d;d=p,p=e,isNaN(s)||(u=s-n.height*r.x-o),isNaN(a)||(h=a-n.width*r.y-o)}}this.focusBorder=this.renderer.rect(u,h,d,p,parseInt((i&&i.r||0).toString(),10)/c).addClass("highcharts-focus-border").attr({zIndex:99}).add(s),this.renderer.styledMode||this.focusBorder.attr({stroke:i&&i.stroke,"stroke-width":(i&&i.strokeWidth||0)/c}),function(e){for(var i=arguments.length,r=new Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];e.focusBorderUpdateHooks||(e.focusBorderUpdateHooks={},t.forEach((t=>{let i=t+"Setter",n=e[i]||e._defaultSetter;e.focusBorderUpdateHooks[i]=n,e[i]=function(){let t=n.apply(e,arguments);return e.addFocusBorder.apply(e,r),t}})))}(this,e,i),function(e){if(e.focusBorderDestroyHook)return;let t=e.destroy;e.destroy=function(){return e.focusBorder&&e.focusBorder.destroy&&e.focusBorder.destroy(),t.apply(e,arguments)},e.focusBorderDestroyHook=t}(this)}function a(){var e;(e=this).focusBorderUpdateHooks&&(Object.keys(e.focusBorderUpdateHooks).forEach((t=>{let i=e.focusBorderUpdateHooks[t];i===e._defaultSetter?delete e[t]:e[t]=i})),delete e.focusBorderUpdateHooks),this.focusBorderDestroyHook&&(this.destroy=this.focusBorderDestroyHook,delete this.focusBorderDestroyHook),this.focusBorder&&(this.focusBorder.destroy(),delete this.focusBorder)}e.compose=function(e,t){let i=e.prototype,r=t.prototype;i.renderFocusBorder||(i.renderFocusBorder=n,i.setFocusToElement=o),r.addFocusBorder||(r.addFocusBorder=s,r.removeFocusBorder=a)}}(t||(t={})),t})),i(t,"Accessibility/Utils/Announcer.js",[t["Core/Renderer/HTML/AST.js"],t["Accessibility/Utils/DOMElementProvider.js"],t["Core/Globals.js"],t["Accessibility/Utils/HTMLUtilities.js"],t["Core/Utilities.js"]],(function(e,t,i,r,n){let{doc:o}=i,{addClass:s,visuallyHideElement:a}=r,{attr:l}=n;return class{constructor(e,i){this.chart=e,this.domElementProvider=new t,this.announceRegion=this.addAnnounceRegion(i)}destroy(){this.domElementProvider.destroyCreatedElements()}announce(t){e.setElementHTML(this.announceRegion,t),this.clearAnnouncementRegionTimer&&clearTimeout(this.clearAnnouncementRegionTimer),this.clearAnnouncementRegionTimer=setTimeout((()=>{this.announceRegion.innerHTML=e.emptyHTML,delete this.clearAnnouncementRegionTimer}),3e3)}addAnnounceRegion(e){let t=this.chart.announcerContainer||this.createAnnouncerContainer(),i=this.domElementProvider.createElement("div");return l(i,{"aria-hidden":!1,"aria-live":e,"aria-atomic":!0}),this.chart.styledMode?s(i,"highcharts-visually-hidden"):a(i),t.appendChild(i),i}createAnnouncerContainer(){let e=this.chart,t=o.createElement("div");return l(t,{"aria-hidden":!1,class:"highcharts-announcer-container"}),t.style.position="relative",e.renderTo.insertBefore(t,e.renderTo.firstChild),e.announcerContainer=t,t}}})),i(t,"Accessibility/Components/AnnotationsA11y.js",[t["Accessibility/Utils/HTMLUtilities.js"]],(function(e){let{escapeStringForHTML:t,stripHTMLTagsFromString:i}=e;function r(e){return(e.annotations||[]).reduce(((e,t)=>(t.options&&!1!==t.options.visible&&(e=e.concat(t.labels)),e)),[])}function n(e){return e.options&&e.options.accessibility&&e.options.accessibility.description||e.graphic&&e.graphic.text&&e.graphic.text.textStr||""}function o(e){let t=e.options&&e.options.accessibility&&e.options.accessibility.description;if(t)return t;let i=e.chart,r=n(e),o=e.points,s=o.filter((e=>!!e.graphic)).map((e=>{let t=e.accessibility&&e.accessibility.valueDescription||(e=>e.graphic&&e.graphic.element&&e.graphic.element.getAttribute("aria-label")||"")(e),i=e&&e.series.name||"";return(i?i+", ":"")+"data point "+t})).filter((e=>!!e)),a=s.length,l=a>1?"MultiplePoints":a?"SinglePoint":"NoPoints",c={annotationText:r,annotation:e,numPoints:a,annotationPoint:s[0],additionalAnnotationPoints:s.slice(1)};return i.langFormat("accessibility.screenReaderSection.annotations.description"+l,c)}function s(e){return r(e).map((r=>{let n=t(i(o(r),e.renderer.forExport));return n?`<li>${n}</li>`:""}))}return{getAnnotationsInfoHTML:function(e){let t=e.annotations;return t&&t.length?`<ul style="list-style-type: none">${s(e).join(" ")}</ul>`:""},getAnnotationLabelDescription:o,getAnnotationListItems:s,getPointAnnotationTexts:function(e){let t=r(e.series.chart).filter((t=>t.points.indexOf(e)>-1));return t.length?t.map((e=>`${n(e)}`)):[]}}})),i(t,"Accessibility/Components/InfoRegionsComponent.js",[t["Accessibility/A11yI18n.js"],t["Accessibility/AccessibilityComponent.js"],t["Accessibility/Utils/Announcer.js"],t["Accessibility/Components/AnnotationsA11y.js"],t["Core/Renderer/HTML/AST.js"],t["Accessibility/Utils/ChartUtilities.js"],t["Core/Templating.js"],t["Core/Globals.js"],t["Accessibility/Utils/HTMLUtilities.js"],t["Core/Utilities.js"]],(function(e,t,i,r,n,o,s,a,l,c){let{getAnnotationsInfoHTML:u}=r,{getAxisDescription:h,getAxisRangeDescription:d,getChartTitle:p,unhideChartElementFromAT:f}=o,{format:m}=s,{doc:g}=a,{addClass:y,getElement:_,getHeadingTagNameForElement:v,stripHTMLTagsFromString:x,visuallyHideElement:b}=l,{attr:w,pick:S,replaceNested:T}=c;function M(e){return T(e,[/<([\w\-.:!]+)\b[^<>]*>\s*<\/\1>/g,""])}return class extends t{constructor(){super(...arguments),this.screenReaderSections={}}init(){let e=this.chart,t=this;this.initRegionsDefinitions(),this.addEvent(e,"aftergetTableAST",(function(e){t.onDataTableCreated(e)})),this.addEvent(e,"afterViewData",(function(e){e.wasHidden&&(t.dataTableDiv=e.element,setTimeout((function(){t.focusDataTable()}),300))})),this.addEvent(e,"afterHideData",(function(){t.viewDataTableButton&&t.viewDataTableButton.setAttribute("aria-expanded","false")})),e.exporting&&this.addEvent(e,"afterPrint",(function(){t.updateAllScreenReaderSections()})),this.announcer=new i(e,"assertive")}initRegionsDefinitions(){let e=this,t=this.chart.options.accessibility;this.screenReaderSections={before:{element:null,buildContent:function(i){let r=t.screenReaderSection.beforeChartFormatter;return r?r(i):e.defaultBeforeChartFormatter(i)},insertIntoDOM:function(e,t){t.renderTo.insertBefore(e,t.renderTo.firstChild)},afterInserted:function(){void 0!==e.sonifyButtonId&&e.initSonifyButton(e.sonifyButtonId),void 0!==e.dataTableButtonId&&e.initDataTableButton(e.dataTableButtonId)}},after:{element:null,buildContent:function(i){let r=t.screenReaderSection.afterChartFormatter;return r?r(i):e.defaultAfterChartFormatter()},insertIntoDOM:function(e,t){t.renderTo.insertBefore(e,t.container.nextSibling)},afterInserted:function(){e.chart.accessibility&&t.keyboardNavigation.enabled&&e.chart.accessibility.keyboardNavigation.updateExitAnchor()}}}}onChartRender(){this.linkedDescriptionElement=this.getLinkedDescriptionElement(),this.setLinkedDescriptionAttrs(),this.updateAllScreenReaderSections()}updateAllScreenReaderSections(){let e=this;Object.keys(this.screenReaderSections).forEach((function(t){e.updateScreenReaderSection(t)}))}getLinkedDescriptionElement(){let e=this.chart.options.accessibility.linkedDescription;if(!e)return;if("string"!=typeof e)return e;let t=m(e,this.chart),i=g.querySelectorAll(t);return 1===i.length?i[0]:void 0}setLinkedDescriptionAttrs(){let e=this.linkedDescriptionElement;e&&(e.setAttribute("aria-hidden","true"),y(e,"highcharts-linked-description"))}updateScreenReaderSection(e){let t=this.chart,i=this.screenReaderSections[e],r=i.buildContent(t),o=i.element=i.element||this.createElement("div"),s=o.firstChild||this.createElement("div");r?(this.setScreenReaderSectionAttribs(o,e),n.setElementHTML(s,r),o.appendChild(s),i.insertIntoDOM(o,t),t.styledMode?y(s,"highcharts-visually-hidden"):b(s),f(t,s),i.afterInserted&&i.afterInserted()):(o.parentNode&&o.parentNode.removeChild(o),i.element=null)}setScreenReaderSectionAttribs(e,t){let i=this.chart,r=i.langFormat("accessibility.screenReaderSection."+t+"RegionLabel",{chart:i,chartTitle:p(i)});w(e,{id:`highcharts-screen-reader-region-${t}-${i.index}`,"aria-label":r||void 0}),e.style.position="relative",r&&e.setAttribute("role","all"===i.options.accessibility.landmarkVerbosity?"region":"group")}defaultBeforeChartFormatter(){let t=this.chart,i=t.options.accessibility.screenReaderSection.beforeChartFormat;if(!i)return"";let r=this.getAxesDescription(),n=t.sonify&&t.options.sonification&&t.options.sonification.enabled,o="highcharts-a11y-sonify-data-btn-"+t.index,s="hc-linkto-highcharts-data-table-"+t.index,a=u(t),l=t.langFormat("accessibility.screenReaderSection.annotations.heading",{chart:t}),c={headingTagName:v(t.renderTo),chartTitle:p(t),typeDescription:this.getTypeDescriptionText(),chartSubtitle:this.getSubtitleText(),chartLongdesc:this.getLongdescText(),xAxisDescription:r.xAxis,yAxisDescription:r.yAxis,playAsSoundButton:n?this.getSonifyButtonText(o):"",viewTableButton:t.getCSV?this.getDataTableButtonText(s):"",annotationsTitle:a?l:"",annotationsList:a},h=e.i18nFormat(i,c,t);return this.dataTableButtonId=s,this.sonifyButtonId=o,M(h)}defaultAfterChartFormatter(){let t=this.chart,i=t.options.accessibility.screenReaderSection.afterChartFormat;if(!i)return"";let r={endOfChartMarker:this.getEndOfChartMarkerText()};return M(e.i18nFormat(i,r,t))}getLinkedDescription(){let e=this.linkedDescriptionElement;return x(e&&e.innerHTML||"",this.chart.renderer.forExport)}getLongdescText(){let e=this.chart.options,t=e.caption,i=t&&t.text,r=this.getLinkedDescription();return e.accessibility.description||r||i||""}getTypeDescriptionText(){let e=this.chart;return e.types?e.options.accessibility.typeDescription||function(e,t){let i=t[0],r=e.series&&e.series[0]||{},n=e.mapView&&e.mapView.geoMap&&e.mapView.geoMap.title,o={numSeries:e.series.length,numPoints:r.points&&r.points.length,chart:e,mapTitle:n};return i?"map"===i||"tiledwebmap"===i?o.mapTitle?e.langFormat("accessibility.chartTypes.mapTypeDescription",o):e.langFormat("accessibility.chartTypes.unknownMap",o):e.types.length>1?e.langFormat("accessibility.chartTypes.combinationChart",o):function(e,t,i){let r=t[0],n=e.langFormat("accessibility.seriesTypeDescriptions."+r,i),o=e.series&&e.series.length<2?"Single":"Multiple";return(e.langFormat("accessibility.chartTypes."+r+o,i)||e.langFormat("accessibility.chartTypes.default"+o,i))+(n?" "+n:"")}(e,t,o):e.langFormat("accessibility.chartTypes.emptyChart",o)}(e,e.types):""}getDataTableButtonText(e){let t=this.chart;return'<button id="'+e+'">'+t.langFormat("accessibility.table.viewAsDataTableButtonText",{chart:t,chartTitle:p(t)})+"</button>"}getSonifyButtonText(e){let t=this.chart;return t.options.sonification&&!1===t.options.sonification.enabled?"":'<button id="'+e+'">'+t.langFormat("accessibility.sonification.playAsSoundButtonText",{chart:t,chartTitle:p(t)})+"</button>"}getSubtitleText(){let e=this.chart.options.subtitle;return x(e&&e.text||"",this.chart.renderer.forExport)}getEndOfChartMarkerText(){let e=_(`highcharts-end-of-chart-marker-${this.chart.index}`);if(e)return e.outerHTML;let t=this.chart,i=t.langFormat("accessibility.screenReaderSection.endOfChartMarker",{chart:t});return'<div id="highcharts-end-of-chart-marker-'+t.index+'">'+i+"</div>"}onDataTableCreated(e){let t=this.chart;if(t.options.accessibility.enabled){this.viewDataTableButton&&this.viewDataTableButton.setAttribute("aria-expanded","true");let i=e.tree.attributes||{};i.tabindex=-1,i.summary=t.langFormat("accessibility.table.tableSummary",{chart:t}),e.tree.attributes=i}}focusDataTable(){let e=this.dataTableDiv,t=e&&e.getElementsByTagName("table")[0];t&&t.focus&&t.focus()}initSonifyButton(e){let t=this.sonifyButton=_(e),i=this.chart,r=e=>{t&&(t.setAttribute("aria-hidden","true"),t.setAttribute("aria-label","")),e.preventDefault(),e.stopPropagation();let r=i.langFormat("accessibility.sonification.playAsSoundClickAnnouncement",{chart:i});this.announcer.announce(r),setTimeout((()=>{t&&(t.removeAttribute("aria-hidden"),t.removeAttribute("aria-label")),i.sonify&&i.sonify()}),1e3)};t&&i&&(t.setAttribute("tabindex",-1),t.onclick=function(e){(i.options.accessibility&&i.options.accessibility.screenReaderSection.onPlayAsSoundClick||r).call(this,e,i)})}initDataTableButton(e){let t=this.viewDataTableButton=_(e),i=this.chart,r=e.replace("hc-linkto-","");t&&(w(t,{tabindex:-1,"aria-expanded":!!_(r)}),t.onclick=i.options.accessibility.screenReaderSection.onViewDataTableClick||function(){i.viewData()})}getAxesDescription(){let e=this.chart,t=function(t,i){let r=e[t];return r.length>1||r[0]&&S(r[0].options.accessibility&&r[0].options.accessibility.enabled,i)},i=!!e.types&&0>e.types.indexOf("map")&&0>e.types.indexOf("treemap")&&0>e.types.indexOf("tilemap"),r=!!e.hasCartesianSeries,n=t("xAxis",!e.angular&&r&&i),o=t("yAxis",r&&i),s={};return n&&(s.xAxis=this.getAxisDescriptionText("xAxis")),o&&(s.yAxis=this.getAxisDescriptionText("yAxis")),s}getAxisDescriptionText(e){let t=this.chart,i=t[e];return t.langFormat("accessibility.axis."+e+"Description"+(i.length>1?"Plural":"Singular"),{chart:t,names:i.map((function(e){return h(e)})),ranges:i.map((function(e){return d(e)})),numAxes:i.length})}destroy(){this.announcer&&this.announcer.destroy()}}})),i(t,"Accessibility/Components/MenuComponent.js",[t["Core/Utilities.js"],t["Accessibility/AccessibilityComponent.js"],t["Accessibility/KeyboardNavigationHandler.js"],t["Accessibility/Utils/ChartUtilities.js"],t["Accessibility/Utils/HTMLUtilities.js"]],(function(e,t,i,r,n){let{attr:o}=e,{getChartTitle:s,unhideChartElementFromAT:a}=r,{getFakeMouseEvent:l}=n;function c(e){return e.exportSVGElements&&e.exportSVGElements[0]}class u extends t{init(){let e=this.chart,t=this;this.addEvent(e,"exportMenuShown",(function(){t.onMenuShown()})),this.addEvent(e,"exportMenuHidden",(function(){t.onMenuHidden()})),this.createProxyGroup()}onMenuHidden(){let e=this.chart.exportContextMenu;e&&e.setAttribute("aria-hidden","true"),this.setExportButtonExpandedState("false")}onMenuShown(){let e=this.chart,t=e.exportContextMenu;t&&(this.addAccessibleContextMenuAttribs(),a(e,t)),this.setExportButtonExpandedState("true")}setExportButtonExpandedState(e){this.exportButtonProxy&&this.exportButtonProxy.innerElement.setAttribute("aria-expanded",e)}onChartRender(){let e=this.chart,t=e.focusElement,i=e.accessibility;this.proxyProvider.clearGroup("chartMenu"),this.proxyMenuButton(),this.exportButtonProxy&&t&&t===e.exportingGroup&&(t.focusBorder?e.setFocusToElement(t,this.exportButtonProxy.innerElement):i&&i.keyboardNavigation.tabindexContainer.focus())}proxyMenuButton(){let e=this.chart,t=this.proxyProvider,i=c(e);(function(e){let t=e.options.exporting,i=c(e);return!!(t&&!1!==t.enabled&&t.accessibility&&t.accessibility.enabled&&i&&i.element)})(e)&&i&&(this.exportButtonProxy=t.addProxyElement("chartMenu",{click:i},"button",{"aria-label":e.langFormat("accessibility.exporting.menuButtonLabel",{chart:e,chartTitle:s(e)}),"aria-expanded":!1,title:e.options.lang.contextButtonTitle||null}))}createProxyGroup(){this.chart&&this.proxyProvider&&this.proxyProvider.addGroup("chartMenu")}addAccessibleContextMenuAttribs(){let e=this.chart,t=e.exportDivElements;if(t&&t.length){t.forEach((e=>{e&&("LI"!==e.tagName||e.children&&e.children.length?e.setAttribute("aria-hidden","true"):e.setAttribute("tabindex",-1))}));let i=t[0]&&t[0].parentNode;i&&o(i,{"aria-hidden":void 0,"aria-label":e.langFormat("accessibility.exporting.chartMenuLabel",{chart:e}),role:"list"})}}getKeyboardNavigation(){let e=this.keyCodes,t=this.chart,r=this;return new i(t,{keyCodeMap:[[[e.left,e.up],function(){return r.onKbdPrevious(this)}],[[e.right,e.down],function(){return r.onKbdNext(this)}],[[e.enter,e.space],function(){return r.onKbdClick(this)}]],validate:function(){return!!t.exporting&&!1!==t.options.exporting.enabled&&!1!==t.options.exporting.accessibility.enabled},init:function(){let e=r.exportButtonProxy,i=r.chart.exportingGroup;e&&i&&t.setFocusToElement(i,e.innerElement)},terminate:function(){t.hideExportMenu()}})}onKbdPrevious(e){let t=this.chart,i=t.options.accessibility,r=e.response,n=t.highlightedExportItemIx||0;for(;n--;)if(t.highlightExportItem(n))return r.success;return i.keyboardNavigation.wrapAround?(t.highlightLastExportItem(),r.success):r.prev}onKbdNext(e){let t=this.chart,i=t.options.accessibility,r=e.response;for(let n=(t.highlightedExportItemIx||0)+1;n<t.exportDivElements.length;++n)if(t.highlightExportItem(n))return r.success;return i.keyboardNavigation.wrapAround?(t.highlightExportItem(0),r.success):r.next}onKbdClick(e){let t=this.chart,i=t.exportDivElements[t.highlightedExportItemIx],r=c(t).element;return t.openMenu?this.fakeClickEvent(i):(this.fakeClickEvent(r),t.highlightExportItem(0)),e.response.success}}return function(e){function t(){let e=c(this);if(e){let t=e.element;t.onclick&&t.onclick(l("click"))}}function i(){let e=this.exportDivElements;e&&this.exportContextMenu&&this.openMenu&&(e.forEach((e=>{e&&"highcharts-menu-item"===e.className&&e.onmouseout&&e.onmouseout(l("mouseout"))})),this.highlightedExportItemIx=0,this.exportContextMenu.hideMenu(),this.container.focus())}function r(e){let t=this.exportDivElements&&this.exportDivElements[e],i=this.exportDivElements&&this.exportDivElements[this.highlightedExportItemIx];if(t&&"LI"===t.tagName&&(!t.children||!t.children.length)){let r=!!(this.renderTo.getElementsByTagName("g")[0]||{}).focus;return t.focus&&r&&t.focus(),i&&i.onmouseout&&i.onmouseout(l("mouseout")),t.onmouseover&&t.onmouseover(l("mouseover")),this.highlightedExportItemIx=e,!0}return!1}function n(){if(this.exportDivElements){let e=this.exportDivElements.length;for(;e--;)if(this.highlightExportItem(e))return!0}return!1}e.compose=function(e){let o=e.prototype;o.hideExportMenu||(o.hideExportMenu=i,o.highlightExportItem=r,o.highlightLastExportItem=n,o.showExportMenu=t)}}(u||(u={})),u})),i(t,"Accessibility/KeyboardNavigation.js",[t["Core/Globals.js"],t["Accessibility/Components/MenuComponent.js"],t["Core/Utilities.js"],t["Accessibility/Utils/EventProvider.js"],t["Accessibility/Utils/HTMLUtilities.js"]],(function(e,t,i,r,n){let{doc:o,win:s}=e,{addEvent:a,defined:l,fireEvent:c}=i,{getElement:u,simulatedEventTarget:h}=n;class d{constructor(e,t){this.currentModuleIx=NaN,this.modules=[],this.init(e,t)}init(e,t){let i=this.eventProvider=new r;this.chart=e,this.components=t,this.modules=[],this.currentModuleIx=0,this.update(),i.addEvent(this.tabindexContainer,"keydown",(e=>this.onKeydown(e))),i.addEvent(this.tabindexContainer,"focus",(e=>this.onFocus(e))),["mouseup","touchend"].forEach((e=>i.addEvent(o,e,(e=>this.onMouseUp(e))))),["mousedown","touchstart"].forEach((t=>i.addEvent(e.renderTo,t,(()=>{this.isClickingChart=!0}))))}update(e){let t=this.chart.options.accessibility,i=t&&t.keyboardNavigation,r=this.components;this.updateContainerTabindex(),i&&i.enabled&&e&&e.length?(this.modules=e.reduce((function(e,t){let i=r[t].getKeyboardNavigation();return e.concat(i)}),[]),this.updateExitAnchor()):(this.modules=[],this.currentModuleIx=0,this.removeExitAnchor())}updateExitAnchor(){let e=u(`highcharts-end-of-chart-marker-${this.chart.index}`);this.removeExitAnchor(),e?(this.makeElementAnExitAnchor(e),this.exitAnchor=e):this.createExitAnchor()}move(e){let t=this.modules&&this.modules[this.currentModuleIx];t&&t.terminate&&t.terminate(e),this.chart.focusElement&&this.chart.focusElement.removeFocusBorder(),this.currentModuleIx+=e;let i=this.modules&&this.modules[this.currentModuleIx];if(i){if(i.validate&&!i.validate())return this.move(e);if(i.init)return i.init(e),!0}return this.currentModuleIx=0,this.exiting=!0,e>0?this.exitAnchor&&this.exitAnchor.focus():this.tabindexContainer.focus(),!1}onFocus(e){let t=this.chart,i=e.relatedTarget&&t.container.contains(e.relatedTarget),r=t.options.accessibility,n=r&&r.keyboardNavigation;if(n&&n.enabled&&!this.exiting&&!this.tabbingInBackwards&&!this.isClickingChart&&!i){let e=this.getFirstValidModuleIx();null!==e&&(this.currentModuleIx=e,this.modules[e].init(1))}this.keyboardReset=!1,this.exiting=!1}onMouseUp(e){if(delete this.isClickingChart,!this.keyboardReset&&e.relatedTarget!==h){let t=this.chart;if(!e.target||!t.container.contains(e.target)){let e=this.modules&&this.modules[this.currentModuleIx||0];e&&e.terminate&&e.terminate(),this.currentModuleIx=0}t.focusElement&&(t.focusElement.removeFocusBorder(),delete t.focusElement),this.keyboardReset=!0}}onKeydown(e){let t,i=e||s.event,r=this.modules&&this.modules.length&&this.modules[this.currentModuleIx],n=i.target;if((!n||"INPUT"!==n.nodeName||n.classList.contains("highcharts-a11y-proxy-element"))&&(this.keyboardReset=!1,this.exiting=!1,r)){let e=r.run(i);e===r.response.success?t=!0:e===r.response.prev?t=this.move(-1):e===r.response.next&&(t=this.move(1)),t&&(i.preventDefault(),i.stopPropagation())}}updateContainerTabindex(){let e,t=this.chart.options.accessibility,i=t&&t.keyboardNavigation,r=!(i&&!1===i.enabled),n=this.chart,o=n.container;n.renderTo.hasAttribute("tabindex")?(o.removeAttribute("tabindex"),e=n.renderTo):e=o,this.tabindexContainer=e;let s=e.getAttribute("tabindex");r&&!s?e.setAttribute("tabindex","0"):r||n.container.removeAttribute("tabindex")}createExitAnchor(){let e=this.chart,t=this.exitAnchor=o.createElement("div");e.renderTo.appendChild(t),this.makeElementAnExitAnchor(t)}makeElementAnExitAnchor(e){let t=this.tabindexContainer.getAttribute("tabindex")||0;e.setAttribute("class","highcharts-exit-anchor"),e.setAttribute("tabindex",t),e.setAttribute("aria-hidden",!1),this.addExitAnchorEventsToEl(e)}removeExitAnchor(){if(this.exitAnchor){let e=this.eventProvider.eventRemovers.find((e=>e.element===this.exitAnchor));e&&l(e.remover)&&this.eventProvider.removeEvent(e.remover),this.exitAnchor.parentNode&&this.exitAnchor.parentNode.removeChild(this.exitAnchor),delete this.exitAnchor}}addExitAnchorEventsToEl(e){let t=this.chart,i=this;this.eventProvider.addEvent(e,"focus",(function(e){let r=e||s.event,n=!(r.relatedTarget&&t.container.contains(r.relatedTarget)||i.exiting);if(t.focusElement&&delete t.focusElement,n){if(i.tabbingInBackwards=!0,i.tabindexContainer.focus(),delete i.tabbingInBackwards,r.preventDefault(),i.modules&&i.modules.length){i.currentModuleIx=i.modules.length-1;let e=i.modules[i.currentModuleIx];e&&e.validate&&!e.validate()?i.move(-1):e&&e.init(-1)}}else i.exiting=!1}))}getFirstValidModuleIx(){let e=this.modules.length;for(let t=0;t<e;++t){let e=this.modules[t];if(!e.validate||e.validate())return t}return null}destroy(){this.removeExitAnchor(),this.eventProvider.removeAddedEvents(),this.chart.container.removeAttribute("tabindex")}}return function(i){function r(){let e=this;c(this,"dismissPopupContent",{},(function(){e.tooltip&&e.tooltip.hide(0),e.hideExportMenu()}))}function n(t){27===(t.which||t.keyCode)&&e.charts&&e.charts.forEach((e=>{e&&e.dismissPopupContent&&e.dismissPopupContent()}))}i.compose=function(e){t.compose(e);let i=e.prototype;return i.dismissPopupContent||(i.dismissPopupContent=r,a(o,"keydown",n)),e}}(d||(d={})),d})),i(t,"Accessibility/Components/LegendComponent.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Globals.js"],t["Core/Legend/Legend.js"],t["Core/Utilities.js"],t["Accessibility/AccessibilityComponent.js"],t["Accessibility/KeyboardNavigationHandler.js"],t["Accessibility/Utils/ChartUtilities.js"],t["Accessibility/Utils/HTMLUtilities.js"]],(function(e,t,i,r,n,o,s,a){let{animObject:l}=e,{doc:c}=t,{addEvent:u,fireEvent:h,isNumber:d,pick:p,syncTimeout:f}=r,{getChartTitle:m}=s,{stripHTMLTagsFromString:g,addClass:y,removeClass:_}=a;function v(e){let t=e.legend&&e.legend.allItems,i=e.options.legend.accessibility||{},r=e.colorAxis&&e.colorAxis.some((e=>!e.dataClasses||!e.dataClasses.length));return!(!t||!t.length||r||!1===i.enabled)}function x(e,t){let i=t.legendItem||{};for(let r of(t.setState(e?"hover":"",!0),["group","label","symbol"])){let t=i[r],n=t&&t.element||t;n&&h(n,e?"mouseover":"mouseout")}}class b extends n{constructor(){super(...arguments),this.highlightedLegendItemIx=NaN,this.proxyGroup=null}init(){let e=this;this.recreateProxies(),this.addEvent(i,"afterScroll",(function(){this.chart===e.chart&&(e.proxyProvider.updateGroupProxyElementPositions("legend"),e.updateLegendItemProxyVisibility(),e.highlightedLegendItemIx>-1&&this.chart.highlightLegendItem(e.highlightedLegendItemIx))})),this.addEvent(i,"afterPositionItem",(function(t){this.chart===e.chart&&this.chart.renderer&&e.updateProxyPositionForItem(t.item)})),this.addEvent(i,"afterRender",(function(){this.chart===e.chart&&this.chart.renderer&&e.recreateProxies()&&f((()=>e.proxyProvider.updateGroupProxyElementPositions("legend")),l(p(this.chart.renderer.globalAnimation,!0)).duration)}))}updateLegendItemProxyVisibility(){let e,t=this.chart,i=t.legend,r=i.allItems||[],n=i.currentPage||1,o=i.clipHeight||0;r.forEach((r=>{if(r.a11yProxyElement){let s=i.pages&&i.pages.length,a=r.a11yProxyElement.element,l=!1;if(e=r.legendItem||{},s){let t=e.pageIx||0;l=(e.y||0)+(e.label?Math.round(e.label.getBBox().height):0)-i.pages[t]>o||t!==n-1}l?t.styledMode?y(a,"highcharts-a11y-invisible"):a.style.visibility="hidden":(_(a,"highcharts-a11y-invisible"),a.style.visibility="")}}))}onChartRender(){v(this.chart)||this.removeProxies()}highlightAdjacentLegendPage(e){let t=this.chart,i=t.legend,r=(i.currentPage||1)+e,n=i.pages||[];if(r>0&&r<=n.length){let e=0;for(let n of i.allItems)((n.legendItem||{}).pageIx||0)+1===r&&t.highlightLegendItem(e)&&(this.highlightedLegendItemIx=e),++e}}updateProxyPositionForItem(e){e.a11yProxyElement&&e.a11yProxyElement.refreshPosition()}recreateProxies(){let e=c.activeElement,t=this.proxyGroup,i=e&&t&&t.contains(e);return this.removeProxies(),!!v(this.chart)&&(this.addLegendProxyGroup(),this.proxyLegendItems(),this.updateLegendItemProxyVisibility(),this.updateLegendTitle(),i&&this.chart.highlightLegendItem(this.highlightedLegendItemIx),!0)}removeProxies(){this.proxyProvider.removeGroup("legend")}updateLegendTitle(){let e=this.chart,t=g((e.legend&&e.legend.options.title&&e.legend.options.title.text||"").replace(/<br ?\/?>/g," "),e.renderer.forExport),i=e.langFormat("accessibility.legend.legendLabel"+(t?"":"NoTitle"),{chart:e,legendTitle:t,chartTitle:m(e)});this.proxyProvider.updateGroupAttrs("legend",{"aria-label":i})}addLegendProxyGroup(){let e="all"===this.chart.options.accessibility.landmarkVerbosity?"region":null;this.proxyGroup=this.proxyProvider.addGroup("legend","ul",{"aria-label":"_placeholder_",role:e})}proxyLegendItems(){let e,t=this;((this.chart.legend||{}).allItems||[]).forEach((i=>{(e=i.legendItem||{}).label&&e.label.element&&t.proxyLegendItem(i)}))}proxyLegendItem(e){let t=e.legendItem||{};if(!t.label||!t.group)return;let i=this.chart.langFormat("accessibility.legend.legendItem",{chart:this.chart,itemName:g(e.name,this.chart.renderer.forExport),item:e}),r={tabindex:-1,"aria-pressed":e.visible,"aria-label":i},n=t.group.div?t.label:t.group;e.a11yProxyElement=this.proxyProvider.addProxyElement("legend",{click:t.label,visual:n.element},"button",r)}getKeyboardNavigation(){let e=this.keyCodes,t=this,i=this.chart;return new o(i,{keyCodeMap:[[[e.left,e.right,e.up,e.down],function(e){return t.onKbdArrowKey(this,e)}],[[e.enter,e.space],function(){return t.onKbdClick(this)}],[[e.pageDown,e.pageUp],function(i){let r=i===e.pageDown?1:-1;return t.highlightAdjacentLegendPage(r),this.response.success}]],validate:function(){return t.shouldHaveLegendNavigation()},init:function(){i.highlightLegendItem(0),t.highlightedLegendItemIx=0},terminate:function(){t.highlightedLegendItemIx=-1,i.legend.allItems.forEach((e=>x(!1,e)))}})}onKbdArrowKey(e,t){let{keyCodes:{left:i,up:r},highlightedLegendItemIx:n,chart:o}=this,s=o.legend.allItems.length,a=o.options.accessibility.keyboardNavigation.wrapAround,l=t===i||t===r?-1:1;return o.highlightLegendItem(n+l)?this.highlightedLegendItemIx+=l:a&&s>1&&(this.highlightedLegendItemIx=l>0?0:s-1,o.highlightLegendItem(this.highlightedLegendItemIx)),e.response.success}onKbdClick(e){let t=this.chart.legend.allItems[this.highlightedLegendItemIx];return t&&t.a11yProxyElement&&t.a11yProxyElement.click(),e.response.success}shouldHaveLegendNavigation(){if(!v(this.chart))return!1;let e=this.chart,t=(e.options.legend||{}).accessibility||{};return!!(e.legend.display&&t.keyboardNavigation&&t.keyboardNavigation.enabled)}destroy(){this.removeProxies()}}return function(e){function t(e){let t=this.legend.allItems,i=this.accessibility&&this.accessibility.components.legend.highlightedLegendItemIx,r=t[e],n=r?.legendItem||{};if(r){d(i)&&t[i]&&x(!1,t[i]),function(e,t){let i=(e.allItems[t].legendItem||{}).pageIx,r=e.currentPage;void 0!==i&&i+1!==r&&e.scroll(1+i-r)}(this.legend,e);let o=n.label,s=r.a11yProxyElement&&r.a11yProxyElement.innerElement;return o&&o.element&&s&&this.setFocusToElement(o,s),x(!0,r),!0}return!1}function i(e){let t=this.chart.options.accessibility,i=e.item;t.enabled&&i&&i.a11yProxyElement&&i.a11yProxyElement.innerElement.setAttribute("aria-pressed",e.visible?"true":"false")}e.compose=function(e,r){let n=e.prototype;n.highlightLegendItem||(n.highlightLegendItem=t,u(r,"afterColorizeItem",i))}}(b||(b={})),b})),i(t,"Stock/Navigator/ChartNavigatorComposition.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],(function(e,t){let i,{isTouchDevice:r}=e,{addEvent:n,merge:o,pick:s}=t,a=[];function l(){this.navigator&&this.navigator.setBaseSeries(null,!1)}function c(){let e,t,i,r=this.legend,n=this.navigator;if(n){e=r&&r.options,t=n.xAxis,i=n.yAxis;let{scrollbarHeight:o,scrollButtonSize:a}=n;this.inverted?(n.left=n.opposite?this.chartWidth-o-n.height:this.spacing[3]+o,n.top=this.plotTop+a):(n.left=s(t.left,this.plotLeft+a),n.top=n.navigatorOptions.top||this.chartHeight-n.height-o-(this.scrollbar?.options.margin||0)-this.spacing[2]-(this.rangeSelector&&this.extraBottomMargin?this.rangeSelector.getHeight():0)-(e&&"bottom"===e.verticalAlign&&"proximate"!==e.layout&&e.enabled&&!e.floating?r.legendHeight+s(e.margin,10):0)-(this.titleOffset?this.titleOffset[2]:0)),t&&i&&(this.inverted?t.options.left=i.options.left=n.left:t.options.top=i.options.top=n.top,t.setAxisSize(),i.setAxisSize())}}function u(e){!this.navigator&&!this.scroller&&(this.options.navigator.enabled||this.options.scrollbar.enabled)&&(this.scroller=this.navigator=new i(this),s(e.redraw,!0)&&this.redraw(e.animation))}function h(){let e=this.options;(e.navigator.enabled||e.scrollbar.enabled)&&(this.scroller=this.navigator=new i(this))}function d(){let e=this.options,t=e.navigator,i=e.rangeSelector;if((t&&t.enabled||i&&i.enabled)&&(!r&&"x"===this.zooming.type||r&&"x"===this.zooming.pinchType))return!1}function p(e){let t=e.navigator;if(t&&e.xAxis[0]){let i=e.xAxis[0].getExtremes();t.render(i.min,i.max)}}function f(e){let t=e.options.navigator||{},i=e.options.scrollbar||{};!this.navigator&&!this.scroller&&(t.enabled||i.enabled)&&(o(!0,this.options.navigator,t),o(!0,this.options.scrollbar,i),delete e.options.navigator,delete e.options.scrollbar)}return{compose:function(e,r){if(t.pushUnique(a,e)){let t=e.prototype;i=r,t.callbacks.push(p),n(e,"afterAddSeries",l),n(e,"afterSetChartSize",c),n(e,"afterUpdate",u),n(e,"beforeRender",h),n(e,"beforeShowResetZoom",d),n(e,"update",f)}}}})),i(t,"Core/Axis/NavigatorAxisComposition.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],(function(e,t){let{isTouchDevice:i}=e,{addEvent:r,correctFloat:n,defined:o,isNumber:s,pick:a}=t;function l(){this.navigatorAxis||(this.navigatorAxis=new u(this))}function c(e){let t,r=this.chart,n=r.options,s=n.navigator,a=this.navigatorAxis,l=r.zooming.pinchType,c=n.rangeSelector,u=r.zooming.type;if(this.isXAxis&&(s?.enabled||c?.enabled))if("y"===u&&"zoom"===e.trigger)t=!1;else if(("zoom"===e.trigger&&"xy"===u||i&&"xy"===l)&&this.options.range){let t=a.previousZoom;o(e.min)?a.previousZoom=[this.min,this.max]:t&&(e.min=t[0],e.max=t[1],a.previousZoom=void 0)}void 0!==t&&e.preventDefault()}class u{static compose(e){e.keepProps.includes("navigatorAxis")||(e.keepProps.push("navigatorAxis"),r(e,"init",l),r(e,"setExtremes",c))}constructor(e){this.axis=e}destroy(){this.axis=void 0}toFixedRange(e,t,i,r){let l=this.axis,c=(l.pointRange||0)/2,u=a(i,l.translate(e,!0,!l.horiz)),h=a(r,l.translate(t,!0,!l.horiz));return o(i)||(u=n(u+c)),o(r)||(h=n(h-c)),s(u)&&s(h)||(u=h=void 0),{min:u,max:h}}}return u})),i(t,"Stock/Navigator/NavigatorDefaults.js",[t["Core/Color/Color.js"],t["Core/Series/SeriesRegistry.js"]],(function(e,t){let{parse:i}=e,{seriesTypes:r}=t;return{height:40,margin:25,maskInside:!0,handles:{width:7,borderRadius:0,height:15,symbols:["navigator-handle","navigator-handle"],enabled:!0,lineWidth:1,backgroundColor:"#f2f2f2",borderColor:"#999999"},maskFill:i("#667aff").setOpacity(.3).get(),outlineColor:"#999999",outlineWidth:1,series:{type:void 0===r.areaspline?"line":"areaspline",fillOpacity:.05,lineWidth:1,compare:null,sonification:{enabled:!1},dataGrouping:{approximation:"average",enabled:!0,groupPixelWidth:2,firstAnchor:"firstPoint",anchor:"middle",lastAnchor:"lastPoint",units:[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2,3,4]],["week",[1,2,3]],["month",[1,3,6]],["year",null]]},dataLabels:{enabled:!1,zIndex:2},id:"highcharts-navigator-series",className:"highcharts-navigator-series",lineColor:null,marker:{enabled:!1},threshold:null},xAxis:{className:"highcharts-navigator-xaxis",tickLength:0,lineWidth:0,gridLineColor:"#e6e6e6",id:"navigator-x-axis",gridLineWidth:1,tickPixelInterval:200,labels:{align:"left",style:{color:"#000000",fontSize:"0.7em",opacity:.6,textOutline:"2px contrast"},x:3,y:-4},crosshair:!1},yAxis:{className:"highcharts-navigator-yaxis",gridLineWidth:0,startOnTick:!1,endOnTick:!1,minPadding:.1,id:"navigator-y-axis",maxPadding:.1,labels:{enabled:!1},crosshair:!1,title:{text:null},tickLength:0,tickWidth:0}}})),i(t,"Stock/Navigator/NavigatorSymbols.js",[t["Core/Renderer/SVG/Symbols.js"],t["Core/Utilities.js"]],(function(e,t){let{relativeLength:i}=t;return{"navigator-handle":function(t,r,n,o){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=s.width?s.width/2:n,l=i(s.borderRadius||0,Math.min(2*a,o));return[["M",-1.5,(o=s.height||o)/2-3.5],["L",-1.5,o/2+4.5],["M",.5,o/2-3.5],["L",.5,o/2+4.5],...e.rect(-a-1,.5,2*a+1,o,{r:l})]}}})),i(t,"Stock/Utilities/StockUtilities.js",[t["Core/Utilities.js"]],(function(e){let{defined:t}=e;return{setFixedRange:function(e){let i=this.xAxis[0];t(i.dataMax)&&t(i.dataMin)&&e?this.fixedRange=Math.min(e,i.dataMax-i.dataMin):this.fixedRange=e}}})),i(t,"Stock/Navigator/NavigatorComposition.js",[t["Core/Defaults.js"],t["Core/Globals.js"],t["Core/Axis/NavigatorAxisComposition.js"],t["Stock/Navigator/NavigatorDefaults.js"],t["Stock/Navigator/NavigatorSymbols.js"],t["Core/Renderer/RendererRegistry.js"],t["Stock/Utilities/StockUtilities.js"],t["Core/Utilities.js"]],(function(e,t,i,r,n,o,s,a){let{setOptions:l}=e,{composed:c}=t,{getRendererType:u}=o,{setFixedRange:h}=s,{addEvent:d,extend:p,pushUnique:f}=a;function m(){this.chart.navigator&&!this.options.isInternal&&this.chart.navigator.setBaseSeries(null,!1)}return{compose:function(e,t,o){i.compose(t),f(c,"Navigator")&&(e.prototype.setFixedRange=h,p(u().prototype.symbols,n),d(o,"afterUpdate",m),l({navigator:r}))}}})),i(t,"Core/Axis/ScrollbarAxis.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],(function(e,t){var i;let{composed:r}=e,{addEvent:n,defined:o,pick:s,pushUnique:a}=t;return function(e){let t;function i(e){let t=s(e.options&&e.options.min,e.min),i=s(e.options&&e.options.max,e.max);return{axisMin:t,axisMax:i,scrollMin:o(e.dataMin)?Math.min(t,e.min,e.dataMin,s(e.threshold,1/0)):t,scrollMax:o(e.dataMax)?Math.max(i,e.max,e.dataMax,s(e.threshold,-1/0)):i}}function l(){let e=this.scrollbar,t=e&&!e.options.opposite,i=this.horiz?2:t?3:1;e&&(this.chart.scrollbarsOffsets=[0,0],this.chart.axisOffset[i]+=e.size+(e.options.margin||0))}function c(){let e=this;e.options&&e.options.scrollbar&&e.options.scrollbar.enabled&&(e.options.scrollbar.vertical=!e.horiz,e.options.startOnTick=e.options.endOnTick=!1,e.scrollbar=new t(e.chart.renderer,e.options.scrollbar,e.chart),n(e.scrollbar,"changed",(function(t){let r,n,{axisMin:s,axisMax:a,scrollMin:l,scrollMax:c}=i(e),u=c-l;if(o(s)&&o(a))if(e.horiz&&!e.reversed||!e.horiz&&e.reversed?(r=l+u*this.to,n=l+u*this.from):(r=l+u*(1-this.from),n=l+u*(1-this.to)),this.shouldUpdateExtremes(t.DOMType)){let i="mousemove"!==t.DOMType&&"touchmove"!==t.DOMType&&void 0;e.setExtremes(n,r,!0,i,t)}else this.setRange(this.from,this.to)})))}function u(){let e,t,r,{scrollMin:n,scrollMax:s}=i(this),a=this.scrollbar,l=this.axisTitleMargin+(this.titleOffset||0),c=this.chart.scrollbarsOffsets,u=this.options.margin||0;if(a&&c){if(this.horiz)this.opposite||(c[1]+=l),a.position(this.left,this.top+this.height+2+c[1]-(this.opposite?u:0),this.width,this.height),this.opposite||(c[1]+=u),e=1;else{let t;this.opposite&&(c[0]+=l),t=a.options.opposite?this.left+this.width+2+c[0]-(this.opposite?0:u):this.opposite?0:u,a.position(t,this.top,this.width,this.height),this.opposite&&(c[0]+=u),e=0}if(c[e]+=a.size+(a.options.margin||0),isNaN(n)||isNaN(s)||!o(this.min)||!o(this.max)||this.dataMin===this.dataMax)a.setRange(0,1);else if(this.min===this.max){let e=this.pointRange/(this.dataMax+1);t=e*this.min,r=e*(this.max+1),a.setRange(t,r)}else t=(this.min-n)/(s-n),r=(this.max-n)/(s-n),this.horiz&&!this.reversed||!this.horiz&&this.reversed?a.setRange(t,r):a.setRange(1-r,1-t)}}e.compose=function(e,i){a(r,"Axis.Scrollbar")&&(t=i,n(e,"afterGetOffset",l),n(e,"afterInit",c),n(e,"afterRender",u))}}(i||(i={})),i})),i(t,"Stock/Scrollbar/ScrollbarDefaults.js",[],(function(){return{height:10,barBorderRadius:5,buttonBorderRadius:0,buttonsEnabled:!1,liveRedraw:void 0,margin:void 0,minWidth:6,opposite:!0,step:.2,zIndex:3,barBackgroundColor:"#cccccc",barBorderWidth:0,barBorderColor:"#cccccc",buttonArrowColor:"#333333",buttonBackgroundColor:"#e6e6e6",buttonBorderColor:"#cccccc",buttonBorderWidth:1,rifleColor:"none",trackBackgroundColor:"rgba(255, 255, 255, 0.001)",trackBorderColor:"#cccccc",trackBorderRadius:5,trackBorderWidth:1}})),i(t,"Stock/Scrollbar/Scrollbar.js",[t["Core/Defaults.js"],t["Core/Globals.js"],t["Core/Axis/ScrollbarAxis.js"],t["Stock/Scrollbar/ScrollbarDefaults.js"],t["Core/Utilities.js"]],(function(e,t,i,r,n){let{defaultOptions:o}=e,{addEvent:s,correctFloat:a,crisp:l,defined:c,destroyObjectProperties:u,fireEvent:h,merge:d,pick:p,removeEvent:f}=n;class m{static compose(e){i.compose(e,m)}static swapXY(e,t){return t&&e.forEach((e=>{let t,i=e.length;for(let r=0;r<i;r+=2)"number"==typeof(t=e[r+1])&&(e[r+1]=e[r+2],e[r+2]=t)})),e}constructor(e,t,i){this._events=[],this.chartX=0,this.chartY=0,this.from=0,this.scrollbarButtons=[],this.scrollbarLeft=0,this.scrollbarStrokeWidth=1,this.scrollbarTop=0,this.size=0,this.to=0,this.trackBorderWidth=1,this.x=0,this.y=0,this.init(e,t,i)}addEvents(){let e=this.options.inverted?[1,0]:[0,1],t=this.scrollbarButtons,i=this.scrollbarGroup.element,r=this.track.element,n=this.mouseDownHandler.bind(this),o=this.mouseMoveHandler.bind(this),a=this.mouseUpHandler.bind(this),l=[[t[e[0]].element,"click",this.buttonToMinClick.bind(this)],[t[e[1]].element,"click",this.buttonToMaxClick.bind(this)],[r,"click",this.trackClick.bind(this)],[i,"mousedown",n],[i.ownerDocument,"mousemove",o],[i.ownerDocument,"mouseup",a],[i,"touchstart",n],[i.ownerDocument,"touchmove",o],[i.ownerDocument,"touchend",a]];l.forEach((function(e){s.apply(null,e)})),this._events=l}buttonToMaxClick(e){let t=(this.to-this.from)*p(this.options.step,.2);this.updatePosition(this.from+t,this.to+t),h(this,"changed",{from:this.from,to:this.to,trigger:"scrollbar",DOMEvent:e})}buttonToMinClick(e){let t=a(this.to-this.from)*p(this.options.step,.2);this.updatePosition(a(this.from-t),a(this.to-t)),h(this,"changed",{from:this.from,to:this.to,trigger:"scrollbar",DOMEvent:e})}cursorToScrollbarPosition(e){let t=this.options,i=t.minWidth>this.calculatedWidth?t.minWidth:0;return{chartX:(e.chartX-this.x-this.xOffset)/(this.barWidth-i),chartY:(e.chartY-this.y-this.yOffset)/(this.barWidth-i)}}destroy(){let e=this,t=e.chart.scroller;e.removeEvents(),["track","scrollbarRifles","scrollbar","scrollbarGroup","group"].forEach((function(t){e[t]&&e[t].destroy&&(e[t]=e[t].destroy())})),t&&e===t.scrollbar&&(t.scrollbar=null,u(t.scrollbarButtons))}drawScrollbarButton(e){let t=this.renderer,i=this.scrollbarButtons,r=this.options,n=this.size,o=t.g().add(this.group);if(i.push(o),r.buttonsEnabled){let s=t.rect().addClass("highcharts-scrollbar-button").add(o);this.chart.styledMode||s.attr({stroke:r.buttonBorderColor,"stroke-width":r.buttonBorderWidth,fill:r.buttonBackgroundColor}),s.attr(s.crisp({x:-.5,y:-.5,width:n,height:n,r:r.buttonBorderRadius},s.strokeWidth()));let a=t.path(m.swapXY([["M",n/2+(e?-1:1),n/2-3],["L",n/2+(e?-1:1),n/2+3],["L",n/2+(e?2:-2),n/2]],r.vertical)).addClass("highcharts-scrollbar-arrow").add(i[e]);this.chart.styledMode||a.attr({fill:r.buttonArrowColor})}}init(e,t,i){this.scrollbarButtons=[],this.renderer=e,this.userOptions=t,this.options=d(r,o.scrollbar,t),this.options.margin=p(this.options.margin,10),this.chart=i,this.size=p(this.options.size,this.options.height),t.enabled&&(this.render(),this.addEvents())}mouseDownHandler(e){let t=this.chart.pointer?.normalize(e)||e,i=this.cursorToScrollbarPosition(t);this.chartX=i.chartX,this.chartY=i.chartY,this.initPositions=[this.from,this.to],this.grabbedCenter=!0}mouseMoveHandler(e){let t,i=this.chart.pointer?.normalize(e)||e,r=this.options.vertical?"chartY":"chartX",n=this.initPositions||[];this.grabbedCenter&&(!e.touches||0!==e.touches[0][r])&&(t=this.cursorToScrollbarPosition(i)[r]-this[r],this.hasDragged=!0,this.updatePosition(n[0]+t,n[1]+t),this.hasDragged&&h(this,"changed",{from:this.from,to:this.to,trigger:"scrollbar",DOMType:e.type,DOMEvent:e}))}mouseUpHandler(e){this.hasDragged&&h(this,"changed",{from:this.from,to:this.to,trigger:"scrollbar",DOMType:e.type,DOMEvent:e}),this.grabbedCenter=this.hasDragged=this.chartX=this.chartY=null}position(e,t,i,r){let{buttonsEnabled:n,margin:o=0,vertical:s}=this.options,a=this.rendered?"animate":"attr",l=r,c=0;this.group.show(),this.x=e,this.y=t+this.trackBorderWidth,this.width=i,this.height=r,this.xOffset=l,this.yOffset=c,s?(this.width=this.yOffset=i=c=this.size,this.xOffset=l=0,this.yOffset=c=n?this.size:0,this.barWidth=r-(n?2*i:0),this.x=e+=o):(this.height=r=this.size,this.xOffset=l=n?this.size:0,this.barWidth=i-(n?2*r:0),this.y=this.y+o),this.group[a]({translateX:e,translateY:this.y}),this.track[a]({width:i,height:r}),this.scrollbarButtons[1][a]({translateX:s?0:i-l,translateY:s?r-c:0})}removeEvents(){this._events.forEach((function(e){f.apply(null,e)})),this._events.length=0}render(){let e=this.renderer,t=this.options,i=this.size,r=this.chart.styledMode,n=e.g("scrollbar").attr({zIndex:t.zIndex}).hide().add();this.group=n,this.track=e.rect().addClass("highcharts-scrollbar-track").attr({r:t.trackBorderRadius||0,height:i,width:i}).add(n),r||this.track.attr({fill:t.trackBackgroundColor,stroke:t.trackBorderColor,"stroke-width":t.trackBorderWidth});let o=this.trackBorderWidth=this.track.strokeWidth();this.track.attr({x:-l(0,o),y:-l(0,o)}),this.scrollbarGroup=e.g().add(n),this.scrollbar=e.rect().addClass("highcharts-scrollbar-thumb").attr({height:i-o,width:i-o,r:t.barBorderRadius||0}).add(this.scrollbarGroup),this.scrollbarRifles=e.path(m.swapXY([["M",-3,i/4],["L",-3,2*i/3],["M",0,i/4],["L",0,2*i/3],["M",3,i/4],["L",3,2*i/3]],t.vertical)).addClass("highcharts-scrollbar-rifles").add(this.scrollbarGroup),r||(this.scrollbar.attr({fill:t.barBackgroundColor,stroke:t.barBorderColor,"stroke-width":t.barBorderWidth}),this.scrollbarRifles.attr({stroke:t.rifleColor,"stroke-width":1})),this.scrollbarStrokeWidth=this.scrollbar.strokeWidth(),this.scrollbarGroup.translate(-l(0,this.scrollbarStrokeWidth),-l(0,this.scrollbarStrokeWidth)),this.drawScrollbarButton(0),this.drawScrollbarButton(1)}setRange(e,t){let i,r,n=this.options,o=n.vertical,s=n.minWidth,l=this.barWidth,u=!this.rendered||this.hasDragged||this.chart.navigator&&this.chart.navigator.hasDragged?"attr":"animate";if(!c(l))return;let h=l*Math.min(t,1);i=Math.ceil(l*(e=Math.max(e,0))),this.calculatedWidth=r=a(h-i),r<s&&(i=(l-s+r)*e,r=s);let d=Math.floor(i+this.xOffset+this.yOffset),p=r/2-.5;this.from=e,this.to=t,o?(this.scrollbarGroup[u]({translateY:d}),this.scrollbar[u]({height:r}),this.scrollbarRifles[u]({translateY:p}),this.scrollbarTop=d,this.scrollbarLeft=0):(this.scrollbarGroup[u]({translateX:d}),this.scrollbar[u]({width:r}),this.scrollbarRifles[u]({translateX:p}),this.scrollbarLeft=d,this.scrollbarTop=0),r<=12?this.scrollbarRifles.hide():this.scrollbarRifles.show(),!1===n.showFull&&(e<=0&&t>=1?this.group.hide():this.group.show()),this.rendered=!0}shouldUpdateExtremes(e){return p(this.options.liveRedraw,t.svg&&!t.isTouchDevice&&!this.chart.boosted)||"mouseup"===e||"touchend"===e||!c(e)}trackClick(e){let t=this.chart.pointer?.normalize(e)||e,i=this.to-this.from,r=this.y+this.scrollbarTop,n=this.x+this.scrollbarLeft;this.options.vertical&&t.chartY>r||!this.options.vertical&&t.chartX>n?this.updatePosition(this.from+i,this.to+i):this.updatePosition(this.from-i,this.to-i),h(this,"changed",{from:this.from,to:this.to,trigger:"scrollbar",DOMEvent:e})}update(e){this.destroy(),this.init(this.chart.renderer,d(!0,this.options,e),this.chart)}updatePosition(e,t){t>1&&(e=a(1-a(t-e)),t=1),e<0&&(t=a(t-e),e=0),this.from=e,this.to=t}}return m.defaultOptions=r,o.scrollbar=d(!0,m.defaultOptions,o.scrollbar),m})),i(t,"Stock/Navigator/Navigator.js",[t["Core/Axis/Axis.js"],t["Stock/Navigator/ChartNavigatorComposition.js"],t["Core/Defaults.js"],t["Core/Globals.js"],t["Core/Axis/NavigatorAxisComposition.js"],t["Stock/Navigator/NavigatorComposition.js"],t["Stock/Scrollbar/Scrollbar.js"],t["Core/Renderer/SVG/SVGRenderer.js"],t["Core/Utilities.js"]],(function(e,t,i,r,n,o,s,a,l){let{defaultOptions:c}=i,{isTouchDevice:u}=r,{prototype:{symbols:h}}=a,{addEvent:d,clamp:p,correctFloat:f,defined:m,destroyObjectProperties:g,erase:y,extend:_,find:v,fireEvent:x,isArray:b,isNumber:w,merge:S,pick:T,removeEvent:M,splat:A}=l;function C(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];let n=[].filter.call(i,w);if(n.length)return Math[e].apply(0,n)}class E{static compose(e,i,r){t.compose(e,E),o.compose(e,i,r)}constructor(e){this.isDirty=!1,this.scrollbarHeight=0,this.init(e)}drawHandle(e,t,i,r){let n=this.navigatorOptions.handles.height;this.handles[t][r](i?{translateX:Math.round(this.left+this.height/2),translateY:Math.round(this.top+parseInt(e,10)+.5-n)}:{translateX:Math.round(this.left+parseInt(e,10)),translateY:Math.round(this.top+this.height/2-n/2-1)})}drawOutline(e,t,i,r){let n,o,s=this.navigatorOptions.maskInside,a=this.outline.strokeWidth(),l=a/2,c=a%2/2,u=this.scrollButtonSize,h=this.size,d=this.top,p=this.height,f=d-l,m=d+p,g=this.left;i?(n=d+t+c,o=[["M",g+p,d-u-c],["L",g+p,n],["L",g,n],["M",g,t=d+e+c],["L",g+p,t],["L",g+p,d+h+u]],s&&o.push(["M",g+p,n-l],["L",g+p,t+l])):(g-=u,o=[["M",g,f],["L",e+=g+u-c,f],["L",e,m],["M",t+=g+u-c,m],["L",t,f],["L",g+h+2*u,f]],s&&o.push(["M",e-l,f],["L",t+l,f])),this.outline[r]({d:o})}drawMasks(e,t,i,r){let n,o,s,a,l=this.left,c=this.top,u=this.height;i?(s=[l,l,l],a=[c,c+e,c+t],o=[u,u,u],n=[e,t-e,this.size-t]):(s=[l,l+e,l+t],a=[c,c,c],o=[e,t-e,this.size-t],n=[u,u,u]),this.shades.forEach(((e,t)=>{e[r]({x:s[t],y:a[t],width:o[t],height:n[t]})}))}renderElements(){let e=this,t=e.navigatorOptions,i=t.maskInside,r=e.chart,n=r.inverted,o=r.renderer,s={cursor:n?"ns-resize":"ew-resize"},a=e.navigatorGroup??(e.navigatorGroup=o.g("navigator").attr({zIndex:8,visibility:"hidden"}).add());if([!i,i,!i].forEach(((i,n)=>{let l=e.shades[n]??(e.shades[n]=o.rect().addClass("highcharts-navigator-mask"+(1===n?"-inside":"-outside")).add(a));r.styledMode||(l.attr({fill:i?t.maskFill:"rgba(0,0,0,0)"}),1===n&&l.css(s))})),e.outline||(e.outline=o.path().addClass("highcharts-navigator-outline").add(a)),r.styledMode||e.outline.attr({"stroke-width":t.outlineWidth,stroke:t.outlineColor}),t.handles?.enabled){let i=t.handles,{height:n,width:l}=i;[0,1].forEach((t=>{let c=i.symbols[t];if(e.handles[t]&&e.handles[t].symbolUrl===c){if(!e.handles[t].isImg&&e.handles[t].symbolName!==c){let i=h[c].call(h,-l/2-1,0,l,n);e.handles[t].attr({d:i}),e.handles[t].symbolName=c}}else e.handles[t]?.destroy(),e.handles[t]=o.symbol(c,-l/2-1,0,l,n,i),e.handles[t].attr({zIndex:7-t}).addClass("highcharts-navigator-handle highcharts-navigator-handle-"+["left","right"][t]).add(a),e.addMouseEvents();r.inverted&&e.handles[t].attr({rotation:90,rotationOriginX:Math.floor(-l/2),rotationOriginY:(n+l)/2}),r.styledMode||e.handles[t].attr({fill:i.backgroundColor,stroke:i.borderColor,"stroke-width":i.lineWidth,width:i.width,height:i.height,x:-l/2-1,y:0}).css(s)}))}}update(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.chart,r=i.options.chart.inverted!==i.scrollbar?.options.vertical;if(S(!0,i.options.navigator,e),this.navigatorOptions=i.options.navigator||{},this.setOpposite(),m(e.enabled)||r)return this.destroy(),this.navigatorEnabled=e.enabled||this.navigatorEnabled,this.init(i);if(this.navigatorEnabled&&(this.isDirty=!0,!1===e.adaptToUpdatedData&&this.baseSeries.forEach((e=>{M(e,"updatedData",this.updatedDataHandler)}),this),e.adaptToUpdatedData&&this.baseSeries.forEach((e=>{e.eventsToUnbind.push(d(e,"updatedData",this.updatedDataHandler))}),this),(e.series||e.baseSeries)&&this.setBaseSeries(void 0,!1),e.height||e.xAxis||e.yAxis)){this.height=e.height??this.height;let t=this.getXAxisOffsets();this.xAxis.update({...e.xAxis,offsets:t,[i.inverted?"width":"height"]:this.height,[i.inverted?"height":"width"]:void 0},!1),this.yAxis.update({...e.yAxis,[i.inverted?"width":"height"]:this.height},!1)}t&&i.redraw()}render(e,t,i,r){let n,o,s,a,l,c=this.chart,u=this.xAxis,h=u.pointRange||0,d=u.navigatorAxis.fake?c.xAxis[0]:u,g=this.navigatorEnabled,y=this.rendered,_=c.inverted,v=c.xAxis[0].minRange,b=c.xAxis[0].options.maxRange,S=this.scrollButtonSize,M=this.scrollbarHeight;if(this.hasDragged&&!m(i))return;if(this.isDirty&&this.renderElements(),e=f(e-h/2),t=f(t+h/2),!w(e)||!w(t)){if(!y)return;i=0,r=T(u.width,d.width)}this.left=T(u.left,c.plotLeft+S+(_?c.plotWidth:0));let A=this.size=a=T(u.len,(_?c.plotHeight:c.plotWidth)-2*S);n=_?M:a+2*S,i=T(i,u.toPixels(e,!0)),r=T(r,u.toPixels(t,!0)),w(i)&&Math.abs(i)!==1/0||(i=0,r=n);let C=u.toValue(i,!0),E=u.toValue(r,!0),P=Math.abs(f(E-C));P<v?this.grabbedLeft?i=u.toPixels(E-v-h,!0):this.grabbedRight&&(r=u.toPixels(C+v+h,!0)):m(b)&&f(P-h)>b&&(this.grabbedLeft?i=u.toPixels(E-b-h,!0):this.grabbedRight&&(r=u.toPixels(C+b+h,!0))),this.zoomedMax=p(Math.max(i,r),0,A),this.zoomedMin=p(this.fixedWidth?this.zoomedMax-this.fixedWidth:Math.min(i,r),0,A),this.range=this.zoomedMax-this.zoomedMin,A=Math.round(this.zoomedMax);let k=Math.round(this.zoomedMin);g&&(this.navigatorGroup.attr({visibility:"inherit"}),l=y&&!this.hasDragged?"animate":"attr",this.drawMasks(k,A,_,l),this.drawOutline(k,A,_,l),this.navigatorOptions.handles.enabled&&(this.drawHandle(k,0,_,l),this.drawHandle(A,1,_,l))),this.scrollbar&&(_?(s=this.top-S,o=this.left-M+(g||!d.opposite?0:(d.titleOffset||0)+d.axisTitleMargin),M=a+2*S):(s=this.top+(g?this.height:-M),o=this.left-S),this.scrollbar.position(o,s,n,M),this.scrollbar.setRange(this.zoomedMin/(a||1),this.zoomedMax/(a||1))),this.rendered=!0,this.isDirty=!1,x(this,"afterRender")}addMouseEvents(){let e,t,i=this,r=i.chart,n=r.container,o=[];i.mouseMoveHandler=e=function(e){i.onMouseMove(e)},i.mouseUpHandler=t=function(e){i.onMouseUp(e)},(o=i.getPartsEvents("mousedown")).push(d(r.renderTo,"mousemove",e),d(n.ownerDocument,"mouseup",t),d(r.renderTo,"touchmove",e),d(n.ownerDocument,"touchend",t)),o.concat(i.getPartsEvents("touchstart")),i.eventsToUnbind=o,i.series&&i.series[0]&&o.push(d(i.series[0].xAxis,"foundExtremes",(function(){r.navigator.modifyNavigatorAxisExtremes()})))}getPartsEvents(e){let t=this,i=[];return["shades","handles"].forEach((function(r){t[r].forEach((function(n,o){i.push(d(n.element,e,(function(e){t[r+"Mousedown"](e,o)})))}))})),i}shadesMousedown(e,t){e=this.chart.pointer?.normalize(e)||e;let i,r,n,o,s=this.chart,a=this.xAxis,l=this.zoomedMin,c=this.size,u=this.range,h=this.left,d=e.chartX;s.inverted&&(d=e.chartY,h=this.top),1===t?(this.grabbedCenter=d,this.fixedWidth=u,this.dragOffset=d-l):(o=d-h-u/2,0===t?o=Math.max(0,o):2===t&&o+u>=c&&(o=c-u,this.reversedExtremes?(o-=u,r=this.getUnionExtremes().dataMin):i=this.getUnionExtremes().dataMax),o!==l&&(this.fixedWidth=u,m((n=a.navigatorAxis.toFixedRange(o,o+u,r,i)).min)&&x(this,"setRange",{min:Math.min(n.min,n.max),max:Math.max(n.min,n.max),redraw:!0,eventArguments:{trigger:"navigator"}})))}handlesMousedown(e,t){e=this.chart.pointer?.normalize(e)||e;let i=this.chart,r=i.xAxis[0],n=this.reversedExtremes;0===t?(this.grabbedLeft=!0,this.otherHandlePos=this.zoomedMax,this.fixedExtreme=n?r.min:r.max):(this.grabbedRight=!0,this.otherHandlePos=this.zoomedMin,this.fixedExtreme=n?r.max:r.min),i.setFixedRange(void 0)}onMouseMove(e){let t,i=this,r=i.chart,n=i.navigatorSize,o=i.range,s=i.dragOffset,a=r.inverted,l=i.left;(!e.touches||0!==e.touches[0].pageX)&&(t=(e=r.pointer?.normalize(e)||e).chartX,a&&(l=i.top,t=e.chartY),i.grabbedLeft?(i.hasDragged=!0,i.render(0,0,t-l,i.otherHandlePos)):i.grabbedRight?(i.hasDragged=!0,i.render(0,0,i.otherHandlePos,t-l)):i.grabbedCenter&&(i.hasDragged=!0,t<s?t=s:t>n+s-o&&(t=n+s-o),i.render(0,0,t-s,t-s+o)),i.hasDragged&&i.scrollbar&&T(i.scrollbar.options.liveRedraw,!u&&!this.chart.boosted)&&(e.DOMType=e.type,setTimeout((function(){i.onMouseUp(e)}),0)))}onMouseUp(e){let t,i,r,n,o,s,a=this.chart,l=this.xAxis,c=this.scrollbar,u=e.DOMEvent||e,h=a.inverted,d=this.rendered&&!this.hasDragged?"animate":"attr";(this.hasDragged&&(!c||!c.hasDragged)||"scrollbar"===e.trigger)&&(r=this.getUnionExtremes(),this.zoomedMin===this.otherHandlePos?n=this.fixedExtreme:this.zoomedMax===this.otherHandlePos&&(o=this.fixedExtreme),this.zoomedMax===this.size&&(o=this.reversedExtremes?r.dataMin:r.dataMax),0===this.zoomedMin&&(n=this.reversedExtremes?r.dataMax:r.dataMin),m((s=l.navigatorAxis.toFixedRange(this.zoomedMin,this.zoomedMax,n,o)).min)&&x(this,"setRange",{min:Math.min(s.min,s.max),max:Math.max(s.min,s.max),redraw:!0,animation:!this.hasDragged&&null,eventArguments:{trigger:"navigator",triggerOp:"navigator-drag",DOMEvent:u}})),"mousemove"!==e.DOMType&&"touchmove"!==e.DOMType&&(this.grabbedLeft=this.grabbedRight=this.grabbedCenter=this.fixedWidth=this.fixedExtreme=this.otherHandlePos=this.hasDragged=this.dragOffset=null),this.navigatorEnabled&&w(this.zoomedMin)&&w(this.zoomedMax)&&(i=Math.round(this.zoomedMin),t=Math.round(this.zoomedMax),this.shades&&this.drawMasks(i,t,h,d),this.outline&&this.drawOutline(i,t,h,d),this.navigatorOptions.handles.enabled&&Object.keys(this.handles).length===this.handles.length&&(this.drawHandle(i,0,h,d),this.drawHandle(t,1,h,d)))}removeEvents(){this.eventsToUnbind&&(this.eventsToUnbind.forEach((function(e){e()})),this.eventsToUnbind=void 0),this.removeBaseSeriesEvents()}removeBaseSeriesEvents(){let e=this.baseSeries||[];this.navigatorEnabled&&e[0]&&(!1!==this.navigatorOptions.adaptToUpdatedData&&e.forEach((function(e){M(e,"updatedData",this.updatedDataHandler)}),this),e[0].xAxis&&M(e[0].xAxis,"foundExtremes",this.modifyBaseAxisExtremes))}getXAxisOffsets(){return this.chart.inverted?[this.scrollButtonSize,0,-this.scrollButtonSize,0]:[0,-this.scrollButtonSize,0,this.scrollButtonSize]}init(t){let i=t.options,r=i.navigator||{},o=r.enabled,a=i.scrollbar||{},l=a.enabled,c=o&&r.height||0,u=l&&a.height||0,h=a.buttonsEnabled&&u||0;this.handles=[],this.shades=[],this.chart=t,this.setBaseSeries(),this.height=c,this.scrollbarHeight=u,this.scrollButtonSize=h,this.scrollbarEnabled=l,this.navigatorEnabled=o,this.navigatorOptions=r,this.scrollbarOptions=a,this.setOpposite();let p=this,f=p.baseSeries,m=t.xAxis.length,g=t.yAxis.length,y=f&&f[0]&&f[0].xAxis||t.xAxis[0]||{options:{}};if(t.isDirtyBox=!0,p.navigatorEnabled){let i=this.getXAxisOffsets();p.xAxis=new e(t,S({breaks:y.options.breaks,ordinal:y.options.ordinal,overscroll:y.options.overscroll},r.xAxis,{type:"datetime",yAxis:r.yAxis?.id,index:m,isInternal:!0,offset:0,keepOrdinalPadding:!0,startOnTick:!1,endOnTick:!1,minPadding:y.options.ordinal?0:y.options.minPadding,maxPadding:y.options.ordinal?0:y.options.maxPadding,zoomEnabled:!1},t.inverted?{offsets:i,width:c}:{offsets:i,height:c}),"xAxis"),p.yAxis=new e(t,S(r.yAxis,{alignTicks:!1,offset:0,index:g,isInternal:!0,reversed:T(r.yAxis&&r.yAxis.reversed,t.yAxis[0]&&t.yAxis[0].reversed,!1),zoomEnabled:!1},t.inverted?{width:c}:{height:c}),"yAxis"),f||r.series.data?p.updateNavigatorSeries(!1):0===t.series.length&&(p.unbindRedraw=d(t,"beforeRedraw",(function(){t.series.length>0&&!p.series&&(p.setBaseSeries(),p.unbindRedraw())}))),p.reversedExtremes=t.inverted&&!p.xAxis.reversed||!t.inverted&&p.xAxis.reversed,p.renderElements(),p.addMouseEvents()}else p.xAxis={chart:t,navigatorAxis:{fake:!0},translate:function(e,i){let r=t.xAxis[0],n=r.getExtremes(),o=r.len-2*h,s=C("min",r.options.min,n.dataMin),a=C("max",r.options.max,n.dataMax)-s;return i?e*a/o+s:o*(e-s)/a},toPixels:function(e){return this.translate(e)},toValue:function(e){return this.translate(e,!0)}},p.xAxis.navigatorAxis.axis=p.xAxis,p.xAxis.navigatorAxis.toFixedRange=n.prototype.toFixedRange.bind(p.xAxis.navigatorAxis);if(t.options.scrollbar.enabled){let e=S(t.options.scrollbar,{vertical:t.inverted});!w(e.margin)&&p.navigatorEnabled&&(e.margin=t.inverted?-3:3),t.scrollbar=p.scrollbar=new s(t.renderer,e,t),d(p.scrollbar,"changed",(function(e){let t=p.size,i=t*this.to,r=t*this.from;p.hasDragged=p.scrollbar.hasDragged,p.render(0,0,r,i),this.shouldUpdateExtremes(e.DOMType)&&setTimeout((function(){p.onMouseUp(e)}))}))}p.addBaseSeriesEvents(),p.addChartEvents()}setOpposite(){let e=this.navigatorOptions,t=this.navigatorEnabled,i=this.chart;this.opposite=T(e.opposite,!(t||!i.inverted))}getUnionExtremes(e){let t,i=this.chart.xAxis[0],r=this.xAxis,n=r.options,o=i.options;return e&&null===i.dataMin||(t={dataMin:T(n&&n.min,C("min",o.min,i.dataMin,r.dataMin,r.min)),dataMax:T(n&&n.max,C("max",o.max,i.dataMax,r.dataMax,r.max))}),t}setBaseSeries(e,t){let i=this.chart,r=this.baseSeries=[];e=e||i.options&&i.options.navigator.baseSeries||(i.series.length?v(i.series,(e=>!e.options.isInternal)).index:0),(i.series||[]).forEach(((t,i)=>{!t.options.isInternal&&(t.options.showInNavigator||(i===e||t.options.id===e)&&!1!==t.options.showInNavigator)&&r.push(t)})),this.xAxis&&!this.xAxis.navigatorAxis.fake&&this.updateNavigatorSeries(!0,t)}updateNavigatorSeries(e,t){let i,r,n,o=this,s=o.chart,a=o.baseSeries,l={enableMouseTracking:!1,index:null,linkedTo:null,group:"nav",padXAxis:!1,xAxis:this.navigatorOptions.xAxis?.id,yAxis:this.navigatorOptions.yAxis?.id,showInLegend:!1,stacking:void 0,isInternal:!0,states:{inactive:{opacity:1}}},u=o.series=(o.series||[]).filter((e=>{let t=e.baseSeries;return!(0>a.indexOf(t))||(t&&(M(t,"updatedData",o.updatedDataHandler),delete t.navigatorSeries),e.chart&&e.destroy(),!1)})),h=o.navigatorOptions.series;a&&a.length&&a.forEach((e=>{let d=e.navigatorSeries,p=_({color:e.color,visible:e.visible},b(h)?c.navigator.series:h);if(d&&!1===o.navigatorOptions.adaptToUpdatedData)return;l.name="Navigator "+a.length,n=(i=e.options||{}).navigatorOptions||{},p.dataLabels=A(p.dataLabels),(r=S(i,l,p,n)).pointRange=T(p.pointRange,n.pointRange,c.plotOptions[r.type||"line"].pointRange);let f=n.data||p.data;o.hasNavigatorData=o.hasNavigatorData||!!f,r.data=f||i.data&&i.data.slice(0),d&&d.options?d.update(r,t):(e.navigatorSeries=s.initSeries(r),s.setSortedData(),e.navigatorSeries.baseSeries=e,u.push(e.navigatorSeries))})),(h.data&&!(a&&a.length)||b(h))&&(o.hasNavigatorData=!1,(h=A(h)).forEach(((e,t)=>{l.name="Navigator "+(u.length+1),(r=S(c.navigator.series,{color:s.series[t]&&!s.series[t].options.isInternal&&s.series[t].color||s.options.colors[t]||s.options.colors[0]},l,e)).data=e.data,r.data&&(o.hasNavigatorData=!0,u.push(s.initSeries(r)))}))),e&&this.addBaseSeriesEvents()}addBaseSeriesEvents(){let e=this,t=e.baseSeries||[];t[0]&&t[0].xAxis&&t[0].eventsToUnbind.push(d(t[0].xAxis,"foundExtremes",this.modifyBaseAxisExtremes)),t.forEach((i=>{i.eventsToUnbind.push(d(i,"show",(function(){this.navigatorSeries&&this.navigatorSeries.setVisible(!0,!1)}))),i.eventsToUnbind.push(d(i,"hide",(function(){this.navigatorSeries&&this.navigatorSeries.setVisible(!1,!1)}))),!1!==this.navigatorOptions.adaptToUpdatedData&&i.xAxis&&i.eventsToUnbind.push(d(i,"updatedData",this.updatedDataHandler)),i.eventsToUnbind.push(d(i,"remove",(function(){t&&y(t,i),this.navigatorSeries&&(y(e.series,this.navigatorSeries),m(this.navigatorSeries.options)&&this.navigatorSeries.remove(!1),delete this.navigatorSeries)})))}))}getBaseSeriesMin(e){return this.baseSeries.reduce((function(e,t){return Math.min(e,t.xData&&t.xData.length?t.xData[0]:e)}),e)}modifyNavigatorAxisExtremes(){let e=this.xAxis;if(void 0!==e.getExtremes){let t=this.getUnionExtremes(!0);t&&(t.dataMin!==e.min||t.dataMax!==e.max)&&(e.min=t.dataMin,e.max=t.dataMax)}}modifyBaseAxisExtremes(){let e,t,i=this.chart.navigator,r=this.getExtremes(),n=r.min,o=r.max,s=r.dataMin,a=r.dataMax,l=o-n,c=i.stickToMin,u=i.stickToMax,h=T(this.ordinal?.convertOverscroll(this.options.overscroll),0),d=i.series&&i.series[0],p=!!this.setExtremes;!(this.eventArgs&&"rangeSelectorButton"===this.eventArgs.trigger)&&(c&&(e=(t=s)+l),u&&(e=a+h,c||(t=Math.max(s,e-l,i.getBaseSeriesMin(d&&d.xData?d.xData[0]:-Number.MAX_VALUE)))),p&&(c||u)&&w(t)&&(this.min=this.userMin=t,this.max=this.userMax=e)),i.stickToMin=i.stickToMax=null}updatedDataHandler(){let e=this.chart.navigator,t=this.navigatorSeries,i=e.reversedExtremes?0===Math.round(e.zoomedMin):Math.round(e.zoomedMax)>=Math.round(e.size);e.stickToMax=T(this.chart.options.navigator&&this.chart.options.navigator.stickToMax,i),e.stickToMin=e.shouldStickToMin(this,e),t&&!e.hasNavigatorData&&(t.options.pointStart=this.xData[0],t.setData(this.options.data,!1,null,!1))}shouldStickToMin(e,t){let i=t.getBaseSeriesMin(e.xData[0]),r=e.xAxis,n=r.max,o=r.min,s=r.options.range;return!(!w(n)||!w(o))&&(s&&n-i>0?n-i<s:o<=i)}addChartEvents(){this.eventsToUnbind||(this.eventsToUnbind=[]),this.eventsToUnbind.push(d(this.chart,"redraw",(function(){let e=this.navigator,t=e&&(e.baseSeries&&e.baseSeries[0]&&e.baseSeries[0].xAxis||this.xAxis[0]);t&&e.render(t.min,t.max)})),d(this.chart,"getMargins",(function(){let e=this.navigator,t=e.opposite?"plotTop":"marginBottom";this.inverted&&(t=e.opposite?"marginRight":"plotLeft"),this[t]=(this[t]||0)+(e.navigatorEnabled||!this.inverted?e.height+e.scrollbarHeight:0)+e.navigatorOptions.margin})),d(E,"setRange",(function(e){this.chart.xAxis[0].setExtremes(e.min,e.max,e.redraw,e.animation,e.eventArguments)})))}destroy(){this.removeEvents(),this.xAxis&&(y(this.chart.xAxis,this.xAxis),y(this.chart.axes,this.xAxis)),this.yAxis&&(y(this.chart.yAxis,this.yAxis),y(this.chart.axes,this.yAxis)),(this.series||[]).forEach((e=>{e.destroy&&e.destroy()})),["series","xAxis","yAxis","shades","outline","scrollbarTrack","scrollbarRifles","scrollbarGroup","scrollbar","navigatorGroup","rendered"].forEach((e=>{this[e]&&this[e].destroy&&this[e].destroy(),this[e]=null})),[this.handles].forEach((e=>{g(e)})),this.navigatorEnabled=!1}}return E})),i(t,"Accessibility/Components/NavigatorComponent.js",[t["Accessibility/AccessibilityComponent.js"],t["Accessibility/Utils/Announcer.js"],t["Accessibility/KeyboardNavigationHandler.js"],t["Stock/Navigator/Navigator.js"],t["Core/Animation/AnimationUtilities.js"],t["Core/Templating.js"],t["Core/Utilities.js"],t["Accessibility/Utils/HTMLUtilities.js"],t["Accessibility/Utils/ChartUtilities.js"]],(function(e,t,i,r,n,o,s,a,l){let{animObject:c}=n,{format:u}=o,{clamp:h,pick:d,syncTimeout:p}=s,{getFakeMouseEvent:f}=a,{getAxisRangeDescription:m,fireEventOnWrappedOrUnwrappedElement:g}=l;return class extends e{init(){let e=this.chart,i=this;this.announcer=new t(e,"polite"),this.addEvent(r,"afterRender",(function(){this.chart===i.chart&&this.chart.renderer&&p((()=>{i.proxyProvider.updateGroupProxyElementPositions("navigator"),i.updateHandleValues()}),c(d(this.chart.renderer.globalAnimation,!0)).duration)}))}onChartUpdate(){let e=this.chart,t=e.options,i=t.navigator;if(i.enabled&&i.accessibility?.enabled){let i=t.accessibility.landmarkVerbosity,r=t.lang.accessibility?.navigator.groupLabel;this.proxyProvider.removeGroup("navigator"),this.proxyProvider.addGroup("navigator","div",{role:"all"===i?"region":"group","aria-label":u(r,{chart:e},e)});let n=t.lang.accessibility?.navigator.handleLabel;[0,1].forEach((t=>{let i=this.getHandleByIx(t);if(i){let r=this.proxyProvider.addProxyElement("navigator",{click:i},"input",{type:"range","aria-label":u(n,{handleIx:t,chart:e},e)});this[t?"maxHandleProxy":"minHandleProxy"]=r.innerElement,r.innerElement.style.pointerEvents="none",r.innerElement.oninput=()=>this.updateNavigator()}})),this.updateHandleValues()}else this.proxyProvider.removeGroup("navigator")}getNavigatorHandleNavigation(e){let t=this,r=this.chart,n=e?this.maxHandleProxy:this.minHandleProxy,o=this.keyCodes;return new i(r,{keyCodeMap:[[[o.left,o.right,o.up,o.down],function(i){if(n){let s=i===o.left||i===o.up?-1:1;n.value=""+h(parseFloat(n.value)+s,0,100),t.updateNavigator((()=>{let i=t.getHandleByIx(e);i&&r.setFocusToElement(i,n)}))}return this.response.success}]],init:()=>{r.setFocusToElement(this.getHandleByIx(e),n)},validate:()=>!!(this.getHandleByIx(e)&&n&&r.options.navigator.accessibility?.enabled)})}getKeyboardNavigation(){return[this.getNavigatorHandleNavigation(0),this.getNavigatorHandleNavigation(1)]}destroy(){this.updateNavigatorThrottleTimer&&clearTimeout(this.updateNavigatorThrottleTimer),this.proxyProvider.removeGroup("navigator"),this.announcer&&this.announcer.destroy()}updateHandleValues(){let e=this.chart.navigator;if(e&&this.minHandleProxy&&this.maxHandleProxy){let t=e.size;this.minHandleProxy.value=""+Math.round(e.zoomedMin/t*100),this.maxHandleProxy.value=""+Math.round(e.zoomedMax/t*100)}}getHandleByIx(e){let t=this.chart.navigator;return t&&t.handles&&t.handles[e]}updateNavigator(e){this.updateNavigatorThrottleTimer&&clearTimeout(this.updateNavigatorThrottleTimer),this.updateNavigatorThrottleTimer=setTimeout((e=>{let t=this.chart,{navigator:i,pointer:r}=t;if(i&&r&&this.minHandleProxy&&this.maxHandleProxy){let n=r.getChartPosition(),o=parseFloat(this.minHandleProxy.value)/100*i.size,s=parseFloat(this.maxHandleProxy.value)/100*i.size;[[0,"mousedown",i.zoomedMin],[0,"mousemove",o],[0,"mouseup",o],[1,"mousedown",i.zoomedMax],[1,"mousemove",s],[1,"mouseup",s]].forEach((e=>{let[t,r,o]=e,s=this.getHandleByIx(t)?.element;s&&g(s,f(r,{x:n.left+i.left+o,y:n.top+i.top},s))})),e&&e();let a=t.options.lang.accessibility?.navigator.changeAnnouncement,l=m(t.xAxis[0]);this.announcer.announce(u(a,{axisRangeDescription:l,chart:t},t))}}).bind(this,e),20)}}})),i(t,"Accessibility/Components/SeriesComponent/SeriesDescriber.js",[t["Accessibility/Components/AnnotationsA11y.js"],t["Accessibility/Utils/ChartUtilities.js"],t["Core/Templating.js"],t["Accessibility/Utils/HTMLUtilities.js"],t["Core/Utilities.js"]],(function(e,t,i,r,n){let{getPointAnnotationTexts:o}=e,{getAxisDescription:s,getSeriesFirstPointElement:a,getSeriesA11yElement:l,unhideChartElementFromAT:c}=t,{format:u,numberFormat:h}=i,{reverseChildNodes:d,stripHTMLTagsFromString:p}=r,{find:f,isNumber:m,isString:g,pick:y,defined:_}=n;function v(e){let t=e.chart.options.accessibility.series.pointDescriptionEnabledThreshold;return!!(!1!==t&&e.points&&e.points.length>=+t)}function x(e,t){let i=e.series,r=i.chart,n=r.options.accessibility.point||{},o=i.options.accessibility&&i.options.accessibility.point||{},s=i.tooltipOptions||{},a=r.options.lang;return m(t)?h(t,o.valueDecimals||n.valueDecimals||s.valueDecimals||-1,a.decimalPoint,a.accessibility.thousandsSep||a.thousandsSep):t}function b(e,t){let i=e[t];return e.chart.langFormat("accessibility.series."+t+"Description",{name:s(i),series:e})}function w(e){let t=e.series,i=t.chart.series.length>1||t.options.name,r=function(e){let t=e.series,i=t.chart,r=t.options.accessibility,n=r&&r.point&&r.point.valueDescriptionFormat||i.options.accessibility.point.valueDescriptionFormat,o=y(t.xAxis&&t.xAxis.options.accessibility&&t.xAxis.options.accessibility.enabled,!i.angular&&"flowmap"!==t.type),s=o?function(e){let t=function(e){let t=e.series,i=t.chart,r=t.options.accessibility&&t.options.accessibility.point||{},n=i.options.accessibility.point||{},o=t.xAxis&&t.xAxis.dateTime;if(o){let t=o.getXDateFormat(e.x||0,i.options.tooltip.dateTimeLabelFormats),s=r.dateFormatter&&r.dateFormatter(e)||n.dateFormatter&&n.dateFormatter(e)||r.dateFormat||n.dateFormat||t;return i.time.dateFormat(s,e.x||0,void 0)}}(e),i=(e.series.xAxis||{}).categories&&_(e.category)&&(""+e.category).replace("<br/>"," "),r=_(e.id)&&0>(""+e.id).indexOf("highcharts-"),n="x, "+e.x;return e.name||t||i||(r?e.id:n)}(e):"";return u(n,{point:e,index:_(e.index)?e.index+1:"",xDescription:s,value:function(e){let t=e.series,i=t.chart.options.accessibility.point||{},r=t.chart.options.accessibility&&t.chart.options.accessibility.point||{},n=t.tooltipOptions||{},o=r.valuePrefix||i.valuePrefix||n.valuePrefix||"",s=r.valueSuffix||i.valueSuffix||n.valueSuffix||"",a=x(e,e[void 0!==e.value?"value":"y"]);return e.isNull?t.chart.langFormat("accessibility.series.nullPointValue",{point:e}):t.pointArrayMap?function(e,t,i){let r=t||"",n=i||"",o=function(t){let i=x(e,y(e[t],e.options[t]));return void 0!==i?t+": "+r+i+n:i};return e.series.pointArrayMap.reduce((function(e,t){let i=o(t);return i?e+(e.length?", ":"")+i:e}),"")}(e,o,s):o+a+s}(e),separator:o?", ":""},i)}(e),n=e.options&&e.options.accessibility&&e.options.accessibility.description,s=i?" "+t.name+".":"",a=function(e){let t=e.series.chart,i=o(e);return i.length?t.langFormat("accessibility.series.pointAnnotationsDescription",{point:e,annotations:i}):""}(e);return e.accessibility=e.accessibility||{},e.accessibility.valueDescription=r,r+(n?" "+n:"")+s+(a?" "+a:"")}function S(e){let t=e.chart,i=t.types||[],r=function(e){let t=(e.options.accessibility||{}).description;return t&&e.chart.langFormat("accessibility.series.description",{description:t,series:e})||""}(e),n=function(i){return t[i]&&t[i].length>1&&e[i]},o=e.index+1,s=b(e,"xAxis"),a=b(e,"yAxis"),l={seriesNumber:o,series:e,chart:t},c=i.length>1?"Combination":"",h=t.langFormat("accessibility.series.summary."+e.type+c,l)||t.langFormat("accessibility.series.summary.default"+c,l),d=(n("yAxis")?" "+a+".":"")+(n("xAxis")?" "+s+".":"");return u(y(e.options.accessibility&&e.options.accessibility.descriptionFormat,t.options.accessibility.series.descriptionFormat,""),{seriesDescription:h,authorDescription:r?" "+r:"",axisDescription:d,series:e,chart:t,seriesNumber:o},void 0)}return{defaultPointDescriptionFormatter:w,defaultSeriesDescriptionFormatter:S,describeSeries:function(e){let t=e.chart,i=a(e),r=l(e),n=t.is3d&&t.is3d();r&&(r.lastChild!==i||n||d(r),function(e){let t=function(e){let t=e.options.accessibility||{};return!v(e)&&!t.exposeAsGroupOnly}(e),i=function(e){let t=e.chart.options.accessibility.keyboardNavigation.seriesNavigation;return!(!e.points||!(e.points.length<+t.pointNavigationEnabledThreshold||!1===t.pointNavigationEnabledThreshold))}(e),r=e.chart.options.accessibility.point.describeNull;(t||i)&&e.points.forEach((i=>{let n=i.graphic&&i.graphic.element||function(e){let t=e.series,i=t&&t.chart,r=t&&t.is("sunburst"),n=e.isNull,o=i&&i.options.accessibility.point.describeNull;return n&&!r&&o}(i)&&function(e){let t=e.series,i=function(e){let t=e.index;return e.series&&e.series.data&&_(t)&&f(e.series.data,(function(e){return!!(e&&void 0!==e.index&&e.index>t&&e.graphic&&e.graphic.element)}))||null}(e),r=i&&i.graphic,n=r?r.parentGroup:t.graph||t.group,o=function(e,t){let i=e.series.chart.renderer.rect(t.x,t.y,1,1);return i.attr({class:"highcharts-a11y-mock-point",fill:"none",opacity:0,"fill-opacity":0,"stroke-opacity":0}),i}(e,i?{x:y(e.plotX,i.plotX,0),y:y(e.plotY,i.plotY,0)}:{x:y(e.plotX,0),y:y(e.plotY,0)});if(n&&n.element)return e.graphic=o,e.hasMockGraphic=!0,o.add(n),n.element.insertBefore(o.element,r?r.element:null),o.element}(i),o=i.options&&i.options.accessibility&&!1===i.options.accessibility.enabled;if(n){if(i.isNull&&!r)return void n.setAttribute("aria-hidden",!0);n.setAttribute("tabindex","-1"),e.chart.styledMode||(n.style.outline="none"),t&&!o?function(e,t){let i=e.series,r=i.options.accessibility?.point||{},n=i.chart.options.accessibility.point||{},o=p(g(r.descriptionFormat)&&u(r.descriptionFormat,e,i.chart)||r.descriptionFormatter?.(e)||g(n.descriptionFormat)&&u(n.descriptionFormat,e,i.chart)||n.descriptionFormatter?.(e)||w(e),i.chart.renderer.forExport);t.setAttribute("role","img"),t.setAttribute("aria-label",o)}(i,n):n.setAttribute("aria-hidden",!0)}}))}(e),c(t,r),function(e){let t=e.chart,i=t.options.chart,r=i.options3d&&i.options3d.enabled,n=t.series.length>1,o=t.options.accessibility.series.describeSingleSeries,s=(e.options.accessibility||{}).exposeAsGroupOnly;return!(r&&n)&&(n||o||s||v(e))}(e)?function(e,t){let i=e.options.accessibility||{},r=e.chart.options.accessibility,n=r.landmarkVerbosity;i.exposeAsGroupOnly?t.setAttribute("role","img"):"all"===n?t.setAttribute("role","region"):t.setAttribute("role","group"),t.setAttribute("tabindex","-1"),e.chart.styledMode||(t.style.outline="none"),t.setAttribute("aria-label",p(r.series.descriptionFormatter&&r.series.descriptionFormatter(e)||S(e),e.chart.renderer.forExport))}(e,r):r.removeAttribute("aria-label"))}}})),i(t,"Accessibility/Components/SeriesComponent/NewDataAnnouncer.js",[t["Core/Globals.js"],t["Core/Utilities.js"],t["Accessibility/Utils/Announcer.js"],t["Accessibility/Utils/ChartUtilities.js"],t["Accessibility/Utils/EventProvider.js"],t["Accessibility/Components/SeriesComponent/SeriesDescriber.js"]],(function(e,t,i,r,n,o){let{composed:s}=e,{addEvent:a,defined:l,pushUnique:c}=t,{getChartTitle:u}=r,{defaultPointDescriptionFormatter:h,defaultSeriesDescriptionFormatter:d}=o;function p(e){return!!e.options.accessibility.announceNewData.enabled}class f{constructor(e){this.dirty={allSeries:{}},this.lastAnnouncementTime=0,this.chart=e}init(){let e=this.chart,t=e.options.accessibility.announceNewData.interruptUser?"assertive":"polite";this.lastAnnouncementTime=0,this.dirty={allSeries:{}},this.eventProvider=new n,this.announcer=new i(e,t),this.addEventListeners()}destroy(){this.eventProvider.removeAddedEvents(),this.announcer.destroy()}addEventListeners(){let e=this,t=this.chart,i=this.eventProvider;i.addEvent(t,"afterApplyDrilldown",(function(){e.lastAnnouncementTime=0})),i.addEvent(t,"afterAddSeries",(function(t){e.onSeriesAdded(t.series)})),i.addEvent(t,"redraw",(function(){e.announceDirtyData()}))}onSeriesAdded(e){p(this.chart)&&(this.dirty.hasDirty=!0,this.dirty.allSeries[e.name+e.index]=e,this.dirty.newSeries=l(this.dirty.newSeries)?void 0:e)}announceDirtyData(){let e=this.chart,t=this;if(e.options.accessibility.announceNewData&&this.dirty.hasDirty){let e=this.dirty.newPoint;e&&(e=function(e){let t=e.series.data.filter((t=>e.x===t.x&&e.y===t.y));return 1===t.length?t[0]:e}(e)),this.queueAnnouncement(Object.keys(this.dirty.allSeries).map((e=>t.dirty.allSeries[e])),this.dirty.newSeries,e),this.dirty={allSeries:{}}}}queueAnnouncement(e,t,i){let r=this.chart.options.accessibility.announceNewData;if(r.enabled){let n=+new Date,o=n-this.lastAnnouncementTime,s=Math.max(0,r.minAnnounceInterval-o),a=function(e,t){let i=(e||[]).concat(t||[]).reduce(((e,t)=>(e[t.name+t.index]=t,e)),{});return Object.keys(i).map((e=>i[e]))}(this.queuedAnnouncement&&this.queuedAnnouncement.series,e),l=this.buildAnnouncementMessage(a,t,i);l&&(this.queuedAnnouncement&&clearTimeout(this.queuedAnnouncementTimer),this.queuedAnnouncement={time:n,message:l,series:a},this.queuedAnnouncementTimer=setTimeout((()=>{this&&this.announcer&&(this.lastAnnouncementTime=+new Date,this.announcer.announce(this.queuedAnnouncement.message),delete this.queuedAnnouncement,delete this.queuedAnnouncementTimer)}),s))}}buildAnnouncementMessage(t,i,r){let n=this.chart,o=n.options.accessibility.announceNewData;if(o.announcementFormatter){let e=o.announcementFormatter(t,i,r);if(!1!==e)return e.length?e:null}let s=e.charts&&e.charts.length>1?"Multiple":"Single",a=i?"newSeriesAnnounce"+s:r?"newPointAnnounce"+s:"newDataAnnounce",l=u(n);return n.langFormat("accessibility.announceNewData."+a,{chartTitle:l,seriesDesc:i?d(i):null,pointDesc:r?h(r):null,point:r,series:i})}}return function(e){function t(e){let t=this.chart,i=t.accessibility?.components.series.newDataAnnouncer;i&&i.chart===t&&p(t)&&(i.dirty.newPoint=l(i.dirty.newPoint)?void 0:e.point)}function i(){let e=this.chart,t=e.accessibility?.components.series.newDataAnnouncer;t&&t.chart===e&&p(e)&&(t.dirty.hasDirty=!0,t.dirty.allSeries[this.name+this.index]=this)}e.compose=function(e){c(s,"A11y.NDA")&&(a(e,"addPoint",t),a(e,"updatedData",i))}}(f||(f={})),f})),i(t,"Accessibility/ProxyElement.js",[t["Core/Globals.js"],t["Core/Utilities.js"],t["Accessibility/Utils/EventProvider.js"],t["Accessibility/Utils/ChartUtilities.js"],t["Accessibility/Utils/HTMLUtilities.js"]],(function(e,t,i,r,n){let{doc:o}=e,{attr:s,css:a,merge:l}=t,{fireEventOnWrappedOrUnwrappedElement:c}=r,{cloneMouseEvent:u,cloneTouchEvent:h,getFakeMouseEvent:d,removeElement:p}=n;return class{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"button",n=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;this.chart=e,this.target=t,this.eventProvider=new i;let a=this.innerElement=o.createElement(r),l=this.element=n?o.createElement(n):a;e.styledMode||this.hideElementVisually(a),n&&("li"!==n||e.styledMode||(l.style.listStyle="none"),l.appendChild(a),this.element=l),this.updateTarget(t,s)}click(){let e=this.getTargetPosition();e.x+=e.width/2,e.y+=e.height/2;let t=d("click",e);c(this.target.click,t)}updateTarget(e,t){this.target=e,this.updateCSSClassName();let i=t||{};Object.keys(i).forEach((e=>{null===i[e]&&delete i[e]}));let r=this.getTargetAttr(e.click,"aria-label");s(this.innerElement,l(r?{"aria-label":r}:{},i)),this.eventProvider.removeAddedEvents(),this.addProxyEventsToElement(this.innerElement,e.click),this.refreshPosition()}refreshPosition(){let e=this.getTargetPosition();a(this.innerElement,{width:(e.width||1)+"px",height:(e.height||1)+"px",left:(Math.round(e.x)||0)+"px",top:(Math.round(e.y)||0)+"px"})}remove(){this.eventProvider.removeAddedEvents(),p(this.element)}updateCSSClassName(){let e=e=>e.indexOf("highcharts-no-tooltip")>-1,t=this.chart.legend,i=t.group&&t.group.div,r=e(i&&i.className||""),n=e(this.getTargetAttr(this.target.click,"class")||"");this.innerElement.className=r||n?"highcharts-a11y-proxy-element highcharts-no-tooltip":"highcharts-a11y-proxy-element"}addProxyEventsToElement(e,t){["click","touchstart","touchend","touchcancel","touchmove","mouseover","mouseenter","mouseleave","mouseout"].forEach((i=>{let r=0===i.indexOf("touch");this.eventProvider.addEvent(e,i,(e=>{let i=r?h(e):u(e);t&&c(t,i),e.stopPropagation(),r||e.preventDefault()}),{passive:!1})}))}hideElementVisually(e){a(e,{borderWidth:0,backgroundColor:"transparent",cursor:"pointer",outline:"none",opacity:.001,filter:"alpha(opacity=1)",zIndex:999,overflow:"hidden",padding:0,margin:0,display:"block",position:"absolute","-ms-filter":"progid:DXImageTransform.Microsoft.Alpha(Opacity=1)"})}getTargetPosition(){let e=this.target.click,t=e.element?e.element:e,i=this.target.visual||t,r=this.chart.renderTo,n=this.chart.pointer;if(r&&i?.getBoundingClientRect&&n){let e=i.getBoundingClientRect(),t=n.getChartPosition();return{x:(e.left-t.left)/t.scaleX,y:(e.top-t.top)/t.scaleY,width:e.right/t.scaleX-e.left/t.scaleX,height:e.bottom/t.scaleY-e.top/t.scaleY}}return{x:0,y:0,width:1,height:1}}getTargetAttr(e,t){return e.element?e.element.getAttribute(t):e.getAttribute(t)}}})),i(t,"Accessibility/ProxyProvider.js",[t["Core/Globals.js"],t["Core/Utilities.js"],t["Accessibility/Utils/ChartUtilities.js"],t["Accessibility/Utils/DOMElementProvider.js"],t["Accessibility/Utils/HTMLUtilities.js"],t["Accessibility/ProxyElement.js"]],(function(e,t,i,r,n,o){let{doc:s}=e,{attr:a,css:l}=t,{unhideChartElementFromAT:c}=i,{removeChildNodes:u}=n;return class{constructor(e){this.chart=e,this.domElementProvider=new r,this.groups={},this.groupOrder=[],this.beforeChartProxyPosContainer=this.createProxyPosContainer("before"),this.afterChartProxyPosContainer=this.createProxyPosContainer("after"),this.update()}addProxyElement(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"button",r=arguments.length>3?arguments[3]:void 0,n=this.groups[e];if(!n)throw Error("ProxyProvider.addProxyElement: Invalid group key "+e);let s="ul"===n.type||"ol"===n.type?"li":void 0,a=new o(this.chart,t,i,s,r);return n.proxyContainerElement.appendChild(a.element),n.proxyElements.push(a),a}addGroup(e){let t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"div",r=arguments.length>2?arguments[2]:void 0,n=this.groups[e];if(n)return n.groupElement;let o=this.domElementProvider.createElement(i);return r&&r.role&&"div"!==i?(t=this.domElementProvider.createElement("div")).appendChild(o):t=o,t.className="highcharts-a11y-proxy-group highcharts-a11y-proxy-group-"+e.replace(/\W/g,"-"),this.groups[e]={proxyContainerElement:o,groupElement:t,type:i,proxyElements:[]},a(t,r||{}),"ul"===i&&o.setAttribute("role","list"),this.afterChartProxyPosContainer.appendChild(t),this.updateGroupOrder(this.groupOrder),t}updateGroupAttrs(e,t){let i=this.groups[e];if(!i)throw Error("ProxyProvider.updateGroupAttrs: Invalid group key "+e);a(i.groupElement,t)}updateGroupOrder(e){if(this.groupOrder=e.slice(),this.isDOMOrderGroupOrder())return;let t=e.indexOf("series"),i=t>-1?e.slice(0,t):e,r=t>-1?e.slice(t+1):[],n=s.activeElement;["before","after"].forEach((e=>{let t=this["before"===e?"beforeChartProxyPosContainer":"afterChartProxyPosContainer"];u(t),("before"===e?i:r).forEach((e=>{let i=this.groups[e];i&&t.appendChild(i.groupElement)}))})),(this.beforeChartProxyPosContainer.contains(n)||this.afterChartProxyPosContainer.contains(n))&&n&&n.focus&&n.focus()}clearGroup(e){let t=this.groups[e];if(!t)throw Error("ProxyProvider.clearGroup: Invalid group key "+e);u(t.proxyContainerElement)}removeGroup(e){let t=this.groups[e];t&&(this.domElementProvider.removeElement(t.groupElement),t.groupElement!==t.proxyContainerElement&&this.domElementProvider.removeElement(t.proxyContainerElement),delete this.groups[e])}update(){this.updatePosContainerPositions(),this.updateGroupOrder(this.groupOrder),this.updateProxyElementPositions()}updateProxyElementPositions(){Object.keys(this.groups).forEach(this.updateGroupProxyElementPositions.bind(this))}updateGroupProxyElementPositions(e){let t=this.groups[e];t&&t.proxyElements.forEach((e=>e.refreshPosition()))}destroy(){this.domElementProvider.destroyCreatedElements()}createProxyPosContainer(e){let t=this.domElementProvider.createElement("div");return t.setAttribute("aria-hidden","false"),t.className="highcharts-a11y-proxy-container"+(e?"-"+e:""),l(t,{top:"0",left:"0"}),this.chart.styledMode||(t.style.whiteSpace="nowrap",t.style.position="absolute"),t}getCurrentGroupOrderInDOM(){let e=e=>{let t=Object.keys(this.groups),i=t.length;for(;i--;){let r=t[i],n=this.groups[r];if(n&&e===n.groupElement)return r}},t=t=>{let i=[],r=t.children;for(let n=0;n<r.length;++n){let t=e(r[n]);t&&i.push(t)}return i},i=t(this.beforeChartProxyPosContainer),r=t(this.afterChartProxyPosContainer);return i.push("series"),i.concat(r)}isDOMOrderGroupOrder(){let e=this.getCurrentGroupOrderInDOM(),t=this.groupOrder.filter((e=>"series"===e||!!this.groups[e])),i=e.length;if(i!==t.length)return!1;for(;i--;)if(e[i]!==t[i])return!1;return!0}updatePosContainerPositions(){let e=this.chart;if(e.renderer.forExport)return;let t=e.renderer.box;e.container.insertBefore(this.afterChartProxyPosContainer,t.nextSibling),e.container.insertBefore(this.beforeChartProxyPosContainer,t),c(this.chart,this.afterChartProxyPosContainer),c(this.chart,this.beforeChartProxyPosContainer)}}})),i(t,"Accessibility/Components/RangeSelectorComponent.js",[t["Accessibility/AccessibilityComponent.js"],t["Accessibility/Utils/Announcer.js"],t["Accessibility/Utils/ChartUtilities.js"],t["Accessibility/KeyboardNavigationHandler.js"],t["Core/Utilities.js"]],(function(e,t,i,r,n){let{unhideChartElementFromAT:o,getAxisRangeDescription:s}=i,{addEvent:a,attr:l}=n;class c extends e{init(){let e=this.chart;this.announcer=new t(e,"polite")}onChartUpdate(){let e=this.chart,t=this,i=e.rangeSelector;i&&(this.updateSelectorVisibility(),this.setDropdownAttrs(),i.buttons&&i.buttons.length&&i.buttons.forEach((e=>{t.setRangeButtonAttrs(e)})),i.maxInput&&i.minInput&&["minInput","maxInput"].forEach((function(r,n){let s=i[r];s&&(o(e,s),t.setRangeInputAttrs(s,"accessibility.rangeSelector."+(n?"max":"min")+"InputLabel"))})))}updateSelectorVisibility(){let e=this.chart,t=e.rangeSelector,i=t&&t.dropdown,r=t&&t.buttons||[],n=e=>e.setAttribute("aria-hidden",!0);t&&t.hasVisibleDropdown&&i?(o(e,i),r.forEach((e=>n(e.element)))):(i&&n(i),r.forEach((t=>o(e,t.element))))}setDropdownAttrs(){let e=this.chart,t=e.rangeSelector&&e.rangeSelector.dropdown;if(t){let i=e.langFormat("accessibility.rangeSelector.dropdownLabel",{rangeTitle:e.options.lang.rangeSelectorZoom});t.setAttribute("aria-label",i),t.setAttribute("tabindex",-1)}}setRangeButtonAttrs(e){l(e.element,{tabindex:-1,role:"button"})}setRangeInputAttrs(e,t){let i=this.chart;l(e,{tabindex:-1,"aria-label":i.langFormat(t,{chart:i})})}onButtonNavKbdArrowKey(e,t){let i=e.response,r=this.keyCodes,n=this.chart,o=n.options.accessibility.keyboardNavigation.wrapAround,s=t===r.left||t===r.up?-1:1;return n.highlightRangeSelectorButton(n.highlightedRangeSelectorItemIx+s)?i.success:o?(e.init(s),i.success):i[s>0?"next":"prev"]}onButtonNavKbdClick(e){let t=e.response,i=this.chart;return 3!==i.oldRangeSelectorItemState&&this.fakeClickEvent(i.rangeSelector.buttons[i.highlightedRangeSelectorItemIx].element),t.success}onAfterBtnClick(){let e=this.chart,t=s(e.xAxis[0]),i=e.langFormat("accessibility.rangeSelector.clickButtonAnnouncement",{chart:e,axisRangeDescription:t});i&&this.announcer.announce(i)}onInputKbdMove(e){let t=this.chart,i=t.rangeSelector,r=t.highlightedInputRangeIx=(t.highlightedInputRangeIx||0)+e;if(r>1||r<0){if(t.accessibility)return t.accessibility.keyboardNavigation.exiting=!0,t.accessibility.keyboardNavigation.tabindexContainer.focus(),t.accessibility.keyboardNavigation.move(e)}else if(i){let e=i[r?"maxDateBox":"minDateBox"],n=i[r?"maxInput":"minInput"];e&&n&&t.setFocusToElement(e,n)}return!0}onInputNavInit(e){let t=this,i=this.chart,r=e>0?0:1,n=i.rangeSelector,o=n&&n[r?"maxDateBox":"minDateBox"],s=n&&n.minInput,l=n&&n.maxInput;if(i.highlightedInputRangeIx=r,o&&s&&l){i.setFocusToElement(o,r?l:s),this.removeInputKeydownHandler&&this.removeInputKeydownHandler();let e=e=>{(e.which||e.keyCode)===this.keyCodes.tab&&t.onInputKbdMove(e.shiftKey?-1:1)&&(e.preventDefault(),e.stopPropagation())},n=a(s,"keydown",e),c=a(l,"keydown",e);this.removeInputKeydownHandler=()=>{n(),c()}}}onInputNavTerminate(){let e=this.chart.rangeSelector||{};e.maxInput&&e.hideInput("max"),e.minInput&&e.hideInput("min"),this.removeInputKeydownHandler&&(this.removeInputKeydownHandler(),delete this.removeInputKeydownHandler)}initDropdownNav(){let e=this.chart,t=e.rangeSelector,i=t&&t.dropdown;t&&i&&(e.setFocusToElement(t.buttonGroup,i),this.removeDropdownKeydownHandler&&this.removeDropdownKeydownHandler(),this.removeDropdownKeydownHandler=a(i,"keydown",(t=>{let i=(t.which||t.keyCode)===this.keyCodes.tab,r=e.accessibility;i&&(t.preventDefault(),t.stopPropagation(),r&&(r.keyboardNavigation.tabindexContainer.focus(),r.keyboardNavigation.move(t.shiftKey?-1:1)))})))}getRangeSelectorButtonNavigation(){let e=this.chart,t=this.keyCodes,i=this;return new r(e,{keyCodeMap:[[[t.left,t.right,t.up,t.down],function(e){return i.onButtonNavKbdArrowKey(this,e)}],[[t.enter,t.space],function(){return i.onButtonNavKbdClick(this)}]],validate:function(){return!!(e.rangeSelector&&e.rangeSelector.buttons&&e.rangeSelector.buttons.length)},init:function(t){let r=e.rangeSelector;if(r&&r.hasVisibleDropdown)i.initDropdownNav();else if(r){let i=r.buttons.length-1;e.highlightRangeSelectorButton(t>0?0:i)}},terminate:function(){i.removeDropdownKeydownHandler&&(i.removeDropdownKeydownHandler(),delete i.removeDropdownKeydownHandler)}})}getRangeSelectorInputNavigation(){let e=this.chart,t=this;return new r(e,{keyCodeMap:[],validate:function(){return!!(e.rangeSelector&&e.rangeSelector.inputGroup&&"hidden"!==e.rangeSelector.inputGroup.element.style.visibility&&!1!==e.options.rangeSelector.inputEnabled&&e.rangeSelector.minInput&&e.rangeSelector.maxInput)},init:function(e){t.onInputNavInit(e)},terminate:function(){t.onInputNavTerminate()}})}getKeyboardNavigation(){return[this.getRangeSelectorButtonNavigation(),this.getRangeSelectorInputNavigation()]}destroy(){this.removeDropdownKeydownHandler&&this.removeDropdownKeydownHandler(),this.removeInputKeydownHandler&&this.removeInputKeydownHandler(),this.announcer&&this.announcer.destroy()}}return function(e){function t(e){let t=this.rangeSelector&&this.rangeSelector.buttons||[],i=this.highlightedRangeSelectorItemIx,r=this.rangeSelector&&this.rangeSelector.selected;return void 0!==i&&t[i]&&i!==r&&t[i].setState(this.oldRangeSelectorItemState||0),this.highlightedRangeSelectorItemIx=e,!!t[e]&&(this.setFocusToElement(t[e].box,t[e].element),e!==r&&(this.oldRangeSelectorItemState=t[e].state,t[e].setState(1)),!0)}function i(){let e=this.chart.accessibility;if(e&&e.components.rangeSelector)return e.components.rangeSelector.onAfterBtnClick()}e.compose=function(e,r){let n=e.prototype;n.highlightRangeSelectorButton||(n.highlightRangeSelectorButton=t,a(r,"afterBtnClick",i))}}(c||(c={})),c})),i(t,"Accessibility/Components/SeriesComponent/ForcedMarkers.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],(function(e,t){var i;let{composed:r}=e,{addEvent:n,merge:o,pushUnique:s}=t;return function(e){function t(e){o(!0,e,{marker:{enabled:!0,states:{normal:{opacity:0}}}})}function i(e){return e.marker.states&&e.marker.states.normal&&e.marker.states.normal.opacity}function a(e){return!!(e._hasPointMarkers&&e.points&&e.points.length)}function l(){this.chart.styledMode&&(this.markerGroup&&this.markerGroup[this.a11yMarkersForced?"addClass":"removeClass"]("highcharts-a11y-markers-hidden"),a(this)&&this.points.forEach((e=>{e.graphic&&(e.graphic[e.hasForcedA11yMarker?"addClass":"removeClass"]("highcharts-a11y-marker-hidden"),e.graphic[!1===e.hasForcedA11yMarker?"addClass":"removeClass"]("highcharts-a11y-marker-visible"))})))}function c(e){this.resetA11yMarkerOptions=o(e.options.marker||{},this.userOptions.marker||{})}function u(){let e=this.options;!function(e){let t=e.chart.options.accessibility.enabled,i=!1!==(e.options.accessibility&&e.options.accessibility.enabled);return t&&i&&function(e){let t=e.chart.options.accessibility;return e.points.length<t.series.pointDescriptionEnabledThreshold||!1===t.series.pointDescriptionEnabledThreshold}(e)}(this)?this.a11yMarkersForced&&(delete this.a11yMarkersForced,function(e){let t=e.resetA11yMarkerOptions;if(t){let i=t.states&&t.states.normal&&t.states.normal.opacity;e.userOptions&&e.userOptions.marker&&(e.userOptions.marker.enabled=!0),e.update({marker:{enabled:t.enabled,states:{normal:{opacity:i}}}})}}(this),delete this.resetA11yMarkerOptions):(e.marker&&!1===e.marker.enabled&&(this.a11yMarkersForced=!0,t(this.options)),a(this)&&function(e){let r=e.points.length;for(;r--;){let n=e.points[r],s=n.options,a=n.hasForcedA11yMarker;if(delete n.hasForcedA11yMarker,s.marker){let e=a&&0===i(s);s.marker.enabled&&!e?(o(!0,s.marker,{states:{normal:{opacity:i(s)||1}}}),n.hasForcedA11yMarker=!1):!1===s.marker.enabled&&(t(s),n.hasForcedA11yMarker=!0)}}}(this))}function h(){this.boosted&&this.a11yMarkersForced&&(o(!0,this.options,{marker:{enabled:!1}}),delete this.a11yMarkersForced)}e.compose=function(e){s(r,"A11y.FM")&&(n(e,"afterSetOptions",c),n(e,"render",u),n(e,"afterRender",l),n(e,"renderCanvas",h))}}(i||(i={})),i})),i(t,"Accessibility/Components/SeriesComponent/SeriesKeyboardNavigation.js",[t["Core/Series/Point.js"],t["Core/Series/Series.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Globals.js"],t["Core/Utilities.js"],t["Accessibility/KeyboardNavigationHandler.js"],t["Accessibility/Utils/EventProvider.js"],t["Accessibility/Utils/ChartUtilities.js"]],(function(e,t,i,r,n,o,s,a){let{seriesTypes:l}=i,{doc:c}=r,{defined:u,fireEvent:h}=n,{getPointFromXY:d,getSeriesFromName:p,scrollAxisToPoint:f}=a;function m(e){let t=e.index,i=e.series.points,r=i.length;if(i[t]===e)return t;for(;r--;)if(i[r]===e)return r}function g(e){let t=e.chart.options.accessibility.keyboardNavigation.seriesNavigation,i=e.options.accessibility||{},r=i.keyboardNavigation;return r&&!1===r.enabled||!1===i.enabled||!1===e.options.enableMouseTracking||!e.visible||t.pointNavigationEnabledThreshold&&+t.pointNavigationEnabledThreshold<=e.points.length}function y(e){let t=e.series.chart.options.accessibility,i=e.options.accessibility&&!1===e.options.accessibility.enabled;return e.isNull&&t.keyboardNavigation.seriesNavigation.skipNullPoints||!1===e.visible||!1===e.isInside||i||g(e.series)}function _(e){let t=e.series||[],i=t.length;for(let r=0;r<i;++r)if(!g(t[r])){let e=function(e){let t=e.points||[],i=t.length;for(let r=0;r<i;++r)if(!y(t[r]))return t[r];return null}(t[r]);if(e)return e}return null}function v(e){let t=e.series.length,i=!1;for(;t--&&(e.highlightedPoint=e.series[t].points[e.series[t].points.length-1],!(i=e.series[t].highlightNextValidPoint())););return i}function x(e){delete e.highlightedPoint;let t=_(e);return!!t&&t.highlight()}class b{constructor(e,t){this.keyCodes=t,this.chart=e}init(){let i=this,r=this.chart,n=this.eventProvider=new s;n.addEvent(t,"destroy",(function(){return i.onSeriesDestroy(this)})),n.addEvent(r,"afterApplyDrilldown",(function(){!function(e){let t=_(e);t&&t.highlight(!1)}(this)})),n.addEvent(r,"drilldown",(function(e){let t=e.point,r=t.series;i.lastDrilledDownPoint={x:t.x,y:t.y,seriesName:r?r.name:""}})),n.addEvent(r,"drillupall",(function(){setTimeout((function(){i.onDrillupAll()}),10)})),n.addEvent(e,"afterSetState",(function(){let e=this.graphic&&this.graphic.element,t=c.activeElement,i=t&&t.getAttribute("class"),n=i&&i.indexOf("highcharts-a11y-proxy-element")>-1;r.highlightedPoint===this&&t!==e&&!n&&e&&e.focus&&e.focus()}))}onDrillupAll(){let e,t=this.lastDrilledDownPoint,i=this.chart,r=t&&p(i,t.seriesName);t&&r&&u(t.x)&&u(t.y)&&(e=d(r,t.x,t.y)),e=e||_(i),i.container&&i.container.focus(),e&&e.highlight&&e.highlight(!1)}getKeyboardNavigationHandler(){let e=this,t=this.keyCodes,i=this.chart,r=i.inverted;return new o(i,{keyCodeMap:[[r?[t.up,t.down]:[t.left,t.right],function(t){return e.onKbdSideways(this,t)}],[r?[t.left,t.right]:[t.up,t.down],function(t){return e.onKbdVertical(this,t)}],[[t.enter,t.space],function(e,t){let r=i.highlightedPoint;if(r){let{plotLeft:e,plotTop:i}=this.chart,{plotX:n=0,plotY:o=0}=r;t={...t,chartX:e+n,chartY:i+o,point:r,target:r.graphic?.element||t.target},h(r.series,"click",t),r.firePointEvent("click",t)}return this.response.success}],[[t.home],function(){return x(i),this.response.success}],[[t.end],function(){return v(i),this.response.success}],[[t.pageDown,t.pageUp],function(e){return i.highlightAdjacentSeries(e===t.pageDown),this.response.success}]],init:function(){return e.onHandlerInit(this)},validate:function(){return!!_(i)},terminate:function(){return e.onHandlerTerminate()}})}onKbdSideways(e,t){let i=this.keyCodes,r=t===i.right||t===i.down;return this.attemptHighlightAdjacentPoint(e,r)}onHandlerInit(e){let t=this.chart;return t.options.accessibility.keyboardNavigation.seriesNavigation.rememberPointFocus&&t.highlightedPoint?t.highlightedPoint.highlight():x(t),e.response.success}onKbdVertical(e,t){let i=this.chart,r=this.keyCodes,n=t===r.down||t===r.right,o=i.options.accessibility.keyboardNavigation.seriesNavigation;return o.mode&&"serialize"===o.mode?this.attemptHighlightAdjacentPoint(e,n):(i[i.highlightedPoint&&i.highlightedPoint.series.keyboardMoveVertical?"highlightAdjacentPointVertical":"highlightAdjacentSeries"](n),e.response.success)}onHandlerTerminate(){let e=this.chart,t=e.options.accessibility.keyboardNavigation;e.tooltip&&e.tooltip.hide(0);let i=e.highlightedPoint&&e.highlightedPoint.series;i&&i.onMouseOut&&i.onMouseOut(),e.highlightedPoint&&e.highlightedPoint.onMouseOut&&e.highlightedPoint.onMouseOut(),t.seriesNavigation.rememberPointFocus||delete e.highlightedPoint}attemptHighlightAdjacentPoint(e,t){let i=this.chart,r=i.options.accessibility.keyboardNavigation.wrapAround;return i.highlightAdjacentPoint(t)||r&&(t?x(i):v(i))?e.response.success:e.response[t?"next":"prev"]}onSeriesDestroy(e){let t=this.chart;t.highlightedPoint&&t.highlightedPoint.series===e&&(delete t.highlightedPoint,t.focusElement&&t.focusElement.removeFocusBorder())}destroy(){this.eventProvider.removeAddedEvents()}}return function(e){function t(e){let t,i,r=this.series,n=this.highlightedPoint,o=n&&m(n)||0,s=n&&n.series.points||[],a=this.series&&this.series[this.series.length-1],l=a&&a.points&&a.points[a.points.length-1];if(!r[0]||!r[0].points)return!1;if(n){if(t=r[n.series.index+(e?1:-1)],(i=s[o+(e?1:-1)])||!t||(i=t.points[e?0:t.points.length-1]),!i)return!1}else i=e?r[0].points[0]:l;return y(i)?(g(t=i.series)?this.highlightedPoint=e?t.points[t.points.length-1]:t.points[0]:this.highlightedPoint=i,this.highlightAdjacentPoint(e)):i.highlight()}function i(e){let t,i=this.highlightedPoint,r=1/0;return!(!u(i.plotX)||!u(i.plotY))&&(this.series.forEach((n=>{g(n)||n.points.forEach((o=>{if(!u(o.plotY)||!u(o.plotX)||o===i)return;let s=o.plotY-i.plotY,a=Math.abs(o.plotX-i.plotX),l=Math.abs(s)*Math.abs(s)+a*a*4;n.yAxis&&n.yAxis.reversed&&(s*=-1),!(s<=0&&e||s>=0&&!e||l<5||y(o))&&l<r&&(r=l,t=o)}))})),!!t&&t.highlight())}function r(e){let t,i,r,n=this.highlightedPoint,o=this.series&&this.series[this.series.length-1],s=o&&o.points&&o.points[o.points.length-1];return this.highlightedPoint?!(!(t=this.series[n.series.index+(e?-1:1)])||!(i=function(e,t){let i,r,n,o=1/0,s=t.points.length,a=e=>!(u(e.plotX)&&u(e.plotY));if(!a(e)){for(;s--;)!a(i=t.points[s])&&(n=(e.plotX-i.plotX)*(e.plotX-i.plotX)*4+(e.plotY-i.plotY)*(e.plotY-i.plotY)*1)<o&&(o=n,r=s);return u(r)?t.points[r]:void 0}}(n,t)))&&(g(t)?(i.highlight(),(r=this.highlightAdjacentSeries(e))?r:(n.highlight(),!1)):(i.highlight(),i.series.highlightNextValidPoint())):(t=e?this.series&&this.series[0]:o,!!(i=e?t&&t.points&&t.points[0]:s)&&i.highlight())}function n(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.series.chart,i=t.tooltip?.label?.element;!this.isNull&&e?this.onMouseOver():t.tooltip&&t.tooltip.hide(0),f(this),this.graphic&&(t.setFocusToElement(this.graphic),!e&&t.focusElement&&t.focusElement.removeFocusBorder()),t.highlightedPoint=this;let r=i?.getBoundingClientRect().top;if(i&&r&&r<0){let e=window.scrollY;window.scrollTo({behavior:"smooth",top:e+r})}return this}function o(){let e=this.chart.highlightedPoint,t=(e&&e.series)===this?m(e):0,i=this.points,r=i.length;if(i&&r){for(let e=t;e<r;++e)if(!y(i[e]))return i[e].highlight();for(let e=t;e>=0;--e)if(!y(i[e]))return i[e].highlight()}return!1}e.compose=function(e,s,a){let c=e.prototype,u=s.prototype,h=a.prototype;c.highlightAdjacentPoint||(c.highlightAdjacentPoint=t,c.highlightAdjacentPointVertical=i,c.highlightAdjacentSeries=r,u.highlight=n,h.keyboardMoveVertical=!0,["column","gantt","pie"].forEach((e=>{l[e]&&(l[e].prototype.keyboardMoveVertical=!1)})),h.highlightNextValidPoint=o)}}(b||(b={})),b})),i(t,"Accessibility/Components/SeriesComponent/SeriesComponent.js",[t["Accessibility/AccessibilityComponent.js"],t["Accessibility/Utils/ChartUtilities.js"],t["Accessibility/Components/SeriesComponent/ForcedMarkers.js"],t["Accessibility/Components/SeriesComponent/NewDataAnnouncer.js"],t["Accessibility/Components/SeriesComponent/SeriesDescriber.js"],t["Accessibility/Components/SeriesComponent/SeriesKeyboardNavigation.js"]],(function(e,t,i,r,n,o){let{hideSeriesFromAT:s}=t,{describeSeries:a}=n;return class extends e{static compose(e,t,n){r.compose(n),i.compose(n),o.compose(e,t,n)}init(){this.newDataAnnouncer=new r(this.chart),this.newDataAnnouncer.init(),this.keyboardNavigation=new o(this.chart,this.keyCodes),this.keyboardNavigation.init(),this.hideTooltipFromATWhenShown(),this.hideSeriesLabelsFromATWhenShown()}hideTooltipFromATWhenShown(){let e=this;this.chart.tooltip&&this.addEvent(this.chart.tooltip.constructor,"refresh",(function(){this.chart===e.chart&&this.label&&this.label.element&&this.label.element.setAttribute("aria-hidden",!0)}))}hideSeriesLabelsFromATWhenShown(){this.addEvent(this.chart,"afterDrawSeriesLabels",(function(){this.series.forEach((function(e){e.labelBySeries&&e.labelBySeries.attr("aria-hidden",!0)}))}))}onChartRender(){this.chart.series.forEach((function(e){!1!==(e.options.accessibility&&e.options.accessibility.enabled)&&e.visible&&0!==e.getPointsCollection().length?a(e):s(e)}))}getKeyboardNavigation(){return this.keyboardNavigation.getKeyboardNavigationHandler()}destroy(){this.newDataAnnouncer.destroy(),this.keyboardNavigation.destroy()}}})),i(t,"Accessibility/Components/ZoomComponent.js",[t["Accessibility/AccessibilityComponent.js"],t["Accessibility/Utils/ChartUtilities.js"],t["Accessibility/Utils/HTMLUtilities.js"],t["Accessibility/KeyboardNavigationHandler.js"],t["Core/Utilities.js"]],(function(e,t,i,r,n){let{unhideChartElementFromAT:o}=t,{getFakeMouseEvent:s}=i,{attr:a,pick:l}=n;return class extends e{constructor(){super(...arguments),this.focusedMapNavButtonIx=-1}init(){let e=this,t=this.chart;this.proxyProvider.addGroup("zoom","div"),["afterShowResetZoom","afterApplyDrilldown","drillupall"].forEach((i=>{e.addEvent(t,i,(function(){e.updateProxyOverlays()}))}))}onChartUpdate(){let e=this.chart,t=this;e.mapNavigation&&e.mapNavigation.navButtons.forEach(((i,r)=>{o(e,i.element),t.setMapNavButtonAttrs(i.element,"accessibility.zoom.mapZoom"+(r?"Out":"In"))}))}setMapNavButtonAttrs(e,t){let i=this.chart;a(e,{tabindex:-1,role:"button","aria-label":i.langFormat(t,{chart:i})})}onChartRender(){this.updateProxyOverlays()}updateProxyOverlays(){let e=this.chart;if(this.proxyProvider.clearGroup("zoom"),e.resetZoomButton&&this.createZoomProxyButton(e.resetZoomButton,"resetZoomProxyButton",e.langFormat("accessibility.zoom.resetZoomButton",{chart:e})),e.drillUpButton&&e.breadcrumbs&&e.breadcrumbs.list){let t=e.breadcrumbs.list[e.breadcrumbs.list.length-1];this.createZoomProxyButton(e.drillUpButton,"drillUpProxyButton",e.langFormat("accessibility.drillUpButton",{chart:e,buttonText:e.breadcrumbs.getButtonText(t)}))}}createZoomProxyButton(e,t,i){this[t]=this.proxyProvider.addProxyElement("zoom",{click:e},"button",{"aria-label":i,tabindex:-1})}getMapZoomNavigation(){let e=this.keyCodes,t=this.chart,i=this;return new r(t,{keyCodeMap:[[[e.up,e.down,e.left,e.right],function(e){return i.onMapKbdArrow(this,e)}],[[e.tab],function(e,t){return i.onMapKbdTab(this,t)}],[[e.space,e.enter],function(){return i.onMapKbdClick(this)}]],validate:function(){return!!(t.mapView&&t.mapNavigation&&t.mapNavigation.navButtons.length)},init:function(e){return i.onMapNavInit(e)}})}onMapKbdArrow(e,t){let i=this.chart,r=this.keyCodes,n=i.container,o=t===r.up||t===r.down,a=t===r.left||t===r.up?1:-1,l=(o?i.plotHeight:i.plotWidth)/10*a,c=10*Math.random(),u={x:n.offsetLeft+i.plotLeft+i.plotWidth/2+c,y:n.offsetTop+i.plotTop+i.plotHeight/2+c},h=o?{x:u.x,y:u.y+l}:{x:u.x+l,y:u.y};return[s("mousedown",u),s("mousemove",h),s("mouseup",h)].forEach((e=>n.dispatchEvent(e))),e.response.success}onMapKbdTab(e,t){let i=this.chart,r=e.response,n=t.shiftKey,o=n&&!this.focusedMapNavButtonIx||!n&&this.focusedMapNavButtonIx;if(i.mapNavigation.navButtons[this.focusedMapNavButtonIx].setState(0),o)return i.mapView&&i.mapView.zoomBy(),r[n?"prev":"next"];this.focusedMapNavButtonIx+=n?-1:1;let s=i.mapNavigation.navButtons[this.focusedMapNavButtonIx];return i.setFocusToElement(s.box,s.element),s.setState(2),r.success}onMapKbdClick(e){let t=this.chart.mapNavigation.navButtons[this.focusedMapNavButtonIx].element;return this.fakeClickEvent(t),e.response.success}onMapNavInit(e){let t=this.chart,i=t.mapNavigation.navButtons[0],r=t.mapNavigation.navButtons[1],n=e>0?i:r;t.setFocusToElement(n.box,n.element),n.setState(2),this.focusedMapNavButtonIx=e>0?0:1}simpleButtonNavigation(e,t,i){let n=this.keyCodes,o=this,s=this.chart;return new r(s,{keyCodeMap:[[[n.tab,n.up,n.down,n.left,n.right],function(e,t){let i=e===n.tab&&t.shiftKey||e===n.left||e===n.up;return this.response[i?"prev":"next"]}],[[n.space,n.enter],function(){return l(i(this,s),this.response.success)}]],validate:function(){return s[e]&&s[e].box&&o[t].innerElement},init:function(){s.setFocusToElement(s[e].box,o[t].innerElement)}})}getKeyboardNavigation(){return[this.simpleButtonNavigation("resetZoomButton","resetZoomProxyButton",(function(e,t){t.zoomOut()})),this.simpleButtonNavigation("drillUpButton","drillUpProxyButton",(function(e,t){return t.drillUp(),e.response.prev})),this.getMapZoomNavigation()]}}})),i(t,"Accessibility/HighContrastMode.js",[t["Core/Globals.js"]],(function(e){let{doc:t,isMS:i,win:r}=e;return{isHighContrastModeActive:function(){let e=/(Edg)/.test(r.navigator.userAgent);if(r.matchMedia&&e)return r.matchMedia("(-ms-high-contrast: active)").matches;if(i&&r.getComputedStyle){let e=t.createElement("div");e.style.backgroundImage="url(data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)",t.body.appendChild(e);let i=(e.currentStyle||r.getComputedStyle(e)).backgroundImage;return t.body.removeChild(e),"none"===i}return r.matchMedia&&r.matchMedia("(forced-colors: active)").matches},setHighContrastTheme:function(e){e.highContrastModeActive=!0;let t=e.options.accessibility.highContrastTheme;e.update(t,!1);let i=t.colors?.length>1;e.series.forEach((function(e){let r=t.plotOptions[e.type]||{},n=i&&void 0!==e.colorIndex?t.colors[e.colorIndex]:r.color||"window",o={color:r.color||"windowText",colors:i?t.colors:[r.color||"windowText"],borderColor:r.borderColor||"window",fillColor:n};e.update(o,!1),e.points&&e.points.forEach((function(e){e.options&&e.options.color&&e.update({color:r.color||"windowText",borderColor:r.borderColor||"window"},!1)}))})),e.redraw()}}})),i(t,"Accessibility/HighContrastTheme.js",[],(function(){return{chart:{backgroundColor:"window"},title:{style:{color:"windowText"}},subtitle:{style:{color:"windowText"}},colorAxis:{minColor:"windowText",maxColor:"windowText",stops:[],dataClasses:[]},colors:["windowText"],xAxis:{gridLineColor:"windowText",labels:{style:{color:"windowText"}},lineColor:"windowText",minorGridLineColor:"windowText",tickColor:"windowText",title:{style:{color:"windowText"}}},yAxis:{gridLineColor:"windowText",labels:{style:{color:"windowText"}},lineColor:"windowText",minorGridLineColor:"windowText",tickColor:"windowText",title:{style:{color:"windowText"}}},tooltip:{backgroundColor:"window",borderColor:"windowText",style:{color:"windowText"}},plotOptions:{series:{lineColor:"windowText",fillColor:"window",borderColor:"windowText",edgeColor:"windowText",borderWidth:1,dataLabels:{connectorColor:"windowText",color:"windowText",style:{color:"windowText",textOutline:"none"}},marker:{lineColor:"windowText",fillColor:"windowText"}},pie:{color:"window",colors:["window"],borderColor:"windowText",borderWidth:1},boxplot:{fillColor:"window"},candlestick:{lineColor:"windowText",fillColor:"window"},errorbar:{fillColor:"window"}},legend:{backgroundColor:"window",itemStyle:{color:"windowText"},itemHoverStyle:{color:"windowText"},itemHiddenStyle:{color:"#555"},title:{style:{color:"windowText"}}},credits:{style:{color:"windowText"}},drilldown:{activeAxisLabelStyle:{color:"windowText"},activeDataLabelStyle:{color:"windowText"}},navigation:{buttonOptions:{symbolStroke:"windowText",theme:{fill:"window"}}},rangeSelector:{buttonTheme:{fill:"window",stroke:"windowText",style:{color:"windowText"},states:{hover:{fill:"window",stroke:"windowText",style:{color:"windowText"}},select:{fill:"#444",stroke:"windowText",style:{color:"windowText"}}}},inputBoxBorderColor:"windowText",inputStyle:{backgroundColor:"window",color:"windowText"},labelStyle:{color:"windowText"}},navigator:{handles:{backgroundColor:"window",borderColor:"windowText"},outlineColor:"windowText",maskFill:"transparent",series:{color:"windowText",lineColor:"windowText"},xAxis:{gridLineColor:"windowText"}},scrollbar:{barBackgroundColor:"#444",barBorderColor:"windowText",buttonArrowColor:"windowText",buttonBackgroundColor:"window",buttonBorderColor:"windowText",rifleColor:"windowText",trackBackgroundColor:"window",trackBorderColor:"windowText"}}})),i(t,"Accessibility/Options/A11yDefaults.js",[],(function(){return{accessibility:{enabled:!0,screenReaderSection:{beforeChartFormat:"<{headingTagName}>{chartTitle}</{headingTagName}><div>{typeDescription}</div><div>{chartSubtitle}</div><div>{chartLongdesc}</div><div>{playAsSoundButton}</div><div>{viewTableButton}</div><div>{xAxisDescription}</div><div>{yAxisDescription}</div><div>{annotationsTitle}{annotationsList}</div>",afterChartFormat:"{endOfChartMarker}",axisRangeDateFormat:"%Y-%m-%d %H:%M:%S"},series:{descriptionFormat:"{seriesDescription}{authorDescription}{axisDescription}",describeSingleSeries:!1,pointDescriptionEnabledThreshold:200},point:{valueDescriptionFormat:"{xDescription}{separator}{value}.",describeNull:!0},landmarkVerbosity:"all",linkedDescription:'*[data-highcharts-chart="{index}"] + .highcharts-description',highContrastMode:"auto",keyboardNavigation:{enabled:!0,focusBorder:{enabled:!0,hideBrowserFocusOutline:!0,style:{color:"#334eff",lineWidth:2,borderRadius:3},margin:2},order:["series","zoom","rangeSelector","navigator","legend","chartMenu"],wrapAround:!0,seriesNavigation:{skipNullPoints:!0,pointNavigationEnabledThreshold:!1,rememberPointFocus:!1}},announceNewData:{enabled:!1,minAnnounceInterval:5e3,interruptUser:!1}},legend:{accessibility:{enabled:!0,keyboardNavigation:{enabled:!0}}},exporting:{accessibility:{enabled:!0}},navigator:{accessibility:{enabled:!0}}}})),i(t,"Accessibility/Options/LangDefaults.js",[],(function(){return{accessibility:{defaultChartTitle:"Chart",chartContainerLabel:"{title}. Highcharts interactive chart.",svgContainerLabel:"Interactive chart",drillUpButton:"{buttonText}",credits:"Chart credits: {creditsStr}",thousandsSep:",",svgContainerTitle:"",graphicContainerLabel:"",screenReaderSection:{beforeRegionLabel:"",afterRegionLabel:"",annotations:{heading:"Chart annotations summary",descriptionSinglePoint:"{annotationText}. Related to {annotationPoint}",descriptionMultiplePoints:"{annotationText}. Related to {annotationPoint}{#each additionalAnnotationPoints}, also related to {this}{/each}",descriptionNoPoints:"{annotationText}"},endOfChartMarker:"End of interactive chart."},sonification:{playAsSoundButtonText:"Play as sound, {chartTitle}",playAsSoundClickAnnouncement:"Play"},legend:{legendLabelNoTitle:"Toggle series visibility, {chartTitle}",legendLabel:"Chart legend: {legendTitle}",legendItem:"Show {itemName}"},zoom:{mapZoomIn:"Zoom chart",mapZoomOut:"Zoom out chart",resetZoomButton:"Reset zoom"},rangeSelector:{dropdownLabel:"{rangeTitle}",minInputLabel:"Select start date.",maxInputLabel:"Select end date.",clickButtonAnnouncement:"Viewing {axisRangeDescription}"},navigator:{handleLabel:"{#eq handleIx 0}Start, percent{else}End, percent{/eq}",groupLabel:"Axis zoom",changeAnnouncement:"{axisRangeDescription}"},table:{viewAsDataTableButtonText:"View as data table, {chartTitle}",tableSummary:"Table representation of chart."},announceNewData:{newDataAnnounce:"Updated data for chart {chartTitle}",newSeriesAnnounceSingle:"New data series: {seriesDesc}",newPointAnnounceSingle:"New data point: {pointDesc}",newSeriesAnnounceMultiple:"New data series in chart {chartTitle}: {seriesDesc}",newPointAnnounceMultiple:"New data point in chart {chartTitle}: {pointDesc}"},seriesTypeDescriptions:{boxplot:"Box plot charts are typically used to display groups of statistical data. Each data point in the chart can have up to 5 values: minimum, lower quartile, median, upper quartile, and maximum.",arearange:"Arearange charts are line charts displaying a range between a lower and higher value for each point.",areasplinerange:"These charts are line charts displaying a range between a lower and higher value for each point.",bubble:"Bubble charts are scatter charts where each data point also has a size value.",columnrange:"Columnrange charts are column charts displaying a range between a lower and higher value for each point.",errorbar:"Errorbar series are used to display the variability of the data.",funnel:"Funnel charts are used to display reduction of data in stages.",pyramid:"Pyramid charts consist of a single pyramid with item heights corresponding to each point value.",waterfall:"A waterfall chart is a column chart where each column contributes towards a total end value."},chartTypes:{emptyChart:"Empty chart",mapTypeDescription:"Map of {mapTitle} with {numSeries} data series.",unknownMap:"Map of unspecified region with {numSeries} data series.",combinationChart:"Combination chart with {numSeries} data series.",defaultSingle:"Chart with {numPoints} data {#eq numPoints 1}point{else}points{/eq}.",defaultMultiple:"Chart with {numSeries} data series.",splineSingle:"Line chart with {numPoints} data {#eq numPoints 1}point{else}points{/eq}.",splineMultiple:"Line chart with {numSeries} lines.",lineSingle:"Line chart with {numPoints} data {#eq numPoints 1}point{else}points{/eq}.",lineMultiple:"Line chart with {numSeries} lines.",columnSingle:"Bar chart with {numPoints} {#eq numPoints 1}bar{else}bars{/eq}.",columnMultiple:"Bar chart with {numSeries} data series.",barSingle:"Bar chart with {numPoints} {#eq numPoints 1}bar{else}bars{/eq}.",barMultiple:"Bar chart with {numSeries} data series.",pieSingle:"Pie chart with {numPoints} {#eq numPoints 1}slice{else}slices{/eq}.",pieMultiple:"Pie chart with {numSeries} pies.",scatterSingle:"Scatter chart with {numPoints} {#eq numPoints 1}point{else}points{/eq}.",scatterMultiple:"Scatter chart with {numSeries} data series.",boxplotSingle:"Boxplot with {numPoints} {#eq numPoints 1}box{else}boxes{/eq}.",boxplotMultiple:"Boxplot with {numSeries} data series.",bubbleSingle:"Bubble chart with {numPoints} {#eq numPoints 1}bubbles{else}bubble{/eq}.",bubbleMultiple:"Bubble chart with {numSeries} data series."},axis:{xAxisDescriptionSingular:"The chart has 1 X axis displaying {names[0]}. {ranges[0]}",xAxisDescriptionPlural:"The chart has {numAxes} X axes displaying {#each names}{#unless @first},{/unless}{#if @last} and{/if} {this}{/each}.",yAxisDescriptionSingular:"The chart has 1 Y axis displaying {names[0]}. {ranges[0]}",yAxisDescriptionPlural:"The chart has {numAxes} Y axes displaying {#each names}{#unless @first},{/unless}{#if @last} and{/if} {this}{/each}.",timeRangeDays:"Data range: {range} days.",timeRangeHours:"Data range: {range} hours.",timeRangeMinutes:"Data range: {range} minutes.",timeRangeSeconds:"Data range: {range} seconds.",rangeFromTo:"Data ranges from {rangeFrom} to {rangeTo}.",rangeCategories:"Data range: {numCategories} categories."},exporting:{chartMenuLabel:"Chart menu",menuButtonLabel:"View chart menu, {chartTitle}"},series:{summary:{default:"{series.name}, series {seriesNumber} of {chart.series.length} with {series.points.length} data {#eq series.points.length 1}point{else}points{/eq}.",defaultCombination:"{series.name}, series {seriesNumber} of {chart.series.length} with {series.points.length} data {#eq series.points.length 1}point{else}points{/eq}.",line:"{series.name}, line {seriesNumber} of {chart.series.length} with {series.points.length} data {#eq series.points.length 1}point{else}points{/eq}.",lineCombination:"{series.name}, series {seriesNumber} of {chart.series.length}. Line with {series.points.length} data {#eq series.points.length 1}point{else}points{/eq}.",spline:"{series.name}, line {seriesNumber} of {chart.series.length} with {series.points.length} data {#eq series.points.length 1}point{else}points{/eq}.",splineCombination:"{series.name}, series {seriesNumber} of {chart.series.length}. Line with {series.points.length} data {#eq series.points.length 1}point{else}points{/eq}.",column:"{series.name}, bar series {seriesNumber} of {chart.series.length} with {series.points.length} {#eq series.points.length 1}bar{else}bars{/eq}.",columnCombination:"{series.name}, series {seriesNumber} of {chart.series.length}. Bar series with {series.points.length} {#eq series.points.length 1}bar{else}bars{/eq}.",bar:"{series.name}, bar series {seriesNumber} of {chart.series.length} with {series.points.length} {#eq series.points.length 1}bar{else}bars{/eq}.",barCombination:"{series.name}, series {seriesNumber} of {chart.series.length}. Bar series with {series.points.length} {#eq series.points.length 1}bar{else}bars{/eq}.",pie:"{series.name}, pie {seriesNumber} of {chart.series.length} with {series.points.length} {#eq series.points.length 1}slice{else}slices{/eq}.",pieCombination:"{series.name}, series {seriesNumber} of {chart.series.length}. Pie with {series.points.length} {#eq series.points.length 1}slice{else}slices{/eq}.",scatter:"{series.name}, scatter plot {seriesNumber} of {chart.series.length} with {series.points.length} {#eq series.points.length 1}point{else}points{/eq}.",scatterCombination:"{series.name}, series {seriesNumber} of {chart.series.length}, scatter plot with {series.points.length} {#eq series.points.length 1}point{else}points{/eq}.",boxplot:"{series.name}, boxplot {seriesNumber} of {chart.series.length} with {series.points.length} {#eq series.points.length 1}box{else}boxes{/eq}.",boxplotCombination:"{series.name}, series {seriesNumber} of {chart.series.length}. Boxplot with {series.points.length} {#eq series.points.length 1}box{else}boxes{/eq}.",bubble:"{series.name}, bubble series {seriesNumber} of {chart.series.length} with {series.points.length} {#eq series.points.length 1}bubble{else}bubbles{/eq}.",bubbleCombination:"{series.name}, series {seriesNumber} of {chart.series.length}. Bubble series with {series.points.length} {#eq series.points.length 1}bubble{else}bubbles{/eq}.",map:"{series.name}, map {seriesNumber} of {chart.series.length} with {series.points.length} {#eq series.points.length 1}area{else}areas{/eq}.",mapCombination:"{series.name}, series {seriesNumber} of {chart.series.length}. Map with {series.points.length} {#eq series.points.length 1}area{else}areas{/eq}.",mapline:"{series.name}, line {seriesNumber} of {chart.series.length} with {series.points.length} data {#eq series.points.length 1}point{else}points{/eq}.",maplineCombination:"{series.name}, series {seriesNumber} of {chart.series.length}. Line with {series.points.length} data {#eq series.points.length 1}point{else}points{/eq}.",mapbubble:"{series.name}, bubble series {seriesNumber} of {chart.series.length} with {series.points.length} {#eq series.points.length 1}bubble{else}bubbles{/eq}.",mapbubbleCombination:"{series.name}, series {seriesNumber} of {chart.series.length}. Bubble series with {series.points.length} {#eq series.points.length 1}bubble{else}bubbles{/eq}."},description:"{description}",xAxisDescription:"X axis, {name}",yAxisDescription:"Y axis, {name}",nullPointValue:"No value",pointAnnotationsDescription:"{#each annotations}Annotation: {this}{/each}"}}}})),i(t,"Accessibility/Options/DeprecatedOptions.js",[t["Core/Utilities.js"]],(function(e){let{error:t,pick:i}=e;function r(e,t,r){let n,o=e,s=0;for(;s<t.length-1;++s)o=o[n=t[s]]=i(o[n],{});o[t[t.length-1]]=r}function n(e,i,n,o){function s(e,t){return t.reduce((function(e,t){return e[t]}),e)}let a=s(e.options,i),l=s(e.options,n);Object.keys(o).forEach((function(s){let c=a[s];void 0!==c&&(r(l,o[s],c),t(32,!1,e,{[i.join(".")+"."+s]:n.join(".")+"."+o[s].join(".")}))}))}return function(e){(function(e){let i=e.options.chart,r=e.options.accessibility||{};["description","typeDescription"].forEach((function(n){i[n]&&(r[n]=i[n],t(32,!1,e,{[`chart.${n}`]:`use accessibility.${n}`}))}))})(e),function(e){e.axes.forEach((function(i){let r=i.options;r&&r.description&&(r.accessibility=r.accessibility||{},r.accessibility.description=r.description,t(32,!1,e,{"axis.description":"use axis.accessibility.description"}))}))}(e),e.series&&function(e){let i={description:["accessibility","description"],exposeElementToA11y:["accessibility","exposeAsGroupOnly"],pointDescriptionFormatter:["accessibility","point","descriptionFormatter"],skipKeyboardNavigation:["accessibility","keyboardNavigation","enabled"],"accessibility.pointDescriptionFormatter":["accessibility","point","descriptionFormatter"]};e.series.forEach((function(n){Object.keys(i).forEach((function(o){let s=n.options[o];"accessibility.pointDescriptionFormatter"===o&&(s=n.options.accessibility&&n.options.accessibility.pointDescriptionFormatter),void 0!==s&&(r(n.options,i[o],"skipKeyboardNavigation"===o?!s:s),t(32,!1,e,{[`series.${o}`]:"series."+i[o].join(".")}))}))}))}(e),n(e,["accessibility"],["accessibility"],{pointDateFormat:["point","dateFormat"],pointDateFormatter:["point","dateFormatter"],pointDescriptionFormatter:["point","descriptionFormatter"],pointDescriptionThreshold:["series","pointDescriptionEnabledThreshold"],pointNavigationThreshold:["keyboardNavigation","seriesNavigation","pointNavigationEnabledThreshold"],pointValueDecimals:["point","valueDecimals"],pointValuePrefix:["point","valuePrefix"],pointValueSuffix:["point","valueSuffix"],screenReaderSectionFormatter:["screenReaderSection","beforeChartFormatter"],describeSingleSeries:["series","describeSingleSeries"],seriesDescriptionFormatter:["series","descriptionFormatter"],onTableAnchorClick:["screenReaderSection","onViewDataTableClick"],axisRangeDateFormat:["screenReaderSection","axisRangeDateFormat"]}),n(e,["accessibility","keyboardNavigation"],["accessibility","keyboardNavigation","seriesNavigation"],{skipNullPoints:["skipNullPoints"],mode:["mode"]}),n(e,["lang","accessibility"],["lang","accessibility"],{legendItem:["legend","legendItem"],legendLabel:["legend","legendLabel"],mapZoomIn:["zoom","mapZoomIn"],mapZoomOut:["zoom","mapZoomOut"],resetZoomButton:["zoom","resetZoomButton"],screenReaderRegionLabel:["screenReaderSection","beforeRegionLabel"],rangeSelectorButton:["rangeSelector","buttonText"],rangeSelectorMaxInput:["rangeSelector","maxInputLabel"],rangeSelectorMinInput:["rangeSelector","minInputLabel"],svgContainerEnd:["screenReaderSection","endOfChartMarker"],viewAsDataTable:["table","viewAsDataTableButtonText"],tableSummary:["table","tableSummary"]})}})),i(t,"Accessibility/Accessibility.js",[t["Core/Defaults.js"],t["Core/Globals.js"],t["Core/Utilities.js"],t["Accessibility/Utils/HTMLUtilities.js"],t["Accessibility/A11yI18n.js"],t["Accessibility/Components/ContainerComponent.js"],t["Accessibility/FocusBorder.js"],t["Accessibility/Components/InfoRegionsComponent.js"],t["Accessibility/KeyboardNavigation.js"],t["Accessibility/Components/LegendComponent.js"],t["Accessibility/Components/MenuComponent.js"],t["Accessibility/Components/NavigatorComponent.js"],t["Accessibility/Components/SeriesComponent/NewDataAnnouncer.js"],t["Accessibility/ProxyProvider.js"],t["Accessibility/Components/RangeSelectorComponent.js"],t["Accessibility/Components/SeriesComponent/SeriesComponent.js"],t["Accessibility/Components/ZoomComponent.js"],t["Accessibility/HighContrastMode.js"],t["Accessibility/HighContrastTheme.js"],t["Accessibility/Options/A11yDefaults.js"],t["Accessibility/Options/LangDefaults.js"],t["Accessibility/Options/DeprecatedOptions.js"]],(function(e,t,i,r,n,o,s,a,l,c,u,h,d,p,f,m,g,y,_,v,x,b){let{defaultOptions:w}=e,{doc:S}=t,{addEvent:T,extend:M,fireEvent:A,merge:C}=i,{removeElement:E}=r;class P{constructor(e){this.init(e)}init(e){if(this.chart=e,!S.addEventListener)return this.zombie=!0,this.components={},void e.renderTo.setAttribute("aria-hidden",!0);b(e),this.proxyProvider=new p(this.chart),this.initComponents(),this.keyboardNavigation=new l(e,this.components)}initComponents(){let e=this.chart,t=this.proxyProvider,i=e.options.accessibility;this.components={container:new o,infoRegions:new a,legend:new c,chartMenu:new u,rangeSelector:new f,series:new m,zoom:new g,navigator:new h},i.customComponents&&M(this.components,i.customComponents);let r=this.components;this.getComponentOrder().forEach((function(i){r[i].initBase(e,t),r[i].init()}))}getComponentOrder(){return this.components?this.components.series?["series"].concat(Object.keys(this.components).filter((e=>"series"!==e))):Object.keys(this.components):[]}update(){let e=this.components,t=this.chart,i=t.options.accessibility;A(t,"beforeA11yUpdate"),t.types=this.getChartTypes();let r=i.keyboardNavigation.order;this.proxyProvider.updateGroupOrder(r),this.getComponentOrder().forEach((function(i){e[i].onChartUpdate(),A(t,"afterA11yComponentUpdate",{name:i,component:e[i]})})),this.keyboardNavigation.update(r),!t.highContrastModeActive&&!1!==i.highContrastMode&&(y.isHighContrastModeActive()||!0===i.highContrastMode)&&y.setHighContrastTheme(t),A(t,"afterA11yUpdate",{accessibility:this})}destroy(){let e=this.chart||{},t=this.components;Object.keys(t).forEach((function(e){t[e].destroy(),t[e].destroyBase()})),this.proxyProvider&&this.proxyProvider.destroy(),e.announcerContainer&&E(e.announcerContainer),this.keyboardNavigation&&this.keyboardNavigation.destroy(),e.renderTo&&e.renderTo.setAttribute("aria-hidden",!0),e.focusElement&&e.focusElement.removeFocusBorder()}getChartTypes(){let e={};return this.chart.series.forEach((function(t){e[t.type]=1})),Object.keys(e)}}return function(e){function t(){this.accessibility&&this.accessibility.destroy()}function i(){this.a11yDirty&&this.renderTo&&(delete this.a11yDirty,this.updateA11yEnabled());let e=this.accessibility;e&&!e.zombie&&(e.proxyProvider.updateProxyElementPositions(),e.getComponentOrder().forEach((function(t){e.components[t].onChartRender()})))}function r(e){let t=e.options.accessibility;t&&(t.customComponents&&(this.options.accessibility.customComponents=t.customComponents,delete t.customComponents),C(!0,this.options.accessibility,t),this.accessibility&&this.accessibility.destroy&&(this.accessibility.destroy(),delete this.accessibility)),this.a11yDirty=!0}function o(){let t=this.accessibility,i=this.options.accessibility,r=this.renderer.boxWrapper.element,n=this.title;if(i&&i.enabled)t&&!t.zombie?t.update():(this.accessibility=t=new e(this),t&&!t.zombie&&t.update(),"img"===r.getAttribute("role")&&r.removeAttribute("role"));else if(t)t.destroy&&t.destroy(),delete this.accessibility;else{this.renderTo.setAttribute("role","img"),this.renderTo.setAttribute("aria-hidden",!1),this.renderTo.setAttribute("aria-label",(n&&n.element.textContent||"").replace(/</g,"&lt;")),r.setAttribute("aria-hidden",!0);let e=document.getElementsByClassName("highcharts-description")[0];e&&(e.setAttribute("aria-hidden",!1),e.classList.remove("highcharts-linked-description"))}}function a(){this.series.chart.accessibility&&(this.series.chart.a11yDirty=!0)}e.i18nFormat=n.i18nFormat,e.compose=function(e,h,p,g,y,_){l.compose(e),d.compose(g),c.compose(e,h),u.compose(e),m.compose(e,p,g),n.compose(e),s.compose(e,y),_&&f.compose(e,_);let v=e.prototype;v.updateA11yEnabled||(v.updateA11yEnabled=o,T(e,"destroy",t),T(e,"render",i),T(e,"update",r),["addSeries","init"].forEach((t=>{T(e,t,(function(){this.a11yDirty=!0}))})),["afterApplyDrilldown","drillupall"].forEach((t=>{T(e,t,(function(){let e=this.accessibility;e&&!e.zombie&&e.update()}))})),T(p,"update",a),["update","updatedData","remove"].forEach((e=>{T(g,e,(function(){this.chart.accessibility&&(this.chart.a11yDirty=!0)}))})))}}(P||(P={})),C(!0,w,v,{accessibility:{highContrastTheme:_},lang:x}),P})),i(t,"masters/modules/accessibility.src.js",[t["Core/Globals.js"],t["Accessibility/Accessibility.js"],t["Accessibility/AccessibilityComponent.js"],t["Accessibility/Utils/ChartUtilities.js"],t["Accessibility/Utils/HTMLUtilities.js"],t["Accessibility/KeyboardNavigationHandler.js"],t["Accessibility/Components/SeriesComponent/SeriesDescriber.js"]],(function(e,t,i,r,n,o,s){return e.i18nFormat=t.i18nFormat,e.A11yChartUtilities=r,e.A11yHTMLUtilities=n,e.AccessibilityComponent=i,e.KeyboardNavigationHandler=o,e.SeriesAccessibilityDescriber=s,t.compose(e.Chart,e.Legend,e.Point,e.Series,e.SVGElement,e.RangeSelector),e}))},e.exports?(o.default=o,e.exports=o):(r=[i(3488)],void 0===(n=function(e){return o(e),o.Highcharts=e,o}.apply(t,r))||(e.exports=n))},7598:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(7868);function n(e){if("string"!==typeof e)throw new Error((0,r.A)(7));return e.charAt(0).toUpperCase()+e.slice(1)}},7758:(e,t,i)=>{"use strict";i.d(t,{A:()=>R});var r=i(8604),n=i(7162),o=i(3815);const s=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const r=t.reduce(((e,t)=>(t.filterProps.forEach((i=>{e[i]=t})),e)),{}),n=e=>Object.keys(e).reduce(((t,i)=>r[i]?(0,o.A)(t,r[i](e)):t),{});return n.propTypes={},n.filterProps=t.reduce(((e,t)=>e.concat(t.filterProps)),[]),n};var a=i(9751);function l(e){return"number"!==typeof e?e:`${e}px solid`}function c(e,t){return(0,n.Ay)({prop:e,themeKey:"borders",transform:t})}const u=c("border",l),h=c("borderTop",l),d=c("borderRight",l),p=c("borderBottom",l),f=c("borderLeft",l),m=c("borderColor"),g=c("borderTopColor"),y=c("borderRightColor"),_=c("borderBottomColor"),v=c("borderLeftColor"),x=c("outline",l),b=c("outlineColor"),w=e=>{if(void 0!==e.borderRadius&&null!==e.borderRadius){const t=(0,r.MA)(e.theme,"shape.borderRadius",4,"borderRadius"),i=e=>({borderRadius:(0,r._W)(t,e)});return(0,a.NI)(e,e.borderRadius,i)}return null};w.propTypes={},w.filterProps=["borderRadius"];s(u,h,d,p,f,m,g,y,_,v,w,x,b);const S=e=>{if(void 0!==e.gap&&null!==e.gap){const t=(0,r.MA)(e.theme,"spacing",8,"gap"),i=e=>({gap:(0,r._W)(t,e)});return(0,a.NI)(e,e.gap,i)}return null};S.propTypes={},S.filterProps=["gap"];const T=e=>{if(void 0!==e.columnGap&&null!==e.columnGap){const t=(0,r.MA)(e.theme,"spacing",8,"columnGap"),i=e=>({columnGap:(0,r._W)(t,e)});return(0,a.NI)(e,e.columnGap,i)}return null};T.propTypes={},T.filterProps=["columnGap"];const M=e=>{if(void 0!==e.rowGap&&null!==e.rowGap){const t=(0,r.MA)(e.theme,"spacing",8,"rowGap"),i=e=>({rowGap:(0,r._W)(t,e)});return(0,a.NI)(e,e.rowGap,i)}return null};M.propTypes={},M.filterProps=["rowGap"];s(S,T,M,(0,n.Ay)({prop:"gridColumn"}),(0,n.Ay)({prop:"gridRow"}),(0,n.Ay)({prop:"gridAutoFlow"}),(0,n.Ay)({prop:"gridAutoColumns"}),(0,n.Ay)({prop:"gridAutoRows"}),(0,n.Ay)({prop:"gridTemplateColumns"}),(0,n.Ay)({prop:"gridTemplateRows"}),(0,n.Ay)({prop:"gridTemplateAreas"}),(0,n.Ay)({prop:"gridArea"}));function A(e,t){return"grey"===t?t:e}s((0,n.Ay)({prop:"color",themeKey:"palette",transform:A}),(0,n.Ay)({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:A}),(0,n.Ay)({prop:"backgroundColor",themeKey:"palette",transform:A}));function C(e){return e<=1&&0!==e?100*e+"%":e}const E=(0,n.Ay)({prop:"width",transform:C}),P=e=>{if(void 0!==e.maxWidth&&null!==e.maxWidth){const t=t=>{var i,r;const n=(null==(i=e.theme)||null==(i=i.breakpoints)||null==(i=i.values)?void 0:i[t])||a.zu[t];return n?"px"!==(null==(r=e.theme)||null==(r=r.breakpoints)?void 0:r.unit)?{maxWidth:`${n}${e.theme.breakpoints.unit}`}:{maxWidth:n}:{maxWidth:C(t)}};return(0,a.NI)(e,e.maxWidth,t)}return null};P.filterProps=["maxWidth"];const k=(0,n.Ay)({prop:"minWidth",transform:C}),I=(0,n.Ay)({prop:"height",transform:C}),D=(0,n.Ay)({prop:"maxHeight",transform:C}),L=(0,n.Ay)({prop:"minHeight",transform:C}),R=((0,n.Ay)({prop:"size",cssProperty:"width",transform:C}),(0,n.Ay)({prop:"size",cssProperty:"height",transform:C}),s(E,P,k,I,D,L,(0,n.Ay)({prop:"boxSizing"})),{border:{themeKey:"borders",transform:l},borderTop:{themeKey:"borders",transform:l},borderRight:{themeKey:"borders",transform:l},borderBottom:{themeKey:"borders",transform:l},borderLeft:{themeKey:"borders",transform:l},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:l},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:w},color:{themeKey:"palette",transform:A},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:A},backgroundColor:{themeKey:"palette",transform:A},p:{style:r.Ms},pt:{style:r.Ms},pr:{style:r.Ms},pb:{style:r.Ms},pl:{style:r.Ms},px:{style:r.Ms},py:{style:r.Ms},padding:{style:r.Ms},paddingTop:{style:r.Ms},paddingRight:{style:r.Ms},paddingBottom:{style:r.Ms},paddingLeft:{style:r.Ms},paddingX:{style:r.Ms},paddingY:{style:r.Ms},paddingInline:{style:r.Ms},paddingInlineStart:{style:r.Ms},paddingInlineEnd:{style:r.Ms},paddingBlock:{style:r.Ms},paddingBlockStart:{style:r.Ms},paddingBlockEnd:{style:r.Ms},m:{style:r.Lc},mt:{style:r.Lc},mr:{style:r.Lc},mb:{style:r.Lc},ml:{style:r.Lc},mx:{style:r.Lc},my:{style:r.Lc},margin:{style:r.Lc},marginTop:{style:r.Lc},marginRight:{style:r.Lc},marginBottom:{style:r.Lc},marginLeft:{style:r.Lc},marginX:{style:r.Lc},marginY:{style:r.Lc},marginInline:{style:r.Lc},marginInlineStart:{style:r.Lc},marginInlineEnd:{style:r.Lc},marginBlock:{style:r.Lc},marginBlockStart:{style:r.Lc},marginBlockEnd:{style:r.Lc},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:S},rowGap:{style:M},columnGap:{style:T},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:C},maxWidth:{style:P},minWidth:{transform:C},height:{transform:C},maxHeight:{transform:C},minHeight:{transform:C},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}})},7868:(e,t,i)=>{"use strict";function r(e){let t="https://mui.com/production-error/?code="+e;for(let i=1;i<arguments.length;i+=1)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified MUI error #"+e+"; visit "+t+" for the full message."}i.d(t,{A:()=>r})},7918:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r.A});var r=i(7598)},7950:(e,t,i)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=i(2730)},8052:(e,t,i)=>{"use strict";var r=i(4994);t.Ay=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{themeId:t,defaultTheme:i=m,rootShouldForwardProp:r=f,slotShouldForwardProp:l=f}=e,u=e=>(0,c.default)((0,n.default)({},e,{theme:y((0,n.default)({},e,{defaultTheme:i,themeId:t}))}));return u.__mui_systemSx=!0,function(e){let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,s.internal_processStyles)(e,(e=>e.filter((e=>!(null!=e&&e.__mui_systemSx)))));const{name:h,slot:p,skipVariantsResolver:m,skipSx:x,overridesResolver:b=_(g(p))}=c,w=(0,o.default)(c,d),S=void 0!==m?m:p&&"Root"!==p&&"root"!==p||!1,T=x||!1;let M=f;"Root"===p||"root"===p?M=r:p?M=l:function(e){return"string"===typeof e&&e.charCodeAt(0)>96}(e)&&(M=void 0);const A=(0,s.default)(e,(0,n.default)({shouldForwardProp:M,label:undefined},w)),C=e=>"function"===typeof e&&e.__emotion_real!==e||(0,a.isPlainObject)(e)?r=>v(e,(0,n.default)({},r,{theme:y({theme:r.theme,defaultTheme:i,themeId:t})})):e,E=function(r){let o=C(r);for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];const c=a?a.map(C):[];h&&b&&c.push((e=>{const r=y((0,n.default)({},e,{defaultTheme:i,themeId:t}));if(!r.components||!r.components[h]||!r.components[h].styleOverrides)return null;const o=r.components[h].styleOverrides,s={};return Object.entries(o).forEach((t=>{let[i,o]=t;s[i]=v(o,(0,n.default)({},e,{theme:r}))})),b(e,s)})),h&&!S&&c.push((e=>{var r;const o=y((0,n.default)({},e,{defaultTheme:i,themeId:t}));return v({variants:null==o||null==(r=o.components)||null==(r=r[h])?void 0:r.variants},(0,n.default)({},e,{theme:o}))})),T||c.push(u);const d=c.length-a.length;if(Array.isArray(r)&&d>0){const e=new Array(d).fill("");o=[...r,...e],o.raw=[...r.raw,...e]}const p=A(o,...c);return e.muiName&&(p.muiName=e.muiName),p};return A.withConfig&&(E.withConfig=A.withConfig),E}};var n=r(i(4634)),o=r(i(4893)),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var i=p(t);if(i&&i.has(e))return i.get(e);var r={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=n?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,i&&i.set(e,r),r}(i(3174)),a=i(9482),l=(r(i(7918)),r(i(3382)),r(i(4989))),c=r(i(3234));const u=["ownerState"],h=["variants"],d=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(p=function(e){return e?i:t})(e)}function f(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}const m=(0,l.default)(),g=e=>e?e.charAt(0).toLowerCase()+e.slice(1):e;function y(e){let{defaultTheme:t,theme:i,themeId:r}=e;return n=i,0===Object.keys(n).length?t:i[r]||i;var n}function _(e){return e?(t,i)=>i[e]:null}function v(e,t){let{ownerState:i}=t,r=(0,o.default)(t,u);const s="function"===typeof e?e((0,n.default)({ownerState:i},r)):e;if(Array.isArray(s))return s.flatMap((e=>v(e,(0,n.default)({ownerState:i},r))));if(s&&"object"===typeof s&&Array.isArray(s.variants)){const{variants:e=[]}=s;let t=(0,o.default)(s,h);return e.forEach((e=>{let o=!0;"function"===typeof e.props?o=e.props((0,n.default)({ownerState:i},r,i)):Object.keys(e.props).forEach((t=>{(null==i?void 0:i[t])!==e.props[t]&&r[t]!==e.props[t]&&(o=!1)})),o&&(Array.isArray(t)||(t=[t]),t.push("function"===typeof e.style?e.style((0,n.default)({ownerState:i},r,i)):e.style))})),t}return s}},8168:(e,t,i)=>{"use strict";function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)({}).hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},r.apply(null,arguments)}i.d(t,{A:()=>r})},8280:(e,t,i)=>{"use strict";i.d(t,{A:()=>p});var r=i(8168),n=i(8587),o=i(9172),s=i(4853);const a={borderRadius:4};var l=i(8604);var c=i(8812),u=i(7758),h=i(9703);const d=["breakpoints","palette","spacing","shape"];const p=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{breakpoints:t={},palette:i={},spacing:p,shape:f={}}=e,m=(0,n.A)(e,d),g=(0,s.A)(t),y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;if(e.mui)return e;const t=(0,l.LX)({spacing:e}),i=function(){for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];return(0===i.length?[1]:i).map((e=>{const i=t(e);return"number"===typeof i?`${i}px`:i})).join(" ")};return i.mui=!0,i}(p);let _=(0,o.A)({breakpoints:g,direction:"ltr",components:{},palette:(0,r.A)({mode:"light"},i),spacing:y,shape:(0,r.A)({},a,f)},m);_.applyStyles=h.A;for(var v=arguments.length,x=new Array(v>1?v-1:0),b=1;b<v;b++)x[b-1]=arguments[b];return _=x.reduce(((e,t)=>(0,o.A)(e,t)),_),_.unstable_sxConfig=(0,r.A)({},u.A,null==m?void 0:m.unstable_sxConfig),_.unstable_sx=function(e){return(0,c.A)({sx:e,theme:this})},_}},8587:(e,t,i)=>{"use strict";function r(e,t){if(null==e)return{};var i={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;i[r]=e[r]}return i}i.d(t,{A:()=>r})},8604:(e,t,i)=>{"use strict";i.d(t,{LX:()=>f,MA:()=>p,_W:()=>m,Lc:()=>_,Ms:()=>v});var r=i(9751),n=i(7162),o=i(3815);const s={m:"margin",p:"padding"},a={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},l={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},c=function(e){const t={};return i=>(void 0===t[i]&&(t[i]=e(i)),t[i])}((e=>{if(e.length>2){if(!l[e])return[e];e=l[e]}const[t,i]=e.split(""),r=s[t],n=a[i]||"";return Array.isArray(n)?n.map((e=>r+e)):[r+n]})),u=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],h=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],d=[...u,...h];function p(e,t,i,r){var o;const s=null!=(o=(0,n.Yn)(e,t,!1))?o:i;return"number"===typeof s?e=>"string"===typeof e?e:s*e:Array.isArray(s)?e=>"string"===typeof e?e:s[e]:"function"===typeof s?s:()=>{}}function f(e){return p(e,"spacing",8)}function m(e,t){if("string"===typeof t||null==t)return t;const i=e(Math.abs(t));return t>=0?i:"number"===typeof i?-i:`-${i}`}function g(e,t,i,n){if(-1===t.indexOf(i))return null;const o=function(e,t){return i=>e.reduce(((e,r)=>(e[r]=m(t,i),e)),{})}(c(i),n),s=e[i];return(0,r.NI)(e,s,o)}function y(e,t){const i=f(e.theme);return Object.keys(e).map((r=>g(e,t,r,i))).reduce(o.A,{})}function _(e){return y(e,u)}function v(e){return y(e,h)}function x(e){return y(e,d)}_.propTypes={},_.filterProps=u,v.propTypes={},v.filterProps=h,x.propTypes={},x.filterProps=d},8698:(e,t,i)=>{"use strict";i.d(t,{A:()=>c});var r=i(8168),n=i(8587),o=i(9172),s=i(7758);const a=["sx"],l=e=>{var t,i;const r={systemProps:{},otherProps:{}},n=null!=(t=null==e||null==(i=e.theme)?void 0:i.unstable_sxConfig)?t:s.A;return Object.keys(e).forEach((t=>{n[t]?r.systemProps[t]=e[t]:r.otherProps[t]=e[t]})),r};function c(e){const{sx:t}=e,i=(0,n.A)(e,a),{systemProps:s,otherProps:c}=l(i);let u;return u=Array.isArray(t)?[s,...t]:"function"===typeof t?function(){const e=t(...arguments);return(0,o.Q)(e)?(0,r.A)({},s,e):s}:(0,r.A)({},s,t),(0,r.A)({},c,{sx:u})}},8812:(e,t,i)=>{"use strict";i.d(t,{A:()=>u,k:()=>l});var r=i(7598),n=i(3815),o=i(7162),s=i(9751),a=i(7758);function l(){function e(e,t,i,n){const a={[e]:t,theme:i},l=n[e];if(!l)return{[e]:t};const{cssProperty:c=e,themeKey:u,transform:h,style:d}=l;if(null==t)return null;if("typography"===u&&"inherit"===t)return{[e]:t};const p=(0,o.Yn)(i,u)||{};if(d)return d(a);return(0,s.NI)(a,t,(t=>{let i=(0,o.BO)(p,h,t);return t===i&&"string"===typeof t&&(i=(0,o.BO)(p,h,`${e}${"default"===t?"":(0,r.A)(t)}`,t)),!1===c?i:{[c]:i}}))}return function t(i){var r;const{sx:o,theme:l={}}=i||{};if(!o)return null;const c=null!=(r=l.unstable_sxConfig)?r:a.A;function u(i){let r=i;if("function"===typeof i)r=i(l);else if("object"!==typeof i)return i;if(!r)return null;const o=(0,s.EU)(l.breakpoints),a=Object.keys(o);let u=o;return Object.keys(r).forEach((i=>{const o=(a=r[i],h=l,"function"===typeof a?a(h):a);var a,h;if(null!==o&&void 0!==o)if("object"===typeof o)if(c[i])u=(0,n.A)(u,e(i,o,l,c));else{const e=(0,s.NI)({theme:l},o,(e=>({[i]:e})));!function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const r=t.reduce(((e,t)=>e.concat(Object.keys(t))),[]),n=new Set(r);return t.every((e=>n.size===Object.keys(e).length))}(e,o)?u=(0,n.A)(u,e):u[i]=t({sx:o,theme:l})}else u=(0,n.A)(u,e(i,o,l,c))})),(0,s.vf)(a,u)}return Array.isArray(o)?o.map(u):u(o)}}const c=l();c.filterProps=["sx"];const u=c},8853:(e,t,i)=>{"use strict";e.exports=i(7234)},9172:(e,t,i)=>{"use strict";i.d(t,{A:()=>a,Q:()=>o});var r=i(8168),n=i(5043);function o(e){if("object"!==typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function s(e){if(n.isValidElement(e)||!o(e))return e;const t={};return Object.keys(e).forEach((i=>{t[i]=s(e[i])})),t}function a(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clone:!0};const l=i.clone?(0,r.A)({},e):e;return o(e)&&o(t)&&Object.keys(t).forEach((r=>{n.isValidElement(t[r])?l[r]=t[r]:o(t[r])&&Object.prototype.hasOwnProperty.call(e,r)&&o(e[r])?l[r]=a(e[r],t[r],i):i.clone?l[r]=o(t[r])?s(t[r]):t[r]:l[r]=t[r]})),l}},9369:(e,t,i)=>{"use strict";i.d(t,{C:()=>c,E:()=>g,T:()=>h,c:()=>f,h:()=>d,w:()=>u});var r=i(5043),n=i(3803),o=i(1722),s=i(6598),a=i(9436),l=r.createContext("undefined"!==typeof HTMLElement?(0,n.A)({key:"css"}):null),c=l.Provider,u=function(e){return(0,r.forwardRef)((function(t,i){var n=(0,r.useContext)(l);return e(t,n,i)}))},h=r.createContext({});var d={}.hasOwnProperty,p="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",f=function(e,t){var i={};for(var r in t)d.call(t,r)&&(i[r]=t[r]);return i[p]=e,i},m=function(e){var t=e.cache,i=e.serialized,r=e.isStringTag;return(0,o.SF)(t,i,r),(0,a.s)((function(){return(0,o.sk)(t,i,r)})),null},g=u((function(e,t,i){var n=e.css;"string"===typeof n&&void 0!==t.registered[n]&&(n=t.registered[n]);var a=e[p],l=[n],c="";"string"===typeof e.className?c=(0,o.Rk)(t.registered,l,e.className):null!=e.className&&(c=e.className+" ");var u=(0,s.J)(l,void 0,r.useContext(h));c+=t.key+"-"+u.name;var f={};for(var g in e)d.call(e,g)&&"css"!==g&&g!==p&&(f[g]=e[g]);return f.className=c,i&&(f.ref=i),r.createElement(r.Fragment,null,r.createElement(m,{cache:t,serialized:u,isStringTag:"string"===typeof a}),r.createElement(a,f))}))},9436:(e,t,i)=>{"use strict";var r;i.d(t,{i:()=>a,s:()=>s});var n=i(5043),o=!!(r||(r=i.t(n,2))).useInsertionEffect&&(r||(r=i.t(n,2))).useInsertionEffect,s=o||function(e){return e()},a=o||n.useLayoutEffect},9482:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r.A,isPlainObject:()=>r.Q});var r=i(9172)},9520:(e,t,i)=>{var r,n,o;o=function(e){"use strict";var t=e?e._modules:{};function i(t,i,r,n){t.hasOwnProperty(i)||(t[i]=n.apply(null,r),"function"==typeof CustomEvent&&e.win.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:i,module:t[i]}})))}i(t,"Extensions/NoDataToDisplay/NoDataDefaults.js",[],(function(){return{lang:{noData:"No data to display"},noData:{attr:{zIndex:1},position:{x:0,y:0,align:"center",verticalAlign:"middle"},style:{fontWeight:"bold",fontSize:"0.8em",color:"#666666"}}}})),i(t,"Extensions/NoDataToDisplay/NoDataToDisplay.js",[t["Core/Renderer/HTML/AST.js"],t["Extensions/NoDataToDisplay/NoDataDefaults.js"],t["Core/Utilities.js"]],(function(e,t,i){let{addEvent:r,extend:n,merge:o}=i;function s(){let e=this.series||[],t=e.length;for(;t--;)if(e[t].hasData()&&!e[t].options.isInternal)return!0;return this.loadingShown}function a(){this.noDataLabel&&(this.noDataLabel=this.noDataLabel.destroy())}function l(t){let i=this.options,r=t||i&&i.lang.noData||"",o=i&&(i.noData||{});this.renderer&&(this.noDataLabel||(this.noDataLabel=this.renderer.label(r,0,0,void 0,void 0,void 0,o.useHTML,void 0,"no-data").add()),this.styledMode||this.noDataLabel.attr(e.filterUserAttributes(o.attr||{})).css(o.style||{}),this.noDataLabel.align(n(this.noDataLabel.getBBox(),o.position||{}),!1,"plotBox"))}function c(){this.hasData()?this.hideNoData():this.showNoData()}return{compose:function(e,i){let n=e.prototype;n.showNoData||(n.hasData=s,n.hideNoData=a,n.showNoData=l,r(e,"render",c),o(!0,i,t))}}})),i(t,"masters/modules/no-data-to-display.src.js",[t["Core/Globals.js"],t["Extensions/NoDataToDisplay/NoDataToDisplay.js"]],(function(e,t){return t.compose(e.Chart,e.defaultOptions),e}))},e.exports?(o.default=o,e.exports=o):(r=[i(3488)],void 0===(n=function(e){return o(e),o.Highcharts=e,o}.apply(t,r))||(e.exports=n))},9703:(e,t,i)=>{"use strict";function r(e,t){const i=this;if(i.vars&&"function"===typeof i.getColorSchemeSelector){const r=i.getColorSchemeSelector(e).replace(/(\[[^\]]+\])/,"*:where($1)");return{[r]:t}}return i.palette.mode===e?t:{}}i.d(t,{A:()=>r})},9751:(e,t,i)=>{"use strict";i.d(t,{EU:()=>s,NI:()=>o,vf:()=>a,zu:()=>r});const r={xs:0,sm:600,md:900,lg:1200,xl:1536},n={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${r[e]}px)`};function o(e,t,i){const o=e.theme||{};if(Array.isArray(t)){const e=o.breakpoints||n;return t.reduce(((r,n,o)=>(r[e.up(e.keys[o])]=i(t[o]),r)),{})}if("object"===typeof t){const e=o.breakpoints||n;return Object.keys(t).reduce(((n,o)=>{if(-1!==Object.keys(e.values||r).indexOf(o)){n[e.up(o)]=i(t[o],o)}else{const e=o;n[e]=t[e]}return n}),{})}return i(t)}function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;return(null==(t=e.keys)?void 0:t.reduce(((t,i)=>(t[e.up(i)]={},t)),{}))||{}}function a(e,t){return e.reduce(((e,t)=>{const i=e[t];return(!i||0===Object.keys(i).length)&&delete e[t],e}),t)}}},t={};function i(r){var n=t[r];if(void 0!==n)return n.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,i),o.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;i.t=function(r,n){if(1&n&&(r=this(r)),8&n)return r;if("object"===typeof r&&r){if(4&n&&r.__esModule)return r;if(16&n&&"function"===typeof r.then)return r}var o=Object.create(null);i.r(o);var s={};e=e||[null,t({}),t([]),t(t)];for(var a=2&n&&r;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>s[e]=()=>r[e]));return s.default=()=>r,i.d(o,s),o}})(),i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e=i(5043),t=i.t(e,2),r=i(4391),n=i(8168),o=i(8587);function s(e,t){const i=(0,n.A)({},t);return Object.keys(e).forEach((r=>{if(r.toString().match(/^(components|slots)$/))i[r]=(0,n.A)({},e[r],i[r]);else if(r.toString().match(/^(componentsProps|slotProps)$/)){const o=e[r]||{},a=t[r];i[r]={},a&&Object.keys(a)?o&&Object.keys(o)?(i[r]=(0,n.A)({},a),Object.keys(o).forEach((e=>{i[r][e]=s(o[e],a[e])}))):i[r]=a:i[r]=o}else void 0===i[r]&&(i[r]=e[r])})),i}function a(e){const{theme:t,name:i,props:r}=e;return t&&t.components&&t.components[i]&&t.components[i].defaultProps?s(t.components[i].defaultProps,r):r}var l=i(8280),c=i(9369);const u=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const i=e.useContext(c.T);return i&&(r=i,0!==Object.keys(r).length)?i:t;var r},h=(0,l.A)();const d=function(){return u(arguments.length>0&&void 0!==arguments[0]?arguments[0]:h)};var p=i(7868),f=i(9172),m=i(7758),g=i(8812);var y=i(7266);const _={black:"#000",white:"#fff"},v={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},x={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},b={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},w={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},S={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},T={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},M={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},A=["mode","contrastThreshold","tonalOffset"],C={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:_.white,default:_.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},E={text:{primary:_.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:_.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function P(e,t,i,r){const n=r.light||r,o=r.dark||1.5*r;e[t]||(e.hasOwnProperty(i)?e[t]=e[i]:"light"===t?e.light=(0,y.a)(e.main,n):"dark"===t&&(e.dark=(0,y.e$)(e.main,o)))}function k(e){const{mode:t="light",contrastThreshold:i=3,tonalOffset:r=.2}=e,s=(0,o.A)(e,A),a=e.primary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:S[200],light:S[50],dark:S[400]}:{main:S[700],light:S[400],dark:S[800]}}(t),l=e.secondary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:x[200],light:x[50],dark:x[400]}:{main:x[500],light:x[300],dark:x[700]}}(t),c=e.error||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:b[500],light:b[300],dark:b[700]}:{main:b[700],light:b[400],dark:b[800]}}(t),u=e.info||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:T[400],light:T[300],dark:T[700]}:{main:T[700],light:T[500],dark:T[900]}}(t),h=e.success||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:M[400],light:M[300],dark:M[700]}:{main:M[800],light:M[500],dark:M[900]}}(t),d=e.warning||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:w[400],light:w[300],dark:w[700]}:{main:"#ed6c02",light:w[500],dark:w[900]}}(t);function m(e){return(0,y.eM)(e,E.text.primary)>=i?E.text.primary:C.text.primary}const g=e=>{let{color:t,name:i,mainShade:o=500,lightShade:s=300,darkShade:a=700}=e;if(t=(0,n.A)({},t),!t.main&&t[o]&&(t.main=t[o]),!t.hasOwnProperty("main"))throw new Error((0,p.A)(11,i?` (${i})`:"",o));if("string"!==typeof t.main)throw new Error((0,p.A)(12,i?` (${i})`:"",JSON.stringify(t.main)));return P(t,"light",s,r),P(t,"dark",a,r),t.contrastText||(t.contrastText=m(t.main)),t},k={dark:E,light:C};return(0,f.A)((0,n.A)({common:(0,n.A)({},_),mode:t,primary:g({color:a,name:"primary"}),secondary:g({color:l,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:g({color:c,name:"error"}),warning:g({color:d,name:"warning"}),info:g({color:u,name:"info"}),success:g({color:h,name:"success"}),grey:v,contrastThreshold:i,getContrastText:m,augmentColor:g,tonalOffset:r},k[t]),s)}const I=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];const D={textTransform:"uppercase"},L='"Roboto", "Helvetica", "Arial", sans-serif';function R(e,t){const i="function"===typeof t?t(e):t,{fontFamily:r=L,fontSize:s=14,fontWeightLight:a=300,fontWeightRegular:l=400,fontWeightMedium:c=500,fontWeightBold:u=700,htmlFontSize:h=16,allVariants:d,pxToRem:p}=i,m=(0,o.A)(i,I);const g=s/14,y=p||(e=>e/h*g+"rem"),_=(e,t,i,o,s)=>{return(0,n.A)({fontFamily:r,fontWeight:e,fontSize:y(t),lineHeight:i},r===L?{letterSpacing:(a=o/t,Math.round(1e5*a)/1e5)+"em"}:{},s,d);var a},v={h1:_(a,96,1.167,-1.5),h2:_(a,60,1.2,-.5),h3:_(l,48,1.167,0),h4:_(l,34,1.235,.25),h5:_(l,24,1.334,0),h6:_(c,20,1.6,.15),subtitle1:_(l,16,1.75,.15),subtitle2:_(c,14,1.57,.1),body1:_(l,16,1.5,.15),body2:_(l,14,1.43,.15),button:_(c,14,1.75,.4,D),caption:_(l,12,1.66,.4),overline:_(l,12,2.66,1,D),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return(0,f.A)((0,n.A)({htmlFontSize:h,pxToRem:y,fontFamily:r,fontSize:s,fontWeightLight:a,fontWeightRegular:l,fontWeightMedium:c,fontWeightBold:u},v),m,{clone:!1})}function z(){return[`${arguments.length<=0?void 0:arguments[0]}px ${arguments.length<=1?void 0:arguments[1]}px ${arguments.length<=2?void 0:arguments[2]}px ${arguments.length<=3?void 0:arguments[3]}px rgba(0,0,0,0.2)`,`${arguments.length<=4?void 0:arguments[4]}px ${arguments.length<=5?void 0:arguments[5]}px ${arguments.length<=6?void 0:arguments[6]}px ${arguments.length<=7?void 0:arguments[7]}px rgba(0,0,0,0.14)`,`${arguments.length<=8?void 0:arguments[8]}px ${arguments.length<=9?void 0:arguments[9]}px ${arguments.length<=10?void 0:arguments[10]}px ${arguments.length<=11?void 0:arguments[11]}px rgba(0,0,0,0.12)`].join(",")}const O=["none",z(0,2,1,-1,0,1,1,0,0,1,3,0),z(0,3,1,-2,0,2,2,0,0,1,5,0),z(0,3,3,-2,0,3,4,0,0,1,8,0),z(0,2,4,-1,0,4,5,0,0,1,10,0),z(0,3,5,-1,0,5,8,0,0,1,14,0),z(0,3,5,-1,0,6,10,0,0,1,18,0),z(0,4,5,-2,0,7,10,1,0,2,16,1),z(0,5,5,-3,0,8,10,1,0,3,14,2),z(0,5,6,-3,0,9,12,1,0,3,16,2),z(0,6,6,-3,0,10,14,1,0,4,18,3),z(0,6,7,-4,0,11,15,1,0,4,20,3),z(0,7,8,-4,0,12,17,2,0,5,22,4),z(0,7,8,-4,0,13,19,2,0,5,24,4),z(0,7,9,-4,0,14,21,2,0,5,26,4),z(0,8,9,-5,0,15,22,2,0,6,28,5),z(0,8,10,-5,0,16,24,2,0,6,30,5),z(0,8,11,-5,0,17,26,2,0,6,32,5),z(0,9,11,-5,0,18,28,2,0,7,34,6),z(0,9,12,-6,0,19,29,2,0,7,36,6),z(0,10,13,-6,0,20,31,3,0,8,38,7),z(0,10,13,-6,0,21,33,3,0,8,40,7),z(0,10,14,-6,0,22,35,3,0,8,42,7),z(0,11,14,-7,0,23,36,3,0,9,44,8),z(0,11,15,-7,0,24,38,3,0,9,46,8)],F=["duration","easing","delay"],B={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},N={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function j(e){return`${Math.round(e)}ms`}function V(e){if(!e)return 0;const t=e/36;return Math.round(10*(4+15*t**.25+t/5))}function U(e){const t=(0,n.A)({},B,e.easing),i=(0,n.A)({},N,e.duration);return(0,n.A)({getAutoHeightDuration:V,create:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{duration:n=i.standard,easing:s=t.easeInOut,delay:a=0}=r;(0,o.A)(r,F);return(Array.isArray(e)?e:[e]).map((e=>`${e} ${"string"===typeof n?n:j(n)} ${s} ${"string"===typeof a?a:j(a)}`)).join(",")}},e,{easing:t,duration:i})}const G={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},H=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function W(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{mixins:t={},palette:i={},transitions:r={},typography:s={}}=e,a=(0,o.A)(e,H);if(e.vars&&void 0===e.generateCssVars)throw new Error((0,p.A)(18));const c=k(i),u=(0,l.A)(e);let h=(0,f.A)(u,{mixins:(d=u.breakpoints,y=t,(0,n.A)({toolbar:{minHeight:56,[d.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[d.up("sm")]:{minHeight:64}}},y)),palette:c,shadows:O.slice(),typography:R(c,s),transitions:U(r),zIndex:(0,n.A)({},G)});var d,y;h=(0,f.A)(h,a);for(var _=arguments.length,v=new Array(_>1?_-1:0),x=1;x<_;x++)v[x-1]=arguments[x];return h=v.reduce(((e,t)=>(0,f.A)(e,t)),h),h.unstable_sxConfig=(0,n.A)({},m.A,null==a?void 0:a.unstable_sxConfig),h.unstable_sx=function(e){return(0,g.A)({sx:e,theme:this})},h}const $=W(),q="$$material";function X(e){let{props:t,name:i}=e;return function(e){let{props:t,name:i,defaultTheme:r,themeId:n}=e,o=d(r);return n&&(o=o[n]||o),a({theme:o,name:i,props:t})}({props:t,name:i,defaultTheme:$,themeId:q})}var Y=i(579);const Z=["localeText"],K=e.createContext(null);const J=function(t){var i;const{localeText:r}=t,s=(0,o.A)(t,Z),{utils:a,localeText:l}=null!=(i=e.useContext(K))?i:{utils:void 0,localeText:void 0},c=X({props:s,name:"MuiLocalizationProvider"}),{children:u,dateAdapter:h,dateFormats:d,dateLibInstance:p,adapterLocale:f,localeText:m}=c,g=e.useMemo((()=>(0,n.A)({},m,l,r)),[m,l,r]),y=e.useMemo((()=>{if(!h)return a||null;const e=new h({locale:f,formats:d,instance:p});if(!e.isMUIAdapter)throw new Error(["MUI: The date adapter should be imported from `@mui/x-date-pickers` or `@mui/x-date-pickers-pro`, not from `@date-io`","For example, `import { AdapterDayjs } from '@mui/x-date-pickers/AdapterDayjs'` instead of `import AdapterDayjs from '@date-io/dayjs'`","More information on the installation documentation: https://mui.com/x/react-date-pickers/getting-started/#installation"].join("\n"));return e}),[h,f,d,p,a]),_=e.useMemo((()=>y?{minDate:y.date("1900-01-01T00:00:00.000"),maxDate:y.date("2099-12-31T00:00:00.000")}:null),[y]),v=e.useMemo((()=>({utils:y,defaultDates:_,localeText:g})),[_,y,g]);return(0,Y.jsx)(K.Provider,{value:v,children:u})};function Q(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function ee(e){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ee(e)}function te(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function ie(e){te(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===ee(e)&&"[object Date]"===t?new Date(e.getTime()):"number"===typeof e||"[object Number]"===t?new Date(e):("string"!==typeof e&&"[object String]"!==t||"undefined"===typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}function re(e,t){te(2,arguments);var i=ie(e),r=Q(t);return isNaN(r)?new Date(NaN):r?(i.setDate(i.getDate()+r),i):i}function ne(e,t){te(2,arguments);var i=ie(e).getTime(),r=Q(t);return new Date(i+r)}function oe(e,t){te(2,arguments);var i=ie(e),r=Q(t);if(isNaN(r))return new Date(NaN);if(!r)return i;var n=i.getDate(),o=new Date(i.getTime());return o.setMonth(i.getMonth()+r+1,0),n>=o.getDate()?o:(i.setFullYear(o.getFullYear(),o.getMonth(),n),i)}function se(e,t){return te(2,arguments),oe(e,12*Q(t))}function ae(e,t){te(2,arguments);var i=ie(e),r=ie(t),n=i.getTime()-r.getTime();return n<0?-1:n>0?1:n}function le(e,t){te(2,arguments);var i=ie(e),r=ie(t),n=ae(i,r),o=Math.abs(function(e,t){te(2,arguments);var i=ie(e),r=ie(t);return i.getFullYear()-r.getFullYear()}(i,r));i.setFullYear(1584),r.setFullYear(1584);var s=ae(i,r)===-n,a=n*(o-Number(s));return 0===a?0:a}function ce(e){te(1,arguments);var t=ie(e);return t.setHours(23,59,59,999),t}function ue(e){te(1,arguments);var t=ie(e),i=t.getMonth();return t.setFullYear(t.getFullYear(),i+1,0),t.setHours(23,59,59,999),t}function he(e,t){te(2,arguments);var i,r=ie(e),n=ie(t),o=ae(r,n),s=Math.abs(function(e,t){te(2,arguments);var i=ie(e),r=ie(t);return 12*(i.getFullYear()-r.getFullYear())+(i.getMonth()-r.getMonth())}(r,n));if(s<1)i=0;else{1===r.getMonth()&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-o*s);var a=ae(r,n)===-o;(function(e){te(1,arguments);var t=ie(e);return ce(t).getTime()===ue(t).getTime()})(ie(e))&&1===s&&1===ae(e,n)&&(a=!1),i=o*(s-Number(a))}return 0===i?0:i}var de={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)}};function pe(e){return e?de[e]:de.trunc}function fe(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}function me(e){te(1,arguments);var t=ie(e);return t.setHours(0,0,0,0),t}function ge(e,t){var i=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return i<0?-1:i>0?1:i}function ye(e,t){te(2,arguments);var i=ie(e),r=ie(t),n=ge(i,r),o=Math.abs(function(e,t){te(2,arguments);var i=me(e),r=me(t),n=i.getTime()-fe(i),o=r.getTime()-fe(r);return Math.round((n-o)/864e5)}(i,r));i.setDate(i.getDate()-n*o);var s=n*(o-Number(ge(i,r)===-n));return 0===s?0:s}Math.pow(10,8);var _e=6e4,ve=36e5;function xe(e,t){return te(2,arguments),ie(e).getTime()-ie(t).getTime()}var be={};function we(){return be}function Se(e,t){var i,r,n,o,s,a,l,c;te(1,arguments);var u=we(),h=Q(null!==(i=null!==(r=null!==(n=null!==(o=null===t||void 0===t?void 0:t.weekStartsOn)&&void 0!==o?o:null===t||void 0===t||null===(s=t.locale)||void 0===s||null===(a=s.options)||void 0===a?void 0:a.weekStartsOn)&&void 0!==n?n:u.weekStartsOn)&&void 0!==r?r:null===(l=u.locale)||void 0===l||null===(c=l.options)||void 0===c?void 0:c.weekStartsOn)&&void 0!==i?i:0);if(!(h>=0&&h<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var d=ie(e),p=d.getDay(),f=6+(p<h?-7:0)-(p-h);return d.setDate(d.getDate()+f),d.setHours(23,59,59,999),d}function Te(e){te(1,arguments);var t=ie(e),i=t.getFullYear();return t.setFullYear(i+1,0,0),t.setHours(23,59,59,999),t}function Me(e){if(te(1,arguments),!function(e){return te(1,arguments),e instanceof Date||"object"===ee(e)&&"[object Date]"===Object.prototype.toString.call(e)}(e)&&"number"!==typeof e)return!1;var t=ie(e);return!isNaN(Number(t))}function Ae(e,t){return te(2,arguments),ne(e,-Q(t))}function Ce(e){te(1,arguments);var t=ie(e),i=t.getUTCDay(),r=(i<1?7:0)+i-1;return t.setUTCDate(t.getUTCDate()-r),t.setUTCHours(0,0,0,0),t}function Ee(e){te(1,arguments);var t=ie(e),i=t.getUTCFullYear(),r=new Date(0);r.setUTCFullYear(i+1,0,4),r.setUTCHours(0,0,0,0);var n=Ce(r),o=new Date(0);o.setUTCFullYear(i,0,4),o.setUTCHours(0,0,0,0);var s=Ce(o);return t.getTime()>=n.getTime()?i+1:t.getTime()>=s.getTime()?i:i-1}function Pe(e){te(1,arguments);var t=ie(e),i=Ce(t).getTime()-function(e){te(1,arguments);var t=Ee(e),i=new Date(0);return i.setUTCFullYear(t,0,4),i.setUTCHours(0,0,0,0),Ce(i)}(t).getTime();return Math.round(i/6048e5)+1}function ke(e,t){var i,r,n,o,s,a,l,c;te(1,arguments);var u=we(),h=Q(null!==(i=null!==(r=null!==(n=null!==(o=null===t||void 0===t?void 0:t.weekStartsOn)&&void 0!==o?o:null===t||void 0===t||null===(s=t.locale)||void 0===s||null===(a=s.options)||void 0===a?void 0:a.weekStartsOn)&&void 0!==n?n:u.weekStartsOn)&&void 0!==r?r:null===(l=u.locale)||void 0===l||null===(c=l.options)||void 0===c?void 0:c.weekStartsOn)&&void 0!==i?i:0);if(!(h>=0&&h<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var d=ie(e),p=d.getUTCDay(),f=(p<h?7:0)+p-h;return d.setUTCDate(d.getUTCDate()-f),d.setUTCHours(0,0,0,0),d}function Ie(e,t){var i,r,n,o,s,a,l,c;te(1,arguments);var u=ie(e),h=u.getUTCFullYear(),d=we(),p=Q(null!==(i=null!==(r=null!==(n=null!==(o=null===t||void 0===t?void 0:t.firstWeekContainsDate)&&void 0!==o?o:null===t||void 0===t||null===(s=t.locale)||void 0===s||null===(a=s.options)||void 0===a?void 0:a.firstWeekContainsDate)&&void 0!==n?n:d.firstWeekContainsDate)&&void 0!==r?r:null===(l=d.locale)||void 0===l||null===(c=l.options)||void 0===c?void 0:c.firstWeekContainsDate)&&void 0!==i?i:1);if(!(p>=1&&p<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var f=new Date(0);f.setUTCFullYear(h+1,0,p),f.setUTCHours(0,0,0,0);var m=ke(f,t),g=new Date(0);g.setUTCFullYear(h,0,p),g.setUTCHours(0,0,0,0);var y=ke(g,t);return u.getTime()>=m.getTime()?h+1:u.getTime()>=y.getTime()?h:h-1}function De(e,t){te(1,arguments);var i=ie(e),r=ke(i,t).getTime()-function(e,t){var i,r,n,o,s,a,l,c;te(1,arguments);var u=we(),h=Q(null!==(i=null!==(r=null!==(n=null!==(o=null===t||void 0===t?void 0:t.firstWeekContainsDate)&&void 0!==o?o:null===t||void 0===t||null===(s=t.locale)||void 0===s||null===(a=s.options)||void 0===a?void 0:a.firstWeekContainsDate)&&void 0!==n?n:u.firstWeekContainsDate)&&void 0!==r?r:null===(l=u.locale)||void 0===l||null===(c=l.options)||void 0===c?void 0:c.firstWeekContainsDate)&&void 0!==i?i:1),d=Ie(e,t),p=new Date(0);return p.setUTCFullYear(d,0,h),p.setUTCHours(0,0,0,0),ke(p,t)}(i,t).getTime();return Math.round(r/6048e5)+1}function Le(e,t){for(var i=e<0?"-":"",r=Math.abs(e).toString();r.length<t;)r="0"+r;return i+r}const Re={y:function(e,t){var i=e.getUTCFullYear(),r=i>0?i:1-i;return Le("yy"===t?r%100:r,t.length)},M:function(e,t){var i=e.getUTCMonth();return"M"===t?String(i+1):Le(i+1,2)},d:function(e,t){return Le(e.getUTCDate(),t.length)},a:function(e,t){var i=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return i.toUpperCase();case"aaa":return i;case"aaaaa":return i[0];default:return"am"===i?"a.m.":"p.m."}},h:function(e,t){return Le(e.getUTCHours()%12||12,t.length)},H:function(e,t){return Le(e.getUTCHours(),t.length)},m:function(e,t){return Le(e.getUTCMinutes(),t.length)},s:function(e,t){return Le(e.getUTCSeconds(),t.length)},S:function(e,t){var i=t.length,r=e.getUTCMilliseconds();return Le(Math.floor(r*Math.pow(10,i-3)),t.length)}};var ze="midnight",Oe="noon",Fe="morning",Be="afternoon",Ne="evening",je="night";function Ve(e,t){var i=e>0?"-":"+",r=Math.abs(e),n=Math.floor(r/60),o=r%60;if(0===o)return i+String(n);var s=t||"";return i+String(n)+s+Le(o,2)}function Ue(e,t){return e%60===0?(e>0?"-":"+")+Le(Math.abs(e)/60,2):Ge(e,t)}function Ge(e,t){var i=t||"",r=e>0?"-":"+",n=Math.abs(e);return r+Le(Math.floor(n/60),2)+i+Le(n%60,2)}const He={G:function(e,t,i){var r=e.getUTCFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return i.era(r,{width:"abbreviated"});case"GGGGG":return i.era(r,{width:"narrow"});default:return i.era(r,{width:"wide"})}},y:function(e,t,i){if("yo"===t){var r=e.getUTCFullYear(),n=r>0?r:1-r;return i.ordinalNumber(n,{unit:"year"})}return Re.y(e,t)},Y:function(e,t,i,r){var n=Ie(e,r),o=n>0?n:1-n;return"YY"===t?Le(o%100,2):"Yo"===t?i.ordinalNumber(o,{unit:"year"}):Le(o,t.length)},R:function(e,t){return Le(Ee(e),t.length)},u:function(e,t){return Le(e.getUTCFullYear(),t.length)},Q:function(e,t,i){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return Le(r,2);case"Qo":return i.ordinalNumber(r,{unit:"quarter"});case"QQQ":return i.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return i.quarter(r,{width:"narrow",context:"formatting"});default:return i.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,i){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return Le(r,2);case"qo":return i.ordinalNumber(r,{unit:"quarter"});case"qqq":return i.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return i.quarter(r,{width:"narrow",context:"standalone"});default:return i.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,i){var r=e.getUTCMonth();switch(t){case"M":case"MM":return Re.M(e,t);case"Mo":return i.ordinalNumber(r+1,{unit:"month"});case"MMM":return i.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return i.month(r,{width:"narrow",context:"formatting"});default:return i.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,i){var r=e.getUTCMonth();switch(t){case"L":return String(r+1);case"LL":return Le(r+1,2);case"Lo":return i.ordinalNumber(r+1,{unit:"month"});case"LLL":return i.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return i.month(r,{width:"narrow",context:"standalone"});default:return i.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,i,r){var n=De(e,r);return"wo"===t?i.ordinalNumber(n,{unit:"week"}):Le(n,t.length)},I:function(e,t,i){var r=Pe(e);return"Io"===t?i.ordinalNumber(r,{unit:"week"}):Le(r,t.length)},d:function(e,t,i){return"do"===t?i.ordinalNumber(e.getUTCDate(),{unit:"date"}):Re.d(e,t)},D:function(e,t,i){var r=function(e){te(1,arguments);var t=ie(e),i=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var r=i-t.getTime();return Math.floor(r/864e5)+1}(e);return"Do"===t?i.ordinalNumber(r,{unit:"dayOfYear"}):Le(r,t.length)},E:function(e,t,i){var r=e.getUTCDay();switch(t){case"E":case"EE":case"EEE":return i.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return i.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return i.day(r,{width:"short",context:"formatting"});default:return i.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,i,r){var n=e.getUTCDay(),o=(n-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(o);case"ee":return Le(o,2);case"eo":return i.ordinalNumber(o,{unit:"day"});case"eee":return i.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return i.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return i.day(n,{width:"short",context:"formatting"});default:return i.day(n,{width:"wide",context:"formatting"})}},c:function(e,t,i,r){var n=e.getUTCDay(),o=(n-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(o);case"cc":return Le(o,t.length);case"co":return i.ordinalNumber(o,{unit:"day"});case"ccc":return i.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return i.day(n,{width:"narrow",context:"standalone"});case"cccccc":return i.day(n,{width:"short",context:"standalone"});default:return i.day(n,{width:"wide",context:"standalone"})}},i:function(e,t,i){var r=e.getUTCDay(),n=0===r?7:r;switch(t){case"i":return String(n);case"ii":return Le(n,t.length);case"io":return i.ordinalNumber(n,{unit:"day"});case"iii":return i.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return i.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return i.day(r,{width:"short",context:"formatting"});default:return i.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,i){var r=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return i.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return i.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return i.dayPeriod(r,{width:"narrow",context:"formatting"});default:return i.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,i){var r,n=e.getUTCHours();switch(r=12===n?Oe:0===n?ze:n/12>=1?"pm":"am",t){case"b":case"bb":return i.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return i.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return i.dayPeriod(r,{width:"narrow",context:"formatting"});default:return i.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(e,t,i){var r,n=e.getUTCHours();switch(r=n>=17?Ne:n>=12?Be:n>=4?Fe:je,t){case"B":case"BB":case"BBB":return i.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return i.dayPeriod(r,{width:"narrow",context:"formatting"});default:return i.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(e,t,i){if("ho"===t){var r=e.getUTCHours()%12;return 0===r&&(r=12),i.ordinalNumber(r,{unit:"hour"})}return Re.h(e,t)},H:function(e,t,i){return"Ho"===t?i.ordinalNumber(e.getUTCHours(),{unit:"hour"}):Re.H(e,t)},K:function(e,t,i){var r=e.getUTCHours()%12;return"Ko"===t?i.ordinalNumber(r,{unit:"hour"}):Le(r,t.length)},k:function(e,t,i){var r=e.getUTCHours();return 0===r&&(r=24),"ko"===t?i.ordinalNumber(r,{unit:"hour"}):Le(r,t.length)},m:function(e,t,i){return"mo"===t?i.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):Re.m(e,t)},s:function(e,t,i){return"so"===t?i.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):Re.s(e,t)},S:function(e,t){return Re.S(e,t)},X:function(e,t,i,r){var n=(r._originalDate||e).getTimezoneOffset();if(0===n)return"Z";switch(t){case"X":return Ue(n);case"XXXX":case"XX":return Ge(n);default:return Ge(n,":")}},x:function(e,t,i,r){var n=(r._originalDate||e).getTimezoneOffset();switch(t){case"x":return Ue(n);case"xxxx":case"xx":return Ge(n);default:return Ge(n,":")}},O:function(e,t,i,r){var n=(r._originalDate||e).getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Ve(n,":");default:return"GMT"+Ge(n,":")}},z:function(e,t,i,r){var n=(r._originalDate||e).getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Ve(n,":");default:return"GMT"+Ge(n,":")}},t:function(e,t,i,r){var n=r._originalDate||e;return Le(Math.floor(n.getTime()/1e3),t.length)},T:function(e,t,i,r){return Le((r._originalDate||e).getTime(),t.length)}};var We=function(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},$e=function(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}};const qe={p:$e,P:function(e,t){var i,r=e.match(/(P+)(p+)?/)||[],n=r[1],o=r[2];if(!o)return We(e,t);switch(n){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;default:i=t.dateTime({width:"full"})}return i.replace("{{date}}",We(n,t)).replace("{{time}}",$e(o,t))}};var Xe=["D","DD"],Ye=["YY","YYYY"];function Ze(e){return-1!==Xe.indexOf(e)}function Ke(e){return-1!==Ye.indexOf(e)}function Je(e,t,i){if("YYYY"===e)throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(i,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("YY"===e)throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(i,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("D"===e)throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(i,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("DD"===e)throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(i,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var Qe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};const et=function(e,t,i){var r,n=Qe[e];return r="string"===typeof n?n:1===t?n.one:n.other.replace("{{count}}",t.toString()),null!==i&&void 0!==i&&i.addSuffix?i.comparison&&i.comparison>0?"in "+r:r+" ago":r};function tt(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.width?String(t.width):e.defaultWidth;return e.formats[i]||e.formats[e.defaultWidth]}}var it={date:tt({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:tt({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:tt({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})};var rt={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function nt(e){return function(t,i){var r;if("formatting"===(null!==i&&void 0!==i&&i.context?String(i.context):"standalone")&&e.formattingValues){var n=e.defaultFormattingWidth||e.defaultWidth,o=null!==i&&void 0!==i&&i.width?String(i.width):n;r=e.formattingValues[o]||e.formattingValues[n]}else{var s=e.defaultWidth,a=null!==i&&void 0!==i&&i.width?String(i.width):e.defaultWidth;r=e.values[a]||e.values[s]}return r[e.argumentCallback?e.argumentCallback(t):t]}}function ot(e){return function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i.width,n=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],o=t.match(n);if(!o)return null;var s,a=o[0],l=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?function(e,t){for(var i=0;i<e.length;i++)if(t(e[i]))return i;return}(l,(function(e){return e.test(a)})):function(e,t){for(var i in e)if(e.hasOwnProperty(i)&&t(e[i]))return i;return}(l,(function(e){return e.test(a)}));return s=e.valueCallback?e.valueCallback(c):c,{value:s=i.valueCallback?i.valueCallback(s):s,rest:t.slice(a.length)}}}var st;const at={code:"en-US",formatDistance:et,formatLong:it,formatRelative:function(e,t,i,r){return rt[e]},localize:{ordinalNumber:function(e,t){var i=Number(e),r=i%100;if(r>20||r<10)switch(r%10){case 1:return i+"st";case 2:return i+"nd";case 3:return i+"rd"}return i+"th"},era:nt({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:nt({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:nt({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:nt({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:nt({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:(st={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.match(st.matchPattern);if(!i)return null;var r=i[0],n=e.match(st.parsePattern);if(!n)return null;var o=st.valueCallback?st.valueCallback(n[0]):n[0];return{value:o=t.valueCallback?t.valueCallback(o):o,rest:e.slice(r.length)}}),era:ot({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:ot({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:ot({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:ot({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:ot({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}},lt=at;var ct=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,ut=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,ht=/^'([^]*?)'?$/,dt=/''/g,pt=/[a-zA-Z]/;function ft(e,t,i){var r,n,o,s,a,l,c,u,h,d,p,f,m,g,y,_,v,x;te(2,arguments);var b=String(t),w=we(),S=null!==(r=null!==(n=null===i||void 0===i?void 0:i.locale)&&void 0!==n?n:w.locale)&&void 0!==r?r:lt,T=Q(null!==(o=null!==(s=null!==(a=null!==(l=null===i||void 0===i?void 0:i.firstWeekContainsDate)&&void 0!==l?l:null===i||void 0===i||null===(c=i.locale)||void 0===c||null===(u=c.options)||void 0===u?void 0:u.firstWeekContainsDate)&&void 0!==a?a:w.firstWeekContainsDate)&&void 0!==s?s:null===(h=w.locale)||void 0===h||null===(d=h.options)||void 0===d?void 0:d.firstWeekContainsDate)&&void 0!==o?o:1);if(!(T>=1&&T<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var M=Q(null!==(p=null!==(f=null!==(m=null!==(g=null===i||void 0===i?void 0:i.weekStartsOn)&&void 0!==g?g:null===i||void 0===i||null===(y=i.locale)||void 0===y||null===(_=y.options)||void 0===_?void 0:_.weekStartsOn)&&void 0!==m?m:w.weekStartsOn)&&void 0!==f?f:null===(v=w.locale)||void 0===v||null===(x=v.options)||void 0===x?void 0:x.weekStartsOn)&&void 0!==p?p:0);if(!(M>=0&&M<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!S.localize)throw new RangeError("locale must contain localize property");if(!S.formatLong)throw new RangeError("locale must contain formatLong property");var A=ie(e);if(!Me(A))throw new RangeError("Invalid time value");var C=Ae(A,fe(A)),E={firstWeekContainsDate:T,weekStartsOn:M,locale:S,_originalDate:A};return b.match(ut).map((function(e){var t=e[0];return"p"===t||"P"===t?(0,qe[t])(e,S.formatLong):e})).join("").match(ct).map((function(r){if("''"===r)return"'";var n=r[0];if("'"===n)return function(e){var t=e.match(ht);if(!t)return e;return t[1].replace(dt,"'")}(r);var o=He[n];if(o)return null!==i&&void 0!==i&&i.useAdditionalWeekYearTokens||!Ke(r)||Je(r,t,String(e)),null!==i&&void 0!==i&&i.useAdditionalDayOfYearTokens||!Ze(r)||Je(r,t,String(e)),o(C,r,S.localize,E);if(n.match(pt))throw new RangeError("Format string contains an unescaped latin alphabet character `"+n+"`");return r})).join("")}function mt(e){te(1,arguments);var t=ie(e),i=t.getFullYear(),r=t.getMonth(),n=new Date(0);return n.setFullYear(i,r+1,0),n.setHours(0,0,0,0),n.getDate()}function gt(e,t){var i,r,n,o,s,a,l,c;te(1,arguments);var u=we(),h=Q(null!==(i=null!==(r=null!==(n=null!==(o=null===t||void 0===t?void 0:t.weekStartsOn)&&void 0!==o?o:null===t||void 0===t||null===(s=t.locale)||void 0===s||null===(a=s.options)||void 0===a?void 0:a.weekStartsOn)&&void 0!==n?n:u.weekStartsOn)&&void 0!==r?r:null===(l=u.locale)||void 0===l||null===(c=l.options)||void 0===c?void 0:c.weekStartsOn)&&void 0!==i?i:0);if(!(h>=0&&h<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var d=ie(e),p=d.getDay(),f=(p<h?7:0)+p-h;return d.setDate(d.getDate()-f),d.setHours(0,0,0,0),d}function yt(e,t){var i,r,n,o,s,a,l,c;te(1,arguments);var u=we(),h=Q(null!==(i=null!==(r=null!==(n=null!==(o=null===t||void 0===t?void 0:t.firstWeekContainsDate)&&void 0!==o?o:null===t||void 0===t||null===(s=t.locale)||void 0===s||null===(a=s.options)||void 0===a?void 0:a.firstWeekContainsDate)&&void 0!==n?n:u.firstWeekContainsDate)&&void 0!==r?r:null===(l=u.locale)||void 0===l||null===(c=l.options)||void 0===c?void 0:c.firstWeekContainsDate)&&void 0!==i?i:1),d=function(e,t){var i,r,n,o,s,a,l,c;te(1,arguments);var u=ie(e),h=u.getFullYear(),d=we(),p=Q(null!==(i=null!==(r=null!==(n=null!==(o=null===t||void 0===t?void 0:t.firstWeekContainsDate)&&void 0!==o?o:null===t||void 0===t||null===(s=t.locale)||void 0===s||null===(a=s.options)||void 0===a?void 0:a.firstWeekContainsDate)&&void 0!==n?n:d.firstWeekContainsDate)&&void 0!==r?r:null===(l=d.locale)||void 0===l||null===(c=l.options)||void 0===c?void 0:c.firstWeekContainsDate)&&void 0!==i?i:1);if(!(p>=1&&p<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var f=new Date(0);f.setFullYear(h+1,0,p),f.setHours(0,0,0,0);var m=gt(f,t),g=new Date(0);g.setFullYear(h,0,p),g.setHours(0,0,0,0);var y=gt(g,t);return u.getTime()>=m.getTime()?h+1:u.getTime()>=y.getTime()?h:h-1}(e,t),p=new Date(0);return p.setFullYear(d,0,h),p.setHours(0,0,0,0),gt(p,t)}function _t(e,t){te(2,arguments);var i=ie(e),r=ie(t);return i.getTime()>r.getTime()}function vt(e,t){te(2,arguments);var i=ie(e),r=ie(t);return i.getTime()<r.getTime()}function xt(e){te(1,arguments);var t=ie(e);return t.setMinutes(0,0,0),t}function bt(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}function wt(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(e){if("string"==typeof e)return bt(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?bt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw o}}}}function St(e,t){if(null==e)throw new TypeError("assign requires that input parameter not be null or undefined");for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}function Tt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Mt(e,t){return Mt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Mt(e,t)}function At(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Mt(e,t)}function Ct(e){return Ct=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ct(e)}function Et(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Et=function(){return!!e})()}function Pt(e){var t=Et();return function(){var i,r=Ct(e);if(t){var n=Ct(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return function(e,t){if(t&&("object"==ee(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Tt(e)}(this,i)}}function kt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function It(e){var t=function(e,t){if("object"!=ee(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=ee(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ee(t)?t:t+""}function Dt(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,It(r.key),r)}}function Lt(e,t,i){return t&&Dt(e.prototype,t),i&&Dt(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rt(e,t,i){return(t=It(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var zt=function(){function e(){kt(this,e),Rt(this,"priority",void 0),Rt(this,"subPriority",0)}return Lt(e,[{key:"validate",value:function(e,t){return!0}}]),e}(),Ot=function(e){At(i,e);var t=Pt(i);function i(e,r,n,o,s){var a;return kt(this,i),(a=t.call(this)).value=e,a.validateValue=r,a.setValue=n,a.priority=o,s&&(a.subPriority=s),a}return Lt(i,[{key:"validate",value:function(e,t){return this.validateValue(e,this.value,t)}},{key:"set",value:function(e,t,i){return this.setValue(e,t,this.value,i)}}]),i}(zt),Ft=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",10),Rt(Tt(e),"subPriority",-1),e}return Lt(i,[{key:"set",value:function(e,t){if(t.timestampIsSet)return e;var i=new Date(0);return i.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),i.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),i}}]),i}(zt),Bt=function(){function e(){kt(this,e),Rt(this,"incompatibleTokens",void 0),Rt(this,"priority",void 0),Rt(this,"subPriority",void 0)}return Lt(e,[{key:"run",value:function(e,t,i,r){var n=this.parse(e,t,i,r);return n?{setter:new Ot(n.value,this.validate,this.set,this.priority,this.subPriority),rest:n.rest}:null}},{key:"validate",value:function(e,t,i){return!0}}]),e}(),Nt=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",140),Rt(Tt(e),"incompatibleTokens",["R","u","t","T"]),e}return Lt(i,[{key:"parse",value:function(e,t,i){switch(t){case"G":case"GG":case"GGG":return i.era(e,{width:"abbreviated"})||i.era(e,{width:"narrow"});case"GGGGG":return i.era(e,{width:"narrow"});default:return i.era(e,{width:"wide"})||i.era(e,{width:"abbreviated"})||i.era(e,{width:"narrow"})}}},{key:"set",value:function(e,t,i){return t.era=i,e.setUTCFullYear(i,0,1),e.setUTCHours(0,0,0,0),e}}]),i}(Bt),jt=/^(1[0-2]|0?\d)/,Vt=/^(3[0-1]|[0-2]?\d)/,Ut=/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,Gt=/^(5[0-3]|[0-4]?\d)/,Ht=/^(2[0-3]|[0-1]?\d)/,Wt=/^(2[0-4]|[0-1]?\d)/,$t=/^(1[0-1]|0?\d)/,qt=/^(1[0-2]|0?\d)/,Xt=/^[0-5]?\d/,Yt=/^[0-5]?\d/,Zt=/^\d/,Kt=/^\d{1,2}/,Jt=/^\d{1,3}/,Qt=/^\d{1,4}/,ei=/^-?\d+/,ti=/^-?\d/,ii=/^-?\d{1,2}/,ri=/^-?\d{1,3}/,ni=/^-?\d{1,4}/,oi=/^([+-])(\d{2})(\d{2})?|Z/,si=/^([+-])(\d{2})(\d{2})|Z/,ai=/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,li=/^([+-])(\d{2}):(\d{2})|Z/,ci=/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/;function ui(e,t){return e?{value:t(e.value),rest:e.rest}:e}function hi(e,t){var i=t.match(e);return i?{value:parseInt(i[0],10),rest:t.slice(i[0].length)}:null}function di(e,t){var i=t.match(e);if(!i)return null;if("Z"===i[0])return{value:0,rest:t.slice(1)};var r="+"===i[1]?1:-1,n=i[2]?parseInt(i[2],10):0,o=i[3]?parseInt(i[3],10):0,s=i[5]?parseInt(i[5],10):0;return{value:r*(n*ve+o*_e+1e3*s),rest:t.slice(i[0].length)}}function pi(e){return hi(ei,e)}function fi(e,t){switch(e){case 1:return hi(Zt,t);case 2:return hi(Kt,t);case 3:return hi(Jt,t);case 4:return hi(Qt,t);default:return hi(new RegExp("^\\d{1,"+e+"}"),t)}}function mi(e,t){switch(e){case 1:return hi(ti,t);case 2:return hi(ii,t);case 3:return hi(ri,t);case 4:return hi(ni,t);default:return hi(new RegExp("^-?\\d{1,"+e+"}"),t)}}function gi(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;default:return 0}}function yi(e,t){var i,r=t>0,n=r?t:1-t;if(n<=50)i=e||100;else{var o=n+50;i=e+100*Math.floor(o/100)-(e>=o%100?100:0)}return r?i:1-i}function _i(e){return e%400===0||e%4===0&&e%100!==0}var vi=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",130),Rt(Tt(e),"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"]),e}return Lt(i,[{key:"parse",value:function(e,t,i){var r=function(e){return{year:e,isTwoDigitYear:"yy"===t}};switch(t){case"y":return ui(fi(4,e),r);case"yo":return ui(i.ordinalNumber(e,{unit:"year"}),r);default:return ui(fi(t.length,e),r)}}},{key:"validate",value:function(e,t){return t.isTwoDigitYear||t.year>0}},{key:"set",value:function(e,t,i){var r=e.getUTCFullYear();if(i.isTwoDigitYear){var n=yi(i.year,r);return e.setUTCFullYear(n,0,1),e.setUTCHours(0,0,0,0),e}var o="era"in t&&1!==t.era?1-i.year:i.year;return e.setUTCFullYear(o,0,1),e.setUTCHours(0,0,0,0),e}}]),i}(Bt),xi=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",130),Rt(Tt(e),"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"]),e}return Lt(i,[{key:"parse",value:function(e,t,i){var r=function(e){return{year:e,isTwoDigitYear:"YY"===t}};switch(t){case"Y":return ui(fi(4,e),r);case"Yo":return ui(i.ordinalNumber(e,{unit:"year"}),r);default:return ui(fi(t.length,e),r)}}},{key:"validate",value:function(e,t){return t.isTwoDigitYear||t.year>0}},{key:"set",value:function(e,t,i,r){var n=Ie(e,r);if(i.isTwoDigitYear){var o=yi(i.year,n);return e.setUTCFullYear(o,0,r.firstWeekContainsDate),e.setUTCHours(0,0,0,0),ke(e,r)}var s="era"in t&&1!==t.era?1-i.year:i.year;return e.setUTCFullYear(s,0,r.firstWeekContainsDate),e.setUTCHours(0,0,0,0),ke(e,r)}}]),i}(Bt),bi=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",130),Rt(Tt(e),"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]),e}return Lt(i,[{key:"parse",value:function(e,t){return mi("R"===t?4:t.length,e)}},{key:"set",value:function(e,t,i){var r=new Date(0);return r.setUTCFullYear(i,0,4),r.setUTCHours(0,0,0,0),Ce(r)}}]),i}(Bt),wi=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",130),Rt(Tt(e),"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"]),e}return Lt(i,[{key:"parse",value:function(e,t){return mi("u"===t?4:t.length,e)}},{key:"set",value:function(e,t,i){return e.setUTCFullYear(i,0,1),e.setUTCHours(0,0,0,0),e}}]),i}(Bt),Si=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",120),Rt(Tt(e),"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]),e}return Lt(i,[{key:"parse",value:function(e,t,i){switch(t){case"Q":case"QQ":return fi(t.length,e);case"Qo":return i.ordinalNumber(e,{unit:"quarter"});case"QQQ":return i.quarter(e,{width:"abbreviated",context:"formatting"})||i.quarter(e,{width:"narrow",context:"formatting"});case"QQQQQ":return i.quarter(e,{width:"narrow",context:"formatting"});default:return i.quarter(e,{width:"wide",context:"formatting"})||i.quarter(e,{width:"abbreviated",context:"formatting"})||i.quarter(e,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(e,t){return t>=1&&t<=4}},{key:"set",value:function(e,t,i){return e.setUTCMonth(3*(i-1),1),e.setUTCHours(0,0,0,0),e}}]),i}(Bt),Ti=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",120),Rt(Tt(e),"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]),e}return Lt(i,[{key:"parse",value:function(e,t,i){switch(t){case"q":case"qq":return fi(t.length,e);case"qo":return i.ordinalNumber(e,{unit:"quarter"});case"qqq":return i.quarter(e,{width:"abbreviated",context:"standalone"})||i.quarter(e,{width:"narrow",context:"standalone"});case"qqqqq":return i.quarter(e,{width:"narrow",context:"standalone"});default:return i.quarter(e,{width:"wide",context:"standalone"})||i.quarter(e,{width:"abbreviated",context:"standalone"})||i.quarter(e,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(e,t){return t>=1&&t<=4}},{key:"set",value:function(e,t,i){return e.setUTCMonth(3*(i-1),1),e.setUTCHours(0,0,0,0),e}}]),i}(Bt),Mi=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]),Rt(Tt(e),"priority",110),e}return Lt(i,[{key:"parse",value:function(e,t,i){var r=function(e){return e-1};switch(t){case"M":return ui(hi(jt,e),r);case"MM":return ui(fi(2,e),r);case"Mo":return ui(i.ordinalNumber(e,{unit:"month"}),r);case"MMM":return i.month(e,{width:"abbreviated",context:"formatting"})||i.month(e,{width:"narrow",context:"formatting"});case"MMMMM":return i.month(e,{width:"narrow",context:"formatting"});default:return i.month(e,{width:"wide",context:"formatting"})||i.month(e,{width:"abbreviated",context:"formatting"})||i.month(e,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(e,t){return t>=0&&t<=11}},{key:"set",value:function(e,t,i){return e.setUTCMonth(i,1),e.setUTCHours(0,0,0,0),e}}]),i}(Bt),Ai=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",110),Rt(Tt(e),"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]),e}return Lt(i,[{key:"parse",value:function(e,t,i){var r=function(e){return e-1};switch(t){case"L":return ui(hi(jt,e),r);case"LL":return ui(fi(2,e),r);case"Lo":return ui(i.ordinalNumber(e,{unit:"month"}),r);case"LLL":return i.month(e,{width:"abbreviated",context:"standalone"})||i.month(e,{width:"narrow",context:"standalone"});case"LLLLL":return i.month(e,{width:"narrow",context:"standalone"});default:return i.month(e,{width:"wide",context:"standalone"})||i.month(e,{width:"abbreviated",context:"standalone"})||i.month(e,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(e,t){return t>=0&&t<=11}},{key:"set",value:function(e,t,i){return e.setUTCMonth(i,1),e.setUTCHours(0,0,0,0),e}}]),i}(Bt);var Ci=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",100),Rt(Tt(e),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"]),e}return Lt(i,[{key:"parse",value:function(e,t,i){switch(t){case"w":return hi(Gt,e);case"wo":return i.ordinalNumber(e,{unit:"week"});default:return fi(t.length,e)}}},{key:"validate",value:function(e,t){return t>=1&&t<=53}},{key:"set",value:function(e,t,i,r){return ke(function(e,t,i){te(2,arguments);var r=ie(e),n=Q(t),o=De(r,i)-n;return r.setUTCDate(r.getUTCDate()-7*o),r}(e,i,r),r)}}]),i}(Bt);var Ei=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",100),Rt(Tt(e),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]),e}return Lt(i,[{key:"parse",value:function(e,t,i){switch(t){case"I":return hi(Gt,e);case"Io":return i.ordinalNumber(e,{unit:"week"});default:return fi(t.length,e)}}},{key:"validate",value:function(e,t){return t>=1&&t<=53}},{key:"set",value:function(e,t,i){return Ce(function(e,t){te(2,arguments);var i=ie(e),r=Q(t),n=Pe(i)-r;return i.setUTCDate(i.getUTCDate()-7*n),i}(e,i))}}]),i}(Bt),Pi=[31,28,31,30,31,30,31,31,30,31,30,31],ki=[31,29,31,30,31,30,31,31,30,31,30,31],Ii=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",90),Rt(Tt(e),"subPriority",1),Rt(Tt(e),"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"]),e}return Lt(i,[{key:"parse",value:function(e,t,i){switch(t){case"d":return hi(Vt,e);case"do":return i.ordinalNumber(e,{unit:"date"});default:return fi(t.length,e)}}},{key:"validate",value:function(e,t){var i=_i(e.getUTCFullYear()),r=e.getUTCMonth();return i?t>=1&&t<=ki[r]:t>=1&&t<=Pi[r]}},{key:"set",value:function(e,t,i){return e.setUTCDate(i),e.setUTCHours(0,0,0,0),e}}]),i}(Bt),Di=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",90),Rt(Tt(e),"subpriority",1),Rt(Tt(e),"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]),e}return Lt(i,[{key:"parse",value:function(e,t,i){switch(t){case"D":case"DD":return hi(Ut,e);case"Do":return i.ordinalNumber(e,{unit:"date"});default:return fi(t.length,e)}}},{key:"validate",value:function(e,t){return _i(e.getUTCFullYear())?t>=1&&t<=366:t>=1&&t<=365}},{key:"set",value:function(e,t,i){return e.setUTCMonth(0,i),e.setUTCHours(0,0,0,0),e}}]),i}(Bt);function Li(e,t,i){var r,n,o,s,a,l,c,u;te(2,arguments);var h=we(),d=Q(null!==(r=null!==(n=null!==(o=null!==(s=null===i||void 0===i?void 0:i.weekStartsOn)&&void 0!==s?s:null===i||void 0===i||null===(a=i.locale)||void 0===a||null===(l=a.options)||void 0===l?void 0:l.weekStartsOn)&&void 0!==o?o:h.weekStartsOn)&&void 0!==n?n:null===(c=h.locale)||void 0===c||null===(u=c.options)||void 0===u?void 0:u.weekStartsOn)&&void 0!==r?r:0);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var p=ie(e),f=Q(t),m=((f%7+7)%7<d?7:0)+f-p.getUTCDay();return p.setUTCDate(p.getUTCDate()+m),p}var Ri=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",90),Rt(Tt(e),"incompatibleTokens",["D","i","e","c","t","T"]),e}return Lt(i,[{key:"parse",value:function(e,t,i){switch(t){case"E":case"EE":case"EEE":return i.day(e,{width:"abbreviated",context:"formatting"})||i.day(e,{width:"short",context:"formatting"})||i.day(e,{width:"narrow",context:"formatting"});case"EEEEE":return i.day(e,{width:"narrow",context:"formatting"});case"EEEEEE":return i.day(e,{width:"short",context:"formatting"})||i.day(e,{width:"narrow",context:"formatting"});default:return i.day(e,{width:"wide",context:"formatting"})||i.day(e,{width:"abbreviated",context:"formatting"})||i.day(e,{width:"short",context:"formatting"})||i.day(e,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(e,t){return t>=0&&t<=6}},{key:"set",value:function(e,t,i,r){return(e=Li(e,i,r)).setUTCHours(0,0,0,0),e}}]),i}(Bt),zi=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",90),Rt(Tt(e),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]),e}return Lt(i,[{key:"parse",value:function(e,t,i,r){var n=function(e){var t=7*Math.floor((e-1)/7);return(e+r.weekStartsOn+6)%7+t};switch(t){case"e":case"ee":return ui(fi(t.length,e),n);case"eo":return ui(i.ordinalNumber(e,{unit:"day"}),n);case"eee":return i.day(e,{width:"abbreviated",context:"formatting"})||i.day(e,{width:"short",context:"formatting"})||i.day(e,{width:"narrow",context:"formatting"});case"eeeee":return i.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return i.day(e,{width:"short",context:"formatting"})||i.day(e,{width:"narrow",context:"formatting"});default:return i.day(e,{width:"wide",context:"formatting"})||i.day(e,{width:"abbreviated",context:"formatting"})||i.day(e,{width:"short",context:"formatting"})||i.day(e,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(e,t){return t>=0&&t<=6}},{key:"set",value:function(e,t,i,r){return(e=Li(e,i,r)).setUTCHours(0,0,0,0),e}}]),i}(Bt),Oi=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",90),Rt(Tt(e),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]),e}return Lt(i,[{key:"parse",value:function(e,t,i,r){var n=function(e){var t=7*Math.floor((e-1)/7);return(e+r.weekStartsOn+6)%7+t};switch(t){case"c":case"cc":return ui(fi(t.length,e),n);case"co":return ui(i.ordinalNumber(e,{unit:"day"}),n);case"ccc":return i.day(e,{width:"abbreviated",context:"standalone"})||i.day(e,{width:"short",context:"standalone"})||i.day(e,{width:"narrow",context:"standalone"});case"ccccc":return i.day(e,{width:"narrow",context:"standalone"});case"cccccc":return i.day(e,{width:"short",context:"standalone"})||i.day(e,{width:"narrow",context:"standalone"});default:return i.day(e,{width:"wide",context:"standalone"})||i.day(e,{width:"abbreviated",context:"standalone"})||i.day(e,{width:"short",context:"standalone"})||i.day(e,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(e,t){return t>=0&&t<=6}},{key:"set",value:function(e,t,i,r){return(e=Li(e,i,r)).setUTCHours(0,0,0,0),e}}]),i}(Bt);var Fi=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",90),Rt(Tt(e),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]),e}return Lt(i,[{key:"parse",value:function(e,t,i){var r=function(e){return 0===e?7:e};switch(t){case"i":case"ii":return fi(t.length,e);case"io":return i.ordinalNumber(e,{unit:"day"});case"iii":return ui(i.day(e,{width:"abbreviated",context:"formatting"})||i.day(e,{width:"short",context:"formatting"})||i.day(e,{width:"narrow",context:"formatting"}),r);case"iiiii":return ui(i.day(e,{width:"narrow",context:"formatting"}),r);case"iiiiii":return ui(i.day(e,{width:"short",context:"formatting"})||i.day(e,{width:"narrow",context:"formatting"}),r);default:return ui(i.day(e,{width:"wide",context:"formatting"})||i.day(e,{width:"abbreviated",context:"formatting"})||i.day(e,{width:"short",context:"formatting"})||i.day(e,{width:"narrow",context:"formatting"}),r)}}},{key:"validate",value:function(e,t){return t>=1&&t<=7}},{key:"set",value:function(e,t,i){return e=function(e,t){te(2,arguments);var i=Q(t);i%7===0&&(i-=7);var r=ie(e),n=((i%7+7)%7<1?7:0)+i-r.getUTCDay();return r.setUTCDate(r.getUTCDate()+n),r}(e,i),e.setUTCHours(0,0,0,0),e}}]),i}(Bt),Bi=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",80),Rt(Tt(e),"incompatibleTokens",["b","B","H","k","t","T"]),e}return Lt(i,[{key:"parse",value:function(e,t,i){switch(t){case"a":case"aa":case"aaa":return i.dayPeriod(e,{width:"abbreviated",context:"formatting"})||i.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaaa":return i.dayPeriod(e,{width:"narrow",context:"formatting"});default:return i.dayPeriod(e,{width:"wide",context:"formatting"})||i.dayPeriod(e,{width:"abbreviated",context:"formatting"})||i.dayPeriod(e,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(e,t,i){return e.setUTCHours(gi(i),0,0,0),e}}]),i}(Bt),Ni=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",80),Rt(Tt(e),"incompatibleTokens",["a","B","H","k","t","T"]),e}return Lt(i,[{key:"parse",value:function(e,t,i){switch(t){case"b":case"bb":case"bbb":return i.dayPeriod(e,{width:"abbreviated",context:"formatting"})||i.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbbb":return i.dayPeriod(e,{width:"narrow",context:"formatting"});default:return i.dayPeriod(e,{width:"wide",context:"formatting"})||i.dayPeriod(e,{width:"abbreviated",context:"formatting"})||i.dayPeriod(e,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(e,t,i){return e.setUTCHours(gi(i),0,0,0),e}}]),i}(Bt),ji=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",80),Rt(Tt(e),"incompatibleTokens",["a","b","t","T"]),e}return Lt(i,[{key:"parse",value:function(e,t,i){switch(t){case"B":case"BB":case"BBB":return i.dayPeriod(e,{width:"abbreviated",context:"formatting"})||i.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBBB":return i.dayPeriod(e,{width:"narrow",context:"formatting"});default:return i.dayPeriod(e,{width:"wide",context:"formatting"})||i.dayPeriod(e,{width:"abbreviated",context:"formatting"})||i.dayPeriod(e,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(e,t,i){return e.setUTCHours(gi(i),0,0,0),e}}]),i}(Bt),Vi=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",70),Rt(Tt(e),"incompatibleTokens",["H","K","k","t","T"]),e}return Lt(i,[{key:"parse",value:function(e,t,i){switch(t){case"h":return hi(qt,e);case"ho":return i.ordinalNumber(e,{unit:"hour"});default:return fi(t.length,e)}}},{key:"validate",value:function(e,t){return t>=1&&t<=12}},{key:"set",value:function(e,t,i){var r=e.getUTCHours()>=12;return r&&i<12?e.setUTCHours(i+12,0,0,0):r||12!==i?e.setUTCHours(i,0,0,0):e.setUTCHours(0,0,0,0),e}}]),i}(Bt),Ui=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",70),Rt(Tt(e),"incompatibleTokens",["a","b","h","K","k","t","T"]),e}return Lt(i,[{key:"parse",value:function(e,t,i){switch(t){case"H":return hi(Ht,e);case"Ho":return i.ordinalNumber(e,{unit:"hour"});default:return fi(t.length,e)}}},{key:"validate",value:function(e,t){return t>=0&&t<=23}},{key:"set",value:function(e,t,i){return e.setUTCHours(i,0,0,0),e}}]),i}(Bt),Gi=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",70),Rt(Tt(e),"incompatibleTokens",["h","H","k","t","T"]),e}return Lt(i,[{key:"parse",value:function(e,t,i){switch(t){case"K":return hi($t,e);case"Ko":return i.ordinalNumber(e,{unit:"hour"});default:return fi(t.length,e)}}},{key:"validate",value:function(e,t){return t>=0&&t<=11}},{key:"set",value:function(e,t,i){return e.getUTCHours()>=12&&i<12?e.setUTCHours(i+12,0,0,0):e.setUTCHours(i,0,0,0),e}}]),i}(Bt),Hi=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",70),Rt(Tt(e),"incompatibleTokens",["a","b","h","H","K","t","T"]),e}return Lt(i,[{key:"parse",value:function(e,t,i){switch(t){case"k":return hi(Wt,e);case"ko":return i.ordinalNumber(e,{unit:"hour"});default:return fi(t.length,e)}}},{key:"validate",value:function(e,t){return t>=1&&t<=24}},{key:"set",value:function(e,t,i){var r=i<=24?i%24:i;return e.setUTCHours(r,0,0,0),e}}]),i}(Bt),Wi=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",60),Rt(Tt(e),"incompatibleTokens",["t","T"]),e}return Lt(i,[{key:"parse",value:function(e,t,i){switch(t){case"m":return hi(Xt,e);case"mo":return i.ordinalNumber(e,{unit:"minute"});default:return fi(t.length,e)}}},{key:"validate",value:function(e,t){return t>=0&&t<=59}},{key:"set",value:function(e,t,i){return e.setUTCMinutes(i,0,0),e}}]),i}(Bt),$i=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",50),Rt(Tt(e),"incompatibleTokens",["t","T"]),e}return Lt(i,[{key:"parse",value:function(e,t,i){switch(t){case"s":return hi(Yt,e);case"so":return i.ordinalNumber(e,{unit:"second"});default:return fi(t.length,e)}}},{key:"validate",value:function(e,t){return t>=0&&t<=59}},{key:"set",value:function(e,t,i){return e.setUTCSeconds(i,0),e}}]),i}(Bt),qi=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",30),Rt(Tt(e),"incompatibleTokens",["t","T"]),e}return Lt(i,[{key:"parse",value:function(e,t){return ui(fi(t.length,e),(function(e){return Math.floor(e*Math.pow(10,3-t.length))}))}},{key:"set",value:function(e,t,i){return e.setUTCMilliseconds(i),e}}]),i}(Bt),Xi=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",10),Rt(Tt(e),"incompatibleTokens",["t","T","x"]),e}return Lt(i,[{key:"parse",value:function(e,t){switch(t){case"X":return di(oi,e);case"XX":return di(si,e);case"XXXX":return di(ai,e);case"XXXXX":return di(ci,e);default:return di(li,e)}}},{key:"set",value:function(e,t,i){return t.timestampIsSet?e:new Date(e.getTime()-i)}}]),i}(Bt),Yi=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",10),Rt(Tt(e),"incompatibleTokens",["t","T","X"]),e}return Lt(i,[{key:"parse",value:function(e,t){switch(t){case"x":return di(oi,e);case"xx":return di(si,e);case"xxxx":return di(ai,e);case"xxxxx":return di(ci,e);default:return di(li,e)}}},{key:"set",value:function(e,t,i){return t.timestampIsSet?e:new Date(e.getTime()-i)}}]),i}(Bt),Zi=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",40),Rt(Tt(e),"incompatibleTokens","*"),e}return Lt(i,[{key:"parse",value:function(e){return pi(e)}},{key:"set",value:function(e,t,i){return[new Date(1e3*i),{timestampIsSet:!0}]}}]),i}(Bt),Ki=function(e){At(i,e);var t=Pt(i);function i(){var e;kt(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Rt(Tt(e=t.call.apply(t,[this].concat(n))),"priority",20),Rt(Tt(e),"incompatibleTokens","*"),e}return Lt(i,[{key:"parse",value:function(e){return pi(e)}},{key:"set",value:function(e,t,i){return[new Date(i),{timestampIsSet:!0}]}}]),i}(Bt),Ji={G:new Nt,y:new vi,Y:new xi,R:new bi,u:new wi,Q:new Si,q:new Ti,M:new Mi,L:new Ai,w:new Ci,I:new Ei,d:new Ii,D:new Di,E:new Ri,e:new zi,c:new Oi,i:new Fi,a:new Bi,b:new Ni,B:new ji,h:new Vi,H:new Ui,K:new Gi,k:new Hi,m:new Wi,s:new $i,S:new qi,X:new Xi,x:new Yi,t:new Zi,T:new Ki},Qi=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,er=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,tr=/^'([^]*?)'?$/,ir=/''/g,rr=/\S/,nr=/[a-zA-Z]/;function or(e,t,i,r){var n,o,s,a,l,c,u,h,d,p,f,m,g,y,_,v,x,b;te(3,arguments);var w=String(e),S=String(t),T=we(),M=null!==(n=null!==(o=null===r||void 0===r?void 0:r.locale)&&void 0!==o?o:T.locale)&&void 0!==n?n:lt;if(!M.match)throw new RangeError("locale must contain match property");var A=Q(null!==(s=null!==(a=null!==(l=null!==(c=null===r||void 0===r?void 0:r.firstWeekContainsDate)&&void 0!==c?c:null===r||void 0===r||null===(u=r.locale)||void 0===u||null===(h=u.options)||void 0===h?void 0:h.firstWeekContainsDate)&&void 0!==l?l:T.firstWeekContainsDate)&&void 0!==a?a:null===(d=T.locale)||void 0===d||null===(p=d.options)||void 0===p?void 0:p.firstWeekContainsDate)&&void 0!==s?s:1);if(!(A>=1&&A<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var C=Q(null!==(f=null!==(m=null!==(g=null!==(y=null===r||void 0===r?void 0:r.weekStartsOn)&&void 0!==y?y:null===r||void 0===r||null===(_=r.locale)||void 0===_||null===(v=_.options)||void 0===v?void 0:v.weekStartsOn)&&void 0!==g?g:T.weekStartsOn)&&void 0!==m?m:null===(x=T.locale)||void 0===x||null===(b=x.options)||void 0===b?void 0:b.weekStartsOn)&&void 0!==f?f:0);if(!(C>=0&&C<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(""===S)return""===w?ie(i):new Date(NaN);var E,P={firstWeekContainsDate:A,weekStartsOn:C,locale:M},k=[new Ft],I=S.match(er).map((function(e){var t=e[0];return t in qe?(0,qe[t])(e,M.formatLong):e})).join("").match(Qi),D=[],L=wt(I);try{var R=function(){var t=E.value;null!==r&&void 0!==r&&r.useAdditionalWeekYearTokens||!Ke(t)||Je(t,S,e),null!==r&&void 0!==r&&r.useAdditionalDayOfYearTokens||!Ze(t)||Je(t,S,e);var i=t[0],n=Ji[i];if(n){var o=n.incompatibleTokens;if(Array.isArray(o)){var s=D.find((function(e){return o.includes(e.token)||e.token===i}));if(s)throw new RangeError("The format string mustn't contain `".concat(s.fullToken,"` and `").concat(t,"` at the same time"))}else if("*"===n.incompatibleTokens&&D.length>0)throw new RangeError("The format string mustn't contain `".concat(t,"` and any other token at the same time"));D.push({token:i,fullToken:t});var a=n.run(w,t,M.match,P);if(!a)return{v:new Date(NaN)};k.push(a.setter),w=a.rest}else{if(i.match(nr))throw new RangeError("Format string contains an unescaped latin alphabet character `"+i+"`");if("''"===t?t="'":"'"===i&&(t=t.match(tr)[1].replace(ir,"'")),0!==w.indexOf(t))return{v:new Date(NaN)};w=w.slice(t.length)}};for(L.s();!(E=L.n()).done;){var z=R();if("object"===ee(z))return z.v}}catch(H){L.e(H)}finally{L.f()}if(w.length>0&&rr.test(w))return new Date(NaN);var O=k.map((function(e){return e.priority})).sort((function(e,t){return t-e})).filter((function(e,t,i){return i.indexOf(e)===t})).map((function(e){return k.filter((function(t){return t.priority===e})).sort((function(e,t){return t.subPriority-e.subPriority}))})).map((function(e){return e[0]})),F=ie(i);if(isNaN(F.getTime()))return new Date(NaN);var B,N=Ae(F,fe(F)),j={},V=wt(O);try{for(V.s();!(B=V.n()).done;){var U=B.value;if(!U.validate(N,P))return new Date(NaN);var G=U.set(N,j,P);Array.isArray(G)?(N=G[0],St(j,G[1])):N=G}}catch(H){V.e(H)}finally{V.f()}return N}function sr(e){te(1,arguments);var t=ie(e);return t.setDate(1),t.setHours(0,0,0,0),t}function ar(e){te(1,arguments);var t=ie(e),i=new Date(0);return i.setFullYear(t.getFullYear(),0,1),i.setHours(0,0,0,0),i}function lr(e,t){var i;te(1,arguments);var r=Q(null!==(i=null===t||void 0===t?void 0:t.additionalDigits)&&void 0!==i?i:2);if(2!==r&&1!==r&&0!==r)throw new RangeError("additionalDigits must be 0, 1 or 2");if("string"!==typeof e&&"[object String]"!==Object.prototype.toString.call(e))return new Date(NaN);var n,o=function(e){var t,i={},r=e.split(cr.dateTimeDelimiter);if(r.length>2)return i;/:/.test(r[0])?t=r[0]:(i.date=r[0],t=r[1],cr.timeZoneDelimiter.test(i.date)&&(i.date=e.split(cr.timeZoneDelimiter)[0],t=e.substr(i.date.length,e.length)));if(t){var n=cr.timezone.exec(t);n?(i.time=t.replace(n[1],""),i.timezone=n[1]):i.time=t}return i}(e);if(o.date){var s=function(e,t){var i=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),r=e.match(i);if(!r)return{year:NaN,restDateString:""};var n=r[1]?parseInt(r[1]):null,o=r[2]?parseInt(r[2]):null;return{year:null===o?n:100*o,restDateString:e.slice((r[1]||r[2]).length)}}(o.date,r);n=function(e,t){if(null===t)return new Date(NaN);var i=e.match(ur);if(!i)return new Date(NaN);var r=!!i[4],n=pr(i[1]),o=pr(i[2])-1,s=pr(i[3]),a=pr(i[4]),l=pr(i[5])-1;if(r)return function(e,t,i){return t>=1&&t<=53&&i>=0&&i<=6}(0,a,l)?function(e,t,i){var r=new Date(0);r.setUTCFullYear(e,0,4);var n=r.getUTCDay()||7,o=7*(t-1)+i+1-n;return r.setUTCDate(r.getUTCDate()+o),r}(t,a,l):new Date(NaN);var c=new Date(0);return function(e,t,i){return t>=0&&t<=11&&i>=1&&i<=(mr[t]||(gr(e)?29:28))}(t,o,s)&&function(e,t){return t>=1&&t<=(gr(e)?366:365)}(t,n)?(c.setUTCFullYear(t,o,Math.max(n,s)),c):new Date(NaN)}(s.restDateString,s.year)}if(!n||isNaN(n.getTime()))return new Date(NaN);var a,l=n.getTime(),c=0;if(o.time&&(c=function(e){var t=e.match(hr);if(!t)return NaN;var i=fr(t[1]),r=fr(t[2]),n=fr(t[3]);if(!function(e,t,i){if(24===e)return 0===t&&0===i;return i>=0&&i<60&&t>=0&&t<60&&e>=0&&e<25}(i,r,n))return NaN;return i*ve+r*_e+1e3*n}(o.time),isNaN(c)))return new Date(NaN);if(!o.timezone){var u=new Date(l+c),h=new Date(0);return h.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),h.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),h}return a=function(e){if("Z"===e)return 0;var t=e.match(dr);if(!t)return 0;var i="+"===t[1]?-1:1,r=parseInt(t[2]),n=t[3]&&parseInt(t[3])||0;if(!function(e,t){return t>=0&&t<=59}(0,n))return NaN;return i*(r*ve+n*_e)}(o.timezone),isNaN(a)?new Date(NaN):new Date(l+c+a)}var cr={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},ur=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,hr=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,dr=/^([+-])(\d{2})(?::?(\d{2}))?$/;function pr(e){return e?parseInt(e):1}function fr(e){return e&&parseFloat(e.replace(",","."))||0}var mr=[31,null,31,30,31,30,31,31,30,31,30,31];function gr(e){return e%400===0||e%4===0&&e%100!==0}var yr=i(6723),_r=i.n(yr);const vr={y:{sectionType:"year",contentType:"digit",maxLength:4},yy:"year",yyy:{sectionType:"year",contentType:"digit",maxLength:4},yyyy:"year",M:{sectionType:"month",contentType:"digit",maxLength:2},MM:"month",MMMM:{sectionType:"month",contentType:"letter"},MMM:{sectionType:"month",contentType:"letter"},L:{sectionType:"month",contentType:"digit",maxLength:2},LL:"month",LLL:{sectionType:"month",contentType:"letter"},LLLL:{sectionType:"month",contentType:"letter"},d:{sectionType:"day",contentType:"digit",maxLength:2},dd:"day",do:{sectionType:"day",contentType:"digit-with-letter"},E:{sectionType:"weekDay",contentType:"letter"},EE:{sectionType:"weekDay",contentType:"letter"},EEE:{sectionType:"weekDay",contentType:"letter"},EEEE:{sectionType:"weekDay",contentType:"letter"},EEEEE:{sectionType:"weekDay",contentType:"letter"},i:{sectionType:"weekDay",contentType:"digit",maxLength:1},ii:"weekDay",iii:{sectionType:"weekDay",contentType:"letter"},iiii:{sectionType:"weekDay",contentType:"letter"},e:{sectionType:"weekDay",contentType:"digit",maxLength:1},ee:"weekDay",eee:{sectionType:"weekDay",contentType:"letter"},eeee:{sectionType:"weekDay",contentType:"letter"},eeeee:{sectionType:"weekDay",contentType:"letter"},eeeeee:{sectionType:"weekDay",contentType:"letter"},c:{sectionType:"weekDay",contentType:"digit",maxLength:1},cc:"weekDay",ccc:{sectionType:"weekDay",contentType:"letter"},cccc:{sectionType:"weekDay",contentType:"letter"},ccccc:{sectionType:"weekDay",contentType:"letter"},cccccc:{sectionType:"weekDay",contentType:"letter"},a:"meridiem",aa:"meridiem",aaa:"meridiem",H:{sectionType:"hours",contentType:"digit",maxLength:2},HH:"hours",h:{sectionType:"hours",contentType:"digit",maxLength:2},hh:"hours",m:{sectionType:"minutes",contentType:"digit",maxLength:2},mm:"minutes",s:{sectionType:"seconds",contentType:"digit",maxLength:2},ss:"seconds"},xr={year:"yyyy",month:"LLLL",monthShort:"MMM",dayOfMonth:"d",weekday:"EEEE",weekdayShort:"EEEEEE",hours24h:"HH",hours12h:"hh",meridiem:"aa",minutes:"mm",seconds:"ss",fullDate:"PP",fullDateWithWeekday:"PPPP",keyboardDate:"P",shortDate:"MMM d",normalDate:"d MMMM",normalDateWithWeekday:"EEE, MMM d",monthAndYear:"LLLL yyyy",monthAndDate:"MMMM d",fullTime:"p",fullTime12h:"hh:mm aa",fullTime24h:"HH:mm",fullDateTime:"PP p",fullDateTime12h:"PP hh:mm aa",fullDateTime24h:"PP HH:mm",keyboardDateTime:"P p",keyboardDateTime12h:"P hh:mm aa",keyboardDateTime24h:"P HH:mm"};class br{constructor(e){this.isMUIAdapter=!0,this.isTimezoneCompatible=!1,this.lib="date-fns",this.locale=void 0,this.formats=void 0,this.formatTokenMap=vr,this.escapedCharacters={start:"'",end:"'"},this.longFormatters=void 0,this.date=e=>"undefined"===typeof e?new Date:null===e?null:new Date(e),this.dateWithTimezone=e=>this.date(e),this.getTimezone=()=>"default",this.setTimezone=e=>e,this.toJsDate=e=>e,this.getCurrentLocaleCode=()=>{var e;return(null==(e=this.locale)?void 0:e.code)||"en-US"},this.is12HourCycleInCurrentLocale=()=>!this.locale||/a/.test(this.locale.formatLong.time({width:"short"})),this.expandFormat=e=>e.match(/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g).map((e=>{const t=e[0];if("p"===t||"P"===t){return(0,this.longFormatters[t])(e,this.locale.formatLong)}return e})).join(""),this.getFormatHelperText=e=>this.expandFormat(e).replace(/(aaa|aa|a)/g,"(a|p)m").toLocaleLowerCase(),this.isNull=e=>null===e,this.formatNumber=e=>e,this.getMeridiemText=e=>"am"===e?"AM":"PM";const{locale:t,formats:i,longFormatters:r}=e;this.locale=t,this.formats=(0,n.A)({},xr,i),this.longFormatters=r}}const wr={cropinfo:{grass:{label:"Grass Reference",Lini:0,Ldev:0,Lmid:240,Llate:0,Kcini:1,Kcmid:1,Kcend:1},cereals:{label:"Cereals",Lini:20,Ldev:35,Lmid:60,Llate:25,Kcini:.3,Kcmid:1.15,Kcend:.3},forages:{label:"Forages",Lini:10,Ldev:15,Lmid:20,Llate:10,Kcini:.4,Kcmid:1.2,Kcend:1.1},grapes:{label:"Grapes (wine)",Lini:30,Ldev:60,Lmid:40,Llate:80,Kcini:.3,Kcmid:.7,Kcend:.45},legumes:{label:"Legumes",Lini:20,Ldev:30,Lmid:30,Llate:10,Kcini:.5,Kcmid:1.1,Kcend:1},rootstubers:{label:"Roots and Tubers",Lini:20,Ldev:30,Lmid:50,Llate:20,Kcini:.5,Kcmid:1.15,Kcend:.7},vegsmallshort:{label:"Vegetables (Small) - Short Season",Lini:20,Ldev:35,Lmid:35,Llate:10,Kcini:.7,Kcmid:1.05,Kcend:.95},vegsmalllong:{label:"Vegetables (Small) - Long Season",Lini:30,Ldev:45,Lmid:75,Llate:30,Kcini:.7,Kcmid:1.05,Kcend:.95},vegsolanum:{label:"Vegetables (Solanum Family)",Lini:30,Ldev:40,Lmid:80,Llate:30,Kcini:.6,Kcmid:1.15,Kcend:.8},vegcucumber:{label:"Vegetables (Cucumber Family)",Lini:25,Ldev:40,Lmid:35,Llate:20,Kcini:.5,Kcmid:1,Kcend:.8}},soildata:{labels:{high:"High (Clay)",medium:"Medium (Loam)",low:"Low (Sand)"},soilmoistureoptions:{low:{wiltingpoint:1,prewiltingpoint:1.15,stressthreshold:1.5,fieldcapacity:2,saturation:5},medium:{wiltingpoint:2,prewiltingpoint:2.225,stressthreshold:2.8,fieldcapacity:3.5,saturation:5.5},high:{wiltingpoint:3,prewiltingpoint:3.3,stressthreshold:4,fieldcapacity:5,saturation:6.5}},soildrainageoptions:{low:{daysToDrainToFcFromSat:.125},medium:{daysToDrainToFcFromSat:1},high:{daysToDrainToFcFromSat:2}}}};function Sr(e){return wr.soildata.soilmoistureoptions[e].fieldcapacity-wr.soildata.soilmoistureoptions[e].wiltingpoint}function Tr(e,t){var i=null;return i=(e*=-1)<=.5*t?1:(t-e)/(.5*t),i=Math.max(i,0)}function Mr(e,t){var i=wr.cropinfo[t].Lini,r=wr.cropinfo[t].Ldev,n=wr.cropinfo[t].Lmid,o=wr.cropinfo[t].Llate,s=wr.cropinfo[t].Kcini,a=wr.cropinfo[t].Kcmid,l=wr.cropinfo[t].Kcend;return e<=i?s:e>i&&e<i+r?s+(e-i)*(a-s)/r:e>=i+r&&e<=i+r+n?a:e>i+r+n&&e<i+r+n+o?a-(e-(i+r+n))*(a-l)/o:l}function Ar(e,t,i,r,n,o,s,a,l){var c,u=null,h=null,d=null,p=null,f=null,m=null,g=null,y=null,_=null,v=null,x=null,b=null,w=[],S=[],T=[],M=[],A=[],C=[];u=i,w.push(u),S.push(null),T.push(null),M.push(null),C.push(null),A.push(null),c=function(e){return(wr.soildata.soilmoistureoptions[e].saturation-wr.soildata.soilmoistureoptions[e].fieldcapacity)/wr.soildata.soildrainageoptions[e].daysToDrainToFcFromSat}(s),h=Math.floor((Date.parse(r)-Date.parse(n))/864e5);for(var E=l?0:1;E<t.length;E++){o===E&&(u=0),h+=1,d=Tr(u,Sr(s)),p=Mr(h,a),f=0,m=0,y=-1*t[E]*p*d,_=(g=e[E])/24,v=-1*y/24,b=c/24;for(var P=1;P<=24;P++)f-=x=u>0?Math.min(u,b):0,m-=Math.max(u+_-v-x-(wr.soildata.soilmoistureoptions[s].saturation-wr.soildata.soilmoistureoptions[s].fieldcapacity),0),u=Math.min(u+_-v-x,wr.soildata.soilmoistureoptions[s].saturation-wr.soildata.soilmoistureoptions[s].fieldcapacity),u=Math.max(u,-1*(wr.soildata.soilmoistureoptions[s].fieldcapacity-wr.soildata.soilmoistureoptions[s].wiltingpoint));S.push(u-w[w.length-1]),w.push(u),T.push(f),M.push(m),C.push(y),A.push(g)}return l?{deficitDailyChange:S.slice(1),deficitDaily:w.slice(1),drainageDaily:T.slice(1),runoffDaily:M.slice(1),petDaily:C.slice(1),precipDaily:A.slice(1)}:{deficitDailyChange:S,deficitDaily:w,drainageDaily:T,runoffDaily:M,petDaily:C,precipDaily:A}}const Cr="WATER-DEF-FORECAST",Er=[0,10,25,50,75,90,100],Pr="https://precip-outlook.rcc-acis.workers.dev/getOutlook",kr="https://grid2.rcc-acis.org/GridData",Ir=(e,t)=>`https://csf-irrigation-api-worker.rcc-acis.workers.dev/?lat=${e[1]}&lon=${e[0]}&year=${t}`,Dr=new Date,Lr=Dr.getFullYear(),Rr=Lr-(vt(Dr,new Date(`${Lr}-03-01`))?1:0),zr=(0,e.createContext)({toolName:Cr,cropInfo:wr.cropinfo,soilData:wr.soildata,percentiles:Er,fcstUrl:Pr,acisUrl:kr,petUrlCreator:Ir,today:Dr,seasonStartYear:Rr}),Or=e=>{let{children:t}=e;const i={toolName:Cr,cropInfo:wr.cropinfo,soilData:wr.soildata,percentiles:Er,fcstUrl:Pr,acisUrl:kr,petUrlCreator:Ir,today:Dr,seasonStartYear:Rr};return(0,Y.jsx)(zr.Provider,{value:i,children:t})},Fr=(0,e.createContext)({locations:{},selectedLocation:null,updateStoredLocations:()=>null,selectedLocationInfo:null}),Br=t=>{let{children:i}=t;const{toolName:r}=(0,e.useContext)(zr),n=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const i=localStorage.getItem(`${r}.${e}`);return i&&t?JSON.parse(i):i},o=function(e,t){!(arguments.length>2&&void 0!==arguments[2])||arguments[2]?localStorage.setItem(`${r}.${e}`,JSON.stringify(t)):localStorage.setItem(`${r}.${e}`,t)},[s,a]=(0,e.useState)(n("locations")||{}),[l,c]=(0,e.useState)(n("selected",!1)||""),u={locations:s,selectedLocation:l,updateStoredLocations:(e,t)=>{o("selected",e,!1),o("locations",t),a(t),c(e)},selectedLocationInfo:l&&l in s?s[l]:null};return(0,Y.jsx)(Fr.Provider,{value:u,children:i})};var Nr=i(879),jr=i.n(Nr);const Vr=e.createContext(null);function Ur(e,t){if(e===t)return!0;if(!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!Ur(e[i],t[i]))return!1;return!0}if(Array.isArray(t))return!1;if("object"===typeof e&&"object"===typeof t){const i=Object.keys(e),r=Object.keys(t);if(i.length!==r.length)return!1;for(const n of i){if(!t.hasOwnProperty(n))return!1;if(!Ur(e[n],t[n]))return!1}return!0}return!1}function Gr(e,t){if(!e.getProjection)return;const i=e.getProjection();Ur(i,t.getProjection())||t.setProjection(i)}function Hr(e){return{longitude:e.center.lng,latitude:e.center.lat,zoom:e.zoom,pitch:e.pitch,bearing:e.bearing,padding:e.padding}}function Wr(e,t){const i=t.viewState||t;let r=!1;if("zoom"in i){const t=e.zoom;e.zoom=i.zoom,r=r||t!==e.zoom}if("bearing"in i){const t=e.bearing;e.bearing=i.bearing,r=r||t!==e.bearing}if("pitch"in i){const t=e.pitch;e.pitch=i.pitch,r=r||t!==e.pitch}if(i.padding&&!e.isPaddingEqual(i.padding)&&(r=!0,e.padding=i.padding),"longitude"in i&&"latitude"in i){const t=e.center;e.center=new t.constructor(i.longitude,i.latitude),r=r||t!==e.center}return r}const $r=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function qr(e){if(!e)return null;if("string"===typeof e)return e;if("toJS"in e&&(e=e.toJS()),!e.layers)return e;const t={};for(const r of e.layers)t[r.id]=r;const i=e.layers.map((e=>{let i=null;"interactive"in e&&(i=Object.assign({},e),delete i.interactive);const r=t[e.ref];if(r){i=i||Object.assign({},e),delete i.ref;for(const e of $r)e in r&&(i[e]=r[e])}return i||e}));return{...e,layers:i}}const Xr={version:8,sources:{},layers:[]},Yr={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},Zr={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},Kr={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},Jr=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],Qr=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class en{constructor(e,t,i){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=e=>{const t=this.props[Kr[e.type]];t?t(e):"error"===e.type&&console.error(e.error)},this._onPointerEvent=e=>{"mousemove"!==e.type&&"mouseout"!==e.type||this._updateHover(e);const t=this.props[Yr[e.type]];t&&(this.props.interactiveLayerIds&&"mouseover"!==e.type&&"mouseout"!==e.type&&(e.features=this._hoveredFeatures||this._queryRenderedFeatures(e.point)),t(e),delete e.features)},this._onCameraEvent=e=>{if(!this._internalUpdate){const t=this.props[Zr[e.type]];t&&t(e)}e.type in this._deferredEvents&&(this._deferredEvents[e.type]=!1)},this._MapClass=e,this.props=t,this._initialize(i)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const t=this.props;this.props=e;const i=this._updateSettings(e,t);i&&this._createShadowTransform(this._map);const r=this._updateSize(e),n=this._updateViewState(e,!0);this._updateStyle(e,t),this._updateStyleComponents(e,t),this._updateHandlers(e,t),(i||r||n&&!this._map.isMoving())&&this.redraw()}static reuse(e,t){const i=en.savedMaps.pop();if(!i)return null;const r=i.map,n=r.getContainer();for(t.className=n.className;n.childNodes.length>0;)t.appendChild(n.childNodes[0]);r._container=t;const o=r._resizeObserver;o&&(o.disconnect(),o.observe(t)),i.setProps({...e,styleDiffing:!1}),r.resize();const{initialViewState:s}=e;return s&&(s.bounds?r.fitBounds(s.bounds,{...s.fitBoundsOptions,duration:0}):i._updateViewState(s,!1)),r.isStyleLoaded()?r.fire("load"):r.once("styledata",(()=>r.fire("load"))),r._update(),i}_initialize(e){const{props:t}=this,{mapStyle:i=Xr}=t,r={...t,...t.initialViewState,accessToken:t.mapboxAccessToken||tn()||null,container:e,style:qr(i)},n=r.initialViewState||r.viewState||r;if(Object.assign(r,{center:[n.longitude||0,n.latitude||0],zoom:n.zoom||0,pitch:n.pitch||0,bearing:n.bearing||0}),t.gl){const e=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=e,t.gl)}const o=new this._MapClass(r);n.padding&&o.setPadding(n.padding),t.cursor&&(o.getCanvas().style.cursor=t.cursor),this._createShadowTransform(o);const s=o._render;o._render=e=>{this._inRender=!0,s.call(o,e),this._inRender=!1};const a=o._renderTaskQueue.run;o._renderTaskQueue.run=e=>{a.call(o._renderTaskQueue,e),this._onBeforeRepaint()},o.on("render",(()=>this._onAfterRepaint()));const l=o.fire;o.fire=this._fireEvent.bind(this,l),o.on("resize",(()=>{this._renderTransform.resize(o.transform.width,o.transform.height)})),o.on("styledata",(()=>{this._updateStyleComponents(this.props,{}),Gr(o.transform,this._renderTransform)})),o.on("sourcedata",(()=>this._updateStyleComponents(this.props,{})));for(const c in Yr)o.on(c,this._onPointerEvent);for(const c in Zr)o.on(c,this._onCameraEvent);for(const c in Kr)o.on(c,this._onEvent);this._map=o}recycle(){const e=this.map.getContainer().querySelector("[mapboxgl-children]");null===e||void 0===e||e.remove(),en.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const t=function(e){const t=e.clone();return t.pixelsToGLUnits=e.pixelsToGLUnits,t}(e.transform);e.painter.transform=t,this._renderTransform=t}_updateSize(e){const{viewState:t}=e;if(t){const e=this._map;if(t.width!==e.transform.width||t.height!==e.transform.height)return e.resize(),!0}return!1}_updateViewState(e,t){if(this._internalUpdate)return!1;const i=this._map,r=this._renderTransform,{zoom:n,pitch:o,bearing:s}=r,a=i.isMoving();a&&(r.cameraElevationReference="sea");const l=Wr(r,{...Hr(i.transform),...e});if(a&&(r.cameraElevationReference="ground"),l&&t){const e=this._deferredEvents;e.move=!0,e.zoom||(e.zoom=n!==r.zoom),e.rotate||(e.rotate=s!==r.bearing),e.pitch||(e.pitch=o!==r.pitch)}return a||Wr(i.transform,e),l}_updateSettings(e,t){const i=this._map;let r=!1;for(const n of Jr)if(n in e&&!Ur(e[n],t[n])){r=!0;const t=i[`set${n[0].toUpperCase()}${n.slice(1)}`];null===t||void 0===t||t.call(i,e[n])}return r}_updateStyle(e,t){if(e.cursor!==t.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==t.mapStyle){const{mapStyle:t=Xr,styleDiffing:i=!0}=e,r={diff:i};return"localIdeographFontFamily"in e&&(r.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(qr(t),r),!0}return!1}_updateStyleComponents(e,t){const i=this._map;let r=!1;return i.isStyleLoaded()&&("light"in e&&i.setLight&&!Ur(e.light,t.light)&&(r=!0,i.setLight(e.light)),"fog"in e&&i.setFog&&!Ur(e.fog,t.fog)&&(r=!0,i.setFog(e.fog)),"terrain"in e&&i.setTerrain&&!Ur(e.terrain,t.terrain)&&(e.terrain&&!i.getSource(e.terrain.source)||(r=!0,i.setTerrain(e.terrain)))),r}_updateHandlers(e,t){var i,r;const n=this._map;let o=!1;for(const s of Qr){const a=null===(i=e[s])||void 0===i||i;Ur(a,null===(r=t[s])||void 0===r||r)||(o=!0,a?n[s].enable(a):n[s].disable())}return o}_queryRenderedFeatures(e){const t=this._map,i=t.transform,{interactiveLayerIds:r=[]}=this.props;try{return t.transform=this._renderTransform,t.queryRenderedFeatures(e,{layers:r.filter(t.getLayer.bind(t))})}catch(n){return[]}finally{t.transform=i}}_updateHover(e){var t;const{props:i}=this;if(i.interactiveLayerIds&&(i.onMouseMove||i.onMouseEnter||i.onMouseLeave)){const i=e.type,r=(null===(t=this._hoveredFeatures)||void 0===t?void 0:t.length)>0,n=this._queryRenderedFeatures(e.point),o=n.length>0;!o&&r&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=n,o&&!r&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=i}else this._hoveredFeatures=null}_fireEvent(e,t,i){const r=this._map,n=r.transform,o="string"===typeof t?t:t.type;return"move"===o&&this._updateViewState(this.props,!1),o in Zr&&("object"===typeof t&&(t.viewState=Hr(n)),this._map.isMoving())?(r.transform=this._renderTransform,e.call(r,t,i),r.transform=n,r):(e.call(r,t,i),r)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const i in this._deferredEvents)this._deferredEvents[i]&&e.fire(i);this._internalUpdate=!1;const t=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{Gr(this._renderTransform,t),e.transform=t}}}function tn(){let e=null;if("undefined"!==typeof location){const t=/access_token=([^&\/]*)/.exec(location.search);e=t&&t[1]}try{e=e||{NODE_ENV:"production",PUBLIC_URL:"/water-def-forecast",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_MAPBOX_TOKEN:"pk.eyJ1IjoiaWRmY3VydmV0b29sYWRtaW4iLCJhIjoiY2xkdGFmZTd4MDJ3ZDNxb3h5dXdrb3cwbSJ9.-57RGzVhzLpxzp2WsX9xDQ"}.MapboxAccessToken}catch(t){}try{e=e||{NODE_ENV:"production",PUBLIC_URL:"/water-def-forecast",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_MAPBOX_TOKEN:"pk.eyJ1IjoiaWRmY3VydmV0b29sYWRtaW4iLCJhIjoiY2xkdGFmZTd4MDJ3ZDNxb3h5dXdrb3cwbSJ9.-57RGzVhzLpxzp2WsX9xDQ"}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch(i){}return e}en.savedMaps=[];const rn=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function nn(e){if(!e)return null;const t=e.map,i={getMap:()=>t,getCenter:()=>e.transform.center,getZoom:()=>e.transform.zoom,getBearing:()=>e.transform.bearing,getPitch:()=>e.transform.pitch,getPadding:()=>e.transform.padding,getBounds:()=>e.transform.getBounds(),project:i=>{const r=t.transform;t.transform=e.transform;const n=t.project(i);return t.transform=r,n},unproject:i=>{const r=t.transform;t.transform=e.transform;const n=t.unproject(i);return t.transform=r,n},queryTerrainElevation:(i,r)=>{const n=t.transform;t.transform=e.transform;const o=t.queryTerrainElevation(i,r);return t.transform=n,o},queryRenderedFeatures:(i,r)=>{const n=t.transform;t.transform=e.transform;const o=t.queryRenderedFeatures(i,r);return t.transform=n,o}};for(const r of function(e){const t=new Set;let i=e;for(;i;){for(const r of Object.getOwnPropertyNames(i))"_"!==r[0]&&"function"===typeof e[r]&&"fire"!==r&&"setEventedParent"!==r&&t.add(r);i=Object.getPrototypeOf(i)}return Array.from(t)}(t))r in i||rn.includes(r)||(i[r]=t[r].bind(t));return i}const on="undefined"!==typeof document?e.useLayoutEffect:e.useEffect,sn=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];const an=e.createContext(null);function ln(t,i,r){const n=(0,e.useContext)(Vr),[o,s]=(0,e.useState)(null),a=(0,e.useRef)(),{current:l}=(0,e.useRef)({mapLib:null,map:null});(0,e.useEffect)((()=>{const e=t.mapLib;let i,o=!0;return Promise.resolve(e||r).then((e=>{if(!o)return;if(!e)throw new Error("Invalid mapLib");const r="Map"in e?e:e.default;if(!r.Map)throw new Error("Invalid mapLib");if(function(e,t){for(const r of sn)r in t&&(e[r]=t[r]);const{RTLTextPlugin:i="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=t;i&&e.getRTLTextPluginStatus&&"unavailable"===e.getRTLTextPluginStatus()&&e.setRTLTextPlugin(i,(e=>{e&&console.error(e)}),!0)}(r,t),r.supported&&!r.supported(t))throw new Error("Map is not supported by this browser");t.reuseMaps&&(i=en.reuse(t,a.current)),i||(i=new en(r.Map,t,a.current)),l.map=nn(i),l.mapLib=r,s(i),null===n||void 0===n||n.onMapMount(l.map,t.id)})).catch((e=>{const{onError:i}=t;i?i({type:"error",target:null,originalEvent:null,error:e}):console.error(e)})),()=>{o=!1,i&&(null===n||void 0===n||n.onMapUnmount(t.id),t.reuseMaps?i.recycle():i.destroy())}}),[]),on((()=>{o&&o.setProps(t)})),(0,e.useImperativeHandle)(i,(()=>l.map),[o]);const c=(0,e.useMemo)((()=>({position:"relative",width:"100%",height:"100%",...t.style})),[t.style]);return e.createElement("div",{id:t.id,ref:a,style:c},o&&e.createElement(an.Provider,{value:l},e.createElement("div",{"mapboxgl-children":"",style:{height:"100%"}},t.children)))}var cn=i(7950);const un=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function hn(e,t){if(!e||!t)return;const i=e.style;for(const r in t){const e=t[r];Number.isFinite(e)&&!un.test(r)?i[r]=`${e}px`:i[r]=e}}const dn=(0,e.memo)((0,e.forwardRef)((function(t,i){const{map:r,mapLib:n}=(0,e.useContext)(an),o=(0,e.useRef)({props:t});o.current.props=t;const s=(0,e.useMemo)((()=>{let i=!1;e.Children.forEach(t.children,(e=>{e&&(i=!0)}));const r={...t,element:i?document.createElement("div"):null},a=new n.Marker(r);return a.setLngLat([t.longitude,t.latitude]),a.getElement().addEventListener("click",(e=>{var t,i;null===(i=(t=o.current.props).onClick)||void 0===i||i.call(t,{type:"click",target:a,originalEvent:e})})),a.on("dragstart",(e=>{var t,i;const r=e;r.lngLat=s.getLngLat(),null===(i=(t=o.current.props).onDragStart)||void 0===i||i.call(t,r)})),a.on("drag",(e=>{var t,i;const r=e;r.lngLat=s.getLngLat(),null===(i=(t=o.current.props).onDrag)||void 0===i||i.call(t,r)})),a.on("dragend",(e=>{var t,i;const r=e;r.lngLat=s.getLngLat(),null===(i=(t=o.current.props).onDragEnd)||void 0===i||i.call(t,r)})),a}),[]);(0,e.useEffect)((()=>(s.addTo(r.getMap()),()=>{s.remove()})),[]);const{longitude:a,latitude:l,offset:c,style:u,draggable:h=!1,popup:d=null,rotation:p=0,rotationAlignment:f="auto",pitchAlignment:m="auto"}=t;return(0,e.useEffect)((()=>{hn(s.getElement(),u)}),[u]),(0,e.useImperativeHandle)(i,(()=>s),[]),s.getLngLat().lng===a&&s.getLngLat().lat===l||s.setLngLat([a,l]),c&&!function(e,t){const i=Array.isArray(e)?e[0]:e?e.x:0,r=Array.isArray(e)?e[1]:e?e.y:0,n=Array.isArray(t)?t[0]:t?t.x:0,o=Array.isArray(t)?t[1]:t?t.y:0;return i===n&&r===o}(s.getOffset(),c)&&s.setOffset(c),s.isDraggable()!==h&&s.setDraggable(h),s.getRotation()!==p&&s.setRotation(p),s.getRotationAlignment()!==f&&s.setRotationAlignment(f),s.getPitchAlignment()!==m&&s.setPitchAlignment(m),s.getPopup()!==d&&s.setPopup(d),(0,cn.createPortal)(t.children,s.getElement())})));function pn(e){return new Set(e?e.trim().split(/\s+/):[])}const fn=(0,e.memo)((0,e.forwardRef)((function(t,i){const{map:r,mapLib:n}=(0,e.useContext)(an),o=(0,e.useMemo)((()=>document.createElement("div")),[]),s=(0,e.useRef)({props:t});s.current.props=t;const a=(0,e.useMemo)((()=>{const e={...t},i=new n.Popup(e);return i.setLngLat([t.longitude,t.latitude]),i.once("open",(e=>{var t,i;null===(i=(t=s.current.props).onOpen)||void 0===i||i.call(t,e)})),i}),[]);if((0,e.useEffect)((()=>{const e=e=>{var t,i;null===(i=(t=s.current.props).onClose)||void 0===i||i.call(t,e)};return a.on("close",e),a.setDOMContent(o).addTo(r.getMap()),()=>{a.off("close",e),a.isOpen()&&a.remove()}}),[]),(0,e.useEffect)((()=>{hn(a.getElement(),t.style)}),[t.style]),(0,e.useImperativeHandle)(i,(()=>a),[]),a.isOpen()&&(a.getLngLat().lng===t.longitude&&a.getLngLat().lat===t.latitude||a.setLngLat([t.longitude,t.latitude]),t.offset&&!Ur(a.options.offset,t.offset)&&a.setOffset(t.offset),a.options.anchor===t.anchor&&a.options.maxWidth===t.maxWidth||(a.options.anchor=t.anchor,a.setMaxWidth(t.maxWidth)),a.options.className!==t.className)){const e=pn(a.options.className),i=pn(t.className);for(const t of e)i.has(t)||a.removeClassName(t);for(const t of i)e.has(t)||a.addClassName(t);a.options.className=t.className}return(0,cn.createPortal)(t.children,o)})));const mn=function(t,i,r,n){const o=(0,e.useContext)(an),s=(0,e.useMemo)((()=>t(o)),[]);return(0,e.useEffect)((()=>{const e=n||r||i,t="function"===typeof i&&"function"===typeof r?i:null,a="function"===typeof r?r:"function"===typeof i?i:null,{map:l}=o;return l.hasControl(s)||(l.addControl(s,null===e||void 0===e?void 0:e.position),t&&t(o)),()=>{a&&a(o),l.hasControl(s)&&l.removeControl(s)}}),[]),s};(0,e.memo)((function(t){const i=mn((e=>{let{mapLib:i}=e;return new i.AttributionControl(t)}),{position:t.position});return(0,e.useEffect)((()=>{hn(i._container,t.style)}),[t.style]),null}));(0,e.memo)((function(t){const i=mn((e=>{let{mapLib:i}=e;return new i.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)})}),{position:t.position});return(0,e.useEffect)((()=>{hn(i._controlContainer,t.style)}),[t.style]),null}));(0,e.memo)((0,e.forwardRef)((function(t,i){const r=(0,e.useRef)({props:t}),n=mn((e=>{let{mapLib:i}=e;const n=new i.GeolocateControl(t),o=n._setupUI;return n._setupUI=e=>{n._container.hasChildNodes()||o(e)},n.on("geolocate",(e=>{var t,i;null===(i=(t=r.current.props).onGeolocate)||void 0===i||i.call(t,e)})),n.on("error",(e=>{var t,i;null===(i=(t=r.current.props).onError)||void 0===i||i.call(t,e)})),n.on("outofmaxbounds",(e=>{var t,i;null===(i=(t=r.current.props).onOutOfMaxBounds)||void 0===i||i.call(t,e)})),n.on("trackuserlocationstart",(e=>{var t,i;null===(i=(t=r.current.props).onTrackUserLocationStart)||void 0===i||i.call(t,e)})),n.on("trackuserlocationend",(e=>{var t,i;null===(i=(t=r.current.props).onTrackUserLocationEnd)||void 0===i||i.call(t,e)})),n}),{position:t.position});return r.current.props=t,(0,e.useImperativeHandle)(i,(()=>n),[]),(0,e.useEffect)((()=>{hn(n._container,t.style)}),[t.style]),null})));(0,e.memo)((function(t){const i=mn((e=>{let{mapLib:i}=e;return new i.NavigationControl(t)}),{position:t.position});return(0,e.useEffect)((()=>{hn(i._container,t.style)}),[t.style]),null}));(0,e.memo)((function(t){const i=mn((e=>{let{mapLib:i}=e;return new i.ScaleControl(t)}),{position:t.position}),r=(0,e.useRef)(t),n=r.current;r.current=t;const{style:o}=t;return void 0!==t.maxWidth&&t.maxWidth!==n.maxWidth&&(i.options.maxWidth=t.maxWidth),void 0!==t.unit&&t.unit!==n.unit&&i.setUnit(t.unit),(0,e.useEffect)((()=>{hn(i._container,o)}),[o]),null}));const gn=Promise.resolve().then(i.t.bind(i,879,23)),yn=e.forwardRef((function(e,t){return ln(e,t,gn)})),_n=dn,vn=fn,xn=yn;function bn(e){return(0,Y.jsx)(Y.Fragment,{children:Object.keys(e.pastLocations).map((t=>{const i=e.pastLocations[t],r=i.id===e.currentLocation.id;return(0,Y.jsx)(_n,{longitude:i.lng,latitude:i.lat,onClick:t=>e.onMarkerClick(t,i),style:{zIndex:r?2:1,top:-20},children:(0,Y.jsx)("div",{className:r?"loc-curr-marker":"loc-marker",onMouseEnter:()=>e.onMarkerMouseEnter({...i,isSelected:r}),onMouseLeave:e.onMarkerMouseLeave,onContextMenu:()=>e.onMarkerRightClick(i,r)})},i.address)}))})}function wn(e,t){"string"===typeof e&&(e=parseFloat(e));const i=(Math.round(Math.round(e*Math.pow(10,t+1))/10)/Math.pow(10,t)).toFixed(t);return parseFloat(i)}function Sn(e){let t=1/0,i=-1/0,r=1/0,n=-1/0;Object.values(e).forEach((e=>{e.lat>i&&(i=e.lat),e.lat<t&&(t=e.lat),e.lng>n&&(n=e.lng),e.lng<r&&(r=e.lng)}));const o=.1;return t===i&&(t-=o,i+=o),r===n&&(r-=o,n+=o),[r,t,n,i]}function Tn(t){jr().accessToken=t.token;const[i,r]=(0,e.useState)(null),[n,o]=(0,e.useState)({bounds:Sn(t.pastLocations),fitBoundsOptions:{padding:{top:100,bottom:10,left:15,right:15}}});return(0,Y.jsx)("div",{id:"loc-map",children:(0,Y.jsxs)(xn,{...n,ref:t.mapRef,mapStyle:"mapbox://styles/mapbox/satellite-streets-v11",boxZoom:!1,dragRotate:!1,touchPitch:!1,doubleClickZoom:!1,attributionControl:!1,onMove:e=>{return((i=e.viewState).latitude>t.bbox.north||i.latitude<t.bbox.south)&&(i.latitude=n.latitude),(i.longitude>t.bbox.east||i.longitude<t.bbox.west)&&(i.longitude=n.longitude),void o((e=>({...e,...i})));var i},onClick:async e=>{const i=e.lngLat.lng,r=e.lngLat.lat;if(i>=t.bbox.west&&i<=t.bbox.east&&r>=t.bbox.south&&r<=t.bbox.north){const e=await function(e,t,i,r){return fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${e},${t}.json?limit=1&access_token=${i}`,{method:"GET"}).then((e=>e.json())).then((i=>{const n=i.features[0].context.find((e=>"region"===e.id.split(".")[0]));if(r&&!r.includes(n.text))throw new Error("Out of Bounds");return{address:i.features[0].place_name.replace(", United States","").replace(/\s\d{5}/g,""),lng:e,lat:t}})).catch((()=>!1))}(i,r,t.token,t.allowedStates);e&&t.mapRef.current&&(t.handleChangeLocations("add",e),t.mapRef.current.flyTo({center:[e.lng,e.lat],speed:.8,essential:!0}))}},children:[(0,Y.jsx)(bn,{currentLocation:t.currentLocation,pastLocations:t.pastLocations,onMarkerMouseEnter:e=>{r(e)},onMarkerMouseLeave:()=>{r(null)},onMarkerClick:(e,i)=>{e.originalEvent.stopPropagation(),t.handleChangeLocations("change",i)},onMarkerRightClick:(e,i)=>{i||(t.handleChangeLocations("remove",e),r(null))}}),i&&(0,Y.jsxs)(vn,{longitude:i.lng,latitude:i.lat,closeOnClick:!1,closeButton:!1,onClose:()=>r(null),offset:{center:[0,0],left:[12,0],right:[-12,0],top:[0,-6],"top-left":[10,3],"top-right":[-20,3],bottom:[0,-16],"bottom-left":[10,-12],"bottom-right":[-20,-12]},style:{zIndex:4},children:[(0,Y.jsx)("h3",{children:i.address}),(0,Y.jsxs)("h4",{children:["Coordinates: ",wn(i.lng,5),", ",wn(i.lat,5)]}),i.isSelected?"":(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)("h5",{children:"Click to Use"}),"ontouchstart"in window||navigator.maxTouchPoints>0?(0,Y.jsx)("h5",{children:"Click and Hold to Remove"}):(0,Y.jsx)("h5",{children:"Right Click to Remove"})]})]})]})})}function Mn(t){const[i,r]=(0,e.useState)(""),n=()=>{fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${i.split(" ").join("%20")}.json?proximity=-75.37,43.21&country=US&types=postcode,place,address&access_token=${t.token}`,{method:"GET"}).then((e=>e.json())).then((e=>{const i=e.features.reduce(((e,i)=>{const r=i.context.find((e=>e.id.includes("region")&&(!t.allowedStates||t.allowedStates.includes(e.text))));if(!e&&r&&i.center[0]>=t.bbox.west&&i.center[1]>=t.bbox.south){const e=i.place_type[0];let t;if("postcode"===e)t=i.place_name.split(",").slice(0,2).join(",");else if("place"===e)t=`${i.text}, ${r.text}`;else if("address"===e){const e=i.context.find((e=>e.id.includes("place")));t=`${i.text}, ${e.text}, ${r.text}`}return{address:t,lng:i.center[0],lat:i.center[1]}}return e}),!1);i&&(r(i.address),t.handleChangeLocations("add",i),t.mapRef.current.flyTo({center:[i.lng,i.lat],speed:.8,essential:!0}))})).catch((e=>(console.log(e),!1)))};return(0,Y.jsxs)("div",{id:"loc-map-bar",children:[(0,Y.jsx)("input",{id:"loc-map-address-search",type:"text",onChange:e=>r(e.target.value),onKeyDown:e=>"Enter"===e.key?n():"",value:i}),(0,Y.jsx)("label",{id:"loc-map-bar-label",children:"Address Search"}),(0,Y.jsx)("button",{id:"loc-map-bar-btn",onClick:n,children:"Search"}),(0,Y.jsx)("div",{id:"loc-modal-close",onClick:t.handleClose,children:(0,Y.jsx)("div",{id:"loc-modal-close-x",children:"X"})})]})}const An={north:47.53,south:37.09,east:-66.89,west:-82.7542},Cn="default",En={default:{address:"213 Warren Road, Ithaca, New York",id:"default",lat:42.457975,lng:-76.46754}};function Pn(t){const[i,r]=(0,e.useState)(!1),[n,o]=(0,e.useState)(0),[s,a]=(0,e.useState)(Object.keys(t.locations).length>0?t.locations:En),[l,c]=(0,e.useState)(t.selected||Cn),u=(0,e.useRef)(null);(0,e.useEffect)((()=>{""===t.selected&&t.newLocationsCallback(Cn,En)}),[]),(0,e.useEffect)((()=>{!0===i?o("100vh"):!1===i&&setTimeout((()=>{o(0)}),400)}),[i]);const h=()=>{t.newLocationsCallback(l,s),r(!1)},d=(e,t)=>{"add"===e&&(t.id=String(Date.now()),a((e=>({...e,[t.id]:{...t,id:t.id}})))),"remove"===e&&a((e=>{const i={...e};return delete i[t.id],i})),"add"!==e&&"change"!==e||c(t.id)};return(0,Y.jsxs)("div",{id:"loc-container",style:{zIndex:t.modalZIndex||100},children:[(0,Y.jsx)("div",{id:"loc-location-text",children:s[l].address}),(0,Y.jsx)("div",{id:"loc-location-change",onClick:()=>r(!0),children:(0,Y.jsx)("button",{children:"Change Location"})}),(0,Y.jsx)("div",{id:"loc-modal-container",style:{height:n,opacity:i?1:0},onMouseDown:h,children:(0,Y.jsxs)("div",{id:"loc-modal-box",onMouseDown:e=>e.stopPropagation(),children:[(0,Y.jsx)(Mn,{token:t.token,bbox:t.bbox||An,allowedStates:t.allowedStates,mapRef:u,handleChangeLocations:d,handleClose:h}),(0,Y.jsx)(Tn,{token:t.token,allowedStates:t.allowedStates,bbox:t.bbox||An,mapRef:u,handleChangeLocations:d,currentLocation:s[l],pastLocations:s})]})})]})}function kn(e){var t,i,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var n=e.length;for(t=0;t<n;t++)e[t]&&(i=kn(e[t]))&&(r&&(r+=" "),r+=i)}else for(i in e)e[i]&&(r&&(r+=" "),r+=i);return r}const In=function(){for(var e,t,i=0,r="",n=arguments.length;i<n;i++)(e=arguments[i])&&(t=kn(e))&&(r&&(r+=" "),r+=t);return r};function Dn(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;const r={};return Object.keys(e).forEach((n=>{r[n]=e[n].reduce(((e,r)=>{if(r){const n=t(r);""!==n&&e.push(n),i&&i[r]&&e.push(i[r])}return e}),[]).join(" ")})),r}let Ln=0;const Rn=t["useId".toString()];function zn(t){if(void 0!==Rn){const e=Rn();return null!=t?t:e}return function(t){const[i,r]=e.useState(t),n=t||i;return e.useEffect((()=>{null==i&&(Ln+=1,r(`mui-${Ln}`))}),[i]),n}(t)}var On=i(8052);const Fn=function(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e},Bn=e=>Fn(e)&&"classes"!==e,Nn=(0,On.Ay)({themeId:q,defaultTheme:$,rootShouldForwardProp:Bn}),jn=e.createContext(void 0);function Vn(t){let{props:i,name:r}=t;return function(e){const{theme:t,name:i,props:r}=e;if(!t||!t.components||!t.components[i])return r;const n=t.components[i];return n.defaultProps?s(n.defaultProps,r):n.styleOverrides||n.variants?r:s(n,r)}({props:i,name:r,theme:{components:e.useContext(jn)}})}function Un(e){return Vn(e)}const Gn=function(e){return"string"===typeof e};function Hn(e,t){"function"===typeof e?e(t):e&&(e.current=t)}function Wn(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return e.useMemo((()=>i.every((e=>null==e))?null:e=>{i.forEach((t=>{Hn(t,e)}))}),i)}function $n(e){return e&&e.ownerDocument||document}function qn(e){return $n(e).defaultView||window}const Xn="undefined"!==typeof window?e.useLayoutEffect:e.useEffect;const Yn=function(t){const i=e.useRef(t);return Xn((()=>{i.current=t})),e.useRef((function(){return(0,i.current)(...arguments)})).current};function Zn(e){let t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:166;function r(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];clearTimeout(t),t=setTimeout((()=>{e.apply(this,n)}),i)}return r.clear=()=>{clearTimeout(t)},r}const Kn=["onChange","maxRows","minRows","style","value"];function Jn(e){return parseInt(e,10)||0}const Qn={visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"};function eo(e){return function(e){for(const t in e)return!1;return!0}(e)||0===e.outerHeightStyle&&!e.overflowing}const to=e.forwardRef((function(t,i){const{onChange:r,maxRows:s,minRows:a=1,style:l,value:c}=t,u=(0,o.A)(t,Kn),{current:h}=e.useRef(null!=c),d=e.useRef(null),p=Wn(i,d),f=e.useRef(null),m=e.useRef(null),g=e.useCallback((()=>{const e=d.current,i=m.current;if(!e||!i)return;const r=qn(e).getComputedStyle(e);if("0px"===r.width)return{outerHeightStyle:0,overflowing:!1};i.style.width=r.width,i.value=e.value||t.placeholder||"x","\n"===i.value.slice(-1)&&(i.value+=" ");const n=r.boxSizing,o=Jn(r.paddingBottom)+Jn(r.paddingTop),l=Jn(r.borderBottomWidth)+Jn(r.borderTopWidth),c=i.scrollHeight;i.value="x";const u=i.scrollHeight;let h=c;a&&(h=Math.max(Number(a)*u,h)),s&&(h=Math.min(Number(s)*u,h)),h=Math.max(h,u);return{outerHeightStyle:h+("border-box"===n?o+l:0),overflowing:Math.abs(h-c)<=1}}),[s,a,t.placeholder]),y=Yn((()=>{const e=d.current,t=g();if(!e||!t||eo(t))return!1;const i=t.outerHeightStyle;return null!=f.current&&f.current!==i})),_=e.useCallback((()=>{const e=d.current,t=g();if(!e||!t||eo(t))return;const i=t.outerHeightStyle;f.current!==i&&(f.current=i,e.style.height=`${i}px`),e.style.overflow=t.overflowing?"hidden":""}),[g]),v=e.useRef(-1);Xn((()=>{const e=Zn(_),t=null==d?void 0:d.current;if(!t)return;const i=qn(t);let r;return i.addEventListener("resize",e),"undefined"!==typeof ResizeObserver&&(r=new ResizeObserver((()=>{y()&&(r.unobserve(t),cancelAnimationFrame(v.current),_(),v.current=requestAnimationFrame((()=>{r.observe(t)})))})),r.observe(t)),()=>{e.clear(),cancelAnimationFrame(v.current),i.removeEventListener("resize",e),r&&r.disconnect()}}),[g,_,y]),Xn((()=>{_()}));return(0,Y.jsxs)(e.Fragment,{children:[(0,Y.jsx)("textarea",(0,n.A)({value:c,onChange:e=>{h||_(),r&&r(e)},ref:p,rows:a,style:l},u)),(0,Y.jsx)("textarea",{"aria-hidden":!0,className:t.className,readOnly:!0,ref:m,tabIndex:-1,style:(0,n.A)({},Qn,l,{paddingTop:0,paddingBottom:0})})]})}));function io(e){let{props:t,states:i,muiFormControl:r}=e;return i.reduce(((e,i)=>(e[i]=t[i],r&&"undefined"===typeof t[i]&&(e[i]=r[i]),e)),{})}const ro=e.createContext(void 0);function no(){return e.useContext(ro)}const oo=i(7598).A,so=Wn,ao=Xn;var lo=i(869);const co=function(e){let{styles:t,themeId:i,defaultTheme:r={}}=e;const n=d(r),o="function"===typeof t?t(i&&n[i]||n):t;return(0,Y.jsx)(lo.A,{styles:o})};const uo=function(e){return(0,Y.jsx)(co,(0,n.A)({},e,{defaultTheme:$,themeId:q}))};function ho(e){return null!=e&&!(Array.isArray(e)&&0===e.length)}function po(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e&&(ho(e.value)&&""!==e.value||t&&ho(e.defaultValue)&&""!==e.defaultValue)}const fo=e=>e,mo=(()=>{let e=fo;return{configure(t){e=t},generate:t=>e(t),reset(){e=fo}}})(),go={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function yo(e,t){const i=go[t];return i?`${arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui"}-${i}`:`${mo.generate(e)}-${t}`}function _o(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui";const r={};return t.forEach((t=>{r[t]=yo(e,t,i)})),r}function vo(e){return yo("MuiInputBase",e)}const xo=_o("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),bo=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],wo=(e,t)=>{const{ownerState:i}=e;return[t.root,i.formControl&&t.formControl,i.startAdornment&&t.adornedStart,i.endAdornment&&t.adornedEnd,i.error&&t.error,"small"===i.size&&t.sizeSmall,i.multiline&&t.multiline,i.color&&t[`color${oo(i.color)}`],i.fullWidth&&t.fullWidth,i.hiddenLabel&&t.hiddenLabel]},So=(e,t)=>{const{ownerState:i}=e;return[t.input,"small"===i.size&&t.inputSizeSmall,i.multiline&&t.inputMultiline,"search"===i.type&&t.inputTypeSearch,i.startAdornment&&t.inputAdornedStart,i.endAdornment&&t.inputAdornedEnd,i.hiddenLabel&&t.inputHiddenLabel]},To=Nn("div",{name:"MuiInputBase",slot:"Root",overridesResolver:wo})((e=>{let{theme:t,ownerState:i}=e;return(0,n.A)({},t.typography.body1,{color:(t.vars||t).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${xo.disabled}`]:{color:(t.vars||t).palette.text.disabled,cursor:"default"}},i.multiline&&(0,n.A)({padding:"4px 0 5px"},"small"===i.size&&{paddingTop:1}),i.fullWidth&&{width:"100%"})})),Mo=Nn("input",{name:"MuiInputBase",slot:"Input",overridesResolver:So})((e=>{let{theme:t,ownerState:i}=e;const r="light"===t.palette.mode,o=(0,n.A)({color:"currentColor"},t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:r?.42:.5},{transition:t.transitions.create("opacity",{duration:t.transitions.duration.shorter})}),s={opacity:"0 !important"},a=t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:r?.42:.5};return(0,n.A)({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":o,"&::-moz-placeholder":o,"&:-ms-input-placeholder":o,"&::-ms-input-placeholder":o,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${xo.formControl} &`]:{"&::-webkit-input-placeholder":s,"&::-moz-placeholder":s,"&:-ms-input-placeholder":s,"&::-ms-input-placeholder":s,"&:focus::-webkit-input-placeholder":a,"&:focus::-moz-placeholder":a,"&:focus:-ms-input-placeholder":a,"&:focus::-ms-input-placeholder":a},[`&.${xo.disabled}`]:{opacity:1,WebkitTextFillColor:(t.vars||t).palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},"small"===i.size&&{paddingTop:1},i.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},"search"===i.type&&{MozAppearance:"textfield"})})),Ao=(0,Y.jsx)(uo,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),Co=e.forwardRef((function(t,i){var r;const s=Un({props:t,name:"MuiInputBase"}),{"aria-describedby":a,autoComplete:l,autoFocus:c,className:u,components:h={},componentsProps:d={},defaultValue:f,disabled:m,disableInjectingGlobalStyles:g,endAdornment:y,fullWidth:_=!1,id:v,inputComponent:x="input",inputProps:b={},inputRef:w,maxRows:S,minRows:T,multiline:M=!1,name:A,onBlur:C,onChange:E,onClick:P,onFocus:k,onKeyDown:I,onKeyUp:D,placeholder:L,readOnly:R,renderSuffix:z,rows:O,slotProps:F={},slots:B={},startAdornment:N,type:j="text",value:V}=s,U=(0,o.A)(s,bo),G=null!=b.value?b.value:V,{current:H}=e.useRef(null!=G),W=e.useRef(),$=e.useCallback((e=>{0}),[]),q=so(W,w,b.ref,$),[X,Z]=e.useState(!1),K=no();const J=io({props:s,muiFormControl:K,states:["color","disabled","error","hiddenLabel","size","required","filled"]});J.focused=K?K.focused:X,e.useEffect((()=>{!K&&m&&X&&(Z(!1),C&&C())}),[K,m,X,C]);const Q=K&&K.onFilled,ee=K&&K.onEmpty,te=e.useCallback((e=>{po(e)?Q&&Q():ee&&ee()}),[Q,ee]);ao((()=>{H&&te({value:G})}),[G,te,H]);e.useEffect((()=>{te(W.current)}),[]);let ie=x,re=b;M&&"input"===ie&&(re=O?(0,n.A)({type:void 0,minRows:O,maxRows:O},re):(0,n.A)({type:void 0,maxRows:S,minRows:T},re),ie=to);e.useEffect((()=>{K&&K.setAdornedStart(Boolean(N))}),[K,N]);const ne=(0,n.A)({},s,{color:J.color||"primary",disabled:J.disabled,endAdornment:y,error:J.error,focused:J.focused,formControl:K,fullWidth:_,hiddenLabel:J.hiddenLabel,multiline:M,size:J.size,startAdornment:N,type:j}),oe=(e=>{const{classes:t,color:i,disabled:r,error:n,endAdornment:o,focused:s,formControl:a,fullWidth:l,hiddenLabel:c,multiline:u,readOnly:h,size:d,startAdornment:p,type:f}=e;return Dn({root:["root",`color${oo(i)}`,r&&"disabled",n&&"error",l&&"fullWidth",s&&"focused",a&&"formControl",d&&"medium"!==d&&`size${oo(d)}`,u&&"multiline",p&&"adornedStart",o&&"adornedEnd",c&&"hiddenLabel",h&&"readOnly"],input:["input",r&&"disabled","search"===f&&"inputTypeSearch",u&&"inputMultiline","small"===d&&"inputSizeSmall",c&&"inputHiddenLabel",p&&"inputAdornedStart",o&&"inputAdornedEnd",h&&"readOnly"]},vo,t)})(ne),se=B.root||h.Root||To,ae=F.root||d.root||{},le=B.input||h.Input||Mo;return re=(0,n.A)({},re,null!=(r=F.input)?r:d.input),(0,Y.jsxs)(e.Fragment,{children:[!g&&Ao,(0,Y.jsxs)(se,(0,n.A)({},ae,!Gn(se)&&{ownerState:(0,n.A)({},ne,ae.ownerState)},{ref:i,onClick:e=>{W.current&&e.currentTarget===e.target&&W.current.focus(),P&&P(e)}},U,{className:In(oe.root,ae.className,u,R&&"MuiInputBase-readOnly"),children:[N,(0,Y.jsx)(ro.Provider,{value:null,children:(0,Y.jsx)(le,(0,n.A)({ownerState:ne,"aria-invalid":J.error,"aria-describedby":a,autoComplete:l,autoFocus:c,defaultValue:f,disabled:J.disabled,id:v,onAnimationStart:e=>{te("mui-auto-fill-cancel"===e.animationName?W.current:{value:"x"})},name:A,placeholder:L,readOnly:R,required:J.required,rows:O,value:G,onKeyDown:I,onKeyUp:D,type:j},re,!Gn(le)&&{as:ie,ownerState:(0,n.A)({},ne,re.ownerState)},{ref:q,className:In(oe.input,re.className,R&&"MuiInputBase-readOnly"),onBlur:e=>{C&&C(e),b.onBlur&&b.onBlur(e),K&&K.onBlur?K.onBlur(e):Z(!1)},onChange:function(e){if(!H){const t=e.target||W.current;if(null==t)throw new Error((0,p.A)(1));te({value:t.value})}for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];b.onChange&&b.onChange(e,...i),E&&E(e,...i)},onFocus:e=>{J.disabled?e.stopPropagation():(k&&k(e),b.onFocus&&b.onFocus(e),K&&K.onFocus?K.onFocus(e):Z(!0))}}))}),y,z?z((0,n.A)({},J,{startAdornment:N})):null]}))]})})),Eo=Co;function Po(e){return yo("MuiInput",e)}const ko=(0,n.A)({},xo,_o("MuiInput",["root","underline","input"])),Io=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],Do=Nn(To,{shouldForwardProp:e=>Bn(e)||"classes"===e,name:"MuiInput",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[...wo(e,t),!i.disableUnderline&&t.underline]}})((e=>{let{theme:t,ownerState:i}=e;let r="light"===t.palette.mode?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return t.vars&&(r=`rgba(${t.vars.palette.common.onBackgroundChannel} / ${t.vars.opacity.inputUnderline})`),(0,n.A)({position:"relative"},i.formControl&&{"label + &":{marginTop:16}},!i.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(t.vars||t).palette[i.color].main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${ko.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${ko.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${r}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${ko.disabled}, .${ko.error}):before`]:{borderBottom:`2px solid ${(t.vars||t).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${r}`}},[`&.${ko.disabled}:before`]:{borderBottomStyle:"dotted"}})})),Lo=Nn(Mo,{name:"MuiInput",slot:"Input",overridesResolver:So})({}),Ro=e.forwardRef((function(e,t){var i,r,s,a;const l=Un({props:e,name:"MuiInput"}),{disableUnderline:c,components:u={},componentsProps:h,fullWidth:d=!1,inputComponent:p="input",multiline:m=!1,slotProps:g,slots:y={},type:_="text"}=l,v=(0,o.A)(l,Io),x=(e=>{const{classes:t,disableUnderline:i}=e,r=Dn({root:["root",!i&&"underline"],input:["input"]},Po,t);return(0,n.A)({},t,r)})(l),b={root:{ownerState:{disableUnderline:c}}},w=(null!=g?g:h)?(0,f.A)(null!=g?g:h,b):b,S=null!=(i=null!=(r=y.root)?r:u.Root)?i:Do,T=null!=(s=null!=(a=y.input)?a:u.Input)?s:Lo;return(0,Y.jsx)(Eo,(0,n.A)({slots:{root:S,input:T},slotProps:w,fullWidth:d,inputComponent:p,multiline:m,ref:t,type:_},v,{classes:x}))}));Ro.muiName="Input";const zo=Ro;function Oo(e){return yo("MuiFilledInput",e)}const Fo=(0,n.A)({},xo,_o("MuiFilledInput",["root","underline","input"])),Bo=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],No=Nn(To,{shouldForwardProp:e=>Bn(e)||"classes"===e,name:"MuiFilledInput",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[...wo(e,t),!i.disableUnderline&&t.underline]}})((e=>{let{theme:t,ownerState:i}=e;var r;const o="light"===t.palette.mode,s=o?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",a=o?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",l=o?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",c=o?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return(0,n.A)({position:"relative",backgroundColor:t.vars?t.vars.palette.FilledInput.bg:a,borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),"&:hover":{backgroundColor:t.vars?t.vars.palette.FilledInput.hoverBg:l,"@media (hover: none)":{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:a}},[`&.${Fo.focused}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:a},[`&.${Fo.disabled}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.disabledBg:c}},!i.disableUnderline&&{"&::after":{borderBottom:`2px solid ${null==(r=(t.vars||t).palette[i.color||"primary"])?void 0:r.main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Fo.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Fo.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / ${t.vars.opacity.inputUnderline})`:s}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Fo.disabled}, .${Fo.error}):before`]:{borderBottom:`1px solid ${(t.vars||t).palette.text.primary}`},[`&.${Fo.disabled}:before`]:{borderBottomStyle:"dotted"}},i.startAdornment&&{paddingLeft:12},i.endAdornment&&{paddingRight:12},i.multiline&&(0,n.A)({padding:"25px 12px 8px"},"small"===i.size&&{paddingTop:21,paddingBottom:4},i.hiddenLabel&&{paddingTop:16,paddingBottom:17},i.hiddenLabel&&"small"===i.size&&{paddingTop:8,paddingBottom:9}))})),jo=Nn(Mo,{name:"MuiFilledInput",slot:"Input",overridesResolver:So})((e=>{let{theme:t,ownerState:i}=e;return(0,n.A)({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:"light"===t.palette.mode?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:"light"===t.palette.mode?null:"#fff",caretColor:"light"===t.palette.mode?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},t.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},"small"===i.size&&{paddingTop:21,paddingBottom:4},i.hiddenLabel&&{paddingTop:16,paddingBottom:17},i.startAdornment&&{paddingLeft:0},i.endAdornment&&{paddingRight:0},i.hiddenLabel&&"small"===i.size&&{paddingTop:8,paddingBottom:9},i.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0})})),Vo=e.forwardRef((function(e,t){var i,r,s,a;const l=Un({props:e,name:"MuiFilledInput"}),{components:c={},componentsProps:u,fullWidth:h=!1,inputComponent:d="input",multiline:p=!1,slotProps:m,slots:g={},type:y="text"}=l,_=(0,o.A)(l,Bo),v=(0,n.A)({},l,{fullWidth:h,inputComponent:d,multiline:p,type:y}),x=(e=>{const{classes:t,disableUnderline:i}=e,r=Dn({root:["root",!i&&"underline"],input:["input"]},Oo,t);return(0,n.A)({},t,r)})(l),b={root:{ownerState:v},input:{ownerState:v}},w=(null!=m?m:u)?(0,f.A)(b,null!=m?m:u):b,S=null!=(i=null!=(r=g.root)?r:c.Root)?i:No,T=null!=(s=null!=(a=g.input)?a:c.Input)?s:jo;return(0,Y.jsx)(Eo,(0,n.A)({slots:{root:S,input:T},componentsProps:w,fullWidth:h,inputComponent:d,multiline:p,ref:t,type:y},_,{classes:x}))}));Vo.muiName="Input";const Uo=Vo;var Go;const Ho=["children","classes","className","label","notched"],Wo=Nn("fieldset",{shouldForwardProp:Bn})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),$o=Nn("legend",{shouldForwardProp:Bn})((e=>{let{ownerState:t,theme:i}=e;return(0,n.A)({float:"unset",width:"auto",overflow:"hidden"},!t.withLabel&&{padding:0,lineHeight:"11px",transition:i.transitions.create("width",{duration:150,easing:i.transitions.easing.easeOut})},t.withLabel&&(0,n.A)({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:i.transitions.create("max-width",{duration:50,easing:i.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},t.notched&&{maxWidth:"100%",transition:i.transitions.create("max-width",{duration:100,easing:i.transitions.easing.easeOut,delay:50})}))}));function qo(e){return yo("MuiOutlinedInput",e)}const Xo=(0,n.A)({},xo,_o("MuiOutlinedInput",["root","notchedOutline","input"])),Yo=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],Zo=Nn(To,{shouldForwardProp:e=>Bn(e)||"classes"===e,name:"MuiOutlinedInput",slot:"Root",overridesResolver:wo})((e=>{let{theme:t,ownerState:i}=e;const r="light"===t.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return(0,n.A)({position:"relative",borderRadius:(t.vars||t).shape.borderRadius,[`&:hover .${Xo.notchedOutline}`]:{borderColor:(t.vars||t).palette.text.primary},"@media (hover: none)":{[`&:hover .${Xo.notchedOutline}`]:{borderColor:t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:r}},[`&.${Xo.focused} .${Xo.notchedOutline}`]:{borderColor:(t.vars||t).palette[i.color].main,borderWidth:2},[`&.${Xo.error} .${Xo.notchedOutline}`]:{borderColor:(t.vars||t).palette.error.main},[`&.${Xo.disabled} .${Xo.notchedOutline}`]:{borderColor:(t.vars||t).palette.action.disabled}},i.startAdornment&&{paddingLeft:14},i.endAdornment&&{paddingRight:14},i.multiline&&(0,n.A)({padding:"16.5px 14px"},"small"===i.size&&{padding:"8.5px 14px"}))})),Ko=Nn((function(e){const{className:t,label:i,notched:r}=e,s=(0,o.A)(e,Ho),a=null!=i&&""!==i,l=(0,n.A)({},e,{notched:r,withLabel:a});return(0,Y.jsx)(Wo,(0,n.A)({"aria-hidden":!0,className:t,ownerState:l},s,{children:(0,Y.jsx)($o,{ownerState:l,children:a?(0,Y.jsx)("span",{children:i}):Go||(Go=(0,Y.jsx)("span",{className:"notranslate",children:"\u200b"}))})}))}),{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(e,t)=>t.notchedOutline})((e=>{let{theme:t}=e;const i="light"===t.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:i}})),Jo=Nn(Mo,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:So})((e=>{let{theme:t,ownerState:i}=e;return(0,n.A)({padding:"16.5px 14px"},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:"light"===t.palette.mode?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:"light"===t.palette.mode?null:"#fff",caretColor:"light"===t.palette.mode?null:"#fff",borderRadius:"inherit"}},t.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},"small"===i.size&&{padding:"8.5px 14px"},i.multiline&&{padding:0},i.startAdornment&&{paddingLeft:0},i.endAdornment&&{paddingRight:0})})),Qo=e.forwardRef((function(t,i){var r,s,a,l,c;const u=Un({props:t,name:"MuiOutlinedInput"}),{components:h={},fullWidth:d=!1,inputComponent:p="input",label:f,multiline:m=!1,notched:g,slots:y={},type:_="text"}=u,v=(0,o.A)(u,Yo),x=(e=>{const{classes:t}=e,i=Dn({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},qo,t);return(0,n.A)({},t,i)})(u),b=no(),w=io({props:u,muiFormControl:b,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),S=(0,n.A)({},u,{color:w.color||"primary",disabled:w.disabled,error:w.error,focused:w.focused,formControl:b,fullWidth:d,hiddenLabel:w.hiddenLabel,multiline:m,size:w.size,type:_}),T=null!=(r=null!=(s=y.root)?s:h.Root)?r:Zo,M=null!=(a=null!=(l=y.input)?l:h.Input)?a:Jo;return(0,Y.jsx)(Eo,(0,n.A)({slots:{root:T,input:M},renderSuffix:t=>(0,Y.jsx)(Ko,{ownerState:S,className:x.notchedOutline,label:null!=f&&""!==f&&w.required?c||(c=(0,Y.jsxs)(e.Fragment,{children:[f,"\u2009","*"]})):f,notched:"undefined"!==typeof g?g:Boolean(t.startAdornment||t.filled||t.focused)}),fullWidth:d,inputComponent:p,multiline:m,ref:i,type:_},v,{classes:(0,n.A)({},x,{notchedOutline:null})}))}));Qo.muiName="Input";const es=Qo;function ts(e){return yo("MuiFormLabel",e)}const is=_o("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),rs=["children","className","color","component","disabled","error","filled","focused","required"],ns=Nn("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:i}=e;return(0,n.A)({},t.root,"secondary"===i.color&&t.colorSecondary,i.filled&&t.filled)}})((e=>{let{theme:t,ownerState:i}=e;return(0,n.A)({color:(t.vars||t).palette.text.secondary},t.typography.body1,{lineHeight:"1.4375em",padding:0,position:"relative",[`&.${is.focused}`]:{color:(t.vars||t).palette[i.color].main},[`&.${is.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${is.error}`]:{color:(t.vars||t).palette.error.main}})})),os=Nn("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(e,t)=>t.asterisk})((e=>{let{theme:t}=e;return{[`&.${is.error}`]:{color:(t.vars||t).palette.error.main}}})),ss=e.forwardRef((function(e,t){const i=Un({props:e,name:"MuiFormLabel"}),{children:r,className:s,component:a="label"}=i,l=(0,o.A)(i,rs),c=io({props:i,muiFormControl:no(),states:["color","required","focused","disabled","error","filled"]}),u=(0,n.A)({},i,{color:c.color||"primary",component:a,disabled:c.disabled,error:c.error,filled:c.filled,focused:c.focused,required:c.required}),h=(e=>{const{classes:t,color:i,focused:r,disabled:n,error:o,filled:s,required:a}=e;return Dn({root:["root",`color${oo(i)}`,n&&"disabled",o&&"error",s&&"filled",r&&"focused",a&&"required"],asterisk:["asterisk",o&&"error"]},ts,t)})(u);return(0,Y.jsxs)(ns,(0,n.A)({as:a,ownerState:u,className:In(h.root,s),ref:t},l,{children:[r,c.required&&(0,Y.jsxs)(os,{ownerState:u,"aria-hidden":!0,className:h.asterisk,children:["\u2009","*"]})]}))}));function as(e){return yo("MuiInputLabel",e)}_o("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const ls=["disableAnimation","margin","shrink","variant","className"],cs=Nn(ss,{shouldForwardProp:e=>Bn(e)||"classes"===e,name:"MuiInputLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[{[`& .${is.asterisk}`]:t.asterisk},t.root,i.formControl&&t.formControl,"small"===i.size&&t.sizeSmall,i.shrink&&t.shrink,!i.disableAnimation&&t.animated,i.focused&&t.focused,t[i.variant]]}})((e=>{let{theme:t,ownerState:i}=e;return(0,n.A)({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},i.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},"small"===i.size&&{transform:"translate(0, 17px) scale(1)"},i.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!i.disableAnimation&&{transition:t.transitions.create(["color","transform","max-width"],{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut})},"filled"===i.variant&&(0,n.A)({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},"small"===i.size&&{transform:"translate(12px, 13px) scale(1)"},i.shrink&&(0,n.A)({userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},"small"===i.size&&{transform:"translate(12px, 4px) scale(0.75)"})),"outlined"===i.variant&&(0,n.A)({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},"small"===i.size&&{transform:"translate(14px, 9px) scale(1)"},i.shrink&&{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}))})),us=e.forwardRef((function(e,t){const i=Un({name:"MuiInputLabel",props:e}),{disableAnimation:r=!1,shrink:s,className:a}=i,l=(0,o.A)(i,ls),c=no();let u=s;"undefined"===typeof u&&c&&(u=c.filled||c.focused||c.adornedStart);const h=io({props:i,muiFormControl:c,states:["size","variant","required","focused"]}),d=(0,n.A)({},i,{disableAnimation:r,formControl:c,shrink:u,size:h.size,variant:h.variant,required:h.required,focused:h.focused}),p=(e=>{const{classes:t,formControl:i,size:r,shrink:o,disableAnimation:s,variant:a,required:l}=e,c=Dn({root:["root",i&&"formControl",!s&&"animated",o&&"shrink",r&&"normal"!==r&&`size${oo(r)}`,a],asterisk:[l&&"asterisk"]},as,t);return(0,n.A)({},t,c)})(d);return(0,Y.jsx)(cs,(0,n.A)({"data-shrink":u,ownerState:d,ref:t,className:In(p.root,a)},l,{classes:p}))}));const hs=function(t,i){var r,n;return e.isValidElement(t)&&-1!==i.indexOf(null!=(r=t.type.muiName)?r:null==(n=t.type)||null==(n=n._payload)||null==(n=n.value)?void 0:n.muiName)};function ds(e){return yo("MuiFormControl",e)}_o("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const ps=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],fs=Nn("div",{name:"MuiFormControl",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:i}=e;return(0,n.A)({},t.root,t[`margin${oo(i.margin)}`],i.fullWidth&&t.fullWidth)}})((e=>{let{ownerState:t}=e;return(0,n.A)({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},"normal"===t.margin&&{marginTop:16,marginBottom:8},"dense"===t.margin&&{marginTop:8,marginBottom:4},t.fullWidth&&{width:"100%"})})),ms=e.forwardRef((function(t,i){const r=Un({props:t,name:"MuiFormControl"}),{children:s,className:a,color:l="primary",component:c="div",disabled:u=!1,error:h=!1,focused:d,fullWidth:p=!1,hiddenLabel:f=!1,margin:m="none",required:g=!1,size:y="medium",variant:_="outlined"}=r,v=(0,o.A)(r,ps),x=(0,n.A)({},r,{color:l,component:c,disabled:u,error:h,fullWidth:p,hiddenLabel:f,margin:m,required:g,size:y,variant:_}),b=(e=>{const{classes:t,margin:i,fullWidth:r}=e;return Dn({root:["root","none"!==i&&`margin${oo(i)}`,r&&"fullWidth"]},ds,t)})(x),[w,S]=e.useState((()=>{let t=!1;return s&&e.Children.forEach(s,(e=>{if(!hs(e,["Input","Select"]))return;const i=hs(e,["Select"])?e.props.input:e;i&&i.props.startAdornment&&(t=!0)})),t})),[T,M]=e.useState((()=>{let t=!1;return s&&e.Children.forEach(s,(e=>{hs(e,["Input","Select"])&&(po(e.props,!0)||po(e.props.inputProps,!0))&&(t=!0)})),t})),[A,C]=e.useState(!1);u&&A&&C(!1);const E=void 0===d||u?A:d;let P;const k=e.useMemo((()=>({adornedStart:w,setAdornedStart:S,color:l,disabled:u,error:h,filled:T,focused:E,fullWidth:p,hiddenLabel:f,size:y,onBlur:()=>{C(!1)},onEmpty:()=>{M(!1)},onFilled:()=>{M(!0)},onFocus:()=>{C(!0)},registerEffect:P,required:g,variant:_})),[w,l,u,h,T,E,p,f,P,g,y,_]);return(0,Y.jsx)(ro.Provider,{value:k,children:(0,Y.jsx)(fs,(0,n.A)({as:c,ownerState:x,className:In(b.root,a),ref:i},v,{children:s}))})}));function gs(e){return yo("MuiFormHelperText",e)}const ys=_o("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var _s;const vs=["children","className","component","disabled","error","filled","focused","margin","required","variant"],xs=Nn("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,i.size&&t[`size${oo(i.size)}`],i.contained&&t.contained,i.filled&&t.filled]}})((e=>{let{theme:t,ownerState:i}=e;return(0,n.A)({color:(t.vars||t).palette.text.secondary},t.typography.caption,{textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${ys.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${ys.error}`]:{color:(t.vars||t).palette.error.main}},"small"===i.size&&{marginTop:4},i.contained&&{marginLeft:14,marginRight:14})})),bs=e.forwardRef((function(e,t){const i=Un({props:e,name:"MuiFormHelperText"}),{children:r,className:s,component:a="p"}=i,l=(0,o.A)(i,vs),c=io({props:i,muiFormControl:no(),states:["variant","size","disabled","error","filled","focused","required"]}),u=(0,n.A)({},i,{component:a,contained:"filled"===c.variant||"outlined"===c.variant,variant:c.variant,size:c.size,disabled:c.disabled,error:c.error,filled:c.filled,focused:c.focused,required:c.required}),h=(e=>{const{classes:t,contained:i,size:r,disabled:n,error:o,filled:s,focused:a,required:l}=e;return Dn({root:["root",n&&"disabled",o&&"error",r&&`size${oo(r)}`,i&&"contained",a&&"focused",s&&"filled",l&&"required"]},gs,t)})(u);return(0,Y.jsx)(xs,(0,n.A)({as:a,ownerState:u,className:In(h.root,s),ref:t},l,{children:" "===r?_s||(_s=(0,Y.jsx)("span",{className:"notranslate",children:"\u200b"})):r}))}));function ws(t){var i;return parseInt(e.version,10)>=19?(null==t||null==(i=t.props)?void 0:i.ref)||null:(null==t?void 0:t.ref)||null}const Ss=$n,Ts=e.createContext();const Ms=function(e,t,i){return void 0===e||Gn(e)?t:(0,n.A)({},t,{ownerState:(0,n.A)({},t.ownerState,i)})};const As=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(void 0===e)return{};const i={};return Object.keys(e).filter((i=>i.match(/^on[A-Z]/)&&"function"===typeof e[i]&&!t.includes(i))).forEach((t=>{i[t]=e[t]})),i};const Cs=function(e){if(void 0===e)return{};const t={};return Object.keys(e).filter((t=>!(t.match(/^on[A-Z]/)&&"function"===typeof e[t]))).forEach((i=>{t[i]=e[i]})),t};const Es=function(e){const{getSlotProps:t,additionalProps:i,externalSlotProps:r,externalForwardedProps:o,className:s}=e;if(!t){const e=In(null==i?void 0:i.className,s,null==o?void 0:o.className,null==r?void 0:r.className),t=(0,n.A)({},null==i?void 0:i.style,null==o?void 0:o.style,null==r?void 0:r.style),a=(0,n.A)({},i,o,r);return e.length>0&&(a.className=e),Object.keys(t).length>0&&(a.style=t),{props:a,internalRef:void 0}}const a=As((0,n.A)({},o,r)),l=Cs(r),c=Cs(o),u=t(a),h=In(null==u?void 0:u.className,null==i?void 0:i.className,s,null==o?void 0:o.className,null==r?void 0:r.className),d=(0,n.A)({},null==u?void 0:u.style,null==i?void 0:i.style,null==o?void 0:o.style,null==r?void 0:r.style),p=(0,n.A)({},u,i,c,l);return h.length>0&&(p.className=h),Object.keys(d).length>0&&(p.style=d),{props:p,internalRef:u.ref}};const Ps=function(e,t,i){return"function"===typeof e?e(t,i):e},ks=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];const Is=function(e){var t;const{elementType:i,externalSlotProps:r,ownerState:s,skipResolvingSlotProps:a=!1}=e,l=(0,o.A)(e,ks),c=a?{}:Ps(r,s),{props:u,internalRef:h}=Es((0,n.A)({},l,{externalSlotProps:c})),d=Wn(h,null==c?void 0:c.ref,null==(t=e.additionalProps)?void 0:t.ref);return Ms(i,(0,n.A)({},u,{ref:d}),s)};const Ds=e.createContext({});function Ls(e){return yo("MuiList",e)}_o("MuiList",["root","padding","dense","subheader"]);const Rs=["children","className","component","dense","disablePadding","subheader"],zs=Nn("ul",{name:"MuiList",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,!i.disablePadding&&t.padding,i.dense&&t.dense,i.subheader&&t.subheader]}})((e=>{let{ownerState:t}=e;return(0,n.A)({listStyle:"none",margin:0,padding:0,position:"relative"},!t.disablePadding&&{paddingTop:8,paddingBottom:8},t.subheader&&{paddingTop:0})})),Os=e.forwardRef((function(t,i){const r=Un({props:t,name:"MuiList"}),{children:s,className:a,component:l="ul",dense:c=!1,disablePadding:u=!1,subheader:h}=r,d=(0,o.A)(r,Rs),p=e.useMemo((()=>({dense:c})),[c]),f=(0,n.A)({},r,{component:l,dense:c,disablePadding:u}),m=(e=>{const{classes:t,disablePadding:i,dense:r,subheader:n}=e;return Dn({root:["root",!i&&"padding",r&&"dense",n&&"subheader"]},Ls,t)})(f);return(0,Y.jsx)(Ds.Provider,{value:p,children:(0,Y.jsxs)(zs,(0,n.A)({as:l,className:In(m.root,a),ref:i,ownerState:f},d,{children:[h,s]}))})}));function Fs(e){const t=e.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}const Bs=Fs,Ns=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function js(e,t,i){return e===t?e.firstChild:t&&t.nextElementSibling?t.nextElementSibling:i?null:e.firstChild}function Vs(e,t,i){return e===t?i?e.firstChild:e.lastChild:t&&t.previousElementSibling?t.previousElementSibling:i?null:e.lastChild}function Us(e,t){if(void 0===t)return!0;let i=e.innerText;return void 0===i&&(i=e.textContent),i=i.trim().toLowerCase(),0!==i.length&&(t.repeating?i[0]===t.keys[0]:0===i.indexOf(t.keys.join("")))}function Gs(e,t,i,r,n,o){let s=!1,a=n(e,t,!!t&&i);for(;a;){if(a===e.firstChild){if(s)return!1;s=!0}const t=!r&&(a.disabled||"true"===a.getAttribute("aria-disabled"));if(a.hasAttribute("tabindex")&&Us(a,o)&&!t)return a.focus(),!0;a=n(e,a,i)}return!1}const Hs=e.forwardRef((function(t,i){const{actions:r,autoFocus:s=!1,autoFocusItem:a=!1,children:l,className:c,disabledItemsFocusable:u=!1,disableListWrap:h=!1,onKeyDown:d,variant:p="selectedMenu"}=t,f=(0,o.A)(t,Ns),m=e.useRef(null),g=e.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});ao((()=>{s&&m.current.focus()}),[s]),e.useImperativeHandle(r,(()=>({adjustStyleForScrollbar:(e,t)=>{let{direction:i}=t;const r=!m.current.style.width;if(e.clientHeight<m.current.clientHeight&&r){const t=`${Bs(Ss(e))}px`;m.current.style["rtl"===i?"paddingLeft":"paddingRight"]=t,m.current.style.width=`calc(100% + ${t})`}return m.current}})),[]);const y=so(m,i);let _=-1;e.Children.forEach(l,((t,i)=>{e.isValidElement(t)?(t.props.disabled||("selectedMenu"===p&&t.props.selected||-1===_)&&(_=i),_===i&&(t.props.disabled||t.props.muiSkipListHighlight||t.type.muiSkipListHighlight)&&(_+=1,_>=l.length&&(_=-1))):_===i&&(_+=1,_>=l.length&&(_=-1))}));const v=e.Children.map(l,((t,i)=>{if(i===_){const i={};return a&&(i.autoFocus=!0),void 0===t.props.tabIndex&&"selectedMenu"===p&&(i.tabIndex=0),e.cloneElement(t,i)}return t}));return(0,Y.jsx)(Os,(0,n.A)({role:"menu",ref:y,className:c,onKeyDown:e=>{const t=m.current,i=e.key,r=Ss(t).activeElement;if("ArrowDown"===i)e.preventDefault(),Gs(t,r,h,u,js);else if("ArrowUp"===i)e.preventDefault(),Gs(t,r,h,u,Vs);else if("Home"===i)e.preventDefault(),Gs(t,null,h,u,js);else if("End"===i)e.preventDefault(),Gs(t,null,h,u,Vs);else if(1===i.length){const n=g.current,o=i.toLowerCase(),s=performance.now();n.keys.length>0&&(s-n.lastTime>500?(n.keys=[],n.repeating=!0,n.previousKeyMatched=!0):n.repeating&&o!==n.keys[0]&&(n.repeating=!1)),n.lastTime=s,n.keys.push(o);const a=r&&!n.repeating&&Us(r,n);n.previousKeyMatched&&(a||Gs(t,r,!1,u,js,n))?e.preventDefault():n.previousKeyMatched=!1}d&&d(e)},tabIndex:s?0:-1},f,{children:v}))})),Ws=Zn,$s=qn,qs={};const Xs=[];class Ys{constructor(){this.currentId=null,this.clear=()=>{null!==this.currentId&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new Ys}start(e,t){this.clear(),this.currentId=setTimeout((()=>{this.currentId=null,t()}),e)}}function Zs(){const t=function(t,i){const r=e.useRef(qs);return r.current===qs&&(r.current=t(i)),r}(Ys.create).current;var i;return i=t.disposeEffect,e.useEffect(i,Xs),t}function Ks(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Mt(e,t)}const Js=!1,Qs=e.createContext(null);var ea=function(e){return e.scrollTop},ta="unmounted",ia="exited",ra="entering",na="entered",oa="exiting",sa=function(t){function i(e,i){var r;r=t.call(this,e,i)||this;var n,o=i&&!i.isMounting?e.enter:e.appear;return r.appearStatus=null,e.in?o?(n=ia,r.appearStatus=ra):n=na:n=e.unmountOnExit||e.mountOnEnter?ta:ia,r.state={status:n},r.nextCallback=null,r}Ks(i,t),i.getDerivedStateFromProps=function(e,t){return e.in&&t.status===ta?{status:ia}:null};var r=i.prototype;return r.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},r.componentDidUpdate=function(e){var t=null;if(e!==this.props){var i=this.state.status;this.props.in?i!==ra&&i!==na&&(t=ra):i!==ra&&i!==na||(t=oa)}this.updateStatus(!1,t)},r.componentWillUnmount=function(){this.cancelNextCallback()},r.getTimeouts=function(){var e,t,i,r=this.props.timeout;return e=t=i=r,null!=r&&"number"!==typeof r&&(e=r.exit,t=r.enter,i=void 0!==r.appear?r.appear:t),{exit:e,enter:t,appear:i}},r.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===ra){if(this.props.unmountOnExit||this.props.mountOnEnter){var i=this.props.nodeRef?this.props.nodeRef.current:cn.findDOMNode(this);i&&ea(i)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===ia&&this.setState({status:ta})},r.performEnter=function(e){var t=this,i=this.props.enter,r=this.context?this.context.isMounting:e,n=this.props.nodeRef?[r]:[cn.findDOMNode(this),r],o=n[0],s=n[1],a=this.getTimeouts(),l=r?a.appear:a.enter;!e&&!i||Js?this.safeSetState({status:na},(function(){t.props.onEntered(o)})):(this.props.onEnter(o,s),this.safeSetState({status:ra},(function(){t.props.onEntering(o,s),t.onTransitionEnd(l,(function(){t.safeSetState({status:na},(function(){t.props.onEntered(o,s)}))}))})))},r.performExit=function(){var e=this,t=this.props.exit,i=this.getTimeouts(),r=this.props.nodeRef?void 0:cn.findDOMNode(this);t&&!Js?(this.props.onExit(r),this.safeSetState({status:oa},(function(){e.props.onExiting(r),e.onTransitionEnd(i.exit,(function(){e.safeSetState({status:ia},(function(){e.props.onExited(r)}))}))}))):this.safeSetState({status:ia},(function(){e.props.onExited(r)}))},r.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},r.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},r.setNextCallback=function(e){var t=this,i=!0;return this.nextCallback=function(r){i&&(i=!1,t.nextCallback=null,e(r))},this.nextCallback.cancel=function(){i=!1},this.nextCallback},r.onTransitionEnd=function(e,t){this.setNextCallback(t);var i=this.props.nodeRef?this.props.nodeRef.current:cn.findDOMNode(this),r=null==e&&!this.props.addEndListener;if(i&&!r){if(this.props.addEndListener){var n=this.props.nodeRef?[this.nextCallback]:[i,this.nextCallback],o=n[0],s=n[1];this.props.addEndListener(o,s)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},r.render=function(){var t=this.state.status;if(t===ta)return null;var i=this.props,r=i.children,n=(i.in,i.mountOnEnter,i.unmountOnExit,i.appear,i.enter,i.exit,i.timeout,i.addEndListener,i.onEnter,i.onEntering,i.onEntered,i.onExit,i.onExiting,i.onExited,i.nodeRef,(0,o.A)(i,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return e.createElement(Qs.Provider,{value:null},"function"===typeof r?r(t,n):e.cloneElement(e.Children.only(r),n))},i}(e.Component);function aa(){}sa.contextType=Qs,sa.propTypes={},sa.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:aa,onEntering:aa,onEntered:aa,onExit:aa,onExiting:aa,onExited:aa},sa.UNMOUNTED=ta,sa.EXITED=ia,sa.ENTERING=ra,sa.ENTERED=na,sa.EXITING=oa;const la=sa;function ca(){const e=d($);return e[q]||e}const ua=e=>e.scrollTop;function ha(e,t){var i,r;const{timeout:n,easing:o,style:s={}}=e;return{duration:null!=(i=s.transitionDuration)?i:"number"===typeof n?n:n[t.mode]||0,easing:null!=(r=s.transitionTimingFunction)?r:"object"===typeof o?o[t.mode]:o,delay:s.transitionDelay}}const da=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function pa(e){return`scale(${e}, ${e**2})`}const fa={entering:{opacity:1,transform:pa(1)},entered:{opacity:1,transform:"none"}},ma="undefined"!==typeof navigator&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),ga=e.forwardRef((function(t,i){const{addEndListener:r,appear:s=!0,children:a,easing:l,in:c,onEnter:u,onEntered:h,onEntering:d,onExit:p,onExited:f,onExiting:m,style:g,timeout:y="auto",TransitionComponent:_=la}=t,v=(0,o.A)(t,da),x=Zs(),b=e.useRef(),w=ca(),S=e.useRef(null),T=so(S,ws(a),i),M=e=>t=>{if(e){const i=S.current;void 0===t?e(i):e(i,t)}},A=M(d),C=M(((e,t)=>{ua(e);const{duration:i,delay:r,easing:n}=ha({style:g,timeout:y,easing:l},{mode:"enter"});let o;"auto"===y?(o=w.transitions.getAutoHeightDuration(e.clientHeight),b.current=o):o=i,e.style.transition=[w.transitions.create("opacity",{duration:o,delay:r}),w.transitions.create("transform",{duration:ma?o:.666*o,delay:r,easing:n})].join(","),u&&u(e,t)})),E=M(h),P=M(m),k=M((e=>{const{duration:t,delay:i,easing:r}=ha({style:g,timeout:y,easing:l},{mode:"exit"});let n;"auto"===y?(n=w.transitions.getAutoHeightDuration(e.clientHeight),b.current=n):n=t,e.style.transition=[w.transitions.create("opacity",{duration:n,delay:i}),w.transitions.create("transform",{duration:ma?n:.666*n,delay:ma?i:i||.333*n,easing:r})].join(","),e.style.opacity=0,e.style.transform=pa(.75),p&&p(e)})),I=M(f);return(0,Y.jsx)(_,(0,n.A)({appear:s,in:c,nodeRef:S,onEnter:C,onEntered:E,onEntering:A,onExit:k,onExited:I,onExiting:P,addEndListener:e=>{"auto"===y&&x.start(b.current||0,e),r&&r(S.current,e)},timeout:"auto"===y?null:y},v,{children:(t,i)=>e.cloneElement(a,(0,n.A)({style:(0,n.A)({opacity:0,transform:pa(.75),visibility:"exited"!==t||c?void 0:"hidden"},fa[t],g,a.props.style),ref:T},i))}))}));ga.muiSupportAuto=!0;const ya=ga,_a=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function va(e){const t=[],i=[];return Array.from(e.querySelectorAll(_a)).forEach(((e,r)=>{const n=function(e){const t=parseInt(e.getAttribute("tabindex")||"",10);return Number.isNaN(t)?"true"===e.contentEditable||("AUDIO"===e.nodeName||"VIDEO"===e.nodeName||"DETAILS"===e.nodeName)&&null===e.getAttribute("tabindex")?0:e.tabIndex:t}(e);-1!==n&&function(e){return!(e.disabled||"INPUT"===e.tagName&&"hidden"===e.type||function(e){if("INPUT"!==e.tagName||"radio"!==e.type)return!1;if(!e.name)return!1;const t=t=>e.ownerDocument.querySelector(`input[type="radio"]${t}`);let i=t(`[name="${e.name}"]:checked`);return i||(i=t(`[name="${e.name}"]`)),i!==e}(e))}(e)&&(0===n?t.push(e):i.push({documentOrder:r,tabIndex:n,node:e}))})),i.sort(((e,t)=>e.tabIndex===t.tabIndex?e.documentOrder-t.documentOrder:e.tabIndex-t.tabIndex)).map((e=>e.node)).concat(t)}function xa(){return!0}const ba=function(t){const{children:i,disableAutoFocus:r=!1,disableEnforceFocus:n=!1,disableRestoreFocus:o=!1,getTabbable:s=va,isEnabled:a=xa,open:l}=t,c=e.useRef(!1),u=e.useRef(null),h=e.useRef(null),d=e.useRef(null),p=e.useRef(null),f=e.useRef(!1),m=e.useRef(null),g=Wn(ws(i),m),y=e.useRef(null);e.useEffect((()=>{l&&m.current&&(f.current=!r)}),[r,l]),e.useEffect((()=>{if(!l||!m.current)return;const e=$n(m.current);return m.current.contains(e.activeElement)||(m.current.hasAttribute("tabIndex")||m.current.setAttribute("tabIndex","-1"),f.current&&m.current.focus()),()=>{o||(d.current&&d.current.focus&&(c.current=!0,d.current.focus()),d.current=null)}}),[l]),e.useEffect((()=>{if(!l||!m.current)return;const e=$n(m.current),t=t=>{y.current=t,!n&&a()&&"Tab"===t.key&&e.activeElement===m.current&&t.shiftKey&&(c.current=!0,h.current&&h.current.focus())},i=()=>{const t=m.current;if(null===t)return;if(!e.hasFocus()||!a()||c.current)return void(c.current=!1);if(t.contains(e.activeElement))return;if(n&&e.activeElement!==u.current&&e.activeElement!==h.current)return;if(e.activeElement!==p.current)p.current=null;else if(null!==p.current)return;if(!f.current)return;let i=[];if(e.activeElement!==u.current&&e.activeElement!==h.current||(i=s(m.current)),i.length>0){var r,o;const e=Boolean((null==(r=y.current)?void 0:r.shiftKey)&&"Tab"===(null==(o=y.current)?void 0:o.key)),t=i[0],n=i[i.length-1];"string"!==typeof t&&"string"!==typeof n&&(e?n.focus():t.focus())}else t.focus()};e.addEventListener("focusin",i),e.addEventListener("keydown",t,!0);const r=setInterval((()=>{e.activeElement&&"BODY"===e.activeElement.tagName&&i()}),50);return()=>{clearInterval(r),e.removeEventListener("focusin",i),e.removeEventListener("keydown",t,!0)}}),[r,n,o,a,l,s]);const _=e=>{null===d.current&&(d.current=e.relatedTarget),f.current=!0};return(0,Y.jsxs)(e.Fragment,{children:[(0,Y.jsx)("div",{tabIndex:l?0:-1,onFocus:_,ref:u,"data-testid":"sentinelStart"}),e.cloneElement(i,{ref:g,onFocus:e=>{null===d.current&&(d.current=e.relatedTarget),f.current=!0,p.current=e.target;const t=i.props.onFocus;t&&t(e)}}),(0,Y.jsx)("div",{tabIndex:l?0:-1,onFocus:_,ref:h,"data-testid":"sentinelEnd"})]})};const wa=e.forwardRef((function(t,i){const{children:r,container:n,disablePortal:o=!1}=t,[s,a]=e.useState(null),l=Wn(e.isValidElement(r)?ws(r):null,i);if(Xn((()=>{o||a(function(e){return"function"===typeof e?e():e}(n)||document.body)}),[n,o]),Xn((()=>{if(s&&!o)return Hn(i,s),()=>{Hn(i,null)}}),[i,s,o]),o){if(e.isValidElement(r)){const t={ref:l};return e.cloneElement(r,t)}return(0,Y.jsx)(e.Fragment,{children:r})}return(0,Y.jsx)(e.Fragment,{children:s?cn.createPortal(r,s):s})})),Sa=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],Ta={entering:{opacity:1},entered:{opacity:1}},Ma=e.forwardRef((function(t,i){const r=ca(),s={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{addEndListener:a,appear:l=!0,children:c,easing:u,in:h,onEnter:d,onEntered:p,onEntering:f,onExit:m,onExited:g,onExiting:y,style:_,timeout:v=s,TransitionComponent:x=la}=t,b=(0,o.A)(t,Sa),w=e.useRef(null),S=so(w,ws(c),i),T=e=>t=>{if(e){const i=w.current;void 0===t?e(i):e(i,t)}},M=T(f),A=T(((e,t)=>{ua(e);const i=ha({style:_,timeout:v,easing:u},{mode:"enter"});e.style.webkitTransition=r.transitions.create("opacity",i),e.style.transition=r.transitions.create("opacity",i),d&&d(e,t)})),C=T(p),E=T(y),P=T((e=>{const t=ha({style:_,timeout:v,easing:u},{mode:"exit"});e.style.webkitTransition=r.transitions.create("opacity",t),e.style.transition=r.transitions.create("opacity",t),m&&m(e)})),k=T(g);return(0,Y.jsx)(x,(0,n.A)({appear:l,in:h,nodeRef:w,onEnter:A,onEntered:C,onEntering:M,onExit:P,onExited:k,onExiting:E,addEndListener:e=>{a&&a(w.current,e)},timeout:v},b,{children:(t,i)=>e.cloneElement(c,(0,n.A)({style:(0,n.A)({opacity:0,visibility:"exited"!==t||h?void 0:"hidden"},Ta[t],_,c.props.style),ref:S},i))}))}));function Aa(e){return yo("MuiBackdrop",e)}_o("MuiBackdrop",["root","invisible"]);const Ca=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],Ea=Nn("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,i.invisible&&t.invisible]}})((e=>{let{ownerState:t}=e;return(0,n.A)({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},t.invisible&&{backgroundColor:"transparent"})})),Pa=e.forwardRef((function(e,t){var i,r,s;const a=Un({props:e,name:"MuiBackdrop"}),{children:l,className:c,component:u="div",components:h={},componentsProps:d={},invisible:p=!1,open:f,slotProps:m={},slots:g={},TransitionComponent:y=Ma,transitionDuration:_}=a,v=(0,o.A)(a,Ca),x=(0,n.A)({},a,{component:u,invisible:p}),b=(e=>{const{classes:t,invisible:i}=e;return Dn({root:["root",i&&"invisible"]},Aa,t)})(x),w=null!=(i=m.root)?i:d.root;return(0,Y.jsx)(y,(0,n.A)({in:f,timeout:_},v,{children:(0,Y.jsx)(Ea,(0,n.A)({"aria-hidden":!0},w,{as:null!=(r=null!=(s=g.root)?s:h.Root)?r:u,className:In(b.root,c,null==w?void 0:w.className),ownerState:(0,n.A)({},x,null==w?void 0:w.ownerState),classes:b,ref:t,children:l}))}))}));function ka(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.reduce(((e,t)=>null==t?e:function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];e.apply(this,r),t.apply(this,r)}),(()=>{}))}function Ia(e,t){t?e.setAttribute("aria-hidden","true"):e.removeAttribute("aria-hidden")}function Da(e){return parseInt(qn(e).getComputedStyle(e).paddingRight,10)||0}function La(e,t,i,r,n){const o=[t,i,...r];[].forEach.call(e.children,(e=>{const t=-1===o.indexOf(e),i=!function(e){const t=-1!==["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(e.tagName),i="INPUT"===e.tagName&&"hidden"===e.getAttribute("type");return t||i}(e);t&&i&&Ia(e,n)}))}function Ra(e,t){let i=-1;return e.some(((e,r)=>!!t(e)&&(i=r,!0))),i}function za(e,t){const i=[],r=e.container;if(!t.disableScrollLock){if(function(e){const t=$n(e);return t.body===e?qn(e).innerWidth>t.documentElement.clientWidth:e.scrollHeight>e.clientHeight}(r)){const e=Fs($n(r));i.push({value:r.style.paddingRight,property:"padding-right",el:r}),r.style.paddingRight=`${Da(r)+e}px`;const t=$n(r).querySelectorAll(".mui-fixed");[].forEach.call(t,(t=>{i.push({value:t.style.paddingRight,property:"padding-right",el:t}),t.style.paddingRight=`${Da(t)+e}px`}))}let e;if(r.parentNode instanceof DocumentFragment)e=$n(r).body;else{const t=r.parentElement,i=qn(r);e="HTML"===(null==t?void 0:t.nodeName)&&"scroll"===i.getComputedStyle(t).overflowY?t:r}i.push({value:e.style.overflow,property:"overflow",el:e},{value:e.style.overflowX,property:"overflow-x",el:e},{value:e.style.overflowY,property:"overflow-y",el:e}),e.style.overflow="hidden"}return()=>{i.forEach((e=>{let{value:t,el:i,property:r}=e;t?i.style.setProperty(r,t):i.style.removeProperty(r)}))}}const Oa=new class{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(e,t){let i=this.modals.indexOf(e);if(-1!==i)return i;i=this.modals.length,this.modals.push(e),e.modalRef&&Ia(e.modalRef,!1);const r=function(e){const t=[];return[].forEach.call(e.children,(e=>{"true"===e.getAttribute("aria-hidden")&&t.push(e)})),t}(t);La(t,e.mount,e.modalRef,r,!0);const n=Ra(this.containers,(e=>e.container===t));return-1!==n?(this.containers[n].modals.push(e),i):(this.containers.push({modals:[e],container:t,restore:null,hiddenSiblings:r}),i)}mount(e,t){const i=Ra(this.containers,(t=>-1!==t.modals.indexOf(e))),r=this.containers[i];r.restore||(r.restore=za(r,t))}remove(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const i=this.modals.indexOf(e);if(-1===i)return i;const r=Ra(this.containers,(t=>-1!==t.modals.indexOf(e))),n=this.containers[r];if(n.modals.splice(n.modals.indexOf(e),1),this.modals.splice(i,1),0===n.modals.length)n.restore&&n.restore(),e.modalRef&&Ia(e.modalRef,t),La(n.container,e.mount,e.modalRef,n.hiddenSiblings,!1),this.containers.splice(r,1);else{const e=n.modals[n.modals.length-1];e.modalRef&&Ia(e.modalRef,!1)}return i}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}};const Fa=function(t){const{container:i,disableEscapeKeyDown:r=!1,disableScrollLock:o=!1,manager:s=Oa,closeAfterTransition:a=!1,onTransitionEnter:l,onTransitionExited:c,children:u,onClose:h,open:d,rootRef:p}=t,f=e.useRef({}),m=e.useRef(null),g=e.useRef(null),y=Wn(g,p),[_,v]=e.useState(!d),x=function(e){return!!e&&e.props.hasOwnProperty("in")}(u);let b=!0;"false"!==t["aria-hidden"]&&!1!==t["aria-hidden"]||(b=!1);const w=()=>(f.current.modalRef=g.current,f.current.mount=m.current,f.current),S=()=>{s.mount(w(),{disableScrollLock:o}),g.current&&(g.current.scrollTop=0)},T=Yn((()=>{const e=function(e){return"function"===typeof e?e():e}(i)||$n(m.current).body;s.add(w(),e),g.current&&S()})),M=e.useCallback((()=>s.isTopModal(w())),[s]),A=Yn((e=>{m.current=e,e&&(d&&M()?S():g.current&&Ia(g.current,b))})),C=e.useCallback((()=>{s.remove(w(),b)}),[b,s]);e.useEffect((()=>()=>{C()}),[C]),e.useEffect((()=>{d?T():x&&a||C()}),[d,C,x,a,T]);const E=e=>t=>{var i;null==(i=e.onKeyDown)||i.call(e,t),"Escape"===t.key&&229!==t.which&&M()&&(r||(t.stopPropagation(),h&&h(t,"escapeKeyDown")))},P=e=>t=>{var i;null==(i=e.onClick)||i.call(e,t),t.target===t.currentTarget&&h&&h(t,"backdropClick")};return{getRootProps:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const i=As(t);delete i.onTransitionEnter,delete i.onTransitionExited;const r=(0,n.A)({},i,e);return(0,n.A)({role:"presentation"},r,{onKeyDown:E(r),ref:y})},getBackdropProps:function(){const e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.A)({"aria-hidden":!0},e,{onClick:P(e),open:d})},getTransitionProps:()=>({onEnter:ka((()=>{v(!1),l&&l()}),null==u?void 0:u.props.onEnter),onExited:ka((()=>{v(!0),c&&c(),a&&C()}),null==u?void 0:u.props.onExited)}),rootRef:y,portalRef:A,isTopModal:M,exited:_,hasTransition:x}};function Ba(e){return yo("MuiModal",e)}_o("MuiModal",["root","hidden","backdrop"]);const Na=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","onTransitionEnter","onTransitionExited","open","slotProps","slots","theme"],ja=Nn("div",{name:"MuiModal",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,!i.open&&i.exited&&t.hidden]}})((e=>{let{theme:t,ownerState:i}=e;return(0,n.A)({position:"fixed",zIndex:(t.vars||t).zIndex.modal,right:0,bottom:0,top:0,left:0},!i.open&&i.exited&&{visibility:"hidden"})})),Va=Nn(Pa,{name:"MuiModal",slot:"Backdrop",overridesResolver:(e,t)=>t.backdrop})({zIndex:-1}),Ua=e.forwardRef((function(t,i){var r,s,a,l,c,u;const h=Un({name:"MuiModal",props:t}),{BackdropComponent:d=Va,BackdropProps:p,className:f,closeAfterTransition:m=!1,children:g,container:y,component:_,components:v={},componentsProps:x={},disableAutoFocus:b=!1,disableEnforceFocus:w=!1,disableEscapeKeyDown:S=!1,disablePortal:T=!1,disableRestoreFocus:M=!1,disableScrollLock:A=!1,hideBackdrop:C=!1,keepMounted:E=!1,onBackdropClick:P,open:k,slotProps:I,slots:D}=h,L=(0,o.A)(h,Na),R=(0,n.A)({},h,{closeAfterTransition:m,disableAutoFocus:b,disableEnforceFocus:w,disableEscapeKeyDown:S,disablePortal:T,disableRestoreFocus:M,disableScrollLock:A,hideBackdrop:C,keepMounted:E}),{getRootProps:z,getBackdropProps:O,getTransitionProps:F,portalRef:B,isTopModal:N,exited:j,hasTransition:V}=Fa((0,n.A)({},R,{rootRef:i})),U=(0,n.A)({},R,{exited:j}),G=(e=>{const{open:t,exited:i,classes:r}=e;return Dn({root:["root",!t&&i&&"hidden"],backdrop:["backdrop"]},Ba,r)})(U),H={};if(void 0===g.props.tabIndex&&(H.tabIndex="-1"),V){const{onEnter:e,onExited:t}=F();H.onEnter=e,H.onExited=t}const W=null!=(r=null!=(s=null==D?void 0:D.root)?s:v.Root)?r:ja,$=null!=(a=null!=(l=null==D?void 0:D.backdrop)?l:v.Backdrop)?a:d,q=null!=(c=null==I?void 0:I.root)?c:x.root,X=null!=(u=null==I?void 0:I.backdrop)?u:x.backdrop,Z=Is({elementType:W,externalSlotProps:q,externalForwardedProps:L,getSlotProps:z,additionalProps:{ref:i,as:_},ownerState:U,className:In(f,null==q?void 0:q.className,null==G?void 0:G.root,!U.open&&U.exited&&(null==G?void 0:G.hidden))}),K=Is({elementType:$,externalSlotProps:X,additionalProps:p,getSlotProps:e=>O((0,n.A)({},e,{onClick:t=>{P&&P(t),null!=e&&e.onClick&&e.onClick(t)}})),className:In(null==X?void 0:X.className,null==p?void 0:p.className,null==G?void 0:G.backdrop),ownerState:U});return E||k||V&&!j?(0,Y.jsx)(wa,{ref:B,container:y,disablePortal:T,children:(0,Y.jsxs)(W,(0,n.A)({},Z,{children:[!C&&d?(0,Y.jsx)($,(0,n.A)({},K)):null,(0,Y.jsx)(ba,{disableEnforceFocus:w,disableAutoFocus:b,disableRestoreFocus:M,isEnabled:N,open:k,children:e.cloneElement(g,H)})]}))}):null})),Ga=e=>{let t;return t=e<1?5.11916*e**2:4.5*Math.log(e+1)+2,(t/100).toFixed(2)};function Ha(e){return yo("MuiPaper",e)}_o("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const Wa=["className","component","elevation","square","variant"],$a=Nn("div",{name:"MuiPaper",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,t[i.variant],!i.square&&t.rounded,"elevation"===i.variant&&t[`elevation${i.elevation}`]]}})((e=>{let{theme:t,ownerState:i}=e;var r;return(0,n.A)({backgroundColor:(t.vars||t).palette.background.paper,color:(t.vars||t).palette.text.primary,transition:t.transitions.create("box-shadow")},!i.square&&{borderRadius:t.shape.borderRadius},"outlined"===i.variant&&{border:`1px solid ${(t.vars||t).palette.divider}`},"elevation"===i.variant&&(0,n.A)({boxShadow:(t.vars||t).shadows[i.elevation]},!t.vars&&"dark"===t.palette.mode&&{backgroundImage:`linear-gradient(${(0,y.X4)("#fff",Ga(i.elevation))}, ${(0,y.X4)("#fff",Ga(i.elevation))})`},t.vars&&{backgroundImage:null==(r=t.vars.overlays)?void 0:r[i.elevation]}))})),qa=e.forwardRef((function(e,t){const i=Un({props:e,name:"MuiPaper"}),{className:r,component:s="div",elevation:a=1,square:l=!1,variant:c="elevation"}=i,u=(0,o.A)(i,Wa),h=(0,n.A)({},i,{component:s,elevation:a,square:l,variant:c}),d=(e=>{const{square:t,elevation:i,variant:r,classes:n}=e;return Dn({root:["root",r,!t&&"rounded","elevation"===r&&`elevation${i}`]},Ha,n)})(h);return(0,Y.jsx)($a,(0,n.A)({as:s,ownerState:h,className:In(d.root,r),ref:t},u))}));function Xa(e){return yo("MuiPopover",e)}_o("MuiPopover",["root","paper"]);const Ya=["onEntering"],Za=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps","disableScrollLock"],Ka=["slotProps"];function Ja(e,t){let i=0;return"number"===typeof t?i=t:"center"===t?i=e.height/2:"bottom"===t&&(i=e.height),i}function Qa(e,t){let i=0;return"number"===typeof t?i=t:"center"===t?i=e.width/2:"right"===t&&(i=e.width),i}function el(e){return[e.horizontal,e.vertical].map((e=>"number"===typeof e?`${e}px`:e)).join(" ")}function tl(e){return"function"===typeof e?e():e}const il=Nn(Ua,{name:"MuiPopover",slot:"Root",overridesResolver:(e,t)=>t.root})({}),rl=Nn(qa,{name:"MuiPopover",slot:"Paper",overridesResolver:(e,t)=>t.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),nl=e.forwardRef((function(t,i){var r,s,a;const l=Un({props:t,name:"MuiPopover"}),{action:c,anchorEl:u,anchorOrigin:h={vertical:"top",horizontal:"left"},anchorPosition:d,anchorReference:p="anchorEl",children:f,className:m,container:g,elevation:y=8,marginThreshold:_=16,open:v,PaperProps:x={},slots:b,slotProps:w,transformOrigin:S={vertical:"top",horizontal:"left"},TransitionComponent:T=ya,transitionDuration:M="auto",TransitionProps:{onEntering:A}={},disableScrollLock:C=!1}=l,E=(0,o.A)(l.TransitionProps,Ya),P=(0,o.A)(l,Za),k=null!=(r=null==w?void 0:w.paper)?r:x,I=e.useRef(),D=so(I,k.ref),L=(0,n.A)({},l,{anchorOrigin:h,anchorReference:p,elevation:y,marginThreshold:_,externalPaperSlotProps:k,transformOrigin:S,TransitionComponent:T,transitionDuration:M,TransitionProps:E}),R=(e=>{const{classes:t}=e;return Dn({root:["root"],paper:["paper"]},Xa,t)})(L),z=e.useCallback((()=>{if("anchorPosition"===p)return d;const e=tl(u),t=(e&&1===e.nodeType?e:Ss(I.current).body).getBoundingClientRect();return{top:t.top+Ja(t,h.vertical),left:t.left+Qa(t,h.horizontal)}}),[u,h.horizontal,h.vertical,d,p]),O=e.useCallback((e=>({vertical:Ja(e,S.vertical),horizontal:Qa(e,S.horizontal)})),[S.horizontal,S.vertical]),F=e.useCallback((e=>{const t={width:e.offsetWidth,height:e.offsetHeight},i=O(t);if("none"===p)return{top:null,left:null,transformOrigin:el(i)};const r=z();let n=r.top-i.vertical,o=r.left-i.horizontal;const s=n+t.height,a=o+t.width,l=$s(tl(u)),c=l.innerHeight-_,h=l.innerWidth-_;if(null!==_&&n<_){const e=n-_;n-=e,i.vertical+=e}else if(null!==_&&s>c){const e=s-c;n-=e,i.vertical+=e}if(null!==_&&o<_){const e=o-_;o-=e,i.horizontal+=e}else if(a>h){const e=a-h;o-=e,i.horizontal+=e}return{top:`${Math.round(n)}px`,left:`${Math.round(o)}px`,transformOrigin:el(i)}}),[u,p,z,O,_]),[B,N]=e.useState(v),j=e.useCallback((()=>{const e=I.current;if(!e)return;const t=F(e);null!==t.top&&(e.style.top=t.top),null!==t.left&&(e.style.left=t.left),e.style.transformOrigin=t.transformOrigin,N(!0)}),[F]);e.useEffect((()=>(C&&window.addEventListener("scroll",j),()=>window.removeEventListener("scroll",j))),[u,C,j]);e.useEffect((()=>{v&&j()})),e.useImperativeHandle(c,(()=>v?{updatePosition:()=>{j()}}:null),[v,j]),e.useEffect((()=>{if(!v)return;const e=Ws((()=>{j()})),t=$s(u);return t.addEventListener("resize",e),()=>{e.clear(),t.removeEventListener("resize",e)}}),[u,v,j]);let V=M;"auto"!==M||T.muiSupportAuto||(V=void 0);const U=g||(u?Ss(tl(u)).body:void 0),G=null!=(s=null==b?void 0:b.root)?s:il,H=null!=(a=null==b?void 0:b.paper)?a:rl,W=Is({elementType:H,externalSlotProps:(0,n.A)({},k,{style:B?k.style:(0,n.A)({},k.style,{opacity:0})}),additionalProps:{elevation:y,ref:D},ownerState:L,className:In(R.paper,null==k?void 0:k.className)}),$=Is({elementType:G,externalSlotProps:(null==w?void 0:w.root)||{},externalForwardedProps:P,additionalProps:{ref:i,slotProps:{backdrop:{invisible:!0}},container:U,open:v},ownerState:L,className:In(R.root,m)}),{slotProps:q}=$,X=(0,o.A)($,Ka);return(0,Y.jsx)(G,(0,n.A)({},X,!Gn(G)&&{slotProps:q,disableScrollLock:C},{children:(0,Y.jsx)(T,(0,n.A)({appear:!0,in:v,onEntering:(e,t)=>{A&&A(e,t),j()},onExited:()=>{N(!1)},timeout:V},E,{children:(0,Y.jsx)(H,(0,n.A)({},W,{children:f}))}))}))}));function ol(e){return yo("MuiMenu",e)}_o("MuiMenu",["root","paper","list"]);const sl=["onEntering"],al=["autoFocus","children","className","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant","slots","slotProps"],ll={vertical:"top",horizontal:"right"},cl={vertical:"top",horizontal:"left"},ul=Nn(nl,{shouldForwardProp:e=>Bn(e)||"classes"===e,name:"MuiMenu",slot:"Root",overridesResolver:(e,t)=>t.root})({}),hl=Nn(rl,{name:"MuiMenu",slot:"Paper",overridesResolver:(e,t)=>t.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),dl=Nn(Hs,{name:"MuiMenu",slot:"List",overridesResolver:(e,t)=>t.list})({outline:0}),pl=e.forwardRef((function(t,i){var r,s;const a=Un({props:t,name:"MuiMenu"}),{autoFocus:l=!0,children:c,className:u,disableAutoFocusItem:h=!1,MenuListProps:d={},onClose:p,open:f,PaperProps:m={},PopoverClasses:g,transitionDuration:y="auto",TransitionProps:{onEntering:_}={},variant:v="selectedMenu",slots:x={},slotProps:b={}}=a,w=(0,o.A)(a.TransitionProps,sl),S=(0,o.A)(a,al),T=(()=>{const t=e.useContext(Ts);return null!=t&&t})(),M=(0,n.A)({},a,{autoFocus:l,disableAutoFocusItem:h,MenuListProps:d,onEntering:_,PaperProps:m,transitionDuration:y,TransitionProps:w,variant:v}),A=(e=>{const{classes:t}=e;return Dn({root:["root"],paper:["paper"],list:["list"]},ol,t)})(M),C=l&&!h&&f,E=e.useRef(null);let P=-1;e.Children.map(c,((t,i)=>{e.isValidElement(t)&&(t.props.disabled||("selectedMenu"===v&&t.props.selected||-1===P)&&(P=i))}));const k=null!=(r=x.paper)?r:hl,I=null!=(s=b.paper)?s:m,D=Is({elementType:x.root,externalSlotProps:b.root,ownerState:M,className:[A.root,u]}),L=Is({elementType:k,externalSlotProps:I,ownerState:M,className:A.paper});return(0,Y.jsx)(ul,(0,n.A)({onClose:p,anchorOrigin:{vertical:"bottom",horizontal:T?"right":"left"},transformOrigin:T?ll:cl,slots:{paper:k,root:x.root},slotProps:{root:D,paper:L},open:f,ref:i,transitionDuration:y,TransitionProps:(0,n.A)({onEntering:(e,t)=>{E.current&&E.current.adjustStyleForScrollbar(e,{direction:T?"rtl":"ltr"}),_&&_(e,t)}},w),ownerState:M},S,{classes:g,children:(0,Y.jsx)(dl,(0,n.A)({onKeyDown:e=>{"Tab"===e.key&&(e.preventDefault(),p&&p(e,"tabKeyDown"))},actions:E,autoFocus:l&&(-1===P||h),autoFocusItem:C,variant:v},d,{className:In(A.list,d.className),children:c}))}))}));function fl(e){return yo("MuiNativeSelect",e)}const ml=_o("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),gl=["className","disabled","error","IconComponent","inputRef","variant"],yl=e=>{let{ownerState:t,theme:i}=e;return(0,n.A)({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":(0,n.A)({},i.vars?{backgroundColor:`rgba(${i.vars.palette.common.onBackgroundChannel} / 0.05)`}:{backgroundColor:"light"===i.palette.mode?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"},[`&.${ml.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(i.vars||i).palette.background.paper},"&&&":{paddingRight:24,minWidth:16}},"filled"===t.variant&&{"&&&":{paddingRight:32}},"outlined"===t.variant&&{borderRadius:(i.vars||i).shape.borderRadius,"&:focus":{borderRadius:(i.vars||i).shape.borderRadius},"&&&":{paddingRight:32}})},_l=Nn("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:Bn,overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.select,t[i.variant],i.error&&t.error,{[`&.${ml.multiple}`]:t.multiple}]}})(yl),vl=e=>{let{ownerState:t,theme:i}=e;return(0,n.A)({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(i.vars||i).palette.action.active,[`&.${ml.disabled}`]:{color:(i.vars||i).palette.action.disabled}},t.open&&{transform:"rotate(180deg)"},"filled"===t.variant&&{right:7},"outlined"===t.variant&&{right:7})},xl=Nn("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.icon,i.variant&&t[`icon${oo(i.variant)}`],i.open&&t.iconOpen]}})(vl),bl=e.forwardRef((function(t,i){const{className:r,disabled:s,error:a,IconComponent:l,inputRef:c,variant:u="standard"}=t,h=(0,o.A)(t,gl),d=(0,n.A)({},t,{disabled:s,variant:u,error:a}),p=(e=>{const{classes:t,variant:i,disabled:r,multiple:n,open:o,error:s}=e;return Dn({select:["select",i,r&&"disabled",n&&"multiple",s&&"error"],icon:["icon",`icon${oo(i)}`,o&&"iconOpen",r&&"disabled"]},fl,t)})(d);return(0,Y.jsxs)(e.Fragment,{children:[(0,Y.jsx)(_l,(0,n.A)({ownerState:d,className:In(p.select,r),disabled:s,ref:c||i},h)),t.multiple?null:(0,Y.jsx)(xl,{as:l,ownerState:d,className:p.icon})]})}));function wl(t){let{controlled:i,default:r,name:n,state:o="value"}=t;const{current:s}=e.useRef(void 0!==i),[a,l]=e.useState(r);return[s?i:a,e.useCallback((e=>{s||l(e)}),[])]}const Sl=wl;function Tl(e){return yo("MuiSelect",e)}const Ml=_o("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]);var Al;const Cl=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","error","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],El=Nn("div",{name:"MuiSelect",slot:"Select",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[{[`&.${Ml.select}`]:t.select},{[`&.${Ml.select}`]:t[i.variant]},{[`&.${Ml.error}`]:t.error},{[`&.${Ml.multiple}`]:t.multiple}]}})(yl,{[`&.${Ml.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),Pl=Nn("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.icon,i.variant&&t[`icon${oo(i.variant)}`],i.open&&t.iconOpen]}})(vl),kl=Nn("input",{shouldForwardProp:e=>Fn(e)&&"classes"!==e,name:"MuiSelect",slot:"NativeInput",overridesResolver:(e,t)=>t.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function Il(e,t){return"object"===typeof t&&null!==t?e===t:String(e)===String(t)}function Dl(e){return null==e||"string"===typeof e&&!e.trim()}const Ll=e.forwardRef((function(t,i){var r;const{"aria-describedby":s,"aria-label":a,autoFocus:l,autoWidth:c,children:u,className:h,defaultOpen:d,defaultValue:f,disabled:m,displayEmpty:g,error:y=!1,IconComponent:_,inputRef:v,labelId:x,MenuProps:b={},multiple:w,name:S,onBlur:T,onChange:M,onClose:A,onFocus:C,onOpen:E,open:P,readOnly:k,renderValue:I,SelectDisplayProps:D={},tabIndex:L,value:R,variant:z="standard"}=t,O=(0,o.A)(t,Cl),[F,B]=Sl({controlled:R,default:f,name:"Select"}),[N,j]=Sl({controlled:P,default:d,name:"Select"}),V=e.useRef(null),U=e.useRef(null),[G,H]=e.useState(null),{current:W}=e.useRef(null!=P),[$,q]=e.useState(),X=so(i,v),Z=e.useCallback((e=>{U.current=e,e&&H(e)}),[]),K=null==G?void 0:G.parentNode;e.useImperativeHandle(X,(()=>({focus:()=>{U.current.focus()},node:V.current,value:F})),[F]),e.useEffect((()=>{d&&N&&G&&!W&&(q(c?null:K.clientWidth),U.current.focus())}),[G,c]),e.useEffect((()=>{l&&U.current.focus()}),[l]),e.useEffect((()=>{if(!x)return;const e=Ss(U.current).getElementById(x);if(e){const t=()=>{getSelection().isCollapsed&&U.current.focus()};return e.addEventListener("click",t),()=>{e.removeEventListener("click",t)}}}),[x]);const J=(e,t)=>{e?E&&E(t):A&&A(t),W||(q(c?null:K.clientWidth),j(e))},Q=e.Children.toArray(u),ee=e=>t=>{let i;if(t.currentTarget.hasAttribute("tabindex")){if(w){i=Array.isArray(F)?F.slice():[];const t=F.indexOf(e.props.value);-1===t?i.push(e.props.value):i.splice(t,1)}else i=e.props.value;if(e.props.onClick&&e.props.onClick(t),F!==i&&(B(i),M)){const r=t.nativeEvent||t,n=new r.constructor(r.type,r);Object.defineProperty(n,"target",{writable:!0,value:{value:i,name:S}}),M(n,e)}w||J(!1,t)}},te=null!==G&&N;let ie,re;delete O["aria-invalid"];const ne=[];let oe=!1,se=!1;(po({value:F})||g)&&(I?ie=I(F):oe=!0);const ae=Q.map((t=>{if(!e.isValidElement(t))return null;let i;if(w){if(!Array.isArray(F))throw new Error((0,p.A)(2));i=F.some((e=>Il(e,t.props.value))),i&&oe&&ne.push(t.props.children)}else i=Il(F,t.props.value),i&&oe&&(re=t.props.children);return i&&(se=!0),e.cloneElement(t,{"aria-selected":i?"true":"false",onClick:ee(t),onKeyUp:e=>{" "===e.key&&e.preventDefault(),t.props.onKeyUp&&t.props.onKeyUp(e)},role:"option",selected:i,value:void 0,"data-value":t.props.value})}));oe&&(ie=w?0===ne.length?null:ne.reduce(((e,t,i)=>(e.push(t),i<ne.length-1&&e.push(", "),e)),[]):re);let le,ce=$;!c&&W&&G&&(ce=K.clientWidth),le="undefined"!==typeof L?L:m?null:0;const ue=D.id||(S?`mui-component-select-${S}`:void 0),he=(0,n.A)({},t,{variant:z,value:F,open:te,error:y}),de=(e=>{const{classes:t,variant:i,disabled:r,multiple:n,open:o,error:s}=e;return Dn({select:["select",i,r&&"disabled",n&&"multiple",s&&"error"],icon:["icon",`icon${oo(i)}`,o&&"iconOpen",r&&"disabled"],nativeInput:["nativeInput"]},Tl,t)})(he),pe=(0,n.A)({},b.PaperProps,null==(r=b.slotProps)?void 0:r.paper),fe=zn();return(0,Y.jsxs)(e.Fragment,{children:[(0,Y.jsx)(El,(0,n.A)({ref:Z,tabIndex:le,role:"combobox","aria-controls":fe,"aria-disabled":m?"true":void 0,"aria-expanded":te?"true":"false","aria-haspopup":"listbox","aria-label":a,"aria-labelledby":[x,ue].filter(Boolean).join(" ")||void 0,"aria-describedby":s,onKeyDown:e=>{if(!k){-1!==[" ","ArrowUp","ArrowDown","Enter"].indexOf(e.key)&&(e.preventDefault(),J(!0,e))}},onMouseDown:m||k?null:e=>{0===e.button&&(e.preventDefault(),U.current.focus(),J(!0,e))},onBlur:e=>{!te&&T&&(Object.defineProperty(e,"target",{writable:!0,value:{value:F,name:S}}),T(e))},onFocus:C},D,{ownerState:he,className:In(D.className,de.select,h),id:ue,children:Dl(ie)?Al||(Al=(0,Y.jsx)("span",{className:"notranslate",children:"\u200b"})):ie})),(0,Y.jsx)(kl,(0,n.A)({"aria-invalid":y,value:Array.isArray(F)?F.join(","):F,name:S,ref:V,"aria-hidden":!0,onChange:e=>{const t=Q.find((t=>t.props.value===e.target.value));void 0!==t&&(B(t.props.value),M&&M(e,t))},tabIndex:-1,disabled:m,className:de.nativeInput,autoFocus:l,ownerState:he},O)),(0,Y.jsx)(Pl,{as:_,className:de.icon,ownerState:he}),(0,Y.jsx)(pl,(0,n.A)({id:`menu-${S||""}`,anchorEl:K,open:te,onClose:e=>{J(!1,e)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},b,{MenuListProps:(0,n.A)({"aria-labelledby":x,role:"listbox","aria-multiselectable":w?"true":void 0,disableListWrap:!0,id:fe},b.MenuListProps),slotProps:(0,n.A)({},b.slotProps,{paper:(0,n.A)({},pe,{style:(0,n.A)({minWidth:ce},null!=pe?pe.style:null)})}),children:ae}))]})}));function Rl(e){return yo("MuiSvgIcon",e)}_o("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const zl=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],Ol=Nn("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,"inherit"!==i.color&&t[`color${oo(i.color)}`],t[`fontSize${oo(i.fontSize)}`]]}})((e=>{let{theme:t,ownerState:i}=e;var r,n,o,s,a,l,c,u,h,d,p,f,m;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:i.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:null==(r=t.transitions)||null==(n=r.create)?void 0:n.call(r,"fill",{duration:null==(o=t.transitions)||null==(o=o.duration)?void 0:o.shorter}),fontSize:{inherit:"inherit",small:(null==(s=t.typography)||null==(a=s.pxToRem)?void 0:a.call(s,20))||"1.25rem",medium:(null==(l=t.typography)||null==(c=l.pxToRem)?void 0:c.call(l,24))||"1.5rem",large:(null==(u=t.typography)||null==(h=u.pxToRem)?void 0:h.call(u,35))||"2.1875rem"}[i.fontSize],color:null!=(d=null==(p=(t.vars||t).palette)||null==(p=p[i.color])?void 0:p.main)?d:{action:null==(f=(t.vars||t).palette)||null==(f=f.action)?void 0:f.active,disabled:null==(m=(t.vars||t).palette)||null==(m=m.action)?void 0:m.disabled,inherit:void 0}[i.color]}})),Fl=e.forwardRef((function(t,i){const r=Un({props:t,name:"MuiSvgIcon"}),{children:s,className:a,color:l="inherit",component:c="svg",fontSize:u="medium",htmlColor:h,inheritViewBox:d=!1,titleAccess:p,viewBox:f="0 0 24 24"}=r,m=(0,o.A)(r,zl),g=e.isValidElement(s)&&"svg"===s.type,y=(0,n.A)({},r,{color:l,component:c,fontSize:u,instanceFontSize:t.fontSize,inheritViewBox:d,viewBox:f,hasSvgAsChild:g}),_={};d||(_.viewBox=f);const v=(e=>{const{color:t,fontSize:i,classes:r}=e;return Dn({root:["root","inherit"!==t&&`color${oo(t)}`,`fontSize${oo(i)}`]},Rl,r)})(y);return(0,Y.jsxs)(Ol,(0,n.A)({as:c,className:In(v.root,a),focusable:"false",color:h,"aria-hidden":!p||void 0,role:p?"img":void 0,ref:i},_,m,g&&s.props,{ownerState:y,children:[g?s.props.children:s,p?(0,Y.jsx)("title",{children:p}):null]}))}));Fl.muiName="SvgIcon";const Bl=Fl;function Nl(t,i){function r(e,r){return(0,Y.jsx)(Bl,(0,n.A)({"data-testid":`${i}Icon`,ref:r},e,{children:t}))}return r.muiName=Bl.muiName,e.memo(e.forwardRef(r))}const jl=Nl((0,Y.jsx)("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),Vl=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],Ul=["root"],Gl={name:"MuiSelect",overridesResolver:(e,t)=>t.root,shouldForwardProp:e=>Bn(e)&&"variant"!==e,slot:"Root"},Hl=Nn(zo,Gl)(""),Wl=Nn(es,Gl)(""),$l=Nn(Uo,Gl)(""),ql=e.forwardRef((function(t,i){const r=Un({name:"MuiSelect",props:t}),{autoWidth:s=!1,children:a,classes:l={},className:c,defaultOpen:u=!1,displayEmpty:h=!1,IconComponent:d=jl,id:p,input:m,inputProps:g,label:y,labelId:_,MenuProps:v,multiple:x=!1,native:b=!1,onClose:w,onOpen:S,open:T,renderValue:M,SelectDisplayProps:A,variant:C="outlined"}=r,E=(0,o.A)(r,Vl),P=b?bl:Ll,k=io({props:r,muiFormControl:no(),states:["variant","error"]}),I=k.variant||C,D=(0,n.A)({},r,{variant:I,classes:l}),L=(e=>{const{classes:t}=e;return t})(D),R=(0,o.A)(L,Ul),z=m||{standard:(0,Y.jsx)(Hl,{ownerState:D}),outlined:(0,Y.jsx)(Wl,{label:y,ownerState:D}),filled:(0,Y.jsx)($l,{ownerState:D})}[I],O=so(i,ws(z));return(0,Y.jsx)(e.Fragment,{children:e.cloneElement(z,(0,n.A)({inputComponent:P,inputProps:(0,n.A)({children:a,error:k.error,IconComponent:d,variant:I,type:void 0,multiple:x},b?{id:p}:{autoWidth:s,defaultOpen:u,displayEmpty:h,labelId:_,MenuProps:v,onClose:w,onOpen:S,open:T,renderValue:M,SelectDisplayProps:(0,n.A)({id:p},A)},g,{classes:g?(0,f.A)(R,g.classes):R},m?m.props.inputProps:{})},(x&&b||h)&&"outlined"===I?{notched:!0}:{},{ref:O,className:In(z.props.className,c,L.root)},!m&&{variant:I},E))})}));ql.muiName="Select";const Xl=ql;function Yl(e){return yo("MuiTextField",e)}_o("MuiTextField",["root"]);const Zl=["autoComplete","autoFocus","children","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","maxRows","minRows","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","select","SelectProps","type","value","variant"],Kl={standard:zo,filled:Uo,outlined:es},Jl=Nn(ms,{name:"MuiTextField",slot:"Root",overridesResolver:(e,t)=>t.root})({}),Ql=e.forwardRef((function(e,t){const i=Un({props:e,name:"MuiTextField"}),{autoComplete:r,autoFocus:s=!1,children:a,className:l,color:c="primary",defaultValue:u,disabled:h=!1,error:d=!1,FormHelperTextProps:p,fullWidth:f=!1,helperText:m,id:g,InputLabelProps:y,inputProps:_,InputProps:v,inputRef:x,label:b,maxRows:w,minRows:S,multiline:T=!1,name:M,onBlur:A,onChange:C,onFocus:E,placeholder:P,required:k=!1,rows:I,select:D=!1,SelectProps:L,type:R,value:z,variant:O="outlined"}=i,F=(0,o.A)(i,Zl),B=(0,n.A)({},i,{autoFocus:s,color:c,disabled:h,error:d,fullWidth:f,multiline:T,required:k,select:D,variant:O}),N=(e=>{const{classes:t}=e;return Dn({root:["root"]},Yl,t)})(B);const j={};"outlined"===O&&(y&&"undefined"!==typeof y.shrink&&(j.notched=y.shrink),j.label=b),D&&(L&&L.native||(j.id=void 0),j["aria-describedby"]=void 0);const V=zn(g),U=m&&V?`${V}-helper-text`:void 0,G=b&&V?`${V}-label`:void 0,H=Kl[O],W=(0,Y.jsx)(H,(0,n.A)({"aria-describedby":U,autoComplete:r,autoFocus:s,defaultValue:u,fullWidth:f,multiline:T,name:M,rows:I,maxRows:w,minRows:S,type:R,value:z,id:V,inputRef:x,onBlur:A,onChange:C,onFocus:E,placeholder:P,inputProps:_},j,v));return(0,Y.jsxs)(Jl,(0,n.A)({className:In(N.root,l),disabled:h,error:d,fullWidth:f,ref:t,required:k,color:c,variant:O,ownerState:B},F,{children:[null!=b&&""!==b&&(0,Y.jsx)(us,(0,n.A)({htmlFor:V,id:G},y,{children:b})),D?(0,Y.jsx)(Xl,(0,n.A)({"aria-describedby":U,id:V,labelId:G,value:z,input:W},L,{children:a})):W,m&&(0,Y.jsx)(bs,(0,n.A)({id:U},p,{children:m}))]}))})),ec=Yn;let tc=!0,ic=!1;const rc=new Ys,nc={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function oc(e){e.metaKey||e.altKey||e.ctrlKey||(tc=!0)}function sc(){tc=!1}function ac(){"hidden"===this.visibilityState&&ic&&(tc=!0)}function lc(e){const{target:t}=e;try{return t.matches(":focus-visible")}catch(i){}return tc||function(e){const{type:t,tagName:i}=e;return!("INPUT"!==i||!nc[t]||e.readOnly)||"TEXTAREA"===i&&!e.readOnly||!!e.isContentEditable}(t)}const cc=function(){const t=e.useCallback((e=>{var t;null!=e&&((t=e.ownerDocument).addEventListener("keydown",oc,!0),t.addEventListener("mousedown",sc,!0),t.addEventListener("pointerdown",sc,!0),t.addEventListener("touchstart",sc,!0),t.addEventListener("visibilitychange",ac,!0))}),[]),i=e.useRef(!1);return{isFocusVisibleRef:i,onFocus:function(e){return!!lc(e)&&(i.current=!0,!0)},onBlur:function(){return!!i.current&&(ic=!0,rc.start(100,(()=>{ic=!1})),i.current=!1,!0)},ref:t}};function uc(t,i){var r=Object.create(null);return t&&e.Children.map(t,(function(e){return e})).forEach((function(t){r[t.key]=function(t){return i&&(0,e.isValidElement)(t)?i(t):t}(t)})),r}function hc(e,t,i){return null!=i[t]?i[t]:e.props[t]}function dc(t,i,r){var n=uc(t.children),o=function(e,t){function i(i){return i in t?t[i]:e[i]}e=e||{},t=t||{};var r,n=Object.create(null),o=[];for(var s in e)s in t?o.length&&(n[s]=o,o=[]):o.push(s);var a={};for(var l in t){if(n[l])for(r=0;r<n[l].length;r++){var c=n[l][r];a[n[l][r]]=i(c)}a[l]=i(l)}for(r=0;r<o.length;r++)a[o[r]]=i(o[r]);return a}(i,n);return Object.keys(o).forEach((function(s){var a=o[s];if((0,e.isValidElement)(a)){var l=s in i,c=s in n,u=i[s],h=(0,e.isValidElement)(u)&&!u.props.in;!c||l&&!h?c||!l||h?c&&l&&(0,e.isValidElement)(u)&&(o[s]=(0,e.cloneElement)(a,{onExited:r.bind(null,a),in:u.props.in,exit:hc(a,"exit",t),enter:hc(a,"enter",t)})):o[s]=(0,e.cloneElement)(a,{in:!1}):o[s]=(0,e.cloneElement)(a,{onExited:r.bind(null,a),in:!0,exit:hc(a,"exit",t),enter:hc(a,"enter",t)})}})),o}var pc=Object.values||function(e){return Object.keys(e).map((function(t){return e[t]}))},fc=function(t){function i(e,i){var r,n=(r=t.call(this,e,i)||this).handleExited.bind(Tt(r));return r.state={contextValue:{isMounting:!0},handleExited:n,firstRender:!0},r}Ks(i,t);var r=i.prototype;return r.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},r.componentWillUnmount=function(){this.mounted=!1},i.getDerivedStateFromProps=function(t,i){var r,n,o=i.children,s=i.handleExited;return{children:i.firstRender?(r=t,n=s,uc(r.children,(function(t){return(0,e.cloneElement)(t,{onExited:n.bind(null,t),in:!0,appear:hc(t,"appear",r),enter:hc(t,"enter",r),exit:hc(t,"exit",r)})}))):dc(t,o,s),firstRender:!1}},r.handleExited=function(e,t){var i=uc(this.props.children);e.key in i||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState((function(t){var i=(0,n.A)({},t.children);return delete i[e.key],{children:i}})))},r.render=function(){var t=this.props,i=t.component,r=t.childFactory,n=(0,o.A)(t,["component","childFactory"]),s=this.state.contextValue,a=pc(this.state.children).map(r);return delete n.appear,delete n.enter,delete n.exit,null===i?e.createElement(Qs.Provider,{value:s},a):e.createElement(Qs.Provider,{value:s},e.createElement(i,n,a))},i}(e.Component);fc.propTypes={},fc.defaultProps={component:"div",childFactory:function(e){return e}};const mc=fc;var gc=i(3290);const yc=function(t){const{className:i,classes:r,pulsate:n=!1,rippleX:o,rippleY:s,rippleSize:a,in:l,onExited:c,timeout:u}=t,[h,d]=e.useState(!1),p=In(i,r.ripple,r.rippleVisible,n&&r.ripplePulsate),f={width:a,height:a,top:-a/2+s,left:-a/2+o},m=In(r.child,h&&r.childLeaving,n&&r.childPulsate);return l||h||d(!0),e.useEffect((()=>{if(!l&&null!=c){const e=setTimeout(c,u);return()=>{clearTimeout(e)}}}),[c,l,u]),(0,Y.jsx)("span",{className:p,style:f,children:(0,Y.jsx)("span",{className:m})})};const _c=_o("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),vc=["center","classes","className"];let xc,bc,wc,Sc,Tc=e=>e;const Mc=(0,gc.i7)(xc||(xc=Tc`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),Ac=(0,gc.i7)(bc||(bc=Tc`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),Cc=(0,gc.i7)(wc||(wc=Tc`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),Ec=Nn("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),Pc=Nn(yc,{name:"MuiTouchRipple",slot:"Ripple"})(Sc||(Sc=Tc`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),_c.rippleVisible,Mc,550,(e=>{let{theme:t}=e;return t.transitions.easing.easeInOut}),_c.ripplePulsate,(e=>{let{theme:t}=e;return t.transitions.duration.shorter}),_c.child,_c.childLeaving,Ac,550,(e=>{let{theme:t}=e;return t.transitions.easing.easeInOut}),_c.childPulsate,Cc,(e=>{let{theme:t}=e;return t.transitions.easing.easeInOut})),kc=e.forwardRef((function(t,i){const r=Un({props:t,name:"MuiTouchRipple"}),{center:s=!1,classes:a={},className:l}=r,c=(0,o.A)(r,vc),[u,h]=e.useState([]),d=e.useRef(0),p=e.useRef(null);e.useEffect((()=>{p.current&&(p.current(),p.current=null)}),[u]);const f=e.useRef(!1),m=Zs(),g=e.useRef(null),y=e.useRef(null),_=e.useCallback((e=>{const{pulsate:t,rippleX:i,rippleY:r,rippleSize:n,cb:o}=e;h((e=>[...e,(0,Y.jsx)(Pc,{classes:{ripple:In(a.ripple,_c.ripple),rippleVisible:In(a.rippleVisible,_c.rippleVisible),ripplePulsate:In(a.ripplePulsate,_c.ripplePulsate),child:In(a.child,_c.child),childLeaving:In(a.childLeaving,_c.childLeaving),childPulsate:In(a.childPulsate,_c.childPulsate)},timeout:550,pulsate:t,rippleX:i,rippleY:r,rippleSize:n},d.current)])),d.current+=1,p.current=o}),[a]),v=e.useCallback((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};const{pulsate:r=!1,center:n=s||t.pulsate,fakeElement:o=!1}=t;if("mousedown"===(null==e?void 0:e.type)&&f.current)return void(f.current=!1);"touchstart"===(null==e?void 0:e.type)&&(f.current=!0);const a=o?null:y.current,l=a?a.getBoundingClientRect():{width:0,height:0,left:0,top:0};let c,u,h;if(n||void 0===e||0===e.clientX&&0===e.clientY||!e.clientX&&!e.touches)c=Math.round(l.width/2),u=Math.round(l.height/2);else{const{clientX:t,clientY:i}=e.touches&&e.touches.length>0?e.touches[0]:e;c=Math.round(t-l.left),u=Math.round(i-l.top)}if(n)h=Math.sqrt((2*l.width**2+l.height**2)/3),h%2===0&&(h+=1);else{const e=2*Math.max(Math.abs((a?a.clientWidth:0)-c),c)+2,t=2*Math.max(Math.abs((a?a.clientHeight:0)-u),u)+2;h=Math.sqrt(e**2+t**2)}null!=e&&e.touches?null===g.current&&(g.current=()=>{_({pulsate:r,rippleX:c,rippleY:u,rippleSize:h,cb:i})},m.start(80,(()=>{g.current&&(g.current(),g.current=null)}))):_({pulsate:r,rippleX:c,rippleY:u,rippleSize:h,cb:i})}),[s,_,m]),x=e.useCallback((()=>{v({},{pulsate:!0})}),[v]),b=e.useCallback(((e,t)=>{if(m.clear(),"touchend"===(null==e?void 0:e.type)&&g.current)return g.current(),g.current=null,void m.start(0,(()=>{b(e,t)}));g.current=null,h((e=>e.length>0?e.slice(1):e)),p.current=t}),[m]);return e.useImperativeHandle(i,(()=>({pulsate:x,start:v,stop:b})),[x,v,b]),(0,Y.jsx)(Ec,(0,n.A)({className:In(_c.root,a.root,l),ref:y},c,{children:(0,Y.jsx)(mc,{component:null,exit:!0,children:u})}))}));function Ic(e){return yo("MuiButtonBase",e)}const Dc=_o("MuiButtonBase",["root","disabled","focusVisible"]),Lc=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],Rc=Nn("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${Dc.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),zc=e.forwardRef((function(t,i){const r=Un({props:t,name:"MuiButtonBase"}),{action:s,centerRipple:a=!1,children:l,className:c,component:u="button",disabled:h=!1,disableRipple:d=!1,disableTouchRipple:p=!1,focusRipple:f=!1,LinkComponent:m="a",onBlur:g,onClick:y,onContextMenu:_,onDragLeave:v,onFocus:x,onFocusVisible:b,onKeyDown:w,onKeyUp:S,onMouseDown:T,onMouseLeave:M,onMouseUp:A,onTouchEnd:C,onTouchMove:E,onTouchStart:P,tabIndex:k=0,TouchRippleProps:I,touchRippleRef:D,type:L}=r,R=(0,o.A)(r,Lc),z=e.useRef(null),O=e.useRef(null),F=so(O,D),{isFocusVisibleRef:B,onFocus:N,onBlur:j,ref:V}=cc(),[U,G]=e.useState(!1);h&&U&&G(!1),e.useImperativeHandle(s,(()=>({focusVisible:()=>{G(!0),z.current.focus()}})),[]);const[H,W]=e.useState(!1);e.useEffect((()=>{W(!0)}),[]);const $=H&&!d&&!h;function q(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:p;return ec((r=>{t&&t(r);return!i&&O.current&&O.current[e](r),!0}))}e.useEffect((()=>{U&&f&&!d&&H&&O.current.pulsate()}),[d,f,U,H]);const X=q("start",T),Z=q("stop",_),K=q("stop",v),J=q("stop",A),Q=q("stop",(e=>{U&&e.preventDefault(),M&&M(e)})),ee=q("start",P),te=q("stop",C),ie=q("stop",E),re=q("stop",(e=>{j(e),!1===B.current&&G(!1),g&&g(e)}),!1),ne=ec((e=>{z.current||(z.current=e.currentTarget),N(e),!0===B.current&&(G(!0),b&&b(e)),x&&x(e)})),oe=()=>{const e=z.current;return u&&"button"!==u&&!("A"===e.tagName&&e.href)},se=e.useRef(!1),ae=ec((e=>{f&&!se.current&&U&&O.current&&" "===e.key&&(se.current=!0,O.current.stop(e,(()=>{O.current.start(e)}))),e.target===e.currentTarget&&oe()&&" "===e.key&&e.preventDefault(),w&&w(e),e.target===e.currentTarget&&oe()&&"Enter"===e.key&&!h&&(e.preventDefault(),y&&y(e))})),le=ec((e=>{f&&" "===e.key&&O.current&&U&&!e.defaultPrevented&&(se.current=!1,O.current.stop(e,(()=>{O.current.pulsate(e)}))),S&&S(e),y&&e.target===e.currentTarget&&oe()&&" "===e.key&&!e.defaultPrevented&&y(e)}));let ce=u;"button"===ce&&(R.href||R.to)&&(ce=m);const ue={};"button"===ce?(ue.type=void 0===L?"button":L,ue.disabled=h):(R.href||R.to||(ue.role="button"),h&&(ue["aria-disabled"]=h));const he=so(i,V,z);const de=(0,n.A)({},r,{centerRipple:a,component:u,disabled:h,disableRipple:d,disableTouchRipple:p,focusRipple:f,tabIndex:k,focusVisible:U}),pe=(e=>{const{disabled:t,focusVisible:i,focusVisibleClassName:r,classes:n}=e,o=Dn({root:["root",t&&"disabled",i&&"focusVisible"]},Ic,n);return i&&r&&(o.root+=` ${r}`),o})(de);return(0,Y.jsxs)(Rc,(0,n.A)({as:ce,className:In(pe.root,c),ownerState:de,onBlur:re,onClick:y,onContextMenu:Z,onFocus:ne,onKeyDown:ae,onKeyUp:le,onMouseDown:X,onMouseLeave:Q,onMouseUp:J,onDragLeave:K,onTouchEnd:te,onTouchMove:ie,onTouchStart:ee,ref:he,tabIndex:h?-1:k,type:L},ue,R,{children:[l,$?(0,Y.jsx)(kc,(0,n.A)({ref:F,center:a},I)):null]}))}));const Oc=_o("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]);const Fc=_o("MuiListItemIcon",["root","alignItemsFlexStart"]);const Bc=_o("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]);function Nc(e){return yo("MuiMenuItem",e)}const jc=_o("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),Vc=["autoFocus","component","dense","divider","disableGutters","focusVisibleClassName","role","tabIndex","className"],Uc=Nn(zc,{shouldForwardProp:e=>Bn(e)||"classes"===e,name:"MuiMenuItem",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,i.dense&&t.dense,i.divider&&t.divider,!i.disableGutters&&t.gutters]}})((e=>{let{theme:t,ownerState:i}=e;return(0,n.A)({},t.typography.body1,{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap"},!i.disableGutters&&{paddingLeft:16,paddingRight:16},i.divider&&{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"},{"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${jc.selected}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:(0,y.X4)(t.palette.primary.main,t.palette.action.selectedOpacity),[`&.${jc.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:(0,y.X4)(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},[`&.${jc.selected}:hover`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:(0,y.X4)(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:(0,y.X4)(t.palette.primary.main,t.palette.action.selectedOpacity)}},[`&.${jc.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${jc.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},[`& + .${Oc.root}`]:{marginTop:t.spacing(1),marginBottom:t.spacing(1)},[`& + .${Oc.inset}`]:{marginLeft:52},[`& .${Bc.root}`]:{marginTop:0,marginBottom:0},[`& .${Bc.inset}`]:{paddingLeft:36},[`& .${Fc.root}`]:{minWidth:36}},!i.dense&&{[t.breakpoints.up("sm")]:{minHeight:"auto"}},i.dense&&(0,n.A)({minHeight:32,paddingTop:4,paddingBottom:4},t.typography.body2,{[`& .${Fc.root} svg`]:{fontSize:"1.25rem"}}))})),Gc=e.forwardRef((function(t,i){const r=Un({props:t,name:"MuiMenuItem"}),{autoFocus:s=!1,component:a="li",dense:l=!1,divider:c=!1,disableGutters:u=!1,focusVisibleClassName:h,role:d="menuitem",tabIndex:p,className:f}=r,m=(0,o.A)(r,Vc),g=e.useContext(Ds),y=e.useMemo((()=>({dense:l||g.dense||!1,disableGutters:u})),[g.dense,l,u]),_=e.useRef(null);ao((()=>{s&&_.current&&_.current.focus()}),[s]);const v=(0,n.A)({},r,{dense:y.dense,divider:c,disableGutters:u}),x=(e=>{const{disabled:t,dense:i,divider:r,disableGutters:o,selected:s,classes:a}=e,l=Dn({root:["root",i&&"dense",t&&"disabled",!o&&"gutters",r&&"divider",s&&"selected"]},Nc,a);return(0,n.A)({},a,l)})(r),b=so(_,i);let w;return r.disabled||(w=void 0!==p?p:-1),(0,Y.jsx)(Ds.Provider,{value:y,children:(0,Y.jsx)(Uc,(0,n.A)({ref:b,role:d,tabIndex:w,component:a,focusVisibleClassName:In(x.focusVisible,h),className:In(x.root,f)},m,{ownerState:v,classes:x}))})})),Hc=(0,e.createContext)({userSelections:null,setterFuncs:null}),Wc=t=>{let{children:i}=t;const{soilData:r,cropInfo:n,seasonStartYear:o}=(0,e.useContext)(zr),[s,a]=(0,e.useState)(Object.keys(r.labels)[0]),[l,c]=(0,e.useState)(Object.keys(n)[0]),[u,h]=(0,e.useState)(new Date(`${o}-05-15T00:00`)),[d,p]=(0,e.useState)(""),f={userSelections:{waterCapacity:s,cropType:l,plantDate:u,irrigationDate:d},setterFuncs:{setWaterCapacity:a,setCropType:c,setPlantDate:h,setIrrigationDate:p}};return(0,Y.jsx)(Hc.Provider,{value:f,children:i})};function $c(){const{soilData:t}=(0,e.useContext)(zr),{userSelections:i,setterFuncs:r}=(0,e.useContext)(Hc);return(0,Y.jsx)(Ql,{select:!0,value:i.waterCapacity,onChange:e=>r.setWaterCapacity(e.target.value),label:"Soil Water Capacity",children:Object.entries(t.labels).map((e=>{let[t,i]=e;return(0,Y.jsx)(Gc,{value:t,children:i},t)}))})}function qc(){const{cropInfo:t}=(0,e.useContext)(zr),{userSelections:i,setterFuncs:r}=(0,e.useContext)(Hc);return(0,Y.jsxs)(Ql,{select:!0,value:i.cropType,onChange:e=>r.setCropType(e.target.value),label:"Crop Type",children:[Object.entries(t).map((e=>{let[t,i]=e;return(0,Y.jsx)(Gc,{value:t,children:i.label},t)})),"select"]})}function Xc(t,i,r,n,o){const[s,a]=e.useState((()=>o&&r?r(t).matches:n?n(t).matches:i));return Xn((()=>{let e=!0;if(!r)return;const i=r(t),n=()=>{e&&a(i.matches)};return n(),i.addListener(n),()=>{e=!1,i.removeListener(n)}}),[t,r]),s}const Yc=t.useSyncExternalStore;function Zc(t,i,r,n,o){const s=e.useCallback((()=>i),[i]),a=e.useMemo((()=>{if(o&&r)return()=>r(t).matches;if(null!==n){const{matches:e}=n(t);return()=>e}return s}),[s,t,n,o,r]),[l,c]=e.useMemo((()=>{if(null===r)return[s,()=>()=>{}];const e=r(t);return[()=>e.matches,t=>(e.addListener(t),()=>{e.removeListener(t)})]}),[s,r,t]);return Yc(c,l,a)}function Kc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=u(),r="undefined"!==typeof window&&"undefined"!==typeof window.matchMedia,{defaultMatches:n=!1,matchMedia:o=(r?window.matchMedia:null),ssrMatchMedia:s=null,noSsr:l=!1}=a({name:"MuiUseMediaQuery",props:t,theme:i});let c="function"===typeof e?e(i):e;c=c.replace(/^@media( ?)/m,"");return(void 0!==Yc?Zc:Xc)(c,n,o,s,l)}var Jc=i(5173),Qc=i.n(Jc);function eu(e,t,i){return"function"===typeof e?e(t,i):e}const tu=Qc().oneOfType([Qc().func,Qc().object]),iu=(e,t)=>e.length===t.length&&t.every((t=>e.includes(t))),ru=(e,t,i)=>{let r=t;return r=e.setHours(r,e.getHours(i)),r=e.setMinutes(r,e.getMinutes(i)),r=e.setSeconds(r,e.getSeconds(i)),r},nu=e=>{let{date:t,disableFuture:i,disablePast:r,maxDate:n,minDate:o,isDateDisabled:s,utils:a,timezone:l}=e;const c=ru(a,a.dateWithTimezone(void 0,l),t);r&&a.isBefore(o,c)&&(o=c),i&&a.isAfter(n,c)&&(n=c);let u=t,h=t;for(a.isBefore(t,o)&&(u=o,h=null),a.isAfter(t,n)&&(h&&(h=n),u=null);u||h;){if(u&&a.isAfter(u,n)&&(u=null),h&&a.isBefore(h,o)&&(h=null),u){if(!s(u))return u;u=a.addDays(u,1)}if(h){if(!s(h))return h;h=a.addDays(h,-1)}}return null},ou=(e,t,i)=>null!=t&&e.isValid(t)?t:i,su=(e,t)=>{const i=[e.startOfYear(t)];for(;i.length<12;){const t=i[i.length-1];i.push(e.addMonths(t,1))}return i},au=(e,t,i)=>"date"===i?e.startOfDay(e.dateWithTimezone(void 0,t)):e.dateWithTimezone(void 0,t),lu=["year","month","day"],cu=e=>lu.includes(e),uu=(e,t,i)=>{let{format:r,views:n}=t;if(null!=r)return r;const o=e.formats;return iu(n,["year"])?o.year:iu(n,["month"])?o.month:iu(n,["day"])?o.dayOfMonth:iu(n,["month","year"])?`${o.month} ${o.year}`:iu(n,["day","month"])?`${o.month} ${o.dayOfMonth}`:i?/en/.test(e.getCurrentLocaleCode())?o.normalDateWithWeekday:o.normalDate:o.keyboardDate},hu=(e,t)=>{const i=e.startOfWeek(t);return[0,1,2,3,4,5,6].map((t=>e.addDays(i,t)))},du=["hours","minutes","seconds"],pu=(e,t)=>3600*t.getHours(e)+60*t.getMinutes(e)+t.getSeconds(e),fu={year:1,month:2,day:3,hours:4,minutes:5,seconds:6,milliseconds:7},mu=(e,t,i)=>{if(t===fu.year)return e.startOfYear(i);if(t===fu.month)return e.startOfMonth(i);if(t===fu.day)return e.startOfDay(i);let r=i;return t<fu.minutes&&(r=e.setMinutes(r,0)),t<fu.seconds&&(r=e.setSeconds(r,0)),t<fu.milliseconds&&(r=e.setMilliseconds(r,0)),r},gu=e=>{let{props:t,utils:i,granularity:r,timezone:n,getTodayDate:o}=e;var s;let a=o?o():mu(i,r,au(i,n));null!=t.minDate&&i.isAfterDay(t.minDate,a)&&(a=mu(i,r,t.minDate)),null!=t.maxDate&&i.isBeforeDay(t.maxDate,a)&&(a=mu(i,r,t.maxDate));const l=((e,t)=>(i,r)=>e?t.isAfter(i,r):pu(i,t)>pu(r,t))(null!=(s=t.disableIgnoringDatePartForTimeValidation)&&s,i);return null!=t.minTime&&l(t.minTime,a)&&(a=mu(i,r,t.disableIgnoringDatePartForTimeValidation?t.minTime:ru(i,a,t.minTime))),null!=t.maxTime&&l(a,t.maxTime)&&(a=mu(i,r,t.disableIgnoringDatePartForTimeValidation?t.maxTime:ru(i,a,t.maxTime))),a},yu=(e,t)=>{const i=e.formatTokenMap[t];if(null==i)throw new Error([`MUI: The token "${t}" is not supported by the Date and Time Pickers.`,"Please try using another token or open an issue on https://github.com/mui/mui-x/issues/new/choose if you think it should be supported."].join("\n"));return"string"===typeof i?{type:i,contentType:"meridiem"===i?"letter":"digit",maxLength:void 0}:{type:i.sectionType,contentType:i.contentType,maxLength:i.maxLength}},_u=(e,t,i)=>{const r=[],n=e.dateWithTimezone(void 0,t),o=e.startOfWeek(n),s=e.endOfWeek(n);let a=o;for(;e.isBefore(a,s);)r.push(a),a=e.addDays(a,1);return r.map((t=>e.formatByString(t,i)))},vu=(e,t,i,r)=>{switch(i){case"month":return su(e,e.dateWithTimezone(void 0,t)).map((t=>e.formatByString(t,r)));case"weekDay":return _u(e,t,r);case"meridiem":{const i=e.dateWithTimezone(void 0,t);return[e.startOfDay(i),e.endOfDay(i)].map((t=>e.formatByString(t,r)))}default:return[]}},xu=(e,t,i)=>{let r=t;for(r=Number(r).toString();r.length<i;)r=`0${r}`;return r},bu=(e,t,i,r,n)=>{if("day"===n.type&&"digit-with-letter"===n.contentType){const t=e.setDate(r.longestMonth,i);return e.formatByString(t,n.format)}const o=i.toString();return n.hasLeadingZerosInInput?xu(0,o,n.maxLength):o},wu=(e,t,i,r,n,o,s)=>{const a=(e=>{switch(e){case"ArrowUp":return 1;case"ArrowDown":return-1;case"PageUp":return 5;case"PageDown":return-5;default:return 0}})(r),l="Home"===r,c="End"===r,u=""===i.value||l||c;return"digit"===i.contentType||"digit-with-letter"===i.contentType?(()=>{const r=n[i.type]({currentDate:o,format:i.format,contentType:i.contentType}),h=t=>bu(e,0,t,r,i),d="minutes"===i.type&&null!=s&&s.minutesStep?s.minutesStep:1;let p=parseInt(i.value,10)+a*d;if(u){if("year"===i.type&&!c&&!l)return e.formatByString(e.dateWithTimezone(void 0,t),i.format);p=a>0||l?r.minimum:r.maximum}return p%d!==0&&((a<0||l)&&(p+=d-(d+p)%d),(a>0||c)&&(p-=p%d)),p>r.maximum?h(r.minimum+(p-r.maximum-1)%(r.maximum-r.minimum+1)):p<r.minimum?h(r.maximum-(r.minimum-p-1)%(r.maximum-r.minimum+1)):h(p)})():(()=>{const r=vu(e,t,i.type,i.format);if(0===r.length)return i.value;if(u)return a>0||l?r[0]:r[r.length-1];const n=r.indexOf(i.value);return r[(n+r.length+a)%r.length]})()},Su=(e,t)=>{let i=e.value||e.placeholder;const r="non-input"===t?e.hasLeadingZerosInFormat:e.hasLeadingZerosInInput;"non-input"===t&&e.hasLeadingZerosInInput&&!e.hasLeadingZerosInFormat&&(i=Number(i).toString());return["input-rtl","input-ltr"].includes(t)&&"digit"===e.contentType&&!r&&1===i.length&&(i=`${i}\u200e`),"input-rtl"===t&&(i=`\u2068${i}\u2069`),i},Tu=e=>e.replace(/[\u2066\u2067\u2068\u2069]/g,""),Mu=(e,t)=>{let i=0,r=t?1:0;const o=[];for(let s=0;s<e.length;s+=1){const a=e[s],l=Su(a,t?"input-rtl":"input-ltr"),c=`${a.startSeparator}${l}${a.endSeparator}`,u=Tu(c).length,h=c.length,d=Tu(l),p=r+l.indexOf(d[0])+a.startSeparator.length,f=p+d.length;o.push((0,n.A)({},a,{start:i,end:i+u,startInInput:p,endInInput:f})),i+=u,r+=h}return o},Au=(e,t,i,r,n)=>{switch(r.type){case"year":return i.fieldYearPlaceholder({digitAmount:e.formatByString(e.dateWithTimezone(void 0,t),n).length,format:n});case"month":return i.fieldMonthPlaceholder({contentType:r.contentType,format:n});case"day":return i.fieldDayPlaceholder({format:n});case"weekDay":return i.fieldWeekDayPlaceholder({contentType:r.contentType,format:n});case"hours":return i.fieldHoursPlaceholder({format:n});case"minutes":return i.fieldMinutesPlaceholder({format:n});case"seconds":return i.fieldSecondsPlaceholder({format:n});case"meridiem":return i.fieldMeridiemPlaceholder({format:n});default:return n}},Cu=(e,t,i,r)=>e.formatByString(e.parse(t,i),r),Eu=(e,t,i)=>4===e.formatByString(e.dateWithTimezone(void 0,t),i).length,Pu=(e,t,i,r,n)=>{if("digit"!==i)return!1;const o=e.dateWithTimezone(void 0,t);switch(r){case"year":if(Eu(e,t,n)){return"0001"===e.formatByString(e.setYear(o,1),n)}return"01"===e.formatByString(e.setYear(o,2001),n);case"month":return e.formatByString(e.startOfYear(o),n).length>1;case"day":return e.formatByString(e.startOfMonth(o),n).length>1;case"weekDay":return e.formatByString(e.startOfWeek(o),n).length>1;case"hours":return e.formatByString(e.setHours(o,1),n).length>1;case"minutes":return e.formatByString(e.setMinutes(o,1),n).length>1;case"seconds":return e.formatByString(e.setSeconds(o,1),n).length>1;default:throw new Error("Invalid section type")}},ku=(e,t,i,r,o,s,a,l)=>{let c="";const u=[],h=e.date(),d=r=>{if(""===r)return null;const s=yu(e,r),l=Pu(e,t,s.contentType,s.type,r),d=a?l:"digit"===s.contentType,p=null!=o&&e.isValid(o);let f=p?e.formatByString(o,r):"",m=null;if(d)if(l)m=""===f?e.formatByString(h,r).length:f.length;else{if(null==s.maxLength)throw new Error(`MUI: The token ${r} should have a 'maxDigitNumber' property on it's adapter`);m=s.maxLength,p&&(f=xu(0,f,m))}return u.push((0,n.A)({},s,{format:r,maxLength:m,value:f,placeholder:Au(e,t,i,s,r),hasLeadingZeros:l,hasLeadingZerosInFormat:l,hasLeadingZerosInInput:d,startSeparator:0===u.length?c:"",endSeparator:"",modified:!1})),null};let p=10,f=r,m=e.expandFormat(r);for(;m!==f;)if(f=m,m=e.expandFormat(f),p-=1,p<0)throw new Error("MUI: The format expansion seems to be  enter in an infinite loop. Please open an issue with the format passed to the picker component");const g=m,y=((e,t)=>{const i=[],{start:r,end:n}=e.escapedCharacters,o=new RegExp(`(\\${r}[^\\${n}]*\\${n})+`,"g");let s=null;for(;s=o.exec(t);)i.push({start:s.index,end:o.lastIndex-1});return i})(e,g),_=new RegExp(`^(${Object.keys(e.formatTokenMap).sort(((e,t)=>t.length-e.length)).join("|")})`,"g");let v="";for(let n=0;n<g.length;n+=1){const e=y.find((e=>e.start<=n&&e.end>=n)),t=g[n],i=null!=e,r=`${v}${g.slice(n)}`,o=_.test(r);if(!i&&t.match(/([A-Za-z]+)/)&&o)v=r.slice(0,_.lastIndex),n+=_.lastIndex-1;else{i&&(null==e?void 0:e.start)===n||(null==e?void 0:e.end)===n||(d(v),v="",0===u.length?c+=t:u[u.length-1].endSeparator+=t)}}return d(v),u.map((e=>{const t=e=>{let t=e;return l&&null!==t&&t.includes(" ")&&(t=`\u2069${t}\u2066`),"spacious"===s&&["/",".","-"].includes(t)&&(t=` ${t} `),t};return e.startSeparator=t(e.startSeparator),e.endSeparator=t(e.endSeparator),e}))};const Iu=(e,t)=>{0},Du={year:1,month:2,day:3,weekDay:4,hours:5,minutes:6,seconds:7,meridiem:8},Lu=(e,t,i,r,n,o)=>[...r].sort(((e,t)=>Du[e.type]-Du[t.type])).reduce(((r,n)=>!o||n.modified?((e,t,i,r,n)=>{switch(i.type){case"year":return e.setYear(n,e.getYear(r));case"month":return e.setMonth(n,e.getMonth(r));case"weekDay":{const n=_u(e,t,i.format),o=e.formatByString(r,i.format),s=n.indexOf(o),a=n.indexOf(i.value)-s;return e.addDays(r,a)}case"day":return e.setDate(n,e.getDate(r));case"meridiem":{const t=e.getHours(r)<12,i=e.getHours(n);return t&&i>=12?e.addHours(n,-12):!t&&i<12?e.addHours(n,12):n}case"hours":return e.setHours(n,e.getHours(r));case"minutes":return e.setMinutes(n,e.getMinutes(r));case"seconds":return e.setSeconds(n,e.getSeconds(r));default:return n}})(e,t,n,i,r):r),n),Ru=["value","referenceDate"],zu={emptyValue:null,getTodayValue:au,getInitialReferenceValue:e=>{let{value:t,referenceDate:i}=e,r=(0,o.A)(e,Ru);return null!=t&&r.utils.isValid(t)?t:null!=i?i:gu(r)},cleanValue:(e,t)=>null!=t&&e.isValid(t)?t:null,areValuesEqual:(e,t,i)=>!e.isValid(t)&&null!=t&&!e.isValid(i)&&null!=i||e.isEqual(t,i),isSameError:(e,t)=>e===t,hasError:e=>null!=e,defaultErrorState:null,getTimezone:(e,t)=>null!=t&&e.isValid(t)?e.getTimezone(t):null,setTimezone:(e,t,i)=>null==i?null:e.setTimezone(i,t)},Ou={updateReferenceValue:(e,t,i)=>null!=t&&e.isValid(t)?t:i,getSectionsFromValue:(e,t,i,r,n)=>!e.isValid(t)&&!!i?i:Mu(n(t),r),getValueStrFromSections:(e,t)=>{const i=e.map((e=>{const i=Su(e,t?"input-rtl":"input-ltr");return`${e.startSeparator}${i}${e.endSeparator}`})).join("");return t?`\u2066${i}\u2069`:i},getActiveDateManager:(e,t)=>({date:t.value,referenceDate:t.referenceValue,getSections:e=>e,getNewValuesFromNewActiveDate:i=>({value:i,referenceValue:null!=i&&e.isValid(i)?i:t.referenceValue})}),parseValueStr:(e,t,i)=>i(e.trim(),t)},Fu={previousMonth:"Previous month",nextMonth:"Next month",openPreviousView:"open previous view",openNextView:"open next view",calendarViewSwitchingButtonAriaLabel:e=>"year"===e?"year view is open, switch to calendar view":"calendar view is open, switch to year view",start:"Start",end:"End",cancelButtonLabel:"Cancel",clearButtonLabel:"Clear",okButtonLabel:"OK",todayButtonLabel:"Today",datePickerToolbarTitle:"Select date",dateTimePickerToolbarTitle:"Select date & time",timePickerToolbarTitle:"Select time",dateRangePickerToolbarTitle:"Select date range",clockLabelText:(e,t,i)=>`Select ${e}. ${null===t?"No time selected":`Selected time is ${i.format(t,"fullTime")}`}`,hoursClockNumberText:e=>`${e} hours`,minutesClockNumberText:e=>`${e} minutes`,secondsClockNumberText:e=>`${e} seconds`,selectViewText:e=>`Select ${e}`,calendarWeekNumberHeaderLabel:"Week number",calendarWeekNumberHeaderText:"#",calendarWeekNumberAriaLabelText:e=>`Week ${e}`,calendarWeekNumberText:e=>`${e}`,openDatePickerDialogue:(e,t)=>null!==e&&t.isValid(e)?`Choose date, selected date is ${t.format(e,"fullDate")}`:"Choose date",openTimePickerDialogue:(e,t)=>null!==e&&t.isValid(e)?`Choose time, selected time is ${t.format(e,"fullTime")}`:"Choose time",fieldClearLabel:"Clear value",timeTableLabel:"pick time",dateTableLabel:"pick date",fieldYearPlaceholder:e=>"Y".repeat(e.digitAmount),fieldMonthPlaceholder:e=>"letter"===e.contentType?"MMMM":"MM",fieldDayPlaceholder:()=>"DD",fieldWeekDayPlaceholder:e=>"letter"===e.contentType?"EEEE":"EE",fieldHoursPlaceholder:()=>"hh",fieldMinutesPlaceholder:()=>"mm",fieldSecondsPlaceholder:()=>"ss",fieldMeridiemPlaceholder:()=>"aa"},Bu=Fu;Nu=Fu,(0,n.A)({},Nu);var Nu;const ju=()=>{const t=e.useContext(K);if(null===t)throw new Error(["MUI: Can not find the date and time pickers localization context.","It looks like you forgot to wrap your component in LocalizationProvider.","This can also happen if you are bundling multiple versions of the `@mui/x-date-pickers` package"].join("\n"));if(null===t.utils)throw new Error(["MUI: Can not find the date and time pickers adapter from its localization context.","It looks like you forgot to pass a `dateAdapter` to your LocalizationProvider."].join("\n"));const i=e.useMemo((()=>(0,n.A)({},Bu,t.localeText)),[t.localeText]);return e.useMemo((()=>(0,n.A)({},t,{localeText:i})),[t,i])},Vu=()=>ju().utils,Uu=()=>ju().defaultDates,Gu=()=>ju().localeText,Hu=t=>{const i=Vu(),r=e.useRef();return void 0===r.current&&(r.current=i.dateWithTimezone(void 0,t)),r.current};var Wu=i(8698);function $u(e){return yo("MuiTypography",e)}_o("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const qu=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],Xu=Nn("span",{name:"MuiTypography",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,i.variant&&t[i.variant],"inherit"!==i.align&&t[`align${oo(i.align)}`],i.noWrap&&t.noWrap,i.gutterBottom&&t.gutterBottom,i.paragraph&&t.paragraph]}})((e=>{let{theme:t,ownerState:i}=e;return(0,n.A)({margin:0},"inherit"===i.variant&&{font:"inherit"},"inherit"!==i.variant&&t.typography[i.variant],"inherit"!==i.align&&{textAlign:i.align},i.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},i.gutterBottom&&{marginBottom:"0.35em"},i.paragraph&&{marginBottom:16})})),Yu={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},Zu={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},Ku=e.forwardRef((function(e,t){const i=Un({props:e,name:"MuiTypography"}),r=(e=>Zu[e]||e)(i.color),s=(0,Wu.A)((0,n.A)({},i,{color:r})),{align:a="inherit",className:l,component:c,gutterBottom:u=!1,noWrap:h=!1,paragraph:d=!1,variant:p="body1",variantMapping:f=Yu}=s,m=(0,o.A)(s,qu),g=(0,n.A)({},s,{align:a,color:r,className:l,component:c,gutterBottom:u,noWrap:h,paragraph:d,variant:p,variantMapping:f}),y=c||(d?"p":f[p]||Yu[p])||"span",_=(e=>{const{align:t,gutterBottom:i,noWrap:r,paragraph:n,variant:o,classes:s}=e;return Dn({root:["root",o,"inherit"!==e.align&&`align${oo(t)}`,i&&"gutterBottom",r&&"noWrap",n&&"paragraph"]},$u,s)})(g);return(0,Y.jsx)(Xu,(0,n.A)({as:y,ref:t,ownerState:g,className:In(_.root,l)},m))}));function Ju(e){return yo("MuiPickersToolbar",e)}_o("MuiPickersToolbar",["root","content"]);const Qu=Nn("div",{name:"MuiPickersToolbar",slot:"Root",overridesResolver:(e,t)=>t.root})((e=>{let{theme:t,ownerState:i}=e;return(0,n.A)({display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"space-between",padding:t.spacing(2,3)},i.isLandscape&&{height:"auto",maxWidth:160,padding:16,justifyContent:"flex-start",flexWrap:"wrap"})})),eh=Nn("div",{name:"MuiPickersToolbar",slot:"Content",overridesResolver:(e,t)=>t.content})((e=>{let{ownerState:t}=e;var i;return{display:"flex",flexWrap:"wrap",width:"100%",justifyContent:t.isLandscape?"flex-start":"space-between",flexDirection:t.isLandscape?null!=(i=t.landscapeDirection)?i:"column":"row",flex:1,alignItems:t.isLandscape?"flex-start":"center"}})),th=e.forwardRef((function(e,t){const i=X({props:e,name:"MuiPickersToolbar"}),{children:r,className:n,toolbarTitle:o,hidden:s,titleId:a}=i,l=i,c=(e=>{const{classes:t,isLandscape:i}=e;return Dn({root:["root"],content:["content"],penIconButton:["penIconButton",i&&"penIconButtonLandscape"]},Ju,t)})(l);return s?null:(0,Y.jsxs)(Qu,{ref:t,className:In(c.root,n),ownerState:l,children:[(0,Y.jsx)(Ku,{color:"text.secondary",variant:"overline",id:a,children:o}),(0,Y.jsx)(eh,{className:c.content,ownerState:l,children:r})]})}));function ih(e){return yo("MuiDatePickerToolbar",e)}_o("MuiDatePickerToolbar",["root","title"]);const rh=["value","isLandscape","onChange","toolbarFormat","toolbarPlaceholder","views","className"],nh=Nn(th,{name:"MuiDatePickerToolbar",slot:"Root",overridesResolver:(e,t)=>t.root})({}),oh=Nn(Ku,{name:"MuiDatePickerToolbar",slot:"Title",overridesResolver:(e,t)=>t.title})((e=>{let{ownerState:t}=e;return(0,n.A)({},t.isLandscape&&{margin:"auto 16px auto auto"})})),sh=e.forwardRef((function(t,i){const r=X({props:t,name:"MuiDatePickerToolbar"}),{value:s,isLandscape:a,toolbarFormat:l,toolbarPlaceholder:c="\u2013\u2013",views:u,className:h}=r,d=(0,o.A)(r,rh),p=Vu(),f=Gu(),m=(e=>{const{classes:t}=e;return Dn({root:["root"],title:["title"]},ih,t)})(r),g=e.useMemo((()=>{if(!s)return c;const e=uu(p,{format:l,views:u},!0);return p.formatByString(s,e)}),[s,l,c,p,u]),y=r;return(0,Y.jsx)(nh,(0,n.A)({ref:i,toolbarTitle:f.datePickerToolbarTitle,isLandscape:a,className:In(m.root,h)},d,{children:(0,Y.jsx)(oh,{variant:"h4",align:a?"left":"center",ownerState:y,className:m.title,children:g})}))})),ah=e=>{if(void 0!==e)return Object.keys(e).reduce(((t,i)=>(0,n.A)({},t,{[`${i.slice(0,1).toLowerCase()}${i.slice(1)}`]:e[i]})),{})};function lh(t,i){var r,o,s,a;const l=Vu(),c=Uu(),u=X({props:t,name:i}),h=e.useMemo((()=>{var e;return null==(null==(e=u.localeText)?void 0:e.toolbarTitle)?u.localeText:(0,n.A)({},u.localeText,{datePickerToolbarTitle:u.localeText.toolbarTitle})}),[u.localeText]),d=null!=(r=u.slots)?r:ah(u.components);return(0,n.A)({},u,{localeText:h},(e=>{let{openTo:t,defaultOpenTo:i,views:r,defaultViews:n}=e;const o=null!=r?r:n;let s;if(null!=t)s=t;else if(o.includes(i))s=i;else{if(!(o.length>0))throw new Error("MUI: The `views` prop must contain at least one view");s=o[0]}return{views:o,openTo:s}})({views:u.views,openTo:u.openTo,defaultViews:["year","day"],defaultOpenTo:"day"}),{disableFuture:null!=(o=u.disableFuture)&&o,disablePast:null!=(s=u.disablePast)&&s,minDate:ou(l,u.minDate,c.minDate),maxDate:ou(l,u.maxDate,c.maxDate),slots:(0,n.A)({toolbar:sh},d),slotProps:null!=(a=u.slotProps)?a:u.componentsProps})}const ch=e=>{let{props:t,value:i,adapter:r}=e;if(null===i)return null;const{shouldDisableDate:n,shouldDisableMonth:o,shouldDisableYear:s,disablePast:a,disableFuture:l,timezone:c}=t,u=r.utils.dateWithTimezone(void 0,c),h=ou(r.utils,t.minDate,r.defaultDates.minDate),d=ou(r.utils,t.maxDate,r.defaultDates.maxDate);switch(!0){case!r.utils.isValid(i):return"invalidDate";case Boolean(n&&n(i)):return"shouldDisableDate";case Boolean(o&&o(i)):return"shouldDisableMonth";case Boolean(s&&s(i)):return"shouldDisableYear";case Boolean(l&&r.utils.isAfterDay(i,u)):return"disableFuture";case Boolean(a&&r.utils.isBeforeDay(i,u)):return"disablePast";case Boolean(h&&r.utils.isBeforeDay(i,h)):return"minDate";case Boolean(d&&r.utils.isAfterDay(i,d)):return"maxDate";default:return null}};function uh(e){if(void 0===e)return{};const t={};return Object.keys(e).filter((t=>!(t.match(/^on[A-Z]/)&&"function"===typeof e[t]))).forEach((i=>{t[i]=e[i]})),t}function hh(e){const{getSlotProps:t,additionalProps:i,externalSlotProps:r,externalForwardedProps:n,className:o}=e;if(!t){const e=In(i?.className,o,n?.className,r?.className),t={...i?.style,...n?.style,...r?.style},s={...i,...n,...r};return e.length>0&&(s.className=e),Object.keys(t).length>0&&(s.style=t),{props:s,internalRef:void 0}}const s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(void 0===e)return{};const i={};return Object.keys(e).filter((i=>i.match(/^on[A-Z]/)&&"function"===typeof e[i]&&!t.includes(i))).forEach((t=>{i[t]=e[t]})),i}({...n,...r}),a=uh(r),l=uh(n),c=t(s),u=In(c?.className,i?.className,o,n?.className,r?.className),h={...c?.style,...i?.style,...n?.style,...r?.style},d={...c,...i,...l,...a};return u.length>0&&(d.className=u),Object.keys(h).length>0&&(d.style=h),{props:d,internalRef:c.ref}}function dh(t){const{elementType:i,externalSlotProps:r,ownerState:n,skipResolvingSlotProps:o=!1,...s}=t,a=o?{}:eu(r,n),{props:l,internalRef:c}=hh({...s,externalSlotProps:a}),u=function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return e.useMemo((()=>i.every((e=>null==e))?null:e=>{i.forEach((t=>{!function(e,t){"function"===typeof e?e(t):e&&(e.current=t)}(t,e)}))}),i)}(c,a?.ref,t.additionalProps?.ref),h=function(e,t,i){return void 0===e||"string"===typeof e?t:{...t,ownerState:{...t.ownerState,...i}}}(i,{...l,ref:u},n);return h}function ph(e){return yo("MuiInputAdornment",e)}const fh=_o("MuiInputAdornment",["root","filled","standard","outlined","positionStart","positionEnd","disablePointerEvents","hiddenLabel","sizeSmall"]);var mh;const gh=["children","className","component","disablePointerEvents","disableTypography","position","variant"],yh=Nn("div",{name:"MuiInputAdornment",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,t[`position${oo(i.position)}`],!0===i.disablePointerEvents&&t.disablePointerEvents,t[i.variant]]}})((e=>{let{theme:t,ownerState:i}=e;return(0,n.A)({display:"flex",height:"0.01em",maxHeight:"2em",alignItems:"center",whiteSpace:"nowrap",color:(t.vars||t).palette.action.active},"filled"===i.variant&&{[`&.${fh.positionStart}&:not(.${fh.hiddenLabel})`]:{marginTop:16}},"start"===i.position&&{marginRight:8},"end"===i.position&&{marginLeft:8},!0===i.disablePointerEvents&&{pointerEvents:"none"})})),_h=e.forwardRef((function(t,i){const r=Un({props:t,name:"MuiInputAdornment"}),{children:s,className:a,component:l="div",disablePointerEvents:c=!1,disableTypography:u=!1,position:h,variant:d}=r,p=(0,o.A)(r,gh),f=no()||{};let m=d;d&&f.variant,f&&!m&&(m=f.variant);const g=(0,n.A)({},r,{hiddenLabel:f.hiddenLabel,size:f.size,disablePointerEvents:c,position:h,variant:m}),y=(e=>{const{classes:t,disablePointerEvents:i,hiddenLabel:r,position:n,size:o,variant:s}=e;return Dn({root:["root",i&&"disablePointerEvents",n&&`position${oo(n)}`,s,r&&"hiddenLabel",o&&`size${oo(o)}`]},ph,t)})(g);return(0,Y.jsx)(ro.Provider,{value:null,children:(0,Y.jsx)(yh,(0,n.A)({as:l,ownerState:g,className:In(y.root,a),ref:i},p,{children:"string"!==typeof s||u?(0,Y.jsxs)(e.Fragment,{children:["start"===h?mh||(mh=(0,Y.jsx)("span",{className:"notranslate",children:"\u200b"})):null,s]}):(0,Y.jsx)(Ku,{color:"text.secondary",children:s})}))})}));function vh(e){return yo("MuiIconButton",e)}const xh=_o("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),bh=["edge","children","className","color","disabled","disableFocusRipple","size"],wh=Nn(zc,{name:"MuiIconButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,"default"!==i.color&&t[`color${oo(i.color)}`],i.edge&&t[`edge${oo(i.edge)}`],t[`size${oo(i.size)}`]]}})((e=>{let{theme:t,ownerState:i}=e;return(0,n.A)({textAlign:"center",flex:"0 0 auto",fontSize:t.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:(t.vars||t).palette.action.active,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest})},!i.disableRipple&&{"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:(0,y.X4)(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"start"===i.edge&&{marginLeft:"small"===i.size?-3:-12},"end"===i.edge&&{marginRight:"small"===i.size?-3:-12})}),(e=>{let{theme:t,ownerState:i}=e;var r;const o=null==(r=(t.vars||t).palette)?void 0:r[i.color];return(0,n.A)({},"inherit"===i.color&&{color:"inherit"},"inherit"!==i.color&&"default"!==i.color&&(0,n.A)({color:null==o?void 0:o.main},!i.disableRipple&&{"&:hover":(0,n.A)({},o&&{backgroundColor:t.vars?`rgba(${o.mainChannel} / ${t.vars.palette.action.hoverOpacity})`:(0,y.X4)(o.main,t.palette.action.hoverOpacity)},{"@media (hover: none)":{backgroundColor:"transparent"}})}),"small"===i.size&&{padding:5,fontSize:t.typography.pxToRem(18)},"large"===i.size&&{padding:12,fontSize:t.typography.pxToRem(28)},{[`&.${xh.disabled}`]:{backgroundColor:"transparent",color:(t.vars||t).palette.action.disabled}})})),Sh=e.forwardRef((function(e,t){const i=Un({props:e,name:"MuiIconButton"}),{edge:r=!1,children:s,className:a,color:l="default",disabled:c=!1,disableFocusRipple:u=!1,size:h="medium"}=i,d=(0,o.A)(i,bh),p=(0,n.A)({},i,{edge:r,color:l,disabled:c,disableFocusRipple:u,size:h}),f=(e=>{const{classes:t,disabled:i,color:r,edge:n,size:o}=e;return Dn({root:["root",i&&"disabled","default"!==r&&`color${oo(r)}`,n&&`edge${oo(n)}`,`size${oo(o)}`]},vh,t)})(p);return(0,Y.jsx)(wh,(0,n.A)({className:In(f.root,a),centerRipple:!0,focusRipple:!u,disabled:c,ref:t},d,{ownerState:p,children:s}))}));var Th=i(2374);function Mh(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Ah(e){return e instanceof Mh(e).Element||e instanceof Element}function Ch(e){return e instanceof Mh(e).HTMLElement||e instanceof HTMLElement}function Eh(e){return"undefined"!==typeof ShadowRoot&&(e instanceof Mh(e).ShadowRoot||e instanceof ShadowRoot)}var Ph=Math.max,kh=Math.min,Ih=Math.round;function Dh(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map((function(e){return e.brand+"/"+e.version})).join(" "):navigator.userAgent}function Lh(){return!/^((?!chrome|android).)*safari/i.test(Dh())}function Rh(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=!1);var r=e.getBoundingClientRect(),n=1,o=1;t&&Ch(e)&&(n=e.offsetWidth>0&&Ih(r.width)/e.offsetWidth||1,o=e.offsetHeight>0&&Ih(r.height)/e.offsetHeight||1);var s=(Ah(e)?Mh(e):window).visualViewport,a=!Lh()&&i,l=(r.left+(a&&s?s.offsetLeft:0))/n,c=(r.top+(a&&s?s.offsetTop:0))/o,u=r.width/n,h=r.height/o;return{width:u,height:h,top:c,right:l+u,bottom:c+h,left:l,x:l,y:c}}function zh(e){var t=Mh(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function Oh(e){return e?(e.nodeName||"").toLowerCase():null}function Fh(e){return((Ah(e)?e.ownerDocument:e.document)||window.document).documentElement}function Bh(e){return Rh(Fh(e)).left+zh(e).scrollLeft}function Nh(e){return Mh(e).getComputedStyle(e)}function jh(e){var t=Nh(e),i=t.overflow,r=t.overflowX,n=t.overflowY;return/auto|scroll|overlay|hidden/.test(i+n+r)}function Vh(e,t,i){void 0===i&&(i=!1);var r=Ch(t),n=Ch(t)&&function(e){var t=e.getBoundingClientRect(),i=Ih(t.width)/e.offsetWidth||1,r=Ih(t.height)/e.offsetHeight||1;return 1!==i||1!==r}(t),o=Fh(t),s=Rh(e,n,i),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!i)&&(("body"!==Oh(t)||jh(o))&&(a=function(e){return e!==Mh(e)&&Ch(e)?{scrollLeft:(t=e).scrollLeft,scrollTop:t.scrollTop}:zh(e);var t}(t)),Ch(t)?((l=Rh(t,!0)).x+=t.clientLeft,l.y+=t.clientTop):o&&(l.x=Bh(o))),{x:s.left+a.scrollLeft-l.x,y:s.top+a.scrollTop-l.y,width:s.width,height:s.height}}function Uh(e){var t=Rh(e),i=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-i)<=1&&(i=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:i,height:r}}function Gh(e){return"html"===Oh(e)?e:e.assignedSlot||e.parentNode||(Eh(e)?e.host:null)||Fh(e)}function Hh(e){return["html","body","#document"].indexOf(Oh(e))>=0?e.ownerDocument.body:Ch(e)&&jh(e)?e:Hh(Gh(e))}function Wh(e,t){var i;void 0===t&&(t=[]);var r=Hh(e),n=r===(null==(i=e.ownerDocument)?void 0:i.body),o=Mh(r),s=n?[o].concat(o.visualViewport||[],jh(r)?r:[]):r,a=t.concat(s);return n?a:a.concat(Wh(Gh(s)))}function $h(e){return["table","td","th"].indexOf(Oh(e))>=0}function qh(e){return Ch(e)&&"fixed"!==Nh(e).position?e.offsetParent:null}function Xh(e){for(var t=Mh(e),i=qh(e);i&&$h(i)&&"static"===Nh(i).position;)i=qh(i);return i&&("html"===Oh(i)||"body"===Oh(i)&&"static"===Nh(i).position)?t:i||function(e){var t=/firefox/i.test(Dh());if(/Trident/i.test(Dh())&&Ch(e)&&"fixed"===Nh(e).position)return null;var i=Gh(e);for(Eh(i)&&(i=i.host);Ch(i)&&["html","body"].indexOf(Oh(i))<0;){var r=Nh(i);if("none"!==r.transform||"none"!==r.perspective||"paint"===r.contain||-1!==["transform","perspective"].indexOf(r.willChange)||t&&"filter"===r.willChange||t&&r.filter&&"none"!==r.filter)return i;i=i.parentNode}return null}(e)||t}var Yh="top",Zh="bottom",Kh="right",Jh="left",Qh="auto",ed=[Yh,Zh,Kh,Jh],td="start",id="end",rd="viewport",nd="popper",od=ed.reduce((function(e,t){return e.concat([t+"-"+td,t+"-"+id])}),[]),sd=[].concat(ed,[Qh]).reduce((function(e,t){return e.concat([t,t+"-"+td,t+"-"+id])}),[]),ad=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function ld(e){var t=new Map,i=new Set,r=[];function n(e){i.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!i.has(e)){var r=t.get(e);r&&n(r)}})),r.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){i.has(e.name)||n(e)})),r}function cd(e){var t;return function(){return t||(t=new Promise((function(i){Promise.resolve().then((function(){t=void 0,i(e())}))}))),t}}var ud={placement:"bottom",modifiers:[],strategy:"absolute"};function hd(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return!t.some((function(e){return!(e&&"function"===typeof e.getBoundingClientRect)}))}function dd(e){void 0===e&&(e={});var t=e,i=t.defaultModifiers,r=void 0===i?[]:i,n=t.defaultOptions,o=void 0===n?ud:n;return function(e,t,i){void 0===i&&(i=o);var n={placement:"bottom",orderedModifiers:[],options:Object.assign({},ud,o),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},s=[],a=!1,l={state:n,setOptions:function(i){var a="function"===typeof i?i(n.options):i;c(),n.options=Object.assign({},o,n.options,a),n.scrollParents={reference:Ah(e)?Wh(e):e.contextElement?Wh(e.contextElement):[],popper:Wh(t)};var u=function(e){var t=ld(e);return ad.reduce((function(e,i){return e.concat(t.filter((function(e){return e.phase===i})))}),[])}(function(e){var t=e.reduce((function(e,t){var i=e[t.name];return e[t.name]=i?Object.assign({},i,t,{options:Object.assign({},i.options,t.options),data:Object.assign({},i.data,t.data)}):t,e}),{});return Object.keys(t).map((function(e){return t[e]}))}([].concat(r,n.options.modifiers)));return n.orderedModifiers=u.filter((function(e){return e.enabled})),n.orderedModifiers.forEach((function(e){var t=e.name,i=e.options,r=void 0===i?{}:i,o=e.effect;if("function"===typeof o){var a=o({state:n,name:t,instance:l,options:r}),c=function(){};s.push(a||c)}})),l.update()},forceUpdate:function(){if(!a){var e=n.elements,t=e.reference,i=e.popper;if(hd(t,i)){n.rects={reference:Vh(t,Xh(i),"fixed"===n.options.strategy),popper:Uh(i)},n.reset=!1,n.placement=n.options.placement,n.orderedModifiers.forEach((function(e){return n.modifiersData[e.name]=Object.assign({},e.data)}));for(var r=0;r<n.orderedModifiers.length;r++)if(!0!==n.reset){var o=n.orderedModifiers[r],s=o.fn,c=o.options,u=void 0===c?{}:c,h=o.name;"function"===typeof s&&(n=s({state:n,options:u,name:h,instance:l})||n)}else n.reset=!1,r=-1}}},update:cd((function(){return new Promise((function(e){l.forceUpdate(),e(n)}))})),destroy:function(){c(),a=!0}};if(!hd(e,t))return l;function c(){s.forEach((function(e){return e()})),s=[]}return l.setOptions(i).then((function(e){!a&&i.onFirstUpdate&&i.onFirstUpdate(e)})),l}}var pd={passive:!0};function fd(e){return e.split("-")[0]}function md(e){return e.split("-")[1]}function gd(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function yd(e){var t,i=e.reference,r=e.element,n=e.placement,o=n?fd(n):null,s=n?md(n):null,a=i.x+i.width/2-r.width/2,l=i.y+i.height/2-r.height/2;switch(o){case Yh:t={x:a,y:i.y-r.height};break;case Zh:t={x:a,y:i.y+i.height};break;case Kh:t={x:i.x+i.width,y:l};break;case Jh:t={x:i.x-r.width,y:l};break;default:t={x:i.x,y:i.y}}var c=o?gd(o):null;if(null!=c){var u="y"===c?"height":"width";switch(s){case td:t[c]=t[c]-(i[u]/2-r[u]/2);break;case id:t[c]=t[c]+(i[u]/2-r[u]/2)}}return t}var _d={top:"auto",right:"auto",bottom:"auto",left:"auto"};function vd(e){var t,i=e.popper,r=e.popperRect,n=e.placement,o=e.variation,s=e.offsets,a=e.position,l=e.gpuAcceleration,c=e.adaptive,u=e.roundOffsets,h=e.isFixed,d=s.x,p=void 0===d?0:d,f=s.y,m=void 0===f?0:f,g="function"===typeof u?u({x:p,y:m}):{x:p,y:m};p=g.x,m=g.y;var y=s.hasOwnProperty("x"),_=s.hasOwnProperty("y"),v=Jh,x=Yh,b=window;if(c){var w=Xh(i),S="clientHeight",T="clientWidth";if(w===Mh(i)&&"static"!==Nh(w=Fh(i)).position&&"absolute"===a&&(S="scrollHeight",T="scrollWidth"),n===Yh||(n===Jh||n===Kh)&&o===id)x=Zh,m-=(h&&w===b&&b.visualViewport?b.visualViewport.height:w[S])-r.height,m*=l?1:-1;if(n===Jh||(n===Yh||n===Zh)&&o===id)v=Kh,p-=(h&&w===b&&b.visualViewport?b.visualViewport.width:w[T])-r.width,p*=l?1:-1}var M,A=Object.assign({position:a},c&&_d),C=!0===u?function(e,t){var i=e.x,r=e.y,n=t.devicePixelRatio||1;return{x:Ih(i*n)/n||0,y:Ih(r*n)/n||0}}({x:p,y:m},Mh(i)):{x:p,y:m};return p=C.x,m=C.y,l?Object.assign({},A,((M={})[x]=_?"0":"",M[v]=y?"0":"",M.transform=(b.devicePixelRatio||1)<=1?"translate("+p+"px, "+m+"px)":"translate3d("+p+"px, "+m+"px, 0)",M)):Object.assign({},A,((t={})[x]=_?m+"px":"",t[v]=y?p+"px":"",t.transform="",t))}var xd={left:"right",right:"left",bottom:"top",top:"bottom"};function bd(e){return e.replace(/left|right|bottom|top/g,(function(e){return xd[e]}))}var wd={start:"end",end:"start"};function Sd(e){return e.replace(/start|end/g,(function(e){return wd[e]}))}function Td(e,t){var i=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(i&&Eh(i)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Md(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function Ad(e,t,i){return t===rd?Md(function(e,t){var i=Mh(e),r=Fh(e),n=i.visualViewport,o=r.clientWidth,s=r.clientHeight,a=0,l=0;if(n){o=n.width,s=n.height;var c=Lh();(c||!c&&"fixed"===t)&&(a=n.offsetLeft,l=n.offsetTop)}return{width:o,height:s,x:a+Bh(e),y:l}}(e,i)):Ah(t)?function(e,t){var i=Rh(e,!1,"fixed"===t);return i.top=i.top+e.clientTop,i.left=i.left+e.clientLeft,i.bottom=i.top+e.clientHeight,i.right=i.left+e.clientWidth,i.width=e.clientWidth,i.height=e.clientHeight,i.x=i.left,i.y=i.top,i}(t,i):Md(function(e){var t,i=Fh(e),r=zh(e),n=null==(t=e.ownerDocument)?void 0:t.body,o=Ph(i.scrollWidth,i.clientWidth,n?n.scrollWidth:0,n?n.clientWidth:0),s=Ph(i.scrollHeight,i.clientHeight,n?n.scrollHeight:0,n?n.clientHeight:0),a=-r.scrollLeft+Bh(e),l=-r.scrollTop;return"rtl"===Nh(n||i).direction&&(a+=Ph(i.clientWidth,n?n.clientWidth:0)-o),{width:o,height:s,x:a,y:l}}(Fh(e)))}function Cd(e,t,i,r){var n="clippingParents"===t?function(e){var t=Wh(Gh(e)),i=["absolute","fixed"].indexOf(Nh(e).position)>=0&&Ch(e)?Xh(e):e;return Ah(i)?t.filter((function(e){return Ah(e)&&Td(e,i)&&"body"!==Oh(e)})):[]}(e):[].concat(t),o=[].concat(n,[i]),s=o[0],a=o.reduce((function(t,i){var n=Ad(e,i,r);return t.top=Ph(n.top,t.top),t.right=kh(n.right,t.right),t.bottom=kh(n.bottom,t.bottom),t.left=Ph(n.left,t.left),t}),Ad(e,s,r));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function Ed(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function Pd(e,t){return t.reduce((function(t,i){return t[i]=e,t}),{})}function kd(e,t){void 0===t&&(t={});var i=t,r=i.placement,n=void 0===r?e.placement:r,o=i.strategy,s=void 0===o?e.strategy:o,a=i.boundary,l=void 0===a?"clippingParents":a,c=i.rootBoundary,u=void 0===c?rd:c,h=i.elementContext,d=void 0===h?nd:h,p=i.altBoundary,f=void 0!==p&&p,m=i.padding,g=void 0===m?0:m,y=Ed("number"!==typeof g?g:Pd(g,ed)),_=d===nd?"reference":nd,v=e.rects.popper,x=e.elements[f?_:d],b=Cd(Ah(x)?x:x.contextElement||Fh(e.elements.popper),l,u,s),w=Rh(e.elements.reference),S=yd({reference:w,element:v,strategy:"absolute",placement:n}),T=Md(Object.assign({},v,S)),M=d===nd?T:w,A={top:b.top-M.top+y.top,bottom:M.bottom-b.bottom+y.bottom,left:b.left-M.left+y.left,right:M.right-b.right+y.right},C=e.modifiersData.offset;if(d===nd&&C){var E=C[n];Object.keys(A).forEach((function(e){var t=[Kh,Zh].indexOf(e)>=0?1:-1,i=[Yh,Zh].indexOf(e)>=0?"y":"x";A[e]+=E[i]*t}))}return A}function Id(e,t,i){return Ph(e,kh(t,i))}function Dd(e,t,i){return void 0===i&&(i={x:0,y:0}),{top:e.top-t.height-i.y,right:e.right-t.width+i.x,bottom:e.bottom-t.height+i.y,left:e.left-t.width-i.x}}function Ld(e){return[Yh,Kh,Zh,Jh].some((function(t){return e[t]>=0}))}var Rd=dd({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,i=e.instance,r=e.options,n=r.scroll,o=void 0===n||n,s=r.resize,a=void 0===s||s,l=Mh(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return o&&c.forEach((function(e){e.addEventListener("scroll",i.update,pd)})),a&&l.addEventListener("resize",i.update,pd),function(){o&&c.forEach((function(e){e.removeEventListener("scroll",i.update,pd)})),a&&l.removeEventListener("resize",i.update,pd)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,i=e.name;t.modifiersData[i]=yd({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,i=e.options,r=i.gpuAcceleration,n=void 0===r||r,o=i.adaptive,s=void 0===o||o,a=i.roundOffsets,l=void 0===a||a,c={placement:fd(t.placement),variation:md(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:n,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,vd(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:s,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,vd(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},{name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var i=t.styles[e]||{},r=t.attributes[e]||{},n=t.elements[e];Ch(n)&&Oh(n)&&(Object.assign(n.style,i),Object.keys(r).forEach((function(e){var t=r[e];!1===t?n.removeAttribute(e):n.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,i={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,i.popper),t.styles=i,t.elements.arrow&&Object.assign(t.elements.arrow.style,i.arrow),function(){Object.keys(t.elements).forEach((function(e){var r=t.elements[e],n=t.attributes[e]||{},o=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:i[e]).reduce((function(e,t){return e[t]="",e}),{});Ch(r)&&Oh(r)&&(Object.assign(r.style,o),Object.keys(n).forEach((function(e){r.removeAttribute(e)})))}))}},requires:["computeStyles"]},{name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,i=e.options,r=e.name,n=i.offset,o=void 0===n?[0,0]:n,s=sd.reduce((function(e,i){return e[i]=function(e,t,i){var r=fd(e),n=[Jh,Yh].indexOf(r)>=0?-1:1,o="function"===typeof i?i(Object.assign({},t,{placement:e})):i,s=o[0],a=o[1];return s=s||0,a=(a||0)*n,[Jh,Kh].indexOf(r)>=0?{x:a,y:s}:{x:s,y:a}}(i,t.rects,o),e}),{}),a=s[t.placement],l=a.x,c=a.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=c),t.modifiersData[r]=s}},{name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,i=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var n=i.mainAxis,o=void 0===n||n,s=i.altAxis,a=void 0===s||s,l=i.fallbackPlacements,c=i.padding,u=i.boundary,h=i.rootBoundary,d=i.altBoundary,p=i.flipVariations,f=void 0===p||p,m=i.allowedAutoPlacements,g=t.options.placement,y=fd(g),_=l||(y===g||!f?[bd(g)]:function(e){if(fd(e)===Qh)return[];var t=bd(e);return[Sd(e),t,Sd(t)]}(g)),v=[g].concat(_).reduce((function(e,i){return e.concat(fd(i)===Qh?function(e,t){void 0===t&&(t={});var i=t,r=i.placement,n=i.boundary,o=i.rootBoundary,s=i.padding,a=i.flipVariations,l=i.allowedAutoPlacements,c=void 0===l?sd:l,u=md(r),h=u?a?od:od.filter((function(e){return md(e)===u})):ed,d=h.filter((function(e){return c.indexOf(e)>=0}));0===d.length&&(d=h);var p=d.reduce((function(t,i){return t[i]=kd(e,{placement:i,boundary:n,rootBoundary:o,padding:s})[fd(i)],t}),{});return Object.keys(p).sort((function(e,t){return p[e]-p[t]}))}(t,{placement:i,boundary:u,rootBoundary:h,padding:c,flipVariations:f,allowedAutoPlacements:m}):i)}),[]),x=t.rects.reference,b=t.rects.popper,w=new Map,S=!0,T=v[0],M=0;M<v.length;M++){var A=v[M],C=fd(A),E=md(A)===td,P=[Yh,Zh].indexOf(C)>=0,k=P?"width":"height",I=kd(t,{placement:A,boundary:u,rootBoundary:h,altBoundary:d,padding:c}),D=P?E?Kh:Jh:E?Zh:Yh;x[k]>b[k]&&(D=bd(D));var L=bd(D),R=[];if(o&&R.push(I[C]<=0),a&&R.push(I[D]<=0,I[L]<=0),R.every((function(e){return e}))){T=A,S=!1;break}w.set(A,R)}if(S)for(var z=function(e){var t=v.find((function(t){var i=w.get(t);if(i)return i.slice(0,e).every((function(e){return e}))}));if(t)return T=t,"break"},O=f?3:1;O>0;O--){if("break"===z(O))break}t.placement!==T&&(t.modifiersData[r]._skip=!0,t.placement=T,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}},{name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,i=e.options,r=e.name,n=i.mainAxis,o=void 0===n||n,s=i.altAxis,a=void 0!==s&&s,l=i.boundary,c=i.rootBoundary,u=i.altBoundary,h=i.padding,d=i.tether,p=void 0===d||d,f=i.tetherOffset,m=void 0===f?0:f,g=kd(t,{boundary:l,rootBoundary:c,padding:h,altBoundary:u}),y=fd(t.placement),_=md(t.placement),v=!_,x=gd(y),b="x"===x?"y":"x",w=t.modifiersData.popperOffsets,S=t.rects.reference,T=t.rects.popper,M="function"===typeof m?m(Object.assign({},t.rects,{placement:t.placement})):m,A="number"===typeof M?{mainAxis:M,altAxis:M}:Object.assign({mainAxis:0,altAxis:0},M),C=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,E={x:0,y:0};if(w){if(o){var P,k="y"===x?Yh:Jh,I="y"===x?Zh:Kh,D="y"===x?"height":"width",L=w[x],R=L+g[k],z=L-g[I],O=p?-T[D]/2:0,F=_===td?S[D]:T[D],B=_===td?-T[D]:-S[D],N=t.elements.arrow,j=p&&N?Uh(N):{width:0,height:0},V=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},U=V[k],G=V[I],H=Id(0,S[D],j[D]),W=v?S[D]/2-O-H-U-A.mainAxis:F-H-U-A.mainAxis,$=v?-S[D]/2+O+H+G+A.mainAxis:B+H+G+A.mainAxis,q=t.elements.arrow&&Xh(t.elements.arrow),X=q?"y"===x?q.clientTop||0:q.clientLeft||0:0,Y=null!=(P=null==C?void 0:C[x])?P:0,Z=L+$-Y,K=Id(p?kh(R,L+W-Y-X):R,L,p?Ph(z,Z):z);w[x]=K,E[x]=K-L}if(a){var J,Q="x"===x?Yh:Jh,ee="x"===x?Zh:Kh,te=w[b],ie="y"===b?"height":"width",re=te+g[Q],ne=te-g[ee],oe=-1!==[Yh,Jh].indexOf(y),se=null!=(J=null==C?void 0:C[b])?J:0,ae=oe?re:te-S[ie]-T[ie]-se+A.altAxis,le=oe?te+S[ie]+T[ie]-se-A.altAxis:ne,ce=p&&oe?function(e,t,i){var r=Id(e,t,i);return r>i?i:r}(ae,te,le):Id(p?ae:re,te,p?le:ne);w[b]=ce,E[b]=ce-te}t.modifiersData[r]=E}},requiresIfExists:["offset"]},{name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,i=e.state,r=e.name,n=e.options,o=i.elements.arrow,s=i.modifiersData.popperOffsets,a=fd(i.placement),l=gd(a),c=[Jh,Kh].indexOf(a)>=0?"height":"width";if(o&&s){var u=function(e,t){return Ed("number"!==typeof(e="function"===typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:Pd(e,ed))}(n.padding,i),h=Uh(o),d="y"===l?Yh:Jh,p="y"===l?Zh:Kh,f=i.rects.reference[c]+i.rects.reference[l]-s[l]-i.rects.popper[c],m=s[l]-i.rects.reference[l],g=Xh(o),y=g?"y"===l?g.clientHeight||0:g.clientWidth||0:0,_=f/2-m/2,v=u[d],x=y-h[c]-u[p],b=y/2-h[c]/2+_,w=Id(v,b,x),S=l;i.modifiersData[r]=((t={})[S]=w,t.centerOffset=w-b,t)}},effect:function(e){var t=e.state,i=e.options.element,r=void 0===i?"[data-popper-arrow]":i;null!=r&&("string"!==typeof r||(r=t.elements.popper.querySelector(r)))&&Td(t.elements.popper,r)&&(t.elements.arrow=r)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]},{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,i=e.name,r=t.rects.reference,n=t.rects.popper,o=t.modifiersData.preventOverflow,s=kd(t,{elementContext:"reference"}),a=kd(t,{altBoundary:!0}),l=Dd(s,r),c=Dd(a,n,o),u=Ld(l),h=Ld(c);t.modifiersData[i]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:h},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":h})}}]});function zd(e){return yo("MuiPopper",e)}_o("MuiPopper",["root"]);const Od=["anchorEl","children","direction","disablePortal","modifiers","open","placement","popperOptions","popperRef","slotProps","slots","TransitionProps","ownerState"],Fd=["anchorEl","children","container","direction","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","style","transition","slotProps","slots"];function Bd(e){return"function"===typeof e?e():e}function Nd(e){return void 0!==e.nodeType}const jd={},Vd=e.forwardRef((function(t,i){var r;const{anchorEl:s,children:a,direction:l,disablePortal:c,modifiers:u,open:h,placement:d,popperOptions:p,popperRef:f,slotProps:m={},slots:g={},TransitionProps:y}=t,_=(0,o.A)(t,Od),v=e.useRef(null),x=Wn(v,i),b=e.useRef(null),w=Wn(b,f),S=e.useRef(w);Xn((()=>{S.current=w}),[w]),e.useImperativeHandle(f,(()=>b.current),[]);const T=function(e,t){if("ltr"===t)return e;switch(e){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return e}}(d,l),[M,A]=e.useState(T),[C,E]=e.useState(Bd(s));e.useEffect((()=>{b.current&&b.current.forceUpdate()})),e.useEffect((()=>{s&&E(Bd(s))}),[s]),Xn((()=>{if(!C||!h)return;let e=[{name:"preventOverflow",options:{altBoundary:c}},{name:"flip",options:{altBoundary:c}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:e=>{let{state:t}=e;A(t.placement)}}];null!=u&&(e=e.concat(u)),p&&null!=p.modifiers&&(e=e.concat(p.modifiers));const t=Rd(C,v.current,(0,n.A)({placement:T},p,{modifiers:e}));return S.current(t),()=>{t.destroy(),S.current(null)}}),[C,c,u,h,p,T]);const P={placement:M};null!==y&&(P.TransitionProps=y);const k=(e=>{const{classes:t}=e;return Dn({root:["root"]},zd,t)})(t),I=null!=(r=g.root)?r:"div",D=Is({elementType:I,externalSlotProps:m.root,externalForwardedProps:_,additionalProps:{role:"tooltip",ref:x},ownerState:t,className:k.root});return(0,Y.jsx)(I,(0,n.A)({},D,{children:"function"===typeof a?a(P):a}))})),Ud=["anchorEl","component","components","componentsProps","container","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","transition","slots","slotProps"],Gd=Nn(e.forwardRef((function(t,i){const{anchorEl:r,children:s,container:a,direction:l="ltr",disablePortal:c=!1,keepMounted:u=!1,modifiers:h,open:d,placement:p="bottom",popperOptions:f=jd,popperRef:m,style:g,transition:y=!1,slotProps:_={},slots:v={}}=t,x=(0,o.A)(t,Fd),[b,w]=e.useState(!0);if(!u&&!d&&(!y||b))return null;let S;if(a)S=a;else if(r){const e=Bd(r);S=e&&Nd(e)?$n(e).body:$n(null).body}const T=d||!u||y&&!b?void 0:"none",M=y?{in:d,onEnter:()=>{w(!1)},onExited:()=>{w(!0)}}:void 0;return(0,Y.jsx)(wa,{disablePortal:c,container:S,children:(0,Y.jsx)(Vd,(0,n.A)({anchorEl:r,direction:l,disablePortal:c,modifiers:h,ref:i,open:y?!b:d,placement:p,popperOptions:f,popperRef:m,slotProps:_,slots:v},x,{style:(0,n.A)({position:"fixed",top:0,left:0,display:T},g),TransitionProps:M,children:s}))})})),{name:"MuiPopper",slot:"Root",overridesResolver:(e,t)=>t.root})({}),Hd=e.forwardRef((function(e,t){var i;const r=(0,Th.A)(),s=Un({props:e,name:"MuiPopper"}),{anchorEl:a,component:l,components:c,componentsProps:u,container:h,disablePortal:d,keepMounted:p,modifiers:f,open:m,placement:g,popperOptions:y,popperRef:_,transition:v,slots:x,slotProps:b}=s,w=(0,o.A)(s,Ud),S=null!=(i=null==x?void 0:x.root)?i:null==c?void 0:c.Root,T=(0,n.A)({anchorEl:a,container:h,disablePortal:d,keepMounted:p,modifiers:f,open:m,placement:g,popperOptions:y,popperRef:_,transition:v},w);return(0,Y.jsx)(Gd,(0,n.A)({as:l,direction:null==r?void 0:r.direction,slots:{root:S},slotProps:null!=b?b:u},T,{ref:t}))}));function Wd(e){return yo("MuiPickersPopper",e)}_o("MuiPickersPopper",["root","paper"]);const $d=function(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:document).activeElement;return e?e.shadowRoot?$d(e.shadowRoot):e:null},qd="@media (pointer: fine)",Xd="undefined"!==typeof navigator&&navigator.userAgent.match(/android\s(\d+)|OS\s(\d+)/i),Yd=Xd&&Xd[1]?parseInt(Xd[1],10):null,Zd=Xd&&Xd[2]?parseInt(Xd[2],10):null,Kd=Yd&&Yd<10||Zd&&Zd<13||!1,Jd=()=>Kc("@media (prefers-reduced-motion: reduce)",{defaultMatches:!1})||Kd,Qd=["PaperComponent","popperPlacement","ownerState","children","paperSlotProps","paperClasses","onPaperClick","onPaperTouchStart"],ep=Nn(Hd,{name:"MuiPickersPopper",slot:"Root",overridesResolver:(e,t)=>t.root})((e=>{let{theme:t}=e;return{zIndex:t.zIndex.modal}})),tp=Nn(qa,{name:"MuiPickersPopper",slot:"Paper",overridesResolver:(e,t)=>t.paper})((e=>{let{ownerState:t}=e;return(0,n.A)({outline:0,transformOrigin:"top center"},t.placement.includes("top")&&{transformOrigin:"bottom center"})}));const ip=e.forwardRef(((e,t)=>{const{PaperComponent:i,popperPlacement:r,ownerState:s,children:a,paperSlotProps:l,paperClasses:c,onPaperClick:u,onPaperTouchStart:h}=e,d=(0,o.A)(e,Qd),p=(0,n.A)({},s,{placement:r}),f=dh({elementType:i,externalSlotProps:l,additionalProps:{tabIndex:-1,elevation:8,ref:t},className:c,ownerState:p});return(0,Y.jsx)(i,(0,n.A)({},d,f,{onClick:e=>{var t;u(e),null==(t=f.onClick)||t.call(f,e)},onTouchStart:e=>{var t;h(e),null==(t=f.onTouchStart)||t.call(f,e)},ownerState:p,children:a}))}));function rp(t){var i,r,o,s;const a=X({props:t,name:"MuiPickersPopper"}),{anchorEl:l,children:c,containerRef:u=null,shouldRestoreFocus:h,onBlur:d,onDismiss:p,open:f,role:m,placement:g,slots:y,slotProps:_,reduceAnimations:v}=a;e.useEffect((()=>{function e(e){!f||"Escape"!==e.key&&"Esc"!==e.key||p()}return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[p,f]);const x=e.useRef(null);e.useEffect((()=>{"tooltip"===m||h&&!h()||(f?x.current=$d(document):x.current&&x.current instanceof HTMLElement&&setTimeout((()=>{x.current instanceof HTMLElement&&x.current.focus()})))}),[f,m,h]);const[b,w,S]=function(t,i){const r=e.useRef(!1),n=e.useRef(!1),o=e.useRef(null),s=e.useRef(!1);e.useEffect((()=>{if(t)return document.addEventListener("mousedown",e,!0),document.addEventListener("touchstart",e,!0),()=>{document.removeEventListener("mousedown",e,!0),document.removeEventListener("touchstart",e,!0),s.current=!1};function e(){s.current=!0}}),[t]);const a=Yn((e=>{if(!s.current)return;const t=n.current;n.current=!1;const a=$n(o.current);if(!o.current||"clientX"in e&&function(e,t){return t.documentElement.clientWidth<e.clientX||t.documentElement.clientHeight<e.clientY}(e,a))return;if(r.current)return void(r.current=!1);let l;l=e.composedPath?e.composedPath().indexOf(o.current)>-1:!a.documentElement.contains(e.target)||o.current.contains(e.target),l||t||i(e)})),l=()=>{n.current=!0};return e.useEffect((()=>{if(t){const e=$n(o.current),t=()=>{r.current=!0};return e.addEventListener("touchstart",a),e.addEventListener("touchmove",t),()=>{e.removeEventListener("touchstart",a),e.removeEventListener("touchmove",t)}}}),[t,a]),e.useEffect((()=>{if(t){const e=$n(o.current);return e.addEventListener("click",a),()=>{e.removeEventListener("click",a),n.current=!1}}}),[t,a]),[o,l,l]}(f,null!=d?d:p),T=Wn(e.useRef(null),u),M=Wn(T,b),A=a,C=(e=>{const{classes:t}=e;return Dn({root:["root"],paper:["paper"]},Wd,t)})(A),E=Jd(),P=null!=v?v:E,k=(null!=(i=null==y?void 0:y.desktopTransition)?i:P)?Ma:ya,I=null!=(r=null==y?void 0:y.desktopTrapFocus)?r:ba,D=null!=(o=null==y?void 0:y.desktopPaper)?o:tp,L=null!=(s=null==y?void 0:y.popper)?s:ep,R=dh({elementType:L,externalSlotProps:null==_?void 0:_.popper,additionalProps:{transition:!0,role:m,open:f,anchorEl:l,placement:g,onKeyDown:e=>{"Escape"===e.key&&(e.stopPropagation(),p())}},className:C.root,ownerState:a});return(0,Y.jsx)(L,(0,n.A)({},R,{children:e=>{let{TransitionProps:t,placement:i}=e;return(0,Y.jsx)(I,(0,n.A)({open:f,disableAutoFocus:!0,disableRestoreFocus:!0,disableEnforceFocus:"tooltip"===m,isEnabled:()=>!0},null==_?void 0:_.desktopTrapFocus,{children:(0,Y.jsx)(k,(0,n.A)({},t,null==_?void 0:_.desktopTransition,{children:(0,Y.jsx)(ip,{PaperComponent:D,ownerState:A,popperPlacement:i,ref:M,onPaperClick:w,onPaperTouchStart:S,paperClasses:C.paper,paperSlotProps:null==_?void 0:_.desktopPaper,children:c})}))}))}}))}function np(t,i,r,n){const{value:o,onError:s}=t,a=ju(),l=e.useRef(n),c=i({adapter:a,value:o,props:t});return e.useEffect((()=>{s&&!r(c,l.current)&&s(c,o),l.current=c}),[r,s,l,c,o]),c}const op=t=>{let{timezone:i,value:r,defaultValue:n,onChange:o,valueManager:s}=t;var a,l;const c=Vu(),u=e.useRef(n),h=null!=(a=null!=r?r:u.current)?a:s.emptyValue,d=e.useMemo((()=>s.getTimezone(c,h)),[c,s,h]),p=Yn((e=>null==d?e:s.setTimezone(c,d,e))),f=null!=(l=null!=i?i:d)?l:"default";return{value:e.useMemo((()=>s.setTimezone(c,f,h)),[s,c,f,h]),handleValueChange:Yn((function(e){const t=p(e);for(var i=arguments.length,r=new Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];null==o||o(t,...r)})),timezone:f}},sp=e=>{let{name:t,timezone:i,value:r,defaultValue:n,onChange:o,valueManager:s}=e;const[a,l]=wl({name:t,state:"value",controlled:r,default:null!=n?n:s.emptyValue}),c=Yn((function(e){l(e);for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];null==o||o(e,...i)}));return op({timezone:i,value:a,defaultValue:void 0,onChange:c,valueManager:s})},ap=t=>{let{props:i,valueManager:r,valueType:o,wrapperVariant:s,validator:a}=t;const{onAccept:l,onChange:c,value:u,defaultValue:h,closeOnSelect:d="desktop"===s,selectedSections:p,onSelectedSectionsChange:f,timezone:m}=i,{current:g}=e.useRef(h),{current:y}=e.useRef(void 0!==u);const _=Vu(),v=ju(),[x,b]=wl({controlled:p,default:null,name:"usePickerValue",state:"selectedSections"}),{isOpen:w,setIsOpen:S}=(t=>{let{open:i,onOpen:r,onClose:n}=t;const o=e.useRef("boolean"===typeof i).current,[s,a]=e.useState(!1);return e.useEffect((()=>{if(o){if("boolean"!==typeof i)throw new Error("You must not mix controlling and uncontrolled mode for `open` prop");a(i)}}),[o,i]),{isOpen:s,setIsOpen:e.useCallback((e=>{o||a(e),e&&r&&r(),!e&&n&&n()}),[o,r,n])}})(i),[T,M]=e.useState((()=>{let e;return e=void 0!==u?u:void 0!==g?g:r.emptyValue,{draft:e,lastPublishedValue:e,lastCommittedValue:e,lastControlledValue:u,hasBeenModifiedSinceMount:!1}})),{timezone:A,handleValueChange:C}=op({timezone:m,value:u,defaultValue:g,onChange:c,valueManager:r});np((0,n.A)({},i,{value:T.draft,timezone:A}),a,r.isSameError,r.defaultErrorState);const E=Yn((e=>{const t={action:e,dateState:T,hasChanged:t=>!r.areValuesEqual(_,e.value,t),isControlled:y,closeOnSelect:d},o=(e=>{const{action:t,hasChanged:i,dateState:r,isControlled:n}=e,o=!n&&!r.hasBeenModifiedSinceMount;return"setValueFromField"===t.name||("setValueFromAction"===t.name?!(!o||!["accept","today","clear"].includes(t.pickerAction))||i(r.lastPublishedValue):("setValueFromView"===t.name&&"shallow"!==t.selectionState||"setValueFromShortcut"===t.name)&&(!!o||i(r.lastPublishedValue)))})(t),s=(e=>{const{action:t,hasChanged:i,dateState:r,isControlled:n,closeOnSelect:o}=e,s=!n&&!r.hasBeenModifiedSinceMount;return"setValueFromAction"===t.name?!(!s||!["accept","today","clear"].includes(t.pickerAction))||i(r.lastCommittedValue):"setValueFromView"===t.name&&"finish"===t.selectionState&&o?!!s||i(r.lastCommittedValue):"setValueFromShortcut"===t.name&&"accept"===t.changeImportance&&i(r.lastCommittedValue)})(t),c=(e=>{const{action:t,closeOnSelect:i}=e;return"setValueFromAction"===t.name||("setValueFromView"===t.name?"finish"===t.selectionState&&i:"setValueFromShortcut"===t.name&&"accept"===t.changeImportance)})(t);if(M((t=>(0,n.A)({},t,{draft:e.value,lastPublishedValue:o?e.value:t.lastPublishedValue,lastCommittedValue:s?e.value:t.lastCommittedValue,hasBeenModifiedSinceMount:!0}))),o){const t={validationError:"setValueFromField"===e.name?e.context.validationError:a({adapter:v,value:e.value,props:(0,n.A)({},i,{value:e.value,timezone:A})})};"setValueFromShortcut"===e.name&&null!=e.shortcut&&(t.shortcut=e.shortcut),C(e.value,t)}s&&l&&l(e.value),c&&S(!1)}));if(void 0!==u&&(void 0===T.lastControlledValue||!r.areValuesEqual(_,T.lastControlledValue,u))){const e=r.areValuesEqual(_,T.draft,u);M((t=>(0,n.A)({},t,{lastControlledValue:u},e?{}:{lastCommittedValue:u,lastPublishedValue:u,draft:u,hasBeenModifiedSinceMount:!0})))}const P=Yn((()=>{E({value:r.emptyValue,name:"setValueFromAction",pickerAction:"clear"})})),k=Yn((()=>{E({value:T.lastPublishedValue,name:"setValueFromAction",pickerAction:"accept"})})),I=Yn((()=>{E({value:T.lastPublishedValue,name:"setValueFromAction",pickerAction:"dismiss"})})),D=Yn((()=>{E({value:T.lastCommittedValue,name:"setValueFromAction",pickerAction:"cancel"})})),L=Yn((()=>{E({value:r.getTodayValue(_,A,o),name:"setValueFromAction",pickerAction:"today"})})),R=Yn((()=>S(!0))),z=Yn((()=>S(!1))),O=Yn((function(e){return E({name:"setValueFromView",value:e,selectionState:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"partial"})})),F=Yn(((e,t,i)=>E({name:"setValueFromShortcut",value:e,changeImportance:null!=t?t:"accept",shortcut:i}))),B=Yn(((e,t)=>E({name:"setValueFromField",value:e,context:t}))),N=Yn((e=>{b(e),null==f||f(e)})),j={onClear:P,onAccept:k,onDismiss:I,onCancel:D,onSetToday:L,onOpen:R,onClose:z},V={value:T.draft,onChange:B,selectedSections:x,onSelectedSectionsChange:N},U=e.useMemo((()=>r.cleanValue(_,T.draft)),[_,r,T.draft]);return{open:w,fieldProps:V,viewProps:{value:U,onChange:O,onClose:z,open:w,onSelectedSectionsChange:N},layoutProps:(0,n.A)({},j,{value:U,onChange:O,onSelectShortcut:F,isValid:e=>{const t=a({adapter:v,value:e,props:(0,n.A)({},i,{value:e,timezone:A})});return!r.hasError(t)}}),actions:j}};function lp(t){let{onChange:i,onViewChange:r,openTo:n,view:o,views:s,autoFocus:a,focusedView:l,onFocusedViewChange:c}=t;var u,h;const d=e.useRef(n),p=e.useRef(s),f=e.useRef(s.includes(n)?n:s[0]),[m,g]=wl({name:"useViews",state:"view",controlled:o,default:f.current}),y=e.useRef(a?m:null),[_,v]=wl({name:"useViews",state:"focusedView",controlled:l,default:y.current});e.useEffect((()=>{(d.current&&d.current!==n||p.current&&p.current.some((e=>!s.includes(e))))&&(g(s.includes(n)?n:s[0]),p.current=s,d.current=n)}),[n,g,m,s]);const x=s.indexOf(m),b=null!=(u=s[x-1])?u:null,w=null!=(h=s[x+1])?h:null,S=Yn(((e,t)=>{v(t?e:t=>e===t?null:t),null==c||c(e,t)})),T=Yn((e=>{S(e,!0),e!==m&&(g(e),r&&r(e))})),M=Yn((()=>{w&&T(w)})),A=Yn(((e,t,r)=>{const n="finish"===t,o=r?s.indexOf(r)<s.length-1:Boolean(w);if(i(e,n&&o?"partial":t,r),r&&r!==m){const e=s[s.indexOf(r)+1];e&&T(e)}else n&&M()}));return{view:m,setView:T,focusedView:_,setFocusedView:S,nextView:w,previousView:b,defaultView:s.includes(n)?n:s[0],goToNextView:M,setValueAndGoToNextView:A}}const cp=["className","sx"],up=t=>{let{props:i,propsFromPickerValue:r,additionalViewProps:s,inputRef:a,autoFocusView:l}=t;const{onChange:c,open:u,onSelectedSectionsChange:h,onClose:d}=r,{view:p,views:f,openTo:m,onViewChange:g,viewRenderers:y,timezone:_}=i,v=(0,o.A)(i,cp),{view:x,setView:b,defaultView:w,focusedView:S,setFocusedView:T,setValueAndGoToNextView:M}=lp({view:p,views:f,openTo:m,onChange:c,onViewChange:g,autoFocus:l}),{hasUIView:A,viewModeLookup:C}=e.useMemo((()=>f.reduce(((e,t)=>{let i;return i=null!=y[t]?"UI":"field",e.viewModeLookup[t]=i,"UI"===i&&(e.hasUIView=!0),e}),{hasUIView:!1,viewModeLookup:{}})),[y,f]),E=e.useMemo((()=>f.reduce(((e,t)=>null!=y[t]&&(e=>du.includes(e))(t)?e+1:e),0)),[y,f]),P=C[x],k=Yn((()=>"UI"===P)),[I,D]=e.useState("UI"===P?x:null);I!==x&&"UI"===C[x]&&D(x),Xn((()=>{"field"===P&&u&&(d(),setTimeout((()=>{null==a||a.current.focus(),h(x)})))}),[x]),Xn((()=>{if(!u)return;let e=x;"field"===P&&null!=I&&(e=I),e!==w&&"UI"===C[e]&&"UI"===C[w]&&(e=w),e!==x&&b(e),T(e,!0)}),[u]);return{hasUIView:A,shouldRestoreFocus:k,layoutProps:{views:f,view:I,onViewChange:b},renderCurrentView:()=>{if(null==I)return null;const e=y[I];return null==e?null:e((0,n.A)({},v,s,r,{views:f,timezone:_,onChange:M,view:I,onViewChange:b,focusedView:S,onFocusedViewChange:T,showViewSwitcher:E>1,timeViewsCount:E}))}}};function hp(){return"undefined"===typeof window?"portrait":window.screen&&window.screen.orientation&&window.screen.orientation.angle?90===Math.abs(window.screen.orientation.angle)?"landscape":"portrait":window.orientation&&90===Math.abs(Number(window.orientation))?"landscape":"portrait"}const dp=(t,i)=>{const[r,n]=e.useState(hp);if(Xn((()=>{const e=()=>{n(hp())};return window.addEventListener("orientationchange",e),()=>{window.removeEventListener("orientationchange",e)}}),[]),o=t,s=["hours","minutes","seconds"],Array.isArray(s)?s.every((e=>-1!==o.indexOf(e))):-1!==o.indexOf(s))return!1;var o,s;return"landscape"===(i||r)},pp=(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"warning",i=!1;const r=Array.isArray(e)?e.join("\n"):e}(["The `renderInput` prop has been removed in version 6.0 of the Date and Time Pickers.","You can replace it with the `textField` component slot in most cases.","For more information, please have a look at the migration guide (https://mui.com/x/migration/migration-pickers-v5/#input-renderer-required-in-v5)."]),e=>{let{props:t,valueManager:i,valueType:r,wrapperVariant:o,inputRef:s,additionalViewProps:a,validator:l,autoFocusView:c}=e;const u=ap({props:t,valueManager:i,valueType:r,wrapperVariant:o,validator:l}),h=up({props:t,inputRef:s,additionalViewProps:a,autoFocusView:c,propsFromPickerValue:u.viewProps}),d=(e=>{let{props:t,propsFromPickerValue:i,propsFromPickerViews:r,wrapperVariant:o}=e;const{orientation:s}=t,a=dp(r.views,s);return{layoutProps:(0,n.A)({},r,i,{isLandscape:a,wrapperVariant:o,disabled:t.disabled,readOnly:t.readOnly})}})({props:t,wrapperVariant:o,propsFromPickerValue:u.layoutProps,propsFromPickerViews:h.layoutProps});return{open:u.open,actions:u.actions,fieldProps:u.fieldProps,renderCurrentView:h.renderCurrentView,hasUIView:h.hasUIView,shouldRestoreFocus:h.shouldRestoreFocus,layoutProps:d.layoutProps}});function fp(e){return yo("MuiPickersLayout",e)}const mp=_o("MuiPickersLayout",["root","landscape","contentWrapper","toolbar","actionBar","tabs","shortcuts"]);function gp(e){return yo("MuiButton",e)}const yp=_o("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]);const _p=e.createContext({});const vp=e.createContext(void 0),xp=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],bp=e=>(0,n.A)({},"small"===e.size&&{"& > *:nth-of-type(1)":{fontSize:18}},"medium"===e.size&&{"& > *:nth-of-type(1)":{fontSize:20}},"large"===e.size&&{"& > *:nth-of-type(1)":{fontSize:22}}),wp=Nn(zc,{shouldForwardProp:e=>Bn(e)||"classes"===e,name:"MuiButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,t[i.variant],t[`${i.variant}${oo(i.color)}`],t[`size${oo(i.size)}`],t[`${i.variant}Size${oo(i.size)}`],"inherit"===i.color&&t.colorInherit,i.disableElevation&&t.disableElevation,i.fullWidth&&t.fullWidth]}})((e=>{let{theme:t,ownerState:i}=e;var r,o;const s="light"===t.palette.mode?t.palette.grey[300]:t.palette.grey[800],a="light"===t.palette.mode?t.palette.grey.A100:t.palette.grey[700];return(0,n.A)({},t.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":(0,n.A)({textDecoration:"none",backgroundColor:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:(0,y.X4)(t.palette.text.primary,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"text"===i.variant&&"inherit"!==i.color&&{backgroundColor:t.vars?`rgba(${t.vars.palette[i.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:(0,y.X4)(t.palette[i.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"outlined"===i.variant&&"inherit"!==i.color&&{border:`1px solid ${(t.vars||t).palette[i.color].main}`,backgroundColor:t.vars?`rgba(${t.vars.palette[i.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:(0,y.X4)(t.palette[i.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"contained"===i.variant&&{backgroundColor:t.vars?t.vars.palette.Button.inheritContainedHoverBg:a,boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2],backgroundColor:(t.vars||t).palette.grey[300]}},"contained"===i.variant&&"inherit"!==i.color&&{backgroundColor:(t.vars||t).palette[i.color].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[i.color].main}}),"&:active":(0,n.A)({},"contained"===i.variant&&{boxShadow:(t.vars||t).shadows[8]}),[`&.${yp.focusVisible}`]:(0,n.A)({},"contained"===i.variant&&{boxShadow:(t.vars||t).shadows[6]}),[`&.${yp.disabled}`]:(0,n.A)({color:(t.vars||t).palette.action.disabled},"outlined"===i.variant&&{border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`},"contained"===i.variant&&{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground})},"text"===i.variant&&{padding:"6px 8px"},"text"===i.variant&&"inherit"!==i.color&&{color:(t.vars||t).palette[i.color].main},"outlined"===i.variant&&{padding:"5px 15px",border:"1px solid currentColor"},"outlined"===i.variant&&"inherit"!==i.color&&{color:(t.vars||t).palette[i.color].main,border:t.vars?`1px solid rgba(${t.vars.palette[i.color].mainChannel} / 0.5)`:`1px solid ${(0,y.X4)(t.palette[i.color].main,.5)}`},"contained"===i.variant&&{color:t.vars?t.vars.palette.text.primary:null==(r=(o=t.palette).getContrastText)?void 0:r.call(o,t.palette.grey[300]),backgroundColor:t.vars?t.vars.palette.Button.inheritContainedBg:s,boxShadow:(t.vars||t).shadows[2]},"contained"===i.variant&&"inherit"!==i.color&&{color:(t.vars||t).palette[i.color].contrastText,backgroundColor:(t.vars||t).palette[i.color].main},"inherit"===i.color&&{color:"inherit",borderColor:"currentColor"},"small"===i.size&&"text"===i.variant&&{padding:"4px 5px",fontSize:t.typography.pxToRem(13)},"large"===i.size&&"text"===i.variant&&{padding:"8px 11px",fontSize:t.typography.pxToRem(15)},"small"===i.size&&"outlined"===i.variant&&{padding:"3px 9px",fontSize:t.typography.pxToRem(13)},"large"===i.size&&"outlined"===i.variant&&{padding:"7px 21px",fontSize:t.typography.pxToRem(15)},"small"===i.size&&"contained"===i.variant&&{padding:"4px 10px",fontSize:t.typography.pxToRem(13)},"large"===i.size&&"contained"===i.variant&&{padding:"8px 22px",fontSize:t.typography.pxToRem(15)},i.fullWidth&&{width:"100%"})}),(e=>{let{ownerState:t}=e;return t.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${yp.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${yp.disabled}`]:{boxShadow:"none"}}})),Sp=Nn("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.startIcon,t[`iconSize${oo(i.size)}`]]}})((e=>{let{ownerState:t}=e;return(0,n.A)({display:"inherit",marginRight:8,marginLeft:-4},"small"===t.size&&{marginLeft:-2},bp(t))})),Tp=Nn("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.endIcon,t[`iconSize${oo(i.size)}`]]}})((e=>{let{ownerState:t}=e;return(0,n.A)({display:"inherit",marginRight:-4,marginLeft:8},"small"===t.size&&{marginRight:-2},bp(t))})),Mp=e.forwardRef((function(t,i){const r=e.useContext(_p),a=e.useContext(vp),l=Un({props:s(r,t),name:"MuiButton"}),{children:c,color:u="primary",component:h="button",className:d,disabled:p=!1,disableElevation:f=!1,disableFocusRipple:m=!1,endIcon:g,focusVisibleClassName:y,fullWidth:_=!1,size:v="medium",startIcon:x,type:b,variant:w="text"}=l,S=(0,o.A)(l,xp),T=(0,n.A)({},l,{color:u,component:h,disabled:p,disableElevation:f,disableFocusRipple:m,fullWidth:_,size:v,type:b,variant:w}),M=(e=>{const{color:t,disableElevation:i,fullWidth:r,size:o,variant:s,classes:a}=e,l=Dn({root:["root",s,`${s}${oo(t)}`,`size${oo(o)}`,`${s}Size${oo(o)}`,`color${oo(t)}`,i&&"disableElevation",r&&"fullWidth"],label:["label"],startIcon:["icon","startIcon",`iconSize${oo(o)}`],endIcon:["icon","endIcon",`iconSize${oo(o)}`]},gp,a);return(0,n.A)({},a,l)})(T),A=x&&(0,Y.jsx)(Sp,{className:M.startIcon,ownerState:T,children:x}),C=g&&(0,Y.jsx)(Tp,{className:M.endIcon,ownerState:T,children:g}),E=a||"";return(0,Y.jsxs)(wp,(0,n.A)({ownerState:T,className:In(r.className,M.root,d,E),component:h,disabled:p,focusRipple:!m,focusVisibleClassName:In(M.focusVisible,y),ref:i,type:b},S,{classes:M,children:[A,c,C]}))}));function Ap(e){return yo("MuiDialogActions",e)}_o("MuiDialogActions",["root","spacing"]);const Cp=["className","disableSpacing"],Ep=Nn("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,!i.disableSpacing&&t.spacing]}})((e=>{let{ownerState:t}=e;return(0,n.A)({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto"},!t.disableSpacing&&{"& > :not(style) ~ :not(style)":{marginLeft:8}})})),Pp=e.forwardRef((function(e,t){const i=Un({props:e,name:"MuiDialogActions"}),{className:r,disableSpacing:s=!1}=i,a=(0,o.A)(i,Cp),l=(0,n.A)({},i,{disableSpacing:s}),c=(e=>{const{classes:t,disableSpacing:i}=e;return Dn({root:["root",!i&&"spacing"]},Ap,t)})(l);return(0,Y.jsx)(Ep,(0,n.A)({className:In(c.root,r),ownerState:l,ref:t},a))})),kp=["onAccept","onClear","onCancel","onSetToday","actions"];function Ip(e){const{onAccept:t,onClear:i,onCancel:r,onSetToday:s,actions:a}=e,l=(0,o.A)(e,kp),c=Gu();if(null==a||0===a.length)return null;const u=null==a?void 0:a.map((e=>{switch(e){case"clear":return(0,Y.jsx)(Mp,{onClick:i,children:c.clearButtonLabel},e);case"cancel":return(0,Y.jsx)(Mp,{onClick:r,children:c.cancelButtonLabel},e);case"accept":return(0,Y.jsx)(Mp,{onClick:t,children:c.okButtonLabel},e);case"today":return(0,Y.jsx)(Mp,{onClick:s,children:c.todayButtonLabel},e);default:return null}}));return(0,Y.jsx)(Pp,(0,n.A)({},l,{children:u}))}function Dp(e){return yo("MuiListItem",e)}const Lp=_o("MuiListItem",["root","container","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","padding","button","secondaryAction","selected"]);const Rp=_o("MuiListItemButton",["root","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","selected"]);function zp(e){return yo("MuiListItemSecondaryAction",e)}_o("MuiListItemSecondaryAction",["root","disableGutters"]);const Op=["className"],Fp=Nn("div",{name:"MuiListItemSecondaryAction",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,i.disableGutters&&t.disableGutters]}})((e=>{let{ownerState:t}=e;return(0,n.A)({position:"absolute",right:16,top:"50%",transform:"translateY(-50%)"},t.disableGutters&&{right:0})})),Bp=e.forwardRef((function(t,i){const r=Un({props:t,name:"MuiListItemSecondaryAction"}),{className:s}=r,a=(0,o.A)(r,Op),l=e.useContext(Ds),c=(0,n.A)({},r,{disableGutters:l.disableGutters}),u=(e=>{const{disableGutters:t,classes:i}=e;return Dn({root:["root",t&&"disableGutters"]},zp,i)})(c);return(0,Y.jsx)(Fp,(0,n.A)({className:In(u.root,s),ownerState:c,ref:i},a))}));Bp.muiName="ListItemSecondaryAction";const Np=Bp,jp=["className"],Vp=["alignItems","autoFocus","button","children","className","component","components","componentsProps","ContainerComponent","ContainerProps","dense","disabled","disableGutters","disablePadding","divider","focusVisibleClassName","secondaryAction","selected","slotProps","slots"],Up=Nn("div",{name:"MuiListItem",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,i.dense&&t.dense,"flex-start"===i.alignItems&&t.alignItemsFlexStart,i.divider&&t.divider,!i.disableGutters&&t.gutters,!i.disablePadding&&t.padding,i.button&&t.button,i.hasSecondaryAction&&t.secondaryAction]}})((e=>{let{theme:t,ownerState:i}=e;return(0,n.A)({display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",width:"100%",boxSizing:"border-box",textAlign:"left"},!i.disablePadding&&(0,n.A)({paddingTop:8,paddingBottom:8},i.dense&&{paddingTop:4,paddingBottom:4},!i.disableGutters&&{paddingLeft:16,paddingRight:16},!!i.secondaryAction&&{paddingRight:48}),!!i.secondaryAction&&{[`& > .${Rp.root}`]:{paddingRight:48}},{[`&.${Lp.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${Lp.selected}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:(0,y.X4)(t.palette.primary.main,t.palette.action.selectedOpacity),[`&.${Lp.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:(0,y.X4)(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},[`&.${Lp.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity}},"flex-start"===i.alignItems&&{alignItems:"flex-start"},i.divider&&{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"},i.button&&{transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Lp.selected}:hover`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:(0,y.X4)(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:(0,y.X4)(t.palette.primary.main,t.palette.action.selectedOpacity)}}},i.hasSecondaryAction&&{paddingRight:48})})),Gp=Nn("li",{name:"MuiListItem",slot:"Container",overridesResolver:(e,t)=>t.container})({position:"relative"}),Hp=e.forwardRef((function(t,i){const r=Un({props:t,name:"MuiListItem"}),{alignItems:s="center",autoFocus:a=!1,button:l=!1,children:c,className:u,component:h,components:d={},componentsProps:p={},ContainerComponent:f="li",ContainerProps:{className:m}={},dense:g=!1,disabled:y=!1,disableGutters:_=!1,disablePadding:v=!1,divider:x=!1,focusVisibleClassName:b,secondaryAction:w,selected:S=!1,slotProps:T={},slots:M={}}=r,A=(0,o.A)(r.ContainerProps,jp),C=(0,o.A)(r,Vp),E=e.useContext(Ds),P=e.useMemo((()=>({dense:g||E.dense||!1,alignItems:s,disableGutters:_})),[s,E.dense,g,_]),k=e.useRef(null);ao((()=>{a&&k.current&&k.current.focus()}),[a]);const I=e.Children.toArray(c),D=I.length&&hs(I[I.length-1],["ListItemSecondaryAction"]),L=(0,n.A)({},r,{alignItems:s,autoFocus:a,button:l,dense:P.dense,disabled:y,disableGutters:_,disablePadding:v,divider:x,hasSecondaryAction:D,selected:S}),R=(e=>{const{alignItems:t,button:i,classes:r,dense:n,disabled:o,disableGutters:s,disablePadding:a,divider:l,hasSecondaryAction:c,selected:u}=e;return Dn({root:["root",n&&"dense",!s&&"gutters",!a&&"padding",l&&"divider",o&&"disabled",i&&"button","flex-start"===t&&"alignItemsFlexStart",c&&"secondaryAction",u&&"selected"],container:["container"]},Dp,r)})(L),z=so(k,i),O=M.root||d.Root||Up,F=T.root||p.root||{},B=(0,n.A)({className:In(R.root,F.className,u),disabled:y},C);let N=h||"li";return l&&(B.component=h||"div",B.focusVisibleClassName=In(Lp.focusVisible,b),N=zc),D?(N=B.component||h?N:"div","li"===f&&("li"===N?N="div":"li"===B.component&&(B.component="div")),(0,Y.jsx)(Ds.Provider,{value:P,children:(0,Y.jsxs)(Gp,(0,n.A)({as:f,className:In(R.container,m),ref:z,ownerState:L},A,{children:[(0,Y.jsx)(O,(0,n.A)({},F,!Gn(O)&&{as:N,ownerState:(0,n.A)({},L,F.ownerState)},B,{children:I})),I.pop()]}))})):(0,Y.jsx)(Ds.Provider,{value:P,children:(0,Y.jsxs)(O,(0,n.A)({},F,{as:N,ref:z},!Gn(O)&&{ownerState:(0,n.A)({},L,F.ownerState)},B,{children:[I,w&&(0,Y.jsx)(Np,{children:w})]}))})})),Wp=Nl((0,Y.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel");function $p(e){return yo("MuiChip",e)}const qp=_o("MuiChip",["root","sizeSmall","sizeMedium","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),Xp=["avatar","className","clickable","color","component","deleteIcon","disabled","icon","label","onClick","onDelete","onKeyDown","onKeyUp","size","variant","tabIndex","skipFocusWhenDisabled"],Yp=Nn("div",{name:"MuiChip",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e,{color:r,iconColor:n,clickable:o,onDelete:s,size:a,variant:l}=i;return[{[`& .${qp.avatar}`]:t.avatar},{[`& .${qp.avatar}`]:t[`avatar${oo(a)}`]},{[`& .${qp.avatar}`]:t[`avatarColor${oo(r)}`]},{[`& .${qp.icon}`]:t.icon},{[`& .${qp.icon}`]:t[`icon${oo(a)}`]},{[`& .${qp.icon}`]:t[`iconColor${oo(n)}`]},{[`& .${qp.deleteIcon}`]:t.deleteIcon},{[`& .${qp.deleteIcon}`]:t[`deleteIcon${oo(a)}`]},{[`& .${qp.deleteIcon}`]:t[`deleteIconColor${oo(r)}`]},{[`& .${qp.deleteIcon}`]:t[`deleteIcon${oo(l)}Color${oo(r)}`]},t.root,t[`size${oo(a)}`],t[`color${oo(r)}`],o&&t.clickable,o&&"default"!==r&&t[`clickableColor${oo(r)})`],s&&t.deletable,s&&"default"!==r&&t[`deletableColor${oo(r)}`],t[l],t[`${l}${oo(r)}`]]}})((e=>{let{theme:t,ownerState:i}=e;const r="light"===t.palette.mode?t.palette.grey[700]:t.palette.grey[300];return(0,n.A)({maxWidth:"100%",fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:(t.vars||t).palette.text.primary,backgroundColor:(t.vars||t).palette.action.selected,borderRadius:16,whiteSpace:"nowrap",transition:t.transitions.create(["background-color","box-shadow"]),cursor:"unset",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${qp.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${qp.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:t.vars?t.vars.palette.Chip.defaultAvatarColor:r,fontSize:t.typography.pxToRem(12)},[`& .${qp.avatarColorPrimary}`]:{color:(t.vars||t).palette.primary.contrastText,backgroundColor:(t.vars||t).palette.primary.dark},[`& .${qp.avatarColorSecondary}`]:{color:(t.vars||t).palette.secondary.contrastText,backgroundColor:(t.vars||t).palette.secondary.dark},[`& .${qp.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:t.typography.pxToRem(10)},[`& .${qp.icon}`]:(0,n.A)({marginLeft:5,marginRight:-6},"small"===i.size&&{fontSize:18,marginLeft:4,marginRight:-4},i.iconColor===i.color&&(0,n.A)({color:t.vars?t.vars.palette.Chip.defaultIconColor:r},"default"!==i.color&&{color:"inherit"})),[`& .${qp.deleteIcon}`]:(0,n.A)({WebkitTapHighlightColor:"transparent",color:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / 0.26)`:(0,y.X4)(t.palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / 0.4)`:(0,y.X4)(t.palette.text.primary,.4)}},"small"===i.size&&{fontSize:16,marginRight:4,marginLeft:-4},"default"!==i.color&&{color:t.vars?`rgba(${t.vars.palette[i.color].contrastTextChannel} / 0.7)`:(0,y.X4)(t.palette[i.color].contrastText,.7),"&:hover, &:active":{color:(t.vars||t).palette[i.color].contrastText}})},"small"===i.size&&{height:24},"default"!==i.color&&{backgroundColor:(t.vars||t).palette[i.color].main,color:(t.vars||t).palette[i.color].contrastText},i.onDelete&&{[`&.${qp.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.action.selectedChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:(0,y.X4)(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},i.onDelete&&"default"!==i.color&&{[`&.${qp.focusVisible}`]:{backgroundColor:(t.vars||t).palette[i.color].dark}})}),(e=>{let{theme:t,ownerState:i}=e;return(0,n.A)({},i.clickable&&{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.selectedChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:(0,y.X4)(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity)},[`&.${qp.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.action.selectedChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:(0,y.X4)(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)},"&:active":{boxShadow:(t.vars||t).shadows[1]}},i.clickable&&"default"!==i.color&&{[`&:hover, &.${qp.focusVisible}`]:{backgroundColor:(t.vars||t).palette[i.color].dark}})}),(e=>{let{theme:t,ownerState:i}=e;return(0,n.A)({},"outlined"===i.variant&&{backgroundColor:"transparent",border:t.vars?`1px solid ${t.vars.palette.Chip.defaultBorder}`:`1px solid ${"light"===t.palette.mode?t.palette.grey[400]:t.palette.grey[700]}`,[`&.${qp.clickable}:hover`]:{backgroundColor:(t.vars||t).palette.action.hover},[`&.${qp.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`& .${qp.avatar}`]:{marginLeft:4},[`& .${qp.avatarSmall}`]:{marginLeft:2},[`& .${qp.icon}`]:{marginLeft:4},[`& .${qp.iconSmall}`]:{marginLeft:2},[`& .${qp.deleteIcon}`]:{marginRight:5},[`& .${qp.deleteIconSmall}`]:{marginRight:3}},"outlined"===i.variant&&"default"!==i.color&&{color:(t.vars||t).palette[i.color].main,border:`1px solid ${t.vars?`rgba(${t.vars.palette[i.color].mainChannel} / 0.7)`:(0,y.X4)(t.palette[i.color].main,.7)}`,[`&.${qp.clickable}:hover`]:{backgroundColor:t.vars?`rgba(${t.vars.palette[i.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:(0,y.X4)(t.palette[i.color].main,t.palette.action.hoverOpacity)},[`&.${qp.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette[i.color].mainChannel} / ${t.vars.palette.action.focusOpacity})`:(0,y.X4)(t.palette[i.color].main,t.palette.action.focusOpacity)},[`& .${qp.deleteIcon}`]:{color:t.vars?`rgba(${t.vars.palette[i.color].mainChannel} / 0.7)`:(0,y.X4)(t.palette[i.color].main,.7),"&:hover, &:active":{color:(t.vars||t).palette[i.color].main}}})})),Zp=Nn("span",{name:"MuiChip",slot:"Label",overridesResolver:(e,t)=>{const{ownerState:i}=e,{size:r}=i;return[t.label,t[`label${oo(r)}`]]}})((e=>{let{ownerState:t}=e;return(0,n.A)({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap"},"outlined"===t.variant&&{paddingLeft:11,paddingRight:11},"small"===t.size&&{paddingLeft:8,paddingRight:8},"small"===t.size&&"outlined"===t.variant&&{paddingLeft:7,paddingRight:7})}));function Kp(e){return"Backspace"===e.key||"Delete"===e.key}const Jp=e.forwardRef((function(t,i){const r=Un({props:t,name:"MuiChip"}),{avatar:s,className:a,clickable:l,color:c="default",component:u,deleteIcon:h,disabled:d=!1,icon:p,label:f,onClick:m,onDelete:g,onKeyDown:y,onKeyUp:_,size:v="medium",variant:x="filled",tabIndex:b,skipFocusWhenDisabled:w=!1}=r,S=(0,o.A)(r,Xp),T=e.useRef(null),M=so(T,i),A=e=>{e.stopPropagation(),g&&g(e)},C=!(!1===l||!m)||l,E=C||g?zc:u||"div",P=(0,n.A)({},r,{component:E,disabled:d,size:v,color:c,iconColor:e.isValidElement(p)&&p.props.color||c,onDelete:!!g,clickable:C,variant:x}),k=(e=>{const{classes:t,disabled:i,size:r,color:n,iconColor:o,onDelete:s,clickable:a,variant:l}=e;return Dn({root:["root",l,i&&"disabled",`size${oo(r)}`,`color${oo(n)}`,a&&"clickable",a&&`clickableColor${oo(n)}`,s&&"deletable",s&&`deletableColor${oo(n)}`,`${l}${oo(n)}`],label:["label",`label${oo(r)}`],avatar:["avatar",`avatar${oo(r)}`,`avatarColor${oo(n)}`],icon:["icon",`icon${oo(r)}`,`iconColor${oo(o)}`],deleteIcon:["deleteIcon",`deleteIcon${oo(r)}`,`deleteIconColor${oo(n)}`,`deleteIcon${oo(l)}Color${oo(n)}`]},$p,t)})(P),I=E===zc?(0,n.A)({component:u||"div",focusVisibleClassName:k.focusVisible},g&&{disableRipple:!0}):{};let D=null;g&&(D=h&&e.isValidElement(h)?e.cloneElement(h,{className:In(h.props.className,k.deleteIcon),onClick:A}):(0,Y.jsx)(Wp,{className:In(k.deleteIcon),onClick:A}));let L=null;s&&e.isValidElement(s)&&(L=e.cloneElement(s,{className:In(k.avatar,s.props.className)}));let R=null;return p&&e.isValidElement(p)&&(R=e.cloneElement(p,{className:In(k.icon,p.props.className)})),(0,Y.jsxs)(Yp,(0,n.A)({as:E,className:In(k.root,a),disabled:!(!C||!d)||void 0,onClick:m,onKeyDown:e=>{e.currentTarget===e.target&&Kp(e)&&e.preventDefault(),y&&y(e)},onKeyUp:e=>{e.currentTarget===e.target&&(g&&Kp(e)?g(e):"Escape"===e.key&&T.current&&T.current.blur()),_&&_(e)},ref:M,tabIndex:w&&d?-1:b,ownerState:P},I,S,{children:[L||R,(0,Y.jsx)(Zp,{className:In(k.label),ownerState:P,children:f}),D]}))})),Qp=320,ef=["items","changeImportance","isLandscape","onChange","isValid"],tf=["getValue"];function rf(e){const{items:t,changeImportance:i,onChange:r,isValid:s}=e,a=(0,o.A)(e,ef);if(null==t||0===t.length)return null;const l=t.map((e=>{let{getValue:t}=e,n=(0,o.A)(e,tf);const a=t({isValid:s});return{label:n.label,onClick:()=>{r(a,i,n)},disabled:!s(a)}}));return(0,Y.jsx)(Os,(0,n.A)({dense:!0,sx:[{maxHeight:334,maxWidth:200,overflow:"auto"},...Array.isArray(a.sx)?a.sx:[a.sx]]},a,{children:l.map((e=>(0,Y.jsx)(Hp,{children:(0,Y.jsx)(Jp,(0,n.A)({},e))},e.label)))}))}const nf=e=>{var t,i;const{wrapperVariant:r,onAccept:o,onClear:s,onCancel:a,onSetToday:l,view:c,views:u,onViewChange:h,value:d,onChange:p,onSelectShortcut:f,isValid:m,isLandscape:g,disabled:y,readOnly:_,children:v,components:x,componentsProps:b,slots:w,slotProps:S}=e,T=null!=w?w:ah(x),M=null!=S?S:b,A=(e=>{const{classes:t,isLandscape:i}=e;return Dn({root:["root",i&&"landscape"],contentWrapper:["contentWrapper"],toolbar:["toolbar"],actionBar:["actionBar"],tabs:["tabs"],landscape:["landscape"],shortcuts:["shortcuts"]},fp,t)})(e),C=null!=(t=null==T?void 0:T.actionBar)?t:Ip,E=dh({elementType:C,externalSlotProps:null==M?void 0:M.actionBar,additionalProps:{onAccept:o,onClear:s,onCancel:a,onSetToday:l,actions:"desktop"===r?[]:["cancel","accept"],className:A.actionBar},ownerState:(0,n.A)({},e,{wrapperVariant:r})}),P=(0,Y.jsx)(C,(0,n.A)({},E)),k=null==T?void 0:T.toolbar,I=dh({elementType:k,externalSlotProps:null==M?void 0:M.toolbar,additionalProps:{isLandscape:g,onChange:p,value:d,view:c,onViewChange:h,views:u,disabled:y,readOnly:_,className:A.toolbar},ownerState:(0,n.A)({},e,{wrapperVariant:r})}),D=function(e){return null!==e.view}(I)&&k?(0,Y.jsx)(k,(0,n.A)({},I)):null,L=v,R=null==T?void 0:T.tabs,z=c&&R?(0,Y.jsx)(R,(0,n.A)({view:c,onViewChange:h,className:A.tabs},null==M?void 0:M.tabs)):null,O=null!=(i=null==T?void 0:T.shortcuts)?i:rf,F=dh({elementType:O,externalSlotProps:null==M?void 0:M.shortcuts,additionalProps:{isValid:m,isLandscape:g,onChange:f,className:A.shortcuts},ownerState:{isValid:m,isLandscape:g,onChange:f,className:A.shortcuts,wrapperVariant:r}});return{toolbar:D,content:L,tabs:z,actionBar:P,shortcuts:c&&O?(0,Y.jsx)(O,(0,n.A)({},F)):null}},of=Nn("div",{name:"MuiPickersLayout",slot:"Root",overridesResolver:(e,t)=>t.root})((e=>{let{theme:t,ownerState:i}=e;return{display:"grid",gridAutoColumns:"max-content auto max-content",gridAutoRows:"max-content auto max-content",[`& .${mp.toolbar}`]:i.isLandscape?{gridColumn:"rtl"===t.direction?3:1,gridRow:"2 / 3"}:{gridColumn:"2 / 4",gridRow:1},[`.${mp.shortcuts}`]:i.isLandscape?{gridColumn:"2 / 4",gridRow:1}:{gridColumn:"rtl"===t.direction?3:1,gridRow:"2 / 3"},[`& .${mp.actionBar}`]:{gridColumn:"1 / 4",gridRow:3}}}));of.propTypes={as:Qc().elementType,ownerState:Qc().shape({isLandscape:Qc().bool.isRequired}).isRequired,sx:Qc().oneOfType([Qc().arrayOf(Qc().oneOfType([Qc().func,Qc().object,Qc().bool])),Qc().func,Qc().object])};const sf=Nn("div",{name:"MuiPickersLayout",slot:"ContentWrapper",overridesResolver:(e,t)=>t.contentWrapper})({gridColumn:2,gridRow:2,display:"flex",flexDirection:"column"}),af=function(t){const i=X({props:t,name:"MuiPickersLayout"}),{toolbar:r,content:n,tabs:o,actionBar:s,shortcuts:a}=nf(i),{sx:l,className:c,isLandscape:u,ref:h,wrapperVariant:d}=i,p=i,f=(e=>{const{isLandscape:t,classes:i}=e;return Dn({root:["root",t&&"landscape"],contentWrapper:["contentWrapper"]},fp,i)})(p);return(0,Y.jsxs)(of,{ref:h,sx:l,className:In(c,f.root),ownerState:p,children:[u?a:r,u?r:a,(0,Y.jsx)(sf,{className:f.contentWrapper,children:"desktop"===d?(0,Y.jsxs)(e.Fragment,{children:[n,o]}):(0,Y.jsxs)(e.Fragment,{children:[o,n]})}),s]})},lf=["props","getOpenDialogAriaText"],cf=["ownerState"],uf=["ownerState"],hf=Nl((0,Y.jsx)("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),df=Nl((0,Y.jsx)("path",{d:"M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z"}),"ArrowLeft"),pf=Nl((0,Y.jsx)("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"}),"ArrowRight"),ff=Nl((0,Y.jsx)("path",{d:"M17 12h-5v5h5v-5zM16 1v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-1V1h-2zm3 18H5V8h14v11z"}),"Calendar"),mf=(Nl((0,Y.jsxs)(e.Fragment,{children:[(0,Y.jsx)("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),(0,Y.jsx)("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]}),"Clock"),Nl((0,Y.jsx)("path",{d:"M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"}),"DateRange"),Nl((0,Y.jsxs)(e.Fragment,{children:[(0,Y.jsx)("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),(0,Y.jsx)("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]}),"Time"),Nl((0,Y.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear")),gf=t=>{const i=Vu(),r=Gu(),o=ju(),s="rtl"===ca().direction,{valueManager:a,fieldValueManager:l,valueType:c,validator:u,internalProps:h,internalProps:{value:d,defaultValue:p,referenceDate:f,onChange:m,format:g,formatDensity:y="dense",selectedSections:_,onSelectedSectionsChange:v,shouldRespectLeadingZeros:x=!1,timezone:b}}=t,{timezone:w,value:S,handleValueChange:T}=op({timezone:b,value:d,defaultValue:p,onChange:m,valueManager:a}),M=e.useMemo((()=>((e,t)=>{const i=e.dateWithTimezone(void 0,t),r=e.endOfYear(i),n=e.endOfDay(i),{maxDaysInMonth:o,longestMonth:s}=su(e,i).reduce(((t,i)=>{const r=e.getDaysInMonth(i);return r>t.maxDaysInMonth?{maxDaysInMonth:r,longestMonth:i}:t}),{maxDaysInMonth:0,longestMonth:null});return{year:i=>{let{format:r}=i;return{minimum:0,maximum:Eu(e,t,r)?9999:99}},month:()=>({minimum:1,maximum:e.getMonth(r)+1}),day:t=>{let{currentDate:i}=t;return{minimum:1,maximum:null!=i&&e.isValid(i)?e.getDaysInMonth(i):o,longestMonth:s}},weekDay:i=>{let{format:r,contentType:n}=i;if("digit"===n){const i=_u(e,t,r).map(Number);return{minimum:Math.min(...i),maximum:Math.max(...i)}}return{minimum:1,maximum:7}},hours:t=>{let{format:r}=t;const o=e.getHours(n);return e.formatByString(e.endOfDay(i),r)!==o.toString()?{minimum:1,maximum:Number(e.formatByString(e.startOfDay(i),r))}:{minimum:0,maximum:o}},minutes:()=>({minimum:0,maximum:e.getMinutes(n)}),seconds:()=>({minimum:0,maximum:e.getSeconds(n)}),meridiem:()=>({minimum:0,maximum:0})}})(i,w)),[i,w]),A=e.useCallback((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return l.getSectionsFromValue(i,e,t,s,(e=>ku(i,w,r,g,e,y,x,s)))}),[l,g,r,s,x,i,y,w]),C=e.useMemo((()=>l.getValueStrFromSections(A(a.emptyValue),s)),[l,A,a.emptyValue,s]),[E,P]=e.useState((()=>{const e=A(S);Iu();const t={sections:e,value:S,referenceValue:a.emptyValue,tempValueStrAndroid:null},r=(e=>Math.max(...e.map((e=>{var t;return null!=(t=fu[e.type])?t:1}))))(e),o=a.getInitialReferenceValue({referenceDate:f,value:S,utils:i,props:h,granularity:r,timezone:w});return(0,n.A)({},t,{referenceValue:o})})),[k,I]=wl({controlled:_,default:null,name:"useField",state:"selectedSectionIndexes"}),D=e=>{I(e),null==v||v(e),P((e=>(0,n.A)({},e,{selectedSectionQuery:null})))},L=e.useMemo((()=>{if(null==k)return null;if("all"===k)return{startIndex:0,endIndex:E.sections.length-1,shouldSelectBoundarySelectors:!0};if("number"===typeof k)return{startIndex:k,endIndex:k};if("string"===typeof k){const e=E.sections.findIndex((e=>e.type===k));return{startIndex:e,endIndex:e}}return k}),[k,E.sections]),R=e=>{let{value:t,referenceValue:r,sections:s}=e;if(P((e=>(0,n.A)({},e,{sections:s,value:t,referenceValue:r,tempValueStrAndroid:null}))),a.areValuesEqual(i,E.value,t))return;const l={validationError:u({adapter:o,value:t,props:(0,n.A)({},h,{value:t,timezone:w})})};T(t,l)},z=(e,t)=>{const i=[...E.sections];return i[e]=(0,n.A)({},i[e],{value:t,modified:!0}),Mu(i,s)};return e.useEffect((()=>{const e=A(E.value);Iu(),P((t=>(0,n.A)({},t,{sections:e})))}),[g,i.locale]),e.useEffect((()=>{let e=!1;e=!a.areValuesEqual(i,E.value,S)||a.getTimezone(i,E.value)!==a.getTimezone(i,S),e&&P((e=>(0,n.A)({},e,{value:S,referenceValue:l.updateReferenceValue(i,S,e.referenceValue),sections:A(S)})))}),[S]),{state:E,selectedSectionIndexes:L,setSelectedSections:D,clearValue:()=>{R({value:a.emptyValue,referenceValue:E.referenceValue,sections:A(a.emptyValue)})},clearActiveSection:()=>{if(null==L)return;const e=E.sections[L.startIndex],t=l.getActiveDateManager(i,E,e),r=t.getSections(E.sections).filter((e=>""!==e.value)).length===(""===e.value?0:1),o=z(L.startIndex,""),s=r?null:i.date(new Date("")),a=t.getNewValuesFromNewActiveDate(s);(null!=s&&!i.isValid(s))!==(null!=t.date&&!i.isValid(t.date))?R((0,n.A)({},a,{sections:o})):P((e=>(0,n.A)({},e,a,{sections:o,tempValueStrAndroid:null})))},updateSectionValue:e=>{let{activeSection:t,newSectionValue:r,shouldGoToNextSection:o}=e;o&&L&&L.startIndex<E.sections.length-1?D(L.startIndex+1):L&&L.startIndex!==L.endIndex&&D(L.startIndex);const s=l.getActiveDateManager(i,E,t),a=z(L.startIndex,r),c=s.getSections(a),u=((e,t)=>{const i=t.some((e=>"day"===e.type)),r=[],n=[];for(let a=0;a<t.length;a+=1){const e=t[a];i&&"weekDay"===e.type||(r.push(e.format),n.push(Su(e,"non-input")))}const o=r.join(" "),s=n.join(" ");return e.parse(s,o)})(i,c);let h,d;if(null!=u&&i.isValid(u)){const e=Lu(i,w,u,c,s.referenceDate,!0);h=s.getNewValuesFromNewActiveDate(e),d=!0}else h=s.getNewValuesFromNewActiveDate(u),d=(null!=u&&!i.isValid(u))!==(null!=s.date&&!i.isValid(s.date));return d?R((0,n.A)({},h,{sections:a})):P((e=>(0,n.A)({},e,h,{sections:a,tempValueStrAndroid:null})))},updateValueFromValueStr:e=>{const t=l.parseValueStr(e,E.referenceValue,((e,t)=>{const n=i.parse(e,g);if(null==n||!i.isValid(n))return null;const o=ku(i,w,r,g,n,y,x,s);return Lu(i,w,n,o,t,!1)})),n=l.updateReferenceValue(i,t,E.referenceValue);R({value:t,referenceValue:n,sections:A(t,E.sections)})},setTempAndroidValueStr:e=>P((t=>(0,n.A)({},t,{tempValueStrAndroid:e}))),sectionsValueBoundaries:M,placeholder:C,timezone:w}},yf=e=>null!=e.saveQuery,_f=t=>{let{sections:i,updateSectionValue:r,sectionsValueBoundaries:o,setTempAndroidValueStr:s,timezone:a}=t;const l=Vu(),[c,u]=e.useState(null),h=Yn((()=>u(null)));e.useEffect((()=>{var e;null!=c&&(null==(e=i[c.sectionIndex])?void 0:e.type)!==c.sectionType&&h()}),[i,c,h]),e.useEffect((()=>{if(null!=c){const e=setTimeout((()=>h()),5e3);return()=>{window.clearTimeout(e)}}return()=>{}}),[c,h]);const d=(e,t,r)=>{let{keyPressed:n,sectionIndex:o}=e;const s=n.toLowerCase(),a=i[o];if(null!=c&&(!r||r(c.value))&&c.sectionIndex===o){const e=`${c.value}${s}`,i=t(e,a);if(!yf(i))return u({sectionIndex:o,value:e,sectionType:a.type}),i}const l=t(s,a);return yf(l)&&!l.saveQuery?(h(),null):(u({sectionIndex:o,value:s,sectionType:a.type}),yf(l)?null:l)};return{applyCharacterEditing:Yn((e=>{const t=i[e.sectionIndex],c=" "!==e.keyPressed&&!Number.isNaN(Number(e.keyPressed))?(e=>{const t=(e,t)=>{const i=Number(`${e}`),r=o[t.type]({currentDate:null,format:t.format,contentType:t.contentType});if(i>r.maximum)return{saveQuery:!1};if(i<r.minimum)return{saveQuery:!0};const n=Number(`${e}0`)>r.maximum||e.length===r.maximum.toString().length;return{sectionValue:bu(l,0,i,r,t),shouldGoToNextSection:n}};return d(e,((e,i)=>{if("digit"===i.contentType||"digit-with-letter"===i.contentType)return t(e,i);if("month"===i.type){const r=Pu(l,a,"digit","month","MM"),o=t(e,{type:i.type,format:"MM",hasLeadingZerosInFormat:r,hasLeadingZerosInInput:!0,contentType:"digit",maxLength:2});if(yf(o))return o;const s=Cu(l,o.sectionValue,"MM",i.format);return(0,n.A)({},o,{sectionValue:s})}if("weekDay"===i.type){const r=t(e,i);if(yf(r))return r;const o=_u(l,a,i.format)[Number(r.sectionValue)-1];return(0,n.A)({},r,{sectionValue:o})}return{saveQuery:!1}}),(e=>!Number.isNaN(Number(e))))})(e):(e=>{const t=(e,t,i)=>{const r=t.filter((e=>e.toLowerCase().startsWith(i)));return 0===r.length?{saveQuery:!1}:{sectionValue:r[0],shouldGoToNextSection:1===r.length}},i=(e,i,r,o)=>{const s=e=>vu(l,a,i.type,e);if("letter"===i.contentType)return t(i.format,s(i.format),e);if(r&&null!=o&&"letter"===yu(l,r).contentType){const i=s(r),a=t(0,i,e);return yf(a)?{saveQuery:!1}:(0,n.A)({},a,{sectionValue:o(a.sectionValue,i)})}return{saveQuery:!1}};return d(e,((e,t)=>{switch(t.type){case"month":{const r=e=>Cu(l,e,l.formats.month,t.format);return i(e,t,l.formats.month,r)}case"weekDay":{const r=(e,t)=>t.indexOf(e).toString();return i(e,t,l.formats.weekday,r)}case"meridiem":return i(e,t);default:return{saveQuery:!1}}}))})(e);null==c?s(null):r({activeSection:t,newSectionValue:c.sectionValue,shouldGoToNextSection:c.shouldGoToNextSection})})),resetCharacterQuery:h}},vf=["onClick","onKeyDown","onFocus","onBlur","onMouseUp","onPaste","error","clearable","onClear","disabled"],xf=t=>{const i=Vu(),{state:r,selectedSectionIndexes:s,setSelectedSections:a,clearValue:l,clearActiveSection:c,updateSectionValue:u,updateValueFromValueStr:h,setTempAndroidValueStr:d,sectionsValueBoundaries:p,placeholder:f,timezone:m}=gf(t),{inputRef:g,internalProps:y,internalProps:{readOnly:_=!1,unstableFieldRef:v,minutesStep:x},forwardedProps:{onClick:b,onKeyDown:w,onFocus:S,onBlur:T,onMouseUp:M,onPaste:A,error:C,clearable:E,onClear:P,disabled:k},fieldValueManager:I,valueManager:D,validator:L}=t,R=(0,o.A)(t.forwardedProps,vf),{applyCharacterEditing:z,resetCharacterQuery:O}=_f({sections:r.sections,updateSectionValue:u,sectionsValueBoundaries:p,setTempAndroidValueStr:d,timezone:m}),F=e.useRef(null),B=Wn(g,F),N=e.useRef(void 0),j="rtl"===ca().direction,V=e.useMemo((()=>((e,t)=>{const i={};if(!t)return e.forEach(((t,r)=>{const n=0===r?null:r-1,o=r===e.length-1?null:r+1;i[r]={leftIndex:n,rightIndex:o}})),{neighbors:i,startIndex:0,endIndex:e.length-1};const r={},n={};let o=0,s=0,a=e.length-1;for(;a>=0;){s=e.findIndex(((e,t)=>{var i;return t>=o&&(null==(i=e.endSeparator)?void 0:i.includes(" "))&&" / "!==e.endSeparator})),-1===s&&(s=e.length-1);for(let e=s;e>=o;e-=1)n[e]=a,r[a]=e,a-=1;o=s+1}return e.forEach(((t,o)=>{const s=n[o],a=0===s?null:r[s-1],l=s===e.length-1?null:r[s+1];i[o]={leftIndex:a,rightIndex:l}})),{neighbors:i,startIndex:r[0],endIndex:r[e.length-1]}})(r.sections,j)),[r.sections,j]),U=()=>{var e;if(_)return void a(null);const t=null!=(e=F.current.selectionStart)?e:0;let i;i=t<=r.sections[0].startInInput||t>=r.sections[r.sections.length-1].endInInput?1:r.sections.findIndex((e=>e.startInInput-e.startSeparator.length>t));const n=-1===i?r.sections.length-1:i-1;a(n)},G=Yn((function(e){if(!e.isDefaultPrevented()){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];null==b||b(e,...i),U()}})),H=Yn((e=>{null==M||M(e),e.preventDefault()})),W=Yn((function(){null==S||S(...arguments);const e=F.current;window.clearTimeout(N.current),N.current=setTimeout((()=>{e&&e===F.current&&(null!=s||_||(e.value.length&&Number(e.selectionEnd)-Number(e.selectionStart)===e.value.length?a("all"):U()))}))})),$=Yn((function(){null==T||T(...arguments),a(null)})),q=Yn((e=>{if(null==A||A(e),_)return void e.preventDefault();const t=e.clipboardData.getData("text");if(s&&s.startIndex===s.endIndex){const i=r.sections[s.startIndex],n=/^[a-zA-Z]+$/.test(t),o=/^[0-9]+$/.test(t),a=/^(([a-zA-Z]+)|)([0-9]+)(([a-zA-Z]+)|)$/.test(t);if("letter"===i.contentType&&n||"digit"===i.contentType&&o||"digit-with-letter"===i.contentType&&a)return O(),u({activeSection:i,newSectionValue:t,shouldGoToNextSection:!0}),void e.preventDefault();if(n||o)return void e.preventDefault()}e.preventDefault(),O(),h(t)})),X=Yn((e=>{if(_)return;const t=e.target.value;if(""===t)return O(),void l();const i=e.nativeEvent.data,n=i&&i.length>1,o=n?i:t,a=Tu(o);if(null==s||n)return void h(n?i:a);let u;if(0===s.startIndex&&s.endIndex===r.sections.length-1&&1===a.length)u=a;else{const e=Tu(I.getValueStrFromSections(r.sections,j));let t=-1,i=-1;for(let r=0;r<e.length;r+=1)-1===t&&e[r]!==a[r]&&(t=r),-1===i&&e[e.length-r-1]!==a[a.length-r-1]&&(i=r);const n=r.sections[s.startIndex];if(t<n.start||e.length-i-1>n.end)return;const o=a.length-e.length+n.end-Tu(n.endSeparator||"").length;u=a.slice(n.start+Tu(n.startSeparator||"").length,o)}0!==u.length?z({keyPressed:u,sectionIndex:s.startIndex}):navigator.userAgent.toLowerCase().indexOf("android")>-1?d(o):(O(),c())})),Y=Yn((e=>{switch(null==w||w(e),!0){case"a"===e.key&&(e.ctrlKey||e.metaKey):e.preventDefault(),a("all");break;case"ArrowRight"===e.key:if(e.preventDefault(),null==s)a(V.startIndex);else if(s.startIndex!==s.endIndex)a(s.endIndex);else{const e=V.neighbors[s.startIndex].rightIndex;null!==e&&a(e)}break;case"ArrowLeft"===e.key:if(e.preventDefault(),null==s)a(V.endIndex);else if(s.startIndex!==s.endIndex)a(s.startIndex);else{const e=V.neighbors[s.startIndex].leftIndex;null!==e&&a(e)}break;case"Delete"===e.key:if(e.preventDefault(),_)break;null==s||0===s.startIndex&&s.endIndex===r.sections.length-1?l():c(),O();break;case["ArrowUp","ArrowDown","Home","End","PageUp","PageDown"].includes(e.key):{if(e.preventDefault(),_||null==s)break;const t=r.sections[s.startIndex],n=I.getActiveDateManager(i,r,t),o=wu(i,m,t,e.key,p,n.date,{minutesStep:x});u({activeSection:t,newSectionValue:o,shouldGoToNextSection:!1});break}}}));Xn((()=>{if(!F.current)return;if(null==s)return void(F.current.scrollLeft&&(F.current.scrollLeft=0));const e=r.sections[s.startIndex],t=r.sections[s.endIndex];let i=e.startInInput,n=t.endInInput;if(s.shouldSelectBoundarySelectors&&(i-=e.startSeparator.length,n+=t.endSeparator.length),i!==F.current.selectionStart||n!==F.current.selectionEnd){const e=F.current.scrollTop;F.current===$d(document)&&F.current.setSelectionRange(i,n),F.current.scrollTop=e}}));const Z=np((0,n.A)({},y,{value:r.value,timezone:m}),L,D.isSameError,D.defaultErrorState),K=e.useMemo((()=>void 0!==C?C:D.hasError(Z)),[D,Z,C]);e.useEffect((()=>{K||s||O()}),[r.referenceValue,s,K]),e.useEffect((()=>(F.current&&F.current===document.activeElement&&a("all"),()=>window.clearTimeout(N.current))),[]),e.useEffect((()=>{null!=r.tempValueStrAndroid&&null!=s&&(O(),c())}),[r.tempValueStrAndroid]);const J=e.useMemo((()=>{var e;return null!=(e=r.tempValueStrAndroid)?e:I.getValueStrFromSections(r.sections,j)}),[r.sections,I,r.tempValueStrAndroid,j]),Q=e.useMemo((()=>null==s||"letter"===r.sections[s.startIndex].contentType?"text":"numeric"),[s,r.sections]),ee=F.current&&F.current===$d(document),te=D.areValuesEqual(i,r.value,D.emptyValue),ie=!ee&&te;e.useImperativeHandle(v,(()=>({getSections:()=>r.sections,getActiveSectionIndex:()=>{var e,t,i;const n=null!=(e=F.current.selectionStart)?e:0,o=null!=(t=F.current.selectionEnd)?t:0,s=!(null==(i=F.current)||!i.readOnly);if(0===n&&0===o||s)return null;const a=n<=r.sections[0].startInInput?1:r.sections.findIndex((e=>e.startInInput-e.startSeparator.length>n));return-1===a?r.sections.length-1:a-1},setSelectedSections:e=>a(e)})));const re=Yn((function(e){var t;e.preventDefault();for(var i=arguments.length,r=new Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];null==P||P(e,...r),l(),null==F||null==(t=F.current)||t.focus(),a(0)}));return(0,n.A)({placeholder:f,autoComplete:"off",disabled:Boolean(k)},R,{value:ie?"":J,inputMode:Q,readOnly:_,onClick:G,onFocus:W,onBlur:$,onPaste:q,onChange:X,onKeyDown:Y,onMouseUp:H,onClear:re,error:K,ref:B,clearable:Boolean(E&&!te&&!_&&!k)})},bf=["disablePast","disableFuture","minDate","maxDate","shouldDisableDate","shouldDisableMonth","shouldDisableYear"],wf=["disablePast","disableFuture","minTime","maxTime","shouldDisableClock","shouldDisableTime","minutesStep","ampm","disableIgnoringDatePartForTimeValidation"],Sf=["minDateTime","maxDateTime"],Tf=[...bf,...wf,...Sf],Mf=e=>Tf.reduce(((t,i)=>(e.hasOwnProperty(i)&&(t[i]=e[i]),t)),{}),Af=["value","defaultValue","referenceDate","format","formatDensity","onChange","timezone","readOnly","onError","shouldRespectLeadingZeros","selectedSections","onSelectedSectionsChange","unstableFieldRef"],Cf=e=>{let{props:t,inputRef:i}=e;const r=(e=>{var t,i,r;const o=Vu(),s=Uu();return(0,n.A)({},e,{disablePast:null!=(t=e.disablePast)&&t,disableFuture:null!=(i=e.disableFuture)&&i,format:null!=(r=e.format)?r:o.formats.keyboardDate,minDate:ou(o,e.minDate,s.minDate),maxDate:ou(o,e.maxDate,s.maxDate)})})(t),{forwardedProps:o,internalProps:s}=((e,t)=>{const i=(0,n.A)({},e),r={},o=e=>{i.hasOwnProperty(e)&&(r[e]=i[e],delete i[e])};return Af.forEach(o),"date"===t?bf.forEach(o):"time"===t?wf.forEach(o):"date-time"===t&&(bf.forEach(o),wf.forEach(o),Sf.forEach(o)),{forwardedProps:i,internalProps:r}})(r,"date");return xf({inputRef:i,forwardedProps:o,internalProps:s,valueManager:zu,fieldValueManager:Ou,validator:ch,valueType:"date"})},Ef=["ownerState"],Pf=["components","componentsProps","slots","slotProps","InputProps","inputProps"],kf=["inputRef"],If=["ref","onPaste","onKeyDown","inputMode","readOnly","clearable","onClear"],Df=e.forwardRef((function(t,i){var r,s,a;const l=X({props:t,name:"MuiDateField"}),{components:c,componentsProps:u,slots:h,slotProps:d,InputProps:p,inputProps:f}=l,m=(0,o.A)(l,Pf),g=l,y=null!=(r=null!=(s=null==h?void 0:h.textField)?s:null==c?void 0:c.TextField)?r:Ql,_=dh({elementType:y,externalSlotProps:null!=(a=null==d?void 0:d.textField)?a:null==u?void 0:u.textField,externalForwardedProps:m,ownerState:g}),{inputRef:v}=_,x=(0,o.A)(_,kf);x.inputProps=(0,n.A)({},f,x.inputProps),x.InputProps=(0,n.A)({},p,x.InputProps);const b=Cf({props:x,inputRef:v}),{ref:w,onPaste:S,onKeyDown:T,inputMode:M,readOnly:A,clearable:C,onClear:E}=b,P=(0,o.A)(b,If),{InputProps:k,fieldProps:I}=(t=>{let{clearable:i,fieldProps:r,InputProps:s,onClear:a,slots:l,slotProps:c,components:u,componentsProps:h}=t;var d,p,f,m,g,y;const _=Gu(),v=null!=(d=null!=(p=null==l?void 0:l.clearButton)?p:null==u?void 0:u.ClearButton)?d:Sh,x=dh({elementType:v,externalSlotProps:null!=(f=null==c?void 0:c.clearButton)?f:null==h?void 0:h.clearButton,ownerState:{},className:"clearButton",additionalProps:{title:_.fieldClearLabel}}),b=(0,o.A)(x,Ef),w=null!=(m=null!=(g=null==l?void 0:l.clearIcon)?g:null==u?void 0:u.ClearIcon)?m:mf,S=dh({elementType:w,externalSlotProps:null!=(y=null==c?void 0:c.clearIcon)?y:null==h?void 0:h.clearIcon,ownerState:{}});return{InputProps:(0,n.A)({},s,{endAdornment:(0,Y.jsxs)(e.Fragment,{children:[i&&(0,Y.jsx)(_h,{position:"end",sx:{marginRight:null!=s&&s.endAdornment?-1:-1.5},children:(0,Y.jsx)(v,(0,n.A)({},b,{onClick:a,children:(0,Y.jsx)(w,(0,n.A)({fontSize:"small"},S))}))}),null==s?void 0:s.endAdornment]})}),fieldProps:(0,n.A)({},r,{sx:[{"& .clearButton":{opacity:1},"@media (pointer: fine)":{"& .clearButton":{opacity:0},"&:hover, &:focus-within":{".clearButton":{opacity:1}}}},...Array.isArray(r.sx)?r.sx:[r.sx]]})}})({onClear:E,clearable:C,fieldProps:P,InputProps:P.InputProps,slots:h,slotProps:d,components:c,componentsProps:u});return(0,Y.jsx)(y,(0,n.A)({ref:i},I,{InputProps:(0,n.A)({},k,{readOnly:A}),inputProps:(0,n.A)({},P.inputProps,{inputMode:M,onPaste:S,onKeyDown:T,ref:w})}))})),Lf=t=>{let{shouldDisableDate:i,shouldDisableMonth:r,shouldDisableYear:n,minDate:o,maxDate:s,disableFuture:a,disablePast:l,timezone:c}=t;const u=ju();return e.useCallback((e=>null!==ch({adapter:u,value:e,props:{shouldDisableDate:i,shouldDisableMonth:r,shouldDisableYear:n,minDate:o,maxDate:s,disableFuture:a,disablePast:l,timezone:c}})),[u,i,r,n,o,s,a,l,c])},Rf=t=>{const{value:i,referenceDate:r,defaultCalendarMonth:o,disableFuture:s,disablePast:a,disableSwitchToMonthOnDayFocus:l=!1,maxDate:c,minDate:u,onMonthChange:h,reduceAnimations:d,shouldDisableDate:p,timezone:f}=t,m=Vu(),g=e.useRef(((e,t,i)=>(r,o)=>{switch(o.type){case"changeMonth":return(0,n.A)({},r,{slideDirection:o.direction,currentMonth:o.newMonth,isMonthSwitchingAnimating:!e});case"finishMonthSwitchingAnimation":return(0,n.A)({},r,{isMonthSwitchingAnimating:!1});case"changeFocusedDay":{if(null!=r.focusedDay&&null!=o.focusedDay&&i.isSameDay(o.focusedDay,r.focusedDay))return r;const s=null!=o.focusedDay&&!t&&!i.isSameMonth(r.currentMonth,o.focusedDay);return(0,n.A)({},r,{focusedDay:o.focusedDay,isMonthSwitchingAnimating:s&&!e&&!o.withoutMonthSwitchingAnimation,currentMonth:s?i.startOfMonth(o.focusedDay):r.currentMonth,slideDirection:null!=o.focusedDay&&i.isAfterDay(o.focusedDay,r.currentMonth)?"left":"right"})}default:throw new Error("missing support")}})(Boolean(d),l,m)).current,y=e.useMemo((()=>{let e=null;return r?e=r:o&&(e=m.startOfMonth(o)),zu.getInitialReferenceValue({value:i,utils:m,timezone:f,props:t,referenceDate:e,granularity:fu.day})}),[]),[_,v]=e.useReducer(g,{isMonthSwitchingAnimating:!1,focusedDay:y,currentMonth:m.startOfMonth(y),slideDirection:"left"}),x=e.useCallback((e=>{v((0,n.A)({type:"changeMonth"},e)),h&&h(e.newMonth)}),[h]),b=e.useCallback((e=>{const t=e;m.isSameMonth(t,_.currentMonth)||x({newMonth:m.startOfMonth(t),direction:m.isAfterDay(t,_.currentMonth)?"left":"right"})}),[_.currentMonth,x,m]),w=Lf({shouldDisableDate:p,minDate:u,maxDate:c,disableFuture:s,disablePast:a,timezone:f}),S=e.useCallback((()=>{v({type:"finishMonthSwitchingAnimation"})}),[]),T=Yn(((e,t)=>{w(e)||v({type:"changeFocusedDay",focusedDay:e,withoutMonthSwitchingAnimation:t})}));return{referenceDate:y,calendarState:_,changeMonth:b,changeFocusedDay:T,isDateDisabled:w,onMonthSwitchingAnimationEnd:S,handleChangeMonth:x}},zf=e=>yo("MuiPickersFadeTransitionGroup",e),Of=(_o("MuiPickersFadeTransitionGroup",["root"]),Nn(mc,{name:"MuiPickersFadeTransitionGroup",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"block",position:"relative"}));function Ff(e){const t=X({props:e,name:"MuiPickersFadeTransitionGroup"}),{children:i,className:r,reduceAnimations:n,transKey:o}=t,s=(e=>{const{classes:t}=e;return Dn({root:["root"]},zf,t)})(t),a=ca();return n?i:(0,Y.jsx)(Of,{className:In(s.root,r),children:(0,Y.jsx)(Ma,{appear:!1,mountOnEnter:!0,unmountOnExit:!0,timeout:{appear:a.transitions.duration.enteringScreen,enter:a.transitions.duration.enteringScreen,exit:0},children:i},o)})}var Bf=i(1188);function Nf(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(0,Bf.A)(e,t,i)}function jf(e){if(e.type)return e;if("#"===e.charAt(0))return jf(function(e){e=e.slice(1);const t=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let i=e.match(t);return i&&1===i[0].length&&(i=i.map((e=>e+e))),i?`rgb${4===i.length?"a":""}(${i.map(((e,t)=>t<3?parseInt(e,16):Math.round(parseInt(e,16)/255*1e3)/1e3)).join(", ")})`:""}(e));const t=e.indexOf("("),i=e.substring(0,t);if(-1===["rgb","rgba","hsl","hsla","color"].indexOf(i))throw new Error((0,p.A)(9,e));let r,n=e.substring(t+1,e.length-1);if("color"===i){if(n=n.split(" "),r=n.shift(),4===n.length&&"/"===n[3].charAt(0)&&(n[3]=n[3].slice(1)),-1===["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(r))throw new Error((0,p.A)(10,r))}else n=n.split(",");return n=n.map((e=>parseFloat(e))),{type:i,values:n,colorSpace:r}}function Vf(e){const{type:t,colorSpace:i}=e;let{values:r}=e;return-1!==t.indexOf("rgb")?r=r.map(((e,t)=>t<3?parseInt(e,10):e)):-1!==t.indexOf("hsl")&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),r=-1!==t.indexOf("color")?`${i} ${r.join(" ")}`:`${r.join(", ")}`,`${t}(${r})`}function Uf(e,t){return e=jf(e),t=Nf(t),"rgb"!==e.type&&"hsl"!==e.type||(e.type+="a"),"color"===e.type?e.values[3]=`/${t}`:e.values[3]=t,Vf(e)}function Gf(e){return yo("MuiPickersDay",e)}const Hf=_o("MuiPickersDay",["root","dayWithMargin","dayOutsideMonth","hiddenDaySpacingFiller","today","selected","disabled"]),Wf=["autoFocus","className","day","disabled","disableHighlightToday","disableMargin","hidden","isAnimating","onClick","onDaySelect","onFocus","onBlur","onKeyDown","onMouseDown","onMouseEnter","outsideCurrentMonth","selected","showDaysOutsideCurrentMonth","children","today","isFirstVisibleCell","isLastVisibleCell"],$f=e=>{let{theme:t,ownerState:i}=e;return(0,n.A)({},t.typography.caption,{width:36,height:36,borderRadius:"50%",padding:0,backgroundColor:"transparent",transition:t.transitions.create("background-color",{duration:t.transitions.duration.short}),color:(t.vars||t).palette.text.primary,"@media (pointer: fine)":{"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.hoverOpacity})`:Uf(t.palette.primary.main,t.palette.action.hoverOpacity)}},"&:focus":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.focusOpacity})`:Uf(t.palette.primary.main,t.palette.action.focusOpacity),[`&.${Hf.selected}`]:{willChange:"background-color",backgroundColor:(t.vars||t).palette.primary.dark}},[`&.${Hf.selected}`]:{color:(t.vars||t).palette.primary.contrastText,backgroundColor:(t.vars||t).palette.primary.main,fontWeight:t.typography.fontWeightMedium,"&:hover":{willChange:"background-color",backgroundColor:(t.vars||t).palette.primary.dark}},[`&.${Hf.disabled}:not(.${Hf.selected})`]:{color:(t.vars||t).palette.text.disabled},[`&.${Hf.disabled}&.${Hf.selected}`]:{opacity:.6}},!i.disableMargin&&{margin:"0 2px"},i.outsideCurrentMonth&&i.showDaysOutsideCurrentMonth&&{color:(t.vars||t).palette.text.secondary},!i.disableHighlightToday&&i.today&&{[`&:not(.${Hf.selected})`]:{border:`1px solid ${(t.vars||t).palette.text.secondary}`}})},qf=(e,t)=>{const{ownerState:i}=e;return[t.root,!i.disableMargin&&t.dayWithMargin,!i.disableHighlightToday&&i.today&&t.today,!i.outsideCurrentMonth&&i.showDaysOutsideCurrentMonth&&t.dayOutsideMonth,i.outsideCurrentMonth&&!i.showDaysOutsideCurrentMonth&&t.hiddenDaySpacingFiller]},Xf=Nn(zc,{name:"MuiPickersDay",slot:"Root",overridesResolver:qf})($f),Yf=Nn("div",{name:"MuiPickersDay",slot:"Root",overridesResolver:qf})((e=>{let{theme:t,ownerState:i}=e;return(0,n.A)({},$f({theme:t,ownerState:i}),{opacity:0,pointerEvents:"none"})})),Zf=()=>{},Kf=e.forwardRef((function(t,i){const r=X({props:t,name:"MuiPickersDay"}),{autoFocus:s=!1,className:a,day:l,disabled:c=!1,disableHighlightToday:u=!1,disableMargin:h=!1,isAnimating:d,onClick:p,onDaySelect:f,onFocus:m=Zf,onBlur:g=Zf,onKeyDown:y=Zf,onMouseDown:_=Zf,onMouseEnter:v=Zf,outsideCurrentMonth:x,selected:b=!1,showDaysOutsideCurrentMonth:w=!1,children:S,today:T=!1}=r,M=(0,o.A)(r,Wf),A=(0,n.A)({},r,{autoFocus:s,disabled:c,disableHighlightToday:u,disableMargin:h,selected:b,showDaysOutsideCurrentMonth:w,today:T}),C=(e=>{const{selected:t,disableMargin:i,disableHighlightToday:r,today:n,disabled:o,outsideCurrentMonth:s,showDaysOutsideCurrentMonth:a,classes:l}=e,c=s&&!a;return Dn({root:["root",t&&!c&&"selected",o&&"disabled",!i&&"dayWithMargin",!r&&n&&"today",s&&a&&"dayOutsideMonth",c&&"hiddenDaySpacingFiller"],hiddenDaySpacingFiller:["hiddenDaySpacingFiller"]},Gf,l)})(A),E=Vu(),P=e.useRef(null),k=Wn(P,i);Xn((()=>{!s||c||d||x||P.current.focus()}),[s,c,d,x]);return x&&!w?(0,Y.jsx)(Yf,{className:In(C.root,C.hiddenDaySpacingFiller,a),ownerState:A,role:M.role}):(0,Y.jsx)(Xf,(0,n.A)({className:In(C.root,a),ref:k,centerRipple:!0,disabled:c,tabIndex:b?0:-1,onKeyDown:e=>y(e,l),onFocus:e=>m(e,l),onBlur:e=>g(e,l),onMouseEnter:e=>v(e,l),onClick:e=>{c||f(l),x&&e.currentTarget.focus(),p&&p(e)},onMouseDown:e=>{_(e),x&&e.preventDefault()}},M,{ownerState:A,children:S||E.format(l,"dayOfMonth")}))})),Jf=e.memo(Kf);function Qf(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}var em=function(e,t){return e&&t&&t.split(" ").forEach((function(t){return r=t,void((i=e).classList?i.classList.remove(r):"string"===typeof i.className?i.className=Qf(i.className,r):i.setAttribute("class",Qf(i.className&&i.className.baseVal||"",r)));var i,r}))},tm=function(t){function i(){for(var e,i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))||this).appliedClasses={appear:{},enter:{},exit:{}},e.onEnter=function(t,i){var r=e.resolveArguments(t,i),n=r[0],o=r[1];e.removeClasses(n,"exit"),e.addClass(n,o?"appear":"enter","base"),e.props.onEnter&&e.props.onEnter(t,i)},e.onEntering=function(t,i){var r=e.resolveArguments(t,i),n=r[0],o=r[1]?"appear":"enter";e.addClass(n,o,"active"),e.props.onEntering&&e.props.onEntering(t,i)},e.onEntered=function(t,i){var r=e.resolveArguments(t,i),n=r[0],o=r[1]?"appear":"enter";e.removeClasses(n,o),e.addClass(n,o,"done"),e.props.onEntered&&e.props.onEntered(t,i)},e.onExit=function(t){var i=e.resolveArguments(t)[0];e.removeClasses(i,"appear"),e.removeClasses(i,"enter"),e.addClass(i,"exit","base"),e.props.onExit&&e.props.onExit(t)},e.onExiting=function(t){var i=e.resolveArguments(t)[0];e.addClass(i,"exit","active"),e.props.onExiting&&e.props.onExiting(t)},e.onExited=function(t){var i=e.resolveArguments(t)[0];e.removeClasses(i,"exit"),e.addClass(i,"exit","done"),e.props.onExited&&e.props.onExited(t)},e.resolveArguments=function(t,i){return e.props.nodeRef?[e.props.nodeRef.current,t]:[t,i]},e.getClassNames=function(t){var i=e.props.classNames,r="string"===typeof i,n=r?""+(r&&i?i+"-":"")+t:i[t];return{baseClassName:n,activeClassName:r?n+"-active":i[t+"Active"],doneClassName:r?n+"-done":i[t+"Done"]}},e}Ks(i,t);var r=i.prototype;return r.addClass=function(e,t,i){var r=this.getClassNames(t)[i+"ClassName"],n=this.getClassNames("enter").doneClassName;"appear"===t&&"done"===i&&n&&(r+=" "+n),"active"===i&&e&&ea(e),r&&(this.appliedClasses[t][i]=r,function(e,t){e&&t&&t.split(" ").forEach((function(t){return r=t,void((i=e).classList?i.classList.add(r):function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")}(i,r)||("string"===typeof i.className?i.className=i.className+" "+r:i.setAttribute("class",(i.className&&i.className.baseVal||"")+" "+r)));var i,r}))}(e,r))},r.removeClasses=function(e,t){var i=this.appliedClasses[t],r=i.base,n=i.active,o=i.done;this.appliedClasses[t]={},r&&em(e,r),n&&em(e,n),o&&em(e,o)},r.render=function(){var t=this.props,i=(t.classNames,(0,o.A)(t,["classNames"]));return e.createElement(la,(0,n.A)({},i,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},i}(e.Component);tm.defaultProps={classNames:""},tm.propTypes={};const im=tm,rm=e=>yo("MuiPickersSlideTransition",e),nm=_o("MuiPickersSlideTransition",["root","slideEnter-left","slideEnter-right","slideEnterActive","slideExit","slideExitActiveLeft-left","slideExitActiveLeft-right"]),om=["children","className","reduceAnimations","slideDirection","transKey","classes"],sm=Nn(mc,{name:"MuiPickersSlideTransition",slot:"Root",overridesResolver:(e,t)=>[t.root,{[`.${nm["slideEnter-left"]}`]:t["slideEnter-left"]},{[`.${nm["slideEnter-right"]}`]:t["slideEnter-right"]},{[`.${nm.slideEnterActive}`]:t.slideEnterActive},{[`.${nm.slideExit}`]:t.slideExit},{[`.${nm["slideExitActiveLeft-left"]}`]:t["slideExitActiveLeft-left"]},{[`.${nm["slideExitActiveLeft-right"]}`]:t["slideExitActiveLeft-right"]}]})((e=>{let{theme:t}=e;const i=t.transitions.create("transform",{duration:t.transitions.duration.complex,easing:"cubic-bezier(0.35, 0.8, 0.4, 1)"});return{display:"block",position:"relative",overflowX:"hidden","& > *":{position:"absolute",top:0,right:0,left:0},[`& .${nm["slideEnter-left"]}`]:{willChange:"transform",transform:"translate(100%)",zIndex:1},[`& .${nm["slideEnter-right"]}`]:{willChange:"transform",transform:"translate(-100%)",zIndex:1},[`& .${nm.slideEnterActive}`]:{transform:"translate(0%)",transition:i},[`& .${nm.slideExit}`]:{transform:"translate(0%)"},[`& .${nm["slideExitActiveLeft-left"]}`]:{willChange:"transform",transform:"translate(-100%)",transition:i,zIndex:0},[`& .${nm["slideExitActiveLeft-right"]}`]:{willChange:"transform",transform:"translate(100%)",transition:i,zIndex:0}}}));const am=e=>yo("MuiDayCalendar",e),lm=(_o("MuiDayCalendar",["root","header","weekDayLabel","loadingContainer","slideTransition","monthContainer","weekContainer","weekNumberLabel","weekNumber"]),["parentProps","day","focusableDay","selectedDays","isDateDisabled","currentMonthNumber","isViewFocused"]),cm=["ownerState"],um=Nn("div",{name:"MuiDayCalendar",slot:"Root",overridesResolver:(e,t)=>t.root})({}),hm=Nn("div",{name:"MuiDayCalendar",slot:"Header",overridesResolver:(e,t)=>t.header})({display:"flex",justifyContent:"center",alignItems:"center"}),dm=Nn(Ku,{name:"MuiDayCalendar",slot:"WeekDayLabel",overridesResolver:(e,t)=>t.weekDayLabel})((e=>{let{theme:t}=e;return{width:36,height:40,margin:"0 2px",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",color:(t.vars||t).palette.text.secondary}})),pm=Nn(Ku,{name:"MuiDayCalendar",slot:"WeekNumberLabel",overridesResolver:(e,t)=>t.weekNumberLabel})((e=>{let{theme:t}=e;return{width:36,height:40,margin:"0 2px",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",color:t.palette.text.disabled}})),fm=Nn(Ku,{name:"MuiDayCalendar",slot:"WeekNumber",overridesResolver:(e,t)=>t.weekNumber})((e=>{let{theme:t}=e;return(0,n.A)({},t.typography.caption,{width:36,height:36,padding:0,margin:"0 2px",color:t.palette.text.disabled,fontSize:"0.75rem",alignItems:"center",justifyContent:"center",display:"inline-flex"})})),mm=Nn("div",{name:"MuiDayCalendar",slot:"LoadingContainer",overridesResolver:(e,t)=>t.loadingContainer})({display:"flex",justifyContent:"center",alignItems:"center",minHeight:240}),gm=Nn((function(t){const i=X({props:t,name:"MuiPickersSlideTransition"}),{children:r,className:s,reduceAnimations:a,transKey:l}=i,c=(0,o.A)(i,om),u=(e=>{const{classes:t,slideDirection:i}=e;return Dn({root:["root"],exit:["slideExit"],enterActive:["slideEnterActive"],enter:[`slideEnter-${i}`],exitActive:[`slideExitActiveLeft-${i}`]},rm,t)})(i),h=ca();if(a)return(0,Y.jsx)("div",{className:In(u.root,s),children:r});const d={exit:u.exit,enterActive:u.enterActive,enter:u.enter,exitActive:u.exitActive};return(0,Y.jsx)(sm,{className:In(u.root,s),childFactory:t=>e.cloneElement(t,{classNames:d}),role:"presentation",children:(0,Y.jsx)(im,(0,n.A)({mountOnEnter:!0,unmountOnExit:!0,timeout:h.transitions.duration.complex,classNames:d},c,{children:r}),l)})}),{name:"MuiDayCalendar",slot:"SlideTransition",overridesResolver:(e,t)=>t.slideTransition})({minHeight:240}),ym=Nn("div",{name:"MuiDayCalendar",slot:"MonthContainer",overridesResolver:(e,t)=>t.monthContainer})({overflow:"hidden"}),_m=Nn("div",{name:"MuiDayCalendar",slot:"WeekContainer",overridesResolver:(e,t)=>t.weekContainer})({margin:"2px 0",display:"flex",justifyContent:"center"});function vm(t){var i,r,s;let{parentProps:a,day:l,focusableDay:c,selectedDays:u,isDateDisabled:h,currentMonthNumber:d,isViewFocused:p}=t,f=(0,o.A)(t,lm);const{disabled:m,disableHighlightToday:g,isMonthSwitchingAnimating:y,showDaysOutsideCurrentMonth:_,components:v,componentsProps:x,slots:b,slotProps:w,timezone:S}=a,T=Vu(),M=Hu(S),A=null!==c&&T.isSameDay(l,c),C=u.some((e=>T.isSameDay(e,l))),E=T.isSameDay(l,M),P=null!=(i=null!=(r=null==b?void 0:b.day)?r:null==v?void 0:v.Day)?i:Jf,k=dh({elementType:P,externalSlotProps:null!=(s=null==w?void 0:w.day)?s:null==x?void 0:x.day,additionalProps:(0,n.A)({disableHighlightToday:g,showDaysOutsideCurrentMonth:_,role:"gridcell",isAnimating:y,"data-timestamp":T.toJsDate(l).valueOf()},f),ownerState:(0,n.A)({},a,{day:l,selected:C})}),I=(0,o.A)(k,cm),D=e.useMemo((()=>m||h(l)),[m,h,l]),L=e.useMemo((()=>T.getMonth(l)!==d),[T,l,d]),R=e.useMemo((()=>{const e=T.startOfMonth(T.setMonth(l,d));return _?T.isSameDay(l,T.startOfWeek(e)):T.isSameDay(l,e)}),[d,l,_,T]),z=e.useMemo((()=>{const e=T.endOfMonth(T.setMonth(l,d));return _?T.isSameDay(l,T.endOfWeek(e)):T.isSameDay(l,e)}),[d,l,_,T]);return(0,Y.jsx)(P,(0,n.A)({},I,{day:l,disabled:D,autoFocus:p&&A,today:E,outsideCurrentMonth:L,isFirstVisibleCell:R,isLastVisibleCell:z,selected:C,tabIndex:A?0:-1,"aria-selected":C,"aria-current":E?"date":void 0}))}function xm(t){const i=X({props:t,name:"MuiDayCalendar"}),{onFocusedDayChange:r,className:o,currentMonth:s,selectedDays:a,focusedDay:l,loading:c,onSelectedDaysChange:u,onMonthSwitchingAnimationEnd:h,readOnly:d,reduceAnimations:p,renderLoading:f=()=>(0,Y.jsx)("span",{children:"..."}),slideDirection:m,TransitionProps:g,disablePast:y,disableFuture:_,minDate:v,maxDate:x,shouldDisableDate:b,shouldDisableMonth:w,shouldDisableYear:S,dayOfWeekFormatter:T,hasFocus:M,onFocusedViewChange:A,gridLabelId:C,displayWeekNumber:E,fixedWeekNumber:P,autoFocus:k,timezone:I}=i,D=Hu(I),L=Vu(),R=(e=>{const{classes:t}=e;return Dn({root:["root"],header:["header"],weekDayLabel:["weekDayLabel"],loadingContainer:["loadingContainer"],slideTransition:["slideTransition"],monthContainer:["monthContainer"],weekContainer:["weekContainer"],weekNumberLabel:["weekNumberLabel"],weekNumber:["weekNumber"]},am,t)})(i),z="rtl"===ca().direction,O=T||((e,t)=>L.format(t,"weekdayShort").charAt(0).toUpperCase()),F=Lf({shouldDisableDate:b,shouldDisableMonth:w,shouldDisableYear:S,minDate:v,maxDate:x,disablePast:y,disableFuture:_,timezone:I}),B=Gu(),[N,j]=wl({name:"DayCalendar",state:"hasFocus",controlled:M,default:null!=k&&k}),[V,U]=e.useState((()=>l||D)),G=Yn((e=>{d||u(e)})),H=e=>{F(e)||(r(e),U(e),null==A||A(!0),j(!0))},W=Yn(((e,t)=>{switch(e.key){case"ArrowUp":H(L.addDays(t,-7)),e.preventDefault();break;case"ArrowDown":H(L.addDays(t,7)),e.preventDefault();break;case"ArrowLeft":{const i=L.addDays(t,z?1:-1),r=L.addMonths(t,z?1:-1),n=nu({utils:L,date:i,minDate:z?i:L.startOfMonth(r),maxDate:z?L.endOfMonth(r):i,isDateDisabled:F,timezone:I});H(n||i),e.preventDefault();break}case"ArrowRight":{const i=L.addDays(t,z?-1:1),r=L.addMonths(t,z?-1:1),n=nu({utils:L,date:i,minDate:z?L.startOfMonth(r):i,maxDate:z?i:L.endOfMonth(r),isDateDisabled:F,timezone:I});H(n||i),e.preventDefault();break}case"Home":H(L.startOfWeek(t)),e.preventDefault();break;case"End":H(L.endOfWeek(t)),e.preventDefault();break;case"PageUp":H(L.addMonths(t,1)),e.preventDefault();break;case"PageDown":H(L.addMonths(t,-1)),e.preventDefault()}})),$=Yn(((e,t)=>H(t))),q=Yn(((e,t)=>{N&&L.isSameDay(V,t)&&(null==A||A(!1))})),Z=L.getMonth(s),K=e.useMemo((()=>a.filter((e=>!!e)).map((e=>L.startOfDay(e)))),[L,a]),J=Z,Q=e.useMemo((()=>e.createRef()),[J]),ee=L.startOfWeek(D),te=e.useMemo((()=>{const e=L.startOfMonth(s),t=L.endOfMonth(s);return F(V)||L.isAfterDay(V,t)||L.isBeforeDay(V,e)?nu({utils:L,date:V,minDate:e,maxDate:t,disablePast:y,disableFuture:_,isDateDisabled:F,timezone:I}):V}),[s,_,y,V,F,L,I]),ie=e.useMemo((()=>{const e=L.setTimezone(s,I),t=L.getWeekArray(e);let i=L.addMonths(e,1);for(;P&&t.length<P;){const e=L.getWeekArray(i),r=L.isSameDay(t[t.length-1][0],e[0][0]);e.slice(r?1:0).forEach((e=>{t.length<P&&t.push(e)})),i=L.addMonths(i,1)}return t}),[s,P,L,I]);return(0,Y.jsxs)(um,{role:"grid","aria-labelledby":C,className:R.root,children:[(0,Y.jsxs)(hm,{role:"row",className:R.header,children:[E&&(0,Y.jsx)(pm,{variant:"caption",role:"columnheader","aria-label":B.calendarWeekNumberHeaderLabel,className:R.weekNumberLabel,children:B.calendarWeekNumberHeaderText}),hu(L,D).map(((e,t)=>{var i;const r=L.format(e,"weekdayShort");return(0,Y.jsx)(dm,{variant:"caption",role:"columnheader","aria-label":L.format(L.addDays(ee,t),"weekday"),className:R.weekDayLabel,children:null!=(i=null==O?void 0:O(r,e))?i:r},r+t.toString())}))]}),c?(0,Y.jsx)(mm,{className:R.loadingContainer,children:f()}):(0,Y.jsx)(gm,(0,n.A)({transKey:J,onExited:h,reduceAnimations:p,slideDirection:m,className:In(o,R.slideTransition)},g,{nodeRef:Q,children:(0,Y.jsx)(ym,{ref:Q,role:"rowgroup",className:R.monthContainer,children:ie.map(((e,t)=>(0,Y.jsxs)(_m,{role:"row",className:R.weekContainer,"aria-rowindex":t+1,children:[E&&(0,Y.jsx)(fm,{className:R.weekNumber,role:"rowheader","aria-label":B.calendarWeekNumberAriaLabelText(L.getWeekNumber(e[0])),children:B.calendarWeekNumberText(L.getWeekNumber(e[0]))}),e.map(((e,t)=>(0,Y.jsx)(vm,{parentProps:i,day:e,selectedDays:K,focusableDay:te,onKeyDown:W,onFocus:$,onBlur:q,onDaySelect:G,isDateDisabled:F,currentMonthNumber:Z,isViewFocused:N,"aria-colindex":t+1},e.toString())))]},`week-${e[0]}`)))})}))]})}function bm(e){return yo("MuiPickersMonth",e)}const wm=_o("MuiPickersMonth",["root","monthButton","disabled","selected"]),Sm=["autoFocus","children","disabled","selected","value","tabIndex","onClick","onKeyDown","onFocus","onBlur","aria-current","aria-label","monthsPerRow"],Tm=Nn("div",{name:"MuiPickersMonth",slot:"Root",overridesResolver:(e,t)=>[t.root]})((e=>{let{ownerState:t}=e;return{flexBasis:3===t.monthsPerRow?"33.3%":"25%",display:"flex",alignItems:"center",justifyContent:"center"}})),Mm=Nn("button",{name:"MuiPickersMonth",slot:"MonthButton",overridesResolver:(e,t)=>[t.monthButton,{[`&.${wm.disabled}`]:t.disabled},{[`&.${wm.selected}`]:t.selected}]})((e=>{let{theme:t}=e;return(0,n.A)({color:"unset",backgroundColor:"transparent",border:0,outline:0},t.typography.subtitle1,{margin:"8px 0",height:36,width:72,borderRadius:18,cursor:"pointer","&:focus":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:Uf(t.palette.action.active,t.palette.action.hoverOpacity)},"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:Uf(t.palette.action.active,t.palette.action.hoverOpacity)},"&:disabled":{cursor:"auto",pointerEvents:"none"},[`&.${wm.disabled}`]:{color:(t.vars||t).palette.text.secondary},[`&.${wm.selected}`]:{color:(t.vars||t).palette.primary.contrastText,backgroundColor:(t.vars||t).palette.primary.main,"&:focus, &:hover":{backgroundColor:(t.vars||t).palette.primary.dark}}})})),Am=e.memo((function(t){const i=X({props:t,name:"MuiPickersMonth"}),{autoFocus:r,children:s,disabled:a,selected:l,value:c,tabIndex:u,onClick:h,onKeyDown:d,onFocus:p,onBlur:f,"aria-current":m,"aria-label":g}=i,y=(0,o.A)(i,Sm),_=e.useRef(null),v=(e=>{const{disabled:t,selected:i,classes:r}=e;return Dn({root:["root"],monthButton:["monthButton",t&&"disabled",i&&"selected"]},bm,r)})(i);return Xn((()=>{var e;r&&(null==(e=_.current)||e.focus())}),[r]),(0,Y.jsx)(Tm,(0,n.A)({className:v.root,ownerState:i},y,{children:(0,Y.jsx)(Mm,{ref:_,disabled:a,type:"button",role:"radio",tabIndex:a?-1:u,"aria-current":m,"aria-checked":l,"aria-label":g,onClick:e=>h(e,c),onKeyDown:e=>d(e,c),onFocus:e=>p(e,c),onBlur:e=>f(e,c),className:v.monthButton,ownerState:i,children:s})}))}));function Cm(e){return yo("MuiMonthCalendar",e)}_o("MuiMonthCalendar",["root"]);const Em=["className","value","defaultValue","referenceDate","disabled","disableFuture","disablePast","maxDate","minDate","onChange","shouldDisableMonth","readOnly","disableHighlightToday","autoFocus","onMonthFocus","hasFocus","onFocusedViewChange","monthsPerRow","timezone","gridLabelId"];const Pm=Nn("div",{name:"MuiMonthCalendar",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"flex",flexWrap:"wrap",alignContent:"stretch",padding:"0 4px",width:Qp,boxSizing:"border-box"}),km=e.forwardRef((function(t,i){const r=function(e,t){const i=Vu(),r=Uu(),o=X({props:e,name:t});return(0,n.A)({disableFuture:!1,disablePast:!1},o,{minDate:ou(i,o.minDate,r.minDate),maxDate:ou(i,o.maxDate,r.maxDate)})}(t,"MuiMonthCalendar"),{className:s,value:a,defaultValue:l,referenceDate:c,disabled:u,disableFuture:h,disablePast:p,maxDate:f,minDate:m,onChange:g,shouldDisableMonth:y,readOnly:_,disableHighlightToday:v,autoFocus:x=!1,onMonthFocus:b,hasFocus:w,onFocusedViewChange:S,monthsPerRow:T=3,timezone:M,gridLabelId:A}=r,C=(0,o.A)(r,Em),{value:E,handleValueChange:P,timezone:k}=sp({name:"MonthCalendar",timezone:M,value:a,defaultValue:l,onChange:g,valueManager:zu}),I=Hu(k),D=d(),L=Vu(),R=e.useMemo((()=>zu.getInitialReferenceValue({value:E,utils:L,props:r,timezone:k,referenceDate:c,granularity:fu.month})),[]),z=r,O=(e=>{const{classes:t}=e;return Dn({root:["root"]},Cm,t)})(z),F=e.useMemo((()=>L.getMonth(I)),[L,I]),B=e.useMemo((()=>null!=E?L.getMonth(E):v?null:L.getMonth(R)),[E,L,v,R]),[N,j]=e.useState((()=>B||F)),[V,U]=wl({name:"MonthCalendar",state:"hasFocus",controlled:w,default:null!=x&&x}),G=Yn((e=>{U(e),S&&S(e)})),H=e.useCallback((e=>{const t=L.startOfMonth(p&&L.isAfter(I,m)?I:m),i=L.startOfMonth(h&&L.isBefore(I,f)?I:f),r=L.startOfMonth(e);return!!L.isBefore(r,t)||(!!L.isAfter(r,i)||!!y&&y(r))}),[h,p,f,m,I,y,L]),W=Yn(((e,t)=>{if(_)return;const i=L.setMonth(null!=E?E:R,t);P(i)})),$=Yn((e=>{H(L.setMonth(null!=E?E:R,e))||(j(e),G(!0),b&&b(e))}));e.useEffect((()=>{j((e=>null!==B&&e!==B?B:e))}),[B]);const q=Yn(((e,t)=>{const i=12;switch(e.key){case"ArrowUp":$((i+t-3)%i),e.preventDefault();break;case"ArrowDown":$((i+t+3)%i),e.preventDefault();break;case"ArrowLeft":$((i+t+("ltr"===D.direction?-1:1))%i),e.preventDefault();break;case"ArrowRight":$((i+t+("ltr"===D.direction?1:-1))%i),e.preventDefault()}})),Z=Yn(((e,t)=>{$(t)})),K=Yn(((e,t)=>{N===t&&G(!1)}));return(0,Y.jsx)(Pm,(0,n.A)({ref:i,className:In(O.root,s),ownerState:z,role:"radiogroup","aria-labelledby":A},C,{children:su(L,null!=E?E:R).map((e=>{const t=L.getMonth(e),i=L.format(e,"monthShort"),r=L.format(e,"month"),n=t===B,o=u||H(e);return(0,Y.jsx)(Am,{selected:n,value:t,onClick:W,onKeyDown:q,autoFocus:V&&t===N,disabled:o,tabIndex:t===N?0:-1,onFocus:Z,onBlur:K,"aria-current":F===t?"date":void 0,"aria-label":r,monthsPerRow:T,children:i},i)}))}))}));function Im(e){return yo("MuiPickersYear",e)}const Dm=_o("MuiPickersYear",["root","yearButton","selected","disabled"]),Lm=["autoFocus","className","children","disabled","selected","value","tabIndex","onClick","onKeyDown","onFocus","onBlur","aria-current","yearsPerRow"],Rm=Nn("div",{name:"MuiPickersYear",slot:"Root",overridesResolver:(e,t)=>[t.root]})((e=>{let{ownerState:t}=e;return{flexBasis:3===t.yearsPerRow?"33.3%":"25%",display:"flex",alignItems:"center",justifyContent:"center"}})),zm=Nn("button",{name:"MuiPickersYear",slot:"YearButton",overridesResolver:(e,t)=>[t.yearButton,{[`&.${Dm.disabled}`]:t.disabled},{[`&.${Dm.selected}`]:t.selected}]})((e=>{let{theme:t}=e;return(0,n.A)({color:"unset",backgroundColor:"transparent",border:0,outline:0},t.typography.subtitle1,{margin:"6px 0",height:36,width:72,borderRadius:18,cursor:"pointer","&:focus":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.focusOpacity})`:Uf(t.palette.action.active,t.palette.action.focusOpacity)},"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:Uf(t.palette.action.active,t.palette.action.hoverOpacity)},"&:disabled":{cursor:"auto",pointerEvents:"none"},[`&.${Dm.disabled}`]:{color:(t.vars||t).palette.text.secondary},[`&.${Dm.selected}`]:{color:(t.vars||t).palette.primary.contrastText,backgroundColor:(t.vars||t).palette.primary.main,"&:focus, &:hover":{backgroundColor:(t.vars||t).palette.primary.dark}}})})),Om=e.memo((function(t){const i=X({props:t,name:"MuiPickersYear"}),{autoFocus:r,className:s,children:a,disabled:l,selected:c,value:u,tabIndex:h,onClick:d,onKeyDown:p,onFocus:f,onBlur:m,"aria-current":g}=i,y=(0,o.A)(i,Lm),_=e.useRef(null),v=(e=>{const{disabled:t,selected:i,classes:r}=e;return Dn({root:["root"],yearButton:["yearButton",t&&"disabled",i&&"selected"]},Im,r)})(i);return e.useEffect((()=>{r&&_.current.focus()}),[r]),(0,Y.jsx)(Rm,(0,n.A)({className:In(v.root,s),ownerState:i},y,{children:(0,Y.jsx)(zm,{ref:_,disabled:l,type:"button",role:"radio",tabIndex:l?-1:h,"aria-current":g,"aria-checked":c,onClick:e=>d(e,u),onKeyDown:e=>p(e,u),onFocus:e=>f(e,u),onBlur:e=>m(e,u),className:v.yearButton,ownerState:i,children:a})}))}));function Fm(e){return yo("MuiYearCalendar",e)}_o("MuiYearCalendar",["root"]);const Bm=["autoFocus","className","value","defaultValue","referenceDate","disabled","disableFuture","disablePast","maxDate","minDate","onChange","readOnly","shouldDisableYear","disableHighlightToday","onYearFocus","hasFocus","onFocusedViewChange","yearsPerRow","timezone","gridLabelId"];const Nm=Nn("div",{name:"MuiYearCalendar",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"flex",flexDirection:"row",flexWrap:"wrap",overflowY:"auto",height:"100%",padding:"0 4px",width:Qp,maxHeight:280,boxSizing:"border-box",position:"relative"}),jm=e.forwardRef((function(t,i){const r=function(e,t){var i;const r=Vu(),o=Uu(),s=X({props:e,name:t});return(0,n.A)({disablePast:!1,disableFuture:!1},s,{yearsPerRow:null!=(i=s.yearsPerRow)?i:3,minDate:ou(r,s.minDate,o.minDate),maxDate:ou(r,s.maxDate,o.maxDate)})}(t,"MuiYearCalendar"),{autoFocus:s,className:a,value:l,defaultValue:c,referenceDate:u,disabled:h,disableFuture:p,disablePast:f,maxDate:m,minDate:g,onChange:y,readOnly:_,shouldDisableYear:v,disableHighlightToday:x,onYearFocus:b,hasFocus:w,onFocusedViewChange:S,yearsPerRow:T,timezone:M,gridLabelId:A}=r,C=(0,o.A)(r,Bm),{value:E,handleValueChange:P,timezone:k}=sp({name:"YearCalendar",timezone:M,value:l,defaultValue:c,onChange:y,valueManager:zu}),I=Hu(k),D=d(),L=Vu(),R=e.useMemo((()=>zu.getInitialReferenceValue({value:E,utils:L,props:r,timezone:k,referenceDate:u,granularity:fu.year})),[]),z=r,O=(e=>{const{classes:t}=e;return Dn({root:["root"]},Fm,t)})(z),F=e.useMemo((()=>L.getYear(I)),[L,I]),B=e.useMemo((()=>null!=E?L.getYear(E):x?null:L.getYear(R)),[E,L,x,R]),[N,j]=e.useState((()=>B||F)),[V,U]=wl({name:"YearCalendar",state:"hasFocus",controlled:w,default:null!=s&&s}),G=Yn((e=>{U(e),S&&S(e)})),H=e.useCallback((e=>{if(f&&L.isBeforeYear(e,I))return!0;if(p&&L.isAfterYear(e,I))return!0;if(g&&L.isBeforeYear(e,g))return!0;if(m&&L.isAfterYear(e,m))return!0;if(!v)return!1;const t=L.startOfYear(e);return v(t)}),[p,f,m,g,I,v,L]),W=Yn(((e,t)=>{if(_)return;const i=L.setYear(null!=E?E:R,t);P(i)})),$=Yn((e=>{H(L.setYear(null!=E?E:R,e))||(j(e),G(!0),null==b||b(e))}));e.useEffect((()=>{j((e=>null!==B&&e!==B?B:e))}),[B]);const q=Yn(((e,t)=>{switch(e.key){case"ArrowUp":$(t-T),e.preventDefault();break;case"ArrowDown":$(t+T),e.preventDefault();break;case"ArrowLeft":$(t+("ltr"===D.direction?-1:1)),e.preventDefault();break;case"ArrowRight":$(t+("ltr"===D.direction?1:-1)),e.preventDefault()}})),Z=Yn(((e,t)=>{$(t)})),K=Yn(((e,t)=>{N===t&&G(!1)})),J=e.useRef(null),Q=Wn(i,J);return e.useEffect((()=>{if(s||null===J.current)return;const e=J.current.querySelector('[tabindex="0"]');if(!e)return;const t=e.offsetHeight,i=e.offsetTop,r=J.current.clientHeight,n=J.current.scrollTop,o=i+t;t>r||i<n||(J.current.scrollTop=o-r/2-t/2)}),[s]),(0,Y.jsx)(Nm,(0,n.A)({ref:Q,className:In(O.root,a),ownerState:z,role:"radiogroup","aria-labelledby":A},C,{children:L.getYearRange(g,m).map((e=>{const t=L.getYear(e),i=t===B,r=h||H(e);return(0,Y.jsx)(Om,{selected:i,value:t,onClick:W,onKeyDown:q,autoFocus:V&&t===N,disabled:r,tabIndex:t===N?0:-1,onFocus:Z,onBlur:K,"aria-current":F===t?"date":void 0,yearsPerRow:T,children:L.format(e,"year")},L.format(e,"year"))}))}))}));function Vm(e){return yo("MuiPickersArrowSwitcher",e)}_o("MuiPickersArrowSwitcher",["root","spacer","button"]);const Um=["children","className","slots","slotProps","isNextDisabled","isNextHidden","onGoToNext","nextLabel","isPreviousDisabled","isPreviousHidden","onGoToPrevious","previousLabel"],Gm=["ownerState"],Hm=["ownerState"],Wm=Nn("div",{name:"MuiPickersArrowSwitcher",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"flex"}),$m=Nn("div",{name:"MuiPickersArrowSwitcher",slot:"Spacer",overridesResolver:(e,t)=>t.spacer})((e=>{let{theme:t}=e;return{width:t.spacing(3)}})),qm=Nn(Sh,{name:"MuiPickersArrowSwitcher",slot:"Button",overridesResolver:(e,t)=>t.button})((e=>{let{ownerState:t}=e;return(0,n.A)({},t.hidden&&{visibility:"hidden"})})),Xm=e.forwardRef((function(e,t){var i,r,s,a;const l="rtl"===ca().direction,c=X({props:e,name:"MuiPickersArrowSwitcher"}),{children:u,className:h,slots:d,slotProps:p,isNextDisabled:f,isNextHidden:m,onGoToNext:g,nextLabel:y,isPreviousDisabled:_,isPreviousHidden:v,onGoToPrevious:x,previousLabel:b}=c,w=(0,o.A)(c,Um),S=c,T=(e=>{const{classes:t}=e;return Dn({root:["root"],spacer:["spacer"],button:["button"]},Vm,t)})(S),M={isDisabled:f,isHidden:m,goTo:g,label:y},A={isDisabled:_,isHidden:v,goTo:x,label:b},C=null!=(i=null==d?void 0:d.previousIconButton)?i:qm,E=dh({elementType:C,externalSlotProps:null==p?void 0:p.previousIconButton,additionalProps:{size:"medium",title:A.label,"aria-label":A.label,disabled:A.isDisabled,edge:"end",onClick:A.goTo},ownerState:(0,n.A)({},S,{hidden:A.isHidden}),className:T.button}),P=null!=(r=null==d?void 0:d.nextIconButton)?r:qm,k=dh({elementType:P,externalSlotProps:null==p?void 0:p.nextIconButton,additionalProps:{size:"medium",title:M.label,"aria-label":M.label,disabled:M.isDisabled,edge:"start",onClick:M.goTo},ownerState:(0,n.A)({},S,{hidden:M.isHidden}),className:T.button}),I=null!=(s=null==d?void 0:d.leftArrowIcon)?s:df,D=dh({elementType:I,externalSlotProps:null==p?void 0:p.leftArrowIcon,additionalProps:{fontSize:"inherit"},ownerState:void 0}),L=(0,o.A)(D,Gm),R=null!=(a=null==d?void 0:d.rightArrowIcon)?a:pf,z=dh({elementType:R,externalSlotProps:null==p?void 0:p.rightArrowIcon,additionalProps:{fontSize:"inherit"},ownerState:void 0}),O=(0,o.A)(z,Hm);return(0,Y.jsxs)(Wm,(0,n.A)({ref:t,className:In(T.root,h),ownerState:S},w,{children:[(0,Y.jsx)(C,(0,n.A)({},E,{children:l?(0,Y.jsx)(R,(0,n.A)({},O)):(0,Y.jsx)(I,(0,n.A)({},L))})),u?(0,Y.jsx)(Ku,{variant:"subtitle1",component:"span",children:u}):(0,Y.jsx)($m,{className:T.spacer,ownerState:S}),(0,Y.jsx)(P,(0,n.A)({},k,{children:l?(0,Y.jsx)(I,(0,n.A)({},L)):(0,Y.jsx)(R,(0,n.A)({},O))}))]}))}));const Ym=e=>yo("MuiPickersCalendarHeader",e),Zm=_o("MuiPickersCalendarHeader",["root","labelContainer","label","switchViewButton","switchViewIcon"]),Km=["slots","slotProps","components","componentsProps","currentMonth","disabled","disableFuture","disablePast","maxDate","minDate","onMonthChange","onViewChange","view","reduceAnimations","views","labelId","className","timezone"],Jm=["ownerState"],Qm=Nn("div",{name:"MuiPickersCalendarHeader",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"flex",alignItems:"center",marginTop:16,marginBottom:8,paddingLeft:24,paddingRight:12,maxHeight:30,minHeight:30}),eg=Nn("div",{name:"MuiPickersCalendarHeader",slot:"LabelContainer",overridesResolver:(e,t)=>t.labelContainer})((e=>{let{theme:t}=e;return(0,n.A)({display:"flex",overflow:"hidden",alignItems:"center",cursor:"pointer",marginRight:"auto"},t.typography.body1,{fontWeight:t.typography.fontWeightMedium})})),tg=Nn("div",{name:"MuiPickersCalendarHeader",slot:"Label",overridesResolver:(e,t)=>t.label})({marginRight:6}),ig=Nn(Sh,{name:"MuiPickersCalendarHeader",slot:"SwitchViewButton",overridesResolver:(e,t)=>t.switchViewButton})((e=>{let{ownerState:t}=e;return(0,n.A)({marginRight:"auto"},"year"===t.view&&{[`.${Zm.switchViewIcon}`]:{transform:"rotate(180deg)"}})})),rg=Nn(hf,{name:"MuiPickersCalendarHeader",slot:"SwitchViewIcon",overridesResolver:(e,t)=>t.switchViewIcon})((e=>{let{theme:t}=e;return{willChange:"transform",transition:t.transitions.create("transform"),transform:"rotate(0deg)"}})),ng=e.forwardRef((function(t,i){var r,s,a,l;const c=Gu(),u=Vu(),h=X({props:t,name:"MuiPickersCalendarHeader"}),{slots:d,slotProps:p,components:f,currentMonth:m,disabled:g,disableFuture:y,disablePast:_,maxDate:v,minDate:x,onMonthChange:b,onViewChange:w,view:S,reduceAnimations:T,views:M,labelId:A,className:C,timezone:E}=h,P=(0,o.A)(h,Km),k=h,I=(e=>{const{classes:t}=e;return Dn({root:["root"],labelContainer:["labelContainer"],label:["label"],switchViewButton:["switchViewButton"],switchViewIcon:["switchViewIcon"]},Ym,t)})(h),D=null!=(r=null!=(s=null==d?void 0:d.switchViewButton)?s:null==f?void 0:f.SwitchViewButton)?r:ig,L=dh({elementType:D,externalSlotProps:null==p?void 0:p.switchViewButton,additionalProps:{size:"small","aria-label":c.calendarViewSwitchingButtonAriaLabel(S)},ownerState:k,className:I.switchViewButton}),R=null!=(a=null!=(l=null==d?void 0:d.switchViewIcon)?l:null==f?void 0:f.SwitchViewIcon)?a:rg,z=dh({elementType:R,externalSlotProps:null==p?void 0:p.switchViewIcon,ownerState:void 0,className:I.switchViewIcon}),O=(0,o.A)(z,Jm),F=function(t,i){let{disableFuture:r,maxDate:n,timezone:o}=i;const s=Vu();return e.useMemo((()=>{const e=s.dateWithTimezone(void 0,o),i=s.startOfMonth(r&&s.isBefore(e,n)?e:n);return!s.isAfter(i,t)}),[r,n,t,s,o])}(m,{disableFuture:y,maxDate:v,timezone:E}),B=function(t,i){let{disablePast:r,minDate:n,timezone:o}=i;const s=Vu();return e.useMemo((()=>{const e=s.dateWithTimezone(void 0,o),i=s.startOfMonth(r&&s.isAfter(e,n)?e:n);return!s.isBefore(i,t)}),[r,n,t,s,o])}(m,{disablePast:_,minDate:x,timezone:E});return 1===M.length&&"year"===M[0]?null:(0,Y.jsxs)(Qm,(0,n.A)({},P,{ownerState:k,className:In(C,I.root),ref:i,children:[(0,Y.jsxs)(eg,{role:"presentation",onClick:()=>{if(1!==M.length&&w&&!g)if(2===M.length)w(M.find((e=>e!==S))||M[0]);else{const e=0!==M.indexOf(S)?0:1;w(M[e])}},ownerState:k,"aria-live":"polite",className:I.labelContainer,children:[(0,Y.jsx)(Ff,{reduceAnimations:T,transKey:u.format(m,"monthAndYear"),children:(0,Y.jsx)(tg,{id:A,ownerState:k,className:I.label,children:u.format(m,"monthAndYear")})}),M.length>1&&!g&&(0,Y.jsx)(D,(0,n.A)({},L,{children:(0,Y.jsx)(R,(0,n.A)({},O))}))]}),(0,Y.jsx)(Ma,{in:"day"===S,children:(0,Y.jsx)(Xm,{slots:d,slotProps:p,onGoToPrevious:()=>b(u.addMonths(m,-1),"right"),isPreviousDisabled:B,previousLabel:c.previousMonth,onGoToNext:()=>b(u.addMonths(m,1),"left"),isNextDisabled:F,nextLabel:c.nextMonth})})]}))})),og=Nn("div")({overflow:"hidden",width:Qp,maxHeight:334,display:"flex",flexDirection:"column",margin:"0 auto"}),sg=e=>yo("MuiDateCalendar",e),ag=(_o("MuiDateCalendar",["root","viewTransitionContainer"]),["autoFocus","onViewChange","value","defaultValue","referenceDate","disableFuture","disablePast","defaultCalendarMonth","onChange","onYearChange","onMonthChange","reduceAnimations","shouldDisableDate","shouldDisableMonth","shouldDisableYear","view","views","openTo","className","disabled","readOnly","minDate","maxDate","disableHighlightToday","focusedView","onFocusedViewChange","showDaysOutsideCurrentMonth","fixedWeekNumber","dayOfWeekFormatter","components","componentsProps","slots","slotProps","loading","renderLoading","displayWeekNumber","yearsPerRow","monthsPerRow","timezone"]);const lg=Nn(og,{name:"MuiDateCalendar",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"flex",flexDirection:"column",height:334}),cg=Nn(Ff,{name:"MuiDateCalendar",slot:"ViewTransitionContainer",overridesResolver:(e,t)=>t.viewTransitionContainer})({}),ug=e.forwardRef((function(t,i){var r,s,a;const l=Vu(),c=zn(),u=function(e,t){var i,r,o,s,a,l,c;const u=Vu(),h=Uu(),d=Jd(),p=X({props:e,name:t});return(0,n.A)({},p,{loading:null!=(i=p.loading)&&i,disablePast:null!=(r=p.disablePast)&&r,disableFuture:null!=(o=p.disableFuture)&&o,openTo:null!=(s=p.openTo)?s:"day",views:null!=(a=p.views)?a:["year","day"],reduceAnimations:null!=(l=p.reduceAnimations)?l:d,renderLoading:null!=(c=p.renderLoading)?c:()=>(0,Y.jsx)("span",{children:"..."}),minDate:ou(u,p.minDate,h.minDate),maxDate:ou(u,p.maxDate,h.maxDate)})}(t,"MuiDateCalendar"),{autoFocus:h,onViewChange:d,value:p,defaultValue:f,referenceDate:m,disableFuture:g,disablePast:y,defaultCalendarMonth:_,onChange:v,onYearChange:x,onMonthChange:b,reduceAnimations:w,shouldDisableDate:S,shouldDisableMonth:T,shouldDisableYear:M,view:A,views:C,openTo:E,className:P,disabled:k,readOnly:I,minDate:D,maxDate:L,disableHighlightToday:R,focusedView:z,onFocusedViewChange:O,showDaysOutsideCurrentMonth:F,fixedWeekNumber:B,dayOfWeekFormatter:N,components:j,componentsProps:V,slots:U,slotProps:G,loading:H,renderLoading:W,displayWeekNumber:$,yearsPerRow:q,monthsPerRow:Z,timezone:K}=u,J=(0,o.A)(u,ag),{value:Q,handleValueChange:ee,timezone:te}=sp({name:"DateCalendar",timezone:K,value:p,defaultValue:f,onChange:v,valueManager:zu}),{view:ie,setView:re,focusedView:ne,setFocusedView:oe,goToNextView:se,setValueAndGoToNextView:ae}=lp({view:A,views:C,openTo:E,onChange:ee,onViewChange:d,autoFocus:h,focusedView:z,onFocusedViewChange:O}),{referenceDate:le,calendarState:ce,changeFocusedDay:ue,changeMonth:he,handleChangeMonth:de,isDateDisabled:pe,onMonthSwitchingAnimationEnd:fe}=Rf({value:Q,defaultCalendarMonth:_,referenceDate:m,reduceAnimations:w,onMonthChange:b,minDate:D,maxDate:L,shouldDisableDate:S,disablePast:y,disableFuture:g,timezone:te}),me=k&&Q||D,ge=k&&Q||L,ye=`${c}-grid-label`,_e=null!==ne,ve=null!=(r=null!=(s=null==U?void 0:U.calendarHeader)?s:null==j?void 0:j.CalendarHeader)?r:ng,xe=dh({elementType:ve,externalSlotProps:null!=(a=null==G?void 0:G.calendarHeader)?a:null==V?void 0:V.calendarHeader,additionalProps:{views:C,view:ie,currentMonth:ce.currentMonth,onViewChange:re,onMonthChange:(e,t)=>de({newMonth:e,direction:t}),minDate:me,maxDate:ge,disabled:k,disablePast:y,disableFuture:g,reduceAnimations:w,timezone:te,labelId:ye,slots:U,slotProps:G},ownerState:u}),be=Yn((e=>{const t=l.startOfMonth(e),i=l.endOfMonth(e),r=pe(e)?nu({utils:l,date:e,minDate:l.isBefore(D,t)?t:D,maxDate:l.isAfter(L,i)?i:L,disablePast:y,disableFuture:g,isDateDisabled:pe,timezone:te}):e;r?(ae(r,"finish"),null==b||b(t)):(se(),he(t)),ue(r,!0)})),we=Yn((e=>{const t=l.startOfYear(e),i=l.endOfYear(e),r=pe(e)?nu({utils:l,date:e,minDate:l.isBefore(D,t)?t:D,maxDate:l.isAfter(L,i)?i:L,disablePast:y,disableFuture:g,isDateDisabled:pe,timezone:te}):e;r?(ae(r,"finish"),null==x||x(r)):(se(),he(t)),ue(r,!0)})),Se=Yn((e=>ee(e?ru(l,e,null!=Q?Q:le):e,"finish",ie)));e.useEffect((()=>{null!=Q&&l.isValid(Q)&&he(Q)}),[Q]);const Te=u,Me=(e=>{const{classes:t}=e;return Dn({root:["root"],viewTransitionContainer:["viewTransitionContainer"]},sg,t)})(Te),Ae={disablePast:y,disableFuture:g,maxDate:L,minDate:D},Ce={disableHighlightToday:R,readOnly:I,disabled:k,timezone:te,gridLabelId:ye},Ee=e.useRef(ie);e.useEffect((()=>{Ee.current!==ie&&(ne===Ee.current&&oe(ie,!0),Ee.current=ie)}),[ne,oe,ie]);const Pe=e.useMemo((()=>[Q]),[Q]);return(0,Y.jsxs)(lg,(0,n.A)({ref:i,className:In(Me.root,P),ownerState:Te},J,{children:[(0,Y.jsx)(ve,(0,n.A)({},xe)),(0,Y.jsx)(cg,{reduceAnimations:w,className:Me.viewTransitionContainer,transKey:ie,ownerState:Te,children:(0,Y.jsxs)("div",{children:["year"===ie&&(0,Y.jsx)(jm,(0,n.A)({},Ae,Ce,{value:Q,onChange:we,shouldDisableYear:M,hasFocus:_e,onFocusedViewChange:e=>oe("year",e),yearsPerRow:q,referenceDate:le})),"month"===ie&&(0,Y.jsx)(km,(0,n.A)({},Ae,Ce,{hasFocus:_e,className:P,value:Q,onChange:be,shouldDisableMonth:T,onFocusedViewChange:e=>oe("month",e),monthsPerRow:Z,referenceDate:le})),"day"===ie&&(0,Y.jsx)(xm,(0,n.A)({},ce,Ae,Ce,{onMonthSwitchingAnimationEnd:fe,onFocusedDayChange:ue,reduceAnimations:w,selectedDays:Pe,onSelectedDaysChange:Se,shouldDisableDate:S,shouldDisableMonth:T,shouldDisableYear:M,hasFocus:_e,onFocusedViewChange:e=>oe("day",e),showDaysOutsideCurrentMonth:F,fixedWeekNumber:B,dayOfWeekFormatter:N,displayWeekNumber:$,components:j,componentsProps:V,slots:U,slotProps:G,loading:H,renderLoading:W}))]})})]}))})),hg=e=>{let{view:t,onViewChange:i,views:r,focusedView:n,onFocusedViewChange:o,value:s,defaultValue:a,referenceDate:l,onChange:c,className:u,classes:h,disableFuture:d,disablePast:p,minDate:f,maxDate:m,shouldDisableDate:g,shouldDisableMonth:y,shouldDisableYear:_,reduceAnimations:v,onMonthChange:x,monthsPerRow:b,onYearChange:w,yearsPerRow:S,defaultCalendarMonth:T,components:M,componentsProps:A,slots:C,slotProps:E,loading:P,renderLoading:k,disableHighlightToday:I,readOnly:D,disabled:L,showDaysOutsideCurrentMonth:R,dayOfWeekFormatter:z,sx:O,autoFocus:F,fixedWeekNumber:B,displayWeekNumber:N,timezone:j}=e;return(0,Y.jsx)(ug,{view:t,onViewChange:i,views:r.filter(cu),focusedView:n&&cu(n)?n:null,onFocusedViewChange:o,value:s,defaultValue:a,referenceDate:l,onChange:c,className:u,classes:h,disableFuture:d,disablePast:p,minDate:f,maxDate:m,shouldDisableDate:g,shouldDisableMonth:y,shouldDisableYear:_,reduceAnimations:v,onMonthChange:x,monthsPerRow:b,onYearChange:w,yearsPerRow:S,defaultCalendarMonth:T,components:M,componentsProps:A,slots:C,slotProps:E,loading:P,renderLoading:k,disableHighlightToday:I,readOnly:D,disabled:L,showDaysOutsideCurrentMonth:R,dayOfWeekFormatter:z,sx:O,autoFocus:F,fixedWeekNumber:B,displayWeekNumber:N,timezone:j})},dg=e.forwardRef((function(t,i){var r,s,a,l;const c=Gu(),u=Vu(),h=lh(t,"MuiDesktopDatePicker"),d=(0,n.A)({day:hg,month:hg,year:hg},h.viewRenderers),p=(0,n.A)({},h,{viewRenderers:d,format:uu(u,h,!1),yearsPerRow:null!=(r=h.yearsPerRow)?r:4,slots:(0,n.A)({openPickerIcon:ff,field:Df},h.slots),slotProps:(0,n.A)({},h.slotProps,{field:e=>{var t;return(0,n.A)({},eu(null==(t=h.slotProps)?void 0:t.field,e),Mf(h),{ref:i})},toolbar:(0,n.A)({hidden:!0},null==(s=h.slotProps)?void 0:s.toolbar)})}),{renderPicker:f}=(t=>{var i,r,s,a,l;let{props:c,getOpenDialogAriaText:u}=t,h=(0,o.A)(t,lf);const{slots:d,slotProps:p,className:f,sx:m,format:g,formatDensity:y,timezone:_,name:v,label:x,inputRef:b,readOnly:w,disabled:S,autoFocus:T,localeText:M,reduceAnimations:A}=c,C=Vu(),E=e.useRef(null),P=e.useRef(null),k=zn(),I=null!=(i=null==p||null==(r=p.toolbar)?void 0:r.hidden)&&i,{open:D,actions:L,hasUIView:R,layoutProps:z,renderCurrentView:O,shouldRestoreFocus:F,fieldProps:B}=pp((0,n.A)({},h,{props:c,inputRef:E,autoFocusView:!0,additionalViewProps:{},wrapperVariant:"desktop"})),N=null!=(s=d.inputAdornment)?s:_h,j=dh({elementType:N,externalSlotProps:null==p?void 0:p.inputAdornment,additionalProps:{position:"end"},ownerState:c}),V=(0,o.A)(j,cf),U=null!=(a=d.openPickerButton)?a:Sh,G=dh({elementType:U,externalSlotProps:null==p?void 0:p.openPickerButton,additionalProps:{disabled:S||w,onClick:D?L.onClose:L.onOpen,"aria-label":u(B.value,C),edge:V.position},ownerState:c}),H=(0,o.A)(G,uf),W=d.openPickerIcon,$=d.field,q=dh({elementType:$,externalSlotProps:null==p?void 0:p.field,additionalProps:(0,n.A)({},B,I&&{id:k},{readOnly:w,disabled:S,className:f,sx:m,format:g,formatDensity:y,timezone:_,label:x,name:v,autoFocus:T&&!c.open,focused:!!D||void 0}),ownerState:c});R&&(q.InputProps=(0,n.A)({},q.InputProps,{ref:P},!c.disableOpenPicker&&{[`${V.position}Adornment`]:(0,Y.jsx)(N,(0,n.A)({},V,{children:(0,Y.jsx)(U,(0,n.A)({},H,{children:(0,Y.jsx)(W,(0,n.A)({},null==p?void 0:p.openPickerIcon))}))}))}));const X=(0,n.A)({textField:d.textField,clearIcon:d.clearIcon,clearButton:d.clearButton},q.slots),Z=null!=(l=d.layout)?l:af,K=Wn(E,q.inputRef,b);let Q=k;I&&(Q=x?`${k}-label`:void 0);const ee=(0,n.A)({},p,{toolbar:(0,n.A)({},null==p?void 0:p.toolbar,{titleId:k}),popper:(0,n.A)({"aria-labelledby":Q},null==p?void 0:p.popper)});return{renderPicker:()=>(0,Y.jsxs)(J,{localeText:M,children:[(0,Y.jsx)($,(0,n.A)({},q,{slots:X,slotProps:ee,inputRef:K})),(0,Y.jsx)(rp,(0,n.A)({role:"dialog",placement:"bottom-start",anchorEl:P.current},L,{open:D,slots:d,slotProps:ee,shouldRestoreFocus:F,reduceAnimations:A,children:(0,Y.jsx)(Z,(0,n.A)({},z,null==ee?void 0:ee.layout,{slots:d,slotProps:ee,children:O()}))}))]})}})({props:p,valueManager:zu,valueType:"date",getOpenDialogAriaText:null!=(a=null==(l=p.localeText)?void 0:l.openDatePickerDialogue)?a:c.openDatePickerDialogue,validator:ch});return f()}));function pg(e){return yo("MuiDialogContent",e)}dg.propTypes={autoFocus:Qc().bool,className:Qc().string,closeOnSelect:Qc().bool,components:Qc().object,componentsProps:Qc().object,dayOfWeekFormatter:Qc().func,defaultCalendarMonth:Qc().any,defaultValue:Qc().any,disabled:Qc().bool,disableFuture:Qc().bool,disableHighlightToday:Qc().bool,disableOpenPicker:Qc().bool,disablePast:Qc().bool,displayWeekNumber:Qc().bool,fixedWeekNumber:Qc().number,format:Qc().string,formatDensity:Qc().oneOf(["dense","spacious"]),inputRef:tu,label:Qc().node,loading:Qc().bool,localeText:Qc().object,maxDate:Qc().any,minDate:Qc().any,monthsPerRow:Qc().oneOf([3,4]),name:Qc().string,onAccept:Qc().func,onChange:Qc().func,onClose:Qc().func,onError:Qc().func,onMonthChange:Qc().func,onOpen:Qc().func,onSelectedSectionsChange:Qc().func,onViewChange:Qc().func,onYearChange:Qc().func,open:Qc().bool,openTo:Qc().oneOf(["day","month","year"]),orientation:Qc().oneOf(["landscape","portrait"]),readOnly:Qc().bool,reduceAnimations:Qc().bool,referenceDate:Qc().any,renderLoading:Qc().func,selectedSections:Qc().oneOfType([Qc().oneOf(["all","day","hours","meridiem","minutes","month","seconds","weekDay","year"]),Qc().number,Qc().shape({endIndex:Qc().number.isRequired,startIndex:Qc().number.isRequired})]),shouldDisableDate:Qc().func,shouldDisableMonth:Qc().func,shouldDisableYear:Qc().func,showDaysOutsideCurrentMonth:Qc().bool,slotProps:Qc().object,slots:Qc().object,sx:Qc().oneOfType([Qc().arrayOf(Qc().oneOfType([Qc().func,Qc().object,Qc().bool])),Qc().func,Qc().object]),timezone:Qc().string,value:Qc().any,view:Qc().oneOf(["day","month","year"]),viewRenderers:Qc().shape({day:Qc().func,month:Qc().func,year:Qc().func}),views:Qc().arrayOf(Qc().oneOf(["day","month","year"]).isRequired),yearsPerRow:Qc().oneOf([3,4])};_o("MuiDialogContent",["root","dividers"]);const fg=_o("MuiDialogTitle",["root"]),mg=["className","dividers"],gg=Nn("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,i.dividers&&t.dividers]}})((e=>{let{theme:t,ownerState:i}=e;return(0,n.A)({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px"},i.dividers?{padding:"16px 24px",borderTop:`1px solid ${(t.vars||t).palette.divider}`,borderBottom:`1px solid ${(t.vars||t).palette.divider}`}:{[`.${fg.root} + &`]:{paddingTop:0}})})),yg=e.forwardRef((function(e,t){const i=Un({props:e,name:"MuiDialogContent"}),{className:r,dividers:s=!1}=i,a=(0,o.A)(i,mg),l=(0,n.A)({},i,{dividers:s}),c=(e=>{const{classes:t,dividers:i}=e;return Dn({root:["root",i&&"dividers"]},pg,t)})(l);return(0,Y.jsx)(gg,(0,n.A)({className:In(c.root,r),ownerState:l,ref:t},a))}));function _g(e){return yo("MuiDialog",e)}const vg=_o("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]);const xg=e.createContext({}),bg=["aria-describedby","aria-labelledby","BackdropComponent","BackdropProps","children","className","disableEscapeKeyDown","fullScreen","fullWidth","maxWidth","onBackdropClick","onClick","onClose","open","PaperComponent","PaperProps","scroll","TransitionComponent","transitionDuration","TransitionProps"],wg=Nn(Pa,{name:"MuiDialog",slot:"Backdrop",overrides:(e,t)=>t.backdrop})({zIndex:-1}),Sg=Nn(Ua,{name:"MuiDialog",slot:"Root",overridesResolver:(e,t)=>t.root})({"@media print":{position:"absolute !important"}}),Tg=Nn("div",{name:"MuiDialog",slot:"Container",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.container,t[`scroll${oo(i.scroll)}`]]}})((e=>{let{ownerState:t}=e;return(0,n.A)({height:"100%","@media print":{height:"auto"},outline:0},"paper"===t.scroll&&{display:"flex",justifyContent:"center",alignItems:"center"},"body"===t.scroll&&{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}})})),Mg=Nn(qa,{name:"MuiDialog",slot:"Paper",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.paper,t[`scrollPaper${oo(i.scroll)}`],t[`paperWidth${oo(String(i.maxWidth))}`],i.fullWidth&&t.paperFullWidth,i.fullScreen&&t.paperFullScreen]}})((e=>{let{theme:t,ownerState:i}=e;return(0,n.A)({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"}},"paper"===i.scroll&&{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"},"body"===i.scroll&&{display:"inline-block",verticalAlign:"middle",textAlign:"left"},!i.maxWidth&&{maxWidth:"calc(100% - 64px)"},"xs"===i.maxWidth&&{maxWidth:"px"===t.breakpoints.unit?Math.max(t.breakpoints.values.xs,444):`max(${t.breakpoints.values.xs}${t.breakpoints.unit}, 444px)`,[`&.${vg.paperScrollBody}`]:{[t.breakpoints.down(Math.max(t.breakpoints.values.xs,444)+64)]:{maxWidth:"calc(100% - 64px)"}}},i.maxWidth&&"xs"!==i.maxWidth&&{maxWidth:`${t.breakpoints.values[i.maxWidth]}${t.breakpoints.unit}`,[`&.${vg.paperScrollBody}`]:{[t.breakpoints.down(t.breakpoints.values[i.maxWidth]+64)]:{maxWidth:"calc(100% - 64px)"}}},i.fullWidth&&{width:"calc(100% - 64px)"},i.fullScreen&&{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${vg.paperScrollBody}`]:{margin:0,maxWidth:"100%"}})})),Ag=Nn(e.forwardRef((function(t,i){const r=Un({props:t,name:"MuiDialog"}),s=ca(),a={enter:s.transitions.duration.enteringScreen,exit:s.transitions.duration.leavingScreen},{"aria-describedby":l,"aria-labelledby":c,BackdropComponent:u,BackdropProps:h,children:d,className:p,disableEscapeKeyDown:f=!1,fullScreen:m=!1,fullWidth:g=!1,maxWidth:y="sm",onBackdropClick:_,onClick:v,onClose:x,open:b,PaperComponent:w=qa,PaperProps:S={},scroll:T="paper",TransitionComponent:M=Ma,transitionDuration:A=a,TransitionProps:C}=r,E=(0,o.A)(r,bg),P=(0,n.A)({},r,{disableEscapeKeyDown:f,fullScreen:m,fullWidth:g,maxWidth:y,scroll:T}),k=(e=>{const{classes:t,scroll:i,maxWidth:r,fullWidth:n,fullScreen:o}=e;return Dn({root:["root"],container:["container",`scroll${oo(i)}`],paper:["paper",`paperScroll${oo(i)}`,`paperWidth${oo(String(r))}`,n&&"paperFullWidth",o&&"paperFullScreen"]},_g,t)})(P),I=e.useRef(),D=zn(c),L=e.useMemo((()=>({titleId:D})),[D]);return(0,Y.jsx)(Sg,(0,n.A)({className:In(k.root,p),closeAfterTransition:!0,components:{Backdrop:wg},componentsProps:{backdrop:(0,n.A)({transitionDuration:A,as:u},h)},disableEscapeKeyDown:f,onClose:x,open:b,ref:i,onClick:e=>{v&&v(e),I.current&&(I.current=null,_&&_(e),x&&x(e,"backdropClick"))},ownerState:P},E,{children:(0,Y.jsx)(M,(0,n.A)({appear:!0,in:b,timeout:A,role:"presentation"},C,{children:(0,Y.jsx)(Tg,{className:In(k.container),onMouseDown:e=>{I.current=e.target===e.currentTarget},ownerState:P,children:(0,Y.jsx)(Mg,(0,n.A)({as:w,elevation:24,role:"dialog","aria-describedby":l,"aria-labelledby":D},S,{className:In(k.paper,S.className),ownerState:P,children:(0,Y.jsx)(xg.Provider,{value:L,children:d})}))})}))}))})))({[`& .${vg.container}`]:{outline:0},[`& .${vg.paper}`]:{outline:0,minWidth:Qp}}),Cg=Nn(yg)({"&:first-of-type":{padding:0}});function Eg(e){var t,i;const{children:r,onDismiss:o,open:s,slots:a,slotProps:l}=e,c=null!=(t=null==a?void 0:a.dialog)?t:Ag,u=null!=(i=null==a?void 0:a.mobileTransition)?i:Ma;return(0,Y.jsx)(c,(0,n.A)({open:s,onClose:o},null==l?void 0:l.dialog,{TransitionComponent:u,TransitionProps:null==l?void 0:l.mobileTransition,PaperComponent:null==a?void 0:a.mobilePaper,PaperProps:null==l?void 0:l.mobilePaper,children:(0,Y.jsx)(Cg,{children:r})}))}const Pg=["props","getOpenDialogAriaText"],kg=e.forwardRef((function(t,i){var r,s,a;const l=Gu(),c=Vu(),u=lh(t,"MuiMobileDatePicker"),h=(0,n.A)({day:hg,month:hg,year:hg},u.viewRenderers),d=(0,n.A)({},u,{viewRenderers:h,format:uu(c,u,!1),slots:(0,n.A)({field:Df},u.slots),slotProps:(0,n.A)({},u.slotProps,{field:e=>{var t;return(0,n.A)({},eu(null==(t=u.slotProps)?void 0:t.field,e),Mf(u),{ref:i})},toolbar:(0,n.A)({hidden:!1},null==(r=u.slotProps)?void 0:r.toolbar)})}),{renderPicker:p}=(t=>{var i,r,s;let{props:a,getOpenDialogAriaText:l}=t,c=(0,o.A)(t,Pg);const{slots:u,slotProps:h,className:d,sx:p,format:f,formatDensity:m,timezone:g,name:y,label:_,inputRef:v,readOnly:x,disabled:b,localeText:w}=a,S=Vu(),T=e.useRef(null),M=zn(),A=null!=(i=null==h||null==(r=h.toolbar)?void 0:r.hidden)&&i,{open:C,actions:E,layoutProps:P,renderCurrentView:k,fieldProps:I}=pp((0,n.A)({},c,{props:a,inputRef:T,autoFocusView:!0,additionalViewProps:{},wrapperVariant:"mobile"})),D=u.field,L=dh({elementType:D,externalSlotProps:null==h?void 0:h.field,additionalProps:(0,n.A)({},I,A&&{id:M},!(b||x)&&{onClick:E.onOpen,onKeyDown:(R=E.onOpen,e=>{"Enter"!==e.key&&" "!==e.key||(R(e),e.preventDefault(),e.stopPropagation()),z&&z(e)})},{readOnly:null==x||x,disabled:b,className:d,sx:p,format:f,formatDensity:m,timezone:g,label:_,name:y}),ownerState:a});var R,z;L.inputProps=(0,n.A)({},L.inputProps,{"aria-label":l(I.value,S)});const O=(0,n.A)({textField:u.textField},L.slots),F=null!=(s=u.layout)?s:af,B=Wn(T,L.inputRef,v);let N=M;A&&(N=_?`${M}-label`:void 0);const j=(0,n.A)({},h,{toolbar:(0,n.A)({},null==h?void 0:h.toolbar,{titleId:M}),mobilePaper:(0,n.A)({"aria-labelledby":N},null==h?void 0:h.mobilePaper)});return{renderPicker:()=>(0,Y.jsxs)(J,{localeText:w,children:[(0,Y.jsx)(D,(0,n.A)({},L,{slots:O,slotProps:j,inputRef:B})),(0,Y.jsx)(Eg,(0,n.A)({},E,{open:C,slots:u,slotProps:j,children:(0,Y.jsx)(F,(0,n.A)({},P,null==j?void 0:j.layout,{slots:u,slotProps:j,children:k()}))}))]})}})({props:d,valueManager:zu,valueType:"date",getOpenDialogAriaText:null!=(s=null==(a=d.localeText)?void 0:a.openDatePickerDialogue)?s:l.openDatePickerDialogue,validator:ch});return p()}));kg.propTypes={autoFocus:Qc().bool,className:Qc().string,closeOnSelect:Qc().bool,components:Qc().object,componentsProps:Qc().object,dayOfWeekFormatter:Qc().func,defaultCalendarMonth:Qc().any,defaultValue:Qc().any,disabled:Qc().bool,disableFuture:Qc().bool,disableHighlightToday:Qc().bool,disableOpenPicker:Qc().bool,disablePast:Qc().bool,displayWeekNumber:Qc().bool,fixedWeekNumber:Qc().number,format:Qc().string,formatDensity:Qc().oneOf(["dense","spacious"]),inputRef:tu,label:Qc().node,loading:Qc().bool,localeText:Qc().object,maxDate:Qc().any,minDate:Qc().any,monthsPerRow:Qc().oneOf([3,4]),name:Qc().string,onAccept:Qc().func,onChange:Qc().func,onClose:Qc().func,onError:Qc().func,onMonthChange:Qc().func,onOpen:Qc().func,onSelectedSectionsChange:Qc().func,onViewChange:Qc().func,onYearChange:Qc().func,open:Qc().bool,openTo:Qc().oneOf(["day","month","year"]),orientation:Qc().oneOf(["landscape","portrait"]),readOnly:Qc().bool,reduceAnimations:Qc().bool,referenceDate:Qc().any,renderLoading:Qc().func,selectedSections:Qc().oneOfType([Qc().oneOf(["all","day","hours","meridiem","minutes","month","seconds","weekDay","year"]),Qc().number,Qc().shape({endIndex:Qc().number.isRequired,startIndex:Qc().number.isRequired})]),shouldDisableDate:Qc().func,shouldDisableMonth:Qc().func,shouldDisableYear:Qc().func,showDaysOutsideCurrentMonth:Qc().bool,slotProps:Qc().object,slots:Qc().object,sx:Qc().oneOfType([Qc().arrayOf(Qc().oneOfType([Qc().func,Qc().object,Qc().bool])),Qc().func,Qc().object]),timezone:Qc().string,value:Qc().any,view:Qc().oneOf(["day","month","year"]),viewRenderers:Qc().shape({day:Qc().func,month:Qc().func,year:Qc().func}),views:Qc().arrayOf(Qc().oneOf(["day","month","year"]).isRequired),yearsPerRow:Qc().oneOf([3,4])};const Ig=["desktopModeMediaQuery"],Dg=e.forwardRef((function(e,t){const i=X({props:e,name:"MuiDatePicker"}),{desktopModeMediaQuery:r=qd}=i,s=(0,o.A)(i,Ig);return Kc(r,{defaultMatches:!0})?(0,Y.jsx)(dg,(0,n.A)({ref:t},s)):(0,Y.jsx)(kg,(0,n.A)({ref:t},s))}));function Lg(){const{userSelections:t,setterFuncs:i}=(0,e.useContext)(Hc);return(0,Y.jsx)(Dg,{label:"Planting/Budbreak",value:t.plantDate,onChange:e=>i.setPlantDate(e)})}function Rg(){const{userSelections:t,setterFuncs:i}=(0,e.useContext)(Hc);return(0,Y.jsx)(Dg,{label:"Last Irrigation Date",value:t.irrigationDate,onChange:e=>i.setIrrigationDate(e)})}const zg=async function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=await fetch(t,{method:"POST",headers:{Accept:"application/json",...i},body:JSON.stringify(e)});if(!r.ok)throw new Error(r.statusText);return await r.json()},Og=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=await fetch(e,{method:"GET",headers:{Accept:"application/json",...t}});if(!i.ok)throw new Error(i.statusText);return await i.json()},Fg=(e,t,i)=>{const{dates_pet:r,dates_pet_fcst:n,pet:o,pet_fcst:s}=e,a=[...o];for(;a.length&&-999===a[a.length-1];)a.pop();let l=r.slice(0,a.length);const c=[...n],u=[...s];for(;c.length&&l.includes(c[0]);)c.splice(0,1),u.splice(0,1);l=l.concat(c).map((e=>`${t}-${e.replace("/","-")}`));const h=a.concat(u),d=h.reduce(((e,t)=>e+t))/h.length,p=i-h.length,f=or(l[l.length-1],"yyyy-MM-dd",new Date);for(let m=1;m<=p;m++)l.push(ft(re(f,m),"yyyy-MM-dd")),h.push(d);return{dates:l,values:h}},Bg=(0,e.createContext)({waterDeficits:null}),Ng=t=>{let{children:i}=t;const{selectedLocationInfo:r}=(0,e.useContext)(Fr),{percentiles:n,fcstUrl:o,acisUrl:s,petUrlCreator:a,today:l,seasonStartYear:c}=(0,e.useContext)(zr),{userSelections:u}=(0,e.useContext)(Hc),[h,d]=(0,e.useState)(null),[p,f]=(0,e.useState)(null);(0,e.useEffect)((()=>{if(r){const e=[r.lng,r.lat],t={loc:e.join(","),grid:"nrcc-model",sDate:`${c}-03-01`,eDate:ft(l,"yyyy-MM-dd"),elems:[{name:"pcpn"}]},i={lngLatArr:e,percentiles:n};(async()=>{const[r,n,l]=await Promise.all([zg(t,s),zg(i,o,{Authorization:"api-673283n7-token"}),Og(a(e,c),{Authorization:"api-4a0607-token"})]);console.log("ACIS precip return: ",r),console.log("Forecasted precip return: ",n),console.log("Irrigation API return: ",l),d({qpf:n.qpf,outlook:n.outlook,obsPrecip:r.data.reduce(((e,t)=>{let[i,r]=t;return e.dates.push(i),e.values.push(r),e}),{dates:[],values:[]}),pet:Fg(l,c,r.data.length+28)})})()}}),[r,o,s,a,n,l,c]),(0,e.useEffect)((()=>{if(u&&h&&l&&c){const{waterCapacity:e,cropType:t,plantDate:i,irrigationDate:r}=u,{qpf:o,outlook:s,obsPrecip:a,pet:l}=h,c=ft(i,"yyyy-MM-dd"),d=""===r?"":ft(r,"yyyy-MM-dd"),p=[...a.values];for(;-999===p[p.length-1];)p.pop();let m=0,g=0,y=l.dates.findIndex((e=>e===a.dates[p.length-1]))+1,_=l.dates.slice(g,y).findIndex((e=>e===d));const{deficitDaily:v}=Ar(p,l.values.slice(g,y),m,l.dates[g],c,_,e,t,!1);m=v[v.length-1];const x=l.dates.findIndex((e=>e===o.dates[0])),b=Math.max(y-x,0);g=x+b,y=g+o.values.length-b,_=l.dates.slice(g,y).findIndex((e=>e===d));const w=o.values.slice(b).map((e=>-999===e?0:e)),{deficitDaily:S}=Ar(w,l.values.slice(g,y),m,l.dates[g],c,_,e,t,!0),T=Array(g).fill(null).concat(S);m=S[S.length-1],g=l.dates.findIndex((e=>e===s.dates[0])),y=Math.min(l.values.length,g+s[n[0]].length),_=l.dates.slice(g,y).findIndex((e=>e===d));const M=n.reduce(((i,r)=>{const{deficitDaily:n}=Ar(s[r],l.values.slice(g,y),m,l.dates[g],c,_,e,t,!0);return i[r]=Array(g).fill(null).concat(n),i}),{});f({dates:l.dates,observed:v,qpf:T,percentileDeficits:M,waterCapacity:e})}}),[h,u,l,c,n]);const m={waterDeficits:p};return(0,Y.jsx)(Bg.Provider,{value:m,children:i})},jg=["0,128,0","255,255,0","255,128,0","255,0,0"],Vg=["No deficit for plant","Deficit, no plant stress","Deficit, plant stress likely","Deficit, severe plant stress"],Ug=["Saturation","Field Capacity","Plant Stress Begins","Wilting Danger Exists"];function Gg(e,t){"string"===typeof e&&(e=parseFloat(e));const i=(Math.round(e*Math.pow(10,t))/Math.pow(10,t)).toFixed(t);return parseFloat(i)}const Hg=(0,e.createContext)({chartData:null}),Wg=t=>{let{children:i}=t;const{waterDeficits:r}=(0,e.useContext)(Bg),{percentiles:n}=(0,e.useContext)(zr),[o,s]=(0,e.useState)(null);(0,e.useEffect)((()=>{if(r){const{dates:i,observed:o,qpf:a,percentileDeficits:l,waterCapacity:c}=r,{plotBands:u,plotLines:h,breakpoints:d}=((e,t)=>{const i=wr.soildata.soilmoistureoptions[t],r=[Gg(i.saturation-i.fieldcapacity,3),Gg(i.fieldcapacity-i.fieldcapacity,3),Gg(i.stressthreshold-i.fieldcapacity,3),Gg(i.prewiltingpoint-i.fieldcapacity,3)],n=r.map(((e,t)=>({value:e,width:1,color:"rgba(200,200,200,0.5)",label:{text:Ug[t]||"",style:{fontSize:"0.8em",color:"gray",fontWeight:"lighter"},align:"right",x:-4,y:8}}))),o=r.map(((t,i)=>{const n=0===i?99:t,o=void 0===r[i+1]?-99:r[i+1],s=o<=e&&e<n;return{to:n,from:o,color:s?`rgba(${jg[i]},0.13)`:"transparent",label:{text:Vg[i]||"",style:{fontSize:"1.0em",color:s?"black":"gray",fontWeight:s?"bold":"lighter"},align:"left",verticalAlign:"middle",x:10,y:5}}}));return r.shift(),{plotBands:o,plotLines:n,breakpoints:r}})(o[o.length-1],c),p=[o,a].concat(Object.values(l).flat()).flat().filter((e=>null!==e)),f=Math.min(...p)-.1,m=Math.max(...p)+.1,g=[{type:"line",data:(e=d,t=o,t.map((t=>{let i="transparent";if(null!==t)for(let r=0;r<e.length;r++){if(t>=e[r]&&jg[r]){i=`rgba(${jg[r]},0.8)`;break}r===e.length-1&&(i=`rgba(${jg[r+1]},0.8)`)}return{color:i,y:t}}))),name:"Observed",zIndex:2,color:"black",marker:{enabledThresold:0,lineColor:"black",lineWidth:1,symbol:"circle",radius:3}},{type:"line",data:a,name:"QPF Forecast",zIndex:2,color:"red",dashStyle:"ShortDot",marker:{enabledThresold:0,lineColor:"red",lineWidth:1,symbol:"circle",radius:3}}],y=[...n];if(y.includes(50)){g.push({type:"line",data:l[50],name:"Outlook Forecast Mean",zIndex:y.length,color:"orange",marker:{enabledThresold:0,lineColor:"orange",lineWidth:1,symbol:"circle",radius:3}});const e=y.indexOf(50);y.splice(e,1)}y.slice(0,y.length/2).forEach(((e,t)=>{const i=y[y.length-1-t],r=l[i];g.push({type:"arearange",data:l[e].map(((e,t)=>[t,e,r[t]])),name:`Outlook Forecast ${e}-${i}%`,zIndex:t,marker:{enabledThresold:0,lineColor:"black",lineWidth:1,symbol:"circle",radius:3}})})),s({series:g,dates:i,plotBands:u,plotLines:h,min:f,max:m})}var e,t}),[r,n]);const a={chartData:o};return(0,Y.jsx)(Hg.Provider,{value:a,children:i})};var $g=i(3488),qg=i.n($g),Xg=i(4999),Yg=i.n(Xg),Zg=i(9520),Kg=i.n(Zg),Jg=i(7459),Qg=i.n(Jg),ey=i(3048);function ty(t){let{soilCap:i,todayIdx:r,today:n,irrigationDates:o}=t;const s=(0,e.useRef)(null),{chartData:a}=(0,e.useContext)(Hg);let l=[],c=[],u=[],h=[],d=0,p=0;a&&({series:l,dates:c,plotBands:u,plotLines:h,min:d,max:p}=a);const f={credits:{href:"https://www.nrcc.cornell.edu/",text:"Northeast Regional Climate Center",position:{y:-4}},chart:{zoomType:"x",plotBorderWidth:1},plotOptions:{series:{marker:{enabled:!0}}},title:{text:"Water Deficit"},series:l,legend:{enabled:!0},xAxis:{categories:c},yAxis:{title:{text:"Water Deficit (inches)"},tickInterval:.5,gridLineWidth:0,plotBands:u,plotLines:h,min:d,max:p,endOnTick:!1,startOnTick:!1},tooltip:{shared:!0,outside:!0,split:!1,useHTML:!0,valueDecimals:2}};return(0,Y.jsx)(Yg(),{ref:s,highcharts:qg(),options:f})}function iy(){const{locations:t,selectedLocation:i,updateStoredLocations:r}=(0,e.useContext)(Fr);return(0,Y.jsxs)("div",{className:"App",children:[(0,Y.jsx)(Pn,{locations:t,selected:i,newLocationsCallback:r,token:"pk.eyJ1IjoiaWRmY3VydmV0b29sYWRtaW4iLCJhIjoiY2xkdGFmZTd4MDJ3ZDNxb3h5dXdrb3cwbSJ9.-57RGzVhzLpxzp2WsX9xDQ",modalZIndex:150,bbox:{north:49.458,south:35.5,east:-66.833,west:-97.5}}),(0,Y.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"12px",width:"200px"},children:[(0,Y.jsx)($c,{}),(0,Y.jsx)(qc,{}),(0,Y.jsx)(Lg,{}),(0,Y.jsx)(Rg,{})]}),(0,Y.jsx)(ty,{})]})}i.n(ey)()(qg()),Kg()(qg()),Qg()(qg());r.createRoot(document.getElementById("root")).render((0,Y.jsx)(e.StrictMode,{children:(0,Y.jsx)(J,{dateAdapter:class extends br{constructor(){let{locale:e,formats:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super({locale:null!=e?e:at,formats:t,longFormatters:_r()}),this.parseISO=e=>lr(e),this.toISO=e=>function(e,t){var i,r;te(1,arguments);var n=ie(e);if(isNaN(n.getTime()))throw new RangeError("Invalid time value");var o=String(null!==(i=null===t||void 0===t?void 0:t.format)&&void 0!==i?i:"extended"),s=String(null!==(r=null===t||void 0===t?void 0:t.representation)&&void 0!==r?r:"complete");if("extended"!==o&&"basic"!==o)throw new RangeError("format must be 'extended' or 'basic'");if("date"!==s&&"time"!==s&&"complete"!==s)throw new RangeError("representation must be 'date', 'time', or 'complete'");var a="",l="",c="extended"===o?"-":"",u="extended"===o?":":"";if("time"!==s){var h=Le(n.getDate(),2),d=Le(n.getMonth()+1,2),p=Le(n.getFullYear(),4);a="".concat(p).concat(c).concat(d).concat(c).concat(h)}if("date"!==s){var f=n.getTimezoneOffset();if(0!==f){var m=Math.abs(f),g=Le(Math.floor(m/60),2),y=Le(m%60,2);l="".concat(f<0?"+":"-").concat(g,":").concat(y)}else l="Z";var _=""===a?"":"T",v=[Le(n.getHours(),2),Le(n.getMinutes(),2),Le(n.getSeconds(),2)].join(u);a="".concat(a).concat(_).concat(v).concat(l)}return a}(e,{format:"extended"}),this.parse=(e,t)=>""===e?null:or(e,t,new Date,{locale:this.locale}),this.isValid=e=>Me(this.date(e)),this.format=(e,t)=>this.formatByString(e,this.formats[t]),this.formatByString=(e,t)=>ft(e,t,{locale:this.locale}),this.getDiff=(e,t,i)=>{switch(i){case"years":return le(e,this.date(t));case"quarters":return function(e,t,i){te(2,arguments);var r=he(e,t)/3;return pe(null===i||void 0===i?void 0:i.roundingMethod)(r)}(e,this.date(t));case"months":return he(e,this.date(t));case"weeks":return function(e,t,i){te(2,arguments);var r=ye(e,t)/7;return pe(null===i||void 0===i?void 0:i.roundingMethod)(r)}(e,this.date(t));case"days":return ye(e,this.date(t));case"hours":return function(e,t,i){te(2,arguments);var r=xe(e,t)/ve;return pe(null===i||void 0===i?void 0:i.roundingMethod)(r)}(e,this.date(t));case"minutes":return function(e,t,i){te(2,arguments);var r=xe(e,t)/_e;return pe(null===i||void 0===i?void 0:i.roundingMethod)(r)}(e,this.date(t));case"seconds":return function(e,t,i){te(2,arguments);var r=xe(e,t)/1e3;return pe(null===i||void 0===i?void 0:i.roundingMethod)(r)}(e,this.date(t));default:return xe(e,this.date(t))}},this.isEqual=(e,t)=>null===e&&null===t||function(e,t){te(2,arguments);var i=ie(e),r=ie(t);return i.getTime()===r.getTime()}(e,t),this.isSameYear=(e,t)=>function(e,t){te(2,arguments);var i=ie(e),r=ie(t);return i.getFullYear()===r.getFullYear()}(e,t),this.isSameMonth=(e,t)=>function(e,t){te(2,arguments);var i=ie(e),r=ie(t);return i.getFullYear()===r.getFullYear()&&i.getMonth()===r.getMonth()}(e,t),this.isSameDay=(e,t)=>function(e,t){te(2,arguments);var i=me(e),r=me(t);return i.getTime()===r.getTime()}(e,t),this.isSameHour=(e,t)=>function(e,t){te(2,arguments);var i=xt(e),r=xt(t);return i.getTime()===r.getTime()}(e,t),this.isAfter=(e,t)=>_t(e,t),this.isAfterYear=(e,t)=>_t(e,Te(t)),this.isAfterDay=(e,t)=>_t(e,ce(t)),this.isBefore=(e,t)=>vt(e,t),this.isBeforeYear=(e,t)=>vt(e,ar(t)),this.isBeforeDay=(e,t)=>vt(e,me(t)),this.isWithinRange=(e,t)=>{let[i,r]=t;return function(e,t){te(2,arguments);var i=ie(e).getTime(),r=ie(t.start).getTime(),n=ie(t.end).getTime();if(!(r<=n))throw new RangeError("Invalid interval");return i>=r&&i<=n}(e,{start:i,end:r})},this.startOfYear=e=>ar(e),this.startOfMonth=e=>sr(e),this.startOfWeek=e=>gt(e,{locale:this.locale}),this.startOfDay=e=>me(e),this.endOfYear=e=>Te(e),this.endOfMonth=e=>ue(e),this.endOfWeek=e=>Se(e,{locale:this.locale}),this.endOfDay=e=>ce(e),this.addYears=(e,t)=>se(e,t),this.addMonths=(e,t)=>oe(e,t),this.addWeeks=(e,t)=>function(e,t){return te(2,arguments),re(e,7*Q(t))}(e,t),this.addDays=(e,t)=>re(e,t),this.addHours=(e,t)=>function(e,t){return te(2,arguments),ne(e,36e5*Q(t))}(e,t),this.addMinutes=(e,t)=>function(e,t){return te(2,arguments),ne(e,6e4*Q(t))}(e,t),this.addSeconds=(e,t)=>function(e,t){return te(2,arguments),ne(e,1e3*Q(t))}(e,t),this.getYear=e=>function(e){return te(1,arguments),ie(e).getFullYear()}(e),this.getMonth=e=>function(e){return te(1,arguments),ie(e).getMonth()}(e),this.getDate=e=>function(e){return te(1,arguments),ie(e).getDate()}(e),this.getHours=e=>function(e){return te(1,arguments),ie(e).getHours()}(e),this.getMinutes=e=>function(e){return te(1,arguments),ie(e).getMinutes()}(e),this.getSeconds=e=>function(e){return te(1,arguments),ie(e).getSeconds()}(e),this.getMilliseconds=e=>function(e){return te(1,arguments),ie(e).getMilliseconds()}(e),this.setYear=(e,t)=>function(e,t){te(2,arguments);var i=ie(e),r=Q(t);return isNaN(i.getTime())?new Date(NaN):(i.setFullYear(r),i)}(e,t),this.setMonth=(e,t)=>function(e,t){te(2,arguments);var i=ie(e),r=Q(t),n=i.getFullYear(),o=i.getDate(),s=new Date(0);s.setFullYear(n,r,15),s.setHours(0,0,0,0);var a=mt(s);return i.setMonth(r,Math.min(o,a)),i}(e,t),this.setDate=(e,t)=>function(e,t){te(2,arguments);var i=ie(e),r=Q(t);return i.setDate(r),i}(e,t),this.setHours=(e,t)=>function(e,t){te(2,arguments);var i=ie(e),r=Q(t);return i.setHours(r),i}(e,t),this.setMinutes=(e,t)=>function(e,t){te(2,arguments);var i=ie(e),r=Q(t);return i.setMinutes(r),i}(e,t),this.setSeconds=(e,t)=>function(e,t){te(2,arguments);var i=ie(e),r=Q(t);return i.setSeconds(r),i}(e,t),this.setMilliseconds=(e,t)=>function(e,t){te(2,arguments);var i=ie(e),r=Q(t);return i.setMilliseconds(r),i}(e,t),this.getDaysInMonth=e=>mt(e),this.getNextMonth=e=>oe(e,1),this.getPreviousMonth=e=>oe(e,-1),this.getMonthArray=e=>{const t=[ar(e)];for(;t.length<12;){const e=t[t.length-1];t.push(this.getNextMonth(e))}return t},this.mergeDateAndTime=(e,t)=>this.setSeconds(this.setMinutes(this.setHours(e,this.getHours(t)),this.getMinutes(t)),this.getSeconds(t)),this.getWeekdays=()=>{const e=new Date;return function(e,t){var i;te(1,arguments);var r=e||{},n=ie(r.start),o=ie(r.end).getTime();if(!(n.getTime()<=o))throw new RangeError("Invalid interval");var s=[],a=n;a.setHours(0,0,0,0);var l=Number(null!==(i=null===t||void 0===t?void 0:t.step)&&void 0!==i?i:1);if(l<1||isNaN(l))throw new RangeError("`options.step` must be a number greater than 1");for(;a.getTime()<=o;)s.push(ie(a)),a.setDate(a.getDate()+l),a.setHours(0,0,0,0);return s}({start:gt(e,{locale:this.locale}),end:Se(e,{locale:this.locale})}).map((e=>this.formatByString(e,"EEEEEE")))},this.getWeekArray=e=>{const t=gt(sr(e),{locale:this.locale}),i=Se(ue(e),{locale:this.locale});let r=0,n=t;const o=[];for(;vt(n,i);){const e=Math.floor(r/7);o[e]=o[e]||[],o[e].push(n),n=re(n,1),r+=1}return o},this.getWeekNumber=e=>function(e,t){te(1,arguments);var i=ie(e),r=gt(i,t).getTime()-yt(i,t).getTime();return Math.round(r/6048e5)+1}(e,{locale:this.locale}),this.getYearRange=(e,t)=>{const i=ar(e),r=Te(t),n=[];let o=i;for(;vt(o,r);)n.push(o),o=se(o,1);return n}}},children:(0,Y.jsx)(Or,{children:(0,Y.jsx)(Wc,{children:(0,Y.jsx)(Br,{children:(0,Y.jsx)(Ng,{children:(0,Y.jsx)(Wg,{children:(0,Y.jsx)(iy,{})})})})})})})}))})()})();
//# sourceMappingURL=main.4a546bf0.js.map